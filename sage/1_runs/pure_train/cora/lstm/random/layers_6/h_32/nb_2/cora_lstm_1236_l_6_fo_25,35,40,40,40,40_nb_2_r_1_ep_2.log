main start at this time 1648433580.054623
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009505748748779297
random selection method range initialization spend 0.00021386146545410156
time for parepare:  8.177757263183594e-05
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0023958683013916016
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001342296600341797
----------------------check_connections_block total spend ----------------------------- 0.003384828567504883
generate_one_block  0.0018148422241210938
generate_one_block  0.001420736312866211
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005724430084228516
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.00016999244689941406
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0008873939514160156
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0008497238159179688
----------------------check_connections_block total spend ----------------------------- 0.0030913352966308594
generate_one_block  0.0023081302642822266
generate_one_block  0.0022225379943847656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006654262542724609
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.000217437744140625
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.002370595932006836
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.002255678176879883
----------------------check_connections_block total spend ----------------------------- 0.007258176803588867
generate_one_block  0.003913402557373047
generate_one_block  0.003587484359741211
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006754398345947266
gen group dst list time:  0.00011777877807617188
time for parepare:  0.00023365020751953125
local_output_nid generation:  0.00017404556274414062
local_in_edges_tensor generation:  0.0004737377166748047
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0037736892700195312
local_output_nid generation:  0.00017881393432617188
local_in_edges_tensor generation:  0.0004019737243652344
mini_batch_src_global generation:  0.00037550926208496094
r_  generation:  0.003481626510620117
----------------------check_connections_block total spend ----------------------------- 0.011086463928222656
generate_one_block  0.004801511764526367
generate_one_block  0.003702878952026367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007066726684570312
gen group dst list time:  0.0001461505889892578
time for parepare:  0.00023937225341796875
local_output_nid generation:  0.0002040863037109375
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.0002887248992919922
r_  generation:  0.00408935546875
local_output_nid generation:  0.00022029876708984375
local_in_edges_tensor generation:  0.00045418739318847656
mini_batch_src_global generation:  0.0004246234893798828
r_  generation:  0.004008054733276367
----------------------check_connections_block total spend ----------------------------- 0.012310981750488281
generate_one_block  0.004800319671630859
generate_one_block  0.004137754440307617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006971359252929688
gen group dst list time:  0.0001590251922607422
time for parepare:  0.00024175643920898438
local_output_nid generation:  0.0002231597900390625
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0003027915954589844
r_  generation:  0.004220485687255859
local_output_nid generation:  0.00024127960205078125
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0003871917724609375
r_  generation:  0.004197120666503906
----------------------check_connections_block total spend ----------------------------- 0.012796401977539062
generate_one_block  0.00577545166015625
generate_one_block  0.004163980484008789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

connection checking time:  0.04654335975646973
block generation total time  0.0394134521484375
average batch blocks generation time:  0.01970672607421875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07703256607055664  GigaBytes
Max Memory Allocated: 0.07703256607055664  GigaBytes

torch.Size([2476, 1433])
torch.Size([2436, 32])
torch.Size([2304, 32])
torch.Size([1952, 32])
torch.Size([1170, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2479248046875 GB
    Memory Allocated: 0.9772872924804688  GigaBytes
Max Memory Allocated: 1.0008759498596191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3416748046875 GB
    Memory Allocated: 0.13945722579956055  GigaBytes
Max Memory Allocated: 1.0318193435668945  GigaBytes

torch.Size([2485, 1433])
torch.Size([2436, 32])
torch.Size([2280, 32])
torch.Size([1877, 32])
torch.Size([1100, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 1.0358986854553223  GigaBytes
Max Memory Allocated: 1.060624599456787  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.039119601249694824 |0.17078149318695068 |0.5609923601150513 |0.00021064281463623047 |0.43799006938934326 |0.02107381820678711 |
----------------------------------------------------------pseudo_mini_loss sum 3.242408275604248
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21210
Number of first layer input nodes during this epoch:  4961
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2654862403869629  GigaBytes
Max Memory Allocated: 1.0926218032836914  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006051063537597656
random selection method range initialization spend 0.00014090538024902344
time for parepare:  9.441375732421875e-05
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00014925003051757812
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0001804828643798828
----------------------check_connections_block total spend ----------------------------- 0.001230478286743164
generate_one_block  0.0015728473663330078
generate_one_block  0.0015175342559814453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006077289581298828
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.00020122528076171875
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0008425712585449219
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0008990764617919922
----------------------check_connections_block total spend ----------------------------- 0.0032236576080322266
generate_one_block  0.0023963451385498047
generate_one_block  0.002421140670776367
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006997585296630859
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002461671829223633
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.0022628307342529297
----------------------check_connections_block total spend ----------------------------- 0.00746464729309082
generate_one_block  0.004343509674072266
generate_one_block  0.0036597251892089844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007216930389404297
gen group dst list time:  0.00011944770812988281
time for parepare:  0.0002453327178955078
local_output_nid generation:  0.00019550323486328125
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0002703666687011719
r_  generation:  0.0037620067596435547
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  0.0003867149353027344
r_  generation:  0.003522634506225586
----------------------check_connections_block total spend ----------------------------- 0.011219024658203125
generate_one_block  0.004952907562255859
generate_one_block  0.003941535949707031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007700920104980469
gen group dst list time:  0.00014781951904296875
time for parepare:  0.0002543926239013672
local_output_nid generation:  0.00022792816162109375
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.00030493736267089844
r_  generation:  0.004175901412963867
local_output_nid generation:  0.0002377033233642578
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  0.0003821849822998047
r_  generation:  0.004090070724487305
----------------------check_connections_block total spend ----------------------------- 0.01265406608581543
generate_one_block  0.005194425582885742
generate_one_block  0.0043413639068603516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007176399230957031
gen group dst list time:  0.00016188621520996094
time for parepare:  0.00024628639221191406
local_output_nid generation:  0.00025272369384765625
local_in_edges_tensor generation:  0.0005583763122558594
mini_batch_src_global generation:  0.00031757354736328125
r_  generation:  0.004251241683959961
local_output_nid generation:  0.0002532005310058594
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.000392913818359375
r_  generation:  0.004270792007446289
----------------------check_connections_block total spend ----------------------------- 0.014249324798583984
generate_one_block  0.005444765090942383
generate_one_block  0.0044476985931396484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2654862403869629  GigaBytes
Max Memory Allocated: 1.0926218032836914  GigaBytes

connection checking time:  0.048810720443725586
block generation total time  0.04114341735839844
average batch blocks generation time:  0.02057170867919922
block dataloader generation time/epoch 0.12711548805236816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.2649703025817871  GigaBytes
Max Memory Allocated: 1.0926218032836914  GigaBytes

torch.Size([2512, 1433])
torch.Size([2461, 32])
torch.Size([2330, 32])
torch.Size([1923, 32])
torch.Size([1103, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.1652016639709473  GigaBytes
Max Memory Allocated: 1.1904120445251465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.2649674415588379  GigaBytes
Max Memory Allocated: 1.2214508056640625  GigaBytes

torch.Size([2494, 1433])
torch.Size([2447, 32])
torch.Size([2296, 32])
torch.Size([1859, 32])
torch.Size([1063, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 1.1647357940673828  GigaBytes
Max Memory Allocated: 1.2214508056640625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03728759288787842 |0.0012860298156738281 |0.3296511173248291 |0.00014138221740722656 |0.4457598924636841 |0.015844345092773438 |
----------------------------------------------------------pseudo_mini_loss sum 2.343043327331543
Total (block generation + training)time/epoch 1.8331091403961182
Training time/epoch 1.7057082653045654
Training time without block to device /epoch 1.7031362056732178
Training time without total dataloading part /epoch 1.5669491291046143
load block tensor time/epoch 0.07457518577575684
block to device time/epoch 0.0025720596313476562
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21181
Number of first layer input nodes during this epoch:  5006
