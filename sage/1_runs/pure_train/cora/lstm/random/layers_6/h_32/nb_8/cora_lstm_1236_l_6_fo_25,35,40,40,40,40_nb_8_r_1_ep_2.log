main start at this time 1648433608.6041434
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013327598571777344
random selection method range initialization spend 0.00016069412231445312
time for parepare:  6.413459777832031e-05
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0013401508331298828
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.266334533691406e-05
----------------------check_connections_block total spend ----------------------------- 0.0031499862670898438
generate_one_block  0.0013835430145263672
generate_one_block  0.001077413558959961
generate_one_block  0.0010731220245361328
generate_one_block  0.0010485649108886719
generate_one_block  0.0010616779327392578
generate_one_block  0.0011005401611328125
generate_one_block  0.0011420249938964844
generate_one_block  0.0010428428649902344
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004775524139404297
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.00013637542724609375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002658367156982422
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002491474151611328
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00019097328186035156
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002491474151611328
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00022268295288085938
----------------------check_connections_block total spend ----------------------------- 0.0039010047912597656
generate_one_block  0.0013399124145507812
generate_one_block  0.0013544559478759766
generate_one_block  0.0012888908386230469
generate_one_block  0.0013158321380615234
generate_one_block  0.0012669563293457031
generate_one_block  0.0012159347534179688
generate_one_block  0.0014333724975585938
generate_one_block  0.0012824535369873047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006895065307617188
gen group dst list time:  9.799003601074219e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.00075531005859375
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0008428096771240234
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0007665157318115234
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0007665157318115234
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0007364749908447266
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0008573532104492188
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007462501525878906
----------------------check_connections_block total spend ----------------------------- 0.010251760482788086
generate_one_block  0.0018939971923828125
generate_one_block  0.0021300315856933594
generate_one_block  0.0019528865814208984
generate_one_block  0.0020024776458740234
generate_one_block  0.001934051513671875
generate_one_block  0.0015974044799804688
generate_one_block  0.0019750595092773438
generate_one_block  0.0018877983093261719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007183551788330078
gen group dst list time:  0.0001842975616455078
time for parepare:  0.00017571449279785156
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00035834312438964844
mini_batch_src_global generation:  0.00019621849060058594
r_  generation:  0.0016570091247558594
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0018401145935058594
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.0018053054809570312
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00016427040100097656
r_  generation:  0.0017247200012207031
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0017635822296142578
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0013027191162109375
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.001806020736694336
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0016391277313232422
----------------------check_connections_block total spend ----------------------------- 0.020984888076782227
generate_one_block  0.0030891895294189453
generate_one_block  0.003251314163208008
generate_one_block  0.0032367706298828125
generate_one_block  0.002968311309814453
generate_one_block  0.0029714107513427734
generate_one_block  0.0024871826171875
generate_one_block  0.002917766571044922
generate_one_block  0.002831697463989258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007562637329101562
gen group dst list time:  0.0003654956817626953
time for parepare:  0.00017404556274414062
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0024776458740234375
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.00031757354736328125
mini_batch_src_global generation:  0.00029349327087402344
r_  generation:  0.0025818347930908203
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.002614259719848633
local_output_nid generation:  0.00012969970703125
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.002642393112182617
local_output_nid generation:  0.00012969970703125
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.0025560855865478516
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002777576446533203
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.0022470951080322266
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0026421546936035156
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.002469301223754883
----------------------check_connections_block total spend ----------------------------- 0.030359983444213867
generate_one_block  0.003693103790283203
generate_one_block  0.004312753677368164
generate_one_block  0.004685640335083008
generate_one_block  0.0038385391235351562
generate_one_block  0.003844738006591797
generate_one_block  0.003458738327026367
generate_one_block  0.0037262439727783203
generate_one_block  0.0036797523498535156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007646083831787109
gen group dst list time:  0.0003757476806640625
time for parepare:  0.00018310546875
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0028328895568847656
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.00033283233642578125
r_  generation:  0.0030128955841064453
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.00025463104248046875
r_  generation:  0.0029408931732177734
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.002925395965576172
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0003342628479003906
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.002875089645385742
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0027341842651367188
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0003352165222167969
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.0028862953186035156
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0028443336486816406
----------------------check_connections_block total spend ----------------------------- 0.03433847427368164
generate_one_block  0.005125761032104492
generate_one_block  0.004103899002075195
generate_one_block  0.004099845886230469
generate_one_block  0.004075527191162109
generate_one_block  0.004096031188964844
generate_one_block  0.003968477249145508
generate_one_block  0.004143714904785156
generate_one_block  0.004125118255615234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

connection checking time:  0.09983611106872559
block generation total time  0.11460304260253906
average batch blocks generation time:  0.014325380325317383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07596254348754883  GigaBytes
Max Memory Allocated: 0.07596254348754883  GigaBytes

torch.Size([2375, 1433])
torch.Size([2218, 32])
torch.Size([1841, 32])
torch.Size([1116, 32])
torch.Size([421, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.8980116844177246  GigaBytes
Max Memory Allocated: 0.9360752105712891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.13939905166625977  GigaBytes
Max Memory Allocated: 0.9739646911621094  GigaBytes

torch.Size([2417, 1433])
torch.Size([2269, 32])
torch.Size([1926, 32])
torch.Size([1232, 32])
torch.Size([499, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.981694221496582  GigaBytes
Max Memory Allocated: 1.0172514915466309  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.13939714431762695  GigaBytes
Max Memory Allocated: 1.0538406372070312  GigaBytes

torch.Size([2413, 1433])
torch.Size([2300, 32])
torch.Size([1926, 32])
torch.Size([1209, 32])
torch.Size([433, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9906010627746582  GigaBytes
Max Memory Allocated: 1.0538406372070312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.13939142227172852  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

torch.Size([2410, 1433])
torch.Size([2287, 32])
torch.Size([1940, 32])
torch.Size([1147, 32])
torch.Size([416, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9787168502807617  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.1393895149230957  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

torch.Size([2394, 1433])
torch.Size([2251, 32])
torch.Size([1903, 32])
torch.Size([1163, 32])
torch.Size([445, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9686431884765625  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.13814687728881836  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

torch.Size([2334, 1433])
torch.Size([2101, 32])
torch.Size([1625, 32])
torch.Size([835, 32])
torch.Size([269, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9236631393432617  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.13939237594604492  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

torch.Size([2404, 1433])
torch.Size([2249, 32])
torch.Size([1884, 32])
torch.Size([1139, 32])
torch.Size([482, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9712367057800293  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.13838529586791992  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

torch.Size([2374, 1433])
torch.Size([2224, 32])
torch.Size([1819, 32])
torch.Size([1100, 32])
torch.Size([431, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3729248046875 GB
    Memory Allocated: 0.9618401527404785  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06250220537185669 |0.04376727342605591 |0.3477717638015747 |0.00014710426330566406 |0.37605953216552734 |0.021390914916992188 |
----------------------------------------------------------pseudo_mini_loss sum 3.042994976043701
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64973
Number of first layer input nodes during this epoch:  19121
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 0.2649092674255371  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007398128509521484
random selection method range initialization spend 0.0001544952392578125
time for parepare:  9.465217590332031e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.7670135498046875e-05
----------------------check_connections_block total spend ----------------------------- 0.002139568328857422
generate_one_block  0.0013375282287597656
generate_one_block  0.0011355876922607422
generate_one_block  0.0011272430419921875
generate_one_block  0.0011229515075683594
generate_one_block  0.001093149185180664
generate_one_block  0.0010840892791748047
generate_one_block  0.0011448860168457031
generate_one_block  0.0010900497436523438
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005571842193603516
gen group dst list time:  6.914138793945312e-05
time for parepare:  0.00022292137145996094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0002574920654296875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002608299255371094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00019216537475585938
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00022101402282714844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00021958351135253906
----------------------check_connections_block total spend ----------------------------- 0.004658937454223633
generate_one_block  0.001470804214477539
generate_one_block  0.0014319419860839844
generate_one_block  0.0013992786407470703
generate_one_block  0.00140380859375
generate_one_block  0.0012814998626708984
generate_one_block  0.0013461112976074219
generate_one_block  0.0015125274658203125
generate_one_block  0.0012278556823730469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007863044738769531
gen group dst list time:  0.0001246929168701172
time for parepare:  0.00023651123046875
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0006544589996337891
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.00090789794921875
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0008029937744140625
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0008730888366699219
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0006232261657714844
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0007441043853759766
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.001085519790649414
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0007488727569580078
----------------------check_connections_block total spend ----------------------------- 0.011658430099487305
generate_one_block  0.0020177364349365234
generate_one_block  0.002192974090576172
generate_one_block  0.0019614696502685547
generate_one_block  0.0020656585693359375
generate_one_block  0.0017292499542236328
generate_one_block  0.0020606517791748047
generate_one_block  0.002312898635864258
generate_one_block  0.001893758773803711
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010182857513427734
gen group dst list time:  0.0002219676971435547
time for parepare:  0.00021600723266601562
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.0004169940948486328
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0016961097717285156
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.0002701282501220703
r_  generation:  0.0021140575408935547
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0018792152404785156
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0018830299377441406
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0015041828155517578
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.001621246337890625
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.0022346973419189453
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.0016312599182128906
----------------------check_connections_block total spend ----------------------------- 0.0233609676361084
generate_one_block  0.003336191177368164
generate_one_block  0.0037946701049804688
generate_one_block  0.0032281875610351562
generate_one_block  0.0031647682189941406
generate_one_block  0.0027480125427246094
generate_one_block  0.002926349639892578
generate_one_block  0.003612995147705078
generate_one_block  0.0030972957611083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009212493896484375
gen group dst list time:  0.00039267539978027344
time for parepare:  0.00021982192993164062
local_output_nid generation:  0.00018286705017089844
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.0002541542053222656
r_  generation:  0.002743244171142578
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.00036334991455078125
r_  generation:  0.0029594898223876953
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.002806425094604492
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.0026865005493164062
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.002460956573486328
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0024671554565429688
local_output_nid generation:  0.00017547607421875
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.0027790069580078125
local_output_nid generation:  0.0001537799835205078
local_in_edges_tensor generation:  0.00031304359436035156
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.002606630325317383
----------------------check_connections_block total spend ----------------------------- 0.03302931785583496
generate_one_block  0.004103183746337891
generate_one_block  0.004488468170166016
generate_one_block  0.003980159759521484
generate_one_block  0.003871440887451172
generate_one_block  0.0036482810974121094
generate_one_block  0.003750324249267578
generate_one_block  0.00426936149597168
generate_one_block  0.003997325897216797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008234977722167969
gen group dst list time:  0.0004458427429199219
time for parepare:  0.00023174285888671875
local_output_nid generation:  0.00019860267639160156
local_in_edges_tensor generation:  0.0005185604095458984
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.003177165985107422
local_output_nid generation:  0.00020551681518554688
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  0.0003299713134765625
r_  generation:  0.0032677650451660156
local_output_nid generation:  0.0002028942108154297
local_in_edges_tensor generation:  0.0003948211669921875
mini_batch_src_global generation:  0.00027179718017578125
r_  generation:  0.0032351016998291016
local_output_nid generation:  0.00019073486328125
local_in_edges_tensor generation:  0.0003669261932373047
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.003056764602661133
local_output_nid generation:  0.00018334388732910156
local_in_edges_tensor generation:  0.0003666877746582031
mini_batch_src_global generation:  0.00025653839111328125
r_  generation:  0.002856016159057617
local_output_nid generation:  0.0001888275146484375
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0028505325317382812
local_output_nid generation:  0.0001995563507080078
local_in_edges_tensor generation: Using backend: pytorch
 0.0003566741943359375
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.003087759017944336
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.0030167102813720703
----------------------check_connections_block total spend ----------------------------- 0.037134647369384766
generate_one_block  0.004610300064086914
generate_one_block  0.004471540451049805
generate_one_block  0.004359006881713867
generate_one_block  0.004212617874145508
generate_one_block  0.004111051559448242
generate_one_block  0.004216670989990234
generate_one_block  0.004797935485839844
generate_one_block  0.00471043586730957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 0.2649092674255371  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

connection checking time:  0.10984230041503906
block generation total time  0.12081480026245117
average batch blocks generation time:  0.015101850032806396
block dataloader generation time/epoch 0.3481874465942383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 0.2655329704284668  GigaBytes
Max Memory Allocated: 1.0633788108825684  GigaBytes

torch.Size([2388, 1433])
torch.Size([2211, 32])
torch.Size([1767, 32])
torch.Size([976, 32])
torch.Size([328, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 1.0863418579101562  GigaBytes
Max Memory Allocated: 1.127366542816162  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 0.26555776596069336  GigaBytes
Max Memory Allocated: 1.1648321151733398  GigaBytes

torch.Size([2416, 1433])
torch.Size([2310, 32])
torch.Size([1969, 32])
torch.Size([1260, 32])
torch.Size([471, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.1192116737365723  GigaBytes
Max Memory Allocated: 1.1648321151733398  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.2655482292175293  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

torch.Size([2416, 1433])
torch.Size([2265, 32])
torch.Size([1845, 32])
torch.Size([1098, 32])
torch.Size([408, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.102834701538086  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.26431989669799805  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

torch.Size([2332, 1433])
torch.Size([2133, 32])
torch.Size([1763, 32])
torch.Size([1113, 32])
torch.Size([460, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.065183162689209  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.26421689987182617  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

torch.Size([2317, 1433])
torch.Size([2051, 32])
torch.Size([1582, 32])
torch.Size([838, 32])
torch.Size([304, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.0412721633911133  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.2645101547241211  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

torch.Size([2370, 1433])
torch.Size([2142, 32])
torch.Size([1655, 32])
torch.Size([926, 32])
torch.Size([404, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.0676336288452148  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.26557207107543945  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

torch.Size([2433, 1433])
torch.Size([2340, 32])
torch.Size([2022, 32])
torch.Size([1378, 32])
torch.Size([587, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 1.1337547302246094  GigaBytes
Max Memory Allocated: 1.1915850639343262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.26554346084594727  GigaBytes
Max Memory Allocated: 1.2024898529052734  GigaBytes

torch.Size([2403, 1433])
torch.Size([2267, 32])
torch.Size([1849, 32])
torch.Size([1022, 32])
torch.Size([377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 1.1109471321105957  GigaBytes
Max Memory Allocated: 1.2024898529052734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06151086091995239 |0.0011800825595855713 |0.2934820055961609 |0.00012424588203430176 |0.37868988513946533 |0.01456904411315918 |
----------------------------------------------------------pseudo_mini_loss sum 2.6070709228515625
Total (block generation + training)time/epoch 6.312398672103882
Training time/epoch 5.963964939117432
Training time without block to device /epoch 5.954524278640747
Training time without total dataloading part /epoch 5.392938137054443
load block tensor time/epoch 0.49208688735961914
block to device time/epoch 0.00944066047668457
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  63947
Number of first layer input nodes during this epoch:  19075
