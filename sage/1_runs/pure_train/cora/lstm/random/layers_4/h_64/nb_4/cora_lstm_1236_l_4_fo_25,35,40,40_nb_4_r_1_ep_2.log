main start at this time 1648431510.9502897
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001367330551147461
random selection method range initialization spend 0.0002167224884033203
time for parepare:  6.437301635742188e-05
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0027153491973876953
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.222724914550781e-05
----------------------check_connections_block total spend ----------------------------- 0.003978729248046875
generate_one_block  0.0013451576232910156
generate_one_block  0.0010716915130615234
generate_one_block  0.0011475086212158203
generate_one_block  0.0010805130004882812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004868507385253906
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.0001430511474609375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0004470348358154297
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00046181678771972656
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00038552284240722656
----------------------check_connections_block total spend ----------------------------- 0.003171682357788086
generate_one_block  0.0015370845794677734
generate_one_block  0.0015347003936767578
generate_one_block  0.001405954360961914
generate_one_block  0.0014240741729736328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006086826324462891
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.00017380714416503906
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.0013005733489990234
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0013275146484375
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0010578632354736328
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0012001991271972656
----------------------check_connections_block total spend ----------------------------- 0.007867813110351562
generate_one_block  0.002704143524169922
generate_one_block  0.002545595169067383
generate_one_block  0.0021827220916748047
generate_one_block  0.0022306442260742188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007121562957763672
gen group dst list time:  0.0001308917999267578
time for parepare:  0.00020432472229003906
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00040221214294433594
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0023598670959472656
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.0002799034118652344
r_  generation:  0.0023221969604492188
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.00022792816162109375
r_  generation:  0.0020809173583984375
local_output_nid generation:  0.00010442733764648438
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.002228975296020508
----------------------check_connections_block total spend ----------------------------- 0.013950586318969727
generate_one_block  0.0035924911499023438
generate_one_block  0.003396749496459961
generate_one_block  0.0031473636627197266
generate_one_block  0.003244161605834961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

connection checking time:  0.024990081787109375
block generation total time  0.0289456844329834
average batch blocks generation time:  0.00723642110824585
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07548904418945312  GigaBytes
Max Memory Allocated: 0.07548904418945312  GigaBytes

torch.Size([2183, 1433])
torch.Size([1636, 64])
torch.Size([784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.7327718734741211  GigaBytes
Max Memory Allocated: 0.7658524513244629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.13826847076416016  GigaBytes
Max Memory Allocated: 0.8237810134887695  GigaBytes

torch.Size([2151, 1433])
torch.Size([1559, 64])
torch.Size([766, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.775606632232666  GigaBytes
Max Memory Allocated: 0.8237810134887695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.13723421096801758  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

torch.Size([1960, 1433])
torch.Size([1383, 64])
torch.Size([609, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.7027840614318848  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.13775348663330078  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

torch.Size([2056, 1433])
torch.Size([1460, 64])
torch.Size([700, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.7424120903015137  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05622225999832153 |0.08784794807434082 |0.29294461011886597 |0.00015181303024291992 |0.24349021911621094 |0.014783143997192383 |
----------------------------------------------------------pseudo_mini_loss sum 2.659954786300659
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17976
Number of first layer input nodes during this epoch:  8350
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2713623046875 GB
    Memory Allocated: 0.26458168029785156  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005161762237548828
random selection method range initialization spend 0.00012826919555664062
time for parepare:  7.510185241699219e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.416175842285156e-05
----------------------check_connections_block total spend ----------------------------- 0.0012662410736083984
generate_one_block  0.0012404918670654297
generate_one_block  0.001096963882446289
generate_one_block  0.0010666847229003906
generate_one_block  0.0011417865753173828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004944801330566406
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0006809234619140625
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.001539468765258789
r_  generation:  0.0005867481231689453
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0004017353057861328
----------------------check_connections_block total spend ----------------------------- 0.005396127700805664
generate_one_block  0.0016064643859863281
generate_one_block  0.0017113685607910156
generate_one_block  0.0014882087707519531
generate_one_block  0.0015788078308105469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005543231964111328
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.00018072128295898438
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0012879371643066406
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.001207590103149414
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0012056827545166016
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0011882781982421875
----------------------check_connections_block total spend ----------------------------- 0.008029699325561523
generate_one_block  0.0024862289428710938
generate_one_block  0.0026082992553710938
generate_one_block  0.002378225326538086
generate_one_block  0.0023965835571289062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007550716400146484
gen group dst list time:  0.00013518333435058594
time for parepare:  0.00019288063049316406
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.0004138946533203125
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0021588802337646484
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002283334732055664
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00018858909606933594
r_  generation:  0.0021975040435791016
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  0.00018930435180664062
r_  generation:  0.0021588802337646484
----------------------check_connections_block total spend ----------------------------- 0.01377725601196289
generate_one_block  0.003581523895263672
generate_one_block  0.0035958290100097656
generate_one_block  0.0034799575805664062
generate_one_block  0.0034630298614501953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2713623046875 GB
    Memory Allocated: 0.26458168029785156  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

connection checking time:  0.027203083038330078
block generation total time  0.030374526977539062
average batch blocks generation time:  0.007593631744384766
block dataloader generation time/epoch 0.09244918823242188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2713623046875 GB
    Memory Allocated: 0.2651796340942383  GigaBytes
Max Memory Allocated: 0.866755485534668  GigaBytes

torch.Size([2114, 1433])
torch.Size([1522, 64])
torch.Size([695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 0.8804755210876465  GigaBytes
Max Memory Allocated: 0.9135899543762207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 0.26460790634155273  GigaBytes
Max Memory Allocated: 0.9743671417236328  GigaBytes

torch.Size([2087, 1433])
torch.Size([1533, 64])
torch.Size([732, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.8952975273132324  GigaBytes
Max Memory Allocated: 0.9743671417236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.2651796340942383  GigaBytes
Max Memory Allocated: 0.9871621131896973  GigaBytes

torch.Size([2171, 1433])
torch.Size([1501, 64])
torch.Size([707, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.8793530464172363  GigaBytes
Max Memory Allocated: 0.9871621131896973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.264711856842041  GigaBytes
Max Memory Allocated: 0.9871621131896973  GigaBytes

torch.Size([2107, 1433])
torch.Size([1512, 64])
torch.Size([711, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3709716796875 GB
    Memory Allocated: 0.8850955963134766  GigaBytes
Max Memory Allocated: 0.9871621131896973  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04852992296218872 |0.0007358789443969727 |0.18090903759002686 |0.00013273954391479492 |0.250990629196167 |0.010487556457519531 |
----------------------------------------------------------pseudo_mini_loss sum 2.2339301109313965
Total (block generation + training)time/epoch 2.0909583568573
Training time/epoch 1.9982519149780273
Training time without block to device /epoch 1.9953083992004395
Training time without total dataloading part /epoch 1.738617181777954
load block tensor time/epoch 0.19411969184875488
block to device time/epoch 0.0029435157775878906
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18126
Number of first layer input nodes during this epoch:  8479
