main start at this time 1648431540.1829875
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014736652374267578
random selection method range initialization spend 0.00020837783813476562
time for parepare:  6.961822509765625e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0025594234466552734
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0265579223632812e-05
----------------------check_connections_block total spend ----------------------------- 0.005785703659057617
generate_one_block  0.00160980224609375
generate_one_block  0.001302480697631836
generate_one_block  0.0012362003326416016
generate_one_block  0.0011341571807861328
generate_one_block  0.0011456012725830078
generate_one_block  0.0011525154113769531
generate_one_block  0.0011637210845947266
generate_one_block  0.0011534690856933594
generate_one_block  0.0011720657348632812
generate_one_block  0.001134634017944336
generate_one_block  0.0010221004486083984
generate_one_block  0.001028299331665039
generate_one_block  0.0011548995971679688
generate_one_block  0.0010235309600830078
generate_one_block  0.0010199546813964844
generate_one_block  0.001005411148071289
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005996227264404297
gen group dst list time:  9.679794311523438e-05
time for parepare:  0.00016546249389648438
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015735626220703125
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00014710426330566406
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011110305786132812
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0001125335693359375
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.079673767089844e-05
----------------------check_connections_block total spend ----------------------------- 0.005789995193481445
generate_one_block  0.0012314319610595703
generate_one_block  0.001302480697631836
generate_one_block  0.0013720989227294922
generate_one_block  0.0012881755828857422
generate_one_block  0.0012841224670410156
generate_one_block  0.0012352466583251953
generate_one_block  0.0013887882232666016
generate_one_block  0.0012462139129638672
generate_one_block  0.0012142658233642578
generate_one_block  0.0011191368103027344
generate_one_block  0.0010581016540527344
generate_one_block  0.0012614727020263672
generate_one_block  0.0012271404266357422
generate_one_block  0.0011699199676513672
generate_one_block  0.0012917518615722656
generate_one_block  0.0010449886322021484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006625652313232422
gen group dst list time:  0.00017333030700683594
time for parepare:  0.00022125244140625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003108978271484375
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006175041198730469
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0006899833679199219
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005161762237548828
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005342960357666016
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.000339508056640625
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0006470680236816406
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00041604042053222656
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00037384033203125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00019669532775878906
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0005025863647460938
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00034236907958984375
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005590915679931641
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0006506443023681641
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00020313262939453125
----------------------check_connections_block total spend ----------------------------- 0.013457298278808594
generate_one_block  0.0014524459838867188
generate_one_block  0.0017919540405273438
generate_one_block  0.00183868408203125
generate_one_block  0.0016090869903564453
generate_one_block  0.0017502307891845703
generate_one_block  0.0013225078582763672
generate_one_block  0.0016303062438964844
generate_one_block  0.001369476318359375
generate_one_block  0.0013949871063232422
generate_one_block  0.0013227462768554688
generate_one_block  0.0012602806091308594
generate_one_block  0.0015213489532470703
generate_one_block  0.0013980865478515625
generate_one_block  0.0016210079193115234
generate_one_block  0.0017063617706298828
generate_one_block  0.0012142658233642578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007245540618896484
gen group dst list time:  0.0002856254577636719
time for parepare:  0.00019693374633789062
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0008952617645263672
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.00021195411682128906
r_  generation:  0.0015952587127685547
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0016026496887207031
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0014531612396240234
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.001386404037475586
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.001001596450805664
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0015132427215576172
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0009913444519042969
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0010907649993896484
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.000980377197265625
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006287097930908203
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0011205673217773438
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0008780956268310547
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0013620853424072266
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0013127326965332031
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0005841255187988281
----------------------check_connections_block total spend ----------------------------- 0.02947854995727539
generate_one_block  0.0020837783813476562
generate_one_block  0.002690553665161133
generate_one_block  0.002692699432373047
generate_one_block  0.002552509307861328
generate_one_block  0.0024569034576416016
generate_one_block  0.002094745635986328
generate_one_block  0.0026092529296875
generate_one_block  0.002059459686279297
generate_one_block  0.0023717880249023438
generate_one_block  0.0020318031311035156
generate_one_block  0.0016329288482666016
generate_one_block  0.0023195743560791016
generate_one_block  0.002057790756225586
generate_one_block  0.002627849578857422
generate_one_block  0.0025451183319091797
generate_one_block  0.0017037391662597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

connection checking time:  0.04872584342956543
block generation total time  0.08046960830688477
average batch blocks generation time:  0.005029350519180298
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06994152069091797  GigaBytes
Max Memory Allocated: 0.06994152069091797  GigaBytes

torch.Size([1169, 1433])
torch.Size([495, 64])
torch.Size([162, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5135498046875 GB
    Memory Allocated: 0.29389190673828125  GigaBytes
Max Memory Allocated: 0.3080620765686035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.13665008544921875  GigaBytes
Max Memory Allocated: 0.4106917381286621  GigaBytes

torch.Size([1734, 1433])
torch.Size([946, 64])
torch.Size([314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.5481863021850586  GigaBytes
Max Memory Allocated: 0.5741620063781738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.13643932342529297  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1694, 1433])
torch.Size([958, 64])
torch.Size([331, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.548283576965332  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.13614702224731445  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1641, 1433])
torch.Size([835, 64])
torch.Size([260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.5082826614379883  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.13576602935791016  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1570, 1433])
torch.Size([799, 64])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.49062252044677734  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.13406658172607422  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1254, 1433])
torch.Size([567, 64])
torch.Size([188, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.38241100311279297  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9080810546875 GB
    Memory Allocated: 0.13596582412719727  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1606, 1433])
torch.Size([858, 64])
torch.Size([324, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.5269641876220703  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13406848907470703  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1193, 1433])
torch.Size([550, 64])
torch.Size([193, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.3867621421813965  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13433837890625  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1304, 1433])
torch.Size([622, 64])
torch.Size([203, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.41431665420532227  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13406753540039062  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1178, 1433])
torch.Size([552, 64])
torch.Size([187, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.38141584396362305  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13115453720092773  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([711, 1433])
torch.Size([336, 64])
torch.Size([79, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.2802238464355469  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13498497009277344  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1424, 1433])
torch.Size([730, 64])
torch.Size([243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.45803165435791016  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.1339855194091797  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1239, 1433])
torch.Size([541, 64])
torch.Size([157, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.38248205184936523  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13610267639160156  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1632, 1433])
torch.Size([875, 64])
torch.Size([271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.5327625274658203  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.13593196868896484  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1600, 1433])
torch.Size([869, 64])
torch.Size([347, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.5088915824890137  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.1320042610168457  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([870, 1433])
torch.Size([346, 64])
torch.Size([70, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.2950248718261719  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056587278842926025 |0.022146299481391907 |0.15615707635879517 |0.00012610852718353271 |0.1703597605228424 |0.01887965202331543 |
----------------------------------------------------------pseudo_mini_loss sum 3.1834685802459717
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37032
Number of first layer input nodes during this epoch:  21819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.2593693733215332  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000736236572265625
random selection method range initialization spend 0.000148773193359375
time for parepare:  8.797645568847656e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.003344297409057617
generate_one_block  0.0011792182922363281
generate_one_block  0.0010731220245361328
generate_one_block  0.0010628700256347656
generate_one_block  0.0013070106506347656
generate_one_block  0.0010673999786376953
generate_one_block  0.001081228256225586
generate_one_block  0.0010595321655273438
generate_one_block  0.0010609626770019531
generate_one_block  0.001051187515258789
generate_one_block  0.0010652542114257812
generate_one_block  0.0010540485382080078
generate_one_block  0.0010533332824707031
generate_one_block  0.0010657310485839844
generate_one_block  0.0010609626770019531
generate_one_block  0.0010502338409423828
generate_one_block  0.0010459423065185547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01403498649597168
gen group dst list time:  0.00010251998901367188
time for parepare:  0.00027370452880859375
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00012922286987304688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00019478797912597656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00014138221740722656
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.632110595703125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00015020370483398438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0003609657287597656
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00039124488830566406
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.00019407272338867188
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00018715858459472656
----------------------check_connections_block total spend ----------------------------- 0.007712125778198242
generate_one_block  0.003277301788330078
generate_one_block  0.0026330947875976562
generate_one_block  0.002143383026123047
generate_one_block  0.0023288726806640625
generate_one_block  0.002275705337524414
generate_one_block  0.002338409423828125
generate_one_block  0.0016183853149414062
generate_one_block  0.0015244483947753906
generate_one_block  0.0015208721160888672
generate_one_block  0.001443624496459961
generate_one_block  0.0014765262603759766
generate_one_block  0.001505136489868164
generate_one_block  0.0013005733489990234
generate_one_block  0.0012357234954833984
generate_one_block  0.001142740249633789
generate_one_block  0.0011417865753173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009546279907226562
gen group dst list time:  0.00021576881408691406
time for parepare:  0.0002701282501220703
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0003440380096435547
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005514621734619141
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0004630088806152344
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00030040740966796875
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005645751953125
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0006186962127685547
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0006368160247802734
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.00046515464782714844
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005095005035400391
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0005559921264648438
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0003192424774169922
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0004391670227050781
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005278587341308594
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0005769729614257812
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00026702880859375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003020763397216797
----------------------check_connections_block total spend ----------------------------- 0.015263080596923828
generate_one_block  0.0018627643585205078
generate_one_block  0.0017044544219970703
generate_one_block  0.0015254020690917969
generate_one_block  0.0017762184143066406
generate_one_block  0.0017278194427490234
generate_one_block  0.0017905235290527344
generate_one_block  0.0015444755554199219
generate_one_block  0.0016486644744873047
generate_one_block  0.0018072128295898438
generate_one_block  0.0013911724090576172
generate_one_block  0.001474618911743164
generate_one_block  0.0015714168548583984
generate_one_block  0.0016374588012695312
generate_one_block  0.0016660690307617188
generate_one_block  0.0013356208801269531
generate_one_block  0.0013966560363769531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009267330169677734
gen group dst list time:  0.0003845691680908203
time for parepare:  0.00022077560424804688
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00037741661071777344
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0012536048889160156
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.0011527538299560547
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0008513927459716797
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0015342235565185547
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0014688968658447266
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0015065670013427734
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0011959075927734375
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0013611316680908203
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0014040470123291016
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0006585121154785156
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0008471012115478516
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0011260509490966797
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0012340545654296875
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0012755393981933594
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0006921291351318359
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0008401870727539062
----------------------check_connections_block total spend ----------------------------- 0.031174659729003906
generate_one_block  0.0026979446411132812
generate_one_block  0.0024034976959228516
generate_one_block  0.0020673274993896484
generate_one_block  0.0028014183044433594
generate_one_block  0.0037963390350341797
generate_one_block  0.0037369728088378906
generate_one_block  0.0024476051330566406
generate_one_block  0.002637624740600586
generate_one_block  0.002718687057495117
generate_one_block  0.001913309097290039
generate_one_block  0.0021164417266845703
generate_one_block  0.002460956573486328
generate_one_block  0.0025899410247802734
generate_one_block  0.0025849342346191406
generate_one_block  0.001943349838256836
generate_one_block  0.00213623046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.2593693733215332  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

connection checking time:  0.05414986610412598
block generation total time  0.09581971168518066
average batch blocks generation time:  0.0059887319803237915
block dataloader generation time/epoch 0.2535996437072754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.2632570266723633  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

torch.Size([1418, 1433])
torch.Size([748, 64])
torch.Size([275, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.578178882598877  GigaBytes
Max Memory Allocated: 0.6564803123474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.2617950439453125  GigaBytes
Max Memory Allocated: 0.6891207695007324  GigaBytes

torch.Size([1323, 1433])
torch.Size([636, 64])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.5596961975097656  GigaBytes
Max Memory Allocated: 0.6891207695007324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.26091861724853516  GigaBytes
Max Memory Allocated: 0.6891207695007324  GigaBytes

torch.Size([1165, 1433])
torch.Size([474, 64])
torch.Size([162, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.4755396842956543  GigaBytes
Max Memory Allocated: 0.6891207695007324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.2641286849975586  GigaBytes
Max Memory Allocated: 0.6891207695007324  GigaBytes

torch.Size([1610, 1433])
torch.Size([898, 64])
torch.Size([283, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.6578140258789062  GigaBytes
Max Memory Allocated: 0.6891207695007324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.2625422477722168  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1465, 1433])
torch.Size([805, 64])
torch.Size([276, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.6239452362060547  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.26327085494995117  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1601, 1433])
torch.Size([894, 64])
torch.Size([301, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.6473422050476074  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.26253271102905273  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1385, 1433])
torch.Size([650, 64])
torch.Size([206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.5663762092590332  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.2630772590637207  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1566, 1433])
torch.Size([788, 64])
torch.Size([275, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.6102585792541504  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.26274728775024414  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1504, 1433])
torch.Size([802, 64])
torch.Size([284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.6167783737182617  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.25925540924072266  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([854, 1433])
torch.Size([373, 64])
torch.Size([146, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.4354705810546875  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.2608165740966797  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1145, 1433])
torch.Size([544, 64])
torch.Size([209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.494537353515625  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.26230812072753906  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1423, 1433])
torch.Size([683, 64])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.567502498626709  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.2629108428955078  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1535, 1433])
torch.Size([754, 64])
torch.Size([245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.6064033508300781  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.26255083084106445  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1467, 1433])
torch.Size([778, 64])
torch.Size([265, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.6165633201599121  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.2599663734436035  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([987, 1433])
torch.Size([397, 64])
torch.Size([110, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.4495687484741211  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.26130056381225586  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

torch.Size([1236, 1433])
torch.Size([506, 64])
torch.Size([143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.49416351318359375  GigaBytes
Max Memory Allocated: 0.7671217918395996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056200504302978516 |0.0006619840860366821 |0.12591786682605743 |0.00012145936489105225 |0.1698068082332611 |0.014394521713256836 |
----------------------------------------------------------pseudo_mini_loss sum 2.3136823177337646
Total (block generation + training)time/epoch 5.977035760879517
Training time/epoch 5.722942590713501
Training time without block to device /epoch 5.712350845336914
Training time without total dataloading part /epoch 4.74793267250061
load block tensor time/epoch 0.8992080688476562
block to device time/epoch 0.010591745376586914
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  36805
Number of first layer input nodes during this epoch:  21684
