main start at this time 1648431634.9009712
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012598037719726562
random selection method range initialization spend 0.00020360946655273438
time for parepare:  8.869171142578125e-05
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.002740621566772461
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.771087646484375e-05
----------------------check_connections_block total spend ----------------------------- 0.004261970520019531
generate_one_block  0.0015664100646972656
generate_one_block  0.0013468265533447266
generate_one_block  0.001382589340209961
generate_one_block  0.001306295394897461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005817413330078125
gen group dst list time:  4.982948303222656e-05
time for parepare:  0.00018095970153808594
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004911422729492188
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005755424499511719
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004782676696777344
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004649162292480469
----------------------check_connections_block total spend ----------------------------- 0.0038704872131347656
generate_one_block  0.001804351806640625
generate_one_block  0.0018494129180908203
generate_one_block  0.0017790794372558594
generate_one_block  0.0017664432525634766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006945133209228516
gen group dst list time:  9.942054748535156e-05
time for parepare:  0.00022292137145996094
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.001455068588256836
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0015726089477539062
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0015015602111816406
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0015816688537597656
----------------------check_connections_block total spend ----------------------------- 0.009872674942016602
generate_one_block  0.003052234649658203
generate_one_block  0.0026721954345703125
generate_one_block  0.002251863479614258
generate_one_block  0.0023193359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007531642913818359
gen group dst list time:  0.00018215179443359375
time for parepare:  0.00023674964904785156
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00048089027404785156
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0028045177459716797
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.00029468536376953125
r_  generation:  0.0029137134552001953
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0028908252716064453
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0024461746215820312
----------------------check_connections_block total spend ----------------------------- 0.01714015007019043
generate_one_block  0.003474712371826172
generate_one_block  0.0033435821533203125
generate_one_block  0.0034079551696777344
generate_one_block  0.003394603729248047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

connection checking time:  0.030883312225341797
block generation total time  0.03111577033996582
average batch blocks generation time:  0.007778942584991455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.08343982696533203  GigaBytes
Max Memory Allocated: 0.08343982696533203  GigaBytes

torch.Size([2096, 1433])
torch.Size([1479, 256])
torch.Size([687, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.7515335083007812  GigaBytes
Max Memory Allocated: 0.7517533302307129  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.1568126678466797  GigaBytes
Max Memory Allocated: 0.7958455085754395  GigaBytes

torch.Size([2129, 1433])
torch.Size([1527, 256])
torch.Size([722, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.8508667945861816  GigaBytes
Max Memory Allocated: 0.8511428833007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.15668201446533203  GigaBytes
Max Memory Allocated: 0.8760910034179688  GigaBytes

torch.Size([2105, 1433])
torch.Size([1509, 256])
torch.Size([690, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.8351283073425293  GigaBytes
Max Memory Allocated: 0.8760910034179688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.1567540168762207  GigaBytes
Max Memory Allocated: 0.8760910034179688  GigaBytes

torch.Size([2118, 1433])
torch.Size([1559, 256])
torch.Size([712, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.8543734550476074  GigaBytes
Max Memory Allocated: 0.8760910034179688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0542183518409729 |0.08542275428771973 |0.29816973209381104 |0.00016367435455322266 |0.25878071784973145 |0.013274431228637695 |
----------------------------------------------------------pseudo_mini_loss sum 3.1518616676330566
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18069
Number of first layer input nodes during this epoch:  8448
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 0.3012518882751465  GigaBytes
Max Memory Allocated: 0.8835811614990234  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005400180816650391
random selection method range initialization spend 0.00013113021850585938
time for parepare:  7.987022399902344e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.630752563476562e-05
----------------------check_connections_block total spend ----------------------------- 0.0013511180877685547
generate_one_block  0.0012688636779785156
generate_one_block  0.0011661052703857422
generate_one_block  0.0011327266693115234
generate_one_block  0.0011906623840332031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015909671783447266
gen group dst list time:  4.8160552978515625e-05
time for parepare:  0.00015735626220703125
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0004565715789794922
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.00042700767517089844
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003418922424316406
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004930496215820312
----------------------check_connections_block total spend ----------------------------- 0.0034761428833007812
generate_one_block  0.0017325878143310547
generate_one_block  0.0017905235290527344
generate_one_block  0.001483917236328125
generate_one_block  0.0016689300537109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  8.869171142578125e-05
time for parepare:  0.00019168853759765625
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0013971328735351562
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0013206005096435547
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0010492801666259766
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0014014244079589844
----------------------check_connections_block total spend ----------------------------- 0.008499622344970703
generate_one_block  0.002800464630126953
generate_one_block  0.002669811248779297
generate_one_block  0.002222299575805664
generate_one_block  0.0024509429931640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007271766662597656
gen group dst list time:  0.0001461505889892578
time for parepare:  0.00020194053649902344
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00042700767517089844
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0024559497833251953
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.0002830028533935547
r_  generation:  0.002457857131958008
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0021584033966064453
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.002499818801879883
----------------------check_connections_block total spend ----------------------------- 0.014859914779663086
generate_one_block  0.004017829895019531
generate_one_block  0.003590822219848633
generate_one_block  0.003236532211303711
generate_one_block  0.003543853759765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 0.3012518882751465  GigaBytes
Max Memory Allocated: 0.8835811614990234  GigaBytes

connection checking time:  0.02683568000793457
block generation total time  0.031208515167236328
average batch blocks generation time:  0.007802128791809082
block dataloader generation time/epoch 0.09499478340148926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 0.30083417892456055  GigaBytes
Max Memory Allocated: 0.8835811614990234  GigaBytes

torch.Size([2029, 1433])
torch.Size([1539, 256])
torch.Size([776, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.9881930351257324  GigaBytes
Max Memory Allocated: 0.988433837890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.30126285552978516  GigaBytes
Max Memory Allocated: 1.0118355751037598  GigaBytes

torch.Size([2149, 1433])
torch.Size([1542, 256])
torch.Size([717, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.9977664947509766  GigaBytes
Max Memory Allocated: 1.0118355751037598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.30081796646118164  GigaBytes
Max Memory Allocated: 1.0273160934448242  GigaBytes

torch.Size([2024, 1433])
torch.Size([1329, 256])
torch.Size([566, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.900665283203125  GigaBytes
Max Memory Allocated: 1.0273160934448242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.3011965751647949  GigaBytes
Max Memory Allocated: 1.0273160934448242  GigaBytes

torch.Size([2136, 1433])
torch.Size([1574, 256])
torch.Size([723, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 1.0121159553527832  GigaBytes
Max Memory Allocated: 1.0273160934448242  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055287182331085205 |0.0026274919509887695 |0.181554913520813 |0.00012743473052978516 |0.25622689723968506 |0.015449762344360352 |
----------------------------------------------------------pseudo_mini_loss sum 2.8166873455047607
Total (block generation + training)time/epoch 2.1576991081237793
Training time/epoch 2.0624072551727295
Training time without block to device /epoch 2.0518972873687744
Training time without total dataloading part /epoch 1.7670867443084717
load block tensor time/epoch 0.22114872932434082
block to device time/epoch 0.010509967803955078
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17834
Number of first layer input nodes during this epoch:  8338
