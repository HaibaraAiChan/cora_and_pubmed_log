main start at this time 1648431664.6112804
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014195442199707031
random selection method range initialization spend 0.00020432472229003906
time for parepare:  6.437301635742188e-05
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0026221275329589844
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1219253540039062e-05
----------------------check_connections_block total spend ----------------------------- 0.005729198455810547
generate_one_block  0.0014777183532714844
generate_one_block  0.0010411739349365234
generate_one_block  0.001012563705444336
generate_one_block  0.0009970664978027344
generate_one_block  0.0010254383087158203
generate_one_block  0.0009999275207519531
generate_one_block  0.001020193099975586
generate_one_block  0.0009930133819580078
generate_one_block  0.001046895980834961
generate_one_block  0.001001119613647461
generate_one_block  0.0010006427764892578
generate_one_block  0.0010135173797607422
generate_one_block  0.0010008811950683594
generate_one_block  0.000949859619140625
generate_one_block  0.000957489013671875
generate_one_block  0.0009565353393554688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005977153778076172
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010919570922851562
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010919570922851562
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001270771026611328
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.821487426757812e-05
----------------------check_connections_block total spend ----------------------------- 0.005573749542236328
generate_one_block  0.001154184341430664
generate_one_block  0.0011560916900634766
generate_one_block  0.0011458396911621094
generate_one_block  0.0011019706726074219
generate_one_block  0.001219034194946289
generate_one_block  0.0011277198791503906
generate_one_block  0.0012574195861816406
generate_one_block  0.0011010169982910156
generate_one_block  0.001058340072631836
generate_one_block  0.0010662078857421875
generate_one_block  0.0010895729064941406
generate_one_block  0.0010654926300048828
generate_one_block  0.0010657310485839844
generate_one_block  0.0011067390441894531
generate_one_block  0.0011332035064697266
generate_one_block  0.0010390281677246094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006902217864990234
gen group dst list time:  0.00016570091247558594
time for parepare:  0.00020813941955566406
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00043511390686035156
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004334449768066406
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004832744598388672
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0006260871887207031
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.00044989585876464844
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0006642341613769531
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003230571746826172
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0003914833068847656
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00037407875061035156
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004222393035888672
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003764629364013672
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005633831024169922
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00047326087951660156
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0002760887145996094
----------------------check_connections_block total spend ----------------------------- 0.013029098510742188
generate_one_block  0.0015254020690917969
generate_one_block  0.0014750957489013672
generate_one_block  0.0015709400177001953
generate_one_block  0.0014104843139648438
generate_one_block  0.0019023418426513672
generate_one_block  0.001455068588256836
generate_one_block  0.0017189979553222656
generate_one_block  0.0013093948364257812
generate_one_block  0.0013794898986816406
generate_one_block  0.0013675689697265625
generate_one_block  0.0014126300811767578
generate_one_block  0.0013740062713623047
generate_one_block  0.001444101333618164
generate_one_block  0.0015914440155029297
generate_one_block  0.0014560222625732422
generate_one_block  0.001249074935913086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007512569427490234
gen group dst list time:  0.0002646446228027344
time for parepare:  0.00018858909606933594
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0011785030364990234
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0010387897491455078
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0013580322265625
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0009434223175048828
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0014164447784423828
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0011363029479980469
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0015342235565185547
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0008361339569091797
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0011608600616455078
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.001009225845336914
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0010073184967041016
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0011301040649414062
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0008985996246337891
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0013513565063476562
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0011293888092041016
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0006952285766601562
----------------------check_connections_block total spend ----------------------------- 0.02872323989868164
generate_one_block  0.002467632293701172
generate_one_block  0.0021109580993652344
generate_one_block  0.0024106502532958984
generate_one_block  0.0020444393157958984
generate_one_block  0.0025086402893066406
generate_one_block  0.0024330615997314453
generate_one_block  0.0026459693908691406
generate_one_block  0.0018856525421142578
generate_one_block  0.0024557113647460938
generate_one_block  0.0020837783813476562
generate_one_block  0.0020759105682373047
generate_one_block  0.0021979808807373047
generate_one_block  0.002015352249145508
generate_one_block  0.0025322437286376953
generate_one_block  0.0022928714752197266
generate_one_block  0.0017576217651367188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

connection checking time:  0.047326087951660156
block generation total time  0.07744812965393066
average batch blocks generation time:  0.0048405081033706665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.08045148849487305  GigaBytes
Max Memory Allocated: 0.08045148849487305  GigaBytes

torch.Size([1545, 1433])
torch.Size([703, 256])
torch.Size([250, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.41966819763183594  GigaBytes
Max Memory Allocated: 0.41973257064819336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.15144586563110352  GigaBytes
Max Memory Allocated: 0.5207843780517578  GigaBytes

torch.Size([1328, 1433])
torch.Size([639, 256])
torch.Size([239, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.45459651947021484  GigaBytes
Max Memory Allocated: 0.5207843780517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.15292596817016602  GigaBytes
Max Memory Allocated: 0.5454721450805664  GigaBytes

torch.Size([1604, 1433])
torch.Size([813, 256])
torch.Size([280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.5272989273071289  GigaBytes
Max Memory Allocated: 0.5454721450805664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.1506357192993164  GigaBytes
Max Memory Allocated: 0.614616870880127  GigaBytes

torch.Size([1177, 1433])
torch.Size([552, 256])
torch.Size([176, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.4249396324157715  GigaBytes
Max Memory Allocated: 0.614616870880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8787841796875 GB
    Memory Allocated: 0.15307855606079102  GigaBytes
Max Memory Allocated: 0.614616870880127  GigaBytes

torch.Size([1631, 1433])
torch.Size([887, 256])
torch.Size([317, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9022216796875 GB
    Memory Allocated: 0.5713667869567871  GigaBytes
Max Memory Allocated: 0.614616870880127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.15160799026489258  GigaBytes
Max Memory Allocated: 0.6465449333190918  GigaBytes

torch.Size([1358, 1433])
torch.Size([694, 256])
torch.Size([244, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.4796109199523926  GigaBytes
Max Memory Allocated: 0.6465449333190918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.1530609130859375  GigaBytes
Max Memory Allocated: 0.6465449333190918  GigaBytes

torch.Size([1627, 1433])
torch.Size([965, 256])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9100341796875 GB
    Memory Allocated: 0.6067705154418945  GigaBytes
Max Memory Allocated: 0.6465449333190918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.15003252029418945  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1065, 1433])
torch.Size([518, 256])
torch.Size([176, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.38721179962158203  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.1530437469482422  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1482, 1433])
torch.Size([682, 256])
torch.Size([200, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.4878959655761719  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.1510319709777832  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1251, 1433])
torch.Size([595, 256])
torch.Size([194, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.4415092468261719  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.15103912353515625  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1252, 1433])
torch.Size([620, 256])
torch.Size([203, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.44550609588623047  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.15207481384277344  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1446, 1433])
torch.Size([677, 256])
torch.Size([183, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.46773719787597656  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.15103721618652344  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1193, 1433])
torch.Size([550, 256])
torch.Size([206, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.4293231964111328  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.1529092788696289  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1600, 1433])
torch.Size([875, 256])
torch.Size([315, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5629301071166992  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.15167999267578125  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1371, 1433])
torch.Size([721, 256])
torch.Size([238, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5000796318054199  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.1500697135925293  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([948, 1433])
torch.Size([423, 256])
torch.Size([147, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.35984230041503906  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05560660362243652 |0.02201870083808899 |0.16129937767982483 |0.00012475252151489258 |0.1876944601535797 |0.019181251525878906 |
----------------------------------------------------------pseudo_mini_loss sum 3.0327088832855225
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37284
Number of first layer input nodes during this epoch:  21878
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.2944207191467285  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007441043853759766
random selection method range initialization spend 0.00015926361083984375
time for parepare:  9.107589721679688e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.0032885074615478516
generate_one_block  0.001188039779663086
generate_one_block  0.0010509490966796875
generate_one_block  0.0010576248168945312
generate_one_block  0.0012917518615722656
generate_one_block  0.0010390281677246094
generate_one_block  0.0010530948638916016
generate_one_block  0.001024007797241211
generate_one_block  0.0010297298431396484
generate_one_block  0.0010254383087158203
generate_one_block  0.0010149478912353516
generate_one_block  0.0010199546813964844
generate_one_block  0.0010166168212890625
generate_one_block  0.0010225772857666016
generate_one_block  0.0010111331939697266
generate_one_block  0.001046895980834961
generate_one_block  0.0010073184967041016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006451606750488281
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00015735626220703125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00020933151245117188
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00011563301086425781
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00011682510375976562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00021457672119140625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.343292236328125e-05
----------------------check_connections_block total spend ----------------------------- 0.006144046783447266
generate_one_block  0.001262664794921875
generate_one_block  0.0011317729949951172
generate_one_block  0.0012154579162597656
generate_one_block  0.0011742115020751953
generate_one_block  0.001140594482421875
generate_one_block  0.001264810562133789
generate_one_block  0.0011131763458251953
generate_one_block  0.001087188720703125
generate_one_block  0.0010790824890136719
generate_one_block  0.0010738372802734375
generate_one_block  0.0011034011840820312
generate_one_block  0.0010669231414794922
generate_one_block  0.0011434555053710938
generate_one_block  0.0011467933654785156
generate_one_block  0.0012354850769042969
generate_one_block  0.0010395050048828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007424354553222656
gen group dst list time:  0.0001823902130126953
time for parepare:  0.0002243518829345703
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0006213188171386719
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005061626434326172
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004932880401611328
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00044608116149902344
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0007336139678955078
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0004405975341796875
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.000354766845703125
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003871917724609375
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00034236907958984375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00033855438232421875
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005414485931396484
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0006625652313232422
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.000308990478515625
----------------------check_connections_block total spend ----------------------------- 0.014164209365844727
generate_one_block  0.001875162124633789
generate_one_block  0.0014622211456298828
generate_one_block  0.0015778541564941406
generate_one_block  0.001519918441772461
generate_one_block  0.001506805419921875
generate_one_block  0.001880645751953125
generate_one_block  0.0014934539794921875
generate_one_block  0.001483917236328125
generate_one_block  0.0015017986297607422
generate_one_block  0.0014247894287109375
generate_one_block  0.0015230178833007812
generate_one_block  0.0013873577117919922
generate_one_block  0.001356363296508789
generate_one_block  0.0015931129455566406
generate_one_block  0.0017688274383544922
generate_one_block  0.0012888908386230469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008072853088378906
gen group dst list time:  0.0003726482391357422
time for parepare:  0.0002052783966064453
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0003833770751953125
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0014460086822509766
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0010540485382080078
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.001341104507446289
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0012781620025634766
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0013053417205810547
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.001775503158569336
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0010974407196044922
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0011010169982910156
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0009603500366210938
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0009419918060302734
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0011527538299560547
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0010251998901367188
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0008001327514648438
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0011532306671142578
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.00140380859375
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0007250308990478516
----------------------check_connections_block total spend ----------------------------- 0.030672311782836914
generate_one_block  0.0029256343841552734
generate_one_block  0.0022783279418945312
generate_one_block  0.0026082992553710938
generate_one_block  0.002475261688232422
generate_one_block  0.002549409866333008
generate_one_block  0.003812074661254883
generate_one_block  0.0022842884063720703
generate_one_block  0.0023021697998046875
generate_one_block  0.002135753631591797
generate_one_block  0.0020966529846191406
generate_one_block  0.0024394989013671875
generate_one_block  0.0021948814392089844
generate_one_block  0.0019774436950683594
generate_one_block  0.0023870468139648438
generate_one_block  0.002672910690307617
generate_one_block  0.0018794536590576172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.2944207191467285  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

connection checking time:  0.050980567932128906
block generation total time  0.08194160461425781
average batch blocks generation time:  0.005121350288391113
block dataloader generation time/epoch 0.22906255722045898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.2970423698425293  GigaBytes
Max Memory Allocated: 0.679079532623291  GigaBytes

torch.Size([1567, 1433])
torch.Size([883, 256])
torch.Size([324, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7177939414978027  GigaBytes
Max Memory Allocated: 0.7178549766540527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.2956547737121582  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

torch.Size([1310, 1433])
torch.Size([611, 256])
torch.Size([186, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.594602108001709  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.2970919609069824  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

torch.Size([1577, 1433])
torch.Size([789, 256])
torch.Size([278, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.6780986785888672  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.29645872116088867  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

torch.Size([1459, 1433])
torch.Size([746, 256])
torch.Size([237, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.6541681289672852  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.29767751693725586  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

torch.Size([1588, 1433])
torch.Size([772, 256])
torch.Size([228, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.6603713035583496  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.2989997863769531  GigaBytes
Max Memory Allocated: 0.796821117401123  GigaBytes

torch.Size([1779, 1433])
torch.Size([1081, 256])
torch.Size([385, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.8054089546203613  GigaBytes
Max Memory Allocated: 0.8055057525634766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.2958498001098633  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1346, 1433])
torch.Size([635, 256])
torch.Size([225, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.6055073738098145  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.2958230972290039  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1341, 1433])
torch.Size([652, 256])
torch.Size([208, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.606755256652832  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.29584407806396484  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1214, 1433])
torch.Size([549, 256])
torch.Size([174, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5673041343688965  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.29517173767089844  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1220, 1433])
torch.Size([558, 256])
torch.Size([188, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5600862503051758  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.2968883514404297  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1540, 1433])
torch.Size([711, 256])
torch.Size([230, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.6395883560180664  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.2956690788269043  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1313, 1433])
torch.Size([635, 256])
torch.Size([140, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5879573822021484  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.29457616806030273  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1109, 1433])
torch.Size([478, 256])
torch.Size([184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5268077850341797  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.29614925384521484  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1401, 1433])
torch.Size([751, 256])
torch.Size([281, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.6431517601013184  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.29743146896362305  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([1639, 1433])
torch.Size([927, 256])
torch.Size([329, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.7285757064819336  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.29375457763671875  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

torch.Size([956, 1433])
torch.Size([431, 256])
torch.Size([130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.5055556297302246  GigaBytes
Max Memory Allocated: 0.874107837677002  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0562453418970108 |0.0005577504634857178 |0.12836450338363647 |0.00010988116264343262 |0.17997777462005615 |0.012351751327514648 |
----------------------------------------------------------pseudo_mini_loss sum 3.4946517944335938
Total (block generation + training)time/epoch 6.149281978607178
Training time/epoch 5.920006036758423
Training time without block to device /epoch 5.911082029342651
Training time without total dataloading part /epoch 4.947586297988892
load block tensor time/epoch 0.8999254703521729
block to device time/epoch 0.008924007415771484
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  38063
Number of first layer input nodes during this epoch:  22359
