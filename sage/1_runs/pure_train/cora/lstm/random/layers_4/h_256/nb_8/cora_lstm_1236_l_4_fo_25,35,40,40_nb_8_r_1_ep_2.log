main start at this time 1648431648.192353
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001588582992553711
random selection method range initialization spend 0.0003638267517089844
time for parepare:  0.000102996826171875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.004362344741821289
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.981590270996094e-05
----------------------check_connections_block total spend ----------------------------- 0.006957054138183594
generate_one_block  0.002249479293823242
generate_one_block  0.0013241767883300781
generate_one_block  0.0012362003326416016
generate_one_block  0.0012259483337402344
generate_one_block  0.0011477470397949219
generate_one_block  0.0010738372802734375
generate_one_block  0.0010776519775390625
generate_one_block  0.0010585784912109375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006988048553466797
gen group dst list time:  6.103515625e-05
time for parepare:  0.00015854835510253906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002589225769042969
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00029659271240234375
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00021576881408691406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.000225067138671875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002143383026123047
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00021338462829589844
----------------------check_connections_block total spend ----------------------------- 0.0042760372161865234
generate_one_block  0.0014083385467529297
generate_one_block  0.0013000965118408203
generate_one_block  0.0013821125030517578
generate_one_block  0.0013740062713623047
generate_one_block  0.0012781620025634766
generate_one_block  0.0012879371643066406
generate_one_block  0.0012962818145751953
generate_one_block  0.001234292984008789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006744861602783203
gen group dst list time:  0.00010895729064941406
time for parepare:  0.00019311904907226562
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0002655982971191406
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.0007967948913574219
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0007460117340087891
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0009624958038330078
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0009121894836425781
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0007152557373046875
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0007588863372802734
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0008080005645751953
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007138252258300781
----------------------check_connections_block total spend ----------------------------- 0.011101484298706055
generate_one_block  0.0020198822021484375
generate_one_block  0.0019440650939941406
generate_one_block  0.0019867420196533203
generate_one_block  0.0019190311431884766
generate_one_block  0.0016884803771972656
generate_one_block  0.0017786026000976562
generate_one_block  0.0018236637115478516
generate_one_block  0.001766204833984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008046627044677734
gen group dst list time:  0.00019979476928710938
time for parepare:  0.00020766258239746094
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0018074512481689453
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.0018215179443359375
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.002044677734375
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.001928567886352539
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0018737316131591797
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.00180816650390625
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0016319751739501953
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0015997886657714844
----------------------check_connections_block total spend ----------------------------- 0.022661685943603516
generate_one_block  0.0030307769775390625
generate_one_block  0.002833843231201172
generate_one_block  0.003015279769897461
generate_one_block  0.002949953079223633
generate_one_block  0.002708911895751953
generate_one_block  0.002791166305541992
generate_one_block  0.0030858516693115234
generate_one_block  0.002677440643310547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

connection checking time:  0.038039207458496094
block generation total time  0.04858112335205078
average batch blocks generation time:  0.006072640419006348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.08230018615722656  GigaBytes
Max Memory Allocated: 0.08230018615722656  GigaBytes

torch.Size([1887, 1433])
torch.Size([1102, 256])
torch.Size([448, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.5890645980834961  GigaBytes
Max Memory Allocated: 0.5891947746276855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.15493106842041016  GigaBytes
Max Memory Allocated: 0.6645545959472656  GigaBytes

torch.Size([1808, 1433])
torch.Size([1093, 256])
torch.Size([406, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.6565041542053223  GigaBytes
Max Memory Allocated: 0.6645545959472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.15567350387573242  GigaBytes
Max Memory Allocated: 0.7260351181030273  GigaBytes

torch.Size([1945, 1433])
torch.Size([1268, 256])
torch.Size([509, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0643310546875 GB
    Memory Allocated: 0.7323474884033203  GigaBytes
Max Memory Allocated: 0.7324924468994141  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.15512609481811523  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

torch.Size([1843, 1433])
torch.Size([1184, 256])
torch.Size([480, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.6994123458862305  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.15487432479858398  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

torch.Size([1790, 1433])
torch.Size([1016, 256])
torch.Size([380, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.6325459480285645  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.15499496459960938  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

torch.Size([1820, 1433])
torch.Size([1088, 256])
torch.Size([370, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.6595664024353027  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.15488004684448242  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

torch.Size([1767, 1433])
torch.Size([1096, 256])
torch.Size([429, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.6685619354248047  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.1539769172668457  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

torch.Size([1630, 1433])
torch.Size([992, 256])
torch.Size([372, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.6188344955444336  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0566556453704834 |0.043228328227996826 |0.21772223711013794 |0.00014066696166992188 |0.22912153601646423 |0.013540267944335938 |
----------------------------------------------------------pseudo_mini_loss sum 3.0576794147491455
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27486
Number of first layer input nodes during this epoch:  14490
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.29837751388549805  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005538463592529297
random selection method range initialization spend 0.0001437664031982422
time for parepare:  0.000110626220703125
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.221366882324219e-05
----------------------check_connections_block total spend ----------------------------- 0.002209186553955078
generate_one_block  0.0012042522430419922
generate_one_block  0.00113677978515625
generate_one_block  0.0011103153228759766
generate_one_block  0.0010824203491210938
generate_one_block  0.0010802745819091797
generate_one_block  0.0010945796966552734
generate_one_block  0.0010881423950195312
generate_one_block  0.0010976791381835938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005533695220947266
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.00018525123596191406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00024771690368652344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00030422210693359375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00028824806213378906
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002143383026123047
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.000278472900390625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00029015541076660156
----------------------check_connections_block total spend ----------------------------- 0.0046215057373046875
generate_one_block  0.0014100074768066406
generate_one_block  0.0014183521270751953
generate_one_block  0.0014257431030273438
generate_one_block  0.0013637542724609375
generate_one_block  0.0012903213500976562
generate_one_block  0.0012967586517333984
generate_one_block  0.0013620853424072266
generate_one_block  0.0013034343719482422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007016658782958984
gen group dst list time:  0.00011873245239257812
time for parepare:  0.00023818016052246094
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00038123130798339844
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0008676052093505859
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0009157657623291016
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0009953975677490234
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0006539821624755859
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006635189056396484
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007064342498779297
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0008184909820556641
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0009200572967529297
----------------------check_connections_block total spend ----------------------------- 0.01160120964050293
generate_one_block  0.0022008419036865234
generate_one_block  0.002173185348510742
generate_one_block  0.0021266937255859375
generate_one_block  0.0016965866088867188
generate_one_block  0.0017101764678955078
generate_one_block  0.0017991065979003906
generate_one_block  0.0018990039825439453
generate_one_block  0.0020008087158203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007455348968505859
gen group dst list time:  0.00022554397583007812
time for parepare:  0.00022220611572265625
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.00042557716369628906
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0018744468688964844
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0020155906677246094
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0021648406982421875
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0015039443969726562
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0015099048614501953
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0004596710205078125
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.0017843246459960938
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.0017840862274169922
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0017726421356201172
----------------------check_connections_block total spend ----------------------------- 0.02309560775756836
generate_one_block  0.003141641616821289
generate_one_block  0.003135204315185547
generate_one_block  0.0032701492309570312
generate_one_block  0.0026311874389648438
generate_one_block  0.0026161670684814453
generate_one_block  0.002871990203857422
generate_one_block  0.0028586387634277344
generate_one_block  0.0030002593994140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.29837751388549805  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

connection checking time:  0.03931832313537598
block generation total time  0.050002098083496094
average batch blocks generation time: Using backend: pytorch
 0.006250262260437012
block dataloader generation time/epoch 0.1539473533630371
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.29918909072875977  GigaBytes
Max Memory Allocated: 0.7843422889709473  GigaBytes

torch.Size([1782, 1433])
torch.Size([1109, 256])
torch.Size([463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.8212771415710449  GigaBytes
Max Memory Allocated: 0.8213858604431152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.2996253967285156  GigaBytes
Max Memory Allocated: 0.8825869560241699  GigaBytes

torch.Size([1879, 1433])
torch.Size([1220, 256])
torch.Size([490, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.8569259643554688  GigaBytes
Max Memory Allocated: 0.8825869560241699  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.30020713806152344  GigaBytes
Max Memory Allocated: 0.9146380424499512  GigaBytes

torch.Size([1987, 1433])
torch.Size([1313, 256])
torch.Size([521, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2518310546875 GB
    Memory Allocated: 0.9013991355895996  GigaBytes
Max Memory Allocated: 0.9146380424499512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.2982773780822754  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

torch.Size([1623, 1433])
torch.Size([859, 256])
torch.Size([332, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.7032170295715332  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.2981410026550293  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

torch.Size([1596, 1433])
torch.Size([873, 256])
torch.Size([339, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.7092032432556152  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.29922008514404297  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

torch.Size([1805, 1433])
torch.Size([1043, 256])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.7849326133728027  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.29918622970581055  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

torch.Size([1781, 1433])
torch.Size([1065, 256])
torch.Size([430, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.7926416397094727  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.2994065284729004  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

torch.Size([1838, 1433])
torch.Size([1156, 256])
torch.Size([449, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.838292121887207  GigaBytes
Max Memory Allocated: 0.9532747268676758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05783990025520325 |0.0008024871349334717 |0.15169653296470642 |0.00012370944023132324 |0.21699848771095276 |0.011101007461547852 |
----------------------------------------------------------pseudo_mini_loss sum 2.7720611095428467
Total (block generation + training)time/epoch 3.648318290710449
Training time/epoch 3.493997097015381
Training time without block to device /epoch 3.487577199935913
Training time without total dataloading part /epoch 2.961650848388672
load block tensor time/epoch 0.462719202041626
block to device time/epoch 0.0064198970794677734
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27063
Number of first layer input nodes during this epoch:  14291
