main start at this time 1648431461.9671617
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011057853698730469
random selection method range initialization spend 0.00019598007202148438
time for parepare:  6.723403930664062e-05
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0023534297943115234
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7179718017578125e-05
----------------------check_connections_block total spend ----------------------------- 0.004297494888305664
generate_one_block  0.001463174819946289
generate_one_block  0.0011572837829589844
generate_one_block  0.0010898113250732422
generate_one_block  0.0010519027709960938
generate_one_block  0.0010743141174316406
generate_one_block  0.0010728836059570312
generate_one_block  0.0010623931884765625
generate_one_block  0.0010409355163574219
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005106925964355469
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.00014781951904296875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002734661102294922
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00025844573974609375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00019931793212890625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00027060508728027344
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002758502960205078
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002300739288330078
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015163421630859375
----------------------check_connections_block total spend ----------------------------- 0.004194736480712891
generate_one_block  0.0013964176177978516
generate_one_block  0.0013535022735595703
generate_one_block  0.0013494491577148438
generate_one_block  0.0012574195861816406
generate_one_block  0.0013461112976074219
generate_one_block  0.001382589340209961
generate_one_block  0.0013003349304199219
generate_one_block  0.0012187957763671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006694793701171875
gen group dst list time:  0.00010752677917480469
time for parepare:  0.00018334388732910156
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0008337497711181641
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0009047985076904297
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0008585453033447266
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006697177886962891
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008137226104736328
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.000978231430053711
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0007760524749755859
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005288124084472656
----------------------check_connections_block total spend ----------------------------- 0.010960102081298828
generate_one_block  0.0020551681518554688
generate_one_block  0.0021266937255859375
generate_one_block  0.0018589496612548828
generate_one_block  0.0016756057739257812
generate_one_block  0.0019042491912841797
generate_one_block  0.0023734569549560547
generate_one_block  0.0017764568328857422
generate_one_block  0.001543283462524414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000732421875
gen group dst list time:  0.0002028942108154297
time for parepare:  0.0001971721649169922
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0018765926361083984
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.00027370452880859375
mini_batch_src_global generation:  0.00021958351135253906
r_  generation:  0.0020182132720947266
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0019843578338623047
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0016193389892578125
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.001798391342163086
local_output_nid generation:  9.560585021972656e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00018715858459472656
r_  generation:  0.0020318031311035156
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0016849040985107422
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0011920928955078125
----------------------check_connections_block total spend ----------------------------- 0.021945476531982422
generate_one_block  0.003029346466064453
generate_one_block  0.003008127212524414
generate_one_block  0.002957582473754883
generate_one_block  0.0026454925537109375
generate_one_block  0.0028581619262695312
generate_one_block  0.003827333450317383
generate_one_block  0.0029184818267822266
generate_one_block  0.0023229122161865234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

connection checking time:  0.03710031509399414
block generation total time  0.04948592185974121
average batch blocks generation time:  0.006185740232467651
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07284164428710938  GigaBytes
Max Memory Allocated: 0.07284164428710938  GigaBytes

torch.Size([1830, 1433])
torch.Size([1148, 32])
torch.Size([435, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.5581836700439453  GigaBytes
Max Memory Allocated: 0.5930147171020508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.13633346557617188  GigaBytes
Max Memory Allocated: 0.6684226989746094  GigaBytes

torch.Size([1921, 1433])
torch.Size([1235, 32])
torch.Size([475, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.6586060523986816  GigaBytes
Max Memory Allocated: 0.6958394050598145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.13646936416625977  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1947, 1433])
torch.Size([1207, 32])
torch.Size([470, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.6461691856384277  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.135345458984375  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1739, 1433])
torch.Size([949, 32])
torch.Size([361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.5447039604187012  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.13631916046142578  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1833, 1433])
torch.Size([1084, 32])
torch.Size([408, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.6015291213989258  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.1364154815673828  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1936, 1433])
torch.Size([1235, 32])
torch.Size([539, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.6582269668579102  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.1355586051940918  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1778, 1433])
torch.Size([1032, 32])
torch.Size([414, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.5789628028869629  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.1340165138244629  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1492, 1433])
torch.Size([783, 32])
torch.Size([283, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.4724435806274414  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05683165788650513 |0.043404221534729004 |0.2144125998020172 |0.0001372992992401123 |0.21165654063224792 |0.015377521514892578 |
----------------------------------------------------------pseudo_mini_loss sum 2.8949291706085205
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27289
Number of first layer input nodes during this epoch:  14476
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.2600884437561035  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005555152893066406
random selection method range initialization spend 0.00014257431030273438
time for parepare:  8.487701416015625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.002141714096069336
generate_one_block  0.0011892318725585938
generate_one_block  0.001135110855102539
generate_one_block  0.001096487045288086
generate_one_block  0.0010733604431152344
generate_one_block  0.0010941028594970703
generate_one_block  0.0011153221130371094
generate_one_block  0.0010688304901123047
generate_one_block  0.001066446304321289
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000522613525390625
gen group dst list time:  6.4849853515625e-05
time for parepare:  0.0001785755157470703
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003154277801513672
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003001689910888672
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00022530555725097656
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001952648162841797
----------------------check_connections_block total spend ----------------------------- 0.0044345855712890625
generate_one_block  0.0013382434844970703
generate_one_block  0.0012886524200439453
generate_one_block  0.0013384819030761719
generate_one_block  0.0013811588287353516
generate_one_block  0.001444101333618164
generate_one_block  0.001413583755493164
generate_one_block  0.001325368881225586
generate_one_block  0.0012197494506835938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007312297821044922
gen group dst list time:  0.00012040138244628906
time for parepare:  0.0002391338348388672
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0007154941558837891
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0006237030029296875
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0008666515350341797
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0006508827209472656
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.001115560531616211
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0009207725524902344
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0007910728454589844
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0006635189056396484
----------------------check_connections_block total spend ----------------------------- 0.011377334594726562
generate_one_block  0.0020067691802978516
generate_one_block  0.001829385757446289
generate_one_block  0.0019354820251464844
generate_one_block  0.0016753673553466797
generate_one_block  0.002199411392211914
generate_one_block  0.001995563507080078
generate_one_block  0.0018658638000488281
generate_one_block  0.001710653305053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007436275482177734
gen group dst list time:  0.0002269744873046875
time for parepare:  0.00022339820861816406
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0018007755279541016
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0016362667083740234
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0018310546875
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.001420736312866211
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0022668838500976562
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.000507354736328125
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.002043485641479492
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.001773834228515625
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0013194084167480469
----------------------check_connections_block total spend ----------------------------- 0.022614717483520508
generate_one_block  0.003078460693359375
generate_one_block  0.0027534961700439453
generate_one_block  0.002915620803833008
generate_one_block  0.0024836063385009766
generate_one_block  0.0033278465270996094
generate_one_block  0.003123760223388672
generate_one_block  0.0028672218322753906
generate_one_block  0.002547740936279297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.2600884437561035  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

connection checking time:  0.03842663764953613
block generation total time  0.049065589904785156
average batch blocks generation time:  0.0061331987380981445
block dataloader generation time/epoch 0.15190768241882324Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.26177072525024414  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

torch.Size([1818, 1433])
torch.Size([1055, 32])
torch.Size([361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0877685546875 GB
    Memory Allocated: 0.7159781455993652  GigaBytes
Max Memory Allocated: 0.7665853500366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.2611989974975586  GigaBytes
Max Memory Allocated: 0.826779842376709  GigaBytes

torch.Size([1712, 1433])
torch.Size([956, 32])
torch.Size([307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.6692895889282227  GigaBytes
Max Memory Allocated: 0.826779842376709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.2624626159667969  GigaBytes
Max Memory Allocated: 0.826779842376709  GigaBytes

torch.Size([1778, 1433])
torch.Size([1093, 32])
torch.Size([433, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.7258968353271484  GigaBytes
Max Memory Allocated: 0.826779842376709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.25995588302612305  GigaBytes
Max Memory Allocated: 0.8355770111083984  GigaBytes

torch.Size([1480, 1433])
torch.Size([811, 32])
torch.Size([327, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.6045517921447754  GigaBytes
Max Memory Allocated: 0.8355770111083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.2637152671813965  GigaBytes
Max Memory Allocated: 0.8355770111083984  GigaBytes

torch.Size([2023, 1433])
torch.Size([1404, 32])
torch.Size([570, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1541748046875 GB
    Memory Allocated: 0.8335351943969727  GigaBytes
Max Memory Allocated: 0.8757872581481934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.26237010955810547  GigaBytes
Max Memory Allocated: 0.9385380744934082  GigaBytes

torch.Size([1928, 1433])
torch.Size([1220, 32])
torch.Size([488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.7796282768249512  GigaBytes
Max Memory Allocated: 0.9385380744934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.2616915702819824  GigaBytes
Max Memory Allocated: 0.9385380744934082  GigaBytes

torch.Size([1803, 1433])
torch.Size([1053, 32])
torch.Size([405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.7083587646484375  GigaBytes
Max Memory Allocated: 0.9385380744934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.2599201202392578  GigaBytes
Max Memory Allocated: 0.9385380744934082  GigaBytes

torch.Size([1473, 1433])
torch.Size([837, 32])
torch.Size([322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.6244492530822754  GigaBytes
Max Memory Allocated: 0.9385380744934082  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05696117877960205 |0.0007248818874359131 |0.15407201647758484 |0.00012242794036865234 |0.21397587656974792 |0.011449575424194336 |
----------------------------------------------------------pseudo_mini_loss sum 2.7253496646881104
Total (block generation + training)time/epoch 3.629220724105835
Training time/epoch 3.476952075958252
Training time without block to device /epoch 3.4711530208587646
Training time without total dataloading part /epoch 2.9568121433258057
load block tensor time/epoch 0.4556894302368164
block to device time/epoch 0.005799055099487305
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  26397
Number of first layer input nodes during this epoch:  14015
