main start at this time 1648431478.3916674
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010941028594970703
random selection method range initialization spend 0.0002243518829345703
time for parepare:  8.797645568847656e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0017437934875488281
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.00546717643737793
generate_one_block  0.0015397071838378906
generate_one_block  0.0012521743774414062
generate_one_block  0.0012602806091308594
generate_one_block  0.0012404918670654297
generate_one_block  0.0012314319610595703
generate_one_block  0.0012373924255371094
generate_one_block  0.0010726451873779297
generate_one_block  0.0009524822235107422
generate_one_block  0.0010023117065429688
generate_one_block  0.0009462833404541016
generate_one_block  0.0009496212005615234
generate_one_block  0.0009510517120361328
generate_one_block  0.0009529590606689453
generate_one_block  0.0009429454803466797
generate_one_block  0.0009379386901855469
generate_one_block  0.0009355545043945312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006051063537597656
gen group dst list time:  0.0001251697540283203
time for parepare:  0.00018286705017089844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00020170211791992188
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00016450881958007812
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001659393310546875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001308917999267578
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00021338462829589844
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00019025802612304688
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001723766326904297
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00014019012451171875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.369850158691406e-05
----------------------check_connections_block total spend ----------------------------- 0.00681304931640625
generate_one_block  0.0014536380767822266
generate_one_block  0.0013620853424072266
generate_one_block  0.001413106918334961
generate_one_block  0.0014269351959228516
generate_one_block  0.0013849735260009766
generate_one_block  0.0011954307556152344
generate_one_block  0.0011947154998779297
generate_one_block  0.0011432170867919922
generate_one_block  0.0012195110321044922
generate_one_block  0.0010590553283691406
generate_one_block  0.0011124610900878906
generate_one_block  0.0010917186737060547
generate_one_block  0.0010683536529541016
generate_one_block  0.0010569095611572266
generate_one_block  0.0010738372802734375
generate_one_block  0.0010805130004882812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006811618804931641
gen group dst list time:  0.0002117156982421875
time for parepare:  0.0002677440643310547
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006892681121826172
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00044465065002441406
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005717277526855469
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0005130767822265625
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005228519439697266
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004973411560058594
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.000423431396484375
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004010200500488281
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005526542663574219
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00048661231994628906
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005769729614257812
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0005674362182617188
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.000461578369140625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040602684020996094
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003368854522705078
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002963542938232422
----------------------check_connections_block total spend ----------------------------- 0.014089107513427734
generate_one_block  0.0017139911651611328
generate_one_block  0.0014462471008300781
generate_one_block  0.0017039775848388672
generate_one_block  0.0015871524810791016
generate_one_block  0.0017490386962890625
generate_one_block  0.00145721435546875
generate_one_block  0.0014071464538574219
generate_one_block  0.0013427734375
generate_one_block  0.0014979839324951172
generate_one_block  0.0014712810516357422
generate_one_block  0.0015304088592529297
generate_one_block  0.0015125274658203125
generate_one_block  0.001458883285522461
generate_one_block  0.0013773441314697266
generate_one_block  0.0012793540954589844
generate_one_block  0.0012407302856445312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01451730728149414
gen group dst list time:  0.0007319450378417969
time for parepare:  0.0004055500030517578
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0005774497985839844
mini_batch_src_global generation:  0.0002682209014892578
r_  generation:  0.0028896331787109375
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.00036787986755371094
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0014641284942626953
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0019867420196533203
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.00018644332885742188
r_  generation:  0.0019135475158691406
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0017852783203125
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0015282630920410156
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0010769367218017578
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0008649826049804688
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0010957717895507812
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.001165151596069336
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.001214742660522461
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0013432502746582031
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0009775161743164062
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0010745525360107422
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0007898807525634766
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0007870197296142578
----------------------check_connections_block total spend ----------------------------- 0.035561323165893555
generate_one_block  0.0038378238677978516
generate_one_block  0.0020825862884521484
generate_one_block  0.0025055408477783203
generate_one_block  0.0024373531341552734
generate_one_block  0.0022962093353271484
generate_one_block  0.0024645328521728516
generate_one_block  0.002251148223876953
generate_one_block  0.001971721649169922
generate_one_block  0.0024824142456054688
generate_one_block  0.002332925796508789
generate_one_block  0.0023956298828125
generate_one_block  0.0025911331176757812
generate_one_block  0.0021038055419921875
generate_one_block  0.0022394657135009766
generate_one_block  0.0019023418426513672
generate_one_block  0.0019011497497558594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

connection checking time:  0.05646347999572754
block generation total time  0.08090829849243164
average batch blocks generation time:  0.0050567686557769775
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07097101211547852  GigaBytes
Max Memory Allocated: 0.07097101211547852  GigaBytes

torch.Size([1483, 1433])
torch.Size([807, 32])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.42603015899658203  GigaBytes
Max Memory Allocated: 0.45171213150024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.13230466842651367  GigaBytes
Max Memory Allocated: 0.5403480529785156  GigaBytes

torch.Size([1174, 1433])
torch.Size([525, 32])
torch.Size([186, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.3626894950866699  GigaBytes
Max Memory Allocated: 0.5403480529785156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.13454866409301758  GigaBytes
Max Memory Allocated: 0.5403480529785156  GigaBytes

torch.Size([1591, 1433])
torch.Size([838, 32])
torch.Size([279, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.5032162666320801  GigaBytes
Max Memory Allocated: 0.5403480529785156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13425207138061523  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1536, 1433])
torch.Size([802, 32])
torch.Size([248, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.4855461120605469  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13355016708374023  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1405, 1433])
torch.Size([734, 32])
torch.Size([273, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.459470272064209  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13462066650390625  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1605, 1433])
torch.Size([808, 32])
torch.Size([245, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.49102306365966797  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13358354568481445  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1412, 1433])
torch.Size([671, 32])
torch.Size([210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.43782472610473633  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13241958618164062  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1195, 1433])
torch.Size([549, 32])
torch.Size([203, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.3749680519104004  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13358831405639648  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1394, 1433])
torch.Size([725, 32])
torch.Size([257, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.4450349807739258  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13360977172851562  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1416, 1433])
torch.Size([732, 32])
torch.Size([222, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.4638791084289551  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13393306732177734  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1476, 1433])
torch.Size([766, 32])
torch.Size([292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.47732973098754883  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13476848602294922  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

torch.Size([1632, 1433])
torch.Size([855, 32])
torch.Size([302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.5190639495849609  GigaBytes
Max Memory Allocated: 0.6172103881835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.13289928436279297  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

torch.Size([1284, 1433])
torch.Size([603, 32])
torch.Size([215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.40775585174560547  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.13355493545532227  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

torch.Size([1407, 1433])
torch.Size([674, 32])
torch.Size([214, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.42890453338623047  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.1328897476196289  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

torch.Size([1142, 1433])
torch.Size([476, 32])
torch.Size([178, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.35422325134277344  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.1319279670715332  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

torch.Size([1104, 1433])
torch.Size([496, 32])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.3505253791809082  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056035369634628296 |0.02221636474132538 |0.15469710528850555 |0.00011330842971801758 |0.17677971720695496 |0.01882195472717285 |
----------------------------------------------------------pseudo_mini_loss sum 2.9119873046875
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37823
Number of first layer input nodes during this epoch:  22256
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25797224044799805  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007164478302001953
random selection method range initialization spend 0.00016570091247558594
time for parepare:  8.940696716308594e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.003337383270263672
generate_one_block  0.001210927963256836
generate_one_block  0.0010747909545898438
generate_one_block  0.001028299331665039
generate_one_block  0.0012843608856201172
generate_one_block  0.0010488033294677734
generate_one_block  0.001016855239868164
generate_one_block  0.0010149478912353516
generate_one_block  0.0010409355163574219
generate_one_block  0.00103759765625
generate_one_block  0.0010159015655517578
generate_one_block  0.0010404586791992188
generate_one_block  0.0010497570037841797
generate_one_block  0.0010099411010742188
generate_one_block  0.0009999275207519531
generate_one_block  0.0010135173797607422
generate_one_block  0.0009548664093017578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006084442138671875
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.00018453598022460938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00013875961303710938
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002205371856689453
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001220703125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00015211105346679688
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.462501525878906e-05
----------------------check_connections_block total spend ----------------------------- 0.0060443878173828125
generate_one_block  0.0012011528015136719
generate_one_block  0.0011272430419921875
generate_one_block  0.001190185546875
generate_one_block  0.0011229515075683594
generate_one_block  0.001161336898803711
generate_one_block  0.001216888427734375
generate_one_block  0.001176595687866211
generate_one_block  0.0010340213775634766
generate_one_block  0.0012276172637939453
generate_one_block  0.0010991096496582031
generate_one_block  0.0010974407196044922
generate_one_block  0.0011742115020751953
generate_one_block  0.0011670589447021484
generate_one_block  0.001068115234375
generate_one_block  0.0011408329010009766
generate_one_block  0.001043081283569336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007393360137939453
gen group dst list time:  0.00017642974853515625
time for parepare:  0.0002224445343017578
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003883838653564453
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004127025604248047
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0002810955047607422
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004343986511230469
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0005519390106201172
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00041294097900390625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0007457733154296875
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.00046181678771972656
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004642009735107422
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006213188171386719
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0004744529724121094
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00039505958557128906
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005588531494140625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00030612945556640625
----------------------check_connections_block total spend ----------------------------- 0.013736248016357422
generate_one_block  0.001592874526977539
generate_one_block  0.0014698505401611328
generate_one_block  0.0015740394592285156
generate_one_block  0.0013451576232910156
generate_one_block  0.0014674663543701172
generate_one_block  0.0017092227935791016
generate_one_block  0.0014255046844482422
generate_one_block  0.0012354850769042969
generate_one_block  0.0019559860229492188
generate_one_block  0.0015153884887695312
generate_one_block  0.0015048980712890625
generate_one_block  0.0016453266143798828
generate_one_block  0.0014867782592773438
generate_one_block  0.001417398452758789
generate_one_block  0.0016281604766845703
generate_one_block  0.0012912750244140625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00079345703125
gen group dst list time:  0.0003445148468017578
time for parepare:  0.00021028518676757812
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00039458274841308594
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.001054525375366211
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.001123189926147461
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.001312255859375
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0007026195526123047
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0011720657348632812
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.001384735107421875
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0009033679962158203
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.00067901611328125
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0016283988952636719
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.001386880874633789
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0012927055358886719
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0014214515686035156
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.001153707504272461
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0009212493896484375
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.001260519027709961
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0007321834564208984
----------------------check_connections_block total spend ----------------------------- 0.03005671501159668
generate_one_block  0.002391338348388672
generate_one_block  0.002276182174682617
generate_one_block  0.002525806427001953
generate_one_block  0.0017840862274169922
generate_one_block  0.0023179054260253906
generate_one_block  0.0033385753631591797
generate_one_block  0.002008676528930664
generate_one_block  0.0017609596252441406
generate_one_block  0.0028383731842041016
generate_one_block  0.0025637149810791016
generate_one_block  0.0024700164794921875
generate_one_block  0.002627849578857422
generate_one_block  0.0023844242095947266
generate_one_block  0.002131938934326172
generate_one_block  0.0024993419647216797
generate_one_block  0.0018973350524902344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25797224044799805  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

connection checking time:  0.049837350845336914
block generation total time  0.08032917976379395
average batch blocks generation time:  0.005020573735237122
block dataloader generation time/epoch 0.22149252891540527
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25911998748779297  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

torch.Size([1326, 1433])
torch.Size([616, 32])
torch.Size([189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.5432000160217285  GigaBytes
Max Memory Allocated: 0.6328091621398926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.2596282958984375  GigaBytes
Max Memory Allocated: 0.6599507331848145  GigaBytes

torch.Size([1421, 1433])
torch.Size([646, 32])
torch.Size([179, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.546879768371582  GigaBytes
Max Memory Allocated: 0.6599507331848145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.26049327850341797  GigaBytes
Max Memory Allocated: 0.6635956764221191  GigaBytes

torch.Size([1582, 1433])
torch.Size([761, 32])
torch.Size([204, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.5996227264404297  GigaBytes
Max Memory Allocated: 0.6635956764221191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25655174255371094  GigaBytes
Max Memory Allocated: 0.7150077819824219  GigaBytes

torch.Size([847, 1433])
torch.Size([390, 32])
torch.Size([141, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.4359622001647949  GigaBytes
Max Memory Allocated: 0.7150077819824219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.2594008445739746  GigaBytes
Max Memory Allocated: 0.7150077819824219  GigaBytes

torch.Size([1378, 1433])
torch.Size([672, 32])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.5552549362182617  GigaBytes
Max Memory Allocated: 0.7150077819824219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.26045656204223633  GigaBytes
Max Memory Allocated: 0.7150077819824219  GigaBytes

torch.Size([1574, 1433])
torch.Size([799, 32])
torch.Size([281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.6182498931884766  GigaBytes
Max Memory Allocated: 0.7150077819824219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25803375244140625  GigaBytes
Max Memory Allocated: 0.7325906753540039  GigaBytes

torch.Size([1123, 1433])
torch.Size([490, 32])
torch.Size([216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.481661319732666  GigaBytes
Max Memory Allocated: 0.7325906753540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.2568550109863281  GigaBytes
Max Memory Allocated: 0.7325906753540039  GigaBytes

torch.Size([904, 1433])
torch.Size([386, 32])
torch.Size([114, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.42288732528686523  GigaBytes
Max Memory Allocated: 0.7325906753540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.26148128509521484  GigaBytes
Max Memory Allocated: 0.7325906753540039  GigaBytes

torch.Size([1764, 1433])
torch.Size([1004, 32])
torch.Size([398, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.6839265823364258  GigaBytes
Max Memory Allocated: 0.7325906753540039  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.2606344223022461  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([1608, 1433])
torch.Size([758, 32])
torch.Size([236, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.6120729446411133  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.26041364669799805  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([1567, 1433])
torch.Size([739, 32])
torch.Size([235, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.5906276702880859  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.26049137115478516  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([1580, 1433])
torch.Size([855, 32])
torch.Size([297, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.6374630928039551  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.26041269302368164  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([1477, 1433])
torch.Size([707, 32])
torch.Size([243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.5737471580505371  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.25864410400390625  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([1237, 1433])
torch.Size([558, 32])
torch.Size([180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.5140633583068848  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.2604193687438965  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([1463, 1433])
torch.Size([771, 32])
torch.Size([281, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.6071300506591797  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.2570939064025879  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

torch.Size([948, 1433])
torch.Size([426, 32])
torch.Size([130, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.4593315124511719  GigaBytes
Max Memory Allocated: 0.7951936721801758  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056552574038505554 |0.0006445348262786865 |0.1255083978176117 |0.00011430680751800537 |0.17454591393470764 |0.013920307159423828 |
----------------------------------------------------------pseudo_mini_loss sum 2.4168741703033447
Total (block generation + training)time/epoch 6.016769647598267
Training time/epoch 5.795065879821777
Training time without block to device /epoch 5.784753322601318
Training time without total dataloading part /epoch 4.816618204116821
load block tensor time/epoch 0.9048411846160889
block to device time/epoch 0.010312557220458984
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  36685
Number of first layer input nodes during this epoch:  21799
