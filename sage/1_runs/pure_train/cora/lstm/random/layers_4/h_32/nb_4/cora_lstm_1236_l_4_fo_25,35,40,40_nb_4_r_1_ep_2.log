main start at this time 1648431448.8089101
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014805793762207031
random selection method range initialization spend 0.00018095970153808594
time for parepare:  6.270408630371094e-05
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0024843215942382812
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.125999450683594e-05
----------------------check_connections_block total spend ----------------------------- 0.0037064552307128906
generate_one_block  0.001432180404663086
generate_one_block  0.0010733604431152344
generate_one_block  0.0010917186737060547
generate_one_block  0.0010445117950439453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004899501800537109
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.00014781951904296875
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004227161407470703
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004482269287109375
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003509521484375
----------------------check_connections_block total spend ----------------------------- 0.0030753612518310547
generate_one_block  0.0014634132385253906
generate_one_block  0.0014410018920898438
generate_one_block  0.0015025138854980469
generate_one_block  0.001371622085571289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005471706390380859
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0001583099365234375
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0011470317840576172
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0012259483337402344
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0012879371643066406
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0010759830474853516
----------------------check_connections_block total spend ----------------------------- 0.007625102996826172
generate_one_block  0.0023877620697021484
generate_one_block  0.002649545669555664
generate_one_block  0.0023555755615234375
generate_one_block  0.0022344589233398438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00072479248046875
gen group dst list time:  0.00013566017150878906
time for parepare:  0.00017571449279785156
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00038886070251464844
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.002074718475341797
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.002270936965942383
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.0021190643310546875
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.002148866653442383
----------------------check_connections_block total spend ----------------------------- 0.013255119323730469
generate_one_block  0.0032956600189208984
generate_one_block  0.0034737586975097656
generate_one_block  0.003363370895385742
generate_one_block  0.0033910274505615234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

connection checking time:  0.023955583572387695
block generation total time  0.028929710388183594
average batch blocks generation time:  0.0072324275970458984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.0748128890991211  GigaBytes
Max Memory Allocated: 0.0748128890991211  GigaBytes

torch.Size([2071, 1433])
torch.Size([1483, 32])
torch.Size([656, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.6690506935119629  GigaBytes
Max Memory Allocated: 0.711578369140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.13768768310546875  GigaBytes
Max Memory Allocated: 0.7736144065856934  GigaBytes

torch.Size([2170, 1433])
torch.Size([1606, 32])
torch.Size([788, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.7782835960388184  GigaBytes
Max Memory Allocated: 0.8232378959655762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.13782024383544922  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

torch.Size([2081, 1433])
torch.Size([1523, 32])
torch.Size([756, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.7540631294250488  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.13750314712524414  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

torch.Size([2137, 1433])
torch.Size([1512, 32])
torch.Size([671, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.751551628112793  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05500704050064087 |0.08609014749526978 |0.29900890588760376 |0.00015020370483398438 |0.24522781372070312 |0.012346267700195312 |
----------------------------------------------------------pseudo_mini_loss sum 2.8933534622192383
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18183
Number of first layer input nodes during this epoch:  8459
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.26299619674682617  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005235671997070312
random selection method range initialization spend 0.00012612342834472656
time for parepare:  7.414817810058594e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.437301635742188e-05
----------------------check_connections_block total spend ----------------------------- 0.0012362003326416016
generate_one_block  0.0012161731719970703
generate_one_block  0.0011188983917236328
generate_one_block  0.0011191368103027344
generate_one_block  0.0011076927185058594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005109310150146484
gen group dst list time:  4.57763671875e-05
time for parepare:  0.00015974044799804688
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003190040588378906
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00034928321838378906
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004191398620605469
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00044536590576171875
----------------------check_connections_block total spend ----------------------------- 0.0031385421752929688
generate_one_block  0.0014700889587402344
generate_one_block  0.0015683174133300781
generate_one_block  0.002652883529663086
generate_one_block  0.0015375614166259766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006017684936523438
gen group dst list time:  8.702278137207031e-05
time for parepare:  0.00018787384033203125
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0009503364562988281
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0010762214660644531
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00015211105346679688
r_  generation:  0.0013349056243896484
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.00122833251953125
----------------------check_connections_block total spend ----------------------------- 0.007614612579345703
generate_one_block  0.002230405807495117
generate_one_block  0.0022928714752197266
generate_one_block  0.0025446414947509766
generate_one_block  0.002411365509033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007627010345458984
gen group dst list time:  0.0001404285430908203
time for parepare:  0.00018310546875
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0004341602325439453
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.002035379409790039
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0020461082458496094
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.0023872852325439453
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0021543502807617188
----------------------check_connections_block total spend ----------------------------- 0.013414859771728516
generate_one_block  0.0036606788635253906
generate_one_block  0.003286123275756836
generate_one_block  0.003589630126953125
generate_one_block  0.0033884048461914062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.26299619674682617  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

connection checking time:  0.024168014526367188
block generation total time  0.030632972717285156
average batch blocks generation time:  0.007658243179321289
block dataloader generation time/epoch 0.09393978118896484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.2631549835205078  GigaBytes
Max Memory Allocated: 0.879401683807373  GigaBytes

torch.Size([2061, 1433])
torch.Size([1390, 32])
torch.Size([562, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8391995429992676  GigaBytes
Max Memory Allocated: 0.8803510665893555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.2622494697570801  GigaBytes
Max Memory Allocated: 0.9443850517272949  GigaBytes

torch.Size([2025, 1433])
torch.Size([1351, 32])
torch.Size([627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.8178853988647461  GigaBytes
Max Memory Allocated: 0.9443850517272949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2362060546875 GB
    Memory Allocated: 0.26317310333251953  GigaBytes
Max Memory Allocated: 0.9443850517272949  GigaBytes

torch.Size([2183, 1433])
torch.Size([1645, 32])
torch.Size([798, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.9120731353759766  GigaBytes
Max Memory Allocated: 0.956878662109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.2624654769897461  GigaBytes
Max Memory Allocated: 1.01265287399292  GigaBytes

torch.Size([2064, 1433])
torch.Size([1477, 32])
torch.Size([742, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.8589496612548828  GigaBytes
Max Memory Allocated: 1.01265287399292  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05424267053604126 |0.00286787748336792 |0.1779463291168213 |0.0001373887062072754 |0.23997807502746582 |0.014995336532592773 |
----------------------------------------------------------pseudo_mini_loss sum 2.301866292953491
Total (block generation + training)time/epoch 2.073387622833252
Training time/epoch 1.9788737297058105
Training time without block to device /epoch 1.9674022197723389
Training time without total dataloading part /epoch 1.6872425079345703
load block tensor time/epoch 0.21697068214416504
block to device time/epoch 0.01147150993347168
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17641
Number of first layer input nodes during this epoch:  8333
