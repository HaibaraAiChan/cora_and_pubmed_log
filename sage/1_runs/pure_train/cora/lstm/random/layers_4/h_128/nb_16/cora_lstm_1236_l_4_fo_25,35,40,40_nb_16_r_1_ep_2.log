main start at this time 1648431602.130745
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009415149688720703
random selection method range initialization spend 0.0001971721649169922
time for parepare:  7.963180541992188e-05
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0015211105346679688
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1696090698242188e-05
----------------------check_connections_block total spend ----------------------------- 0.0052242279052734375
generate_one_block  0.0014986991882324219
generate_one_block  0.0012559890747070312
generate_one_block  0.001247406005859375
generate_one_block  0.0012371540069580078
generate_one_block  0.0012555122375488281
generate_one_block  0.0012280941009521484
generate_one_block  0.0011522769927978516
generate_one_block  0.0010828971862792969
generate_one_block  0.0010905265808105469
generate_one_block  0.0010480880737304688
generate_one_block  0.0010504722595214844
generate_one_block  0.001047372817993164
generate_one_block  0.0009922981262207031
generate_one_block  0.0009629726409912109
generate_one_block  0.0010616779327392578
generate_one_block  0.0009481906890869141
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006029605865478516
gen group dst list time:  0.0001232624053955078
time for parepare:  0.0001838207244873047
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00021147727966308594
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00021004676818847656
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001926422119140625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00028634071350097656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.000102996826171875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00013113021850585938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013327598571777344
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001468658447265625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012493133544921875
----------------------check_connections_block total spend ----------------------------- 0.006791114807128906
generate_one_block  0.0014181137084960938
generate_one_block  0.0013871192932128906
generate_one_block  0.0014662742614746094
generate_one_block  0.0013811588287353516
generate_one_block  0.001444101333618164
generate_one_block  0.001168966293334961
generate_one_block  0.0012733936309814453
generate_one_block  0.0012476444244384766
generate_one_block  0.001027822494506836
generate_one_block  0.0010461807250976562
generate_one_block  0.0010917186737060547
generate_one_block  0.0010514259338378906
generate_one_block  0.0010638236999511719
generate_one_block  0.0010814666748046875
generate_one_block  0.0010793209075927734
generate_one_block  0.0010609626770019531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006911754608154297
gen group dst list time:  0.00020956993103027344
time for parepare:  0.0002715587615966797
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005292892456054688
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005648136138916016
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007789134979248047
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005197525024414062
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007781982421875
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005335807800292969
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0007500648498535156
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.00084686279296875
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003185272216796875
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004620552062988281
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005548000335693359
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0003457069396972656
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004076957702636719
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00040531158447265625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0003650188446044922
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003972053527832031
----------------------check_connections_block total spend ----------------------------- 0.015691757202148438
generate_one_block  0.0015993118286132812
generate_one_block  0.0015027523040771484
generate_one_block  0.0017151832580566406
generate_one_block  0.0014433860778808594
generate_one_block  0.00193023681640625
generate_one_block  0.0014834403991699219
generate_one_block  0.0016148090362548828
generate_one_block  0.0017058849334716797
generate_one_block  0.001216888427734375
generate_one_block  0.0013709068298339844
generate_one_block  0.001425027847290039
generate_one_block  0.001317739486694336
generate_one_block  0.001422882080078125
generate_one_block  0.0013689994812011719
generate_one_block  0.0013439655303955078
generate_one_block  0.0013949871063232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007402896881103516
gen group dst list time:  0.00034046173095703125
time for parepare:  0.00021123886108398438
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0011944770812988281
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0012319087982177734
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0015835762023925781
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0012447834014892578
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0015096664428710938
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0012097358703613281
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0015311241149902344
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0015902519226074219
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0007529258728027344
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0009455680847167969
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0010082721710205078
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0008513927459716797
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0009090900421142578
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0009968280792236328
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0009238719940185547
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0008885860443115234
----------------------check_connections_block total spend ----------------------------- 0.029559612274169922
generate_one_block  0.002390146255493164
generate_one_block  0.0026960372924804688
generate_one_block  0.002583026885986328
generate_one_block  0.0022661685943603516
generate_one_block  0.002501249313354492
generate_one_block  0.0022420883178710938
generate_one_block  0.002567768096923828
generate_one_block  0.0025985240936279297
generate_one_block  0.001974821090698242
generate_one_block  0.0020165443420410156
generate_one_block  0.0020766258239746094
generate_one_block  0.0019643306732177734
generate_one_block  0.002017498016357422
generate_one_block  0.0021114349365234375
generate_one_block  0.002048492431640625
generate_one_block  0.0020003318786621094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

connection checking time:  0.052042484283447266
block generation total time  0.07920098304748535
average batch blocks generation time:  0.0049500614404678345
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07318925857543945  GigaBytes
Max Memory Allocated: 0.07318925857543945  GigaBytes

torch.Size([1406, 1433])
torch.Size([682, 128])
torch.Size([236, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.37838172912597656  GigaBytes
Max Memory Allocated: 0.39008188247680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.1388545036315918  GigaBytes
Max Memory Allocated: 0.4872918128967285  GigaBytes

torch.Size([1410, 1433])
torch.Size([693, 128])
torch.Size([241, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.46187353134155273  GigaBytes
Max Memory Allocated: 0.4872918128967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.14028596878051758  GigaBytes
Max Memory Allocated: 0.5677485466003418  GigaBytes

torch.Size([1676, 1433])
torch.Size([950, 128])
torch.Size([356, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.5543427467346191  GigaBytes
Max Memory Allocated: 0.5686635971069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.13909912109375  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

torch.Size([1456, 1433])
torch.Size([694, 128])
torch.Size([214, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.46175193786621094  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.14028596878051758  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

torch.Size([1578, 1433])
torch.Size([881, 128])
torch.Size([324, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.5363636016845703  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.13930606842041016  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

torch.Size([1495, 1433])
torch.Size([706, 128])
torch.Size([240, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.4547305107116699  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.14039182662963867  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

torch.Size([1696, 1433])
torch.Size([906, 128])
torch.Size([308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.5410194396972656  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.14014101028442383  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

torch.Size([1648, 1433])
torch.Size([962, 128])
torch.Size([342, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.5625762939453125  GigaBytes
Max Memory Allocated: 0.6518597602844238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.13707637786865234  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1080, 1433])
torch.Size([444, 128])
torch.Size([116, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.3364143371582031  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.13753890991210938  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1165, 1433])
torch.Size([573, 128])
torch.Size([167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.4025435447692871  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.1388707160949707  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1237, 1433])
torch.Size([602, 128])
torch.Size([224, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.4238133430480957  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.1377120018005371  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1198, 1433])
torch.Size([534, 128])
torch.Size([175, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.38432979583740234  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.13796234130859375  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1244, 1433])
torch.Size([570, 128])
torch.Size([193, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.40530967712402344  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.1379384994506836  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1239, 1433])
torch.Size([617, 128])
torch.Size([195, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.4337005615234375  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.13795089721679688  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1242, 1433])
torch.Size([570, 128])
torch.Size([154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.4121065139770508  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.13760805130004883  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1165, 1433])
torch.Size([556, 128])
torch.Size([190, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.4009709358215332  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054236605763435364 |0.022143661975860596 |0.15730658173561096 |0.00011748075485229492 |0.187528595328331 |0.015113353729248047 |
----------------------------------------------------------pseudo_mini_loss sum 3.0674757957458496
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37317
Number of first layer input nodes during this epoch:  21935
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.26894426345825195  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005731582641601562
random selection method range initialization spend 0.00016117095947265625
time for parepare:  9.036064147949219e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0034224987030029297
generate_one_block  0.001154184341430664
generate_one_block  0.0011029243469238281
generate_one_block  0.0010578632354736328
generate_one_block  0.0012755393981933594
generate_one_block  0.0010628700256347656
generate_one_block  0.0010771751403808594
generate_one_block  0.0010535717010498047
generate_one_block  0.0010488033294677734
generate_one_block  0.0010709762573242188
generate_one_block  0.0010614395141601562
generate_one_block  0.0010514259338378906
generate_one_block  0.0010485649108886719
generate_one_block  0.0010547637939453125
generate_one_block  0.0010395050048828125
generate_one_block  0.0010523796081542969
generate_one_block  0.0010061264038085938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000637054443359375
gen group dst list time:  0.00010156631469726562
time for parepare:  0.00019359588623046875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002460479736328125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00016188621520996094
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00011539459228515625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001862049102783203
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013899803161621094
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.151199340820312e-05
----------------------check_connections_block total spend ----------------------------- 0.0063669681549072266
generate_one_block  0.0011856555938720703
generate_one_block  0.0013432502746582031
generate_one_block  0.0012557506561279297
generate_one_block  0.0011668205261230469
generate_one_block  0.0011668205261230469
generate_one_block  0.001256704330444336
generate_one_block  0.0011410713195800781
generate_one_block  0.0010938644409179688
generate_one_block  0.0011546611785888672
generate_one_block  0.0011806488037109375
generate_one_block  0.0010907649993896484
generate_one_block  0.0010213851928710938
generate_one_block  0.0011742115020751953
generate_one_block  0.0011205673217773438
generate_one_block  0.0011343955993652344
generate_one_block  0.001007080078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007636547088623047
gen group dst list time:  0.0001857280731201172
time for parepare:  0.0002372264862060547
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00040340423583984375
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0003638267517089844
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0007660388946533203
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006427764892578125
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0004050731658935547
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.000446319580078125
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0005514621734619141
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003681182861328125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004372596740722656
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005931854248046875
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0007534027099609375
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0004246234893798828
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0005047321319580078
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0006167888641357422
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0005910396575927734
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00018215179443359375
----------------------check_connections_block total spend ----------------------------- 0.015189170837402344
generate_one_block  0.0015745162963867188
generate_one_block  0.001985311508178711
generate_one_block  0.0016851425170898438
generate_one_block  0.0014586448669433594
generate_one_block  0.001527547836303711
generate_one_block  0.0015490055084228516
generate_one_block  0.0013573169708251953
generate_one_block  0.0014317035675048828
generate_one_block  0.0017476081848144531
generate_one_block  0.0018315315246582031
generate_one_block  0.001459360122680664
generate_one_block  0.0011684894561767578
generate_one_block  0.0015370845794677734
generate_one_block  0.0016453266143798828
generate_one_block  0.0016360282897949219
generate_one_block  0.00115203857421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007777214050292969
gen group dst list time:  0.00037217140197753906
time for parepare:  0.00021719932556152344
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00036215782165527344
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.0010249614715576172
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0017018318176269531
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0014705657958984375
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0012307167053222656
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0012273788452148438
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0013561248779296875
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0009763240814208984
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0009846687316894531
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0014452934265136719
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0017786026000976562
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00014138221740722656
r_  generation:  0.0011525154113769531
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0005252361297607422
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0012102127075195312
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.001367807388305664
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.001390695571899414
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0005249977111816406
----------------------check_connections_block total spend ----------------------------- 0.031725406646728516
generate_one_block  0.0023267269134521484
generate_one_block  0.002830982208251953
generate_one_block  0.0025763511657714844
generate_one_block  0.002365589141845703
generate_one_block  0.0023038387298583984
generate_one_block  0.003153562545776367
generate_one_block  0.0020248889923095703
generate_one_block  0.0020880699157714844
generate_one_block  0.0025832653045654297
generate_one_block  0.002975940704345703
generate_one_block  0.002413034439086914
generate_one_block  0.0016543865203857422
generate_one_block  0.0024733543395996094
generate_one_block  0.002660512924194336
generate_one_block  0.0026810169219970703
generate_one_block  0.0015871524810791016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.26894426345825195  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

connection checking time:  0.053281545639038086
block generation total time  0.0819389820098877
average batch blocks generation time:  0.005121186375617981
block dataloader generation time/epoch 0.23102617263793945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.26917362213134766  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1232, 1433])
torch.Size([561, 128])
torch.Size([176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.5298047065734863  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9276123046875 GB
    Memory Allocated: 0.2712736129760742  GigaBytes
Max Memory Allocated: 0.6570062637329102  GigaBytes

torch.Size([1620, 1433])
torch.Size([979, 128])
torch.Size([389, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.7112770080566406  GigaBytes
Max Memory Allocated: 0.723757266998291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.2709684371948242  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1565, 1433])
torch.Size([849, 128])
torch.Size([335, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6410465240478516  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.2704124450683594  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1463, 1433])
torch.Size([697, 128])
torch.Size([194, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5804963111877441  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.26948022842407227  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1288, 1433])
torch.Size([655, 128])
torch.Size([209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5782985687255859  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.27057504653930664  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1492, 1433])
torch.Size([750, 128])
torch.Size([254, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.6150598526000977  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.269472599029541  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1155, 1433])
torch.Size([526, 128])
torch.Size([168, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5096988677978516  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.2687973976135254  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1161, 1433])
torch.Size([529, 128])
torch.Size([206, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.5258316993713379  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.2710537910461426  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1581, 1433])
torch.Size([831, 128])
torch.Size([265, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.645500659942627  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.27237939834594727  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

torch.Size([1827, 1433])
torch.Size([1074, 128])
torch.Size([365, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7444849014282227  GigaBytes
Max Memory Allocated: 0.8053412437438965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.2710442543029785  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

torch.Size([1508, 1433])
torch.Size([688, 128])
torch.Size([225, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.5892014503479004  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.26715850830078125  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

torch.Size([857, 1433])
torch.Size([317, 128])
torch.Size([86, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.4087519645690918  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.27104806900024414  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

torch.Size([1484, 1433])
torch.Size([733, 128])
torch.Size([260, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.6155791282653809  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.27124691009521484  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

torch.Size([1617, 1433])
torch.Size([855, 128])
torch.Size([282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.664644718170166  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.2716045379638672  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

torch.Size([1684, 1433])
torch.Size([900, 128])
torch.Size([296, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.6691818237304688  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.26653194427490234  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

torch.Size([740, 1433])
torch.Size([301, 128])
torch.Size([82, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.40079545974731445  GigaBytes
Max Memory Allocated: 0.8392119407653809  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05644075572490692 |0.0005973875522613525 |0.1263616681098938 |0.00011372566223144531 |0.18017031252384186 |0.013901948928833008 |
----------------------------------------------------------pseudo_mini_loss sum 2.7469842433929443
Total (block generation + training)time/epoch 6.1257054805755615
Training time/epoch 5.894401550292969
Training time without block to device /epoch 5.884843349456787
Training time without total dataloading part /epoch 4.920233249664307
load block tensor time/epoch 0.9030520915985107
block to device time/epoch 0.00955820083618164
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  38078
Number of first layer input nodes during this epoch:  22274
