main start at this time 1648431572.5147102
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011363029479980469
random selection method range initialization spend 0.0001823902130126953
time for parepare:  7.581710815429688e-05
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0020990371704101562
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.866455078125e-05
----------------------check_connections_block total spend ----------------------------- 0.0034427642822265625
generate_one_block  0.0014679431915283203
generate_one_block  0.0011608600616455078
generate_one_block  0.001155853271484375
generate_one_block  0.0011103153228759766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005161762237548828
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.00015020370483398438
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0004165172576904297
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005574226379394531
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003447532653808594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003485679626464844
----------------------check_connections_block total spend ----------------------------- 0.003267526626586914
generate_one_block  0.0015447139739990234
generate_one_block  0.0017032623291015625
generate_one_block  0.0014231204986572266
generate_one_block  0.0014476776123046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.0001850128173828125
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0002868175506591797
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0012993812561035156
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0015714168548583984
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0010433197021484375
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0011138916015625
----------------------check_connections_block total spend ----------------------------- 0.008168220520019531
generate_one_block  0.002681255340576172
generate_one_block  0.0028600692749023438
generate_one_block  0.002170085906982422
generate_one_block  0.0021047592163085938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007154941558837891
gen group dst list time:  0.00014019012451171875
time for parepare:  0.00019216537475585938
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0004429817199707031
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.002439260482788086
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.0003294944763183594
mini_batch_src_global generation:  0.00027179718017578125
r_  generation:  0.0026502609252929688
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0021309852600097656
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.002216339111328125
----------------------check_connections_block total spend ----------------------------- 0.01448202133178711
generate_one_block  0.0037374496459960938
generate_one_block  0.003575563430786133
generate_one_block  0.003094911575317383
generate_one_block  0.0032088756561279297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

connection checking time:  0.025917768478393555
block generation total time  0.02955174446105957
average batch blocks generation time:  0.007387936115264893
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07745838165283203  GigaBytes
Max Memory Allocated: 0.07745838165283203  GigaBytes

torch.Size([2145, 1433])
torch.Size([1569, 128])
torch.Size([744, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.7402033805847168  GigaBytes
Max Memory Allocated: 0.753319263458252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.14265823364257812  GigaBytes
Max Memory Allocated: 0.8145451545715332  GigaBytes

torch.Size([2232, 1433])
torch.Size([1728, 128])
torch.Size([901, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8633337020874023  GigaBytes
Max Memory Allocated: 0.8700108528137207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.14112615585327148  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

torch.Size([1950, 1433])
torch.Size([1323, 128])
torch.Size([566, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.7158627510070801  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2030029296875 GB
    Memory Allocated: 0.14144325256347656  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

torch.Size([2009, 1433])
torch.Size([1383, 128])
torch.Size([587, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.7390060424804688  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.053839921951293945 |0.08548957109451294 |0.2933471202850342 |0.00016766786575317383 |0.24722886085510254 |0.014539480209350586 |
----------------------------------------------------------pseudo_mini_loss sum 3.276266574859619
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17865
Number of first layer input nodes during this epoch:  8336
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.2728567123413086  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000530242919921875
random selection method range initialization spend 0.00012803077697753906
time for parepare:  7.843971252441406e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.771087646484375e-05
----------------------check_connections_block total spend ----------------------------- 0.001329660415649414
generate_one_block  0.001251220703125
generate_one_block  0.0011782646179199219
generate_one_block  0.0011625289916992188
generate_one_block  0.0011434555053710938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005233287811279297
gen group dst list time:  4.792213439941406e-05
time for parepare:  0.00016498565673828125
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00045990943908691406
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004410743713378906
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004563331604003906
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.000408172607421875
----------------------check_connections_block total spend ----------------------------- 0.0035986900329589844
generate_one_block  0.0017151832580566406
generate_one_block  0.0017614364624023438
generate_one_block  0.0016341209411621094
generate_one_block  0.0015561580657958984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  9.012222290039062e-05
time for parepare:  0.00019407272338867188
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.001463174819946289
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0012645721435546875
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.001363992691040039
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0012307167053222656
----------------------check_connections_block total spend ----------------------------- 0.009807348251342773
generate_one_block  0.0028891563415527344
generate_one_block  0.002576589584350586
generate_one_block  0.002452850341796875
generate_one_block  0.002302885055541992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007109642028808594
gen group dst list time:  0.00015497207641601562
time for parepare:  0.0001990795135498047
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0004227161407470703
mini_batch_src_global generation:  0.0002105236053466797
r_  generation:  0.002583742141723633
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0023279190063476562
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.0024759769439697266
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0023603439331054688
----------------------check_connections_block total spend ----------------------------- 0.015067815780639648
generate_one_block  0.0041429996490478516
generate_one_block  0.0034084320068359375
generate_one_block  0.0035347938537597656
generate_one_block  0.0034437179565429688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.2728567123413086  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

connection checking time:  0.028473854064941406
block generation total time  0.0314183235168457
average batch blocks generation time:  0.007854580879211426
block dataloader generation time/epoch 0.09489631652832031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.2737312316894531  GigaBytes
Max Memory Allocated: 0.923090934753418  GigaBytes

torch.Size([2184, 1433])
torch.Size([1624, 128])
torch.Size([819, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.9536762237548828  GigaBytes
Max Memory Allocated: 0.964017391204834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.2729315757751465  GigaBytes
Max Memory Allocated: 1.0206217765808105  GigaBytes

torch.Size([2047, 1433])
torch.Size([1453, 128])
torch.Size([680, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.9029245376586914  GigaBytes
Max Memory Allocated: 1.0206217765808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.2737283706665039  GigaBytes
Max Memory Allocated: 1.0206217765808105  GigaBytes

torch.Size([2171, 1433])
torch.Size([1575, 128])
torch.Size([753, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.9292521476745605  GigaBytes
Max Memory Allocated: 1.0206217765808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.27343273162841797  GigaBytes
Max Memory Allocated: 1.0206217765808105  GigaBytes

torch.Size([2141, 1433])
torch.Size([1487, 128])
torch.Size([675, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.904813289642334  GigaBytes
Max Memory Allocated: 1.0206217765808105  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05401700735092163 |0.000816643238067627 |0.18194985389709473 |0.00015163421630859375 |0.24802011251449585 |0.015194892883300781 |
----------------------------------------------------------pseudo_mini_loss sum 2.4043943881988525
Total (block generation + training)time/epoch 2.11311411857605
Training time/epoch 2.0178732872009277
Training time without block to device /epoch 2.0146067142486572
Training time without total dataloading part /epoch 1.7356812953948975
load block tensor time/epoch 0.21606802940368652
block to device time/epoch 0.003266572952270508
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18346
Number of first layer input nodes during this epoch:  8543
