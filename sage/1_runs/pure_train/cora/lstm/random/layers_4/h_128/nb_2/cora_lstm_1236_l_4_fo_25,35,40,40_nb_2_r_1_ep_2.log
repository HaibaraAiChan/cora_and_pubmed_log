main start at this time 1648431561.0865755
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011050701141357422
random selection method range initialization spend 0.00018334388732910156
time for parepare:  8.034706115722656e-05
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0017948150634765625
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001442432403564453
----------------------check_connections_block total spend ----------------------------- 0.0027866363525390625
generate_one_block  0.002239704132080078
generate_one_block  0.0015196800231933594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006072521209716797
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00020170211791992188
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00013494491577148438
r_  generation:  0.0009632110595703125
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0006957054138183594
----------------------check_connections_block total spend ----------------------------- 0.0031671524047851562
generate_one_block  0.002567768096923828
generate_one_block  0.0020961761474609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007090568542480469
gen group dst list time:  7.224082946777344e-05
time for parepare:  0.00022649765014648438
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.0004360675811767578
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.002448558807373047
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.0018835067749023438
----------------------check_connections_block total spend ----------------------------- 0.007026195526123047
generate_one_block  0.004061698913574219
generate_one_block  0.0033981800079345703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007970333099365234
gen group dst list time:  0.00011444091796875
time for parepare:  0.00024318695068359375
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.0005888938903808594
mini_batch_src_global generation:  0.00029969215393066406
r_  generation:  0.0036203861236572266
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.00038695335388183594
mini_batch_src_global generation:  0.00036144256591796875
r_  generation:  0.0032138824462890625
----------------------check_connections_block total spend ----------------------------- 0.010821104049682617
generate_one_block  0.004902362823486328
generate_one_block  0.0037717819213867188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

connection checking time:  0.02101445198059082
block generation total time  0.0207979679107666
average batch blocks generation time:  0.0103989839553833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1600341796875 GB
    Memory Allocated: 0.07823514938354492  GigaBytes
Max Memory Allocated: 0.07823514938354492  GigaBytes

torch.Size([2334, 1433])
torch.Size([1975, 128])
torch.Size([1237, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1444091796875 GB
    Memory Allocated: 0.8821372985839844  GigaBytes
Max Memory Allocated: 0.8823938369750977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 0.14246654510498047  GigaBytes
Max Memory Allocated: 0.9249868392944336  GigaBytes

torch.Size([2196, 1433])
torch.Size([1700, 128])
torch.Size([869, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2791748046875 GB
    Memory Allocated: 0.8513741493225098  GigaBytes
Max Memory Allocated: 0.9249868392944336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0424882173538208 |0.1754544973373413 |0.43793177604675293 |0.00019228458404541016 |0.2649538516998291 |0.014783859252929688 |
----------------------------------------------------------pseudo_mini_loss sum 3.1063947677612305
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10995
Number of first layer input nodes during this epoch:  4530
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4354248046875 GB
    Memory Allocated: 0.27327442169189453  GigaBytes
Max Memory Allocated: 0.9249868392944336  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004696846008300781
random selection method range initialization spend 0.00011539459228515625
time for parepare:  7.033348083496094e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001285076141357422
----------------------check_connections_block total spend ----------------------------- 0.0008933544158935547
generate_one_block  0.0013270378112792969
generate_one_block  0.0011899471282958984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004763603210449219
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.0001621246337890625
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0007004737854003906
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0006778240203857422
----------------------check_connections_block total spend ----------------------------- 0.0026397705078125
generate_one_block  0.0019023418426513672
generate_one_block  0.0018734931945800781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006232261657714844
gen group dst list time:  5.841255187988281e-05
time for parepare:  0.00018930435180664062
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.0018460750579833984
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00021791458129882812Using backend: pytorch

r_  generation:  0.0016345977783203125
----------------------check_connections_block total spend ----------------------------- 0.007025241851806641
generate_one_block  0.003163576126098633
generate_one_block  0.0030059814453125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006270408630371094
gen group dst list time:  8.940696716308594e-05
time for parepare:  0.00018405914306640625
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.00042366981506347656
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0025930404663085938
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.00028228759765625
r_  generation:  0.0026628971099853516
----------------------check_connections_block total spend ----------------------------- 0.0084381103515625
generate_one_block  0.004037141799926758
generate_one_block  0.0039060115814208984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4354248046875 GB
    Memory Allocated: 0.27327442169189453  GigaBytes
Max Memory Allocated: 0.9249868392944336  GigaBytes

connection checking time:  0.01810312271118164
block generation total time  0.017888545989990234
average batch blocks generation time:  0.008944272994995117
block dataloader generation time/epoch 0.0596010684967041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4354248046875 GB
    Memory Allocated: 0.27364110946655273  GigaBytes
Max Memory Allocated: 0.9249868392944336  GigaBytes

torch.Size([2295, 1433])
torch.Size([1904, 128])
torch.Size([1167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4881591796875 GB
    Memory Allocated: 1.0557985305786133  GigaBytes
Max Memory Allocated: 1.056035041809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 0.27369260787963867  GigaBytes
Max Memory Allocated: 1.10075044631958  GigaBytes

torch.Size([2305, 1433])
torch.Size([1905, 128])
torch.Size([1084, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4901123046875 GB
    Memory Allocated: 1.0475282669067383  GigaBytes
Max Memory Allocated: 1.10075044631958  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03831076622009277 |0.0006705522537231445 |0.20232617855072021 |0.0001468658447265625 |0.2664874792098999 |0.014602422714233398 |
----------------------------------------------------------pseudo_mini_loss sum 2.5332388877868652
Total (block generation + training)time/epoch 1.1528785228729248
Training time/epoch 1.0930678844451904
Training time without block to device /epoch 1.0917267799377441
Training time without total dataloading part /epoch 0.9525234699249268
load block tensor time/epoch 0.07662153244018555
block to device time/epoch 0.001341104507446289
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11363
Number of first layer input nodes during this epoch:  4600
