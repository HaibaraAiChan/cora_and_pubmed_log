main start at this time 1648431386.8517594
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014472007751464844
random selection method range initialization spend 0.00018715858459472656
time for parepare:  6.4849853515625e-05
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.001971006393432617
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.435943603515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0032203197479248047
generate_one_block  0.0014889240264892578
generate_one_block  0.0010981559753417969
generate_one_block  0.0011327266693115234
generate_one_block  0.0010917186737060547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005085468292236328
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.00013589859008789062
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003724098205566406
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004401206970214844
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00042891502380371094
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00037598609924316406
----------------------check_connections_block total spend ----------------------------- 0.003133058547973633
generate_one_block  0.001476287841796875
generate_one_block  0.0015003681182861328
generate_one_block  0.001554250717163086
generate_one_block  0.0014216899871826172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005640983581542969
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.00017189979553222656
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0011138916015625
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.001226186752319336
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0012941360473632812
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0012025833129882812
----------------------check_connections_block total spend ----------------------------- 0.007885456085205078
generate_one_block  0.002437591552734375
generate_one_block  0.0024869441986083984
generate_one_block  0.002451181411743164
generate_one_block  0.0022983551025390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007309913635253906
gen group dst list time:  0.00013113021850585938
time for parepare:  0.00018596649169921875
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.002153158187866211
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0023543834686279297
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.002354145050048828
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0022988319396972656
----------------------check_connections_block total spend ----------------------------- 0.013860464096069336
generate_one_block  0.003503084182739258
generate_one_block  0.0034093856811523438
generate_one_block  0.003386974334716797
generate_one_block  0.0033643245697021484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

connection checking time:  0.024878978729248047
block generation total time  0.029290437698364258
average batch blocks generation time:  0.0073226094245910645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07455730438232422  GigaBytes
Max Memory Allocated: 0.07455730438232422  GigaBytes

torch.Size([2033, 1433])
torch.Size([1409, 16])
torch.Size([644, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.6507234573364258  GigaBytes
Max Memory Allocated: 0.6957440376281738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9940185546875 GB
    Memory Allocated: 0.1369795799255371  GigaBytes
Max Memory Allocated: 0.7598953247070312  GigaBytes

torch.Size([2132, 1433])
torch.Size([1537, 16])
torch.Size([735, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.7577919960021973  GigaBytes
Max Memory Allocated: 0.8057770729064941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.13731670379638672  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

torch.Size([2146, 1433])
torch.Size([1560, 16])
torch.Size([757, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.7577486038208008  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1268310546875 GB
    Memory Allocated: 0.13679933547973633  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

torch.Size([2099, 1433])
torch.Size([1527, 16])
torch.Size([718, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.750457763671875  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055806100368499756 |0.08830589056015015 |0.29072028398513794 |0.00015980005264282227 |0.23707783222198486 |0.014816522598266602 |
----------------------------------------------------------pseudo_mini_loss sum 2.5930044651031494
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18039
Number of first layer input nodes during this epoch:  8410
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.26244401931762695  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000507354736328125
random selection method range initialization spend 0.00012969970703125
time for parepare:  7.534027099609375e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0013082027435302734
generate_one_block  0.0012240409851074219
generate_one_block  0.0011250972747802734
generate_one_block  0.0011196136474609375
generate_one_block  0.001096487045288086
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000514984130859375
gen group dst list time:  4.553794860839844e-05
time for parepare:  0.0001583099365234375
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004792213439941406
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00035572052001953125
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00041866302490234375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004107952117919922
----------------------check_connections_block total spend ----------------------------- 0.0033419132232666016
generate_one_block  0.001720428466796875
generate_one_block  0.0016396045684814453
generate_one_block  0.0016412734985351562
generate_one_block  0.0015490055084228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005934238433837891
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.00018525123596191406
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.001360177993774414
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0011353492736816406
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0012505054473876953
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0012881755828857422
----------------------check_connections_block total spend ----------------------------- 0.00828409194946289
generate_one_block  0.0027399063110351562
generate_one_block  0.0024492740631103516
generate_one_block  0.0024542808532714844
generate_one_block  0.0024666786193847656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007281303405761719
gen group dst list time:  0.000141143798828125
time for parepare:  0.00019288063049316406
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00039696693420410156
mini_batch_src_global generation:  0.0001876354217529297
r_  generation:  0.0024199485778808594
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00028133392333984375
mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.002206563949584961
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.0022737979888916016
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.0002892017364501953
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0023653507232666016
----------------------check_connections_block total spend ----------------------------- 0.014379739761352539
generate_one_block  0.004000425338745117
generate_one_block  0.003475189208984375
generate_one_block  0.003476858139038086
generate_one_block  0.003549814224243164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.26244401931762695  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

connection checking time:  0.02600574493408203
block generation total time  0.031162738800048828
average batch blocks generation time:  0.007790684700012207
block dataloader generation time/epoch 0.09214663505554199
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.2628154754638672  GigaBytes
Max Memory Allocated: 0.8653969764709473  GigaBytes

torch.Size([2150, 1433])
torch.Size([1618, 16])
torch.Size([774, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.8960838317871094  GigaBytes
Max Memory Allocated: 0.9452648162841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 0.2624030113220215  GigaBytes
Max Memory Allocated: 1.0027375221252441  GigaBytes

torch.Size([2120, 1433])
torch.Size([1470, 16])
torch.Size([666, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 0.852078914642334  GigaBytes
Max Memory Allocated: 1.0027375221252441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 0.26281070709228516  GigaBytes
Max Memory Allocated: 1.0027375221252441  GigaBytes

torch.Size([2102, 1433])
torch.Size([1527, 16])
torch.Size([732, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2869873046875 GB
    Memory Allocated: 0.8680863380432129  GigaBytes
Max Memory Allocated: 1.0027375221252441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2869873046875 GB
    Memory Allocated: 0.2625875473022461  GigaBytes
Max Memory Allocated: 1.0027375221252441  GigaBytes

torch.Size([2153, 1433])
torch.Size([1567, 16])
torch.Size([742, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2869873046875 GB
    Memory Allocated: 0.887721061706543  GigaBytes
Max Memory Allocated: 1.0027375221252441  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052470386028289795 |0.0007158517837524414 |0.17898237705230713 |0.00013244152069091797 |0.2404879331588745 |0.010433435440063477 |
----------------------------------------------------------pseudo_mini_loss sum 2.2939839363098145
Total (block generation + training)time/epoch 2.0580954551696777
Training time/epoch 1.9656283855438232
Training time without block to device /epoch 1.9627649784088135
Training time without total dataloading part /epoch 1.6888444423675537
load block tensor time/epoch 0.20988154411315918
block to device time/epoch 0.0028634071350097656
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18352
Number of first layer input nodes during this epoch:  8525
