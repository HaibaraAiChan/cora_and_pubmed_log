main start at this time 1648432985.8813841
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001458883285522461
range selection method range initialization spend 0.0001232624053955078
time for parepare:  0.00011920928955078125
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0026421546936035156
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00036454200744628906
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  6.961822509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.006676435470581055
generate_one_block  0.0033419132232666016
generate_one_block  0.0021164417266845703
generate_one_block  0.0020380020141601562
generate_one_block  0.0020291805267333984
generate_one_block  0.002002716064453125
generate_one_block  0.0014259815216064453
generate_one_block  0.0014116764068603516
generate_one_block  0.0013680458068847656
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008792877197265625
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.00025343894958496094
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00029015541076660156
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00034689903259277344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00027179718017578125
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00036215782165527344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003032684326171875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003616809844970703
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002994537353515625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001475811004638672
----------------------check_connections_block total spend ----------------------------- 0.005315065383911133
generate_one_block  0.0012235641479492188
generate_one_block  0.0012865066528320312
generate_one_block  0.0012056827545166016
generate_one_block  0.0012743473052978516
generate_one_block  0.0012476444244384766
generate_one_block  0.0013418197631835938
generate_one_block  0.001360177993774414
generate_one_block  0.0011639595031738281
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006771087646484375
gen group dst list time:  9.703636169433594e-05
time for parepare:  0.00017690658569335938
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0006339550018310547
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0008213520050048828
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0006277561187744141
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007925033569335938
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0007171630859375
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0009543895721435547
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0008518695831298828
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0004925727844238281
----------------------check_connections_block total spend ----------------------------- 0.010107755661010742
generate_one_block  0.0017626285552978516
generate_one_block  0.0019774436950683594
generate_one_block  0.0017457008361816406
generate_one_block  0.001882791519165039
generate_one_block  0.0017859935760498047
generate_one_block  0.002129793167114258
generate_one_block  0.0019314289093017578
generate_one_block  0.0014719963073730469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007917881011962891
gen group dst list time:  0.0001876354217529297
time for parepare:  0.00018525123596191406
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0003867149353027344
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0014929771423339844
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0019459724426269531
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.0001728534698486328
r_  generation:  0.0016665458679199219
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0017316341400146484
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0016634464263916016
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0020117759704589844
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.001800537109375
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0010633468627929688
----------------------check_connections_block total spend ----------------------------- 0.02085089683532715
generate_one_block  0.0027129650115966797
generate_one_block  0.0030584335327148438
generate_one_block  0.002804994583129883
generate_one_block  0.0028443336486816406
generate_one_block  0.0029387474060058594
generate_one_block  0.0034008026123046875
generate_one_block  0.0030143260955810547
generate_one_block  0.0021855831146240234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007832050323486328
gen group dst list time:  0.0003204345703125
time for parepare:  0.00019812583923339844
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.0004317760467529297
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.0024459362030029297
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.0002961158752441406
r_  generation:  0.002744436264038086
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.0026276111602783203
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.002594470977783203
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0025675296783447266
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.00031757354736328125
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.002732515335083008
local_output_nid generation:  0.00016188621520996094
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.0025870800018310547
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.0019371509552001953
----------------------check_connections_block total spend ----------------------------- 0.030823707580566406
generate_one_block  0.0036432743072509766
generate_one_block  0.0038497447967529297
generate_one_block  0.004503011703491211
generate_one_block  0.004174470901489258
generate_one_block  0.003758668899536133
generate_one_block  0.0038518905639648438
generate_one_block  0.003850221633911133
generate_one_block  0.0032198429107666016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.06709742546081543
block generation total time  0.07860279083251953
average batch blocks generation time:  0.009825348854064941
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1600341796875 GB
    Memory Allocated: 0.07820320129394531  GigaBytes
Max Memory Allocated: 0.07820320129394531  GigaBytes

torch.Size([2216, 1433])
torch.Size([1677, 128])
torch.Size([958, 128])
torch.Size([361, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7752256393432617  GigaBytes
Max Memory Allocated: 0.7752799987792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.14422178268432617  GigaBytes
Max Memory Allocated: 0.8336238861083984  GigaBytes

torch.Size([2289, 1433])
torch.Size([1935, 128])
torch.Size([1230, 128])
torch.Size([450, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.9444589614868164  GigaBytes
Max Memory Allocated: 0.9445276260375977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.14405059814453125  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([2260, 1433])
torch.Size([1827, 128])
torch.Size([1046, 128])
torch.Size([356, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8957180976867676  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.14384889602661133  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([2221, 1433])
torch.Size([1803, 128])
torch.Size([1100, 128])
torch.Size([438, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8891034126281738  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.14353370666503906  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([2163, 1433])
torch.Size([1756, 128])
torch.Size([1029, 128])
torch.Size([406, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.8733396530151367  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.14411306381225586  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([2268, 1433])
torch.Size([1931, 128])
torch.Size([1286, 128])
torch.Size([563, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2889404296875 GB
    Memory Allocated: 0.9481053352355957  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.14424943923950195  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([2294, 1433])
torch.Size([1930, 128])
torch.Size([1231, 128])
torch.Size([490, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.9439520835876465  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.14259052276611328  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([1992, 1433])
torch.Size([1370, 128])
torch.Size([656, 128])
torch.Size([258, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 0.7295265197753906  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05853062868118286 |0.04336273670196533 |0.2727195918560028 |0.00013267993927001953 |0.30149006843566895 |0.01777338981628418 |
----------------------------------------------------------pseudo_mini_loss sum 3.151503324508667
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  44535
Number of first layer input nodes during this epoch:  17703
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.2752523422241211  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005576610565185547
range selection method range initialization spend 7.271766662597656e-05
time for parepare:  8.225440979003906e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.0020227432250976562
generate_one_block  0.0012378692626953125
generate_one_block  0.0011162757873535156
generate_one_block  0.0011181831359863281
generate_one_block  0.001096963882446289
generate_one_block  0.0010976791381835938
generate_one_block  0.0010848045349121094
generate_one_block  0.0010802745819091797
generate_one_block  0.001085042953491211
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005238056182861328
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.00018739700317382812
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002849102020263672
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002567768096923828
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00024509429931640625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002567768096923828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002262592315673828
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00022530555725097656
----------------------check_connections_block total spend ----------------------------- 0.004467487335205078
generate_one_block  0.0014529228210449219
generate_one_block  0.0013134479522705078
generate_one_block  0.001359701156616211
generate_one_block  0.0014128684997558594
generate_one_block  0.0013508796691894531
generate_one_block  0.0012996196746826172
generate_one_block  0.0013759136199951172
generate_one_block  0.0012888908386230469
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007243156433105469
gen group dst list time:  0.00011849403381347656
time for parepare:  0.00021696090698242188
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0003159046173095703
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0009331703186035156
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0006983280181884766
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0008611679077148438
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0007760524749755859
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0008268356323242188
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.00074005126953125
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0008256435394287109
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0007562637329101562
----------------------check_connections_block total spend ----------------------------- 0.011300086975097656
generate_one_block  0.0022830963134765625
generate_one_block  0.0018677711486816406
generate_one_block  0.0020122528076171875
generate_one_block  0.001888275146484375
generate_one_block  0.001969575881958008
generate_one_block  0.0018362998962402344
generate_one_block  0.0019555091857910156
generate_one_block  0.0018694400787353516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007872581481933594
gen group dst list time:  0.0002186298370361328
time for parepare:  0.0002167224884033203
local_output_nid generation:  0.00011348724365234375
local_in_edges_tensor generation:  0.0004203319549560547
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0020287036895751953
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.001592397689819336
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.001953601837158203
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0017201900482177734
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0018091201782226562
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.001758575439453125
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0017971992492675781
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0016415119171142578
----------------------check_connections_block total spend ----------------------------- 0.022841930389404297
generate_one_block  0.003395557403564453
generate_one_block  0.0027692317962646484
generate_one_block  0.003147602081298828
generate_one_block  0.0028829574584960938
generate_one_block  0.003046274185180664
generate_one_block  0.0029234886169433594
generate_one_block  0.0031669139862060547
generate_one_block  0.0029180049896240234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007829666137695312
gen group dst list time:  0.00040721893310546875
time for parepare:  0.00022912025451660156
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.00046181678771972656
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0028162002563476562
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.002415895462036133
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0028717517852783203
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.002678394317626953
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003249645233154297
mini_batch_src_global generation:  0.0002448558807373047
r_  generation:  0.0025489330291748047
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0024526119232177734
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0026979446411132812
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.0002231597900390625
r_  generation:  0.0024530887603759766
----------------------check_connections_block total spend ----------------------------- 0.031880855560302734
generate_one_block  0.004203319549560547
generate_one_block  0.003598928451538086
generate_one_block  0.003957986831665039
generate_one_block  0.0038535594940185547
generate_one_block  0.004090309143066406
generate_one_block  0.003720998764038086
generate_one_block  0.004349231719970703
generate_one_block  0.003857851028442383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.2752523422241211  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

connection checking time:  0.07049036026000977
block generation total time  0.08241868019104004
average batch blocks generation time:  0.010302335023880005
block dataloader generation time/epoch 0.23264169692993164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.276644229888916  GigaBytes
Max Memory Allocated: 0.9797005653381348  GigaBytes

torch.Size([2273, 1433])
torch.Size([1926, 128])
torch.Size([1228, 128])
torch.Size([483, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.0653085708618164  GigaBytes
Max Memory Allocated: 1.0653858184814453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.2754025459289551  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

torch.Size([2045, 1433])
torch.Size([1600, 128])
torch.Size([942, 128])
torch.Size([338, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.947535514831543  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.2766256332397461  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

torch.Size([2270, 1433])
torch.Size([1885, 128])
torch.Size([1177, 128])
torch.Size([446, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 1.058389663696289  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.276395320892334  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

torch.Size([2229, 1433])
torch.Size([1780, 128])
torch.Size([1028, 128])
torch.Size([422, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 1.0166139602661133  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.27648115158081055  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

torch.Size([2244, 1433])
torch.Size([1793, 128])
torch.Size([1094, 128])
torch.Size([423, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 1.0202808380126953  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.2758755683898926  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

torch.Size([2132, 1433])
torch.Size([1708, 128])
torch.Size([1024, 128])
torch.Size([381, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.9911646842956543  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4158935546875 GB
    Memory Allocated: 0.2770695686340332  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

torch.Size([2353, 1433])
torch.Size([1991, 128])
torch.Size([1177, 128])
torch.Size([470, 128])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.088904857635498  GigaBytes
Max Memory Allocated: 1.099194049835205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.2761507034301758  GigaBytes
Max Memory Allocated: 1.1262516975402832  GigaBytes

torch.Size([2183, 1433])
torch.Size([1782, 128])
torch.Size([1066, 128])
torch.Size([408, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.0207796096801758  GigaBytes
Max Memory Allocated: 1.1262516975402832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061814457178115845 |0.0009456276893615723 |0.21915894746780396 |0.00012415647506713867 |0.30624717473983765 |0.013856649398803711 |
----------------------------------------------------------pseudo_mini_loss sum 2.495704412460327
Total (block generation + training)time/epoch 5.020441770553589
Training time/epoch 4.787553071975708
Training time without block to device /epoch 4.779988050460815
Training time without total dataloading part /epoch 4.218098878860474
load block tensor time/epoch 0.49451565742492676
block to device time/epoch 0.007565021514892578
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45057
Number of first layer input nodes during this epoch:  17729
