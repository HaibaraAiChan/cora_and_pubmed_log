main start at this time 1648433004.761947
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013375282287597656
range selection method range initialization spend 0.00011277198791503906
time for parepare:  0.00010061264038085938
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0019063949584960938
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.4080276489257812e-05
----------------------check_connections_block total spend ----------------------------- 0.0061397552490234375
generate_one_block  0.0015635490417480469
generate_one_block  0.0013282299041748047
generate_one_block  0.0012614727020263672
generate_one_block  0.0012462139129638672
generate_one_block  0.0012264251708984375
generate_one_block  0.0012335777282714844
generate_one_block  0.0011675357818603516
generate_one_block  0.0009684562683105469
generate_one_block  0.0009632110595703125
generate_one_block  0.0010669231414794922
generate_one_block  0.0009760856628417969
generate_one_block  0.0009610652923583984
generate_one_block  0.0009593963623046875
generate_one_block  0.0009586811065673828
generate_one_block  0.0009832382202148438
generate_one_block  0.0009434223175048828
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005791187286376953
gen group dst list time:  0.00012493133544921875
time for parepare:  0.00021314620971679688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001647472381591797
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00016355514526367188
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002505779266357422
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00019240379333496094
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0002837181091308594
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0001709461212158203
----------------------check_connections_block total spend ----------------------------- 0.007587909698486328
generate_one_block  0.0029256343841552734
generate_one_block  0.0025064945220947266
generate_one_block  0.002423524856567383
generate_one_block  0.0024399757385253906
generate_one_block  0.0020904541015625
generate_one_block  0.0015552043914794922
generate_one_block  0.0015187263488769531
generate_one_block  0.0017311573028564453
generate_one_block  0.0015645027160644531
generate_one_block  0.0016012191772460938
generate_one_block  0.001199483871459961
generate_one_block  0.0012712478637695312
generate_one_block  0.0012412071228027344
generate_one_block  0.0012331008911132812
generate_one_block  0.001135110855102539
generate_one_block  0.0010972023010253906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008094310760498047
gen group dst list time:  0.00020122528076171875
time for parepare:  0.00021839141845703125
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003185272216796875
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0004971027374267578
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005042552947998047
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0005097389221191406
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004928112030029297
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00029015541076660156
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.000247955322265625
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0006556510925292969
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00032520294189453125
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004620552062988281
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005285739898681641
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0007205009460449219
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0005023479461669922
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0005655288696289062
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002830028533935547
----------------------check_connections_block total spend ----------------------------- 0.013309478759765625
generate_one_block  0.0013785362243652344
generate_one_block  0.0015823841094970703
generate_one_block  0.0019338130950927734
generate_one_block  0.0015873908996582031
generate_one_block  0.0015401840209960938
generate_one_block  0.0012357234954833984
generate_one_block  0.0012218952178955078
generate_one_block  0.0016963481903076172
generate_one_block  0.0013079643249511719
generate_one_block  0.001443624496459961
generate_one_block  0.0015683174133300781
generate_one_block  0.0017704963684082031
generate_one_block  0.001512765884399414
generate_one_block  0.0016036033630371094
generate_one_block  0.0013210773468017578
generate_one_block  0.0012440681457519531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007960796356201172
gen group dst list time:  0.0002663135528564453
time for parepare:  0.00019121170043945312
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0008664131164550781
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0012214183807373047
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0013713836669921875
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.0014591217041015625
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0013885498046875
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0007669925689697266
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0007672309875488281
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0015225410461425781
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0009584426879882812
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0011012554168701172
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.0013468265533447266
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0014696121215820312
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0013403892517089844
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0014078617095947266
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0008454322814941406
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0006971359252929688
----------------------check_connections_block total spend ----------------------------- 0.02955937385559082
generate_one_block  0.0020208358764648438
generate_one_block  0.002314329147338867
generate_one_block  0.0029528141021728516
generate_one_block  0.002584218978881836
generate_one_block  0.0024843215942382812
generate_one_block  0.0017976760864257812
generate_one_block  0.001985788345336914
generate_one_block  0.002641916275024414
generate_one_block  0.0020666122436523438
generate_one_block  0.0021750926971435547
generate_one_block  0.002457857131958008
generate_one_block  0.0026280879974365234
generate_one_block  0.0024089813232421875
generate_one_block  0.0025997161865234375
generate_one_block  0.0019145011901855469
generate_one_block  0.0017676353454589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007824897766113281
gen group dst list time:  0.0006117820739746094
time for parepare:  0.00018978118896484375
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0003788471221923828
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0016388893127441406
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.002083301544189453
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0022106170654296875
local_output_nid generation:  0.00012612342834472656
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.002427816390991211
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.002353191375732422
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0016245841979980469
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0015575885772705078
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.0023174285888671875
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0018630027770996094
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.001871347427368164
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.0021123886108398438
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.0002772808074951172
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.002232789993286133
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0021066665649414062
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.002313852310180664
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0016140937805175781
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.0015528202056884766
----------------------check_connections_block total spend ----------------------------- 0.04852294921875
generate_one_block  0.0037314891815185547
generate_one_block  0.0032596588134765625
generate_one_block  0.003701448440551758
generate_one_block  0.003613710403442383
generate_one_block  0.003625631332397461
generate_one_block  0.0027909278869628906
generate_one_block  0.002640247344970703
generate_one_block  0.004263162612915039
generate_one_block  0.003069639205932617
generate_one_block  0.0030379295349121094
generate_one_block  0.003305673599243164
generate_one_block  0.003429412841796875
generate_one_block  0.0033185482025146484
generate_one_block  0.0035386085510253906
generate_one_block  0.0027649402618408203
generate_one_block  0.0027229785919189453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.09897971153259277
block generation total time  0.141096830368042
average batch blocks generation time:  0.008818551898002625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07584285736083984  GigaBytes
Max Memory Allocated: 0.07584285736083984  GigaBytes

torch.Size([1782, 1433])
torch.Size([1075, 128])
torch.Size([498, 128])
torch.Size([145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5441970825195312  GigaBytes
Max Memory Allocated: 0.5517044067382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.14363765716552734  GigaBytes
Max Memory Allocated: 0.6333107948303223  GigaBytes

torch.Size([2066, 1433])
torch.Size([1414, 128])
torch.Size([740, 128])
torch.Size([274, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7411623001098633  GigaBytes
Max Memory Allocated: 0.7453889846801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1433420181274414  GigaBytes
Max Memory Allocated: 0.8099150657653809  GigaBytes

torch.Size([2009, 1433])
torch.Size([1510, 128])
torch.Size([810, 128])
torch.Size([253, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1209716796875 GB
    Memory Allocated: 0.7825226783752441  GigaBytes
Max Memory Allocated: 0.8099150657653809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.14417171478271484  GigaBytes
Max Memory Allocated: 0.8449244499206543  GigaBytes

torch.Size([2163, 1433])
torch.Size([1689, 128])
torch.Size([880, 128])
torch.Size([268, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.8465337753295898  GigaBytes
Max Memory Allocated: 0.8517165184020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14388418197631836  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([2110, 1433])
torch.Size([1635, 128])
torch.Size([837, 128])
torch.Size([262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.8237624168395996  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.1422882080078125  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1818, 1433])
torch.Size([1056, 128])
torch.Size([431, 128])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.602935791015625  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14132213592529297  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1638, 1433])
torch.Size([1036, 128])
torch.Size([423, 128])
torch.Size([127, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.5743584632873535  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14412927627563477  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([2154, 1433])
torch.Size([1651, 128])
torch.Size([956, 128])
torch.Size([337, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.8387851715087891  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14288854598999023  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1928, 1433])
torch.Size([1316, 128])
torch.Size([526, 128])
torch.Size([186, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.7056741714477539  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14280033111572266  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1910, 1433])
torch.Size([1327, 128])
torch.Size([639, 128])
torch.Size([221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.7071704864501953  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14361333847045898  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([2060, 1433])
torch.Size([1502, 128])
torch.Size([803, 128])
torch.Size([262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.784672737121582  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.14384746551513672  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([2101, 1433])
torch.Size([1635, 128])
torch.Size([965, 128])
torch.Size([410, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.8342375755310059  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.14347553253173828  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([2034, 1433])
torch.Size([1505, 128])
torch.Size([819, 128])
torch.Size([258, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.7864832878112793  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.14425373077392578  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([2178, 1433])
torch.Size([1690, 128])
torch.Size([924, 128])
torch.Size([304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8490567207336426  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.1420741081237793  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1777, 1433])
torch.Size([1126, 128])
torch.Size([490, 128])
torch.Size([178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.6234831809997559  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.14262628555297852  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1709, 1433])
torch.Size([999, 128])
torch.Size([399, 128])
torch.Size([125, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.5865740776062012  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0610843151807785 |0.022566691040992737 |0.21971872448921204 |0.00013037025928497314 |0.26946938037872314 |0.01874089241027832 |
----------------------------------------------------------pseudo_mini_loss sum 3.3685178756713867
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  69275
Number of first layer input nodes during this epoch:  31437
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.2752413749694824  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007266998291015625
range selection method range initialization spend 8.320808410644531e-05
time for parepare:  9.107589721679688e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0034415721893310547
generate_one_block  0.0011563301086425781
generate_one_block  0.0013439655303955078
generate_one_block  0.001051187515258789
generate_one_block  0.0010411739349365234
generate_one_block  0.0010235309600830078
generate_one_block  0.0010685920715332031
generate_one_block  0.0010259151458740234
generate_one_block  0.0010139942169189453
generate_one_block  0.0010557174682617188
generate_one_block  0.0010216236114501953
generate_one_block  0.0010156631469726562
generate_one_block  0.001020193099975586
generate_one_block  0.0010464191436767578
generate_one_block  0.0010161399841308594
generate_one_block  0.0010859966278076172
generate_one_block  0.0009703636169433594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006346702575683594
gen group dst list time:  9.942054748535156e-05
time for parepare:  0.0002040863037109375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00018405914306640625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001270771026611328
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001773834228515625
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.606910705566406e-05
----------------------check_connections_block total spend ----------------------------- 0.005828380584716797
generate_one_block  0.001222372055053711
generate_one_block  0.001249074935913086
generate_one_block  0.0011096000671386719
generate_one_block  0.001191854476928711
generate_one_block  0.0011439323425292969
generate_one_block  0.00119781494140625
generate_one_block  0.0011785030364990234
generate_one_block  0.0010936260223388672
generate_one_block  0.0011944770812988281
generate_one_block  0.0010662078857421875
generate_one_block  0.0015635490417480469
generate_one_block  0.001130819320678711
generate_one_block  0.0012402534484863281
generate_one_block  0.0010716915130615234
generate_one_block  0.001129150390625
generate_one_block  0.0010695457458496094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007808208465576172
gen group dst list time:  0.00015735626220703125
time for parepare:  0.00023937225341796875
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00039505958557128906
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0006749629974365234
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0003261566162109375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004572868347167969
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004019737243652344
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005450248718261719
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0005214214324951172
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004076957702636719
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0006692409515380859
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0003380775451660156
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0002961158752441406
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005228519439697266
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0006618499755859375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0002810955047607422
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005137920379638672
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.00036716461181640625
----------------------check_connections_block total spend ----------------------------- 0.01430654525756836
generate_one_block  0.0015909671783447266
generate_one_block  0.001837015151977539
generate_one_block  0.0013153553009033203
generate_one_block  0.0015056133270263672
generate_one_block  0.0014548301696777344
generate_one_block  0.0016207695007324219
generate_one_block  0.0016760826110839844
generate_one_block  0.0014507770538330078
generate_one_block  0.001791238784790039
generate_one_block  0.0013937950134277344
generate_one_block  0.0012853145599365234
generate_one_block  0.001598358154296875
generate_one_block  0.0017917156219482422
generate_one_block  0.0012617111206054688
generate_one_block  0.0016031265258789062
generate_one_block  0.0014369487762451172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008199214935302734
gen group dst list time:  0.00037598609924316406
time for parepare:  0.00022602081298828125
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0003914833068847656
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0011010169982910156
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.0016179084777832031
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0007517337799072266
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0011970996856689453
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00012922286987304688
r_  generation:  0.0010716915130615234
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00015783309936523438
r_  generation:  0.0013773441314697266
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0011796951293945312
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0011115074157714844
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.001588582992553711
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.000980377197265625
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0007717609405517578
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.001306295394897461
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0015070438385009766
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0007026195526123047
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.001306295394897461
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0009243488311767578
----------------------check_connections_block total spend ----------------------------- 0.030780792236328125
generate_one_block  0.0025551319122314453
generate_one_block  0.002846240997314453
generate_one_block  0.001863241195678711
generate_one_block  0.0026340484619140625
generate_one_block  0.0022623538970947266
generate_one_block  0.002618074417114258
generate_one_block  0.0023767948150634766
generate_one_block  0.002306699752807617
generate_one_block  0.0028204917907714844
generate_one_block  0.002184629440307617
generate_one_block  0.001897573471069336
generate_one_block  0.0025894641876220703
generate_one_block  0.002791881561279297
generate_one_block  0.0018837451934814453
generate_one_block  0.0025713443756103516
generate_one_block  0.0021622180938720703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008945465087890625
gen group dst list time:  0.0007023811340332031
time for parepare:  0.00022983551025390625
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.00045371055603027344
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0021347999572753906
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.00031375885009765625
r_  generation:  0.002572298049926758
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0014841556549072266
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.0021228790283203125
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0020928382873535156
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.0003211498260498047
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0023679733276367188
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.002068042755126953
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.0001926422119140625
r_  generation:  0.0019996166229248047
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.0003211498260498047
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.0025260448455810547
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0006105899810791016
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0018169879913330078
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0016143321990966797
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0021049976348876953
local_output_nid generation:  0.0001404285430908203
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0023856163024902344
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0016012191772460938
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0002963542938232422
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.002229928970336914
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0017864704132080078
----------------------check_connections_block total spend ----------------------------- 0.051888227462768555
generate_one_block  0.0036487579345703125
generate_one_block  0.003908395767211914
generate_one_block  0.0027282238006591797
generate_one_block  0.003408193588256836
generate_one_block  0.0033380985260009766
generate_one_block  0.003636598587036133
generate_one_block  0.0033092498779296875
generate_one_block  0.003419637680053711
generate_one_block  0.0041964054107666016
generate_one_block  0.003370046615600586
generate_one_block  0.003136873245239258
generate_one_block  0.003551483154296875
generate_one_block  0.004015922546386719
generate_one_block  0.0029680728912353516
generate_one_block  0.003632068634033203
generate_one_block  0.003206014633178711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.2752413749694824  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

connection checking time:  0.10280394554138184
block generation total time  0.13730406761169434
average batch blocks generation time:  0.008581504225730896
block dataloader generation time/epoch 0.38176393508911133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.2752957344055176  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

torch.Size([1908, 1433])
torch.Size([1366, 128])
torch.Size([646, 128])
torch.Size([204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8409276008605957  GigaBytes
Max Memory Allocated: 0.9053378105163574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.2768540382385254  GigaBytes
Max Memory Allocated: 0.9149928092956543  GigaBytes

torch.Size([2194, 1433])
torch.Size([1709, 128])
torch.Size([957, 128])
torch.Size([325, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.9931426048278809  GigaBytes
Max Memory Allocated: 0.9931893348693848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.27339839935302734  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1557, 1433])
torch.Size([891, 128])
torch.Size([408, 128])
torch.Size([123, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.6775808334350586  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.27529096603393555  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1906, 1433])
torch.Size([1382, 128])
torch.Size([695, 128])
torch.Size([218, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8645038604736328  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2756643295288086  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1977, 1433])
torch.Size([1331, 128])
torch.Size([616, 128])
torch.Size([206, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8523883819580078  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2764134407043457  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([2114, 1433])
torch.Size([1556, 128])
torch.Size([798, 128])
torch.Size([248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.9355525970458984  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2757115364074707  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1985, 1433])
torch.Size([1343, 128])
torch.Size([698, 128])
torch.Size([259, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8532276153564453  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2757997512817383  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes
Using backend: pytorch

torch.Size([2002, 1433])
torch.Size([1359, 128])
torch.Size([641, 128])
torch.Size([183, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8561701774597168  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.276944637298584  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([2211, 1433])
torch.Size([1714, 128])
torch.Size([950, 128])
torch.Size([325, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.991034984588623  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2747659683227539  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1810, 1433])
torch.Size([1232, 128])
torch.Size([543, 128])
torch.Size([160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8098354339599609  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.2749595642089844  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1697, 1433])
torch.Size([1048, 128])
torch.Size([398, 128])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.7407894134521484  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.27564001083374023  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1970, 1433])
torch.Size([1473, 128])
torch.Size([800, 128])
torch.Size([250, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8944516181945801  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.27669715881347656  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([2165, 1433])
torch.Size([1720, 128])
torch.Size([946, 128])
torch.Size([364, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.9885692596435547  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.27469396591186523  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1799, 1433])
torch.Size([1076, 128])
torch.Size([388, 128])
torch.Size([145, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.737795352935791  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.27619266510009766  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([2073, 1433])
torch.Size([1554, 128])
torch.Size([827, 128])
torch.Size([251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.9331192970275879  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.27497339248657227  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

torch.Size([1849, 1433])
torch.Size([1209, 128])
torch.Size([541, 128])
torch.Size([178, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3651123046875 GB
    Memory Allocated: 0.795722484588623  GigaBytes
Max Memory Allocated: 1.0453753471374512  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.062192291021347046 |0.0010189265012741089 |0.19121745228767395 |0.0001469254493713379 |0.26551491022109985 |0.014075279235839844 |
----------------------------------------------------------pseudo_mini_loss sum 2.774806261062622
Total (block generation + training)time/epoch 8.788861751556396
Training time/epoch 8.406862497329712
Training time without block to device /epoch 8.390559673309326
Training time without total dataloading part /epoch 7.324143886566162
load block tensor time/epoch 0.9950766563415527
block to device time/epoch 0.016302824020385742
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  68384
Number of first layer input nodes during this epoch:  31217
