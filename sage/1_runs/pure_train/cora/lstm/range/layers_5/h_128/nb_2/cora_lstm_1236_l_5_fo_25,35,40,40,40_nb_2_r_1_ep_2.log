main start at this time 1648432959.1613302
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00112152099609375
range selection method range initialization spend 0.00010561943054199219
time for parepare:  7.677078247070312e-05
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0018057823181152344
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001544952392578125
----------------------check_connections_block total spend ----------------------------- 0.002802610397338867
generate_one_block  0.0022513866424560547
generate_one_block  0.0015549659729003906
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005714893341064453
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.0001819133758544922
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0008072853088378906
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0008797645568847656
----------------------check_connections_block total spend ----------------------------- 0.0030820369720458984
generate_one_block  0.002187490463256836
generate_one_block  0.0022406578063964844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006883144378662109
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.00023055076599121094
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.00039196014404296875
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.0021605491638183594
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.002299785614013672
----------------------check_connections_block total spend ----------------------------- 0.007135868072509766
generate_one_block  0.0036940574645996094
generate_one_block  0.003644704818725586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007948875427246094
gen group dst list time:  0.00011515617370605469
time for parepare:  0.00023794174194335938
local_output_nid generation:  0.00017404556274414062
local_in_edges_tensor generation:  0.0004901885986328125
mini_batch_src_global generation:  0.00027489662170410156
r_  generation:  0.003429889678955078
local_output_nid generation:  0.0001804828643798828
local_in_edges_tensor generation:  0.0004074573516845703
mini_batch_src_global generation:  0.0003864765167236328
r_  generation:  0.0034570693969726562
----------------------check_connections_block total spend ----------------------------- 0.010776281356811523
generate_one_block  0.004612445831298828
generate_one_block  0.0039370059967041016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007865428924560547
gen group dst list time:  0.00014162063598632812
time for parepare:  0.00024056434631347656
local_output_nid generation:  0.00020503997802734375
local_in_edges_tensor generation:  0.0005538463592529297
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.003939151763916016
local_output_nid generation:  0.00021505355834960938
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.00040459632873535156
r_  generation:  0.003931283950805664
----------------------check_connections_block total spend ----------------------------- 0.011963605880737305
generate_one_block  0.009498357772827148
generate_one_block  0.007417201995849609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.03295779228210449
block generation total time  0.0372319221496582
average batch blocks generation time:  0.0186159610748291
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.08012580871582031  GigaBytes
Max Memory Allocated: 0.08012580871582031  GigaBytes

torch.Size([2473, 1433])
torch.Size([2324, 128])
torch.Size([1917, 128])
torch.Size([1099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3143310546875 GB
    Memory Allocated: 1.0340046882629395  GigaBytes
Max Memory Allocated: 1.034224033355713  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.14573955535888672  GigaBytes
Max Memory Allocated: 1.0348186492919922  GigaBytes

torch.Size([2460, 1433])
torch.Size([2329, 128])
torch.Size([1944, 128])
torch.Size([1182, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.104722499847412  GigaBytes
Max Memory Allocated: 1.1049656867980957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043871164321899414 |0.17111682891845703 |0.507573127746582 |0.00017130374908447266 |0.35857903957366943 |0.015522003173828125 |
----------------------------------------------------------pseudo_mini_loss sum 2.867125988006592
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16427
Number of first layer input nodes during this epoch:  4933
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.2779712677001953  GigaBytes
Max Memory Allocated: 1.1055173873901367  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005304813385009766
range selection method range initialization spend 6.771087646484375e-05
time for parepare:  7.843971252441406e-05
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001239776611328125
----------------------check_connections_block total spend ----------------------------- 0.0009198188781738281
generate_one_block  0.001373291015625
generate_one_block  0.001245260238647461
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005266666412353516
gen group dst list time:  3.361701965332031e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0006959438323974609
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation: Using backend: pytorch
 9.226799011230469e-05
r_  generation:  0.0007307529449462891
----------------------check_connections_block total spend ----------------------------- 0.002836942672729492
generate_one_block  0.0020618438720703125
generate_one_block  0.0023360252380371094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006301403045654297
gen group dst list time:  6.508827209472656e-05
time for parepare:  0.00019288063049316406
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0017879009246826172
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0014424324035644531
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0018644332885742188
----------------------check_connections_block total spend ----------------------------- 0.007079362869262695
generate_one_block  0.0032753944396972656
generate_one_block  0.003318309783935547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007429122924804688
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.00020003318786621094
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0028374195098876953
local_output_nid generation:  0.00014495849609375
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.0003230571746826172
r_  generation:  0.0028533935546875
----------------------check_connections_block total spend ----------------------------- 0.008955240249633789
generate_one_block  0.004254579544067383
generate_one_block  0.004228115081787109
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007567405700683594
gen group dst list time:  0.00011205673217773438
time for parepare:  0.00019097328186035156
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.003221273422241211
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.00039315223693847656
mini_batch_src_global generation:  0.0003368854522705078
r_  generation:  0.00322723388671875
----------------------check_connections_block total spend ----------------------------- 0.009887933731079102
generate_one_block  0.004702091217041016
generate_one_block  0.0044057369232177734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.2779712677001953  GigaBytes
Max Memory Allocated: 1.1055173873901367  GigaBytes

connection checking time:  0.028759479522705078
block generation total time  0.028582096099853516
average batch blocks generation time:  0.014291048049926758
block dataloader generation time/epoch 0.08474063873291016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.2775897979736328  GigaBytes
Max Memory Allocated: 1.1055173873901367  GigaBytes

torch.Size([2450, 1433])
torch.Size([2294, 128])
torch.Size([1869, 128])
torch.Size([1079, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6776123046875 GB
    Memory Allocated: 1.223525047302246  GigaBytes
Max Memory Allocated: 1.2237610816955566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6776123046875 GB
    Memory Allocated: 0.27759456634521484  GigaBytes
Max Memory Allocated: 1.2243223190307617  GigaBytes

torch.Size([2450, 1433])
torch.Size([2325, 128])
torch.Size([1920, 128])
torch.Size([1124, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6795654296875 GB
    Memory Allocated: 1.2369613647460938  GigaBytes
Max Memory Allocated: 1.237189769744873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03941667079925537 |0.0012176036834716797 |0.26802682876586914 |0.00016415119171142578 |0.356461763381958 |0.0135345458984375 |
----------------------------------------------------------pseudo_mini_loss sum 2.3229923248291016
Total (block generation + training)time/epoch 1.4929900169372559
Training time/epoch 1.4079620838165283
Training time without block to device /epoch 1.405526876449585
Training time without total dataloading part /epoch 1.2628400325775146
load block tensor time/epoch 0.07883334159851074
block to device time/epoch 0.0024352073669433594
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16217
Number of first layer input nodes during this epoch:  4900
