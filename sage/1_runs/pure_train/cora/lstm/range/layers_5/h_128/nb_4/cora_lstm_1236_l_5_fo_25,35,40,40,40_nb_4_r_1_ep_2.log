main start at this time 1648432971.267776
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001514434814453125
range selection method range initialization spend 0.00011038780212402344
time for parepare:  6.413459777832031e-05
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.002166271209716797
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.200241088867188e-05
----------------------check_connections_block total spend ----------------------------- 0.0034148693084716797
generate_one_block  0.0015053749084472656
generate_one_block  0.0010852813720703125
generate_one_block  0.001066446304321289
generate_one_block  0.0010688304901123047
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004906654357910156
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.00014066696166992188
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00038933753967285156
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00037026405334472656
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00041937828063964844
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00044345855712890625
----------------------check_connections_block total spend ----------------------------- 0.0031197071075439453
generate_one_block  0.0014696121215820312
generate_one_block  0.0014231204986572266
generate_one_block  0.0014939308166503906
generate_one_block  0.0015645027160644531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005812644958496094
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.00018405914306640625
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  0.0001385211944580078
r_  generation:  0.0012135505676269531
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0011560916900634766
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0012547969818115234
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0013163089752197266
----------------------check_connections_block total spend ----------------------------- 0.008022785186767578
generate_one_block  0.0024366378784179688
generate_one_block  0.002353191375732422
generate_one_block  0.0023860931396484375
generate_one_block  0.00243377685546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000732421875
gen group dst list time:  0.00013566017150878906
time for parepare:  0.00019168853759765625
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.0003898143768310547
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0023577213287353516
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.0002770423889160156
r_  generation:  0.0023076534271240234
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0023071765899658203
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.002377033233642578
----------------------check_connections_block total spend ----------------------------- 0.014471769332885742
generate_one_block  0.003578662872314453
generate_one_block  0.0034089088439941406
generate_one_block  0.003501415252685547
generate_one_block  0.0035400390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008022785186767578
gen group dst list time:  0.00018858909606933594
time for parepare:  0.0001933574676513672
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.002956390380859375
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.0003132820129394531
r_  generation:  0.0029463768005371094
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.000339508056640625
mini_batch_src_global generation:  0.0002541542053222656
r_  generation:  0.002895355224609375
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.003071308135986328
----------------------check_connections_block total spend ----------------------------- 0.017993450164794922
generate_one_block  0.004075527191162109
generate_one_block  0.003976345062255859
generate_one_block  0.0039038658142089844
generate_one_block  0.004630565643310547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06626033782958984  GigaBytes
Max Memory Allocated: 0.06626033782958984  GigaBytes

connection checking time:  0.04360771179199219
block generation total time  0.04617619514465332
average batch blocks generation time:  0.01154404878616333
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.0791006088256836  GigaBytes
Max Memory Allocated: 0.0791006088256836  GigaBytes

torch.Size([2375, 1433])
torch.Size([2155, 128])
torch.Size([1560, 128])
torch.Size([714, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2147216796875 GB
    Memory Allocated: 0.9604754447937012  GigaBytes
Max Memory Allocated: 0.9605860710144043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.14475297927856445  GigaBytes
Max Memory Allocated: 0.9737558364868164  GigaBytes

torch.Size([2384, 1433])
torch.Size([2140, 128])
torch.Size([1534, 128])
torch.Size([655, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.0226268768310547  GigaBytes
Max Memory Allocated: 1.0227441787719727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.1444711685180664  GigaBytes
Max Memory Allocated: 1.0347990989685059  GigaBytes

torch.Size([2331, 1433])
torch.Size([2091, 128])
torch.Size([1514, 128])
torch.Size([733, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3924560546875 GB
    Memory Allocated: 1.0116090774536133  GigaBytes
Max Memory Allocated: 1.0347990989685059  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3924560546875 GB
    Memory Allocated: 0.14486312866210938  GigaBytes
Max Memory Allocated: 1.0347990989685059  GigaBytes

torch.Size([2403, 1433])
torch.Size([2189, 128])
torch.Size([1599, 128])
torch.Size([790, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.039534568786621  GigaBytes
Max Memory Allocated: 1.039665699005127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0597078800201416 |0.08628249168395996 |0.3659994602203369 |0.00016838312149047852 |0.3344101309776306 |0.017840147018432617 |
----------------------------------------------------------pseudo_mini_loss sum 2.798774003982544
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27899
Number of first layer input nodes during this epoch:  9493
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.2776775360107422  GigaBytes
Max Memory Allocated: 1.0442628860473633  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005490779876708984
range selection method range initialization spend 7.224082946777344e-05
time for parepare:  8.106231689453125e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.106231689453125e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0012884140014648438
generate_one_block  0.001199483871459961
generate_one_block  0.0011196136474609375
generate_one_block  0.0011813640594482422
generate_one_block  0.001074075698852539
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004980564117431641
gen group dst list time:  4.458427429199219e-05
time for parepare:  0.0001633167266845703
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004553794860839844
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0004127025604248047
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00037360191345214844
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00039505958557128906
----------------------check_connections_block total spend ----------------------------- 0.003260374069213867
generate_one_block  0.001804351806640625
generate_one_block  0.001531362533569336
generate_one_block  0.001482248306274414
generate_one_block  0.001608133316040039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005466938018798828
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0012631416320800781
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0011844635009765625
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.001138925552368164
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.0001494884490966797
r_  generation:  0.0012938976287841797
----------------------check_connections_block total spend ----------------------------- 0.008087396621704102
generate_one_block  0.002725839614868164
generate_one_block  0.002472400665283203
generate_one_block  0.0023813247680664062
generate_one_block  0.0025823116302490234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007619857788085938
gen group dst list time:  0.000141143798828125
time for parepare:  0.00017905235290527344
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.00043010711669921875
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.0022530555725097656
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002257108688354492
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.0020987987518310547
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.002524137496948242
----------------------check_connections_block total spend ----------------------------- 0.01419377326965332
generate_one_block  0.003889799118041992
generate_one_block  0.0036439895629882812
generate_one_block  0.003523111343383789
generate_one_block  0.0037560462951660156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008018016815185547
gen group dst list time:  0.00020742416381835938
time for parepare:  0.00019121170043945312
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.0004665851593017578
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.0028595924377441406
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.0003056526184082031
r_  generation:  0.002930164337158203
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.0027806758880615234
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation: Using backend: pytorch
 0.0002467632293701172
r_  generation:  0.0030379295349121094
----------------------check_connections_block total spend ----------------------------- 0.017611980438232422
generate_one_block  0.004208087921142578
generate_one_block  0.006166696548461914
generate_one_block  0.004078388214111328
generate_one_block  0.004273891448974609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.2776775360107422  GigaBytes
Max Memory Allocated: 1.0442628860473633  GigaBytes

connection checking time:  0.04315352439880371
block generation total time  0.05012798309326172
average batch blocks generation time:  0.01253199577331543
block dataloader generation time/epoch 0.1436152458190918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.27712535858154297  GigaBytes
Max Memory Allocated: 1.0442628860473633  GigaBytes

torch.Size([2358, 1433])
torch.Size([2106, 128])
torch.Size([1569, 128])
torch.Size([721, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.1439127922058105  GigaBytes
Max Memory Allocated: 1.1440424919128418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.27727699279785156  GigaBytes
Max Memory Allocated: 1.1519370079040527  GigaBytes

torch.Size([2386, 1433])
torch.Size([2167, 128])
torch.Size([1547, 128])
torch.Size([716, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.1624507904052734  GigaBytes
Max Memory Allocated: 1.1625657081604004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.2768721580505371  GigaBytes
Max Memory Allocated: 1.1709675788879395  GigaBytes

torch.Size([2312, 1433])
torch.Size([2027, 128])
torch.Size([1437, 128])
torch.Size([648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 1.108503818511963  GigaBytes
Max Memory Allocated: 1.1709675788879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5272216796875 GB
    Memory Allocated: 0.27751922607421875  GigaBytes
Max Memory Allocated: 1.1709675788879395  GigaBytes

torch.Size([2430, 1433])
torch.Size([2242, 128])
torch.Size([1690, 128])
torch.Size([784, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5858154296875 GB
    Memory Allocated: 1.1905012130737305  GigaBytes
Max Memory Allocated: 1.1906170845031738  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05356943607330322 |0.0011428594589233398 |0.24988162517547607 |0.00013685226440429688 |0.3346726894378662 |0.012967824935913086 |
----------------------------------------------------------pseudo_mini_loss sum 2.583557605743408
Total (block generation + training)time/epoch 2.781836986541748
Training time/epoch 2.637930154800415
Training time without block to device /epoch 2.6333587169647217
Training time without total dataloading part /epoch 2.3517324924468994
load block tensor time/epoch 0.2142777442932129
block to device time/epoch 0.004571437835693359
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27878
Number of first layer input nodes during this epoch:  9486
