main start at this time 1648432842.8758364
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0009703636169433594
range selection method range initialization spend 8.225440979003906e-05
time for parepare:  6.175041198730469e-05
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.0011854171752929688
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.5299530029296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0029251575469970703
generate_one_block  0.0012829303741455078
generate_one_block  0.0009846687316894531
generate_one_block  0.0009908676147460938
generate_one_block  0.0010077953338623047
generate_one_block  0.0009772777557373047
generate_one_block  0.0009851455688476562
generate_one_block  0.0009894371032714844
generate_one_block  0.0009641647338867188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00046896934509277344
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.0001308917999267578
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00023031234741210938
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00014138221740722656
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002410411834716797
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00025844573974609375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00023794174194335938
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00017595291137695312
----------------------check_connections_block total spend ----------------------------- 0.0038192272186279297
generate_one_block  0.001249074935913086
generate_one_block  0.0011129379272460938
generate_one_block  0.001249074935913086
generate_one_block  0.0012538433074951172
generate_one_block  0.0012028217315673828
generate_one_block  0.001285552978515625
generate_one_block  0.0012645721435546875
generate_one_block  0.0011572837829589844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006663799285888672
gen group dst list time:  9.560585021972656e-05
time for parepare:  0.000186920166015625
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.00070953369140625
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.00047469139099121094
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0008842945098876953
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.000888824462890625
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0006890296936035156
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0008478164672851562
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0007698535919189453
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006020069122314453
----------------------check_connections_block total spend ----------------------------- 0.009986400604248047
generate_one_block  0.0018663406372070312
generate_one_block  0.001491546630859375
generate_one_block  0.0019354820251464844
generate_one_block  0.0020127296447753906
generate_one_block  0.0017910003662109375
generate_one_block  0.0019481182098388672
generate_one_block  0.0018682479858398438
generate_one_block  0.001657247543334961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007145404815673828
gen group dst list time:  0.00018024444580078125
time for parepare:  0.00017762184143066406
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0003566741943359375
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0016083717346191406
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0012593269348144531
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0018224716186523438
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.00196075439453125
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0017409324645996094
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00016689300537109375
r_  generation:  0.0016973018646240234
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0017354488372802734
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0014560222625732422
----------------------check_connections_block total spend ----------------------------- 0.020816564559936523
generate_one_block  0.0029883384704589844
generate_one_block  0.002470254898071289
generate_one_block  0.0031104087829589844
generate_one_block  0.0031354427337646484
generate_one_block  0.0030050277709960938
generate_one_block  0.0029447078704833984
generate_one_block  0.0029494762420654297
generate_one_block  0.0026383399963378906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007460117340087891
gen group dst list time:  0.0003848075866699219
time for parepare:  0.00017714500427246094
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.00043272972106933594
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.002499818801879883
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.002228975296020508
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.002660989761352539
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002647876739501953
local_output_nid generation:  0.0001239776611328125
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0023894309997558594
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0002932548522949219
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.002442598342895508
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.0002963542938232422
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.002485513687133789
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.002281665802001953
----------------------check_connections_block total spend ----------------------------- 0.02978825569152832
generate_one_block  0.0045511722564697266
generate_one_block  0.003367900848388672
generate_one_block  0.0038688182830810547
generate_one_block  0.0043981075286865234
generate_one_block  0.003654003143310547
generate_one_block  0.003678560256958008
generate_one_block  0.004460573196411133
generate_one_block  0.003484010696411133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.06441044807434082
block generation total time  0.07905101776123047
average batch blocks generation time:  0.009881377220153809
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07526779174804688  GigaBytes
Max Memory Allocated: 0.07526779174804688  GigaBytes

torch.Size([2266, 1433])
torch.Size([1833, 32])
torch.Size([1087, 32])
torch.Size([452, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.7831287384033203  GigaBytes
Max Memory Allocated: 0.828455924987793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1346435546875 GB
    Memory Allocated: 0.1372528076171875  GigaBytes
Max Memory Allocated: 0.8782949447631836  GigaBytes

torch.Size([2145, 1433])
torch.Size([1542, 32])
torch.Size([760, 32])
torch.Size([264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1737060546875 GB
    Memory Allocated: 0.7526164054870605  GigaBytes
Max Memory Allocated: 0.8782949447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.13805437088012695  GigaBytes
Max Memory Allocated: 0.8782949447631836  GigaBytes

torch.Size([2338, 1433])
torch.Size([1990, 32])
torch.Size([1230, 32])
torch.Size([504, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.9018220901489258  GigaBytes
Max Memory Allocated: 0.9492344856262207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.13794803619384766  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

torch.Size([2294, 1433])
torch.Size([1992, 32])
torch.Size([1307, 32])
torch.Size([515, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.8917689323425293  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.1372828483581543  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

torch.Size([2196, 1433])
torch.Size([1775, 32])
torch.Size([1112, 32])
torch.Size([382, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.8196630477905273  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2596435546875 GB
    Memory Allocated: 0.13793373107910156  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

torch.Size([2206, 1433])
torch.Size([1817, 32])
torch.Size([1141, 32])
torch.Size([463, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.8319063186645508  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.13744878768920898  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

torch.Size([2226, 1433])
torch.Size([1849, 32])
torch.Size([1129, 32])
torch.Size([433, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.8533139228820801  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.1372671127319336  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

torch.Size([2121, 1433])
torch.Size([1664, 32])
torch.Size([900, 32])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.7849268913269043  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06432005763053894 |0.04301688075065613 |0.2781194746494293 |0.0001431107521057129 |0.28030550479888916 |0.02123236656188965 |
----------------------------------------------------------pseudo_mini_loss sum 3.1364147663116455
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45043
Number of first layer input nodes during this epoch:  17792
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.26288890838623047  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006008148193359375
range selection method range initialization spend 8.153915405273438e-05
time for parepare:  8.034706115722656e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.075599670410156e-05
----------------------check_connections_block total spend ----------------------------- 0.0020515918731689453
generate_one_block  0.001252889633178711
generate_one_block  0.0011546611785888672
generate_one_block  0.0010991096496582031
generate_one_block  0.0010998249053955078
generate_one_block  0.0011439323425292969
generate_one_block  0.0010709762573242188
generate_one_block  0.0010561943054199219
generate_one_block  0.0010836124420166016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005500316619873047
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.00019502639770507812
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00027871131896972656
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00031948089599609375
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002715587615966797
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0002551078796386719
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00028705596923828125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.000202178955078125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00019311904907226562
----------------------check_connections_block total spend ----------------------------- 0.0045318603515625
generate_one_block  0.0014123916625976562
generate_one_block  0.0014827251434326172
generate_one_block  0.001402139663696289
generate_one_block  0.0014095306396484375
generate_one_block  0.0014193058013916016
generate_one_block  0.0012617111206054688
generate_one_block  0.0012123584747314453
generate_one_block  0.001222848892211914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00074005126953125
gen group dst list time:  0.00011682510375976562
time for parepare:  0.00023818016052246094
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0003399848937988281
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0008559226989746094
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0010373592376708984
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0009469985961914062
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0008051395416259766
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0008616447448730469
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0006518363952636719
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0004887580871582031
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007138252258300781
----------------------check_connections_block total spend ----------------------------- 0.011400699615478516
generate_one_block  0.0021560192108154297
generate_one_block  0.0023145675659179688
generate_one_block  0.0021369457244873047
generate_one_block  0.0018601417541503906
generate_one_block  0.002054929733276367
generate_one_block  0.0017712116241455078
generate_one_block  0.001554727554321289
generate_one_block  0.0018086433410644531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007586479187011719
gen group dst list time:  0.00021004676818847656
time for parepare:  0.00020575523376464844
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0004153251647949219
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0018148422241210938
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.002121448516845703
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.002041339874267578
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0018019676208496094
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0018157958984375
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00043582916259765625
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0015978813171386719
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0012536048889160156
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0015552043914794922
----------------------check_connections_block total spend ----------------------------- 0.022419452667236328
generate_one_block  0.0031652450561523438
generate_one_block  0.003251791000366211
generate_one_block  0.0032079219818115234
generate_one_block  0.0029485225677490234
generate_one_block  0.0029897689819335938
generate_one_block  0.002779722213745117
generate_one_block  0.002446889877319336
generate_one_block  0.002796173095703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007958412170410156
gen group dst list time:  0.0003886222839355469
time for parepare:  0.00023412704467773438
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.0026268959045410156
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00029277801513671875
r_  generation:  0.0028684139251708984
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.002832651138305664
local_output_nid generation:  0.0001537799835205078
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.002719402313232422
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0027747154235839844
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0003170967102050781
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0024061203002929688
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0021376609802246094
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.002434968948364258
----------------------check_connections_block total spend ----------------------------- 0.03185606002807617
generate_one_block  0.003980159759521484
generate_one_block  0.004281044006347656
generate_one_block  0.003957986831665039
generate_one_block  0.0038292407989501953
generate_one_block  0.0041348934173583984
generate_one_block  0.0037529468536376953
generate_one_block  0.0034766197204589844
generate_one_block  0.0037865638732910156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.26288890838623047  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

connection checking time:  0.07020807266235352
block generation total time  0.08126568794250488
average batch blocks generation time:  0.01015821099281311
block dataloader generation time/epoch 0.23080730438232422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.2627077102661133  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

torch.Size([2177, 1433])
torch.Size([1757, 32])
torch.Size([1068, 32])
torch.Size([427, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.9452714920043945  GigaBytes
Max Memory Allocated: 0.9925823211669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.26337623596191406  GigaBytes
Max Memory Allocated: 1.03971529006958  GigaBytes

torch.Size([2279, 1433])
torch.Size([1961, 32])
torch.Size([1301, 32])
torch.Size([542, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 1.0052757263183594  GigaBytes
Max Memory Allocated: 1.0491228103637695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.26299047470092773  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

torch.Size([2246, 1433])
torch.Size([1906, 32])
torch.Size([1230, 32])
torch.Size([481, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.9943323135375977  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.26336002349853516  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

torch.Size([2227, 1433])
torch.Size([1815, 32])
torch.Size([1067, 32])
torch.Size([401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.9689817428588867  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.2630434036254883  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

torch.Size([2257, 1433])
torch.Size([1864, 32])
torch.Size([1105, 32])
torch.Size([472, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.9793505668640137  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.26334667205810547  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

torch.Size([2203, 1433])
torch.Size([1747, 32])
torch.Size([928, 32])
torch.Size([352, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.9378447532653809  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.2626771926879883  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

torch.Size([2095, 1433])
torch.Size([1505, 32])
torch.Size([700, 32])
torch.Size([246, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.8587970733642578  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.2633514404296875  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

torch.Size([2229, 1433])
torch.Size([1761, 32])
torch.Size([959, 32])
torch.Size([389, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3905029296875 GB
    Memory Allocated: 0.9484148025512695  GigaBytes
Max Memory Allocated: 1.095423698425293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06292334198951721 |0.0008609294891357422 |0.2113838791847229 |0.00012123584747314453 |0.2760544717311859 |0.007223367691040039 |
----------------------------------------------------------pseudo_mini_loss sum 2.269352436065674
Total (block generation + training)time/epoch 4.70898175239563
Training time/epoch 4.477935791015625
Training time without block to device /epoch 4.471048355102539
Training time without total dataloading part /epoch 3.9077000617980957
load block tensor time/epoch 0.5033867359161377
block to device time/epoch 0.0068874359130859375
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44452
Number of first layer input nodes during this epoch:  17713
