main start at this time 1648432816.7860532
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000993490219116211
range selection method range initialization spend 7.843971252441406e-05
time for parepare:  6.794929504394531e-05
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0014274120330810547
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.0023005008697509766
generate_one_block  0.0015807151794433594
generate_one_block  0.001314401626586914
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005068778991699219
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0007166862487792969
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0007121562957763672
----------------------check_connections_block total spend ----------------------------- 0.0025675296783447266
generate_one_block  0.001980304718017578
generate_one_block  0.0019161701202392578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005865097045898438
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0003204345703125
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0019130706787109375
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00018930435180664062
r_  generation:  0.0017535686492919922
----------------------check_connections_block total spend ----------------------------- 0.005793333053588867
generate_one_block  0.003290414810180664
generate_one_block  0.0030965805053710938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006344318389892578
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00018978118896484375
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.002928018569946289
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.0003027915954589844
r_  generation:  0.0027267932891845703
----------------------check_connections_block total spend ----------------------------- 0.008793830871582031
generate_one_block  0.004226207733154297
generate_one_block  0.00401616096496582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007300376892089844
gen group dst list time:  0.000110626220703125
time for parepare:  0.0001957416534423828
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0033502578735351562
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.0003733634948730469
mini_batch_src_global generation:  0.00032901763916015625
r_  generation:  0.0032029151916503906
----------------------check_connections_block total spend ----------------------------- 0.009967327117919922
generate_one_block  0.004637002944946289
generate_one_block  0.004125118255615234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.027122020721435547
block generation total time  0.027287960052490234
average batch blocks generation time:  0.013643980026245117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07691574096679688  GigaBytes
Max Memory Allocated: 0.07691574096679688  GigaBytes

torch.Size([2465, 1433])
torch.Size([2355, 32])
torch.Size([1942, 32])
torch.Size([1163, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2069091796875 GB
    Memory Allocated: 0.9480476379394531  GigaBytes
Max Memory Allocated: 0.9891176223754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3006591796875 GB
    Memory Allocated: 0.1392974853515625  GigaBytes
Max Memory Allocated: 1.0224981307983398  GigaBytes

torch.Size([2430, 1433])
torch.Size([2248, 32])
torch.Size([1806, 32])
torch.Size([1040, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 0.9710936546325684  GigaBytes
Max Memory Allocated: 1.0224981307983398  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.041054606437683105 |0.16899096965789795 |0.49505341053009033 |0.00018918514251708984 |0.34924066066741943 |0.018040180206298828 |
----------------------------------------------------------pseudo_mini_loss sum 2.9308972358703613
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16150
Number of first layer input nodes during this epoch:  4895
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 0.2650747299194336  GigaBytes
Max Memory Allocated: 1.0486326217651367  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005202293395996094
range selection method range initialization spend 6.747245788574219e-05
time for parepare:  7.62939453125e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00012540817260742188
----------------------check_connections_block total spend ----------------------------- 0.0009427070617675781
generate_one_block  0.0013759136199951172
generate_one_block  0.0012328624725341797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005199909210205078
gen group dst list time:  3.4332275390625e-05
time for parepare:  0.00016617774963378906
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0008161067962646484
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation: Using backend: pytorch
 9.417533874511719e-05
r_  generation:  0.0006251335144042969
----------------------check_connections_block total spend ----------------------------- 0.002760648727416992
generate_one_block  0.0021834373474121094
generate_one_block  0.0018177032470703125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006043910980224609
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.00019788742065429688
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.001989126205444336
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0015933513641357422
----------------------check_connections_block total spend ----------------------------- 0.0057599544525146484
generate_one_block  0.003840923309326172
generate_one_block  0.002969503402709961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006549358367919922
gen group dst list time:  8.845329284667969e-05
time for parepare:  0.00019431114196777344
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.002872467041015625
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.0027115345001220703
----------------------check_connections_block total spend ----------------------------- 0.008713722229003906
generate_one_block  0.0043487548828125
generate_one_block  0.004087686538696289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007860660552978516
gen group dst list time:  0.0001125335693359375
time for parepare:  0.0001964569091796875
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.0032701492309570312
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.00033473968505859375
r_  generation:  0.0033152103424072266
----------------------check_connections_block total spend ----------------------------- 0.010163307189941406
generate_one_block  0.0048639774322509766
generate_one_block  0.004358768463134766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 0.2650747299194336  GigaBytes
Max Memory Allocated: 1.0486326217651367  GigaBytes

connection checking time:  0.027397632598876953
block generation total time  0.028470754623413086
average batch blocks generation time:  0.014235377311706543
block dataloader generation time/epoch 0.08250117301940918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 0.2647361755371094  GigaBytes
Max Memory Allocated: 1.0486326217651367  GigaBytes

torch.Size([2416, 1433])
torch.Size([2263, 32])
torch.Size([1891, 32])
torch.Size([1177, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 1.1041717529296875  GigaBytes
Max Memory Allocated: 1.1434235572814941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 0.26471900939941406  GigaBytes
Max Memory Allocated: 1.1798639297485352  GigaBytes

torch.Size([2452, 1433])
torch.Size([2272, 32])
torch.Size([1743, 32])
torch.Size([936, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 1.1019649505615234  GigaBytes
Max Memory Allocated: 1.1798639297485352  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03746604919433594 |0.0009589195251464844 |0.2560683488845825 |0.00013244152069091797 |0.3459591865539551 |0.013968944549560547 |
----------------------------------------------------------pseudo_mini_loss sum 2.2634806632995605
Total (block generation + training)time/epoch 1.4413788318634033
Training time/epoch 1.358558177947998
Training time without block to device /epoch 1.356640338897705
Training time without total dataloading part /epoch 1.2182888984680176
load block tensor time/epoch 0.07493209838867188
block to device time/epoch 0.0019178390502929688
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15835
Number of first layer input nodes during this epoch:  4868
