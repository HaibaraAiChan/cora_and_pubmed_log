main start at this time 1648432861.3546522
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013933181762695312
range selection method range initialization spend 8.654594421386719e-05
time for parepare:  6.628036499023438e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0027494430541992188
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.006082057952880859
generate_one_block  0.0014584064483642578
generate_one_block  0.0010762214660644531
generate_one_block  0.0010616779327392578
generate_one_block  0.001056671142578125
generate_one_block  0.0010690689086914062
generate_one_block  0.0010519027709960938
generate_one_block  0.001092672348022461
generate_one_block  0.0010800361633300781
generate_one_block  0.001051187515258789
generate_one_block  0.0010631084442138672
generate_one_block  0.0010700225830078125
generate_one_block  0.0010557174682617188
generate_one_block  0.0010755062103271484
generate_one_block  0.0009684562683105469
generate_one_block  0.001008749008178711
generate_one_block  0.0009553432464599609
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006160736083984375
gen group dst list time:  9.584426879882812e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002040863037109375
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00017261505126953125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012612342834472656
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00014519691467285156
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.846687316894531e-05
----------------------check_connections_block total spend ----------------------------- 0.005837678909301758
generate_one_block  0.001300811767578125
generate_one_block  0.001116037368774414
generate_one_block  0.0011289119720458984
generate_one_block  0.0011353492736816406
generate_one_block  0.001300811767578125
generate_one_block  0.0012128353118896484
generate_one_block  0.001155853271484375
generate_one_block  0.0012881755828857422
generate_one_block  0.0010881423950195312
generate_one_block  0.0010881423950195312
generate_one_block  0.0011205673217773438
generate_one_block  0.0010936260223388672
generate_one_block  0.0011582374572753906
generate_one_block  0.0011081695556640625
generate_one_block  0.0010900497436523438
generate_one_block  0.0010669231414794922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006856918334960938
gen group dst list time:  0.00019121170043945312
time for parepare:  0.00020265579223632812
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0006537437438964844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00023865699768066406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002551078796386719
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.000301361083984375
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005953311920166016
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004851818084716797
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00038552284240722656
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0007479190826416016
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004050731658935547
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004508495330810547
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004913806915283203
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004673004150390625
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005469322204589844
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005254745483398438
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00044918060302734375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00037932395935058594
----------------------check_connections_block total spend ----------------------------- 0.013592720031738281
generate_one_block  0.0018563270568847656
generate_one_block  0.0013017654418945312
generate_one_block  0.0015726089477539062
generate_one_block  0.001275777816772461
generate_one_block  0.0016067028045654297
generate_one_block  0.0014770030975341797
generate_one_block  0.0013780593872070312
generate_one_block  0.0017902851104736328
generate_one_block  0.0013914108276367188
generate_one_block  0.0014259815216064453
generate_one_block  0.0015037059783935547
generate_one_block  0.0014498233795166016
generate_one_block  0.0015213489532470703
generate_one_block  0.0014903545379638672
generate_one_block  0.0014159679412841797
generate_one_block  0.001390695571899414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007266998291015625
gen group dst list time:  0.0003006458282470703
time for parepare:  0.0001976490020751953
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00033593177795410156
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0015985965728759766
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.000720977783203125
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007913112640380859
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0008146762847900391
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0014526844024658203
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.001352548599243164
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0011546611785888672
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0018129348754882812
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0012221336364746094
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.001184225082397461
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0011649131774902344
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0010988712310791016
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0012466907501220703
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0011470317840576172
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0009608268737792969
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0009634494781494141
----------------------check_connections_block total spend ----------------------------- 0.029776573181152344
generate_one_block  0.002713441848754883
generate_one_block  0.0017609596252441406
generate_one_block  0.0018236637115478516
generate_one_block  0.0018236637115478516
generate_one_block  0.0033113956451416016
generate_one_block  0.002410888671875
generate_one_block  0.0023849010467529297
generate_one_block  0.00283050537109375
generate_one_block  0.0022270679473876953
generate_one_block  0.0022106170654296875
generate_one_block  0.0022134780883789062
generate_one_block  0.0022420883178710938
generate_one_block  0.002444744110107422
generate_one_block  0.0022411346435546875
generate_one_block  0.002073049545288086
generate_one_block  0.0021076202392578125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008413791656494141
gen group dst list time:  0.0006644725799560547
time for parepare:  0.00019788742065429688
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00043487548828125
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.00255584716796875
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.0001728534698486328
r_  generation:  0.0016798973083496094
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.000171661376953125
r_  generation:  0.0017762184143066406
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.001619100570678711
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.0024454593658447266
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.00024080276489257812
r_  generation:  0.002468109130859375
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.002215147018432617
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.0024857521057128906
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.0001895427703857422
r_  generation:  0.0019690990447998047
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0018951892852783203
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.001828908920288086
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0019500255584716797
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0021691322326660156
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0019311904907226562
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0017044544219970703
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.00025463104248046875
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.0018608570098876953
----------------------check_connections_block total spend ----------------------------- 0.04960823059082031
generate_one_block  0.004512786865234375
generate_one_block  0.0027124881744384766
generate_one_block  0.003100156784057617
generate_one_block  0.002597332000732422
generate_one_block  0.0035371780395507812
generate_one_block  0.0035424232482910156
generate_one_block  0.0032837390899658203
generate_one_block  0.004453182220458984
generate_one_block  0.003213167190551758
generate_one_block  0.003053903579711914
generate_one_block  0.003019094467163086
generate_one_block  0.0031557083129882812
generate_one_block  0.0033905506134033203
generate_one_block  0.0031061172485351562
generate_one_block  0.0028591156005859375
generate_one_block  0.003128528594970703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.0988152027130127
block generation total time  0.13178515434265137
average batch blocks generation time:  0.00823657214641571
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.0749349594116211  GigaBytes
Max Memory Allocated: 0.0749349594116211  GigaBytes

torch.Size([2206, 1433])
torch.Size([1685, 32])
torch.Size([941, 32])
torch.Size([367, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7337679862976074  GigaBytes
Max Memory Allocated: 0.777595043182373  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0721435546875 GB
    Memory Allocated: 0.13469600677490234  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

torch.Size([1723, 1433])
torch.Size([1014, 32])
torch.Size([376, 32])
torch.Size([107, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0819091796875 GB
    Memory Allocated: 0.561347484588623  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.1353468894958496  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

torch.Size([1844, 1433])
torch.Size([1071, 32])
torch.Size([413, 32])
torch.Size([118, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.5914497375488281  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.1341853141784668  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

torch.Size([1627, 1433])
torch.Size([978, 32])
torch.Size([439, 32])
torch.Size([150, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.5427169799804688  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.13670873641967773  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

torch.Size([2092, 1433])
torch.Size([1578, 32])
torch.Size([825, 32])
torch.Size([315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.7639069557189941  GigaBytes
Max Memory Allocated: 0.8321084976196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.1371293067932129  GigaBytes
Max Memory Allocated: 0.8644108772277832  GigaBytes

torch.Size([2172, 1433])
torch.Size([1598, 32])
torch.Size([766, 32])
torch.Size([245, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.7639327049255371  GigaBytes
Max Memory Allocated: 0.8644108772277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.13622093200683594  GigaBytes
Max Memory Allocated: 0.8660411834716797  GigaBytes

torch.Size([2004, 1433])
torch.Size([1394, 32])
torch.Size([626, 32])
torch.Size([199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.7103939056396484  GigaBytes
Max Memory Allocated: 0.8660411834716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2186279296875 GB
    Memory Allocated: 0.1373577117919922  GigaBytes
Max Memory Allocated: 0.8660411834716797  GigaBytes

torch.Size([2210, 1433])
torch.Size([1807, 32])
torch.Size([1072, 32])
torch.Size([369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.8329086303710938  GigaBytes
Max Memory Allocated: 0.8765616416931152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.1360797882080078  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([1977, 1433])
torch.Size([1406, 32])
torch.Size([658, 32])
torch.Size([192, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2615966796875 GB
    Memory Allocated: 0.7037711143493652  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.1359395980834961  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([1904, 1433])
torch.Size([1307, 32])
torch.Size([663, 32])
torch.Size([201, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.668391227722168  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.1353154182434082  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([1834, 1433])
torch.Size([1293, 32])
torch.Size([682, 32])
torch.Size([238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.6625299453735352  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.13643312454223633  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([2043, 1433])
torch.Size([1387, 32])
torch.Size([682, 32])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.6902122497558594  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.1366419792175293  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([2080, 1433])
torch.Size([1554, 32])
torch.Size([783, 32])
torch.Size([252, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.7607159614562988  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.13608598709106445  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([1978, 1433])
torch.Size([1362, 32])
torch.Size([706, 32])
torch.Size([243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.68548583984375  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.13593196868896484  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([1770, 1433])
torch.Size([1187, 32])
torch.Size([573, 32])
torch.Size([218, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.6195073127746582  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 0.1359267234802246  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([1950, 1433])
torch.Size([1293, 32])
torch.Size([581, 32])
torch.Size([194, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2733154296875 GB
    Memory Allocated: 0.6597604751586914  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06025145947933197 |0.022430285811424255 |0.22057759761810303 |0.0001286715269088745 |0.2519680857658386 |0.018430233001708984 |
----------------------------------------------------------pseudo_mini_loss sum 2.9620625972747803
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  68515
Number of first layer input nodes during this epoch:  31414
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26213979721069336  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007517337799072266
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  9.179115295410156e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.0503997802734375e-05
----------------------check_connections_block total spend ----------------------------- 0.003512859344482422
generate_one_block  0.001216888427734375
generate_one_block  0.0013251304626464844
generate_one_block  0.0011470317840576172
generate_one_block  0.0010938644409179688
generate_one_block  0.0010743141174316406
generate_one_block  0.0010943412780761719
generate_one_block  0.0010886192321777344
generate_one_block  0.0010695457458496094
generate_one_block  0.0010995864868164062
generate_one_block  0.0010993480682373047
generate_one_block  0.001049041748046875
generate_one_block  0.0010454654693603516
generate_one_block  0.0010895729064941406
generate_one_block  0.0010662078857421875
generate_one_block  0.0010876655578613281
generate_one_block  0.001008749008178711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006539821624755859
gen group dst list time:  9.894371032714844e-05
time for parepare:  0.00020241737365722656
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0001800060272216797
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00013899803161621094
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001704692840576172
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001685619354248047
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00014138221740722656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00011563301086425781
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.225440979003906e-05
----------------------check_connections_block total spend ----------------------------- 0.006061077117919922
generate_one_block  0.0013272762298583984
generate_one_block  0.0012257099151611328
generate_one_block  0.0012459754943847656
generate_one_block  0.0012662410736083984
generate_one_block  0.0012555122375488281
generate_one_block  0.0012025833129882812
generate_one_block  0.0011851787567138672
generate_one_block  0.0011148452758789062
generate_one_block  0.0012428760528564453
generate_one_block  0.0010564327239990234
generate_one_block  0.0015759468078613281
generate_one_block  0.0010631084442138672
generate_one_block  0.0010523796081542969
generate_one_block  0.001050710678100586
generate_one_block  0.0011320114135742188
generate_one_block  0.0010631084442138672
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007941722869873047
gen group dst list time:  0.00017547607421875
time for parepare:  0.00024127960205078125
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0002982616424560547
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0005707740783691406
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.00045418739318847656
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0005929470062255859
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0006546974182128906
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0006735324859619141
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0005404949188232422
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005426406860351562
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007393360137939453
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0002779960632324219
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00043082237243652344
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.000316619873046875
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002701282501220703
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002560615539550781
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005774497985839844
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00029659271240234375
----------------------check_connections_block total spend ----------------------------- 0.014792919158935547
generate_one_block  0.001806020736694336
generate_one_block  0.0016062259674072266
generate_one_block  0.0017902851104736328
generate_one_block  0.0018310546875
generate_one_block  0.0017657279968261719
generate_one_block  0.0016033649444580078
generate_one_block  0.001739501953125
generate_one_block  0.0014750957489013672
generate_one_block  0.0018665790557861328
generate_one_block  0.0012972354888916016
generate_one_block  0.0014605522155761719
generate_one_block  0.0013566017150878906
generate_one_block  0.0012695789337158203
generate_one_block  0.0012524127960205078
generate_one_block  0.001674652099609375
generate_one_block  0.0012760162353515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008091926574707031
gen group dst list time:  0.0003895759582519531
time for parepare:  0.00022268295288085938
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00036787986755371094
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0014727115631103516
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0011057853698730469
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0014667510986328125
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0015590190887451172
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0015192031860351562
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0015170574188232422
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0015034675598144531
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0011546611785888672
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0016341209411621094
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.0008037090301513672
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.001039743423461914
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0009357929229736328
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0007374286651611328
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0006687641143798828
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0012867450714111328
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0007176399230957031
----------------------check_connections_block total spend ----------------------------- 0.03130030632019043
generate_one_block  0.0027854442596435547
generate_one_block  0.002261638641357422
generate_one_block  0.0026443004608154297
generate_one_block  0.002954721450805664
generate_one_block  0.002714872360229492
generate_one_block  0.002722501754760742
generate_one_block  0.0026471614837646484
generate_one_block  0.0023272037506103516
generate_one_block  0.0028197765350341797
generate_one_block  0.0019593238830566406
generate_one_block  0.0022089481353759766
generate_one_block  0.0021724700927734375
generate_one_block  0.001954317092895508
generate_one_block  0.0018398761749267578
generate_one_block  0.002593517303466797
generate_one_block  0.0019114017486572266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008673667907714844
gen group dst list time:  0.0007081031799316406
time for parepare:  0.00021791458129882812
local_output_nid generation:  0.00014281272888183594
local_in_edges_tensor generation:  0.0004942417144775391
mini_batch_src_global generation:  0.0007128715515136719
r_  generation:  0.002374410629272461
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.002000570297241211
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.0023550987243652344
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.0025696754455566406
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003292560577392578
mini_batch_src_global generation:  0.0002448558807373047
r_  generation:  0.002393484115600586
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003161430358886719
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.0024242401123046875
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0022225379943847656
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.0020208358764648438
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.002415895462036133
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0016071796417236328
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.0018908977508544922
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0018982887268066406
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.00171661376953125
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0015227794647216797
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0022194385528564453
local_output_nid generation:  9.560585021972656e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0015726089477539062
----------------------check_connections_block total spend ----------------------------- 0.052938222885131836
generate_one_block  0.004072427749633789
generate_one_block  0.003297567367553711
generate_one_block  0.0035538673400878906
generate_one_block  0.003780841827392578
generate_one_block  0.0036258697509765625
generate_one_block  0.0037322044372558594
generate_one_block  0.0035829544067382812
generate_one_block  0.0034084320068359375
generate_one_block  0.0038175582885742188
generate_one_block  0.002997875213623047
generate_one_block  0.0032558441162109375
generate_one_block  0.0032622814178466797
generate_one_block  0.003189563751220703
generate_one_block  0.0028657913208007812
generate_one_block  0.0036461353302001953
generate_one_block  0.0029141902923583984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26213979721069336  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

connection checking time:  0.10509252548217773
block generation total time  0.13765168190002441
average batch blocks generation time:  0.008603230118751526
block dataloader generation time/epoch 0.37726306915283203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26261138916015625  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

torch.Size([2059, 1433])
torch.Size([1539, 32])
torch.Size([828, 32])
torch.Size([260, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.8762431144714355  GigaBytes
Max Memory Allocated: 0.9286465644836426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26201438903808594  GigaBytes
Max Memory Allocated: 0.9756150245666504  GigaBytes

torch.Size([1890, 1433])
torch.Size([1253, 32])
torch.Size([578, 32])
torch.Size([216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.771125316619873  GigaBytes
Max Memory Allocated: 0.9756150245666504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26223230361938477  GigaBytes
Max Memory Allocated: 0.9756150245666504  GigaBytes

torch.Size([1988, 1433])
torch.Size([1514, 32])
torch.Size([843, 32])
torch.Size([288, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.8626828193664551  GigaBytes
Max Memory Allocated: 0.9756150245666504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26313114166259766  GigaBytes
Max Memory Allocated: 0.9756150245666504  GigaBytes

torch.Size([2155, 1433])
torch.Size([1692, 32])
torch.Size([908, 32])
torch.Size([313, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.9251785278320312  GigaBytes
Max Memory Allocated: 0.9756150245666504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26249217987060547  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

torch.Size([2036, 1433])
torch.Size([1561, 32])
torch.Size([859, 32])
torch.Size([330, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.8738760948181152  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26288557052612305  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

torch.Size([2110, 1433])
torch.Size([1652, 32])
torch.Size([861, 32])
torch.Size([243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.9095888137817383  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.2623324394226074  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

torch.Size([2007, 1433])
torch.Size([1550, 32])
torch.Size([852, 32])
torch.Size([247, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.8776741027832031  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.2620835304260254  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

torch.Size([1963, 1433])
torch.Size([1376, 32])
torch.Size([609, 32])
torch.Size([211, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.827150821685791  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.263211727142334  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

torch.Size([2169, 1433])
torch.Size([1740, 32])
torch.Size([971, 32])
torch.Size([391, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.9373683929443359  GigaBytes
Max Memory Allocated: 1.0228228569030762  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.26199817657470703  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([1812, 1433])
torch.Size([1068, 32])
torch.Size([423, 32])
torch.Size([111, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.7145771980285645  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.261873722076416  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([1925, 1433])
torch.Size([1297, 32])
torch.Size([563, 32])
torch.Size([215, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.7824392318725586  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.2620105743408203  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([1922, 1433])
torch.Size([1305, 32])
torch.Size([542, 32])
torch.Size([151, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.7901191711425781  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.2613215446472168  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([1824, 1433])
torch.Size([1143, 32])
torch.Size([426, 32])
torch.Size([133, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.735814094543457  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.26093053817749023  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([1752, 1433])
torch.Size([995, 32])
torch.Size([374, 32])
torch.Size([117, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.6845908164978027  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.26287078857421875  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([2108, 1433])
torch.Size([1562, 32])
torch.Size([811, 32])
torch.Size([310, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.8776154518127441  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.2619953155517578  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

torch.Size([1803, 1433])
torch.Size([1060, 32])
torch.Size([410, 32])
torch.Size([132, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.6973361968994141  GigaBytes
Max Memory Allocated: 1.0332975387573242  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06290026009082794 |0.0008338987827301025 |0.1917169690132141 |0.00012539327144622803 |0.2481033056974411 |0.01701974868774414 |
----------------------------------------------------------pseudo_mini_loss sum 2.5182247161865234
Total (block generation + training)time/epoch 8.522969722747803
Training time/epoch 8.145459413528442
Training time without block to device /epoch 8.13211703300476
Training time without total dataloading part /epoch 7.056150436401367
load block tensor time/epoch 1.006404161453247
block to device time/epoch 0.01334238052368164
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  69119
Number of first layer input nodes during this epoch:  31523
