main start at this time 1648432828.5202198
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001104593276977539
range selection method range initialization spend 0.00011849403381347656
time for parepare:  8.034706115722656e-05
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.002556324005126953
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.724761962890625e-05
----------------------check_connections_block total spend ----------------------------- 0.004029989242553711
generate_one_block  0.0016207695007324219
generate_one_block  0.0013623237609863281
generate_one_block  0.0013260841369628906
generate_one_block  0.0013082027435302734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005865097045898438
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.0001723766326904297
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004401206970214844
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005869865417480469
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005099773406982422
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00046372413635253906
----------------------check_connections_block total spend ----------------------------- 0.0038251876831054688
generate_one_block  0.0017693042755126953
generate_one_block  0.0019061565399169922
generate_one_block  0.0018246173858642578
generate_one_block  0.0018355846405029297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006823539733886719
gen group dst list time:  0.00010013580322265625
time for parepare:  0.00022602081298828125
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0013403892517089844
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0017552375793457031
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0015256404876708984
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0014202594757080078
----------------------check_connections_block total spend ----------------------------- 0.00976705551147461
generate_one_block  0.0027608871459960938
generate_one_block  0.002719402313232422
generate_one_block  0.0022852420806884766
generate_one_block  0.0021822452545166016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00070953369140625
gen group dst list time:  0.00013685226440429688
time for parepare:  0.00019025802612304688
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.0003731250762939453
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.0022821426391601562
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.0002987384796142578
r_  generation:  0.002565145492553711
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0023605823516845703
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.0022611618041992188
----------------------check_connections_block total spend ----------------------------- 0.014523506164550781
generate_one_block  0.0036017894744873047
generate_one_block  0.003500699996948242
generate_one_block  0.003459930419921875
generate_one_block  0.0032236576080322266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007920265197753906
gen group dst list time:  0.0001926422119140625
time for parepare:  0.00019860267639160156
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0031239986419677734
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.0003666877746582031
mini_batch_src_global generation:  0.0003190040588378906
r_  generation:  0.0031859874725341797
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.0030221939086914062
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.002968311309814453
----------------------check_connections_block total spend ----------------------------- 0.018598079681396484
generate_one_block  0.005191326141357422
generate_one_block  0.0040242671966552734
generate_one_block  0.0038640499114990234
generate_one_block  0.0038208961486816406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06304550170898438  GigaBytes
Max Memory Allocated: 0.06304550170898438  GigaBytes

connection checking time:  0.046713829040527344
block generation total time  0.04797005653381348
average batch blocks generation time:  0.01199251413345337
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07687139511108398  GigaBytes
Max Memory Allocated: 0.07687139511108398  GigaBytes

torch.Size([2404, 1433])
torch.Size([2123, 32])
torch.Size([1419, 32])
torch.Size([646, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.8759846687316895  GigaBytes
Max Memory Allocated: 0.924492359161377  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.13832426071166992  GigaBytes
Max Memory Allocated: 0.9636821746826172  GigaBytes

torch.Size([2382, 1433])
torch.Size([2195, 32])
torch.Size([1635, 32])
torch.Size([818, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 0.9558019638061523  GigaBytes
Max Memory Allocated: 1.0000004768371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.13816547393798828  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

torch.Size([2355, 1433])
torch.Size([2054, 32])
torch.Size([1480, 32])
torch.Size([688, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.9115605354309082  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.13788652420043945  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

torch.Size([2304, 1433])
torch.Size([2005, 32])
torch.Size([1409, 32])
torch.Size([633, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.8934035301208496  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05621135234832764 |0.08836895227432251 |0.35790467262268066 |0.00017255544662475586 |0.32234489917755127 |0.017747879028320312 |
----------------------------------------------------------pseudo_mini_loss sum 2.926433563232422
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27282
Number of first layer input nodes during this epoch:  9445
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.2642350196838379  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005552768707275391
range selection method range initialization spend 7.128715515136719e-05
time for parepare:  8.368492126464844e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.3882598876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0013611316680908203
generate_one_block  0.0013070106506347656
generate_one_block  0.0012192726135253906
generate_one_block  0.001201629638671875
generate_one_block  0.001146554946899414
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005452632904052734
gen group dst list time:  4.9114227294921875e-05
time for parepare:  0.0001678466796875
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005080699920654297
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0004825592041015625
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0003974437713623047
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003528594970703125
----------------------check_connections_block total spend ----------------------------- 0.003499746322631836
generate_one_block  0.001950979232788086
generate_one_block  0.0017201900482177734
generate_one_block  0.001588582992553711
generate_one_block  0.0015099048614501953
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006086826324462891
gen group dst list time:  8.797645568847656e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0014061927795410156
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0014655590057373047
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0011746883392333984
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0011358261108398438
----------------------check_connections_block total spend ----------------------------- 0.008477210998535156
generate_one_block  0.0028409957885742188
generate_one_block  0.0028367042541503906
generate_one_block  0.0024149417877197266
generate_one_block  0.002299785614013672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007975101470947266
gen group dst list time:  0.00014781951904296875
time for parepare:  0.0001990795135498047
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0004029273986816406
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.002413034439086914
local_output_nid generation:  0.00013899803161621094
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.002595186233520508
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.0002892017364501953
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.002294301986694336
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0022983551025390625
----------------------check_connections_block total spend ----------------------------- 0.014850854873657227
generate_one_block  0.0036716461181640625
generate_one_block  0.003770589828491211
generate_one_block  0.003602743148803711
generate_one_block  0.0036191940307617188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008113384246826172
gen group dst list time:  0.00019502639770507812
time for parepare:  0.00020575523376464844
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0002639293670654297
r_  generation:  0.0041654109954833984
local_output_nid generation:  0.00018024444580078125
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.00033092498779296875
r_  generation:  0.003173351287841797
local_output_nid generation:  0.0001804828643798828
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.003099203109741211
local_output_nid generation:  0.00018286705017089844
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation: Using backend: pytorch
 0.0002567768096923828
r_  generation:  0.00313568115234375
----------------------check_connections_block total spend ----------------------------- 0.020049571990966797
generate_one_block  0.004940509796142578
generate_one_block  0.004461765289306641
generate_one_block  0.0042896270751953125
generate_one_block  0.00421452522277832
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.2642350196838379  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

connection checking time:  0.046877384185791016
block generation total time  0.04973268508911133
average batch blocks generation time:  0.012433171272277832
block dataloader generation time/epoch 0.14446282386779785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.2639484405517578  GigaBytes
Max Memory Allocated: 1.0384502410888672  GigaBytes

torch.Size([2299, 1433])
torch.Size([2045, 32])
torch.Size([1501, 32])
torch.Size([754, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.0329499244689941  GigaBytes
Max Memory Allocated: 1.0740242004394531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.26422882080078125  GigaBytes
Max Memory Allocated: 1.1179518699645996  GigaBytes

torch.Size([2350, 1433])
torch.Size([2146, 32])
torch.Size([1621, 32])
torch.Size([787, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.067833423614502  GigaBytes
Max Memory Allocated: 1.1179518699645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.26427268981933594  GigaBytes
Max Memory Allocated: 1.151109218597412  GigaBytes

torch.Size([2361, 1433])
torch.Size([2100, 32])
torch.Size([1411, 32])
torch.Size([648, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.0483746528625488  GigaBytes
Max Memory Allocated: 1.151109218597412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 0.2643923759460449  GigaBytes
Max Memory Allocated: 1.151109218597412  GigaBytes

torch.Size([2384, 1433])
torch.Size([2093, 32])
torch.Size([1399, 32])
torch.Size([605, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4393310546875 GB
    Memory Allocated: 1.0455961227416992  GigaBytes
Max Memory Allocated: 1.151109218597412  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05366110801696777 |0.0011234283447265625 |0.23967397212982178 |0.00013631582260131836 |0.3267657160758972 |0.014430999755859375 |
----------------------------------------------------------pseudo_mini_loss sum 2.2695436477661133
Total (block generation + training)time/epoch 2.7110583782196045
Training time/epoch 2.566204786300659
Training time without block to device /epoch 2.561711072921753
Training time without total dataloading part /epoch 2.2807350158691406
load block tensor time/epoch 0.2146444320678711
block to device time/epoch 0.00449371337890625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27243
Number of first layer input nodes during this epoch:  9394
