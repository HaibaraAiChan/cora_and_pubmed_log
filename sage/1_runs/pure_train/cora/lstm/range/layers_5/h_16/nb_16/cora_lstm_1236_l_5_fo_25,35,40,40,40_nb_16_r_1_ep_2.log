main start at this time 1648432790.1158745
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012946128845214844
range selection method range initialization spend 8.273124694824219e-05
time for parepare:  6.437301635742188e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0011794567108154297
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8835067749023438e-05
----------------------check_connections_block total spend ----------------------------- 0.0041239261627197266
generate_one_block  0.0011868476867675781
generate_one_block  0.001026153564453125
generate_one_block  0.0009722709655761719
generate_one_block  0.0009765625
generate_one_block  0.0009746551513671875
generate_one_block  0.0009548664093017578
generate_one_block  0.0010156631469726562
generate_one_block  0.0009768009185791016
generate_one_block  0.0009608268737792969
generate_one_block  0.0009679794311523438
generate_one_block  0.0009567737579345703
generate_one_block  0.0009710788726806641
generate_one_block  0.0009694099426269531
generate_one_block  0.0009584426879882812
generate_one_block  0.0009984970092773438
generate_one_block  0.0009641647338867188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
gen group dst list time:  8.392333984375e-05
time for parepare:  0.0001385211944580078
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011491775512695312
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011539459228515625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00016760826110839844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0002009868621826172
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010061264038085938
----------------------check_connections_block total spend ----------------------------- 0.0051746368408203125
generate_one_block  0.0011036396026611328
generate_one_block  0.0011744499206542969
generate_one_block  0.0010862350463867188
generate_one_block  0.001155853271484375
generate_one_block  0.001165151596069336
generate_one_block  0.0010235309600830078
generate_one_block  0.0011756420135498047
generate_one_block  0.0010874271392822266
generate_one_block  0.0010249614715576172
generate_one_block  0.0011239051818847656
generate_one_block  0.0010957717895507812
generate_one_block  0.0011055469512939453
generate_one_block  0.001100301742553711
generate_one_block  0.0010657310485839844
generate_one_block  0.0010673999786376953
generate_one_block  0.0010843276977539062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00067138671875
gen group dst list time:  0.00016379356384277344
time for parepare:  0.0001895427703857422
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.000370025634765625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00047397613525390625
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004341602325439453
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006108283996582031
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005066394805908203
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0006251335144042969
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.000392913818359375
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00052642822265625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004367828369140625
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00046634674072265625
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00033926963806152344
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00035262107849121094
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004227161407470703
----------------------check_connections_block total spend ----------------------------- 0.012363195419311523
generate_one_block  0.0014057159423828125
generate_one_block  0.0015075206756591797
generate_one_block  0.0017311573028564453
generate_one_block  0.0016872882843017578
generate_one_block  0.0015497207641601562
generate_one_block  0.0011649131774902344
generate_one_block  0.0017199516296386719
generate_one_block  0.001438140869140625
generate_one_block  0.0011773109436035156
generate_one_block  0.0015797615051269531
generate_one_block  0.0017123222351074219
generate_one_block  0.0015065670013427734
generate_one_block  0.0013470649719238281
generate_one_block  0.0013630390167236328
generate_one_block  0.0013530254364013672
generate_one_block  0.001447439193725586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007243156433105469
gen group dst list time:  0.0002493858337402344
time for parepare:  0.00018215179443359375
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0009069442749023438
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0012335777282714844
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0011894702911376953
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0015020370483398438
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0013654232025146484
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004947185516357422
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0014836788177490234
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0010533332824707031
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006272792816162109
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0013282299041748047
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0011878013610839844
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0012080669403076172
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.0010685920715332031
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0010471343994140625
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0009546279907226562
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0010454654693603516
----------------------check_connections_block total spend ----------------------------- 0.028209447860717773
generate_one_block  0.002051115036010742
generate_one_block  0.0023801326751708984
generate_one_block  0.0023288726806640625
generate_one_block  0.002783060073852539
generate_one_block  0.0025968551635742188
generate_one_block  0.0015091896057128906
generate_one_block  0.0029370784759521484
generate_one_block  0.002248525619506836
generate_one_block  0.0016868114471435547
generate_one_block  0.0033261775970458984
generate_one_block  0.0023894309997558594
generate_one_block  0.002392292022705078
generate_one_block  0.002189159393310547
generate_one_block  0.002178192138671875
generate_one_block  0.002051830291748047
generate_one_block  0.002178668975830078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007503032684326172
gen group dst list time:  0.0005924701690673828
time for parepare:  0.00017881393432617188
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00041556358337402344
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0017719268798828125
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0021190643310546875
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.0001876354217529297
r_  generation:  0.0021114349365234375
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00023221969604492188
r_  generation:  0.002507925033569336
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0023229122161865234
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.001157522201538086
local_output_nid generation:  0.0001232624053955078
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0023746490478515625
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0019867420196533203
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.001461029052734375
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.00018930435180664062
r_  generation:  0.0021991729736328125
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0020151138305664062
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0020895004272460938
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.002084970474243164
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.002131938934326172
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.0001876354217529297
r_  generation:  0.0018706321716308594
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0019001960754394531
----------------------check_connections_block total spend ----------------------------- 0.04881930351257324
generate_one_block  0.0038611888885498047
generate_one_block  0.0032434463500976562
generate_one_block  0.0035893917083740234
generate_one_block  0.0036690235137939453
generate_one_block  0.0035161972045898438
generate_one_block  0.0022814273834228516
generate_one_block  0.0035483837127685547
generate_one_block  0.0032646656036376953
generate_one_block  0.002636432647705078
generate_one_block  0.004218101501464844
generate_one_block  0.0032286643981933594
generate_one_block  0.003320455551147461
generate_one_block  0.003309011459350586
generate_one_block  0.0032525062561035156
generate_one_block  0.003061056137084961
generate_one_block  0.0031709671020507812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.09456658363342285
block generation total time  0.1317291259765625
average batch blocks generation time:  0.008233070373535156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07301998138427734  GigaBytes
Max Memory Allocated: 0.07301998138427734  GigaBytes

torch.Size([1906, 1433])
torch.Size([1230, 16])
torch.Size([552, 16])
torch.Size([207, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.5773487091064453  GigaBytes
Max Memory Allocated: 0.6167097091674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.1359696388244629  GigaBytes
Max Memory Allocated: 0.6884160041809082  GigaBytes

torch.Size([1938, 1433])
torch.Size([1452, 16])
torch.Size([779, 16])
torch.Size([243, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7093701362609863  GigaBytes
Max Memory Allocated: 0.7522811889648438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.13733863830566406  GigaBytes
Max Memory Allocated: 0.8163304328918457  GigaBytes

torch.Size([2045, 1433])
torch.Size([1472, 16])
torch.Size([747, 16])
torch.Size([228, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.715395450592041  GigaBytes
Max Memory Allocated: 0.8163304328918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.1378493309020996  GigaBytes
Max Memory Allocated: 0.8228836059570312  GigaBytes

torch.Size([2286, 1433])
torch.Size([1805, 16])
torch.Size([1000, 16])
torch.Size([314, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.8344178199768066  GigaBytes
Max Memory Allocated: 0.8872871398925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.13735198974609375  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2152, 1433])
torch.Size([1657, 16])
torch.Size([853, 16])
torch.Size([276, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7870674133300781  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13355398178100586  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([1495, 1433])
torch.Size([762, 16])
torch.Size([314, 16])
torch.Size([95, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.44759321212768555  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.1371912956237793  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2152, 1433])
torch.Size([1663, 16])
torch.Size([966, 16])
torch.Size([352, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7855730056762695  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13628578186035156  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([1999, 1433])
torch.Size([1382, 16])
torch.Size([663, 16])
torch.Size([221, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.6838059425354004  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13465547561645508  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([1699, 1433])
torch.Size([986, 16])
torch.Size([357, 16])
torch.Size([109, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.5461645126342773  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13735008239746094  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2104, 1433])
torch.Size([1581, 16])
torch.Size([854, 16])
torch.Size([295, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7593536376953125  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13619518280029297  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([1981, 1433])
torch.Size([1450, 16])
torch.Size([732, 16])
torch.Size([239, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7049984931945801  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.1373424530029297  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2043, 1433])
torch.Size([1486, 16])
torch.Size([738, 16])
torch.Size([259, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7294859886169434  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.1367201805114746  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2080, 1433])
torch.Size([1468, 16])
torch.Size([639, 16])
torch.Size([175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7319397926330566  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13733291625976562  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2077, 1433])
torch.Size([1429, 16])
torch.Size([637, 16])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.7088003158569336  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13608169555664062  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([1962, 1433])
torch.Size([1290, 16])
torch.Size([572, 16])
torch.Size([161, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.6641645431518555  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.13596534729003906  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([1939, 1433])
torch.Size([1348, 16])
torch.Size([664, 16])
torch.Size([235, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.6760282516479492  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06099787354469299 |0.021973714232444763 |0.220069020986557 |0.00012114644050598145 |0.2634380906820297 |0.01766371726989746 |
----------------------------------------------------------pseudo_mini_loss sum 2.891936779022217
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  69753
Number of first layer input nodes during this epoch:  31858
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.26163196563720703  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006899833679199219
range selection method range initialization spend 8.225440979003906e-05
time for parepare:  8.797645568847656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  1.4543533325195312e-05
----------------------check_connections_block total spend ----------------------------- 0.003448963165283203
generate_one_block  0.0011942386627197266
generate_one_block  0.0012924671173095703
generate_one_block  0.0010230541229248047
generate_one_block  0.0010571479797363281
generate_one_block  0.0010547637939453125
generate_one_block  0.0010023117065429688
generate_one_block  0.0009949207305908203
generate_one_block  0.0010519027709960938
generate_one_block  0.0010046958923339844
generate_one_block  0.000989675521850586
generate_one_block  0.0015151500701904297
generate_one_block  0.001039266586303711
generate_one_block  0.0010955333709716797
generate_one_block  0.0011191368103027344
generate_one_block  0.0011363029479980469
generate_one_block  0.000982046127319336
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006830692291259766
gen group dst list time:  0.00010395050048828125
time for parepare:  0.00021958351135253906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00012969970703125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001499652862548828
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00013685226440429688
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00015234947204589844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00020766258239746094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00014662742614746094
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001850128173828125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001621246337890625
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.2928924560546875e-05
----------------------check_connections_block total spend ----------------------------- 0.005976200103759766
generate_one_block  0.001230001449584961
generate_one_block  0.0011975765228271484
generate_one_block  0.0011806488037109375
generate_one_block  0.0012035369873046875
generate_one_block  0.0011525154113769531
generate_one_block  0.0012426376342773438
generate_one_block  0.0011713504791259766
generate_one_block  0.001138925552368164
generate_one_block  0.0011472702026367188
generate_one_block  0.0010690689086914062
generate_one_block  0.0017402172088623047
generate_one_block  0.001116037368774414
generate_one_block  0.0010907649993896484
generate_one_block  0.0011904239654541016
generate_one_block  0.0011837482452392578
generate_one_block  0.0010232925415039062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008182525634765625
gen group dst list time:  0.0001678466796875
time for parepare:  0.00023698806762695312
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.00046515464782714844
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0005350112915039062
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0003833770751953125
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005667209625244141
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.0005044937133789062
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005452632904052734
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005831718444824219
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0004696846008300781
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0003070831298828125
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00030350685119628906
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0006814002990722656
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00036072731018066406
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003216266632080078
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0006918907165527344
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.00040650367736816406
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00020623207092285156
----------------------check_connections_block total spend ----------------------------- 0.014347553253173828
generate_one_block  0.001585245132446289
generate_one_block  0.0017330646514892578
generate_one_block  0.0014693737030029297
generate_one_block  0.001764059066772461
generate_one_block  0.0015718936920166016
generate_one_block  0.0017213821411132812
generate_one_block  0.001847982406616211
generate_one_block  0.0015676021575927734
generate_one_block  0.0012814998626708984
generate_one_block  0.0013275146484375
generate_one_block  0.0018956661224365234
generate_one_block  0.0014190673828125
generate_one_block  0.0013926029205322266
generate_one_block  0.001802682876586914
generate_one_block  0.0014352798461914062
generate_one_block  0.0012257099151611328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008132457733154297
gen group dst list time:  0.0003552436828613281
time for parepare:  0.00019979476928710938
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0003485679626464844
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0012209415435791016
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0013055801391601562
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.001149892807006836
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0014011859893798828
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0013833045959472656
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.000225067138671875
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0014164447784423828
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0014462471008300781
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0011327266693115234
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.000743865966796875
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0008456707000732422
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0015664100646972656
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0009217262268066406
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0008597373962402344
local_output_nid generation:  8.20159912109375e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0015208721160888672
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0009641647338867188
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0006606578826904297
----------------------check_connections_block total spend ----------------------------- 0.03065800666809082
generate_one_block  0.0027654170989990234
generate_one_block  0.0026137828826904297
generate_one_block  0.0023717880249023438
generate_one_block  0.0029587745666503906
generate_one_block  0.0026352405548095703
generate_one_block  0.002744436264038086
generate_one_block  0.0027022361755371094
generate_one_block  0.0023818016052246094
generate_one_block  0.0018875598907470703
generate_one_block  0.002084970474243164
generate_one_block  0.0028984546661376953
generate_one_block  0.002174854278564453
generate_one_block  0.0020706653594970703
generate_one_block  0.0028772354125976562
generate_one_block  0.002206563949584961
generate_one_block  0.0018799304962158203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009157657623291016
gen group dst list time:  0.000743865966796875
time for parepare:  0.0002117156982421875
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.002313375473022461
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.00024080276489257812
r_  generation:  0.0022628307342529297
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.002079486846923828
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.0022966861724853516
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0023267269134521484
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.00032019615173339844
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.002308368682861328
local_output_nid generation:  0.00013756752014160156
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0023488998413085938
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.001895904541015625
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0014989376068115234
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0006046295166015625
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0017695426940917969
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.00021219253540039062
r_  generation:  0.0023412704467773438
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.0001819133758544922
r_  generation:  0.0017464160919189453
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0017254352569580078
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0023767948150634766
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0018863677978515625
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0016682147979736328
----------------------check_connections_block total spend ----------------------------- 0.051937103271484375
generate_one_block  0.0045626163482666016
generate_one_block  0.0037441253662109375
generate_one_block  0.0034966468811035156
generate_one_block  0.0037043094635009766
generate_one_block  0.0037279129028320312
generate_one_block  0.003737926483154297
generate_one_block  0.0038268566131591797
generate_one_block  0.0032596588134765625
generate_one_block  0.0028333663940429688
generate_one_block  0.003237009048461914
generate_one_block  0.0037877559661865234
generate_one_block  0.0031256675720214844
generate_one_block  0.0032379627227783203
generate_one_block  0.0037851333618164062
generate_one_block  0.003281831741333008
generate_one_block  0.0030515193939208984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.26163196563720703  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

connection checking time:  0.10291886329650879
block generation total time  0.13977265357971191
average batch blocks generation time:  0.008735790848731995
block dataloader generation time/epoch 0.3883683681488037
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.2622394561767578  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

torch.Size([2079, 1433])
torch.Size([1569, 16])
torch.Size([712, 16])
torch.Size([247, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 0.8763747215270996  GigaBytes
Max Memory Allocated: 0.9371099472045898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.2628631591796875  GigaBytes
Max Memory Allocated: 0.9821643829345703  GigaBytes

torch.Size([2047, 1433])
torch.Size([1519, 16])
torch.Size([775, 16])
torch.Size([272, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8652825355529785  GigaBytes
Max Memory Allocated: 0.9821643829345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26198530197143555  GigaBytes
Max Memory Allocated: 0.9821643829345703  GigaBytes

torch.Size([2033, 1433])
torch.Size([1410, 16])
torch.Size([630, 16])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.8312921524047852  GigaBytes
Max Memory Allocated: 0.9821643829345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26287078857421875  GigaBytes
Max Memory Allocated: 0.9821643829345703  GigaBytes

torch.Size([2115, 1433])
torch.Size([1622, 16])
torch.Size([874, 16])
torch.Size([279, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.8896965980529785  GigaBytes
Max Memory Allocated: 0.9821643829345703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26244163513183594  GigaBytes
Max Memory Allocated: 0.9943051338195801  GigaBytes

torch.Size([2116, 1433])
torch.Size([1619, 16])
torch.Size([784, 16])
torch.Size([258, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.8967690467834473  GigaBytes
Max Memory Allocated: 0.9943051338195801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26286983489990234  GigaBytes
Max Memory Allocated: 1.00181245803833  GigaBytes

torch.Size([2111, 1433])
torch.Size([1640, 16])
torch.Size([864, 16])
torch.Size([278, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.8978238105773926  GigaBytes
Max Memory Allocated: 1.00181245803833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2626466751098633  GigaBytes
Max Memory Allocated: 1.0018486976623535  GigaBytes

torch.Size([2153, 1433])
torch.Size([1644, 16])
torch.Size([851, 16])
torch.Size([288, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.9110941886901855  GigaBytes
Max Memory Allocated: 1.0018486976623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26095056533813477  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes
Using backend: pytorch

torch.Size([1839, 1433])
torch.Size([1298, 16])
torch.Size([693, 16])
torch.Size([232, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.7815966606140137  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26000547409057617  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

torch.Size([1667, 1433])
torch.Size([998, 16])
torch.Size([396, 16])
torch.Size([138, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.6684126853942871  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2617506980895996  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

torch.Size([1881, 1433])
torch.Size([1210, 16])
torch.Size([476, 16])
torch.Size([148, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.7540488243103027  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2628793716430664  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

torch.Size([2123, 1433])
torch.Size([1668, 16])
torch.Size([995, 16])
torch.Size([373, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.9077634811401367  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.261019229888916  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

torch.Size([1854, 1433])
torch.Size([1179, 16])
torch.Size([534, 16])
torch.Size([169, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.7448267936706543  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26114940643310547  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

torch.Size([1879, 1433])
torch.Size([1171, 16])
torch.Size([526, 16])
torch.Size([178, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.7379870414733887  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2624931335449219  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

torch.Size([2123, 1433])
torch.Size([1690, 16])
torch.Size([959, 16])
torch.Size([333, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.914456844329834  GigaBytes
Max Memory Allocated: 1.015212059020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.26160669326782227  GigaBytes
Max Memory Allocated: 1.017247200012207  GigaBytes

torch.Size([1963, 1433])
torch.Size([1285, 16])
torch.Size([569, 16])
torch.Size([226, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.784339427947998  GigaBytes
Max Memory Allocated: 1.017247200012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2610592842102051  GigaBytes
Max Memory Allocated: 1.017247200012207  GigaBytes

torch.Size([1864, 1433])
torch.Size([1098, 16])
torch.Size([356, 16])
torch.Size([94, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.7233748435974121  GigaBytes
Max Memory Allocated: 1.017247200012207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06019987165927887 |0.0011374950408935547 |0.1977611631155014 |0.00015406310558319092 |0.27068524062633514 |0.01431131362915039 |
----------------------------------------------------------pseudo_mini_loss sum 2.51611328125
Total (block generation + training)time/epoch 8.954657316207886
Training time/epoch 8.565952062606812
Training time without block to device /epoch 8.547752141952515
Training time without total dataloading part /epoch 7.511918783187866
load block tensor time/epoch 0.9631979465484619
block to device time/epoch 0.018199920654296875
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  69939
Number of first layer input nodes during this epoch:  31847
