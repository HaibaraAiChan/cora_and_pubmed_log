main start at this time 1648432771.330355
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0015735626220703125
range selection method range initialization spend 7.939338684082031e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0027446746826171875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.004619598388671875
generate_one_block  0.0014564990997314453
generate_one_block  0.0010094642639160156
generate_one_block  0.0010135173797607422
generate_one_block  0.001016855239868164
generate_one_block  0.0009694099426269531
generate_one_block  0.0009615421295166016
generate_one_block  0.001008749008178711
generate_one_block  0.0009584426879882812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00047707557678222656
gen group dst list time:  5.364418029785156e-05
time for parepare:  0.0001304149627685547
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00028705596923828125
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002677440643310547
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001704692840576172
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00016641616821289062
----------------------check_connections_block total spend ----------------------------- 0.0038046836853027344
generate_one_block  0.0012366771697998047
generate_one_block  0.0013089179992675781
generate_one_block  0.0011467933654785156
generate_one_block  0.0012404918670654297
generate_one_block  0.0012142658233642578
generate_one_block  0.00118255615234375
generate_one_block  0.0011751651763916016
generate_one_block  0.0011970996856689453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006692409515380859
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.0001811981201171875
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0007517337799072266
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0009291172027587891
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.000621795654296875
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0008192062377929688
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0006978511810302734
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007340908050537109
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005943775177001953
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0005855560302734375
----------------------check_connections_block total spend ----------------------------- 0.00982666015625
generate_one_block  0.0019571781158447266
generate_one_block  0.0020112991333007812
generate_one_block  0.0017468929290771484
generate_one_block  0.0019469261169433594
generate_one_block  0.0017702579498291016
generate_one_block  0.0019261837005615234
generate_one_block  0.0016970634460449219
generate_one_block  0.0016188621520996094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007238388061523438
gen group dst list time:  0.0001804828643798828
time for parepare:  0.00018072128295898438
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.00167083740234375
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0019137859344482422
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0017006397247314453
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0017375946044921875
local_output_nid generation:  7.534027099609375e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0015726089477539062
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0017006397247314453
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0015645027160644531
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0014171600341796875
----------------------check_connections_block total spend ----------------------------- 0.020627737045288086
generate_one_block  0.002991199493408203
generate_one_block  0.0031592845916748047
generate_one_block  0.0028221607208251953
generate_one_block  0.0029528141021728516
generate_one_block  0.0028874874114990234
generate_one_block  0.0028808116912841797
generate_one_block  0.0029036998748779297
generate_one_block  0.0025987625122070312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007462501525878906
gen group dst list time:  0.0003838539123535156
time for parepare:  0.00017452239990234375
local_output_nid generation:  0.00011539459228515625
local_in_edges_tensor generation:  0.0004279613494873047
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0024216175079345703
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation:  0.0002884864807128906
r_  generation:  0.002629995346069336
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00021505355834960938
r_  generation:  0.0024688243865966797
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.0024709701538085938
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.0002868175506591797
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.002476930618286133
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.0002105236053466797
r_  generation:  0.0023813247680664062
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0024881362915039062
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0022497177124023438
----------------------check_connections_block total spend ----------------------------- 0.02945685386657715
generate_one_block  0.004460811614990234
generate_one_block  0.0038585662841796875
generate_one_block  0.0037012100219726562
generate_one_block  0.004227399826049805
generate_one_block  0.003672361373901367
generate_one_block  0.003687620162963867
generate_one_block  0.004487752914428711
generate_one_block  0.003468751907348633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.06371593475341797
block generation total time  0.07913732528686523
average batch blocks generation time:  0.009892165660858154
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07470846176147461  GigaBytes
Max Memory Allocated: 0.07470846176147461  GigaBytes

torch.Size([2213, 1433])
torch.Size([1827, 16])
torch.Size([1129, 16])
torch.Size([439, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.7740368843078613  GigaBytes
Max Memory Allocated: 0.8258209228515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.13750934600830078  GigaBytes
Max Memory Allocated: 0.876279354095459  GigaBytes

torch.Size([2340, 1433])
torch.Size([2017, 16])
torch.Size([1302, 16])
torch.Size([505, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.8895664215087891  GigaBytes
Max Memory Allocated: 0.9455528259277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.13736724853515625  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2261, 1433])
torch.Size([1846, 16])
torch.Size([1064, 16])
torch.Size([366, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8439831733703613  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.13699769973754883  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2246, 1433])
torch.Size([1856, 16])
torch.Size([1184, 16])
torch.Size([495, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8383746147155762  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.13736343383789062  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2202, 1433])
torch.Size([1780, 16])
torch.Size([1018, 16])
torch.Size([386, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8201794624328613  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.13663339614868164  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2179, 1433])
torch.Size([1788, 16])
torch.Size([1081, 16])
torch.Size([439, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.8209185600280762  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.13736534118652344  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2246, 1433])
torch.Size([1850, 16])
torch.Size([1027, 16])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.847989559173584  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.13651227951049805  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2159, 1433])
torch.Size([1649, 16])
torch.Size([925, 16])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.7785782814025879  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06140846014022827 |0.04264247417449951 |0.2775329053401947 |0.00013777613639831543 |0.305752694606781 |0.020137786865234375 |
----------------------------------------------------------pseudo_mini_loss sum 3.0486671924591064
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45229
Number of first layer input nodes during this epoch:  17846
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.2622208595275879  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005655288696289062
range selection method range initialization spend 7.987022399902344e-05
time for parepare:  7.62939453125e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.4809112548828125e-05
----------------------check_connections_block total spend ----------------------------- 0.001961231231689453
generate_one_block  0.0013179779052734375
generate_one_block  0.0011239051818847656
generate_one_block  0.0011055469512939453
generate_one_block  0.001064300537109375
generate_one_block  0.0010380744934082031
generate_one_block  0.0010700225830078125
generate_one_block  0.0010542869567871094
generate_one_block  0.0010433197021484375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005135536193847656
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.00018262863159179688
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0002651214599609375
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00023365020751953125
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00025916099548339844
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002548694610595703
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.000171661376953125
----------------------check_connections_block total spend ----------------------------- 0.0042667388916015625
generate_one_block  0.0013556480407714844
generate_one_block  0.0013337135314941406
generate_one_block  0.0013234615325927734
generate_one_block  0.0014100074768066406
generate_one_block  0.0011992454528808594
generate_one_block  0.0013170242309570312
generate_one_block  0.001308441162109375
generate_one_block  0.0012018680572509766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006542205810546875
gen group dst list time:  0.00011086463928222656
time for parepare:  0.0002155303955078125
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0007841587066650391
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0008082389831542969
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0008099079132080078
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.0008633136749267578
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0005085468292236328
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008020401000976562
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.000850677490234375
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0005691051483154297
----------------------check_connections_block total spend ----------------------------- 0.010627031326293945
generate_one_block  0.002050161361694336
generate_one_block  0.0020263195037841797
generate_one_block  0.0020270347595214844
generate_one_block  0.0020787715911865234
generate_one_block  0.0015892982482910156
generate_one_block  0.0020961761474609375
generate_one_block  0.0020554065704345703
generate_one_block  0.00167083740234375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008018016815185547
gen group dst list time:  0.0001976490020751953
time for parepare:  0.0002033710479736328
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.0003955364227294922
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.0017969608306884766
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.001775503158569336
local_output_nid generation:  0.00010442733764648438
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.001802682876586914
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0018062591552734375
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.001238107681274414
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.00044035911560058594
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0017282962799072266
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.001833200454711914
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0013146400451660156
----------------------check_connections_block total spend ----------------------------- 0.02126145362854004
generate_one_block  0.003275632858276367
generate_one_block  0.0031638145446777344
generate_one_block  0.0031630992889404297
generate_one_block  0.0031604766845703125
generate_one_block  0.0025033950805664062
generate_one_block  0.003077268600463867
generate_one_block  0.0031752586364746094
generate_one_block  0.002605915069580078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000789642333984375
gen group dst list time:  0.0003972053527832031
time for parepare:  0.00022292137145996094
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0025582313537597656
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.00026297569274902344
r_  generation:  0.0025482177734375
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.002529621124267578
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.00031280517578125
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.0026082992553710938
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0021820068359375
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0026366710662841797
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.002695322036743164
local_output_nid generation:  0.00013756752014160156
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.002404451370239258
----------------------check_connections_block total spend ----------------------------- 0.03082752227783203
generate_one_block  0.004132747650146484
generate_one_block  0.004076719284057617
generate_one_block  0.003924846649169922
generate_one_block  0.00406646728515625
generate_one_block  0.0037679672241210938
generate_one_block  0.0038874149322509766
generate_one_block  0.004002094268798828
generate_one_block  0.0037233829498291016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.2622208595275879  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

connection checking time:  0.06698274612426758
block generation total time  0.08174991607666016
average batch blocks generation time:  0.01021873950958252
block dataloader generation time/epoch 0.22591781616210938
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.2628927230834961  GigaBytes
Max Memory Allocated: 0.989133358001709  GigaBytes

torch.Size([2207, 1433])
torch.Size([1835, 16])
torch.Size([1153, 16])
torch.Size([472, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9627938270568848  GigaBytes
Max Memory Allocated: 1.0141310691833496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.26264381408691406  GigaBytes
Max Memory Allocated: 1.0646443367004395  GigaBytes

torch.Size([2270, 1433])
torch.Size([1889, 16])
torch.Size([1173, 16])
torch.Size([431, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9738912582397461  GigaBytes
Max Memory Allocated: 1.0646443367004395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2628946304321289  GigaBytes
Max Memory Allocated: 1.0752081871032715  GigaBytes

torch.Size([2214, 1433])
torch.Size([1875, 16])
torch.Size([1200, 16])
torch.Size([478, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9656105041503906  GigaBytes
Max Memory Allocated: 1.0752081871032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2625398635864258  GigaBytes
Max Memory Allocated: 1.0752081871032715  GigaBytes

torch.Size([2250, 1433])
torch.Size([1905, 16])
torch.Size([1195, 16])
torch.Size([487, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9841647148132324  GigaBytes
Max Memory Allocated: 1.0752081871032715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.26136016845703125  GigaBytes
Max Memory Allocated: 1.085219383239746  GigaBytes

torch.Size([2036, 1433])
torch.Size([1475, 16])
torch.Size([766, 16])
torch.Size([279, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.8420472145080566  GigaBytes
Max Memory Allocated: 1.085219383239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2624549865722656  GigaBytes
Max Memory Allocated: 1.085219383239746  GigaBytes

torch.Size([2235, 1433])
torch.Size([1823, 16])
torch.Size([1159, 16])
torch.Size([464, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9563102722167969  GigaBytes
Max Memory Allocated: 1.085219383239746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2628974914550781  GigaBytes
Max Memory Allocated: 1.085219383239746  GigaBytes

torch.Size([2285, 1433])
torch.Size([1920, 16])
torch.Size([1217, 16])
torch.Size([490, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9922375679016113  GigaBytes
Max Memory Allocated: 1.085219383239746  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.2623581886291504  GigaBytes
Max Memory Allocated: 1.093076229095459  GigaBytes

torch.Size([2221, 1433])
torch.Size([1649, 16])
torch.Size([833, 16])
torch.Size([314, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3807373046875 GB
    Memory Allocated: 0.9075584411621094  GigaBytes
Max Memory Allocated: 1.093076229095459  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0628618597984314 |0.0008648335933685303 |0.21763384342193604 |0.00012505054473876953 |0.28458771109580994 |0.0071065425872802734 |
----------------------------------------------------------pseudo_mini_loss sum 2.3081889152526855
Total (block generation + training)time/epoch 4.8266990184783936
Training time/epoch 4.600528955459595
Training time without block to device /epoch 4.5936102867126465
Training time without total dataloading part /epoch 4.025879383087158
load block tensor time/epoch 0.5028948783874512
block to device time/epoch 0.006918668746948242
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44963
Number of first layer input nodes during this epoch:  17718
