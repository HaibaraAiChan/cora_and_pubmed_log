main start at this time 1648432744.8286362
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010499954223632812
range selection method range initialization spend 8.034706115722656e-05
time for parepare:  6.461143493652344e-05
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0013659000396728516
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00010776519775390625
----------------------check_connections_block total spend ----------------------------- 0.0021715164184570312
generate_one_block  0.0013885498046875
generate_one_block  0.0012018680572509766
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005223751068115234
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.00016164779663085938
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0007646083831787109
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0006461143493652344
----------------------check_connections_block total spend ----------------------------- 0.0026161670684814453
generate_one_block  0.001964092254638672
generate_one_block  0.0017936229705810547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005829334259033203
gen group dst list time:  5.626678466796875e-05
time for parepare:  0.0001671314239501953
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0003662109375
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0019123554229736328
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.0018100738525390625
----------------------check_connections_block total spend ----------------------------- 0.005846977233886719
generate_one_block  0.0031821727752685547
generate_one_block  0.003000497817993164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006415843963623047
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.0001938343048095703
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0004115104675292969
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.002841949462890625
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.002785921096801758
----------------------check_connections_block total spend ----------------------------- 0.008671998977661133
generate_one_block  0.0040934085845947266
generate_one_block  0.004291534423828125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007593631744384766
gen group dst list time:  0.00010895729064941406
time for parepare:  0.00018405914306640625
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.003197908401489258
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0003371238708496094
r_  generation:  0.003161191940307617
----------------------check_connections_block total spend ----------------------------- 0.009713888168334961
generate_one_block  0.0044155120849609375
generate_one_block  0.004088640213012695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.026849031448364258
block generation total time  0.02682948112487793
average batch blocks generation time:  0.013414740562438965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07664012908935547  GigaBytes
Max Memory Allocated: 0.07664012908935547  GigaBytes

torch.Size([2465, 1433])
torch.Size([2345, 16])
torch.Size([1956, 16])
torch.Size([1204, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.9326810836791992  GigaBytes
Max Memory Allocated: 0.9889531135559082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 0.13874244689941406  GigaBytes
Max Memory Allocated: 1.0232439041137695  GigaBytes

torch.Size([2441, 1433])
torch.Size([2299, 16])
torch.Size([1914, 16])
torch.Size([1104, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.970848560333252  GigaBytes
Max Memory Allocated: 1.0277628898620605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04604232311248779 |0.17014086246490479 |0.49707329273223877 |0.0001983642578125 |0.34996700286865234 |0.01860189437866211 |
----------------------------------------------------------pseudo_mini_loss sum 2.7831902503967285
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16432
Number of first layer input nodes during this epoch:  4906
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.26396846771240234  GigaBytes
Max Memory Allocated: 1.062636375427246  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005192756652832031
range selection method range initialization spend 6.365776062011719e-05
time for parepare:  7.081031799316406e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001232624053955078
----------------------check_connections_block total spend ----------------------------- 0.0008990764617919922
generate_one_block  0.0013344287872314453
generate_one_block  0.0012135505676269531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00051116943359375
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00015664100646972656
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006985664367675781
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation: Using backend: pytorch
 0.000110626220703125
r_  generation:  0.0007462501525878906
----------------------check_connections_block total spend ----------------------------- 0.002770662307739258
generate_one_block  0.002025127410888672
generate_one_block  0.0019643306732177734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006082057952880859
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.00018215179443359375
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0018820762634277344
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0018618106842041016
----------------------check_connections_block total spend ----------------------------- 0.005998849868774414
generate_one_block  0.0036313533782958984
generate_one_block  0.003241300582885742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006642341613769531
gen group dst list time:  9.250640869140625e-05
time for parepare:  0.00020313262939453125
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.00041484832763671875
mini_batch_src_global generation:  0.00026297569274902344
r_  generation:  0.0027856826782226562
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.002861499786376953
----------------------check_connections_block total spend ----------------------------- 0.010011911392211914
generate_one_block  0.0042247772216796875
generate_one_block  0.00410151481628418
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007684230804443359
gen group dst list time:  0.00011181831359863281
time for parepare:  0.0001881122589111328
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.003170013427734375
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.00037598609924316406
mini_batch_src_global generation:  0.00033211708068847656
r_  generation:  0.0032303333282470703
----------------------check_connections_block total spend ----------------------------- 0.00972747802734375
generate_one_block  0.004534006118774414
generate_one_block  0.004337787628173828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.26396846771240234  GigaBytes
Max Memory Allocated: 1.062636375427246  GigaBytes

connection checking time:  0.028508901596069336
block generation total time  0.028060197830200195
average batch blocks generation time:  0.014030098915100098
block dataloader generation time/epoch 0.08545804023742676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.2636137008666992  GigaBytes
Max Memory Allocated: 1.062636375427246  GigaBytes

torch.Size([2448, 1433])
torch.Size([2326, 16])
torch.Size([1929, 16])
torch.Size([1120, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.1069211959838867  GigaBytes
Max Memory Allocated: 1.1637492179870605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 0.26361656188964844  GigaBytes
Max Memory Allocated: 1.1988487243652344  GigaBytes

torch.Size([2470, 1433])
torch.Size([2340, 16])
torch.Size([1938, 16])
torch.Size([1170, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.1155939102172852  GigaBytes
Max Memory Allocated: 1.1988487243652344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03773200511932373 |0.0009456872940063477 |0.25975942611694336 |0.000133514404296875 |0.34916186332702637 |0.013526201248168945 |
----------------------------------------------------------pseudo_mini_loss sum 2.3184328079223633
Total (block generation + training)time/epoch 1.4588019847869873
Training time/epoch 1.3729839324951172
Training time without block to device /epoch 1.3710925579071045
Training time without total dataloading part /epoch 1.2316358089447021
load block tensor time/epoch 0.07546401023864746
block to device time/epoch 0.0018913745880126953
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16453
Number of first layer input nodes during this epoch:  4918
