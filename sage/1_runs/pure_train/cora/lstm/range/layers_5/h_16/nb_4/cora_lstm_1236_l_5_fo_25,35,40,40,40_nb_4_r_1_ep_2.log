main start at this time 1648432756.8019125
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016829967498779297
range selection method range initialization spend 0.00011420249938964844
time for parepare:  6.341934204101562e-05
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.004094362258911133
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001304149627685547
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.078315734863281e-05
----------------------check_connections_block total spend ----------------------------- 0.005378246307373047
generate_one_block  0.0016176700592041016
generate_one_block  0.0011124610900878906
generate_one_block  0.0010411739349365234
generate_one_block  0.0010161399841308594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004775524139404297
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00013327598571777344
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0004596710205078125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003399848937988281
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00036263465881347656
----------------------check_connections_block total spend ----------------------------- 0.003057718276977539
generate_one_block  0.0015151500701904297
generate_one_block  0.0014848709106445312
generate_one_block  0.0013535022735595703
generate_one_block  0.0014889240264892578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005629062652587891
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.00016498565673828125
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0012285709381103516
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0012974739074707031
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0011000633239746094
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0011777877807617188
----------------------check_connections_block total spend ----------------------------- 0.00776362419128418
generate_one_block  0.002438783645629883
generate_one_block  0.0025353431701660156
generate_one_block  0.0022542476654052734
generate_one_block  0.0022766590118408203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007615089416503906
gen group dst list time:  0.0001361370086669922
time for parepare:  0.00018334388732910156
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0022644996643066406
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.002359628677368164
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0021238327026367188
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.002270221710205078
----------------------check_connections_block total spend ----------------------------- 0.013771533966064453
generate_one_block  0.003551959991455078
generate_one_block  0.0034809112548828125
generate_one_block  0.003488302230834961
generate_one_block  0.003401041030883789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007598400115966797
gen group dst list time:  0.00018024444580078125
time for parepare:  0.00017905235290527344
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.00019621849060058594
r_  generation:  0.002934694290161133
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.00029730796813964844
r_  generation:  0.0028486251831054688
local_output_nid generation:  0.00013899803161621094
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.0027484893798828125
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0028367042541503906
----------------------check_connections_block total spend ----------------------------- 0.017233610153198242
generate_one_block  0.004200935363769531
generate_one_block  0.004815101623535156
generate_one_block  0.0038878917694091797
generate_one_block  0.003984689712524414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06276512145996094  GigaBytes
Max Memory Allocated: 0.06276512145996094  GigaBytes

connection checking time:  0.041826486587524414
block generation total time  0.0461583137512207
average batch blocks generation time:  0.011539578437805176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07660627365112305  GigaBytes
Max Memory Allocated: 0.07660627365112305  GigaBytes

torch.Size([2422, 1433])
torch.Size([2198, 16])
torch.Size([1598, 16])
torch.Size([773, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.8851523399353027  GigaBytes
Max Memory Allocated: 0.9426603317260742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2440185546875 GB
    Memory Allocated: 0.13871526718139648  GigaBytes
Max Memory Allocated: 0.9808521270751953  GigaBytes

torch.Size([2391, 1433])
torch.Size([2163, 16])
torch.Size([1596, 16])
torch.Size([791, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2947998046875 GB
    Memory Allocated: 0.9366912841796875  GigaBytes
Max Memory Allocated: 0.9941296577453613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 0.13743305206298828  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

torch.Size([2323, 1433])
torch.Size([2073, 16])
torch.Size([1464, 16])
torch.Size([693, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 0.9030885696411133  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 0.13765573501586914  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

torch.Size([2364, 1433])
torch.Size([2140, 16])
torch.Size([1533, 16])
torch.Size([694, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3260498046875 GB
    Memory Allocated: 0.9245543479919434  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05999714136123657 |0.08606523275375366 |0.36238086223602295 |0.0001614093780517578 |0.3257635235786438 |0.018098115921020508 |
----------------------------------------------------------pseudo_mini_loss sum 2.5891666412353516
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27954
Number of first layer input nodes during this epoch:  9500
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.26281023025512695  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005102157592773438
range selection method range initialization spend 6.67572021484375e-05
time for parepare:  7.581710815429688e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.508827209472656e-05
----------------------check_connections_block total spend ----------------------------- 0.0012519359588623047
generate_one_block  0.0012645721435546875
generate_one_block  0.0011157989501953125
generate_one_block  0.0010952949523925781
generate_one_block  0.0011379718780517578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005159378051757812
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.00015401840209960938
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00040268898010253906
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004029273986816406
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004019737243652344
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004131793975830078
----------------------check_connections_block total spend ----------------------------- 0.0032765865325927734
generate_one_block  0.0017659664154052734
generate_one_block  0.0015757083892822266
generate_one_block  0.001583099365234375
generate_one_block  0.0014955997467041016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.00017571449279785156
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.001168966293334961
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00016379356384277344
r_  generation:  0.0013124942779541016
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.0011687278747558594
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0012249946594238281
----------------------check_connections_block total spend ----------------------------- 0.008033275604248047
generate_one_block  0.0025565624237060547
generate_one_block  0.0026116371154785156
generate_one_block  0.002438068389892578
generate_one_block  0.002402782440185547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007612705230712891
gen group dst list time:  0.0001380443572998047
time for parepare:  0.00018835067749023438
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.00039649009704589844
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.002157449722290039
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.002254962921142578
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.0022187232971191406
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.002272367477416992
----------------------check_connections_block total spend ----------------------------- 0.013921022415161133
generate_one_block  0.003545999526977539
generate_one_block  0.003674745559692383
generate_one_block  0.0035686492919921875
generate_one_block  0.003566265106201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007650852203369141
gen group dst list time:  0.0001819133758544922
time for parepare:  0.0001876354217529297
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.002821683883666992
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.0028238296508789062
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0002338886260986328
r_  generation:  0.002844572067260742
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation: Using backend: pytorch
 0.00026535987854003906
r_  generation:  0.0028946399688720703
----------------------check_connections_block total spend ----------------------------- 0.017469406127929688
generate_one_block  0.005481719970703125
generate_one_block  0.004387378692626953
generate_one_block  0.004144906997680664
generate_one_block  0.004167079925537109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.26281023025512695  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

connection checking time:  0.04270029067993164
block generation total time  0.048966169357299805
average batch blocks generation time:  0.012241542339324951
block dataloader generation time/epoch 0.1394815444946289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 0.26248598098754883  GigaBytes
Max Memory Allocated: 1.0324902534484863  GigaBytes

torch.Size([2357, 1433])
torch.Size([2097, 16])
torch.Size([1508, 16])
torch.Size([710, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 1.035661220550537  GigaBytes
Max Memory Allocated: 1.0912022590637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.26249074935913086  GigaBytes
Max Memory Allocated: 1.1333541870117188  GigaBytes

torch.Size([2357, 1433])
torch.Size([2125, 16])
torch.Size([1567, 16])
torch.Size([759, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.047774314880371  GigaBytes
Max Memory Allocated: 1.1333541870117188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.26256275177001953  GigaBytes
Max Memory Allocated: 1.1449084281921387  GigaBytes

torch.Size([2371, 1433])
torch.Size([2141, 16])
torch.Size([1514, 16])
torch.Size([718, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.0526227951049805  GigaBytes
Max Memory Allocated: 1.1449084281921387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.263577938079834  GigaBytes
Max Memory Allocated: 1.1501140594482422  GigaBytes

torch.Size([2394, 1433])
torch.Size([2150, 16])
torch.Size([1528, 16])
torch.Size([726, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.0635766983032227  GigaBytes
Max Memory Allocated: 1.1501140594482422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05537766218185425 |0.0012064576148986816 |0.24210292100906372 |0.00012725591659545898 |0.3278050422668457 |0.013426780700683594 |
----------------------------------------------------------pseudo_mini_loss sum 2.316599130630493
Total (block generation + training)time/epoch 2.7259433269500732
Training time/epoch 2.586094617843628
Training time without block to device /epoch 2.581268787384033
Training time without total dataloading part /epoch 2.293567657470703
load block tensor time/epoch 0.221510648727417
block to device time/epoch 0.0048258304595947266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27767
Number of first layer input nodes during this epoch:  9479
