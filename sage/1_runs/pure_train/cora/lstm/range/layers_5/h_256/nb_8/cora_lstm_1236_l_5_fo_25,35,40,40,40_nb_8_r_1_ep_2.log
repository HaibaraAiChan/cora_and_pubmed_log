main start at this time 1648433058.0335183
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0015759468078613281
range selection method range initialization spend 0.00011563301086425781
time for parepare:  6.365776062011719e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0030145645141601562
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0517578125e-05
----------------------check_connections_block total spend ----------------------------- 0.004864931106567383
generate_one_block  0.001302957534790039
generate_one_block  0.001027822494506836
generate_one_block  0.0010094642639160156
generate_one_block  0.0010216236114501953
generate_one_block  0.0010042190551757812
generate_one_block  0.0010080337524414062
generate_one_block  0.0010213851928710938
generate_one_block  0.0009922981262207031
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000492095947265625
gen group dst list time:  5.602836608886719e-05
time for parepare:  0.00014448165893554688
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00027179718017578125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.000186920166015625
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00021386146545410156
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00025582313537597656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002181529998779297
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003235340118408203
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00017714500427246094
----------------------check_connections_block total spend ----------------------------- 0.0040569305419921875
generate_one_block  0.0013151168823242188
generate_one_block  0.0011851787567138672
generate_one_block  0.001214742660522461
generate_one_block  0.00128173828125
generate_one_block  0.001239776611328125
generate_one_block  0.0011682510375976562
generate_one_block  0.001478433609008789
generate_one_block  0.0011675357818603516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006864070892333984
gen group dst list time:  0.00010204315185546875
time for parepare:  0.00019502639770507812
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.00083160400390625
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0006456375122070312
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0006601810455322266
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0008594989776611328
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007760524749755859
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005891323089599609
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0011050701141357422
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0006320476531982422
----------------------check_connections_block total spend ----------------------------- 0.01043391227722168
generate_one_block  0.002020120620727539
generate_one_block  0.001771688461303711
generate_one_block  0.0016815662384033203
generate_one_block  0.001928091049194336
generate_one_block  0.001844644546508789
generate_one_block  0.0016705989837646484
generate_one_block  0.0021486282348632812
generate_one_block  0.0016677379608154297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007748603820800781
gen group dst list time:  0.0001995563507080078
time for parepare:  0.0001881122589111328
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0018966197967529297
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0017168521881103516
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0016109943389892578
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0020008087158203125
local_output_nid generation:  8.821487426757812e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0018787384033203125
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0015368461608886719
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0021758079528808594
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0014946460723876953
----------------------check_connections_block total spend ----------------------------- 0.02216935157775879
generate_one_block  0.0030460357666015625
generate_one_block  0.0027916431427001953
generate_one_block  0.0026938915252685547
generate_one_block  0.003057718276977539
generate_one_block  0.0031092166900634766
generate_one_block  0.0026102066040039062
generate_one_block  0.0032498836517333984
generate_one_block  0.0026063919067382812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007793903350830078
gen group dst list time:  0.0003261566162109375
time for parepare:  0.00018835067749023438
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0004456043243408203
mini_batch_src_global generation:  0.0002338886260986328
r_  generation:  0.0025877952575683594
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0002856254577636719
r_  generation:  0.002565145492553711
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0025415420532226562
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.00023245811462402344
r_  generation:  0.0028641223907470703
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0026679039001464844
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0024461746215820312
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.0027060508728027344
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0021927356719970703
----------------------check_connections_block total spend ----------------------------- 0.031096458435058594
generate_one_block  0.0037844181060791016
generate_one_block  0.003635406494140625
generate_one_block  0.0035622119903564453
generate_one_block  0.004319429397583008
generate_one_block  0.003716707229614258
generate_one_block  0.003554105758666992
generate_one_block  0.003885030746459961
generate_one_block  0.003387451171875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

connection checking time:  0.06775665283203125
block generation total time  0.07779359817504883
average batch blocks generation time:  0.009724199771881104
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08661937713623047  GigaBytes
Max Memory Allocated: 0.08661937713623047  GigaBytes

torch.Size([2224, 1433])
torch.Size([1846, 256])
torch.Size([1183, 256])
torch.Size([469, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9316592216491699  GigaBytes
Max Memory Allocated: 0.9317989349365234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.16185665130615234  GigaBytes
Max Memory Allocated: 0.9356369972229004  GigaBytes

torch.Size([2237, 1433])
torch.Size([1828, 256])
torch.Size([1053, 256])
torch.Size([363, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.9799346923828125  GigaBytes
Max Memory Allocated: 0.9800405502319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.16120338439941406  GigaBytes
Max Memory Allocated: 0.9837536811828613  GigaBytes

torch.Size([2164, 1433])
torch.Size([1776, 256])
torch.Size([1009, 256])
torch.Size([378, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.9504237174987793  GigaBytes
Max Memory Allocated: 0.9837536811828613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.16187381744384766  GigaBytes
Max Memory Allocated: 0.9837536811828613  GigaBytes

torch.Size([2317, 1433])
torch.Size([1987, 256])
torch.Size([1249, 256])
torch.Size([482, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 1.050112247467041  GigaBytes
Max Memory Allocated: 1.0502419471740723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.1615457534790039  GigaBytes
Max Memory Allocated: 1.053908348083496  GigaBytes

torch.Size([2257, 1433])
torch.Size([1883, 256])
torch.Size([1168, 256])
torch.Size([439, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 1.0157642364501953  GigaBytes
Max Memory Allocated: 1.053908348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.1618499755859375  GigaBytes
Max Memory Allocated: 1.053908348083496  GigaBytes

torch.Size([2226, 1433])
torch.Size([1731, 256])
torch.Size([957, 256])
torch.Size([308, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.9465069770812988  GigaBytes
Max Memory Allocated: 1.053908348083496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 0.16205978393554688  GigaBytes
Max Memory Allocated: 1.053908348083496  GigaBytes

torch.Size([2349, 1433])
torch.Size([2059, 256])
torch.Size([1394, 256])
torch.Size([637, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.1082344055175781  GigaBytes
Max Memory Allocated: 1.1083793640136719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.1611957550048828  GigaBytes
Max Memory Allocated: 1.1120142936706543  GigaBytes

torch.Size([2044, 1433])
torch.Size([1622, 256])
torch.Size([939, 256])
torch.Size([337, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4569091796875 GB
    Memory Allocated: 0.9014925956726074  GigaBytes
Max Memory Allocated: 1.1120142936706543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05684429407119751 |0.04284769296646118 |0.2803942561149597 |0.00013968348503112793 |0.32199105620384216 |0.017519474029541016 |
----------------------------------------------------------pseudo_mini_loss sum 3.0399043560028076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45667
Number of first layer input nodes during this epoch:  17818
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 0.3105955123901367  GigaBytes
Max Memory Allocated: 1.1120142936706543  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005786418914794922
range selection method range initialization spend 7.82012939453125e-05
time for parepare:  7.653236389160156e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.695487976074219e-05
----------------------check_connections_block total spend ----------------------------- 0.002024412155151367
generate_one_block  0.001331329345703125
generate_one_block  0.001100301742553711
generate_one_block  0.0010631084442138672
generate_one_block  0.001092672348022461
generate_one_block  0.001066446304321289
generate_one_block  0.0010559558868408203
generate_one_block  0.0010802745819091797
generate_one_block  0.0011012554168701172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005402565002441406
gen group dst list time:  6.198883056640625e-05
time for parepare:  0.00020384788513183594
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002624988555908203
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00022673606872558594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001933574676513672
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002875328063964844
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00021719932556152344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00018596649169921875
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00029754638671875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0002512931823730469
----------------------check_connections_block total spend ----------------------------- 0.004468202590942383
generate_one_block  0.0014226436614990234
generate_one_block  0.0013318061828613281
generate_one_block  0.0012464523315429688
generate_one_block  0.0014731884002685547
generate_one_block  0.001275777816772461
generate_one_block  0.0012302398681640625
generate_one_block  0.0014188289642333984
generate_one_block  0.001338958740234375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007383823394775391
gen group dst list time:  0.00011467933654785156
time for parepare:  0.00022339820861816406
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.00083160400390625
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.000751495361328125
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0006589889526367188
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0009839534759521484
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0006926059722900391
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0005872249603271484
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0009605884552001953
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0008318424224853516
----------------------check_connections_block total spend ----------------------------- 0.011194467544555664
generate_one_block  0.0021398067474365234
generate_one_block  0.0019459724426269531
generate_one_block  0.0017724037170410156
generate_one_block  0.002127408981323242
generate_one_block  0.0018241405487060547
generate_one_block  0.0016584396362304688
generate_one_block  0.002118349075317383
generate_one_block  0.001964092254638672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007829666137695312
gen group dst list time:  0.00021529197692871094
time for parepare:  0.00022268295288085938
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0004048347473144531
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.001955747604370117
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0017647743225097656
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0015583038330078125
local_output_nid generation:  0.00011491775512695312
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.0020194053649902344
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.001558542251586914
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0004246234893798828
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0015518665313720703
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.0019636154174804688
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.001748800277709961
----------------------check_connections_block total spend ----------------------------- 0.022650718688964844
generate_one_block  0.0034024715423583984
generate_one_block  0.003048419952392578
generate_one_block  0.002740621566772461
generate_one_block  0.003287792205810547
generate_one_block  0.00278472900390625
generate_one_block  0.00275421142578125
generate_one_block  0.0032393932342529297
generate_one_block  0.003091096878051758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008261203765869141
gen group dst list time:  0.00041031837463378906
time for parepare:  0.00021767616271972656
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.002841472625732422
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.002658843994140625
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.002481222152709961
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0003376007080078125
mini_batch_src_global generation:  0.00023412704467773438
r_  generation:  0.0029113292694091797
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0024881362915039062
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.002382040023803711
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.0003218650817871094
mini_batch_src_global generation:  0.0002238750457763672
r_  generation:  0.002626180648803711
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0025708675384521484
----------------------check_connections_block total spend ----------------------------- 0.03195381164550781
generate_one_block  0.004269599914550781
generate_one_block  0.0038704872131347656
generate_one_block  0.0036482810974121094
generate_one_block  0.004078388214111328
generate_one_block  0.003948688507080078
generate_one_block  0.003755331039428711
generate_one_block  0.004006385803222656
generate_one_block  0.003934383392333984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 0.3105955123901367  GigaBytes
Max Memory Allocated: 1.1120142936706543  GigaBytes

connection checking time:  0.0702672004699707
block generation total time  0.08214879035949707
average batch blocks generation time:  0.010268598794937134
block dataloader generation time/epoch 0.2334461212158203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 0.3110799789428711  GigaBytes
Max Memory Allocated: 1.1120142936706543  GigaBytes

torch.Size([2316, 1433])
torch.Size([1964, 256])
torch.Size([1223, 256])
torch.Size([450, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 1.1920647621154785  GigaBytes
Max Memory Allocated: 1.1921944618225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.31049299240112305  GigaBytes
Max Memory Allocated: 1.1958575248718262  GigaBytes

torch.Size([2209, 1433])
torch.Size([1817, 256])
torch.Size([1078, 256])
torch.Size([409, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.1267027854919434  GigaBytes
Max Memory Allocated: 1.1958575248718262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.3104057312011719  GigaBytes
Max Memory Allocated: 1.1958575248718262  GigaBytes

torch.Size([2108, 1433])
torch.Size([1659, 256])
torch.Size([924, 256])
torch.Size([336, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.0548501014709473  GigaBytes
Max Memory Allocated: 1.1958575248718262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 0.3110971450805664  GigaBytes
Max Memory Allocated: 1.1958575248718262  GigaBytes

torch.Size([2319, 1433])
torch.Size([2010, 256])
torch.Size([1291, 256])
torch.Size([540, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.2145380973815918  GigaBytes
Max Memory Allocated: 1.2146687507629395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.3104095458984375  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

torch.Size([2133, 1433])
torch.Size([1669, 256])
torch.Size([947, 256])
torch.Size([377, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.065129280090332  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.3104066848754883  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

torch.Size([2177, 1433])
torch.Size([1699, 256])
torch.Size([881, 256])
torch.Size([319, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.080169677734375  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.31108570098876953  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

torch.Size([2313, 1433])
torch.Size([1939, 256])
torch.Size([1238, 256])
torch.Size([524, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.197375774383545  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5604248046875 GB
    Memory Allocated: 0.31061267852783203  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

torch.Size([2230, 1433])
torch.Size([1898, 256])
torch.Size([1136, 256])
torch.Size([436, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5604248046875 GB
    Memory Allocated: 1.1647095680236816  GigaBytes
Max Memory Allocated: 1.218327522277832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06083747744560242 |0.0009584128856658936 |0.2186482846736908 |0.0001252591609954834 |0.31529420614242554 |0.012558698654174805 |
----------------------------------------------------------pseudo_mini_loss sum 2.915287971496582
Total (block generation + training)time/epoch 5.081153154373169
Training time/epoch 4.847400665283203
Training time without block to device /epoch 4.839733362197876
Training time without total dataloading part /epoch 4.285100698471069
load block tensor time/epoch 0.48669981956481934
block to device time/epoch 0.0076673030853271484
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45323
Number of first layer input nodes during this epoch:  17805
