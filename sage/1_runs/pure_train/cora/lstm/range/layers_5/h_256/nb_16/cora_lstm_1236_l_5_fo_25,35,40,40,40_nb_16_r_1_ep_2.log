main start at this time 1648433077.2406964
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00095367431640625
range selection method range initialization spend 8.177757263183594e-05
time for parepare:  7.319450378417969e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0015141963958740234
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.004803180694580078
generate_one_block  0.001241445541381836
generate_one_block  0.0011050701141357422
generate_one_block  0.0010521411895751953
generate_one_block  0.0010612010955810547
generate_one_block  0.0010721683502197266
generate_one_block  0.0010464191436767578
generate_one_block  0.001094818115234375
generate_one_block  0.0010755062103271484
generate_one_block  0.0010433197021484375
generate_one_block  0.0010533332824707031
generate_one_block  0.0010454654693603516
generate_one_block  0.001079559326171875
generate_one_block  0.0009856224060058594
generate_one_block  0.0009667873382568359
generate_one_block  0.0011262893676757812
generate_one_block  0.0009522438049316406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006306171417236328
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.00016689300537109375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00014638900756835938
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002009868621826172
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00014853477478027344
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011491775512695312
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001513957977294922
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.153915405273438e-05
----------------------check_connections_block total spend ----------------------------- 0.005881786346435547
generate_one_block  0.0012257099151611328
generate_one_block  0.0012831687927246094
generate_one_block  0.001148223876953125
generate_one_block  0.0011935234069824219
generate_one_block  0.001268148422241211
generate_one_block  0.0011522769927978516
generate_one_block  0.0012133121490478516
generate_one_block  0.0011138916015625
generate_one_block  0.0010673999786376953
generate_one_block  0.0011038780212402344
generate_one_block  0.0010433197021484375
generate_one_block  0.0010635852813720703
generate_one_block  0.0012888908386230469
generate_one_block  0.001111745834350586
generate_one_block  0.0010783672332763672
generate_one_block  0.001043558120727539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007429122924804688
gen group dst list time:  0.0001850128173828125
time for parepare:  0.00022363662719726562
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.000518798828125
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.00069427490234375
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0003249645233154297
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0004994869232177734
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0004944801330566406
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003056526184082031
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004787445068359375
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005695819854736328
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004341602325439453
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00048804283142089844
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00037407875061035156
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0008873939514160156
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005109310150146484
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00039458274841308594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003383159637451172
----------------------check_connections_block total spend ----------------------------- 0.013964653015136719
generate_one_block  0.0016789436340332031
generate_one_block  0.0018324851989746094
generate_one_block  0.001631021499633789
generate_one_block  0.001491546630859375
generate_one_block  0.0014715194702148438
generate_one_block  0.0012726783752441406
generate_one_block  0.0014607906341552734
generate_one_block  0.0015556812286376953
generate_one_block  0.0014240741729736328
generate_one_block  0.0014674663543701172
generate_one_block  0.0013082027435302734
generate_one_block  0.0013663768768310547
generate_one_block  0.001950979232788086
generate_one_block  0.0014526844024658203
generate_one_block  0.0013759136199951172
generate_one_block  0.0013010501861572266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007867813110351562
gen group dst list time:  0.0002911090850830078
time for parepare:  0.00020766258239746094
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.001317739486694336
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0015761852264404297
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0010542869567871094
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.0001513957977294922
r_  generation:  0.0014579296112060547
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.0013260841369628906
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0009655952453613281
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0013549327850341797
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.001447439193725586
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0011851787567138672
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0013353824615478516
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0008313655853271484
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0010707378387451172
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.001926422119140625
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0010433197021484375
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0010073184967041016
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0008151531219482422
----------------------check_connections_block total spend ----------------------------- 0.03151082992553711
generate_one_block  0.0023949146270751953
generate_one_block  0.0025985240936279297
generate_one_block  0.0021102428436279297
generate_one_block  0.0025115013122558594
generate_one_block  0.0023436546325683594
generate_one_block  0.0019958019256591797
generate_one_block  0.002620697021484375
generate_one_block  0.0024650096893310547
generate_one_block  0.002227306365966797
generate_one_block  0.0023458003997802734
generate_one_block  0.0018696784973144531
generate_one_block  0.0021746158599853516
generate_one_block  0.003068685531616211
generate_one_block  0.002177000045776367
generate_one_block  0.0021202564239501953
generate_one_block  0.0019240379333496094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0021038055419921875
gen group dst list time:  0.00200653076171875
time for parepare:  0.0005395412445068359
local_output_nid generation:  0.0003266334533691406
local_in_edges_tensor generation:  0.0009236335754394531
mini_batch_src_global generation:  0.00046181678771972656
r_  generation:  0.005396127700805664
local_output_nid generation:  0.0003063678741455078
local_in_edges_tensor generation:  0.0006887912750244141
mini_batch_src_global generation:  0.0005929470062255859
r_  generation:  0.004738807678222656
local_output_nid generation:  0.00018644332885742188
local_in_edges_tensor generation:  0.0004107952117919922
mini_batch_src_global generation:  0.00030112266540527344
r_  generation:  0.0032193660736083984
local_output_nid generation:  0.00023293495178222656
local_in_edges_tensor generation:  0.0004527568817138672
mini_batch_src_global generation:  0.00033092498779296875
r_  generation:  0.0026967525482177734
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.002113819122314453
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0017516613006591797
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0021893978118896484
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0020792484283447266
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.00018167495727539062
r_  generation:  0.001941680908203125
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.002079010009765625
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0016281604766845703
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.0019161701202392578
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.0002665519714355469
r_  generation:  0.002555370330810547
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0018503665924072266
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0018200874328613281
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.0016286373138427734
----------------------check_connections_block total spend ----------------------------- 0.06182241439819336
generate_one_block  0.0040340423583984375
generate_one_block  0.003570079803466797
generate_one_block  0.003486156463623047
generate_one_block  0.0034537315368652344
generate_one_block  0.00331878662109375
generate_one_block  0.002961397171020508
generate_one_block  0.0034494400024414062
generate_one_block  0.0032851696014404297
generate_one_block  0.0031981468200683594
generate_one_block  0.003226041793823242
generate_one_block  0.0027997493743896484
generate_one_block  0.003148794174194336
generate_one_block  0.0038111209869384766
generate_one_block  0.003046751022338867
generate_one_block  0.003004312515258789
generate_one_block  0.0028777122497558594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

connection checking time:  0.11317968368530273
block generation total time  0.13205957412719727
average batch blocks generation time:  0.008253723382949829
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.0857396125793457  GigaBytes
Max Memory Allocated: 0.0857396125793457  GigaBytes

torch.Size([2066, 1433])
torch.Size([1447, 256])
torch.Size([730, 256])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.7601666450500488  GigaBytes
Max Memory Allocated: 0.7602252960205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.16033697128295898  GigaBytes
Max Memory Allocated: 0.7932195663452148  GigaBytes

torch.Size([2130, 1433])
torch.Size([1610, 256])
torch.Size([915, 256])
torch.Size([326, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.9010658264160156  GigaBytes
Max Memory Allocated: 0.9011650085449219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.15927934646606445  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([1938, 1433])
torch.Size([1337, 256])
torch.Size([569, 256])
torch.Size([171, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.7564544677734375  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.16015625  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2098, 1433])
torch.Size([1599, 256])
torch.Size([795, 256])
torch.Size([252, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8824276924133301  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.15986061096191406  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2044, 1433])
torch.Size([1507, 256])
torch.Size([730, 256])
torch.Size([239, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.8438973426818848  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.15881013870239258  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([1851, 1433])
torch.Size([1212, 256])
torch.Size([514, 256])
torch.Size([154, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.7161617279052734  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.16059446334838867  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2181, 1433])
torch.Size([1577, 256])
torch.Size([763, 256])
torch.Size([256, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.8695259094238281  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.1597914695739746  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2030, 1433])
torch.Size([1492, 256])
torch.Size([813, 256])
torch.Size([269, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.8472075462341309  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.15964984893798828  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2006, 1433])
torch.Size([1384, 256])
torch.Size([635, 256])
torch.Size([222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.7882189750671387  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.1596364974975586  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2002, 1433])
torch.Size([1434, 256])
torch.Size([761, 256])
torch.Size([236, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.8228588104248047  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.15874481201171875  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([1840, 1433])
torch.Size([1107, 256])
torch.Size([474, 256])
torch.Size([138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.6699166297912598  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.159515380859375  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([1981, 1433])
torch.Size([1345, 256])
torch.Size([619, 256])
torch.Size([180, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.779442310333252  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 0.16109514236450195  GigaBytes
Max Memory Allocated: 0.9048886299133301  GigaBytes

torch.Size([2268, 1433])
torch.Size([1921, 256])
torch.Size([1182, 256])
torch.Size([476, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 1.0336346626281738  GigaBytes
Max Memory Allocated: 1.0337252616882324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.15929412841796875  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

torch.Size([1939, 1433])
torch.Size([1300, 256])
torch.Size([605, 256])
torch.Size([250, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.7662358283996582  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.15862560272216797  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

torch.Size([1815, 1433])
torch.Size([1270, 256])
torch.Size([601, 256])
torch.Size([198, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.7478837966918945  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.15831613540649414  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

torch.Size([1759, 1433])
torch.Size([1120, 256])
torch.Size([474, 256])
torch.Size([149, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.6846718788146973  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06084077060222626 |0.02307187020778656 |0.22193104028701782 |0.00013805925846099854 |0.2789420932531357 |0.0181276798248291 |
----------------------------------------------------------pseudo_mini_loss sum 3.315812826156616
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  70337
Number of first layer input nodes during this epoch:  31948
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.30782318115234375  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010457038879394531
range selection method range initialization spend 0.00021219253540039062
time for parepare:  0.00020694732666015625
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00041985511779785156
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00030994415283203125
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  5.5789947509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.007842540740966797
generate_one_block  0.0023529529571533203
generate_one_block  0.0018506050109863281
generate_one_block  0.0014712810516357422
generate_one_block  0.0014324188232421875
generate_one_block  0.001422882080078125
generate_one_block  0.0014374256134033203
generate_one_block  0.00135040283203125
generate_one_block  0.0010349750518798828
generate_one_block  0.001027822494506836
generate_one_block  0.0010166168212890625
generate_one_block  0.0010304450988769531
generate_one_block  0.0010249614715576172
generate_one_block  0.0010418891906738281
generate_one_block  0.0010271072387695312
generate_one_block  0.0010807514190673828
generate_one_block  0.0010249614715576172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006835460662841797
gen group dst list time:  0.00010061264038085938
time for parepare:  0.00023102760314941406
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002892017364501953
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00020623207092285156
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.000102996826171875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00016307830810546875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001304149627685547
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00018334388732910156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001227855682373047
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00011849403381347656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.179115295410156e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00016498565673828125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001308917999267578
----------------------check_connections_block total spend ----------------------------- 0.006177186965942383
generate_one_block  0.0013432502746582031
generate_one_block  0.0011358261108398438
generate_one_block  0.0012700557708740234
generate_one_block  0.001149892807006836
generate_one_block  0.0010974407196044922
generate_one_block  0.001203298568725586
generate_one_block  0.0011985301971435547
generate_one_block  0.0012519359588623047
generate_one_block  0.0011701583862304688
generate_one_block  0.0011479854583740234
generate_one_block  0.0017328262329101562
generate_one_block  0.001112222671508789
generate_one_block  0.0012199878692626953
generate_one_block  0.0012006759643554688
generate_one_block  0.0011692047119140625
generate_one_block  0.0011065006256103516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008103847503662109
gen group dst list time:  0.00017118453979492188
time for parepare:  0.00024962425231933594
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007121562957763672
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.00036215782165527344
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0006461143493652344
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0003476142883300781
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00022673606872558594
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005643367767333984
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0005297660827636719
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0006315708160400391
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.00044918060302734375
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0004811286926269531
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0003848075866699219
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003275871276855469
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0006699562072753906
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0006456375122070312
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0005657672882080078
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.00045180320739746094
----------------------check_connections_block total spend ----------------------------- 0.015343427658081055
generate_one_block  0.00202178955078125
generate_one_block  0.0014948844909667969
generate_one_block  0.001844167709350586
generate_one_block  0.0015032291412353516
generate_one_block  0.0012519359588623047
generate_one_block  0.0016765594482421875
generate_one_block  0.0017206668853759766
generate_one_block  0.0017254352569580078
generate_one_block  0.0015292167663574219
generate_one_block  0.0015130043029785156
generate_one_block  0.0014712810516357422
generate_one_block  0.0013194084167480469
generate_one_block  0.0017943382263183594
generate_one_block  0.001712799072265625
generate_one_block  0.001653909683227539
generate_one_block  0.001477956771850586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008199214935302734
gen group dst list time:  0.0004076957702636719
time for parepare:  0.0002148151397705078
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0017008781433105469
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00023746490478515625
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0011608600616455078
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0016491413116455078
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0010521411895751953
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0006842613220214844
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0013489723205566406
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0014295578002929688
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0014574527740478516
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.001163482666015625
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0011551380157470703
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0010213851928710938
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0009462833404541016
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0016276836395263672
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0014750957489013672
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.001329660415649414
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.001123189926147461
----------------------check_connections_block total spend ----------------------------- 0.033266544342041016
generate_one_block  0.0032007694244384766
generate_one_block  0.002389192581176758
generate_one_block  0.002868175506591797
generate_one_block  0.0024383068084716797
generate_one_block  0.0017621517181396484
generate_one_block  0.002542734146118164
generate_one_block  0.002627849578857422
generate_one_block  0.002572774887084961
generate_one_block  0.002336263656616211
generate_one_block  0.002282857894897461
generate_one_block  0.0021810531616210938
generate_one_block  0.002131223678588867
generate_one_block  0.002844095230102539
generate_one_block  0.002767801284790039
generate_one_block  0.002631664276123047
generate_one_block  0.002339601516723633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008668899536132812
gen group dst list time:  0.00075531005859375
time for parepare:  0.0002148151397705078
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.0005142688751220703
mini_batch_src_global generation:  0.00021839141845703125
r_  generation:  0.002666950225830078
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.002185344696044922
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0026094913482666016
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.002165079116821289
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.001531362533569336
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0023407936096191406
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.0022611618041992188
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.00021529197692871094
r_  generation:  0.002223491668701172
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  0.00021958351135253906
r_  generation:  0.0020067691802978516
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0006270408630371094
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.001802206039428711
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.001798868179321289
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0002770423889160156
mini_batch_src_global generation:  0.00018644332885742188
r_  generation:  0.0019352436065673828
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.00032019615173339844
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.0023953914642333984
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.002404451370239258
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.002246856689453125
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.0002751350402832031
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0019290447235107422
----------------------check_connections_block total spend ----------------------------- 0.05415821075439453
generate_one_block  0.004338264465332031
generate_one_block  0.0035247802734375
generate_one_block  0.003813028335571289
generate_one_block  0.00336456298828125
generate_one_block  0.002811908721923828
generate_one_block  0.003612995147705078
generate_one_block  0.0036666393280029297
generate_one_block  0.003618955612182617
generate_one_block  0.0033826828002929688
generate_one_block  0.0033435821533203125
generate_one_block  0.0031540393829345703
generate_one_block  0.0034165382385253906
generate_one_block  0.004165172576904297
generate_one_block  0.003864288330078125
generate_one_block  0.0037157535552978516
generate_one_block  0.0032973289489746094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.30782318115234375  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

connection checking time:  0.10894536972045898
block generation total time  0.1422274112701416
average batch blocks generation time:  0.00888921320438385
block dataloader generation time/epoch 0.40926051139831543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.31019020080566406  GigaBytes
Max Memory Allocated: 1.0374622344970703  GigaBytes

torch.Size([2216, 1433])
torch.Size([1742, 256])
torch.Size([1016, 256])
torch.Size([359, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 1.1106104850769043  GigaBytes
Max Memory Allocated: 1.110689640045166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30902528762817383  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2004, 1433])
torch.Size([1377, 256])
torch.Size([613, 256])
torch.Size([155, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9350361824035645  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.3097372055053711  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2132, 1433])
torch.Size([1700, 256])
torch.Size([947, 256])
torch.Size([333, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.0753989219665527  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30917835235595703  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2033, 1433])
torch.Size([1364, 256])
torch.Size([568, 256])
torch.Size([170, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9264469146728516  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30658388137817383  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([1552, 1433])
torch.Size([889, 256])
torch.Size([344, 256])
torch.Size([93, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.727299690246582  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30921030044555664  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2036, 1433])
torch.Size([1501, 256])
torch.Size([753, 256])
torch.Size([257, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9943737983703613  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30954408645629883  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2098, 1433])
torch.Size([1584, 256])
torch.Size([788, 256])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.0290260314941406  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30987071990966797  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2159, 1433])
torch.Size([1537, 256])
torch.Size([847, 256])
torch.Size([302, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.019862174987793  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30889034271240234  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([1978, 1433])
torch.Size([1362, 256])
torch.Size([646, 256])
torch.Size([213, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9360246658325195  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30820751190185547  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([1851, 1433])
torch.Size([1235, 256])
torch.Size([631, 256])
torch.Size([224, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.8814482688903809  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.3078346252441406  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([1782, 1433])
torch.Size([1210, 256])
torch.Size([558, 256])
torch.Size([181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.8698182106018066  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.3087153434753418  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([1947, 1433])
torch.Size([1304, 256])
torch.Size([508, 256])
torch.Size([154, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9059963226318359  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.31016063690185547  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2211, 1433])
torch.Size([1690, 256])
torch.Size([990, 256])
torch.Size([312, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.083578109741211  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.3099327087402344  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2169, 1433])
torch.Size([1662, 256])
torch.Size([872, 256])
torch.Size([305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.076369285583496  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.30970001220703125  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([2127, 1433])
torch.Size([1584, 256])
torch.Size([828, 256])
torch.Size([267, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 1.0288052558898926  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.3081855773925781  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

torch.Size([1846, 1433])
torch.Size([1319, 256])
torch.Size([644, 256])
torch.Size([195, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4627685546875 GB
    Memory Allocated: 0.9256081581115723  GigaBytes
Max Memory Allocated: 1.1144423484802246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06176052987575531 |0.0010942965745925903 |0.1997072696685791 |0.0001280456781387329 |0.2816946655511856 |0.011690139770507812 |
----------------------------------------------------------pseudo_mini_loss sum 3.2802679538726807
Total (block generation + training)time/epoch 9.208057641983032
Training time/epoch 8.798487663269043
Training time without block to device /epoch 8.780978918075562
Training time without total dataloading part /epoch 7.716169834136963
load block tensor time/epoch 0.988168478012085
block to device time/epoch 0.017508745193481445
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  71300
Number of first layer input nodes during this epoch:  32141
