main start at this time 1648433031.2200212
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010569095611572266
range selection method range initialization spend 7.796287536621094e-05
time for parepare:  6.151199340820312e-05
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0012636184692382812
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.000118255615234375
----------------------check_connections_block total spend ----------------------------- 0.0020389556884765625
generate_one_block  0.0013120174407958984
generate_one_block  0.0011873245239257812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00048232078552246094
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00013756752014160156
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0006232261657714844
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006501674652099609
----------------------check_connections_block total spend ----------------------------- 0.002340555191040039
generate_one_block  0.001764535903930664
generate_one_block  0.0017399787902832031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005645751953125
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.00164794921875
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0016973018646240234
----------------------check_connections_block total spend ----------------------------- 0.005334377288818359
generate_one_block  0.0028939247131347656
generate_one_block  0.002927541732788086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006096363067626953
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0001723766326904297
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.00040650367736816406
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.0025289058685302734
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0025587081909179688
----------------------check_connections_block total spend ----------------------------- 0.008040904998779297
generate_one_block  0.003754138946533203
generate_one_block  0.0038862228393554688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007522106170654297
gen group dst list time:  0.00010275840759277344
time for parepare:  0.00017786026000976562
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.0004138946533203125
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.002924203872680664
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.000316619873046875
r_  generation:  0.002942323684692383
----------------------check_connections_block total spend ----------------------------- 0.008992671966552734
generate_one_block  0.004070758819580078
generate_one_block  0.004101276397705078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.0746145248413086  GigaBytes
Max Memory Allocated: 0.0746145248413086  GigaBytes

connection checking time:  0.02470850944519043
block generation total time  0.025138378143310547
average batch blocks generation time:  0.012569189071655273
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1717529296875 GB
    Memory Allocated: 0.08782768249511719  GigaBytes
Max Memory Allocated: 0.08782768249511719  GigaBytes

torch.Size([2439, 1433])
torch.Size([2288, 256])
torch.Size([1880, 256])
torch.Size([1098, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3748779296875 GB
    Memory Allocated: 1.1605944633483887  GigaBytes
Max Memory Allocated: 1.1610493659973145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 0.16262149810791016  GigaBytes
Max Memory Allocated: 1.1641697883605957  GigaBytes

torch.Size([2452, 1433])
torch.Size([2313, 256])
torch.Size([1899, 256])
torch.Size([1130, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5369873046875 GB
    Memory Allocated: 1.2466635704040527  GigaBytes
Max Memory Allocated: 1.2471098899841309  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04408133029937744 |0.16867876052856445 |0.5062551498413086 |0.0001964569091796875 |0.37256455421447754 |0.018039226531982422 |
----------------------------------------------------------pseudo_mini_loss sum 3.085855484008789
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16189
Number of first layer input nodes during this epoch:  4891
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6971435546875 GB
    Memory Allocated: 0.31154346466064453  GigaBytes
Max Memory Allocated: 1.2502250671386719  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004990100860595703
range selection method range initialization spend 6.318092346191406e-05
time for parepare:  6.818771362304688e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011157989501953125
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001316070556640625
----------------------check_connections_block total spend ----------------------------- 0.0008699893951416016
generate_one_block  0.0012857913970947266
generate_one_block  0.0012085437774658203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000492095947265625
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.0002086162567138672
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006210803985595703
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001595020294189453Using backend: pytorch

mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0007026195526123047
----------------------check_connections_block total spend ----------------------------- 0.002630949020385742
generate_one_block  0.0018756389617919922
generate_one_block  0.0022094249725341797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006060600280761719
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.00019359588623046875
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0016183853149414062
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.0016715526580810547
----------------------check_connections_block total spend ----------------------------- 0.005345582962036133
generate_one_block  0.0030448436737060547
generate_one_block  0.0030670166015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006396770477294922
gen group dst list time:  8.416175842285156e-05
time for parepare:  0.00018739700317382812
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.0027494430541992188
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.0025446414947509766
----------------------check_connections_block total spend ----------------------------- 0.008279085159301758
generate_one_block  0.00399017333984375
generate_one_block  0.003912687301635742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007665157318115234
gen group dst list time:  0.00010442733764648438
time for parepare:  0.00018477439880371094
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.0004429817199707031
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.0030574798583984375
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  0.00029659271240234375
r_  generation:  0.0028913021087646484
----------------------check_connections_block total spend ----------------------------- 0.009137392044067383
generate_one_block  0.0046024322509765625
generate_one_block  0.004297971725463867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6971435546875 GB
    Memory Allocated: 0.31154346466064453  GigaBytes
Max Memory Allocated: 1.2502250671386719  GigaBytes

connection checking time:  0.025393009185791016
block generation total time  0.02700018882751465
average batch blocks generation time:  0.013500094413757324
block dataloader generation time/epoch 0.0797271728515625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6971435546875 GB
    Memory Allocated: 0.31065845489501953  GigaBytes
Max Memory Allocated: 1.2502250671386719  GigaBytes

torch.Size([2464, 1433])
torch.Size([2331, 256])
torch.Size([1903, 256])
torch.Size([1063, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.3935294151306152  GigaBytes
Max Memory Allocated: 1.3939404487609863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7576904296875 GB
    Memory Allocated: 0.31117820739746094  GigaBytes
Max Memory Allocated: 1.397118091583252  GigaBytes

torch.Size([2415, 1433])
torch.Size([2245, 256])
torch.Size([1861, 256])
torch.Size([1081, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 1.3773131370544434  GigaBytes
Max Memory Allocated: 1.397118091583252  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037963151931762695 |0.0008726119995117188 |0.2648477554321289 |0.0001341104507446289 |0.3800743818283081 |0.013727903366088867 |
----------------------------------------------------------pseudo_mini_loss sum 3.0657119750976562
Total (block generation + training)time/epoch 1.5252594947814941
Training time/epoch 1.4452996253967285
Training time without block to device /epoch 1.443554401397705
Training time without total dataloading part /epoch 1.3038403987884521
load block tensor time/epoch 0.07592630386352539
block to device time/epoch 0.0017452239990234375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16058
Number of first layer input nodes during this epoch:  4879
