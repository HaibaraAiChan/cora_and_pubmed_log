main start at this time 1648432899.232235
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013048648834228516
range selection method range initialization spend 8.0108642578125e-05
time for parepare:  6.198883056640625e-05
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.001298666000366211
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.05718994140625e-05
----------------------check_connections_block total spend ----------------------------- 0.002511739730834961
generate_one_block  0.0015325546264648438
generate_one_block  0.0011012554168701172
generate_one_block  0.0010807514190673828
generate_one_block  0.0011057853698730469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004875659942626953
gen group dst list time:  3.838539123535156e-05
time for parepare:  0.00013184547424316406
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004928112030029297
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00031566619873046875
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00031757354736328125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00040984153747558594
----------------------check_connections_block total spend ----------------------------- 0.0029938220977783203
generate_one_block  0.0016493797302246094
generate_one_block  0.0013871192932128906
generate_one_block  0.0013930797576904297
generate_one_block  0.0015616416931152344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005505084991455078
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0001633167266845703
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0014331340789794922
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0009765625
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0010619163513183594
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0011248588562011719
----------------------check_connections_block total spend ----------------------------- 0.0074520111083984375
generate_one_block  0.002653360366821289
generate_one_block  0.002106904983520508
generate_one_block  0.002192258834838867
generate_one_block  0.0022704601287841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007236003875732422
gen group dst list time:  0.00012373924255371094
time for parepare:  0.00019550323486328125
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.00041174888610839844
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.00244140625
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.001941680908203125
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0020835399627685547
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0020809173583984375
----------------------check_connections_block total spend ----------------------------- 0.013232946395874023
generate_one_block  0.0036602020263671875
generate_one_block  0.003203153610229492
generate_one_block  0.0034399032592773438
generate_one_block  0.0032846927642822266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007605552673339844
gen group dst list time:  0.00017452239990234375
time for parepare:  0.00018644332885742188
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.002908945083618164
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003237724304199219
mini_batch_src_global generation:  0.00029206275939941406
r_  generation:  0.0027277469635009766
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003216266632080078
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.0027086734771728516
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.002653360366821289
----------------------check_connections_block total spend ----------------------------- 0.016670703887939453
generate_one_block  0.004205942153930664
generate_one_block  0.003969669342041016
generate_one_block  0.0038881301879882812
generate_one_block  0.003838777542114258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

connection checking time:  0.040349483489990234
block generation total time  0.04470467567443848
average batch blocks generation time:  0.01117616891860962
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07768011093139648  GigaBytes
Max Memory Allocated: 0.07768011093139648  GigaBytes

torch.Size([2437, 1433])
torch.Size([2270, 64])
torch.Size([1764, 64])
torch.Size([944, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.944338321685791  GigaBytes
Max Memory Allocated: 0.9586038589477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3045654296875 GB
    Memory Allocated: 0.1398000717163086  GigaBytes
Max Memory Allocated: 0.9957046508789062  GigaBytes

torch.Size([2370, 1433])
torch.Size([2079, 64])
torch.Size([1350, 64])
torch.Size([618, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.9451174736022949  GigaBytes
Max Memory Allocated: 0.9957046508789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.13962459564208984  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

torch.Size([2336, 1433])
torch.Size([2071, 64])
torch.Size([1434, 64])
torch.Size([645, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.9421095848083496  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.13945531845092773  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

torch.Size([2304, 1433])
torch.Size([2024, 64])
torch.Size([1471, 64])
torch.Size([690, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.9243350028991699  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06009036302566528 |0.08524054288864136 |0.36677122116088867 |0.0001544952392578125 |0.32926708459854126 |0.018164634704589844 |
----------------------------------------------------------pseudo_mini_loss sum 2.8411812782287598
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27543
Number of first layer input nodes during this epoch:  9447
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 0.26672792434692383  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005166530609130859
range selection method range initialization spend 6.818771362304688e-05
time for parepare:  7.82012939453125e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.176399230957031e-05
----------------------check_connections_block total spend ----------------------------- 0.0012784004211425781
generate_one_block  0.001230001449584961
generate_one_block  0.0011289119720458984
generate_one_block  0.00109100341796875
generate_one_block  0.0011684894561767578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005483627319335938
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.0001537799835205078
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00038552284240722656
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0004329681396484375
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00035858154296875
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0004982948303222656
----------------------check_connections_block total spend ----------------------------- 0.0034363269805908203
generate_one_block  0.0016829967498779297
generate_one_block  0.0016074180603027344
generate_one_block  0.0015246868133544922
generate_one_block  0.0016326904296875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006132125854492188
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0002002716064453125
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00028514862060546875
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0010976791381835938
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0023572444915771484
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0010917186737060547
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0014452934265136719
----------------------check_connections_block total spend ----------------------------- 0.009243488311767578
generate_one_block  0.002568483352661133
generate_one_block  0.0025866031646728516
generate_one_block  0.0023856163024902344
generate_one_block  0.0027027130126953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007684230804443359
gen group dst list time:  0.00013899803161621094
time for parepare:  0.00018644332885742188
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00040459632873535156
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0021834373474121094
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.00023317337036132812
r_  generation:  0.002151966094970703
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.00019431114196777344
r_  generation:  0.0021560192108154297
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0023720264434814453
----------------------check_connections_block total spend ----------------------------- 0.01399374008178711
generate_one_block  0.003662586212158203
generate_one_block  0.0035009384155273438
generate_one_block  0.0036063194274902344
generate_one_block  0.003755331039428711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007777214050292969
gen group dst list time:  0.0001876354217529297
time for parepare:  0.000186920166015625
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0004661083221435547
mini_batch_src_global generation:  0.0002491474151611328
r_  generation:  0.0028450489044189453
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0027391910552978516
local_output_nid generation:  0.0001785755157470703
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0029010772705078125
local_output_nid generation:  0.0001685619354248047
local_in_edges_tensor generation:  0.0003352165222167969
mini_batch_src_global generation:  0.00024175643920898438Using backend: pytorch

r_  generation:  0.0029582977294921875
----------------------check_connections_block total spend ----------------------------- 0.017421722412109375
generate_one_block  0.004563570022583008
generate_one_block  0.004360675811767578
generate_one_block  0.004204750061035156
generate_one_block  0.004183292388916016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 0.26672792434692383  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

connection checking time:  0.04409527778625488
block generation total time  0.04852867126464844
average batch blocks generation time:  0.01213216781616211
block dataloader generation time/epoch 0.14013075828552246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 0.26674842834472656  GigaBytes
Max Memory Allocated: 1.0125436782836914  GigaBytes

torch.Size([2360, 1433])
torch.Size([2115, 64])
torch.Size([1526, 64])
torch.Size([647, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 1.080611228942871  GigaBytes
Max Memory Allocated: 1.1029558181762695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 0.26648569107055664  GigaBytes
Max Memory Allocated: 1.1438159942626953  GigaBytes

torch.Size([2310, 1433])
torch.Size([2029, 64])
torch.Size([1492, 64])
torch.Size([769, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 1.0561885833740234  GigaBytes
Max Memory Allocated: 1.1438159942626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 0.2678236961364746  GigaBytes
Max Memory Allocated: 1.1438159942626953  GigaBytes

torch.Size([2392, 1433])
torch.Size([2136, 64])
torch.Size([1495, 64])
torch.Size([649, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 1.0949697494506836  GigaBytes
Max Memory Allocated: 1.1438159942626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 0.26671886444091797  GigaBytes
Max Memory Allocated: 1.158226490020752  GigaBytes

torch.Size([2351, 1433])
torch.Size([2186, 64])
torch.Size([1701, 64])
torch.Size([868, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5584716796875 GB
    Memory Allocated: 1.1003050804138184  GigaBytes
Max Memory Allocated: 1.158226490020752  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05377376079559326 |0.0011395812034606934 |0.2522011399269104 |0.0001417398452758789 |0.3397650122642517 |0.013205528259277344 |
----------------------------------------------------------pseudo_mini_loss sum 2.351078987121582
Total (block generation + training)time/epoch 2.807711124420166
Training time/epoch 2.6672542095184326
Training time without block to device /epoch 2.66269588470459
Training time without total dataloading part /epoch 2.3816370964050293
load block tensor time/epoch 0.21509504318237305
block to device time/epoch 0.0045583248138427734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27773
Number of first layer input nodes during this epoch:  9413
