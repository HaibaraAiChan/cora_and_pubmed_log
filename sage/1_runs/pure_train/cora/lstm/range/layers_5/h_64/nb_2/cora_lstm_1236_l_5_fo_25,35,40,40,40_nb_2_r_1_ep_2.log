main start at this time 1648432887.3590488
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013437271118164062
range selection method range initialization spend 0.00010538101196289062
time for parepare:  6.580352783203125e-05
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0024175643920898438
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001251697540283203
----------------------check_connections_block total spend ----------------------------- 0.003231525421142578
generate_one_block  0.00145721435546875
generate_one_block  0.0012216567993164062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004949569702148438
gen group dst list time:  2.8848648071289062e-05
time for parepare:  0.00014448165893554688
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0007610321044921875
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0006737709045410156
----------------------check_connections_block total spend ----------------------------- 0.0025751590728759766
generate_one_block  0.001897573471069336
generate_one_block  0.0018091201782226562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000560760498046875
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.00017070770263671875
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0003066062927246094
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0019066333770751953
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0017275810241699219
----------------------check_connections_block total spend ----------------------------- 0.0056688785552978516
generate_one_block  0.003190755844116211
generate_one_block  0.003007173538208008
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005998611450195312
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0001785755157470703
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.00039768218994140625
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.002804994583129883
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.0002884864807128906
r_  generation:  0.0026900768280029297
----------------------check_connections_block total spend ----------------------------- 0.00841212272644043
generate_one_block  0.004064321517944336
generate_one_block  0.003989458084106445
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007467269897460938
gen group dst list time:  0.00010848045349121094
time for parepare:  0.00019788742065429688
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0004642009735107422
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.0032148361206054688
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.003147125244140625
----------------------check_connections_block total spend ----------------------------- 0.009477853775024414
generate_one_block  0.004833221435546875
generate_one_block  0.004158496856689453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0638275146484375  GigaBytes
Max Memory Allocated: 0.0638275146484375  GigaBytes

connection checking time:  0.026134014129638672
block generation total time  0.02695012092590332
average batch blocks generation time:  0.01347506046295166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07770156860351562  GigaBytes
Max Memory Allocated: 0.07770156860351562  GigaBytes

torch.Size([2480, 1433])
torch.Size([2365, 64])
torch.Size([1974, 64])
torch.Size([1207, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.984433650970459  GigaBytes
Max Memory Allocated: 0.9905438423156738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 0.14086627960205078  GigaBytes
Max Memory Allocated: 1.0254182815551758  GigaBytes

torch.Size([2446, 1433])
torch.Size([2292, 64])
torch.Size([1890, 64])
torch.Size([1065, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 1.0203022956848145  GigaBytes
Max Memory Allocated: 1.0299015045166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043207764625549316 |0.170373797416687 |0.4958610534667969 |0.00021028518676757812 |0.3505983352661133 |0.018122196197509766 |
----------------------------------------------------------pseudo_mini_loss sum 2.9867608547210693
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16430
Number of first layer input nodes during this epoch:  4926
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 0.2682151794433594  GigaBytes
Max Memory Allocated: 1.0648860931396484  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005092620849609375
range selection method range initialization spend 6.365776062011719e-05
time for parepare:  7.295608520507812e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00012803077697753906
----------------------check_connections_block total spend ----------------------------- 0.0009050369262695312
generate_one_block  0.0013546943664550781
generate_one_block  0.0012454986572265625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005023479461669922
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.0001614093780517578
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0006692409515380859
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001697540283203125
Using backend: pytorch
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0007414817810058594
----------------------check_connections_block total spend ----------------------------- 0.0027217864990234375
generate_one_block  0.001968860626220703
generate_one_block  0.0019960403442382812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000598907470703125
gen group dst list time:  6.246566772460938e-05
time for parepare:  0.0001983642578125
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0017931461334228516
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0018157958984375
----------------------check_connections_block total spend ----------------------------- 0.005835294723510742
generate_one_block  0.003591775894165039
generate_one_block  0.0031921863555908203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006475448608398438
gen group dst list time:  9.1552734375e-05
time for parepare:  0.0001914501190185547
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.0004105567932128906
mini_batch_src_global generation:  0.00022125244140625
r_  generation:  0.0028290748596191406
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.00030803680419921875
r_  generation:  0.002793550491333008
----------------------check_connections_block total spend ----------------------------- 0.008852243423461914
generate_one_block  0.00546717643737793
generate_one_block  0.004174232482910156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007691383361816406
gen group dst list time:  0.00011897087097167969
time for parepare:  0.0001881122589111328
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.0031800270080566406
local_output_nid generation:  0.0001819133758544922
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.0031158924102783203
----------------------check_connections_block total spend ----------------------------- 0.009655237197875977
generate_one_block  0.004546165466308594
generate_one_block  0.004488468170166016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 0.2682151794433594  GigaBytes
Max Memory Allocated: 1.0648860931396484  GigaBytes

connection checking time:  0.02706456184387207
block generation total time  0.02942490577697754
average batch blocks generation time:  0.01471245288848877
block dataloader generation time/epoch 0.08356904983520508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 0.26786136627197266  GigaBytes
Max Memory Allocated: 1.0648860931396484  GigaBytes

torch.Size([2441, 1433])
torch.Size([2291, 64])
torch.Size([1900, 64])
torch.Size([1112, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 1.1472644805908203  GigaBytes
Max Memory Allocated: 1.1559357643127441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.26786327362060547  GigaBytes
Max Memory Allocated: 1.1915483474731445  GigaBytes

torch.Size([2441, 1433])
torch.Size([2297, 64])
torch.Size([1919, 64])
torch.Size([1139, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 1.1495380401611328  GigaBytes
Max Memory Allocated: 1.1915483474731445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037667155265808105 |0.0008882284164428711 |0.2650076150894165 |0.00013458728790283203 |0.360729455947876 |0.015781164169311523 |
----------------------------------------------------------pseudo_mini_loss sum 2.282879114151001
Total (block generation + training)time/epoch 1.4914588928222656
Training time/epoch 1.4074132442474365
Training time without block to device /epoch 1.4056367874145508
Training time without total dataloading part /epoch 1.2675244808197021
load block tensor time/epoch 0.07533431053161621
block to device time/epoch 0.0017764568328857422
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16244
Number of first layer input nodes during this epoch:  4882
