main start at this time 1648431726.891355
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001249074935913086
range selection method range initialization spend 0.00010561943054199219
time for parepare:  6.151199340820312e-05
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0020356178283691406
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.004994630813598633
generate_one_block  0.0013947486877441406
generate_one_block  0.0009760856628417969
generate_one_block  0.0009908676147460938
generate_one_block  0.0010221004486083984
generate_one_block  0.0009708404541015625
generate_one_block  0.0009646415710449219
generate_one_block  0.0010192394256591797
generate_one_block  0.0009925365447998047
generate_one_block  0.0010035037994384766
generate_one_block  0.0009615421295166016
generate_one_block  0.0010154247283935547
generate_one_block  0.0009710788726806641
generate_one_block  0.0009603500366210938
generate_one_block  0.0009636878967285156
generate_one_block  0.0009589195251464844
generate_one_block  0.0009872913360595703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006208419799804688
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0001361370086669922
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012373924255371094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011277198791503906
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001404285430908203
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010514259338378906
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010037422180175781
----------------------check_connections_block total spend ----------------------------- 0.005342245101928711
generate_one_block  0.0010991096496582031
generate_one_block  0.0010650157928466797
generate_one_block  0.0010945796966552734
generate_one_block  0.0011894702911376953
generate_one_block  0.0011181831359863281
generate_one_block  0.0010750293731689453
generate_one_block  0.0012443065643310547
generate_one_block  0.0010576248168945312
generate_one_block  0.0011157989501953125
generate_one_block  0.0011093616485595703
generate_one_block  0.0011296272277832031
generate_one_block  0.0010628700256347656
generate_one_block  0.0010752677917480469
generate_one_block  0.0010235309600830078
generate_one_block  0.0011174678802490234
generate_one_block  0.001062154769897461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006816387176513672
gen group dst list time:  0.00014829635620117188
time for parepare:  0.00021266937255859375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00025391578674316406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.000354766845703125
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005295276641845703
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005676746368408203
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003495216369628906
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00048828125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00033402442932128906
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005278587341308594
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.000518798828125
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0005669593811035156
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00031757354736328125
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00034427642822265625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002543926239013672
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003859996795654297
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003616809844970703
----------------------check_connections_block total spend ----------------------------- 0.01209259033203125
generate_one_block  0.0012972354888916016
generate_one_block  0.0013661384582519531
generate_one_block  0.00146484375
generate_one_block  0.0017726421356201172
generate_one_block  0.0018720626831054688
generate_one_block  0.0013439655303955078
generate_one_block  0.0015215873718261719
generate_one_block  0.0013427734375
generate_one_block  0.001569986343383789
generate_one_block  0.0015377998352050781
generate_one_block  0.0016298294067382812
generate_one_block  0.0013163089752197266
generate_one_block  0.0013992786407470703
generate_one_block  0.0012366771697998047
generate_one_block  0.0013766288757324219
generate_one_block  0.001352548599243164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007207393646240234
gen group dst list time:  0.0002446174621582031
time for parepare:  0.0001761913299560547
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0006623268127441406
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.001081228256225586
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0011074542999267578
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0013186931610107422
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0014986991882324219
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0010285377502441406
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0012450218200683594
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.001007080078125
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0013914108276367188
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0012967586517333984
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.00144195556640625
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0008568763732910156
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0008409023284912109
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007801055908203125
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0009706020355224609
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0008273124694824219
----------------------check_connections_block total spend ----------------------------- 0.02781391143798828
generate_one_block  0.0017104148864746094
generate_one_block  0.0021533966064453125
generate_one_block  0.0022106170654296875
generate_one_block  0.003232240676879883
generate_one_block  0.0025932788848876953
generate_one_block  0.0020885467529296875
generate_one_block  0.002300739288330078
generate_one_block  0.002068758010864258
generate_one_block  0.0026695728302001953
generate_one_block  0.002363443374633789
generate_one_block  0.0025403499603271484
generate_one_block  0.0019109249114990234
generate_one_block  0.0019478797912597656
generate_one_block  0.0018360614776611328
generate_one_block  0.0020494461059570312
generate_one_block  0.0019185543060302734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

connection checking time:  0.04524874687194824
block generation total time  0.07663393020629883
average batch blocks generation time:  0.004789620637893677
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06755447387695312  GigaBytes
Max Memory Allocated: 0.06755447387695312  GigaBytes

torch.Size([895, 1433])
torch.Size([390, 16])
torch.Size([153, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.23952293395996094  GigaBytes
Max Memory Allocated: 0.2527942657470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.13250064849853516  GigaBytes
Max Memory Allocated: 0.35935020446777344  GigaBytes

torch.Size([1304, 1433])
torch.Size([641, 16])
torch.Size([173, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.4248952865600586  GigaBytes
Max Memory Allocated: 0.44790077209472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7694091796875 GB
    Memory Allocated: 0.1333332061767578  GigaBytes
Max Memory Allocated: 0.5427484512329102  GigaBytes

torch.Size([1294, 1433])
torch.Size([653, 16])
torch.Size([185, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.431546688079834  GigaBytes
Max Memory Allocated: 0.5427484512329102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.13390111923217773  GigaBytes
Max Memory Allocated: 0.5496044158935547  GigaBytes

torch.Size([1564, 1433])
torch.Size([819, 16])
torch.Size([282, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.4894871711730957  GigaBytes
Max Memory Allocated: 0.5496044158935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.1340341567993164  GigaBytes
Max Memory Allocated: 0.604949951171875  GigaBytes

torch.Size([1588, 1433])
torch.Size([931, 16])
torch.Size([291, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8397216796875 GB
    Memory Allocated: 0.5346221923828125  GigaBytes
Max Memory Allocated: 0.604949951171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.13278818130493164  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1358, 1433])
torch.Size([596, 16])
torch.Size([192, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.4044170379638672  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.13347578048706055  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1485, 1433])
torch.Size([781, 16])
torch.Size([287, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.4593019485473633  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.13278722763061523  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1325, 1433])
torch.Size([600, 16])
torch.Size([197, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.3995213508605957  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.1336832046508789  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1523, 1433])
torch.Size([875, 16])
torch.Size([279, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.5078330039978027  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.1334552764892578  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1481, 1433])
torch.Size([774, 16])
torch.Size([271, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.4770197868347168  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.13420391082763672  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1620, 1433])
torch.Size([891, 16])
torch.Size([342, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.5182580947875977  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.13145923614501953  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1110, 1433])
torch.Size([511, 16])
torch.Size([187, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.35989999771118164  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.13164281845092773  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1144, 1433])
torch.Size([537, 16])
torch.Size([173, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.36658525466918945  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.13168954849243164  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1154, 1433])
torch.Size([464, 16])
torch.Size([135, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.339475154876709  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.13231754302978516  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1270, 1433])
torch.Size([607, 16])
torch.Size([216, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.39353132247924805  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.13125324249267578  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1071, 1433])
torch.Size([511, 16])
torch.Size([190, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.36395740509033203  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05548371374607086 |0.021897077560424805 |0.15630850195884705 |0.00011788308620452881 |0.1802983582019806 |0.015036344528198242 |
----------------------------------------------------------pseudo_mini_loss sum 2.608949661254883
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  36075
Number of first layer input nodes during this epoch:  21186
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.2568016052246094  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005791187286376953
range selection method range initialization spend 7.605552673339844e-05
time for parepare:  7.963180541992188e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0033292770385742188
generate_one_block  0.0011699199676513672
generate_one_block  0.0010466575622558594
generate_one_block  0.0010051727294921875
generate_one_block  0.0012667179107666016
generate_one_block  0.0010762214660644531
generate_one_block  0.0010330677032470703
generate_one_block  0.0010347366333007812
generate_one_block  0.001064300537109375
generate_one_block  0.00102996826171875
generate_one_block  0.0009779930114746094
generate_one_block  0.0009894371032714844
generate_one_block  0.0010542869567871094
generate_one_block  0.0010006427764892578
generate_one_block  0.0009748935699462891
generate_one_block  0.0009846687316894531
generate_one_block  0.0009596347808837891
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00057220458984375
gen group dst list time:  9.202957153320312e-05
time for parepare:  0.00018453598022460938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00015306472778320312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001125335693359375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012135505676269531
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.601478576660156e-05
----------------------check_connections_block total spend ----------------------------- 0.005625486373901367
generate_one_block  0.0012166500091552734
generate_one_block  0.0011365413665771484
generate_one_block  0.0011091232299804688
generate_one_block  0.0012466907501220703
generate_one_block  0.001117706298828125
generate_one_block  0.0011644363403320312
generate_one_block  0.0010981559753417969
generate_one_block  0.0010967254638671875
generate_one_block  0.0011506080627441406
generate_one_block  0.00110626220703125
generate_one_block  0.0011148452758789062
generate_one_block  0.0011777877807617188
generate_one_block  0.0011343955993652344
generate_one_block  0.001100778579711914
generate_one_block  0.0010924339294433594
generate_one_block  0.0010025501251220703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007567405700683594
gen group dst list time:  0.00016689300537109375
time for parepare:  0.0002219676971435547
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.00047087669372558594
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.000457763671875
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0006785392761230469
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005061626434326172
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00036597251892089844
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005376338958740234
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00032448768615722656
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004086494445800781
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0005948543548583984
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00038933753967285156
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00045561790466308594
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00013327598571777344
----------------------check_connections_block total spend ----------------------------- 0.013345003128051758
generate_one_block  0.0016207695007324219
generate_one_block  0.0016014575958251953
generate_one_block  0.0013947486877441406
generate_one_block  0.001798868179321289
generate_one_block  0.001434326171875
generate_one_block  0.0015969276428222656
generate_one_block  0.0014393329620361328
generate_one_block  0.0015022754669189453
generate_one_block  0.0017769336700439453
generate_one_block  0.0013833045959472656
generate_one_block  0.0014972686767578125
generate_one_block  0.0017578601837158203
generate_one_block  0.0014004707336425781
generate_one_block  0.0014495849609375
generate_one_block  0.0015099048614501953
generate_one_block  0.0011382102966308594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008029937744140625
gen group dst list time:  0.0003364086151123047
time for parepare:  0.00019931793212890625
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0012154579162597656
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0011107921600341797
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0007693767547607422
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0016164779663085938
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0010402202606201172
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0012905597686767578
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.001066446304321289
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0008873939514160156
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0013132095336914062
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0009543895721435547
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0009486675262451172
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.001516103744506836
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0008940696716308594
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0009593963623046875
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0011398792266845703
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004630088806152344
----------------------check_connections_block total spend ----------------------------- 0.028618812561035156
generate_one_block  0.0026636123657226562
generate_one_block  0.002335071563720703
generate_one_block  0.0019490718841552734
generate_one_block  0.0028586387634277344
generate_one_block  0.002237558364868164
generate_one_block  0.0031740665435791016
generate_one_block  0.002331256866455078
generate_one_block  0.002009868621826172
generate_one_block  0.002620220184326172
generate_one_block  0.0021300315856933594
generate_one_block  0.0021696090698242188
generate_one_block  0.0027878284454345703
generate_one_block  0.0021255016326904297
generate_one_block  0.002217531204223633
generate_one_block  0.0023839473724365234
generate_one_block  0.001554727554321289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.2568016052246094  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

connection checking time:  0.04758930206298828
block generation total time  0.07991647720336914
average batch blocks generation time:  0.004994779825210571
block dataloader generation time/epoch 0.21918892860412598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.25939130783081055  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

torch.Size([1564, 1433])
torch.Size([768, 16])
torch.Size([254, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.5987358093261719  GigaBytes
Max Memory Allocated: 0.6497631072998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2582511901855469  GigaBytes
Max Memory Allocated: 0.7152996063232422  GigaBytes

torch.Size([1351, 1433])
torch.Size([649, 16])
torch.Size([220, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.5579843521118164  GigaBytes
Max Memory Allocated: 0.7152996063232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.2564353942871094  GigaBytes
Max Memory Allocated: 0.7152996063232422  GigaBytes

torch.Size([1013, 1433])
torch.Size([490, 16])
torch.Size([215, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.46167850494384766  GigaBytes
Max Memory Allocated: 0.7152996063232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.26006317138671875  GigaBytes
Max Memory Allocated: 0.7152996063232422  GigaBytes

torch.Size([1687, 1433])
torch.Size([994, 16])
torch.Size([360, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.6864128112792969  GigaBytes
Max Memory Allocated: 0.719757080078125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2578310966491699  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1273, 1433])
torch.Size([648, 16])
torch.Size([165, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5428338050842285  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.25896692276000977  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1484, 1433])
torch.Size([766, 16])
torch.Size([273, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5922789573669434  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.258878231048584  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1469, 1433])
torch.Size([630, 16])
torch.Size([207, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5450859069824219  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2568068504333496  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1082, 1433])
torch.Size([479, 16])
torch.Size([199, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.4835686683654785  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2595357894897461  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1590, 1433])
torch.Size([834, 16])
torch.Size([279, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.621711254119873  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.25719738006591797  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1155, 1433])
torch.Size([551, 16])
torch.Size([172, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5095915794372559  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2573232650756836  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1178, 1433])
torch.Size([576, 16])
torch.Size([224, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5130348205566406  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.26012325286865234  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1699, 1433])
torch.Size([943, 16])
torch.Size([310, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.6643838882446289  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.25801515579223633  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1308, 1433])
torch.Size([575, 16])
torch.Size([189, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.502892017364502  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2582669258117676  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1355, 1433])
torch.Size([610, 16])
torch.Size([238, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5197019577026367  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.2584819793701172  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([1394, 1433])
torch.Size([687, 16])
torch.Size([214, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.5687742233276367  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.25478219985961914  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

torch.Size([706, 1433])
torch.Size([247, 16])
torch.Size([57, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.3747096061706543  GigaBytes
Max Memory Allocated: 0.8006458282470703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055631622672080994 |0.0005932003259658813 |0.1255795806646347 |0.00011514127254486084 |0.17730730772018433 |0.012217998504638672 |
----------------------------------------------------------pseudo_mini_loss sum 2.497769594192505
Total (block generation + training)time/epoch 6.041777849197388
Training time/epoch 5.822264194488525
Training time without block to device /epoch 5.812772989273071
Training time without total dataloading part /epoch 4.860250473022461
load block tensor time/epoch 0.8901059627532959
block to device time/epoch 0.009491205215454102
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  36083
Number of first layer input nodes during this epoch:  21308
