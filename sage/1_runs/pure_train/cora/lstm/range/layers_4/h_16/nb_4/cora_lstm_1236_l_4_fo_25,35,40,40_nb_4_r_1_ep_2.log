main start at this time 1648431697.4461222
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015392303466796875
range selection method range initialization spend 0.00012350082397460938
time for parepare:  0.00011920928955078125
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0023419857025146484
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.987022399902344e-05
----------------------check_connections_block total spend ----------------------------- 0.0041196346282958984
generate_one_block  0.0015850067138671875
generate_one_block  0.00206756591796875
generate_one_block  0.0012555122375488281
generate_one_block  0.001100778579711914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005958080291748047
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.0001583099365234375
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003886222839355469
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004684925079345703
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00043487548828125
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.000347137451171875
----------------------check_connections_block total spend ----------------------------- 0.0031862258911132812
generate_one_block  0.0014982223510742188
generate_one_block  0.001562356948852539
generate_one_block  0.0015342235565185547
generate_one_block  0.001420736312866211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006325244903564453
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.0001785755157470703
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00026297569274902344
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0011394023895263672
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.001355886459350586
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0013616085052490234
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0010328292846679688
----------------------check_connections_block total spend ----------------------------- 0.007935285568237305
generate_one_block  0.00246429443359375
generate_one_block  0.0025963783264160156
generate_one_block  0.002523183822631836
generate_one_block  0.0020797252655029297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007593631744384766
gen group dst list time:  0.00013136863708496094
time for parepare:  0.0001819133758544922
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0021915435791015625
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0023834705352783203
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.0024302005767822266
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0020742416381835938
----------------------check_connections_block total spend ----------------------------- 0.013808488845825195
generate_one_block  0.003988981246948242
generate_one_block  0.003498554229736328
generate_one_block  0.0035207271575927734
generate_one_block  0.003131866455078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

connection checking time:  0.02493000030517578
block generation total time  0.029819250106811523
average batch blocks generation time:  0.007454812526702881
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07455921173095703  GigaBytes
Max Memory Allocated: 0.07455921173095703  GigaBytes

torch.Size([2058, 1433])
torch.Size([1437, 16])
torch.Size([638, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6553215980529785  GigaBytes
Max Memory Allocated: 0.7004146575927734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.1363205909729004  GigaBytes
Max Memory Allocated: 0.7643446922302246  GigaBytes

torch.Size([2130, 1433])
torch.Size([1606, 16])
torch.Size([779, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0252685546875 GB
    Memory Allocated: 0.7597737312316895  GigaBytes
Max Memory Allocated: 0.809051513671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1190185546875 GB
    Memory Allocated: 0.13666915893554688  GigaBytes
Max Memory Allocated: 0.8666911125183105  GigaBytes

torch.Size([2150, 1433])
torch.Size([1615, 16])
torch.Size([790, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.7750148773193359  GigaBytes
Max Memory Allocated: 0.8666911125183105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.1357426643371582  GigaBytes
Max Memory Allocated: 0.8820185661315918  GigaBytes

torch.Size([2025, 1433])
torch.Size([1316, 16])
torch.Size([581, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.6854829788208008  GigaBytes
Max Memory Allocated: 0.8820185661315918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05603712797164917 |0.08772003650665283 |0.2942172884941101 |0.00015115737915039062 |0.23162293434143066 |0.014988422393798828 |
----------------------------------------------------------pseudo_mini_loss sum 2.824475049972534
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17847
Number of first layer input nodes during this epoch:  8363
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.2613692283630371  GigaBytes
Max Memory Allocated: 0.8820185661315918  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005166530609130859
range selection method range initialization spend 6.890296936035156e-05
time for parepare:  8.177757263183594e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.437301635742188e-05
----------------------check_connections_block total spend ----------------------------- 0.0012879371643066406
generate_one_block  0.0012366771697998047
generate_one_block  0.0011179447174072266
generate_one_block  0.0011196136474609375
generate_one_block  0.0010983943939208984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000507354736328125
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.00015926361083984375
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00047659873962402344
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.00045228004455566406
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0003795623779296875
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0004057884216308594
----------------------check_connections_block total spend ----------------------------- 0.0034055709838867188
generate_one_block  0.0016713142395019531
generate_one_block  0.001743316650390625
generate_one_block  0.001500844955444336
generate_one_block  0.0015308856964111328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005745887756347656
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.001505136489868164
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0013420581817626953
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0011515617370605469
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0012507438659667969
----------------------check_connections_block total spend ----------------------------- 0.008448600769042969
generate_one_block  0.0027608871459960938
generate_one_block  0.002624988555908203
generate_one_block  0.002300739288330078
generate_one_block  0.0023584365844726562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007236003875732422
gen group dst list time:  0.000141143798828125
time for parepare:  0.0002899169921875
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0024712085723876953
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.0002694129943847656
r_  generation:  0.0024292469024658203
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.0022428035736083984
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.0023512840270996094
----------------------check_connections_block total spend ----------------------------- 0.014723777770996094
generate_one_block  0.0040645599365234375
generate_one_block  0.0035588741302490234
generate_one_block  0.0033597946166992188
generate_one_block  0.0035448074340820312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.2613692283630371  GigaBytes
Max Memory Allocated: 0.8820185661315918  GigaBytes

connection checking time:  0.02657794952392578
block generation total time  0.03101944923400879
average batch blocks generation time:  0.007754862308502197
block dataloader generation time/epoch 0.09354662895202637
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.2621641159057617  GigaBytes
Max Memory Allocated: 0.8820185661315918  GigaBytes

torch.Size([2145, 1433])
torch.Size([1598, 16])
torch.Size([805, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.8956069946289062  GigaBytes
Max Memory Allocated: 0.9445199966430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.26181650161743164  GigaBytes
Max Memory Allocated: 1.0015382766723633  GigaBytes

torch.Size([2130, 1433])
torch.Size([1571, 16])
torch.Size([752, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.886725902557373  GigaBytes
Max Memory Allocated: 1.0015382766723633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.26215362548828125  GigaBytes
Max Memory Allocated: 1.0015382766723633  GigaBytes

torch.Size([2026, 1433])
torch.Size([1427, 16])
torch.Size([621, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8392024040222168  GigaBytes
Max Memory Allocated: 1.0015382766723633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.2617945671081543  GigaBytes
Max Memory Allocated: 1.0015382766723633  GigaBytes

torch.Size([2127, 1433])
torch.Size([1531, 16])
torch.Size([712, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2537841796875 GB
    Memory Allocated: 0.8663740158081055  GigaBytes
Max Memory Allocated: 1.0015382766723633  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054173290729522705 |0.0009091496467590332 |0.1871212124824524 |0.00013494491577148438 |0.24440133571624756 |0.010585546493530273 |
----------------------------------------------------------pseudo_mini_loss sum 2.1811585426330566
Total (block generation + training)time/epoch 2.114753246307373
Training time/epoch 2.0206804275512695
Training time without block to device /epoch 2.0170438289642334
Training time without total dataloading part /epoch 1.737215518951416
load block tensor time/epoch 0.21669316291809082
block to device time/epoch 0.003636598587036133
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18179
Number of first layer input nodes during this epoch:  8428
