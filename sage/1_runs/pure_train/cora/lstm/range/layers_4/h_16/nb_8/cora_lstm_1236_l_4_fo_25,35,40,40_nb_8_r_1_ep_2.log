main start at this time 1648431710.643949
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012433528900146484
range selection method range initialization spend 0.0001220703125
time for parepare:  7.843971252441406e-05
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0027358531951904297
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.004939556121826172
generate_one_block  0.0015075206756591797
generate_one_block  0.0013680458068847656
generate_one_block  0.0012867450714111328
generate_one_block  0.0012853145599365234
generate_one_block  0.0012722015380859375
generate_one_block  0.0012698173522949219
generate_one_block  0.0011823177337646484
generate_one_block  0.0010666847229003906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005278587341308594
gen group dst list time:  7.62939453125e-05
time for parepare:  0.00017595291137695312
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002257823944091797
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003268718719482422
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003123283386230469
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00028324127197265625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003097057342529297
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00028252601623535156
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00021767616271972656
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0002391338348388672
----------------------check_connections_block total spend ----------------------------- 0.004790306091308594
generate_one_block  0.0015532970428466797
generate_one_block  0.0016024112701416016
generate_one_block  0.001608133316040039
generate_one_block  0.0015566349029541016
generate_one_block  0.0016095638275146484
generate_one_block  0.0014946460723876953
generate_one_block  0.001149892807006836
generate_one_block  0.0011837482452392578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006582736968994141
gen group dst list time:  0.000133514404296875
time for parepare:  0.00022459030151367188
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0007302761077880859
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0009908676147460938
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0010340213775634766
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0003497600555419922
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0009546279907226562
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0010869503021240234
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.001016378402709961
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0007309913635253906
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0008096694946289062
----------------------check_connections_block total spend ----------------------------- 0.01276707649230957
generate_one_block  0.002051830291748047
generate_one_block  0.0018973350524902344
generate_one_block  0.0018992424011230469
generate_one_block  0.0018308162689208984
generate_one_block  0.0019376277923583984
generate_one_block  0.0018689632415771484
generate_one_block  0.0015957355499267578
generate_one_block  0.0017383098602294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007860660552978516
gen group dst list time:  0.0002529621124267578
time for parepare:  0.0002346038818359375
local_output_nid generation:  9.274482727050781e-05
local_in_edges_tensor generation:  0.0003409385681152344
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.0016489028930664062
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0018723011016845703
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0019609928131103516
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.00186920166015625
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0020067691802978516
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0018734931945800781
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0014677047729492188
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0013325214385986328
----------------------check_connections_block total spend ----------------------------- 0.021965980529785156
generate_one_block  0.0029015541076660156
generate_one_block  0.0028982162475585938
generate_one_block  0.0029726028442382812
generate_one_block  0.002902984619140625
generate_one_block  0.003028392791748047
generate_one_block  0.003004312515258789
generate_one_block  0.0026526451110839844
generate_one_block  0.002545595169067383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06275224685668945  GigaBytes
Max Memory Allocated: 0.06275224685668945  GigaBytes

connection checking time:  0.03952336311340332
block generation total time  0.0494844913482666
average batch blocks generation time:  0.006185561418533325
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.0720820426940918  GigaBytes
Max Memory Allocated: 0.0720820426940918  GigaBytes

torch.Size([1737, 1433])
torch.Size([974, 16])
torch.Size([321, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.4913783073425293  GigaBytes
Max Memory Allocated: 0.5246176719665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.13582801818847656  GigaBytes
Max Memory Allocated: 0.6059880256652832  GigaBytes

torch.Size([1881, 1433])
torch.Size([1133, 16])
torch.Size([435, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8729248046875 GB
    Memory Allocated: 0.6174483299255371  GigaBytes
Max Memory Allocated: 0.6553630828857422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.1355280876159668  GigaBytes
Max Memory Allocated: 0.7300992012023926  GigaBytes

torch.Size([1865, 1433])
torch.Size([1203, 16])
torch.Size([450, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6351699829101562  GigaBytes
Max Memory Allocated: 0.7300992012023926  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.13566207885742188  GigaBytes
Max Memory Allocated: 0.7474966049194336  GigaBytes

torch.Size([1891, 1433])
torch.Size([1161, 16])
torch.Size([437, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.610558032989502  GigaBytes
Max Memory Allocated: 0.7474966049194336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.1356053352355957  GigaBytes
Max Memory Allocated: 0.7474966049194336  GigaBytes

torch.Size([1879, 1433])
torch.Size([1246, 16])
torch.Size([484, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.6490974426269531  GigaBytes
Max Memory Allocated: 0.7474966049194336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.13558483123779297  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

torch.Size([1876, 1433])
torch.Size([1121, 16])
torch.Size([478, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.6120400428771973  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.1350688934326172  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

torch.Size([1639, 1433])
torch.Size([861, 16])
torch.Size([299, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.5053043365478516  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.1339263916015625  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

torch.Size([1568, 1433])
torch.Size([884, 16])
torch.Size([359, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.5041952133178711  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057047903537750244 |0.04343321919441223 |0.21093618869781494 |0.0001322925090789795 |0.211879700422287 |0.009324312210083008 |
----------------------------------------------------------pseudo_mini_loss sum 2.5590531826019287
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  26928
Number of first layer input nodes during this epoch:  14336
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.2595071792602539  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006444454193115234
range selection method range initialization spend 9.131431579589844e-05
time for parepare:  8.797645568847656e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.0021317005157470703
generate_one_block  0.0012199878692626953
generate_one_block  0.0011005401611328125
generate_one_block  0.0010814666748046875
generate_one_block  0.00104522705078125
generate_one_block  0.001056671142578125
generate_one_block  0.0010709762573242188
generate_one_block  0.0010380744934082031
generate_one_block  0.001027822494506836
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005443096160888672
gen group dst list time:  6.0558319091796875e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.03579354286193848
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0005557537078857422
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0006492137908935547
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0005960464477539062
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0004885196685791016
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0005273818969726562
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0006136894226074219
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0002894401550292969
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00021314620971679688
----------------------check_connections_block total spend ----------------------------- 0.04385972023010254
generate_one_block  0.001953125
generate_one_block  0.001950979232788086
generate_one_block  0.001861572265625
generate_one_block  0.0019381046295166016
generate_one_block  0.001394033432006836
generate_one_block  0.0013699531555175781
generate_one_block  0.0012793540954589844
generate_one_block  0.0012097358703613281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007376670837402344
gen group dst list time:  0.00011348724365234375
time for parepare:  0.0002357959747314453
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0008308887481689453
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0009670257568359375
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0008225440979003906
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0007681846618652344
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0008432865142822266
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0008325576782226562
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0006809234619140625
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0005855560302734375
----------------------check_connections_block total spend ----------------------------- 0.01125478744506836
generate_one_block  0.0022127628326416016
generate_one_block  0.002292156219482422
generate_one_block  0.0020198822021484375
generate_one_block  0.0018768310546875
generate_one_block  0.0019435882568359375
generate_one_block  0.0019402503967285156
generate_one_block  0.001775979995727539
generate_one_block  0.0016171932220458984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007476806640625
gen group dst list time:  0.0002200603485107422
time for parepare:  0.00022864341735839844
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0018842220306396484
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.002023935317993164
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.00020074844360351562
r_  generation:  0.0018086433410644531
local_output_nid generation:  9.274482727050781e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0018091201782226562
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.0019121170043945312
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0018286705017089844
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0016489028930664062
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.001373291015625
----------------------check_connections_block total spend ----------------------------- 0.022894620895385742
generate_one_block  0.0032019615173339844
generate_one_block  0.0031812191009521484
generate_one_block  0.002905130386352539
generate_one_block  0.0029354095458984375
generate_one_block  0.0030221939086914062
generate_one_block  0.002966165542602539
generate_one_block  0.0027573108673095703
generate_one_block  0.0026102066040039062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.2595071792602539  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes

connection checking time:  0.07800912857055664
block generation total time  0.0522150993347168
average batch blocks generation time:  0.0065268874168396
block dataloader generation time/epoch 0.21391963958740234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.26088666915893555  GigaBytes
Max Memory Allocated: 0.7607874870300293  GigaBytes
Using backend: pytorch

torch.Size([1840, 1433])
torch.Size([1117, 16])
torch.Size([422, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0701904296875 GB
    Memory Allocated: 0.7326922416687012  GigaBytes
Max Memory Allocated: 0.7696614265441895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.26123476028442383  GigaBytes
Max Memory Allocated: 0.8451361656188965  GigaBytes

torch.Size([1904, 1433])
torch.Size([1234, 16])
torch.Size([521, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.7706360816955566  GigaBytes
Max Memory Allocated: 0.8451361656188965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2605428695678711  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

torch.Size([1776, 1433])
torch.Size([1089, 16])
torch.Size([404, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.7139701843261719  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2611103057861328  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

torch.Size([1801, 1433])
torch.Size([1041, 16])
torch.Size([395, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.7077755928039551  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.26079607009887695  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

torch.Size([1823, 1433])
torch.Size([1134, 16])
torch.Size([431, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.7422127723693848  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.2608628273010254  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

torch.Size([1798, 1433])
torch.Size([1091, 16])
torch.Size([408, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.7211217880249023  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.2607855796813965  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

torch.Size([1772, 1433])
torch.Size([974, 16])
torch.Size([376, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.6625728607177734  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.25936412811279297  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

torch.Size([1558, 1433])
torch.Size([842, 16])
torch.Size([263, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1385498046875 GB
    Memory Allocated: 0.6268672943115234  GigaBytes
Max Memory Allocated: 0.882103443145752  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05728521943092346 |0.0007375180721282959 |0.1553475558757782 |0.00012406706809997559 |0.21301734447479248 |0.011967897415161133 |
----------------------------------------------------------pseudo_mini_loss sum 2.3332695960998535
Total (block generation + training)time/epoch 3.697812080383301
Training time/epoch 3.4836065769195557
Training time without block to device /epoch 3.4777064323425293
Training time without total dataloading part /epoch 2.9598796367645264
load block tensor time/epoch 0.4582817554473877
block to device time/epoch 0.005900144577026367
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  26756
Number of first layer input nodes during this epoch:  14272
