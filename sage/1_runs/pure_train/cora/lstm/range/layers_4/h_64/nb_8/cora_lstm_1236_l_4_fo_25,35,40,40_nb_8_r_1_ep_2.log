main start at this time 1648431834.6576557
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013496875762939453
range selection method range initialization spend 0.00010800361633300781
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.003556966781616211
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.7418136596679688e-05
----------------------check_connections_block total spend ----------------------------- 0.005414247512817383
generate_one_block  0.00142669677734375
generate_one_block  0.0010731220245361328
generate_one_block  0.0009903907775878906
generate_one_block  0.00101470947265625
generate_one_block  0.0009922981262207031
generate_one_block  0.0009770393371582031
generate_one_block  0.0009765625
generate_one_block  0.0009827613830566406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005557537078857422
gen group dst list time:  5.555152893066406e-05
time for parepare:  0.0001399517059326172
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021839141845703125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00026607513427734375
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00019860267639160156
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00019979476928710938
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017261505126953125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001678466796875
----------------------check_connections_block total spend ----------------------------- 0.003777027130126953
generate_one_block  0.0012750625610351562
generate_one_block  0.0012769699096679688
generate_one_block  0.0012004375457763672
generate_one_block  0.001302957534790039
generate_one_block  0.0011830329895019531
generate_one_block  0.0012295246124267578
generate_one_block  0.0011715888977050781
generate_one_block  0.0011479854583740234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006263256072998047
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.00017023086547851562
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0007526874542236328
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0009257793426513672
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0006935596466064453
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0009055137634277344
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0006258487701416016
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005624294281005859
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005154609680175781
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.000614166259765625
----------------------check_connections_block total spend ----------------------------- 0.009744405746459961
generate_one_block  0.001874685287475586
generate_one_block  0.0020699501037597656
generate_one_block  0.001794576644897461
generate_one_block  0.002030611038208008
generate_one_block  0.0016887187957763672
generate_one_block  0.0017058849334716797
generate_one_block  0.0015568733215332031
generate_one_block  0.0017642974853515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007295608520507812
gen group dst list time:  0.00018167495727539062
time for parepare:  0.00017762184143066406
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0015854835510253906
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.001898050308227539
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0016703605651855469
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.001857757568359375
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.001390218734741211
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0013480186462402344
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0012664794921875
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0015692710876464844
----------------------check_connections_block total spend ----------------------------- 0.019720792770385742
generate_one_block  0.002795696258544922
generate_one_block  0.0031337738037109375
generate_one_block  0.0029125213623046875
generate_one_block  0.003143310546875
generate_one_block  0.002608776092529297
generate_one_block  0.0025479793548583984
generate_one_block  0.002651214599609375
generate_one_block  0.0036001205444335938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

connection checking time:  0.033242225646972656
block generation total time  0.04766654968261719
average batch blocks generation time:  0.0059583187103271484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.0728902816772461  GigaBytes
Max Memory Allocated: 0.0728902816772461  GigaBytes

torch.Size([1715, 1433])
torch.Size([1070, 64])
torch.Size([419, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7674560546875 GB
    Memory Allocated: 0.5316224098205566  GigaBytes
Max Memory Allocated: 0.5572113990783691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.13804054260253906  GigaBytes
Max Memory Allocated: 0.6367993354797363  GigaBytes

torch.Size([1990, 1433])
torch.Size([1309, 64])
torch.Size([572, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.6919031143188477  GigaBytes
Max Memory Allocated: 0.7242212295532227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.13765335083007812  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1920, 1433])
torch.Size([1128, 64])
torch.Size([429, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.6284189224243164  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.1375131607055664  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1891, 1433])
torch.Size([1287, 64])
torch.Size([534, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.6792378425598145  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.13683032989501953  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1669, 1433])
torch.Size([927, 64])
torch.Size([373, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.5388298034667969  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.1359543800354004  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1604, 1433])
torch.Size([872, 64])
torch.Size([310, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.5245685577392578  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.13597726821899414  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1609, 1433])
torch.Size([844, 64])
torch.Size([321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.4960908889770508  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.13703489303588867  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1805, 1433])
torch.Size([1056, 64])
torch.Size([362, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.5880212783813477  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05615872144699097 |0.043723851442337036 |0.21430814266204834 |0.00013434886932373047 |0.24352824687957764 |0.014810323715209961 |
----------------------------------------------------------pseudo_mini_loss sum 2.8795742988586426
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  26764
Number of first layer input nodes during this epoch:  14203
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26446104049682617  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007338523864746094
range selection method range initialization spend 7.963180541992188e-05
time for parepare:  7.963180541992188e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.910064697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0021255016326904297
generate_one_block  0.0012593269348144531
generate_one_block  0.0010428428649902344
generate_one_block  0.001094818115234375
generate_one_block  0.0010442733764648438
generate_one_block  0.0010159015655517578
generate_one_block  0.0010111331939697266
generate_one_block  0.0010945796966552734
generate_one_block  0.0010123252868652344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005397796630859375
gen group dst list time:  6.270408630371094e-05
time for parepare:  0.00018668174743652344
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0002760887145996094
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002682209014892578
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00020170211791992188
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00026345252990722656
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00022339820861816406
----------------------check_connections_block total spend ----------------------------- 0.004395008087158203
generate_one_block  0.001434326171875
generate_one_block  0.0012669563293457031
generate_one_block  0.0013508796691894531
generate_one_block  0.0014028549194335938
generate_one_block  0.00124359130859375
generate_one_block  0.0012195110321044922
generate_one_block  0.0013661384582519531
generate_one_block  0.0012481212615966797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007443428039550781
gen group dst list time:  0.00011110305786132812
time for parepare:  0.00025010108947753906
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00038552284240722656
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0008347034454345703
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0007252693176269531
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0008914470672607422
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0006620883941650391
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0007381439208984375
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006313323974609375
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0009250640869140625
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0006914138793945312
----------------------check_connections_block total spend ----------------------------- 0.011152982711791992
generate_one_block  0.0021376609802246094
generate_one_block  0.0019085407257080078
generate_one_block  0.002075672149658203
generate_one_block  0.0018184185028076172
generate_one_block  0.0019214153289794922
generate_one_block  0.001676321029663086
generate_one_block  0.002094745635986328
generate_one_block  0.0018513202667236328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007691383361816406
gen group dst list time:  0.0002238750457763672
time for parepare:  0.00021266937255859375
local_output_nid generation:  0.00011277198791503906
local_in_edges_tensor generation:  0.0004913806915283203
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0018169879913330078
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0016520023345947266
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.0018773078918457031
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0014529228210449219
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0015959739685058594
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.00041556358337402344
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.001434326171875
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0018374919891357422
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0015616416931152344
----------------------check_connections_block total spend ----------------------------- 0.02151322364807129
generate_one_block  0.003596067428588867
generate_one_block  0.0032584667205810547
generate_one_block  0.0032472610473632812
generate_one_block  0.0026977062225341797
generate_one_block  0.0029489994049072266
generate_one_block  0.0027604103088378906
generate_one_block  0.003265857696533203
generate_one_block  0.0027959346771240234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26446104049682617  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

connection checking time:  0.037061214447021484
block generation total time  0.05058717727661133
average batch blocks generation time:  0.006323397159576416
block dataloader generation time/epoch 0.15349936485290527Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26506471633911133  GigaBytes
Max Memory Allocated: 0.7900552749633789  GigaBytes

torch.Size([1934, 1433])
torch.Size([1173, 64])
torch.Size([490, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.7742366790771484  GigaBytes
Max Memory Allocated: 0.803372859954834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2644362449645996  GigaBytes
Max Memory Allocated: 0.8756351470947266  GigaBytes

torch.Size([1817, 1433])
torch.Size([1088, 64])
torch.Size([413, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.7380385398864746  GigaBytes
Max Memory Allocated: 0.8756351470947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2649192810058594  GigaBytes
Max Memory Allocated: 0.8756351470947266  GigaBytes

torch.Size([1906, 1433])
torch.Size([1221, 64])
torch.Size([490, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.7779173851013184  GigaBytes
Max Memory Allocated: 0.8756351470947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2640838623046875  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

torch.Size([1590, 1433])
torch.Size([944, 64])
torch.Size([399, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6619997024536133  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.2649097442626953  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

torch.Size([1733, 1433])
torch.Size([1041, 64])
torch.Size([439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.7155961990356445  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26407814025878906  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

torch.Size([1698, 1433])
torch.Size([862, 64])
torch.Size([338, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6473145484924316  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26508140563964844  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

torch.Size([1936, 1433])
torch.Size([1234, 64])
torch.Size([520, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.7882204055786133  GigaBytes
Max Memory Allocated: 0.8784513473510742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.26395654678344727  GigaBytes
Max Memory Allocated: 0.8880343437194824  GigaBytes

torch.Size([1728, 1433])
torch.Size([983, 64])
torch.Size([383, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.6828474998474121  GigaBytes
Max Memory Allocated: 0.8880343437194824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057508230209350586 |0.0006614923477172852 |0.15574327111244202 |0.0001157224178314209 |0.2415110170841217 |0.010911941528320312 |
----------------------------------------------------------pseudo_mini_loss sum 2.1093757152557373
Total (block generation + training)time/epoch 3.8690569400787354
Training time/epoch 3.715287923812866
Training time without block to device /epoch 3.709995985031128
Training time without total dataloading part /epoch 3.1898720264434814
load block tensor time/epoch 0.4600658416748047
block to device time/epoch 0.005291938781738281
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27123
Number of first layer input nodes during this epoch:  14342
