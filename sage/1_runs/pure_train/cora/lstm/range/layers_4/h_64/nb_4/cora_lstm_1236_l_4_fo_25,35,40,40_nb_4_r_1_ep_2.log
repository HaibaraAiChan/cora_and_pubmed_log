main start at this time 1648431821.460255
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013592243194580078
range selection method range initialization spend 0.00012612342834472656
time for parepare:  6.651878356933594e-05
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.003960371017456055
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.005249500274658203
generate_one_block  0.0015881061553955078
generate_one_block  0.0011451244354248047
generate_one_block  0.0011641979217529297
generate_one_block  0.0010998249053955078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005168914794921875
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.00015354156494140625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004699230194091797
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004668235778808594
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004067420959472656
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00037026405334472656
----------------------check_connections_block total spend ----------------------------- 0.003287792205810547
generate_one_block  0.0016231536865234375
generate_one_block  0.0015866756439208984
generate_one_block  0.0015060901641845703
generate_one_block  0.0014691352844238281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005841255187988281
gen group dst list time:  8.368492126464844e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0014050006866455078
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0013484954833984375
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.0012919902801513672
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0011661052703857422
----------------------check_connections_block total spend ----------------------------- 0.008352994918823242
generate_one_block  0.0028073787689208984
generate_one_block  0.0026695728302001953
generate_one_block  0.0024182796478271484
generate_one_block  0.0021791458129882812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007660388946533203
gen group dst list time:  0.00014066696166992188
time for parepare:  0.0001933574676513672
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0024886131286621094
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002989768981933594
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.0024213790893554688
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.002399921417236328
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.0023431777954101562
----------------------check_connections_block total spend ----------------------------- 0.01470184326171875
generate_one_block  0.0037832260131835938
generate_one_block  0.003384828567504883
generate_one_block  0.003353118896484375
generate_one_block  0.003346681594848633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

connection checking time:  0.02634263038635254
block generation total time  0.030127286911010742
average batch blocks generation time:  0.0075318217277526855
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07548809051513672  GigaBytes
Max Memory Allocated: 0.07548809051513672  GigaBytes

torch.Size([2156, 1433])
torch.Size([1614, 64])
torch.Size([795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7253518104553223  GigaBytes
Max Memory Allocated: 0.7578425407409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.1388387680053711  GigaBytes
Max Memory Allocated: 0.816378116607666  GigaBytes

torch.Size([2136, 1433])
torch.Size([1558, 64])
torch.Size([768, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0740966796875 GB
    Memory Allocated: 0.7741122245788574  GigaBytes
Max Memory Allocated: 0.816378116607666  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.13914966583251953  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

torch.Size([2085, 1433])
torch.Size([1533, 64])
torch.Size([703, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7632427215576172  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.1388568878173828  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

torch.Size([2141, 1433])
torch.Size([1483, 64])
torch.Size([645, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1522216796875 GB
    Memory Allocated: 0.7440023422241211  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05422317981719971 |0.08754068613052368 |0.30738019943237305 |0.00017571449279785156 |0.2409294843673706 |0.014772891998291016 |
----------------------------------------------------------pseudo_mini_loss sum 3.259916305541992
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18348
Number of first layer input nodes during this epoch:  8518
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.2656822204589844  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005295276641845703
range selection method range initialization spend 6.723403930664062e-05
time for parepare:  8.058547973632812e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.535385131835938e-05
----------------------check_connections_block total spend ----------------------------- 0.001338958740234375
generate_one_block  0.0012400150299072266
generate_one_block  0.00115966796875
generate_one_block  0.001146078109741211
generate_one_block  0.0011594295501708984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005354881286621094
gen group dst list time:  4.673004150390625e-05
time for parepare:  0.0001671314239501953
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0004475116729736328
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004146099090576172
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.000408172607421875
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004949569702148438
----------------------check_connections_block total spend ----------------------------- 0.0035147666931152344
generate_one_block  0.0016748905181884766
generate_one_block  0.0017497539520263672
generate_one_block  0.0015745162963867188
generate_one_block  0.0016813278198242188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005869865417480469
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.0002009868621826172
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0013298988342285156
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0012660026550292969
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.001252889633178711
local_output_nid generation:  0.0011949539184570312
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.001421213150024414
----------------------check_connections_block total spend ----------------------------- 0.009772300720214844
generate_one_block  0.0027174949645996094
generate_one_block  0.0026273727416992188
generate_one_block  0.002420663833618164
generate_one_block  0.002612590789794922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007128715515136719
gen group dst list time:  0.0001537799835205078
time for parepare:  0.00020360946655273438
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.00040531158447265625
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.0025289058685302734
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  0.0002789497375488281
r_  generation:  0.0023622512817382812
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.0023338794708251953
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.0002994537353515625
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.0024826526641845703
----------------------check_connections_block total spend ----------------------------- 0.015121936798095703
generate_one_block  0.003985166549682617
generate_one_block  0.003534555435180664
generate_one_block  0.003396749496459961
generate_one_block  0.0036132335662841797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.2656822204589844  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

connection checking time:  0.02840900421142578
block generation total time  0.03158831596374512
average batch blocks generation time:  0.00789707899093628
block dataloader generation time/epoch 0.0966651439666748
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.2658348083496094  GigaBytes
Max Memory Allocated: 0.8649678230285645  GigaBytes

torch.Size([2118, 1433])
torch.Size([1557, 64])
torch.Size([729, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.9086337089538574  GigaBytes
Max Memory Allocated: 0.943016529083252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.26527833938598633  GigaBytes
Max Memory Allocated: 1.001347541809082  GigaBytes

torch.Size([2092, 1433])
torch.Size([1484, 64])
torch.Size([693, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.8690495491027832  GigaBytes
Max Memory Allocated: 1.001347541809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.26582908630371094  GigaBytes
Max Memory Allocated: 1.001347541809082  GigaBytes

torch.Size([2074, 1433])
torch.Size([1458, 64])
torch.Size([687, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.8679323196411133  GigaBytes
Max Memory Allocated: 1.001347541809082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.2655162811279297  GigaBytes
Max Memory Allocated: 1.001347541809082  GigaBytes

torch.Size([2135, 1433])
torch.Size([1575, 64])
torch.Size([792, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.9013857841491699  GigaBytes
Max Memory Allocated: 1.001347541809082  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05354982614517212 |0.0008818507194519043 |0.18316668272018433 |0.0001366734504699707 |0.24443334341049194 |0.010274171829223633 |
----------------------------------------------------------pseudo_mini_loss sum 2.4612154960632324
Total (block generation + training)time/epoch 2.0996909141540527
Training time/epoch 2.002537488937378
Training time without block to device /epoch 1.9990100860595703
Training time without total dataloading part /epoch 1.7212209701538086
load block tensor time/epoch 0.21419930458068848
block to device time/epoch 0.003527402877807617
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18134
Number of first layer input nodes during this epoch:  8419
