main start at this time 1648431810.1339164
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0017294883728027344
range selection method range initialization spend 0.0001068115234375
time for parepare:  6.031990051269531e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0036923885345458984
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00010561943054199219
----------------------check_connections_block total spend ----------------------------- 0.004479169845581055
generate_one_block  0.0014388561248779297
generate_one_block  0.0011594295501708984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005044937133789062
gen group dst list time:  2.8371810913085938e-05
time for parepare:  0.00013828277587890625
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0006816387176513672
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0005967617034912109
----------------------check_connections_block total spend ----------------------------- 0.0023474693298339844
generate_one_block  0.0019519329071044922
generate_one_block  0.0016629695892333984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005776882171630859
gen group dst list time:  5.555152893066406e-05
time for parepare:  0.00017547607421875
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0016744136810302734
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0017211437225341797
----------------------check_connections_block total spend ----------------------------- 0.0054073333740234375
generate_one_block  0.0029516220092773438
generate_one_block  0.0028908252716064453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006439685821533203
gen group dst list time:  8.702278137207031e-05
time for parepare:  0.00018548965454101562
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0026092529296875
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.0002884864807128906
r_  generation:  0.0026586055755615234
----------------------check_connections_block total spend ----------------------------- 0.008204460144042969
generate_one_block  0.0038046836853027344
generate_one_block  0.0038344860076904297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06367063522338867  GigaBytes
Max Memory Allocated: 0.06367063522338867  GigaBytes

connection checking time:  0.01595926284790039
block generation total time  0.017096519470214844
average batch blocks generation time:  0.008548259735107422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07611227035522461  GigaBytes
Max Memory Allocated: 0.07611227035522461  GigaBytes

torch.Size([2307, 1433])
torch.Size([1902, 64])
torch.Size([1142, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0838623046875 GB
    Memory Allocated: 0.8228259086608887  GigaBytes
Max Memory Allocated: 0.8538689613342285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.1393890380859375  GigaBytes
Max Memory Allocated: 0.9019670486450195  GigaBytes

torch.Size([2356, 1433])
torch.Size([1945, 64])
torch.Size([1084, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2264404296875 GB
    Memory Allocated: 0.896998405456543  GigaBytes
Max Memory Allocated: 0.9311699867248535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04232478141784668 |0.1797475814819336 |0.45379865169525146 |0.0002090930938720703 |0.2666299343109131 |0.01441812515258789 |
----------------------------------------------------------pseudo_mini_loss sum 2.8293323516845703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11424
Number of first layer input nodes during this epoch:  4663
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.26692771911621094  GigaBytes
Max Memory Allocated: 0.9773554801940918  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004992485046386719
range selection method range initialization spend 6.341934204101562e-05
time for parepare:  6.723403930664062e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001220703125
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00013136863708496094
----------------------check_connections_block total spend ----------------------------- 0.0008959770202636719
generate_one_block  0.001352071762084961
generate_one_block  0.0012142658233642578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004937648773193359
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.0001506805419921875
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0007128715515136719
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0008647441864013672
----------------------check_connections_block total spend ----------------------------- 0.002806425094604492
generate_one_block  0.001928091049194336
generate_one_block  0.001962423324584961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005745887756347656
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.00018930435180664062
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0017924308776855469
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.00023984909057617188Using backend: pytorch

r_  generation:  0.0018568038940429688
----------------------check_connections_block total spend ----------------------------- 0.006145000457763672
generate_one_block  0.003185749053955078
generate_one_block  0.003156900405883789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002132892608642578
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.0001819133758544922
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.00040793418884277344
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.002759218215942383
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003447532653808594
mini_batch_src_global generation:  0.00029206275939941406
r_  generation:  0.0027713775634765625
----------------------check_connections_block total spend ----------------------------- 0.008718729019165039
generate_one_block  0.004218339920043945
generate_one_block  0.004035472869873047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.26692771911621094  GigaBytes
Max Memory Allocated: 0.9773554801940918  GigaBytes

connection checking time:  0.017670154571533203
block generation total time  0.018486976623535156
average batch blocks generation time:  0.009243488311767578
block dataloader generation time/epoch 0.058725595474243164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.26648664474487305  GigaBytes
Max Memory Allocated: 0.9773554801940918  GigaBytes

torch.Size([2312, 1433])
torch.Size([1894, 64])
torch.Size([1098, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 1.0060358047485352  GigaBytes
Max Memory Allocated: 1.0380711555480957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3826904296875 GB
    Memory Allocated: 0.2664780616760254  GigaBytes
Max Memory Allocated: 1.0859112739562988  GigaBytes

torch.Size([2310, 1433])
torch.Size([1897, 64])
torch.Size([1136, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 1.0173392295837402  GigaBytes
Max Memory Allocated: 1.0859112739562988  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03907513618469238 |0.0006667375564575195 |0.20074081420898438 |0.00013244152069091797 |0.25694286823272705 |0.01465749740600586 |
----------------------------------------------------------pseudo_mini_loss sum 2.277040958404541
Total (block generation + training)time/epoch 1.1328470706939697
Training time/epoch 1.0737454891204834
Training time without block to device /epoch 1.0724120140075684
Training time without total dataloading part /epoch 0.9302897453308105
load block tensor time/epoch 0.07815027236938477
block to device time/epoch 0.001333475112915039
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11347
Number of first layer input nodes during this epoch:  4622
