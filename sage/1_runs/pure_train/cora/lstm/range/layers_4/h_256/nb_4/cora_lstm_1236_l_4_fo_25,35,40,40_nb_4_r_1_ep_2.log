main start at this time 1648431946.2589548
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014641284942626953
range selection method range initialization spend 8.511543273925781e-05
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.002467632293701172
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.003645181655883789
generate_one_block  0.001499176025390625
generate_one_block  0.0011487007141113281
generate_one_block  0.0011301040649414062
generate_one_block  0.0010790824890136719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005276203155517578
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004622936248779297
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00032830238342285156
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003275871276855469
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00039386749267578125
----------------------check_connections_block total spend ----------------------------- 0.00295257568359375
generate_one_block  0.0016384124755859375
generate_one_block  0.0013966560363769531
generate_one_block  0.0014302730560302734
generate_one_block  0.0015163421630859375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005600452423095703
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0001728534698486328
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0012879371643066406
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0010449886322021484
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0010898113250732422
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0011701583862304688
----------------------check_connections_block total spend ----------------------------- 0.007436275482177734
generate_one_block  0.002595663070678711
generate_one_block  0.0022547245025634766
generate_one_block  0.0023145675659179688
generate_one_block  0.0023441314697265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007486343383789062
gen group dst list time:  0.0001266002655029297
time for parepare:  0.0001785755157470703
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.002214193344116211
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002090930938720703
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0020241737365722656
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00019049644470214844
r_  generation:  0.002218961715698242
----------------------check_connections_block total spend ----------------------------- 0.013210535049438477
generate_one_block  0.003452777862548828
generate_one_block  0.0033566951751708984
generate_one_block  0.0032911300659179688
generate_one_block  0.0034401416778564453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1053466796875 GB
    Memory Allocated: 0.07216119766235352  GigaBytes
Max Memory Allocated: 0.07216119766235352  GigaBytes

connection checking time:  0.02359938621520996
block generation total time  0.02903151512145996
average batch blocks generation time:  0.00725787878036499
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1697998046875 GB
    Memory Allocated: 0.0835123062133789  GigaBytes
Max Memory Allocated: 0.0835123062133789  GigaBytes

torch.Size([2108, 1433])
torch.Size([1565, 256])
torch.Size([769, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.7905941009521484  GigaBytes
Max Memory Allocated: 0.7908682823181152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.1562204360961914  GigaBytes
Max Memory Allocated: 0.8211779594421387  GigaBytes

torch.Size([2114, 1433])
torch.Size([1493, 256])
torch.Size([618, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.8249368667602539  GigaBytes
Max Memory Allocated: 0.8251500129699707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1951904296875 GB
    Memory Allocated: 0.15575313568115234  GigaBytes
Max Memory Allocated: 0.8626923561096191  GigaBytes

torch.Size([2027, 1433])
torch.Size([1429, 256])
torch.Size([653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2010498046875 GB
    Memory Allocated: 0.8057312965393066  GigaBytes
Max Memory Allocated: 0.8626923561096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2049560546875 GB
    Memory Allocated: 0.15658283233642578  GigaBytes
Max Memory Allocated: 0.8626923561096191  GigaBytes

torch.Size([2181, 1433])
torch.Size([1550, 256])
torch.Size([731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2166748046875 GB
    Memory Allocated: 0.849280834197998  GigaBytes
Max Memory Allocated: 0.8626923561096191  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054647862911224365 |0.08427602052688599 |0.295685350894928 |0.0001652836799621582 |0.2555137872695923 |0.012386322021484375 |
----------------------------------------------------------pseudo_mini_loss sum 3.2004637718200684
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17973
Number of first layer input nodes during this epoch:  8430
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.3008079528808594  GigaBytes
Max Memory Allocated: 0.8783230781555176  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005276203155517578
range selection method range initialization spend 6.580352783203125e-05
time for parepare:  7.677078247070312e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.437301635742188e-05
----------------------check_connections_block total spend ----------------------------- 0.0012857913970947266
generate_one_block  0.0012438297271728516
generate_one_block  0.0011706352233886719
generate_one_block  0.0011425018310546875
generate_one_block  0.0011146068572998047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005199909210205078
gen group dst list time:  4.506111145019531e-05
time for parepare:  0.00014972686767578125
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005333423614501953
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0002987384796142578
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0003523826599121094
----------------------check_connections_block total spend ----------------------------- 0.003288745880126953
generate_one_block  0.0017719268798828125
generate_one_block  0.0015435218811035156
generate_one_block  0.0026683807373046875
generate_one_block  0.0014657974243164062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005674362182617188
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.00018835067749023438
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0014581680297851562
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0009417533874511719
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0013117790222167969
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0010983943939208984
----------------------check_connections_block total spend ----------------------------- 0.007935047149658203
generate_one_block  0.0028209686279296875
generate_one_block  0.0021283626556396484
generate_one_block  0.002583742141723633
generate_one_block  0.002255678176879883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007524490356445312
gen group dst list time:  0.00014066696166992188
time for parepare:  0.00019097328186035156
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00044655799865722656
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.002431631088256836
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0018696784973144531
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.002337932586669922
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.0021314620971679688
----------------------check_connections_block total spend ----------------------------- 0.013763189315795898
generate_one_block  0.003843545913696289
generate_one_block  0.003108501434326172
generate_one_block  0.0035080909729003906
generate_one_block  0.003348112106323242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.3008079528808594  GigaBytes
Max Memory Allocated: 0.8783230781555176  GigaBytes

connection checking time:  0.024986982345581055
block generation total time  0.031046628952026367
average batch blocks generation time:  0.007761657238006592
block dataloader generation time/epoch 0.09078502655029297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3455810546875 GB
    Memory Allocated: 0.30038022994995117  GigaBytes
Max Memory Allocated: 0.8783230781555176  GigaBytes

torch.Size([2128, 1433])
torch.Size([1623, 256])
torch.Size([881, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3924560546875 GB
    Memory Allocated: 1.030324935913086  GigaBytes
Max Memory Allocated: 1.0306077003479004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.29929351806640625  GigaBytes
Max Memory Allocated: 1.0391006469726562  GigaBytes

torch.Size([1930, 1433])
torch.Size([1213, 256])
torch.Size([489, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.857231616973877  GigaBytes
Max Memory Allocated: 1.0391006469726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.30034685134887695  GigaBytes
Max Memory Allocated: 1.0391006469726562  GigaBytes

torch.Size([2123, 1433])
torch.Size([1555, 256])
torch.Size([753, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 1.0039029121398926  GigaBytes
Max Memory Allocated: 1.0391006469726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.29991817474365234  GigaBytes
Max Memory Allocated: 1.0391006469726562  GigaBytes

torch.Size([2045, 1433])
torch.Size([1395, 256])
torch.Size([623, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.9340648651123047  GigaBytes
Max Memory Allocated: 1.0391006469726562  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05195051431655884 |0.0009638667106628418 |0.17758780717849731 |0.0001285076141357422 |0.25161057710647583 |0.015359878540039062 |
----------------------------------------------------------pseudo_mini_loss sum 3.1360769271850586
Total (block generation + training)time/epoch 2.0974979400634766
Training time/epoch 2.006319761276245
Training time without block to device /epoch 2.0024642944335938
Training time without total dataloading part /epoch 1.7326674461364746
load block tensor time/epoch 0.20780205726623535
block to device time/epoch 0.003855466842651367
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17491
Number of first layer input nodes during this epoch:  8226
