main start at this time 1648431748.070838
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011172294616699219
range selection method range initialization spend 7.43865966796875e-05
time for parepare:  5.8650970458984375e-05
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0012850761413574219
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001316070556640625
----------------------check_connections_block total spend ----------------------------- 0.0021331310272216797
generate_one_block  0.001493692398071289
generate_one_block  0.0011518001556396484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004725456237792969
gen group dst list time:  2.7894973754882812e-05
time for parepare:  0.00013184547424316406
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005967617034912109
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0007257461547851562
----------------------check_connections_block total spend ----------------------------- 0.002425670623779297
generate_one_block  0.0017161369323730469
generate_one_block  0.0019071102142333984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005452632904052734
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.00016379356384277344
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0015912055969238281
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.001814126968383789
----------------------check_connections_block total spend ----------------------------- 0.0053560733795166016
generate_one_block  0.0027761459350585938
generate_one_block  0.003188610076904297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005831718444824219
gen group dst list time:  8.130073547363281e-05
time for parepare:  0.000179290771484375
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.0002079010009765625
r_  generation:  0.002482175827026367
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  0.0002777576446533203
r_  generation:  0.002620697021484375
----------------------check_connections_block total spend ----------------------------- 0.007976531982421875
generate_one_block  0.0037686824798583984
generate_one_block  0.003854990005493164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

connection checking time:  0.015758275985717773
block generation total time  0.0172116756439209
average batch blocks generation time:  0.00860583782196045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07532405853271484  GigaBytes
Max Memory Allocated: 0.07532405853271484  GigaBytes

torch.Size([2286, 1433])
torch.Size([1827, 32])
torch.Size([1000, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.7801046371459961  GigaBytes
Max Memory Allocated: 0.8280878067016602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1346435546875 GB
    Memory Allocated: 0.13799476623535156  GigaBytes
Max Memory Allocated: 0.8780035972595215  GigaBytes

torch.Size([2343, 1433])
torch.Size([1951, 32])
torch.Size([1236, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1912841796875 GB
    Memory Allocated: 0.8808951377868652  GigaBytes
Max Memory Allocated: 0.9287271499633789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04719960689544678 |0.17195820808410645 |0.4378166198730469 |0.0001666545867919922 |0.262864351272583 |0.014616727828979492 |
----------------------------------------------------------pseudo_mini_loss sum 2.5938239097595215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11346
Number of first layer input nodes during this epoch:  4629
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.2642192840576172  GigaBytes
Max Memory Allocated: 0.9732122421264648  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004858970642089844
range selection method range initialization spend 6.341934204101562e-05
time for parepare:  7.581710815429688e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00011920928955078125
----------------------check_connections_block total spend ----------------------------- 0.0009245872497558594
generate_one_block  0.0012919902801513672
generate_one_block  0.0011799335479736328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005004405975341797
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00015473365783691406
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0006692409515380859
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0006492137908935547
----------------------check_connections_block total spend ----------------------------- 0.002483844757080078
generate_one_block  0.0019347667694091797
generate_one_block  0.0018627643585205078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005447864532470703
gen group dst list time:  0.00010275840759277344
time for parepare:  0.00018072128295898438
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.001695871353149414
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.0002117156982421875Using backend: pytorch

r_  generation:  0.001748800277709961
----------------------check_connections_block total spend ----------------------------- 0.0057413578033447266
generate_one_block  0.003022432327270508
generate_one_block  0.0030460357666015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006265640258789062
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.00018477439880371094
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0025548934936523438
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.0002942085266113281
r_  generation:  0.002717733383178711
----------------------check_connections_block total spend ----------------------------- 0.008310079574584961
generate_one_block  0.004343509674072266
generate_one_block  0.003922224044799805
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.2642192840576172  GigaBytes
Max Memory Allocated: 0.9732122421264648  GigaBytes

connection checking time:  0.016535282135009766
block generation total time  0.018131732940673828
average batch blocks generation time:  0.009065866470336914
block dataloader generation time/epoch 0.05538296699523926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.26384496688842773  GigaBytes
Max Memory Allocated: 0.9732122421264648  GigaBytes

torch.Size([2274, 1433])
torch.Size([1860, 32])
torch.Size([1069, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3475341796875 GB
    Memory Allocated: 0.9844059944152832  GigaBytes
Max Memory Allocated: 1.0317668914794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 0.26389598846435547  GigaBytes
Max Memory Allocated: 1.0802454948425293  GigaBytes

torch.Size([2326, 1433])
torch.Size([1896, 32])
torch.Size([1126, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3787841796875 GB
    Memory Allocated: 0.9866900444030762  GigaBytes
Max Memory Allocated: 1.0802454948425293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03922855854034424 |0.0007935762405395508 |0.20155107975006104 |0.00012743473052978516 |0.2603555917739868 |0.015022754669189453 |
----------------------------------------------------------pseudo_mini_loss sum 2.543076515197754
Total (block generation + training)time/epoch 1.1389505863189697
Training time/epoch 1.0833616256713867
Training time without block to device /epoch 1.0817744731903076
Training time without total dataloading part /epoch 0.9390909671783447
load block tensor time/epoch 0.07845711708068848
block to device time/epoch 0.0015871524810791016
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11252
Number of first layer input nodes during this epoch:  4600
