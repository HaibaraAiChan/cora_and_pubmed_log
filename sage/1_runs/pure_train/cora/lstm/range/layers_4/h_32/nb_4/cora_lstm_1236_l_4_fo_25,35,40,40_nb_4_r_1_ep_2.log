main start at this time 1648431759.2616987
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006835460662841797
range selection method range initialization spend 7.605552673339844e-05
time for parepare:  6.580352783203125e-05
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0014150142669677734
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.152557373046875e-05
----------------------check_connections_block total spend ----------------------------- 0.002603769302368164
generate_one_block  0.0012428760528564453
generate_one_block  0.0010690689086914062
generate_one_block  0.0011086463928222656
generate_one_block  0.0010488033294677734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047016143798828125
gen group dst list time:  4.029273986816406e-05
time for parepare:  0.0001671314239501953
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003082752227783203
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0003864765167236328
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004112720489501953
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004305839538574219
----------------------check_connections_block total spend ----------------------------- 0.0030565261840820312
generate_one_block  0.0013790130615234375
generate_one_block  0.0014662742614746094
generate_one_block  0.0014731884002685547
generate_one_block  0.0015552043914794922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005395412445068359
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0008754730224609375
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0011973381042480469
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00012922286987304688
r_  generation:  0.0012669563293457031
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.001249074935913086
----------------------check_connections_block total spend ----------------------------- 0.007485628128051758
generate_one_block  0.0021474361419677734
generate_one_block  0.002429962158203125
generate_one_block  0.0028307437896728516
generate_one_block  0.0023581981658935547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000736236572265625
gen group dst list time:  0.00013065338134765625
time for parepare:  0.00020766258239746094
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0018584728240966797
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.0021257400512695312
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0022652149200439453
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00019621849060058594
r_  generation:  0.002164602279663086
----------------------check_connections_block total spend ----------------------------- 0.01296234130859375
generate_one_block  0.0031571388244628906
generate_one_block  0.003334522247314453
generate_one_block  0.003435850143432617
generate_one_block  0.0033838748931884766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.0630040168762207  GigaBytes
Max Memory Allocated: 0.0630040168762207  GigaBytes

connection checking time:  0.02350449562072754
block generation total time  0.028951406478881836
average batch blocks generation time:  0.007237851619720459
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.0747995376586914  GigaBytes
Max Memory Allocated: 0.0747995376586914  GigaBytes

torch.Size([2017, 1433])
torch.Size([1294, 32])
torch.Size([556, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.6150121688842773  GigaBytes
Max Memory Allocated: 0.6534147262573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.13671350479125977  GigaBytes
Max Memory Allocated: 0.7222485542297363  GigaBytes

torch.Size([2110, 1433])
torch.Size([1530, 32])
torch.Size([719, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.743466854095459  GigaBytes
Max Memory Allocated: 0.7856602668762207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0760498046875 GB
    Memory Allocated: 0.13717365264892578  GigaBytes
Max Memory Allocated: 0.8463683128356934  GigaBytes

torch.Size([2153, 1433])
torch.Size([1601, 32])
torch.Size([812, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.7743310928344727  GigaBytes
Max Memory Allocated: 0.8463683128356934  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1463623046875 GB
    Memory Allocated: 0.13700342178344727  GigaBytes
Max Memory Allocated: 0.875063419342041  GigaBytes

torch.Size([2164, 1433])
torch.Size([1567, 32])
torch.Size([755, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1502685546875 GB
    Memory Allocated: 0.7610759735107422  GigaBytes
Max Memory Allocated: 0.875063419342041  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05281054973602295 |0.0877956748008728 |0.29566389322280884 |0.00016558170318603516 |0.24047565460205078 |0.013800621032714844 |
----------------------------------------------------------pseudo_mini_loss sum 2.657841920852661
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18012
Number of first layer input nodes during this epoch:  8444
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.26316022872924805  GigaBytes
Max Memory Allocated: 0.875063419342041  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006062984466552734
range selection method range initialization spend 8.606910705566406e-05
time for parepare:  9.465217590332031e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.557868957519531e-05
----------------------check_connections_block total spend ----------------------------- 0.0014941692352294922
generate_one_block  0.0014307498931884766
generate_one_block  0.001375436782836914
generate_one_block  0.0013489723205566406
generate_one_block  0.001355886459350586
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005998611450195312
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0002124309539794922
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005373954772949219
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0005240440368652344
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0005125999450683594
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005743503570556641
----------------------check_connections_block total spend ----------------------------- 0.004189729690551758
generate_one_block  0.0019655227661132812
generate_one_block  0.002057790756225586
generate_one_block  0.0018758773803710938
generate_one_block  0.0019304752349853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006740093231201172
gen group dst list time:  0.00010848045349121094
time for parepare:  0.00023412704467773438
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0014815330505371094
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.001543283462524414
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0015964508056640625
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0016798973083496094
----------------------check_connections_block total spend ----------------------------- 0.010270357131958008
generate_one_block  0.0030558109283447266
generate_one_block  0.002661466598510742
generate_one_block  0.0023670196533203125
generate_one_block  0.0024623870849609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006706714630126953
gen group dst list time:  0.00018548965454101562
time for parepare:  0.0002529621124267578
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0004031658172607422
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.0027115345001220703
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.00034236907958984375
r_  generation:  0.002950429916381836
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.002899169921875
local_output_nid generation:  0.0001811981201171875
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.00027179718017578125
r_  generation:  0.0024797916412353516
----------------------check_connections_block total spend ----------------------------- 0.017271995544433594
generate_one_block  0.0046160221099853516
generate_one_block  0.0035448074340820312
generate_one_block  0.003410816192626953
generate_one_block  0.0035321712493896484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.26316022872924805  GigaBytes
Max Memory Allocated: 0.875063419342041  GigaBytes

connection checking time:  0.03173208236694336
block generation total time  0.033480167388916016
average batch blocks generation time:  0.008370041847229004
block dataloader generation time/epoch 0.1009674072265625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.26177549362182617  GigaBytes
Max Memory Allocated: 0.875063419342041  GigaBytes

torch.Size([1936, 1433])
torch.Size([1382, 32])
torch.Size([698, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.8180127143859863  GigaBytes
Max Memory Allocated: 0.875063419342041  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.2628140449523926  GigaBytes
Max Memory Allocated: 0.9215893745422363  GigaBytes

torch.Size([2129, 1433])
torch.Size([1538, 32])
torch.Size([688, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.8891034126281738  GigaBytes
Max Memory Allocated: 0.9335489273071289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2631654739379883  GigaBytes
Max Memory Allocated: 0.9921693801879883  GigaBytes

torch.Size([2110, 1433])
torch.Size([1514, 32])
torch.Size([725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.8655939102172852  GigaBytes
Max Memory Allocated: 0.9921693801879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.26306867599487305  GigaBytes
Max Memory Allocated: 0.9921693801879883  GigaBytes

torch.Size([2176, 1433])
torch.Size([1593, 32])
torch.Size([781, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.895172119140625  GigaBytes
Max Memory Allocated: 0.9921693801879883  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052809178829193115 |0.000878453254699707 |0.17806118726730347 |0.00013935565948486328 |0.24473291635513306 |0.015291690826416016 |
----------------------------------------------------------pseudo_mini_loss sum 2.469782829284668
Total (block generation + training)time/epoch 2.086693286895752
Training time/epoch 1.985389232635498
Training time without block to device /epoch 1.9818754196166992
Training time without total dataloading part /epoch 1.7070255279541016
load block tensor time/epoch 0.21123671531677246
block to device time/epoch 0.003513813018798828
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18017
Number of first layer input nodes during this epoch:  8351
