main start at this time 1648431897.0068383
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012776851654052734
range selection method range initialization spend 0.00012612342834472656
time for parepare:  7.700920104980469e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0027027130126953125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.552436828613281e-05
----------------------check_connections_block total spend ----------------------------- 0.004923105239868164
generate_one_block  0.0016064643859863281
generate_one_block  0.0014319419860839844
generate_one_block  0.0013785362243652344
generate_one_block  0.001378774642944336
generate_one_block  0.0013551712036132812
generate_one_block  0.0013871192932128906
generate_one_block  0.0011491775512695312
generate_one_block  0.0011510848999023438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005366802215576172
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003523826599121094
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00027680397033691406
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003676414489746094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001857280731201172
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00022339820861816406
----------------------check_connections_block total spend ----------------------------- 0.004847049713134766
generate_one_block  0.0017554759979248047
generate_one_block  0.0015685558319091797
generate_one_block  0.0016803741455078125
generate_one_block  0.0017282962799072266
generate_one_block  0.0016329288482666016
generate_one_block  0.001483917236328125
generate_one_block  0.0011832714080810547
generate_one_block  0.0012135505676269531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006899833679199219
gen group dst list time:  0.0001316070556640625
time for parepare:  0.00022792816162109375
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0010941028594970703
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0007202625274658203
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0010654926300048828
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0003409385681152344
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0010514259338378906
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0009837150573730469
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0011467933654785156
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0006494522094726562
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0008039474487304688
----------------------check_connections_block total spend ----------------------------- 0.012930154800415039
generate_one_block  0.0024001598358154297
generate_one_block  0.0016567707061767578
generate_one_block  0.0019421577453613281
generate_one_block  0.0019576549530029297
generate_one_block  0.0019180774688720703
generate_one_block  0.002047300338745117
generate_one_block  0.0015716552734375
generate_one_block  0.0018110275268554688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007722377777099609
gen group dst list time:  0.00025200843811035156
time for parepare:  0.00024700164794921875
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.0004391670227050781
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.002300262451171875
local_output_nid generation:  9.250640869140625e-05
local_in_edges_tensor generation:  0.0002777576446533203
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0017783641815185547
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.00226593017578125
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.001743316650390625
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0019197463989257812
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.002022266387939453
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0013499259948730469
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0014874935150146484
----------------------check_connections_block total spend ----------------------------- 0.023178577423095703
generate_one_block  0.003119230270385742
generate_one_block  0.0025899410247802734
generate_one_block  0.0028977394104003906
generate_one_block  0.0027418136596679688
generate_one_block  0.0028765201568603516
generate_one_block  0.0030007362365722656
generate_one_block  0.0026357173919677734
generate_one_block  0.002653837203979492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

connection checking time:  0.04095578193664551
block generation total time  0.05006670951843262
average batch blocks generation time:  0.006258338689804077
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07549858093261719  GigaBytes
Max Memory Allocated: 0.07549858093261719  GigaBytes

torch.Size([1833, 1433])
torch.Size([1172, 128])
torch.Size([487, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.5853586196899414  GigaBytes
Max Memory Allocated: 0.5991911888122559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.1398024559020996  GigaBytes
Max Memory Allocated: 0.6767802238464355  GigaBytes

torch.Size([1586, 1433])
torch.Size([854, 128])
torch.Size([323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.5194883346557617  GigaBytes
Max Memory Allocated: 0.6767802238464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.1412067413330078  GigaBytes
Max Memory Allocated: 0.6767802238464355  GigaBytes

torch.Size([1846, 1433])
torch.Size([1132, 128])
torch.Size([479, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6380524635314941  GigaBytes
Max Memory Allocated: 0.6767802238464355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.14075756072998047  GigaBytes
Max Memory Allocated: 0.727081298828125  GigaBytes

torch.Size([1762, 1433])
torch.Size([1059, 128])
torch.Size([471, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.6062150001525879  GigaBytes
Max Memory Allocated: 0.727081298828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.14131879806518555  GigaBytes
Max Memory Allocated: 0.727081298828125  GigaBytes

torch.Size([1867, 1433])
torch.Size([1171, 128])
torch.Size([416, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.6441941261291504  GigaBytes
Max Memory Allocated: 0.727081298828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0213623046875 GB
    Memory Allocated: 0.1413264274597168  GigaBytes
Max Memory Allocated: 0.7346096038818359  GigaBytes

torch.Size([1867, 1433])
torch.Size([1224, 128])
torch.Size([517, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.6857399940490723  GigaBytes
Max Memory Allocated: 0.7346096038818359  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.1399545669555664  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

torch.Size([1615, 1433])
torch.Size([824, 128])
torch.Size([259, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5219688415527344  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.14020347595214844  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

torch.Size([1660, 1433])
torch.Size([984, 128])
torch.Size([352, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.5774226188659668  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05483269691467285 |0.04443490505218506 |0.21597692370414734 |0.00013360381126403809 |0.2254161536693573 |0.01434183120727539 |
----------------------------------------------------------pseudo_mini_loss sum 3.203549385070801
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  26520
Number of first layer input nodes during this epoch:  14036
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.27157020568847656  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006506443023681641
range selection method range initialization spend 9.417533874511719e-05
time for parepare:  0.00010061264038085938
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.555152893066406e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.743171691894531e-05
----------------------check_connections_block total spend ----------------------------- 0.0025131702423095703
generate_one_block  0.0014061927795410156
generate_one_block  0.0013043880462646484
generate_one_block  0.0013494491577148438
generate_one_block  0.0013086795806884766
generate_one_block  0.0013263225555419922
generate_one_block  0.0012977123260498047
generate_one_block  0.0013027191162109375
generate_one_block  0.0012705326080322266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006015300750732422
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.00022459030151367188
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00031185150146484375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003108978271484375
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00027632713317871094
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0002856254577636719
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003311634063720703
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00022912025451660156
----------------------check_connections_block total spend ----------------------------- 0.0053403377532958984
generate_one_block  0.0015416145324707031
generate_one_block  0.0016834735870361328
generate_one_block  0.001741170883178711
generate_one_block  0.0017695426940917969
generate_one_block  0.0015413761138916016
generate_one_block  0.0013928413391113281
generate_one_block  0.0013124942779541016
generate_one_block  0.0011789798736572266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007252693176269531
gen group dst list time:  0.0001480579376220703
time for parepare:  0.0002841949462890625
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0007421970367431641
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.0010907649993896484
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.0012295246124267578
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0011134147644042969
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0007615089416503906
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0010623931884765625
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0011196136474609375
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0008044242858886719
----------------------check_connections_block total spend ----------------------------- 0.01400136947631836
generate_one_block  0.001972675323486328
generate_one_block  0.001995086669921875
generate_one_block  0.0021266937255859375
generate_one_block  0.0020568370819091797
generate_one_block  0.0016918182373046875
generate_one_block  0.0019741058349609375
generate_one_block  0.0020372867584228516
generate_one_block  0.0017666816711425781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007815361022949219
gen group dst list time:  0.0003077983856201172
time for parepare:  0.0002644062042236328
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0018763542175292969
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.0002880096435546875
r_  generation:  0.0024423599243164062
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00034737586975097656
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.002496480941772461
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.0024461746215820312
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0015599727630615234
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.00048065185546875
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0019795894622802734
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.001718759536743164
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0013992786407470703
----------------------check_connections_block total spend ----------------------------- 0.025434255599975586
generate_one_block  0.002766132354736328
generate_one_block  0.003138303756713867
generate_one_block  0.0031821727752685547
generate_one_block  0.003168821334838867
generate_one_block  0.002676248550415039
generate_one_block  0.0030705928802490234
generate_one_block  0.0030517578125
generate_one_block  0.0026803016662597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.27157020568847656  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

connection checking time:  0.044775962829589844
block generation total time  0.05151700973510742
average batch blocks generation time:  0.006439626216888428
block dataloader generation time/epoch 0.16291403770446777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.27156829833984375  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes
Using backend: pytorch

torch.Size([1677, 1433])
torch.Size([907, 128])
torch.Size([299, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.6808733940124512  GigaBytes
Max Memory Allocated: 0.769442081451416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.273012638092041  GigaBytes
Max Memory Allocated: 0.7795486450195312  GigaBytes

torch.Size([1944, 1433])
torch.Size([1212, 128])
torch.Size([495, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.798314094543457  GigaBytes
Max Memory Allocated: 0.8145523071289062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.2729811668395996  GigaBytes
Max Memory Allocated: 0.8861079216003418  GigaBytes

torch.Size([1937, 1433])
torch.Size([1263, 128])
torch.Size([520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.8215079307556152  GigaBytes
Max Memory Allocated: 0.8861079216003418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.27277421951293945  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

torch.Size([1899, 1433])
torch.Size([1220, 128])
torch.Size([489, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.8083300590515137  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.27201032638549805  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

torch.Size([1631, 1433])
torch.Size([888, 128])
torch.Size([300, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.6717925071716309  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.27277135848999023  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

torch.Size([1833, 1433])
torch.Size([1169, 128])
torch.Size([458, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.7861433029174805  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.27231693267822266  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

torch.Size([1814, 1433])
torch.Size([1135, 128])
torch.Size([495, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.7787342071533203  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.27138233184814453  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

torch.Size([1642, 1433])
torch.Size([925, 128])
torch.Size([349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.6733689308166504  GigaBytes
Max Memory Allocated: 0.9041056632995605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.057557493448257446 |0.0007089078426361084 |0.15335434675216675 |0.00011727213859558105 |0.21584638953208923 |0.011220216751098633 |
----------------------------------------------------------pseudo_mini_loss sum 2.5478036403656006
Total (block generation + training)time/epoch 3.654564380645752
Training time/epoch 3.4912917613983154
Training time without block to device /epoch 3.4856204986572266
Training time without total dataloading part /epoch 2.965764284133911
load block tensor time/epoch 0.46045994758605957
block to device time/epoch 0.005671262741088867
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27249
Number of first layer input nodes during this epoch:  14377
