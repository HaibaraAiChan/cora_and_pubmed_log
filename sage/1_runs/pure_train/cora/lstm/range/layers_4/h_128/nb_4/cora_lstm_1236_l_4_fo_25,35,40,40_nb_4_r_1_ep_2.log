main start at this time 1648431883.434135
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010585784912109375
range selection method range initialization spend 9.775161743164062e-05
time for parepare:  8.058547973632812e-05
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0026400089263916016
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.198883056640625e-05
----------------------check_connections_block total spend ----------------------------- 0.0041730403900146484
generate_one_block  0.001722574234008789
generate_one_block  0.0013630390167236328
generate_one_block  0.0014002323150634766
generate_one_block  0.0013036727905273438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005931854248046875
gen group dst list time:  5.1021575927734375e-05
time for parepare:  0.0001811981201171875
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00045990943908691406
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005846023559570312
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005502700805664062
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00042057037353515625
----------------------check_connections_block total spend ----------------------------- 0.003904581069946289
generate_one_block  0.0017828941345214844
generate_one_block  0.001905202865600586
generate_one_block  0.0018584728240966797
generate_one_block  0.0017406940460205078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006895065307617188
gen group dst list time:  0.00010275840759277344
time for parepare:  0.00022554397583007812
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0014889240264892578
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.0002682209014892578
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.0016510486602783203
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0016312599182128906
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0014371871948242188
----------------------check_connections_block total spend ----------------------------- 0.010000228881835938
generate_one_block  0.002661466598510742
generate_one_block  0.002654552459716797
generate_one_block  0.002401590347290039
generate_one_block  0.0022287368774414062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007731914520263672
gen group dst list time:  0.0001392364501953125
time for parepare:  0.00019407272338867188
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0003821849822998047
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0023221969604492188
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0023658275604248047
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00029754638671875
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0024526119232177734
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.00238037109375
----------------------check_connections_block total spend ----------------------------- 0.014529943466186523
generate_one_block  0.003675222396850586
generate_one_block  0.0034110546112060547
generate_one_block  0.0037140846252441406
generate_one_block  0.0033533573150634766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0656437873840332  GigaBytes
Max Memory Allocated: 0.0656437873840332  GigaBytes

connection checking time:  0.02843475341796875
block generation total time  0.0313873291015625
average batch blocks generation time:  0.007846832275390625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07745361328125  GigaBytes
Max Memory Allocated: 0.07745361328125  GigaBytes

torch.Size([2070, 1433])
torch.Size([1500, 128])
torch.Size([710, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9490966796875 GB
    Memory Allocated: 0.7050490379333496  GigaBytes
Max Memory Allocated: 0.7181963920593262  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0447998046875 GB
    Memory Allocated: 0.14257049560546875  GigaBytes
Max Memory Allocated: 0.7818093299865723  GigaBytes

torch.Size([2096, 1433])
torch.Size([1525, 128])
torch.Size([795, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.7799015045166016  GigaBytes
Max Memory Allocated: 0.7865419387817383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1424560546875 GB
    Memory Allocated: 0.14310073852539062  GigaBytes
Max Memory Allocated: 0.8473353385925293  GigaBytes

torch.Size([2079, 1433])
torch.Size([1585, 128])
torch.Size([752, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.8064150810241699  GigaBytes
Max Memory Allocated: 0.8473353385925293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.14267492294311523  GigaBytes
Max Memory Allocated: 0.8740448951721191  GigaBytes

torch.Size([2117, 1433])
torch.Size([1514, 128])
torch.Size([648, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.7823886871337891  GigaBytes
Max Memory Allocated: 0.8740448951721191  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05346328020095825 |0.0857764482498169 |0.3039897084236145 |0.0001678466796875 |0.25137561559677124 |0.01437687873840332 |
----------------------------------------------------------pseudo_mini_loss sum 3.14154052734375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18135
Number of first layer input nodes during this epoch:  8362
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.27344560623168945  GigaBytes
Max Memory Allocated: 0.8740448951721191  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005350112915039062
range selection method range initialization spend 6.914138793945312e-05
time for parepare:  8.130073547363281e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.794929504394531e-05
----------------------check_connections_block total spend ----------------------------- 0.0013244152069091797
generate_one_block  0.0012509822845458984
generate_one_block  0.0011744499206542969
generate_one_block  0.0011599063873291016
generate_one_block  0.0011432170867919922
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0020666122436523438
gen group dst list time:  4.6253204345703125e-05
time for parepare:  0.00016045570373535156
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00040268898010253906
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005049705505371094
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00042319297790527344
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004191398620605469
----------------------check_connections_block total spend ----------------------------- 0.003472566604614258
generate_one_block  0.0016112327575683594
generate_one_block  0.0018820762634277344
generate_one_block  0.0015916824340820312
generate_one_block  0.0015912055969238281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005881786346435547
gen group dst list time:  8.869171142578125e-05
time for parepare:  0.00019431114196777344
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0012714862823486328
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.00146484375
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0012576580047607422
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0013136863708496094
----------------------check_connections_block total spend ----------------------------- 0.008629798889160156
generate_one_block  0.0026578903198242188
generate_one_block  0.002829313278198242
generate_one_block  0.0023736953735351562
generate_one_block  0.0024259090423583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007693767547607422
gen group dst list time:  0.0001468658447265625
time for parepare:  0.0002014636993408203
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.00042819976806640625
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.0024530887603759766
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.002538442611694336
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.002371072769165039
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0023970603942871094
----------------------check_connections_block total spend ----------------------------- 0.015061140060424805
generate_one_block  0.003852367401123047
generate_one_block  0.0036454200744628906
generate_one_block  0.003462553024291992
generate_one_block  0.003525972366333008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.27344560623168945  GigaBytes
Max Memory Allocated: 0.8740448951721191  GigaBytes

connection checking time:  0.02716350555419922
block generation total time  0.031449317932128906
average batch blocks generation time:  0.007862329483032227
block dataloader generation time/epoch 0.0953209400177002
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.27372264862060547  GigaBytes
Max Memory Allocated: 0.8740448951721191  GigaBytes

torch.Size([2127, 1433])
torch.Size([1529, 128])
torch.Size([693, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.9225683212280273  GigaBytes
Max Memory Allocated: 0.9368462562561035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.2734651565551758  GigaBytes
Max Memory Allocated: 0.9963831901550293  GigaBytes

torch.Size([2145, 1433])
torch.Size([1617, 128])
torch.Size([799, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.9457201957702637  GigaBytes
Max Memory Allocated: 0.9963831901550293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.27372264862060547  GigaBytes
Max Memory Allocated: 1.0113005638122559  GigaBytes

torch.Size([2081, 1433])
torch.Size([1486, 128])
torch.Size([674, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.9056329727172852  GigaBytes
Max Memory Allocated: 1.0113005638122559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.2733650207519531  GigaBytes
Max Memory Allocated: 1.0113005638122559  GigaBytes

torch.Size([2128, 1433])
torch.Size([1504, 128])
torch.Size([716, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3065185546875 GB
    Memory Allocated: 0.9096179008483887  GigaBytes
Max Memory Allocated: 1.0113005638122559  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05434530973434448 |0.0010379552841186523 |0.1817479133605957 |0.0001373291015625 |0.27760767936706543 |0.015378713607788086 |
----------------------------------------------------------pseudo_mini_loss sum 2.8258631229400635
Total (block generation + training)time/epoch 2.2338054180145264
Training time/epoch 2.138070583343506
Training time without block to device /epoch 2.1339187622070312
Training time without total dataloading part /epoch 1.8533504009246826
load block tensor time/epoch 0.21738123893737793
block to device time/epoch 0.004151821136474609
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18228
Number of first layer input nodes during this epoch:  8481
