main start at this time 1648430409.2094269
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017635822296142578
range selection method range initialization spend 0.0001819133758544922
time for parepare:  0.0001575946807861328
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.003190279006958008
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  2.9325485229492188e-05
----------------------check_connections_block total spend ----------------------------- 0.008185625076293945
generate_one_block  0.0021550655364990234
generate_one_block  0.0017473697662353516
generate_one_block  0.0013785362243652344
generate_one_block  0.0012781620025634766
generate_one_block  0.001260519027709961
generate_one_block  0.0012722015380859375
generate_one_block  0.0010502338409423828
generate_one_block  0.0009503364562988281
generate_one_block  0.0009315013885498047
generate_one_block  0.0009806156158447266
generate_one_block  0.0009343624114990234
generate_one_block  0.00093841552734375
generate_one_block  0.000949859619140625
generate_one_block  0.0009431838989257812
generate_one_block  0.0009458065032958984
generate_one_block  0.0009284019470214844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006046295166015625
gen group dst list time:  0.00012040138244628906
time for parepare:  0.00018930435180664062
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00020003318786621094
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00013685226440429688
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00022935867309570312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00016307830810546875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014209747314453125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018334388732910156
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010251998901367188
----------------------check_connections_block total spend ----------------------------- 0.00674891471862793
generate_one_block  0.0014443397521972656
generate_one_block  0.001344919204711914
generate_one_block  0.0013496875762939453
generate_one_block  0.0013637542724609375
generate_one_block  0.0014677047729492188
generate_one_block  0.0011420249938964844
generate_one_block  0.0011718273162841797
generate_one_block  0.0011570453643798828
generate_one_block  0.00115966796875
generate_one_block  0.001070261001586914
generate_one_block  0.0010552406311035156
generate_one_block  0.0010368824005126953
generate_one_block  0.0010752677917480469
generate_one_block  0.0011088848114013672
generate_one_block  0.0011210441589355469
generate_one_block  0.0010464191436767578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006771087646484375
gen group dst list time:  0.00019979476928710938
time for parepare:  0.0002682209014892578
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005009174346923828
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00035953521728515625
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003974437713623047
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004489421844482422
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0006024837493896484
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004584789276123047
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00047969818115234375
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0003497600555419922
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.000362396240234375
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00046443939208984375
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004069805145263672
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0005869865417480469
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0005261898040771484
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00033783912658691406
----------------------check_connections_block total spend ----------------------------- 0.013085603713989258
generate_one_block  0.0016264915466308594
generate_one_block  0.0014340877532958984
generate_one_block  0.0014605522155761719
generate_one_block  0.0015420913696289062
generate_one_block  0.0016493797302246094
generate_one_block  0.0016727447509765625
generate_one_block  0.0014412403106689453
generate_one_block  0.001295328140258789
generate_one_block  0.0013110637664794922
generate_one_block  0.002214670181274414
generate_one_block  0.0013823509216308594
generate_one_block  0.0012927055358886719
generate_one_block  0.0013861656188964844
generate_one_block  0.0015594959259033203
generate_one_block  0.001538991928100586
generate_one_block  0.0012993812561035156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.019834518432617188
block generation total time  0.04322171211242676
average batch blocks generation time:  0.0027013570070266724
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06769990921020508  GigaBytes
Max Memory Allocated: 0.06769990921020508  GigaBytes

torch.Size([781, 1433])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.1922764778137207  GigaBytes
Max Memory Allocated: 0.20065975189208984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.12998390197753906  GigaBytes
Max Memory Allocated: 0.31384706497192383  GigaBytes

torch.Size([552, 1433])
torch.Size([191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5115966796875 GB
    Memory Allocated: 0.2148113250732422  GigaBytes
Max Memory Allocated: 0.31384706497192383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.13018369674682617  GigaBytes
Max Memory Allocated: 0.3367195129394531  GigaBytes

torch.Size([589, 1433])
torch.Size([198, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.22501373291015625  GigaBytes
Max Memory Allocated: 0.3367195129394531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.1307673454284668  GigaBytes
Max Memory Allocated: 0.3467864990234375  GigaBytes

torch.Size([698, 1433])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.24187374114990234  GigaBytes
Max Memory Allocated: 0.3467864990234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.13151931762695312  GigaBytes
Max Memory Allocated: 0.3629155158996582  GigaBytes

torch.Size([838, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5740966796875 GB
    Memory Allocated: 0.2811446189880371  GigaBytes
Max Memory Allocated: 0.3629155158996582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13061237335205078  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([669, 1433])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.24288415908813477  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13033056259155273  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([616, 1433])
torch.Size([245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.24925565719604492  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13060855865478516  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([492, 1433])
torch.Size([168, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.21536684036254883  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.12955808639526367  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([472, 1433])
torch.Size([178, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.21704912185668945  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13061237335205078  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([651, 1433])
torch.Size([249, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.24425029754638672  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13037109375  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([624, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.22944116592407227  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13060951232910156  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([508, 1433])
torch.Size([185, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.2135171890258789  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13054752349853516  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([657, 1433])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.24074077606201172  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13186025619506836  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

torch.Size([902, 1433])
torch.Size([312, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.2804703712463379  GigaBytes
Max Memory Allocated: 0.4003748893737793  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.13158607482910156  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

torch.Size([851, 1433])
torch.Size([264, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.2609834671020508  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.1301121711730957  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

torch.Size([576, 1433])
torch.Size([160, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6053466796875 GB
    Memory Allocated: 0.2126016616821289  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05264200270175934 |0.022257789969444275 |0.10145412385463715 |0.00011081993579864502 |0.09970815479755402 |0.014277458190917969 |
----------------------------------------------------------pseudo_mini_loss sum 3.190225124359131
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14879
Number of first layer input nodes during this epoch:  10476
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.25715017318725586  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006167888641357422
range selection method range initialization spend 9.369850158691406e-05
time for parepare:  0.00015044212341308594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.621246337890625e-05
----------------------check_connections_block total spend ----------------------------- 0.003531217575073242
generate_one_block  0.0010905265808105469
generate_one_block  0.0010268688201904297
generate_one_block  0.0010609626770019531
generate_one_block  0.002078533172607422
generate_one_block  0.001024007797241211
generate_one_block  0.0010535717010498047
generate_one_block  0.0010335445404052734
generate_one_block  0.001031637191772461
generate_one_block  0.0010256767272949219
generate_one_block  0.0010178089141845703
generate_one_block  0.0010356903076171875
generate_one_block  0.0010271072387695312
generate_one_block  0.001026153564453125
generate_one_block  0.0010156631469726562
generate_one_block  0.0009875297546386719
generate_one_block  0.0009462833404541016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006074905395507812
gen group dst list time:  9.799003601074219e-05
time for parepare:  0.0002810955047607422
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001704692840576172
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00013709068298339844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001804828643798828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001857280731201172
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00017261505126953125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001125335693359375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.440017700195312e-05
----------------------check_connections_block total spend ----------------------------- 0.006010532379150391
generate_one_block  0.0012717247009277344
generate_one_block  0.0011987686157226562
generate_one_block  0.0011873245239257812
generate_one_block  0.0011775493621826172
generate_one_block  0.0011606216430664062
generate_one_block  0.0011208057403564453
generate_one_block  0.0010857582092285156
generate_one_block  0.0011548995971679688
generate_one_block  0.0010447502136230469
generate_one_block  0.0010380744934082031
generate_one_block  0.0011715888977050781
generate_one_block  0.0011475086212158203
generate_one_block  0.0012221336364746094
generate_one_block  0.0028777122497558594
generate_one_block  0.0011920928955078125
generate_one_block  0.0010464191436767578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007729530334472656
gen group dst list time:  0.0003497600555419922
time for parepare:  0.00026917457580566406
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.03780627250671387
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004138946533203125
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0005438327789306641
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0004987716674804688
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00043201446533203125
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004382133483886719
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003097057342529297
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00030612945556640625
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005707740783691406
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0003364086151123047
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.000301361083984375
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0006017684936523438
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005619525909423828
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0004858970642089844
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0003952980041503906
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00047659873962402344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.000324249267578125
----------------------check_connections_block total spend ----------------------------- 0.05104327201843262
generate_one_block  0.001567840576171875
generate_one_block  0.0015819072723388672
generate_one_block  0.0015153884887695312
generate_one_block  0.0014622211456298828
generate_one_block  0.0014796257019042969
generate_one_block  0.0013079643249511719
generate_one_block  0.0013089179992675781
generate_one_block  0.0015769004821777344
generate_one_block  0.0013432502746582031
generate_one_block  0.0014045238494873047
generate_one_block  0.0016376972198486328
generate_one_block  0.0015833377838134766
generate_one_block  0.0015215873718261719
generate_one_block  0.0013964176177978516
generate_one_block  0.0014698505401611328
generate_one_block  0.0013256072998046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.25715017318725586  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

connection checking time:  0.05705380439758301
block generation total time  0.04358077049255371
average batch blocks generation time:  0.002723798155784607
block dataloader generation time/epoch 0.1682875156402588
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.25725841522216797  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

torch.Size([599, 1433])
torch.Size([213, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.36010026931762695  GigaBytes
Max Memory Allocated: 0.4007396697998047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.2583632469177246  GigaBytes
Max Memory Allocated: 0.4814944267272949  GigaBytes

torch.Size([805, 1433])
torch.Size([297, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.39452219009399414  GigaBytes
Max Memory Allocated: 0.4814944267272949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2582554817199707  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

torch.Size([785, 1433])
torch.Size([246, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.38046932220458984  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.25764942169189453  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

torch.Size([672, 1433])
torch.Size([221, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.365053653717041  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.25778818130493164  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

torch.Size([698, 1433])
torch.Size([218, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.3659963607788086  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2564549446105957  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

torch.Size([449, 1433])
torch.Size([158, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.32909488677978516  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2565779685974121  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

torch.Size([472, 1433])
torch.Size([144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.3289918899536133  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2582721710205078  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

torch.Size([788, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.3990941047668457  GigaBytes
Max Memory Allocated: 0.5152320861816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.25686168670654297  GigaBytes
Max Memory Allocated: 0.5188717842102051  GigaBytes

torch.Size([525, 1433])
torch.Size([167, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.3368048667907715  GigaBytes
Max Memory Allocated: 0.5188717842102051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.25650835037231445  GigaBytes
Max Memory Allocated: 0.5188717842102051  GigaBytes

torch.Size([459, 1433])
torch.Size([158, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.32671499252319336  GigaBytes
Max Memory Allocated: 0.5188717842102051  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.2584719657897949  GigaBytes
Max Memory Allocated: 0.5188717842102051  GigaBytes

torch.Size([825, 1433])
torch.Size([341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.4067535400390625  GigaBytes
Max Memory Allocated: 0.5188717842102051  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.2581815719604492  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

torch.Size([771, 1433])
torch.Size([273, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.3982276916503906  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.25832271575927734  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

torch.Size([798, 1433])
torch.Size([279, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.3778204917907715  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.2571091651916504  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

torch.Size([571, 1433])
torch.Size([183, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.3523683547973633  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.25753259658813477  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

torch.Size([650, 1433])
torch.Size([231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.37134361267089844  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.2571072578430176  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

torch.Size([521, 1433])
torch.Size([166, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.33505725860595703  GigaBytes
Max Memory Allocated: 0.5265707969665527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05188116431236267 |0.00041131675243377686 |0.07173402607440948 |0.00010685622692108154 |0.09806455671787262 |0.010714530944824219 |
----------------------------------------------------------pseudo_mini_loss sum 2.356602668762207
Total (block generation + training)time/epoch 3.797797203063965
Training time/epoch 3.629286527633667
Training time without block to device /epoch 3.6227054595947266
Training time without total dataloading part /epoch 2.729201555252075
load block tensor time/epoch 0.8300986289978027
block to device time/epoch 0.00658106803894043
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14739
Number of first layer input nodes during this epoch:  10388
