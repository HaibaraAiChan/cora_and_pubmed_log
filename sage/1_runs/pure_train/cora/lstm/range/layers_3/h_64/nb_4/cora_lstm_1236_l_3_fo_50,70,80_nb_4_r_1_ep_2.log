main start at this time 1648430493.031722
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001522064208984375
range selection method range initialization spend 0.00011110305786132812
time for parepare:  6.365776062011719e-05
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0027008056640625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.176399230957031e-05
----------------------check_connections_block total spend ----------------------------- 0.003910064697265625
generate_one_block  0.0013375282287597656
generate_one_block  0.0010662078857421875
generate_one_block  0.0010254383087158203
generate_one_block  0.0011105537414550781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004763603210449219
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.00013899803161621094
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003840923309326172
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00037479400634765625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00035500526428222656
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00045180320739746094
----------------------check_connections_block total spend ----------------------------- 0.0030579566955566406
generate_one_block  0.0014421939849853516
generate_one_block  0.0013909339904785156
generate_one_block  0.001455068588256836
generate_one_block  0.0014834403991699219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005772113800048828
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.00019168853759765625
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00027370452880859375
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0011992454528808594
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0010724067687988281
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0011363029479980469
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0013408660888671875
----------------------check_connections_block total spend ----------------------------- 0.007711172103881836
generate_one_block  0.0025093555450439453
generate_one_block  0.0023131370544433594
generate_one_block  0.0023250579833984375
generate_one_block  0.0025453567504882812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.010769128799438477
block generation total time  0.015464544296264648
average batch blocks generation time:  0.003866136074066162
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07195281982421875  GigaBytes
Max Memory Allocated: 0.07195281982421875  GigaBytes

torch.Size([1573, 1433])
torch.Size([746, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.41110801696777344  GigaBytes
Max Memory Allocated: 0.4346446990966797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.1348280906677246  GigaBytes
Max Memory Allocated: 0.5268187522888184  GigaBytes

torch.Size([1454, 1433])
torch.Size([628, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.4451413154602051  GigaBytes
Max Memory Allocated: 0.5268187522888184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.13546180725097656  GigaBytes
Max Memory Allocated: 0.5604491233825684  GigaBytes

torch.Size([1405, 1433])
torch.Size([661, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.44177961349487305  GigaBytes
Max Memory Allocated: 0.5604491233825684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.13632535934448242  GigaBytes
Max Memory Allocated: 0.5604491233825684  GigaBytes

torch.Size([1733, 1433])
torch.Size([854, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.5300726890563965  GigaBytes
Max Memory Allocated: 0.5604491233825684  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044674813747406006 |0.08623027801513672 |0.29510927200317383 |0.0001601576805114746 |0.3852478265762329 |0.00905919075012207 |
----------------------------------------------------------pseudo_mini_loss sum 2.9768736362457275
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9788
Number of first layer input nodes during this epoch:  6165
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2634148597717285  GigaBytes
Max Memory Allocated: 0.6431188583374023  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004906654357910156
range selection method range initialization spend 6.270408630371094e-05
time for parepare:  6.747245788574219e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011014938354492188Using backend: pytorch

mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.937980651855469e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.626678466796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0013191699981689453
generate_one_block  0.0012729167938232422
generate_one_block  0.0011103153228759766
generate_one_block  0.0011010169982910156
generate_one_block  0.00107574462890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004940032958984375
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.00014781951904296875
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004324913024902344
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0003733634948730469
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00045037269592285156
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0004062652587890625
----------------------check_connections_block total spend ----------------------------- 0.003309488296508789
generate_one_block  0.0016050338745117188
generate_one_block  0.0014941692352294922
generate_one_block  0.0016427040100097656
generate_one_block  0.0015435218811035156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005619525909423828
gen group dst list time:  8.344650268554688e-05
time for parepare:  0.00018262863159179688
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0013179779052734375
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0011494159698486328
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0012819766998291016
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.001306295394897461
----------------------check_connections_block total spend ----------------------------- 0.008169412612915039
generate_one_block  0.0026884078979492188
generate_one_block  0.0024073123931884766
generate_one_block  0.0026705265045166016
generate_one_block  0.002594470977783203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2634148597717285  GigaBytes
Max Memory Allocated: 0.6431188583374023  GigaBytes

connection checking time:  0.011478900909423828
block generation total time  0.016646146774291992
average batch blocks generation time:  0.004161536693572998
block dataloader generation time/epoch 0.05994296073913574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2629661560058594  GigaBytes
Max Memory Allocated: 0.6431188583374023  GigaBytes

torch.Size([1662, 1433])
torch.Size([801, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.6451435089111328  GigaBytes
Max Memory Allocated: 0.6707572937011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.26211071014404297  GigaBytes
Max Memory Allocated: 0.7587933540344238  GigaBytes

torch.Size([1503, 1433])
torch.Size([679, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.5805349349975586  GigaBytes
Max Memory Allocated: 0.7587933540344238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.2629661560058594  GigaBytes
Max Memory Allocated: 0.7587933540344238  GigaBytes

torch.Size([1572, 1433])
torch.Size([804, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.6217403411865234  GigaBytes
Max Memory Allocated: 0.7587933540344238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.2628645896911621  GigaBytes
Max Memory Allocated: 0.7587933540344238  GigaBytes

torch.Size([1643, 1433])
torch.Size([816, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9979248046875 GB
    Memory Allocated: 0.629091739654541  GigaBytes
Max Memory Allocated: 0.7587933540344238  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04687899351119995 |0.0006158351898193359 |0.17976456880569458 |0.00012236833572387695 |0.379033625125885 |0.009874582290649414 |
----------------------------------------------------------pseudo_mini_loss sum 2.536632537841797
Total (block generation + training)time/epoch 2.5578672885894775
Training time/epoch 2.497591495513916
Training time without block to device /epoch 2.4951281547546387
Training time without total dataloading part /epoch 2.2455568313598633
load block tensor time/epoch 0.1875159740447998
block to device time/epoch 0.0024633407592773438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10215
Number of first layer input nodes during this epoch:  6380
