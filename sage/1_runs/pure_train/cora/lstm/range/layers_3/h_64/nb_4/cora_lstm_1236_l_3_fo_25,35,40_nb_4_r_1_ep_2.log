main start at this time 1648430331.7699723
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011067390441894531
range selection method range initialization spend 0.0001220703125
time for parepare:  7.796287536621094e-05
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.002917766571044922
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.511543273925781e-05
----------------------check_connections_block total spend ----------------------------- 0.0043909549713134766
generate_one_block  0.0018169879913330078
generate_one_block  0.0014345645904541016
generate_one_block  0.0014042854309082031
generate_one_block  0.0014302730560302734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005810260772705078
gen group dst list time:  0.00010156631469726562
time for parepare:  0.00018167495727539062
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004911422729492188
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00048470497131347656
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004210472106933594
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005495548248291016
----------------------check_connections_block total spend ----------------------------- 0.0037620067596435547
generate_one_block  0.0018854141235351562
generate_one_block  0.001856088638305664
generate_one_block  0.0018129348754882812
generate_one_block  0.0019598007202148438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006740093231201172
gen group dst list time:  0.00010275840759277344
time for parepare:  0.00022721290588378906
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0014333724975585938
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.0013933181762695312
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0012276172637939453
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0016841888427734375
----------------------check_connections_block total spend ----------------------------- 0.00931549072265625
generate_one_block  0.0029876232147216797
generate_one_block  0.0027625560760498047
generate_one_block  0.002131223678588867
generate_one_block  0.0024421215057373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.013077497482299805
block generation total time  0.0178377628326416
average batch blocks generation time:  0.0044594407081604
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07136154174804688  GigaBytes
Max Memory Allocated: 0.07136154174804688  GigaBytes

torch.Size([1463, 1433])
torch.Size([692, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.37443065643310547  GigaBytes
Max Memory Allocated: 0.3958311080932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.13440895080566406  GigaBytes
Max Memory Allocated: 0.4894881248474121  GigaBytes

torch.Size([1376, 1433])
torch.Size([616, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.42370176315307617  GigaBytes
Max Memory Allocated: 0.4894881248474121  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.13375377655029297  GigaBytes
Max Memory Allocated: 0.5378727912902832  GigaBytes

torch.Size([1254, 1433])
torch.Size([584, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.39252471923828125  GigaBytes
Max Memory Allocated: 0.5378727912902832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.13590097427368164  GigaBytes
Max Memory Allocated: 0.5378727912902832  GigaBytes

torch.Size([1654, 1433])
torch.Size([796, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.4922952651977539  GigaBytes
Max Memory Allocated: 0.5378727912902832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046484291553497314 |0.08596163988113403 |0.2320420742034912 |0.0001544952392578125 |0.1660824418067932 |0.011755943298339844 |
----------------------------------------------------------pseudo_mini_loss sum 2.9625039100646973
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9169
Number of first layer input nodes during this epoch:  5747
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9373779296875 GB
    Memory Allocated: 0.2629876136779785  GigaBytes
Max Memory Allocated: 0.6045651435852051  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048804283142089844
range selection method range initialization spend 6.437301635742188e-05
time for parepare:  7.033348083496094e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011682510375976562Using backend: pytorch

mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.319450378417969e-05
----------------------check_connections_block total spend ----------------------------- 0.0014171600341796875
generate_one_block  0.0011982917785644531
generate_one_block  0.0011200904846191406
generate_one_block  0.0011665821075439453
generate_one_block  0.0010960102081298828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004973411560058594
gen group dst list time:  4.315376281738281e-05
time for parepare:  0.00015020370483398438
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00044155120849609375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.00038433074951171875
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004761219024658203
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004029273986816406
----------------------check_connections_block total spend ----------------------------- 0.00336456298828125
generate_one_block  0.001605987548828125
generate_one_block  0.0015459060668945312
generate_one_block  0.001580953598022461
generate_one_block  0.0015537738800048828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005750656127929688
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00018715858459472656
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0013623237609863281
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0011355876922607422
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0012941360473632812
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0012755393981933594
----------------------check_connections_block total spend ----------------------------- 0.008227109909057617
generate_one_block  0.003932952880859375
generate_one_block  0.0024030208587646484
generate_one_block  0.002485990524291992
generate_one_block  0.0023467540740966797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9373779296875 GB
    Memory Allocated: 0.2629876136779785  GigaBytes
Max Memory Allocated: 0.6045651435852051  GigaBytes

connection checking time:  0.011591672897338867
block generation total time  0.017455339431762695
average batch blocks generation time:  0.004363834857940674
block dataloader generation time/epoch 0.05288076400756836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9373779296875 GB
    Memory Allocated: 0.2626476287841797  GigaBytes
Max Memory Allocated: 0.6045651435852051  GigaBytes

torch.Size([1603, 1433])
torch.Size([760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.6144876480102539  GigaBytes
Max Memory Allocated: 0.6380553245544434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.2615518569946289  GigaBytes
Max Memory Allocated: 0.7272534370422363  GigaBytes

torch.Size([1399, 1433])
torch.Size([610, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.5401644706726074  GigaBytes
Max Memory Allocated: 0.7272534370422363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.2626466751098633  GigaBytes
Max Memory Allocated: 0.7272534370422363  GigaBytes

torch.Size([1487, 1433])
torch.Size([738, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.5843958854675293  GigaBytes
Max Memory Allocated: 0.7272534370422363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.2623777389526367  GigaBytes
Max Memory Allocated: 0.7272534370422363  GigaBytes

torch.Size([1553, 1433])
torch.Size([727, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9725341796875 GB
    Memory Allocated: 0.5789604187011719  GigaBytes
Max Memory Allocated: 0.7272534370422363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046441853046417236 |0.00042492151260375977 |0.11046284437179565 |0.00011777877807617188 |0.15993332862854004 |0.010316848754882812 |
----------------------------------------------------------pseudo_mini_loss sum 2.5192456245422363
Total (block generation + training)time/epoch 1.3913941383361816
Training time/epoch 1.3381891250610352
Training time without block to device /epoch 1.3364894390106201
Training time without total dataloading part /epoch 1.0923726558685303
load block tensor time/epoch 0.18576741218566895
block to device time/epoch 0.001699686050415039
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9612
Number of first layer input nodes during this epoch:  6042
