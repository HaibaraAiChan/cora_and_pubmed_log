main start at this time 1648430480.8885849
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009801387786865234
range selection method range initialization spend 8.487701416015625e-05
time for parepare:  6.389617919921875e-05
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0014560222625732422
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00013065338134765625
----------------------check_connections_block total spend ----------------------------- 0.002346038818359375
generate_one_block  0.001581430435180664
generate_one_block  0.0012259483337402344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005321502685546875
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.00015401840209960938
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0007114410400390625
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0007545948028564453
----------------------check_connections_block total spend ----------------------------- 0.0026595592498779297
generate_one_block  0.0019192695617675781
generate_one_block  0.0020301342010498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005941390991210938
gen group dst list time:  5.984306335449219e-05
time for parepare:  0.00019073486328125
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.001821756362915039
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0020186901092529297
----------------------check_connections_block total spend ----------------------------- 0.006065845489501953
generate_one_block  0.0031731128692626953
generate_one_block  0.0033147335052490234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.008725404739379883
block generation total time  0.010437250137329102
average batch blocks generation time:  0.005218625068664551
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07375526428222656  GigaBytes
Max Memory Allocated: 0.07375526428222656  GigaBytes

torch.Size([1907, 1433])
torch.Size([1105, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5569033622741699  GigaBytes
Max Memory Allocated: 0.5882968902587891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.13756752014160156  GigaBytes
Max Memory Allocated: 0.6660385131835938  GigaBytes

torch.Size([1962, 1433])
torch.Size([1216, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9549560546875 GB
    Memory Allocated: 0.6611824035644531  GigaBytes
Max Memory Allocated: 0.6949634552001953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03414285182952881 |0.1715221405029297 |0.4488757848739624 |0.00019073486328125 |0.4344550371170044 |0.009123802185058594 |
----------------------------------------------------------pseudo_mini_loss sum 2.771728992462158
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6887
Number of first layer input nodes during this epoch:  3869
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.26468658447265625  GigaBytes
Max Memory Allocated: 0.7673168182373047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005898475646972656
range selection method range initialization spend 7.867813110351562e-05
time for parepare:  9.107589721679688e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00014853477478027344
----------------------check_connections_block total spend ----------------------------- 0.001079559326171875
generate_one_block  0.0015532970428466797
generate_one_block  0.0014827251434326172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005993843078613281
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.00020051002502441406
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0008707046508789062
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0009138584136962891
----------------------check_connections_block total spend ----------------------------- 0.0032663345336914062
generate_one_block  0.0024182796478271484
generate_one_block  0.002409696578979492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006921291351318359
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00023174285888671875
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.002340555191040039
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.002385377883911133
----------------------check_connections_block total spend ----------------------------- 0.008727788925170898
generate_one_block  0.004329204559326172
generate_one_block  0.003440380096435547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.26468658447265625  GigaBytes
Max Memory Allocated: 0.7673168182373047  GigaBytes

connection checking time:  0.011994123458862305
block generation total time  0.01259756088256836
average batch blocks generation time:  0.00629878044128418
block dataloader generation time/epoch 0.1386852264404297
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.2644796371459961  GigaBytes
Max Memory Allocated: 0.7673168182373047  GigaBytes
Using backend: pytorch

torch.Size([1942, 1433])
torch.Size([1144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.7692689895629883  GigaBytes
Max Memory Allocated: 0.8023629188537598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.26448583602905273  GigaBytes
Max Memory Allocated: 0.876276969909668  GigaBytes

torch.Size([1943, 1433])
torch.Size([1175, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.7678532600402832  GigaBytes
Max Memory Allocated: 0.876276969909668  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034952402114868164 |0.0007619857788085938 |0.20838749408721924 |0.00013196468353271484 |0.42436397075653076 |0.0049991607666015625 |
----------------------------------------------------------pseudo_mini_loss sum 2.359833240509033
Total (block generation + training)time/epoch 1.5374245643615723
Training time/epoch 1.39841890335083
Training time without block to device /epoch 1.396894931793213
Training time without total dataloading part /epoch 1.270766019821167
load block tensor time/epoch 0.06990480422973633
block to device time/epoch 0.0015239715576171875
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6900
Number of first layer input nodes during this epoch:  3885
