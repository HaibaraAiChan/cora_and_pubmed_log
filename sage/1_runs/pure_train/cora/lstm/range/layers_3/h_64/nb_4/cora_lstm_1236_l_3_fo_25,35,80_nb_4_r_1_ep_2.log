main start at this time 1648430383.4110126
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006330013275146484
range selection method range initialization spend 9.584426879882812e-05
time for parepare:  6.222724914550781e-05
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0018122196197509766
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.009506225585938e-05
----------------------check_connections_block total spend ----------------------------- 0.003003358840942383
generate_one_block  0.0012772083282470703
generate_one_block  0.0010845661163330078
generate_one_block  0.001055002212524414
generate_one_block  0.0010731220245361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004971027374267578
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00014543533325195312
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0003833770751953125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00038504600524902344
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.000335693359375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00043964385986328125
----------------------check_connections_block total spend ----------------------------- 0.003023862838745117
generate_one_block  0.0014538764953613281
generate_one_block  0.0014328956604003906
generate_one_block  0.0013890266418457031
generate_one_block  0.0015125274658203125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005767345428466797
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0001761913299560547
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0002696514129638672
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0011303424835205078
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0010743141174316406
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0009570121765136719
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0012998580932617188
----------------------check_connections_block total spend ----------------------------- 0.0073397159576416016
generate_one_block  0.0023827552795410156
generate_one_block  0.002227783203125
generate_one_block  0.0022602081298828125
generate_one_block  0.0024590492248535156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06351375579833984  GigaBytes
Max Memory Allocated: 0.06351375579833984  GigaBytes

connection checking time:  0.010363578796386719
block generation total time  0.015118122100830078
average batch blocks generation time:  0.0037795305252075195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07146835327148438  GigaBytes
Max Memory Allocated: 0.07146835327148438  GigaBytes

torch.Size([1483, 1433])
torch.Size([699, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.37655115127563477  GigaBytes
Max Memory Allocated: 0.3980216979980469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.1345052719116211  GigaBytes
Max Memory Allocated: 0.4915652275085449  GigaBytes

torch.Size([1394, 1433])
torch.Size([617, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.4252181053161621  GigaBytes
Max Memory Allocated: 0.4915652275085449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.13382863998413086  GigaBytes
Max Memory Allocated: 0.5393819808959961  GigaBytes

torch.Size([1268, 1433])
torch.Size([578, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.3885679244995117  GigaBytes
Max Memory Allocated: 0.5393819808959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7908935546875 GB
    Memory Allocated: 0.13586759567260742  GigaBytes
Max Memory Allocated: 0.5393819808959961  GigaBytes

torch.Size([1648, 1433])
torch.Size([795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.4908008575439453  GigaBytes
Max Memory Allocated: 0.5393819808959961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04604882001876831 |0.08545303344726562 |0.23416078090667725 |0.00014454126358032227 |0.16781342029571533 |0.010847330093383789 |
----------------------------------------------------------pseudo_mini_loss sum 2.9628920555114746
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9216
Number of first layer input nodes during this epoch:  5793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.2629532814025879  GigaBytes
Max Memory Allocated: 0.6030759811401367  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004899501800537109
range selection method range initialization spend 6.198883056640625e-05
time for parepare:  7.224082946777344e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011038780212402344Using backend: pytorch

mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.0013327598571777344
generate_one_block  0.0012044906616210938
generate_one_block  0.0011081695556640625
generate_one_block  0.0011267662048339844
generate_one_block  0.0010695457458496094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005016326904296875
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00043582916259765625
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00036144256591796875
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004458427429199219
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00039267539978027344
----------------------check_connections_block total spend ----------------------------- 0.00324249267578125
generate_one_block  0.00159454345703125
generate_one_block  0.0014579296112060547
generate_one_block  0.0015478134155273438
generate_one_block  0.0014843940734863281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005602836608886719
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0001800060272216797
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0013153553009033203
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0010745525360107422
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0012137889862060547
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0011959075927734375
----------------------check_connections_block total spend ----------------------------- 0.007924079895019531
generate_one_block  0.0026400089263916016
generate_one_block  0.0023050308227539062
generate_one_block  0.0025529861450195312
generate_one_block  0.002332925796508789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.2629532814025879  GigaBytes
Max Memory Allocated: 0.6030759811401367  GigaBytes

connection checking time:  0.011166572570800781
block generation total time  0.015915632247924805
average batch blocks generation time:  0.003978908061981201
block dataloader generation time/epoch 0.05097556114196777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.2625565528869629  GigaBytes
Max Memory Allocated: 0.6030759811401367  GigaBytes

torch.Size([1586, 1433])
torch.Size([757, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9393310546875 GB
    Memory Allocated: 0.6111726760864258  GigaBytes
Max Memory Allocated: 0.634523868560791  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.26143312454223633  GigaBytes
Max Memory Allocated: 0.7239561080932617  GigaBytes

torch.Size([1377, 1433])
torch.Size([599, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.5365676879882812  GigaBytes
Max Memory Allocated: 0.7239561080932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.2625555992126465  GigaBytes
Max Memory Allocated: 0.7239561080932617  GigaBytes

torch.Size([1481, 1433])
torch.Size([736, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.583488941192627  GigaBytes
Max Memory Allocated: 0.7239561080932617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.2622227668762207  GigaBytes
Max Memory Allocated: 0.7239561080932617  GigaBytes

torch.Size([1524, 1433])
torch.Size([721, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.578803539276123  GigaBytes
Max Memory Allocated: 0.7239561080932617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046581804752349854 |0.00041806697845458984 |0.11209017038345337 |0.0001163482666015625 |0.16726642847061157 |0.010798454284667969 |
----------------------------------------------------------pseudo_mini_loss sum 2.4975881576538086
Total (block generation + training)time/epoch 1.425764799118042
Training time/epoch 1.374448537826538
Training time without block to device /epoch 1.3727762699127197
Training time without total dataloading part /epoch 1.128690242767334
load block tensor time/epoch 0.18632721900939941
block to device time/epoch 0.0016722679138183594
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9516
Number of first layer input nodes during this epoch:  5968
