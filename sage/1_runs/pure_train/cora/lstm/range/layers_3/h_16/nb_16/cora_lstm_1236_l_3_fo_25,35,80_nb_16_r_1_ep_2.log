main start at this time 1648429961.9609427
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012447834014892578
range selection method range initialization spend 8.487701416015625e-05
time for parepare:  6.4849853515625e-05
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.002505064010620117
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.005724191665649414
generate_one_block  0.0014102458953857422
generate_one_block  0.001127481460571289
generate_one_block  0.001064300537109375
generate_one_block  0.0010569095611572266
generate_one_block  0.0010421276092529297
generate_one_block  0.0010528564453125
generate_one_block  0.0010540485382080078
generate_one_block  0.0010428428649902344
generate_one_block  0.0010445117950439453
generate_one_block  0.0011181831359863281
generate_one_block  0.0010466575622558594
generate_one_block  0.0010421276092529297
generate_one_block  0.0010097026824951172
generate_one_block  0.0009694099426269531
generate_one_block  0.0009667873382568359
generate_one_block  0.0009467601776123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006115436553955078
gen group dst list time:  9.250640869140625e-05
time for parepare:  0.0001437664031982422
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.726119995117188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00011539459228515625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001552104949951172
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.7206878662109375e-05
----------------------check_connections_block total spend ----------------------------- 0.005758762359619141
generate_one_block  0.0011975765228271484
generate_one_block  0.0012187957763671875
generate_one_block  0.001146078109741211
generate_one_block  0.0011947154998779297
generate_one_block  0.0011289119720458984
generate_one_block  0.0011677742004394531
generate_one_block  0.0012700557708740234
generate_one_block  0.0012354850769042969
generate_one_block  0.0016663074493408203
generate_one_block  0.0011708736419677734
generate_one_block  0.0011069774627685547
generate_one_block  0.0010340213775634766
generate_one_block  0.0010640621185302734
generate_one_block  0.0013127326965332031
generate_one_block  0.0011374950408935547
generate_one_block  0.0010116100311279297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007193088531494141
gen group dst list time:  0.0001583099365234375
time for parepare:  0.0002167224884033203
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00046253204345703125
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005052089691162109
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00031280517578125
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00046896934509277344
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0002930164337158203
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00039505958557128906
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0006718635559082031
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00046062469482421875
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0005788803100585938
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006239414215087891
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.000331878662109375
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002853870391845703
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00045013427734375
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0006186962127685547
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00014209747314453125
----------------------check_connections_block total spend ----------------------------- 0.01296544075012207
generate_one_block  0.0015761852264404297
generate_one_block  0.0016422271728515625
generate_one_block  0.0013844966888427734
generate_one_block  0.0015444755554199219
generate_one_block  0.0012507438659667969
generate_one_block  0.0016179084777832031
generate_one_block  0.0016949176788330078
generate_one_block  0.0014281272888183594
generate_one_block  0.0015673637390136719
generate_one_block  0.0016052722930908203
generate_one_block  0.0012845993041992188
generate_one_block  0.0012600421905517578
generate_one_block  0.0013306140899658203
generate_one_block  0.0014128684997558594
generate_one_block  0.0016775131225585938
generate_one_block  0.0010840892791748047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.01872420310974121
block generation total time  0.042424917221069336
average batch blocks generation time:  0.0026515573263168335
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06645917892456055  GigaBytes
Max Memory Allocated: 0.06645917892456055  GigaBytes

torch.Size([694, 1433])
torch.Size([232, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.17622137069702148  GigaBytes
Max Memory Allocated: 0.18499994277954102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.12965726852416992  GigaBytes
Max Memory Allocated: 0.2987184524536133  GigaBytes

torch.Size([780, 1433])
torch.Size([266, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.2549710273742676  GigaBytes
Max Memory Allocated: 0.2987184524536133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12786865234375  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

torch.Size([446, 1433])
torch.Size([139, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20168685913085938  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1292719841003418  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

torch.Size([708, 1433])
torch.Size([248, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2427840232849121  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12786865234375  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

torch.Size([409, 1433])
torch.Size([135, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19338035583496094  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12848520278930664  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

torch.Size([561, 1433])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.22257041931152344  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13081073760986328  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

torch.Size([995, 1433])
torch.Size([367, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6092529296875 GB
    Memory Allocated: 0.3031010627746582  GigaBytes
Max Memory Allocated: 0.37623023986816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.12890863418579102  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([640, 1433])
torch.Size([230, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.24035978317260742  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.13024091720581055  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([889, 1433])
torch.Size([319, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.27146387100219727  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.1300034523010254  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([844, 1433])
torch.Size([316, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.28807783126831055  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.12800931930541992  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([472, 1433])
torch.Size([156, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.2058124542236328  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.12792730331420898  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([457, 1433])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.1944880485534668  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.12822341918945312  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([512, 1433])
torch.Size([175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.21783018112182617  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.12892580032348633  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([643, 1433])
torch.Size([239, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.23956727981567383  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.13044023513793945  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([926, 1433])
torch.Size([324, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.287900447845459  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.12669992446899414  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([228, 1433])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6444091796875 GB
    Memory Allocated: 0.15535783767700195  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05235818028450012 |0.0217534601688385 |0.10087965428829193 |0.00011216104030609131 |0.09361517429351807 |0.01425027847290039 |
----------------------------------------------------------pseudo_mini_loss sum 2.813504457473755
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14544
Number of first layer input nodes during this epoch:  10204
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7069091796875 GB
    Memory Allocated: 0.2521815299987793  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005919933319091797
range selection method range initialization spend 8.678436279296875e-05
time for parepare:  9.560585021972656e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.003635883331298828
generate_one_block  0.0013043880462646484
generate_one_block  0.0011944770812988281
generate_one_block  0.0011799335479736328
generate_one_block  0.001596212387084961
generate_one_block  0.0012023448944091797
generate_one_block  0.0011878013610839844
generate_one_block  0.0011930465698242188
generate_one_block  0.0010170936584472656
generate_one_block  0.001010894775390625
generate_one_block  0.0010082721710205078
generate_one_block  0.0010368824005126953
generate_one_block  0.0010077953338623047
generate_one_block  0.0010254383087158203
generate_one_block  0.0010344982147216797
generate_one_block  0.0010104179382324219
generate_one_block  0.0009946823120117188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006263256072998047
gen group dst list time:  0.0001270771026611328
time for parepare:  0.0002009868621826172
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00023102760314941406
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00014519691467285156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001468658447265625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00014734268188476562
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00028133392333984375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.440017700195312e-05
----------------------check_connections_block total spend ----------------------------- 0.006767749786376953
generate_one_block  0.0015914440155029297
generate_one_block  0.0013747215270996094
generate_one_block  0.0013098716735839844
generate_one_block  0.001462697982788086
generate_one_block  0.0013222694396972656
generate_one_block  0.0010786056518554688
generate_one_block  0.0011749267578125
generate_one_block  0.0011470317840576172
generate_one_block  0.0011017322540283203
generate_one_block  0.001142740249633789
generate_one_block  0.0011081695556640625
generate_one_block  0.001102447509765625
generate_one_block  0.0012488365173339844
generate_one_block  0.0011479854583740234
generate_one_block  0.001070261001586914
generate_one_block  0.0010311603546142578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000732421875
gen group dst list time:  0.0002193450927734375
time for parepare:  0.00028228759765625
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00037980079650878906
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.000675201416015625
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.000507354736328125
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007162094116210938
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006136894226074219
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00035381317138671875
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005540847778320312
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005807876586914062
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005242824554443359
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005228519439697266
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00038814544677734375
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.000579833984375
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0009033679962158203
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004374980926513672
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004050731658935547
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0002930164337158203
----------------------check_connections_block total spend ----------------------------- 0.01610112190246582
generate_one_block  0.001766204833984375
generate_one_block  0.0015261173248291016
generate_one_block  0.0013034343719482422
generate_one_block  0.0016584396362304688
generate_one_block  0.0015778541564941406
generate_one_block  0.0013117790222167969
generate_one_block  0.001493215560913086
generate_one_block  0.0014922618865966797
generate_one_block  0.0014605522155761719
generate_one_block  0.0015864372253417969
generate_one_block  0.001338958740234375
generate_one_block  0.001522064208984375
generate_one_block  0.001844644546508789
generate_one_block  0.0014553070068359375
generate_one_block  0.0013911724090576172
generate_one_block  0.0013737678527832031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7069091796875 GB
    Memory Allocated: 0.2521815299987793  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

connection checking time:  0.022868871688842773
block generation total time  0.043517112731933594
average batch blocks generation time:  0.0027198195457458496
block dataloader generation time/epoch 0.13252711296081543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7069091796875 GB
    Memory Allocated: 0.2552657127380371  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

torch.Size([805, 1433])
torch.Size([296, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.4005279541015625  GigaBytes
Max Memory Allocated: 0.42350149154663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25411415100097656  GigaBytes
Max Memory Allocated: 0.5214786529541016  GigaBytes

torch.Size([590, 1433])
torch.Size([222, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.3564887046813965  GigaBytes
Max Memory Allocated: 0.5214786529541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2535977363586426  GigaBytes
Max Memory Allocated: 0.5214786529541016  GigaBytes

torch.Size([494, 1433])
torch.Size([144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.3196535110473633  GigaBytes
Max Memory Allocated: 0.5214786529541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2552986145019531  GigaBytes
Max Memory Allocated: 0.5214786529541016  GigaBytes

torch.Size([811, 1433])
torch.Size([320, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.40807056427001953  GigaBytes
Max Memory Allocated: 0.5214786529541016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25490617752075195  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([738, 1433])
torch.Size([256, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.37941503524780273  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.2535977363586426  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([494, 1433])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.3233013153076172  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.2549104690551758  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([739, 1433])
torch.Size([224, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.36791133880615234  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.25449514389038086  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([661, 1433])
torch.Size([240, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.37427330017089844  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.2545943260192871  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([680, 1433])
torch.Size([240, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.3596210479736328  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.25445556640625  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([654, 1433])
torch.Size([238, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.36104583740234375  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.2545914649963379  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([507, 1433])
torch.Size([166, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.33156681060791016  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.2546658515930176  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([693, 1433])
torch.Size([248, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.3766794204711914  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.25650548934936523  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

torch.Size([1036, 1433])
torch.Size([395, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.45107364654541016  GigaBytes
Max Memory Allocated: 0.5295090675354004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.25463199615478516  GigaBytes
Max Memory Allocated: 0.5710091590881348  GigaBytes

torch.Size([687, 1433])
torch.Size([239, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.36093759536743164  GigaBytes
Max Memory Allocated: 0.5710091590881348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.2539658546447754  GigaBytes
Max Memory Allocated: 0.5710091590881348  GigaBytes

torch.Size([524, 1433])
torch.Size([168, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.3414602279663086  GigaBytes
Max Memory Allocated: 0.5710091590881348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.25365114212036133  GigaBytes
Max Memory Allocated: 0.5710091590881348  GigaBytes

torch.Size([504, 1433])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.32227230072021484  GigaBytes
Max Memory Allocated: 0.5710091590881348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05224010348320007 |0.00040772557258605957 |0.07269151508808136 |0.00010645389556884766 |0.09987396001815796 |0.010294437408447266 |
----------------------------------------------------------pseudo_mini_loss sum 2.242497444152832
Total (block generation + training)time/epoch 3.813955068588257
Training time/epoch 3.681102991104126
Training time without block to device /epoch 3.674579381942749
Training time without total dataloading part /epoch 2.773045301437378
load block tensor time/epoch 0.8358416557312012
block to device time/epoch 0.006523609161376953
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15077
Number of first layer input nodes during this epoch:  10617
