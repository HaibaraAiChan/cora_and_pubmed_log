main start at this time 1648429989.467482
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009889602661132812
range selection method range initialization spend 9.417533874511719e-05
time for parepare:  7.748603820800781e-05
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0014858245849609375
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.534027099609375e-05
----------------------check_connections_block total spend ----------------------------- 0.002917766571044922
generate_one_block  0.0015041828155517578
generate_one_block  0.0013284683227539062
generate_one_block  0.001321554183959961
generate_one_block  0.0013113021850585938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005853176116943359
gen group dst list time:  9.799003601074219e-05
time for parepare:  0.00018095970153808594
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0005056858062744141
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.00054931640625
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005905628204345703
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005242824554443359
----------------------check_connections_block total spend ----------------------------- 0.004041910171508789
generate_one_block  0.0018439292907714844
generate_one_block  0.0018661022186279297
generate_one_block  0.0019028186798095703
generate_one_block  0.0018281936645507812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006687641143798828
gen group dst list time:  0.000110626220703125
time for parepare:  0.0002257823944091797
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0016715526580810547
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.001653432846069336
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0017743110656738281
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0015454292297363281
----------------------check_connections_block total spend ----------------------------- 0.010568380355834961
generate_one_block  0.003414630889892578
generate_one_block  0.0025255680084228516
generate_one_block  0.002573728561401367
generate_one_block  0.002270936965942383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.01461029052734375
block generation total time  0.018225908279418945
average batch blocks generation time:  0.004556477069854736
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07132339477539062  GigaBytes
Max Memory Allocated: 0.07132339477539062  GigaBytes

torch.Size([1600, 1433])
torch.Size([799, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6405029296875 GB
    Memory Allocated: 0.4167637825012207  GigaBytes
Max Memory Allocated: 0.444765567779541  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.13417387008666992  GigaBytes
Max Memory Allocated: 0.5335025787353516  GigaBytes

torch.Size([1621, 1433])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7655029296875 GB
    Memory Allocated: 0.47225141525268555  GigaBytes
Max Memory Allocated: 0.5335025787353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.1344285011291504  GigaBytes
Max Memory Allocated: 0.5887689590454102  GigaBytes

torch.Size([1668, 1433])
torch.Size([841, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.5037007331848145  GigaBytes
Max Memory Allocated: 0.5887689590454102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.13361597061157227  GigaBytes
Max Memory Allocated: 0.6198740005493164  GigaBytes

torch.Size([1517, 1433])
torch.Size([723, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.4460315704345703  GigaBytes
Max Memory Allocated: 0.6198740005493164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047705113887786865 |0.08536726236343384 |0.24813109636306763 |0.00013458728790283203 |0.19485807418823242 |0.010274171829223633 |
----------------------------------------------------------pseudo_mini_loss sum 2.9452123641967773
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10318
Number of first layer input nodes during this epoch:  6406
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25914716720581055  GigaBytes
Max Memory Allocated: 0.6198740005493164  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005085468292236328
range selection method range initialization spend 6.341934204101562e-05
time for parepare:  6.937980651855469e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.867813110351562e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011658668518066406Using backend: pytorch

mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.723403930664062e-05
----------------------check_connections_block total spend ----------------------------- 0.0013849735260009766
generate_one_block  0.001255035400390625
generate_one_block  0.0011222362518310547
generate_one_block  0.0011148452758789062
generate_one_block  0.0011146068572998047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005173683166503906
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.00015664100646972656
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00045371055603027344
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004229545593261719
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004916191101074219
----------------------check_connections_block total spend ----------------------------- 0.003522157669067383
generate_one_block  0.0017704963684082031
generate_one_block  0.0015857219696044922
generate_one_block  0.0015904903411865234
generate_one_block  0.002724170684814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005741119384765625
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.00019240379333496094
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0012421607971191406
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.0013339519500732422
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0013697147369384766
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0013763904571533203
----------------------check_connections_block total spend ----------------------------- 0.008660554885864258
generate_one_block  0.002633810043334961
generate_one_block  0.002700328826904297
generate_one_block  0.002656221389770508
generate_one_block  0.0025205612182617188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25914716720581055  GigaBytes
Max Memory Allocated: 0.6198740005493164  GigaBytes

connection checking time:  0.01218271255493164
block generation total time  0.018181800842285156
average batch blocks generation time:  0.004545450210571289
block dataloader generation time/epoch 0.057442426681518555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25989484786987305  GigaBytes
Max Memory Allocated: 0.6198740005493164  GigaBytes

torch.Size([1489, 1433])
torch.Size([735, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5762324333190918  GigaBytes
Max Memory Allocated: 0.6198740005493164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25979089736938477  GigaBytes
Max Memory Allocated: 0.6934857368469238  GigaBytes

torch.Size([1648, 1433])
torch.Size([777, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6047258377075195  GigaBytes
Max Memory Allocated: 0.6934857368469238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.25989770889282227  GigaBytes
Max Memory Allocated: 0.7213268280029297  GigaBytes

torch.Size([1621, 1433])
torch.Size([816, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.6058945655822754  GigaBytes
Max Memory Allocated: 0.7213268280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2595376968383789  GigaBytes
Max Memory Allocated: 0.7227420806884766  GigaBytes

torch.Size([1600, 1433])
torch.Size([814, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.616124153137207  GigaBytes
Max Memory Allocated: 0.7227420806884766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04721570014953613 |0.0004596710205078125 |0.130598783493042 |0.0001189112663269043 |0.1913762092590332 |0.010530233383178711 |
----------------------------------------------------------pseudo_mini_loss sum 2.101628303527832
Total (block generation + training)time/epoch 1.6140601634979248
Training time/epoch 1.5563218593597412
Training time without block to device /epoch 1.55448317527771
Training time without total dataloading part /epoch 1.298905849456787
load block tensor time/epoch 0.18886280059814453
block to device time/epoch 0.00183868408203125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10241
Number of first layer input nodes during this epoch:  6358
