main start at this time 1648429936.448619
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017626285552978516
range selection method range initialization spend 0.0001499652862548828
time for parepare:  0.00014066696166992188
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0003383159637451172
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0023124217987060547
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00010919570922851562
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  9.274482727050781e-05
----------------------check_connections_block total spend ----------------------------- 0.004209995269775391
generate_one_block  0.001795053482055664
generate_one_block  0.0015904903411865234
generate_one_block  0.0016012191772460938
generate_one_block  0.0015730857849121094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006489753723144531
gen group dst list time:  9.679794311523438e-05
time for parepare:  0.00018072128295898438
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00048828125
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004999637603759766
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005562305450439453
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004756450653076172
----------------------check_connections_block total spend ----------------------------- 0.0038313865661621094
generate_one_block  0.0018129348754882812
generate_one_block  0.0018050670623779297
generate_one_block  0.0018863677978515625
generate_one_block  0.0017971992492675781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006685256958007812
gen group dst list time:  9.942054748535156e-05
time for parepare:  0.00023746490478515625
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0014960765838623047
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.001505136489868164
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0016567707061767578
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0014109611511230469
----------------------check_connections_block total spend ----------------------------- 0.009814023971557617
generate_one_block  0.0035583972930908203
generate_one_block  0.0025513172149658203
generate_one_block  0.0025000572204589844
generate_one_block  0.002156496047973633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.013645410537719727
block generation total time  0.01806783676147461
average batch blocks generation time:  0.004516959190368652
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07074832916259766  GigaBytes
Max Memory Allocated: 0.07074832916259766  GigaBytes

torch.Size([1493, 1433])
torch.Size([709, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.3903965950012207  GigaBytes
Max Memory Allocated: 0.41596269607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.1336202621459961  GigaBytes
Max Memory Allocated: 0.5079264640808105  GigaBytes

torch.Size([1518, 1433])
torch.Size([714, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7420654296875 GB
    Memory Allocated: 0.43983983993530273  GigaBytes
Max Memory Allocated: 0.5079264640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8045654296875 GB
    Memory Allocated: 0.13410568237304688  GigaBytes
Max Memory Allocated: 0.5575070381164551  GigaBytes

torch.Size([1608, 1433])
torch.Size([776, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.4827089309692383  GigaBytes
Max Memory Allocated: 0.5575070381164551  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.13304710388183594  GigaBytes
Max Memory Allocated: 0.5996756553649902  GigaBytes

torch.Size([1411, 1433])
torch.Size([646, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.42058277130126953  GigaBytes
Max Memory Allocated: 0.5996756553649902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04766041040420532 |0.09153211116790771 |0.22577667236328125 |0.00013577938079833984 |0.15776866674423218 |0.012614250183105469 |
----------------------------------------------------------pseudo_mini_loss sum 2.9445064067840576
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9609
Number of first layer input nodes during this epoch:  6030
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.2585744857788086  GigaBytes
Max Memory Allocated: 0.5996756553649902  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005435943603515625
range selection method range initialization spend 6.365776062011719e-05
time for parepare:  6.771087646484375e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010728836059570312Using backend: pytorch

mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.151199340820312e-05
----------------------check_connections_block total spend ----------------------------- 0.0012950897216796875
generate_one_block  0.0011792182922363281
generate_one_block  0.0010957717895507812
generate_one_block  0.0010721683502197266
generate_one_block  0.0010497570037841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004870891571044922
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.0001518726348876953
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003943443298339844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003654956817626953
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00036644935607910156
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0004227161407470703
----------------------check_connections_block total spend ----------------------------- 0.00310516357421875
generate_one_block  0.0014903545379638672
generate_one_block  0.0014188289642333984
generate_one_block  0.0014269351959228516
generate_one_block  0.001489400863647461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005373954772949219
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0001819133758544922
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0010187625885009766
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0011217594146728516
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0011322498321533203
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.007386207580566406
generate_one_block  0.0022771358489990234
generate_one_block  0.0023956298828125
generate_one_block  0.0024738311767578125
generate_one_block  0.0024008750915527344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.2585744857788086  GigaBytes
Max Memory Allocated: 0.5996756553649902  GigaBytes

connection checking time:  0.010491371154785156
block generation total time  0.015372991561889648
average batch blocks generation time:  0.003843247890472412
block dataloader generation time/epoch 0.049538373947143555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.2582588195800781  GigaBytes
Max Memory Allocated: 0.5996756553649902  GigaBytes

torch.Size([1362, 1433])
torch.Size([660, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.5453372001647949  GigaBytes
Max Memory Allocated: 0.5996756553649902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.2592959403991699  GigaBytes
Max Memory Allocated: 0.6633410453796387  GigaBytes

torch.Size([1556, 1433])
torch.Size([693, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.5746755599975586  GigaBytes
Max Memory Allocated: 0.6633410453796387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.2589864730834961  GigaBytes
Max Memory Allocated: 0.6920828819274902  GigaBytes

torch.Size([1498, 1433])
torch.Size([722, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.5694613456726074  GigaBytes
Max Memory Allocated: 0.6920828819274902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.25907039642333984  GigaBytes
Max Memory Allocated: 0.6920828819274902  GigaBytes

torch.Size([1513, 1433])
torch.Size([735, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9354248046875 GB
    Memory Allocated: 0.5877928733825684  GigaBytes
Max Memory Allocated: 0.6920828819274902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046348631381988525 |0.0004140138626098633 |0.11219149827957153 |0.00011795759201049805 |0.1603507399559021 |0.009923696517944336 |
----------------------------------------------------------pseudo_mini_loss sum 2.1246073246002197
Total (block generation + training)time/epoch 1.3988802433013916
Training time/epoch 1.3490276336669922
Training time without block to device /epoch 1.3473715782165527
Training time without total dataloading part /epoch 1.1005644798278809
load block tensor time/epoch 0.1853945255279541
block to device time/epoch 0.0016560554504394531
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9480
Number of first layer input nodes during this epoch:  5929
