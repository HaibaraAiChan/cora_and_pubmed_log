main start at this time 1648430015.7768207
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011718273162841797
range selection method range initialization spend 8.273124694824219e-05
time for parepare:  6.4849853515625e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0024559497833251953
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0056645870208740234
generate_one_block  0.001271963119506836
generate_one_block  0.0011119842529296875
generate_one_block  0.0010492801666259766
generate_one_block  0.0010466575622558594
generate_one_block  0.0010294914245605469
generate_one_block  0.0010402202606201172
generate_one_block  0.0010480880737304688
generate_one_block  0.0010404586791992188
generate_one_block  0.0010399818420410156
generate_one_block  0.0011093616485595703
generate_one_block  0.0010380744934082031
generate_one_block  0.0009434223175048828
generate_one_block  0.0009486675262451172
generate_one_block  0.0009551048278808594
generate_one_block  0.0009577274322509766
generate_one_block  0.0010318756103515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006074905395507812
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.00014710426330566406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00017213821411132812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00019478797912597656
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.8160552978515625e-05
----------------------check_connections_block total spend ----------------------------- 0.00608515739440918
generate_one_block  0.0011763572692871094
generate_one_block  0.0012371540069580078
generate_one_block  0.0011272430419921875
generate_one_block  0.0011963844299316406
generate_one_block  0.0011324882507324219
generate_one_block  0.0011813640594482422
generate_one_block  0.0012695789337158203
generate_one_block  0.0011894702911376953
generate_one_block  0.0011372566223144531
generate_one_block  0.0011708736419677734
generate_one_block  0.0010852813720703125
generate_one_block  0.0010559558868408203
generate_one_block  0.0010592937469482422
generate_one_block  0.0011169910430908203
generate_one_block  0.001134634017944336
generate_one_block  0.0009958744049072266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007026195526123047
gen group dst list time:  0.00018262863159179688
time for parepare:  0.00021505355834960938
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00046515464782714844
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0006422996520996094
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003147125244140625
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0005102157592773438
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003466606140136719
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004930496215820312
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0007550716400146484
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005457401275634766
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006535053253173828
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0006921291351318359
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003333091735839844
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004000663757324219
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004975795745849609
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0007007122039794922
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0001423358917236328
----------------------check_connections_block total spend ----------------------------- 0.014201164245605469
generate_one_block  0.0015594959259033203
generate_one_block  0.001844167709350586
generate_one_block  0.0012569427490234375
generate_one_block  0.0014908313751220703
generate_one_block  0.0012793540954589844
generate_one_block  0.0017058849334716797
generate_one_block  0.0017862319946289062
generate_one_block  0.0015063285827636719
generate_one_block  0.0016515254974365234
generate_one_block  0.0016794204711914062
generate_one_block  0.001283884048461914
generate_one_block  0.0012974739074707031
generate_one_block  0.0013523101806640625
generate_one_block  0.0014524459838867188
generate_one_block  0.0017931461334228516
generate_one_block  0.0018782615661621094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.02028632164001465
block generation total time  0.043083906173706055
average batch blocks generation time:  0.0026927441358566284
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06649112701416016  GigaBytes
Max Memory Allocated: 0.06649112701416016  GigaBytes

torch.Size([700, 1433])
torch.Size([236, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3846435546875 GB
    Memory Allocated: 0.17810678482055664  GigaBytes
Max Memory Allocated: 0.18698453903198242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.13056325912475586  GigaBytes
Max Memory Allocated: 0.3005690574645996  GigaBytes

torch.Size([949, 1433])
torch.Size([371, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.2933368682861328  GigaBytes
Max Memory Allocated: 0.30713367462158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1278843879699707  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

torch.Size([449, 1433])
torch.Size([139, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.20170259475708008  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.12974882125854492  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

torch.Size([797, 1433])
torch.Size([284, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.2558116912841797  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.12795495986938477  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

torch.Size([462, 1433])
torch.Size([165, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.2062215805053711  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1290264129638672  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

torch.Size([662, 1433])
torch.Size([290, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.24865007400512695  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6346435546875 GB
    Memory Allocated: 0.1314849853515625  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

torch.Size([1121, 1433])
torch.Size([435, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.32741451263427734  GigaBytes
Max Memory Allocated: 0.41376829147338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.12942934036254883  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([737, 1433])
torch.Size([287, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.26268625259399414  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1315751075744629  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([1026, 1433])
torch.Size([383, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.2936873435974121  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1303696632385254  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([912, 1433])
torch.Size([366, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.30584239959716797  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1279773712158203  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([466, 1433])
torch.Size([157, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.20620489120483398  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.12830162048339844  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([527, 1433])
torch.Size([184, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.20627498626708984  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.12842130661010742  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([549, 1433])
torch.Size([196, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.22603940963745117  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.1292409896850586  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([702, 1433])
torch.Size([267, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.24989652633666992  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.13124418258666992  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([1065, 1433])
torch.Size([391, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.31137561798095703  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.12671613693237305  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([231, 1433])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.15537405014038086  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05291368067264557 |0.021706774830818176 |0.10640177130699158 |0.0001122206449508667 |0.10720863938331604 |0.013886690139770508 |
----------------------------------------------------------pseudo_mini_loss sum 2.8100993633270264
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16323
Number of first layer input nodes during this epoch:  11355
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.2521977424621582  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005183219909667969
range selection method range initialization spend 7.367134094238281e-05
time for parepare:  7.700920104980469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0032439231872558594
generate_one_block  0.00115966796875
generate_one_block  0.0010154247283935547
generate_one_block  0.0010421276092529297
generate_one_block  0.0013871192932128906
generate_one_block  0.0010402202606201172
generate_one_block  0.0010533332824707031
generate_one_block  0.0010230541229248047
generate_one_block  0.0010020732879638672
generate_one_block  0.001003265380859375
generate_one_block  0.0010228157043457031
generate_one_block  0.0009970664978027344
generate_one_block  0.00099945068359375
generate_one_block  0.0010540485382080078
generate_one_block  0.00101470947265625
generate_one_block  0.0010056495666503906
generate_one_block  0.0009906291961669922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006036758422851562
gen group dst list time:  0.00010013580322265625
time for parepare:  0.000179290771484375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00020694732666015625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011491775512695312
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00018262863159179688
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011682510375976562
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00025081634521484375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00013399124145507812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  8.749961853027344e-05
----------------------check_connections_block total spend ----------------------------- 0.006078481674194336
generate_one_block  0.0013704299926757812
generate_one_block  0.0011897087097167969
generate_one_block  0.001117706298828125
generate_one_block  0.0012509822845458984
generate_one_block  0.0012035369873046875
generate_one_block  0.0011129379272460938
generate_one_block  0.0011188983917236328
generate_one_block  0.001140594482421875
generate_one_block  0.0011284351348876953
generate_one_block  0.0011153221130371094
generate_one_block  0.0010848045349121094
generate_one_block  0.001123666763305664
generate_one_block  0.0012485980987548828
generate_one_block  0.0011703968048095703
generate_one_block  0.0010786056518554688
generate_one_block  0.0010492801666259766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007236003875732422
gen group dst list time:  0.00021600723266601562
time for parepare:  0.0002319812774658203
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0006127357482910156
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0004611015319824219
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003688335418701172
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006804466247558594
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005795955657958984
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0003314018249511719
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.00045561790466308594
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005211830139160156
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005242824554443359
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005116462707519531
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003745555877685547
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0005719661712646484
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0007925033569335938
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00034427642822265625
----------------------check_connections_block total spend ----------------------------- 0.015243053436279297
generate_one_block  0.00183868408203125
generate_one_block  0.001495361328125
generate_one_block  0.0014357566833496094
generate_one_block  0.0017499923706054688
generate_one_block  0.0016484260559082031
generate_one_block  0.0014216899871826172
generate_one_block  0.0014889240264892578
generate_one_block  0.0015358924865722656
generate_one_block  0.0015490055084228516
generate_one_block  0.0016715526580810547
generate_one_block  0.0014023780822753906
generate_one_block  0.0017135143280029297
generate_one_block  0.0019638538360595703
generate_one_block  0.0015721321105957031
generate_one_block  0.001531839370727539
generate_one_block  0.0013904571533203125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.2521977424621582  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

connection checking time:  0.021321535110473633
block generation total time  0.04391336441040039
average batch blocks generation time:  0.0027445852756500244
block dataloader generation time/epoch 0.13678669929504395
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.2556037902832031  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

torch.Size([868, 1433])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4116044044494629  GigaBytes
Max Memory Allocated: 0.4470071792602539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.2542109489440918  GigaBytes
Max Memory Allocated: 0.5321760177612305  GigaBytes

torch.Size([608, 1433])
torch.Size([245, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.36718320846557617  GigaBytes
Max Memory Allocated: 0.5321760177612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.25443220138549805  GigaBytes
Max Memory Allocated: 0.5321760177612305  GigaBytes

torch.Size([650, 1433])
torch.Size([205, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.34511232376098633  GigaBytes
Max Memory Allocated: 0.5321760177612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.2557659149169922  GigaBytes
Max Memory Allocated: 0.5321760177612305  GigaBytes

torch.Size([898, 1433])
torch.Size([359, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7440185546875 GB
    Memory Allocated: 0.4238138198852539  GigaBytes
Max Memory Allocated: 0.5321760177612305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2551846504211426  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([790, 1433])
torch.Size([293, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.3945317268371582  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.25397777557373047  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([565, 1433])
torch.Size([175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.3349933624267578  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.25499820709228516  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([740, 1433])
torch.Size([225, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.3681621551513672  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2546505928039551  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([690, 1433])
torch.Size([263, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.38346385955810547  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2551150321960449  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([777, 1433])
torch.Size([304, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.379209041595459  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.25498056411743164  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([752, 1433])
torch.Size([297, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.38043880462646484  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.254091739654541  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([586, 1433])
torch.Size([201, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.34459495544433594  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2555255889892578  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([797, 1433])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.4018287658691406  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.25659704208374023  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

torch.Size([1053, 1433])
torch.Size([410, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.45705556869506836  GigaBytes
Max Memory Allocated: 0.5448112487792969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.2553224563598633  GigaBytes
Max Memory Allocated: 0.5766735076904297  GigaBytes

torch.Size([816, 1433])
torch.Size([310, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.38360595703125  GigaBytes
Max Memory Allocated: 0.5766735076904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.25404977798461914  GigaBytes
Max Memory Allocated: 0.5766735076904297  GigaBytes

torch.Size([578, 1433])
torch.Size([203, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.3576993942260742  GigaBytes
Max Memory Allocated: 0.5766735076904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.25410032272338867  GigaBytes
Max Memory Allocated: 0.5766735076904297  GigaBytes

torch.Size([588, 1433])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.3387579917907715  GigaBytes
Max Memory Allocated: 0.5766735076904297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05200600624084473 |0.0004167705774307251 |0.0811917781829834 |0.00010482966899871826 |0.12109236419200897 |0.010475635528564453 |
----------------------------------------------------------pseudo_mini_loss sum 2.224330186843872
Total (block generation + training)time/epoch 4.28754186630249
Training time/epoch 4.1504597663879395
Training time without block to device /epoch 4.143791437149048
Training time without total dataloading part /epoch 3.248699188232422
load block tensor time/epoch 0.8320960998535156
block to device time/epoch 0.0066683292388916016
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16837
Number of first layer input nodes during this epoch:  11756
