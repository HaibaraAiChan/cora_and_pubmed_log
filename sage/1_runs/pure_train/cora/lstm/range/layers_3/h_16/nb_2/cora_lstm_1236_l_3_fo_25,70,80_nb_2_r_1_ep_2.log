main start at this time 1648429978.5698724
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012362003326416016
range selection method range initialization spend 8.058547973632812e-05
time for parepare:  6.103515625e-05
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0018587112426757812
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00012993812561035156
----------------------check_connections_block total spend ----------------------------- 0.0027191638946533203
generate_one_block  0.0016853809356689453
generate_one_block  0.0012633800506591797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004906654357910156
gen group dst list time:  2.8848648071289062e-05
time for parepare:  0.00013899803161621094
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0006783008575439453
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0007221698760986328
----------------------check_connections_block total spend ----------------------------- 0.0025670528411865234
generate_one_block  0.0019457340240478516
generate_one_block  0.0020058155059814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005867481231689453
gen group dst list time:  5.602836608886719e-05
time for parepare:  0.0001823902130126953
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.00032019615173339844
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0017833709716796875
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.0017380714416503906
----------------------check_connections_block total spend ----------------------------- 0.005624294281005859
generate_one_block  0.0032148361206054688
generate_one_block  0.003096342086791992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.008191347122192383
block generation total time  0.010262727737426758
average batch blocks generation time:  0.005131363868713379
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07329750061035156  GigaBytes
Max Memory Allocated: 0.07329750061035156  GigaBytes

torch.Size([1966, 1433])
torch.Size([1195, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5604877471923828  GigaBytes
Max Memory Allocated: 0.5997462272644043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.13568496704101562  GigaBytes
Max Memory Allocated: 0.6736307144165039  GigaBytes

torch.Size([1900, 1433])
torch.Size([1144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9237060546875 GB
    Memory Allocated: 0.6089639663696289  GigaBytes
Max Memory Allocated: 0.6736307144165039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03804492950439453 |0.17020857334136963 |0.3847501277923584 |0.0001666545867919922 |0.22379028797149658 |0.010244369506835938 |
----------------------------------------------------------pseudo_mini_loss sum 2.7353439331054688
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6904
Number of first layer input nodes during this epoch:  3866
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.26125240325927734  GigaBytes
Max Memory Allocated: 0.7221622467041016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048279762268066406
range selection method range initialization spend 6.079673767089844e-05
time for parepare:  6.580352783203125e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00012350082397460938
----------------------check_connections_block total spend ----------------------------- 0.0008985996246337891
generate_one_block  0.0013167858123779297
generate_one_block  0.0013420581817626953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005106925964355469
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.00015497207641601562
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006873607635498047
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0007243156433105469
----------------------check_connections_block total spend ----------------------------- 0.002614736557006836
generate_one_block  0.0019309520721435547
generate_one_block  0.0019390583038330078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005655288696289062
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.00018715858459472656
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0017147064208984375
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.001850128173828125
----------------------check_connections_block total spend ----------------------------- 0.005787849426269531
generate_one_block  0.003312826156616211
generate_one_block  0.003351926803588867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.26125240325927734  GigaBytes
Max Memory Allocated: 0.7221622467041016  GigaBytes

connection checking time:  0.008402585983276367
block generation total time  0.01053476333618164
average batch blocks generation time:  0.00526738166809082
block dataloader generation time/epoch 0.035268306732177734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.26102590560913086  GigaBytes
Max Memory Allocated: 0.7221622467041016  GigaBytes
Using backend: pytorch

torch.Size([1876, 1433])
torch.Size([1117, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0799560546875 GB
    Memory Allocated: 0.7221884727478027  GigaBytes
Max Memory Allocated: 0.759770393371582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.2615165710449219  GigaBytes
Max Memory Allocated: 0.8356285095214844  GigaBytes

torch.Size([1967, 1433])
torch.Size([1186, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.7542452812194824  GigaBytes
Max Memory Allocated: 0.8356285095214844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.034560322761535645 |0.00044667720794677734 |0.14977526664733887 |0.00012195110321044922 |0.21799397468566895 |0.009840250015258789 |
----------------------------------------------------------pseudo_mini_loss sum 2.3274831771850586
Total (block generation + training)time/epoch 0.9117245674133301
Training time/epoch 0.8761920928955078
Training time without block to device /epoch 0.8752987384796143
Training time without total dataloading part /epoch 0.7456226348876953
load block tensor time/epoch 0.06912064552307129
block to device time/epoch 0.0008933544158935547
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6843
Number of first layer input nodes during this epoch:  3843
