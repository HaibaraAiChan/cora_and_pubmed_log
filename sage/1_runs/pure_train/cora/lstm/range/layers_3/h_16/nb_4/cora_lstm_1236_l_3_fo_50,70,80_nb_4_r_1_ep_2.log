main start at this time 1648430044.9409096
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011906623840332031
range selection method range initialization spend 7.677078247070312e-05
time for parepare:  5.817413330078125e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.002803325653076172
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010323524475097656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.0040433406829833984
generate_one_block  0.0014600753784179688
generate_one_block  0.0010590553283691406
generate_one_block  0.0010352134704589844
generate_one_block  0.0010237693786621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00049591064453125
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.0001385211944580078
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004086494445800781
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.000453948974609375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040793418884277344
----------------------check_connections_block total spend ----------------------------- 0.0031423568725585938
generate_one_block  0.0014526844024658203
generate_one_block  0.001447916030883789
generate_one_block  0.0014803409576416016
generate_one_block  0.001489877700805664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005478858947753906
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0001666545867919922
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0002682209014892578
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0012862682342529297
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0012462139129638672
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0013422966003417969
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0011591911315917969
----------------------check_connections_block total spend ----------------------------- 0.008034944534301758
generate_one_block  0.002523660659790039
generate_one_block  0.002412080764770508
generate_one_block  0.002619504928588867
generate_one_block  0.0023174285888671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.011177301406860352
block generation total time  0.015743494033813477
average batch blocks generation time:  0.003935873508453369
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07143735885620117  GigaBytes
Max Memory Allocated: 0.07143735885620117  GigaBytes

torch.Size([1621, 1433])
torch.Size([801, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.4382972717285156  GigaBytes
Max Memory Allocated: 0.4681820869445801  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.13421201705932617  GigaBytes
Max Memory Allocated: 0.5566201210021973  GigaBytes

torch.Size([1628, 1433])
torch.Size([809, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7869873046875 GB
    Memory Allocated: 0.48665809631347656  GigaBytes
Max Memory Allocated: 0.5566201210021973  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.13447332382202148  GigaBytes
Max Memory Allocated: 0.6041040420532227  GigaBytes

torch.Size([1676, 1433])
torch.Size([840, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.5182042121887207  GigaBytes
Max Memory Allocated: 0.6041040420532227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.13381528854370117  GigaBytes
Max Memory Allocated: 0.6357331275939941  GigaBytes

torch.Size([1554, 1433])
torch.Size([722, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.46505117416381836  GigaBytes
Max Memory Allocated: 0.6357331275939941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047177135944366455 |0.0858868956565857 |0.29592984914779663 |0.000152587890625 |0.3893762230873108 |0.008875131607055664 |
----------------------------------------------------------pseudo_mini_loss sum 2.9446990489959717
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10385
Number of first layer input nodes during this epoch:  6479
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25934839248657227  GigaBytes
Max Memory Allocated: 0.6357331275939941  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005207061767578125
range selection method range initialization spend 7.724761962890625e-05
time for parepare:  7.367134094238281e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011372566223144531Using backend: pytorch

mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.723403930664062e-05
----------------------check_connections_block total spend ----------------------------- 0.0014503002166748047
generate_one_block  0.0012760162353515625
generate_one_block  0.0011591911315917969
generate_one_block  0.0011076927185058594
generate_one_block  0.001123189926147461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005497932434082031
gen group dst list time:  4.506111145019531e-05
time for parepare:  0.00015282630920410156
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004582405090332031
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00040912628173828125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00041961669921875
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004723072052001953
----------------------check_connections_block total spend ----------------------------- 0.0034363269805908203
generate_one_block  0.0027685165405273438
generate_one_block  0.0016269683837890625
generate_one_block  0.0016047954559326172
generate_one_block  0.0016329288482666016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000591278076171875
gen group dst list time:  9.369850158691406e-05
time for parepare:  0.0001995563507080078
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.00122833251953125
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0014183521270751953
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0013747215270996094
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0014259815216064453
----------------------check_connections_block total spend ----------------------------- 0.008727788925170898
generate_one_block  0.0025970935821533203
generate_one_block  0.002730846405029297
generate_one_block  0.002705097198486328
generate_one_block  0.0025663375854492188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25934839248657227  GigaBytes
Max Memory Allocated: 0.6357331275939941  GigaBytes

connection checking time:  0.012164115905761719
block generation total time  0.01823258399963379
average batch blocks generation time:  0.004558145999908447
block dataloader generation time/epoch 0.06351280212402344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25993871688842773  GigaBytes
Max Memory Allocated: 0.6357331275939941  GigaBytes

torch.Size([1498, 1433])
torch.Size([729, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.5875353813171387  GigaBytes
Max Memory Allocated: 0.6357331275939941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.2599630355834961  GigaBytes
Max Memory Allocated: 0.7059259414672852  GigaBytes

torch.Size([1680, 1433])
torch.Size([770, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.6202144622802734  GigaBytes
Max Memory Allocated: 0.7059259414672852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25994253158569336  GigaBytes
Max Memory Allocated: 0.7384505271911621  GigaBytes

torch.Size([1624, 1433])
torch.Size([822, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.6235332489013672  GigaBytes
Max Memory Allocated: 0.7384505271911621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.25960254669189453  GigaBytes
Max Memory Allocated: 0.741452693939209  GigaBytes

torch.Size([1612, 1433])
torch.Size([814, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.6294980049133301  GigaBytes
Max Memory Allocated: 0.741452693939209  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04430431127548218 |0.0005925297737121582 |0.17884308099746704 |0.00013375282287597656 |0.38173002004623413 |0.009562969207763672 |
----------------------------------------------------------pseudo_mini_loss sum 2.0926828384399414
Total (block generation + training)time/epoch 2.55822491645813
Training time/epoch 2.4943554401397705
Training time without block to device /epoch 2.491985321044922
Training time without total dataloading part /epoch 2.2523903846740723
load block tensor time/epoch 0.1772172451019287
block to device time/epoch 0.002370119094848633
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10290
Number of first layer input nodes during this epoch:  6414
