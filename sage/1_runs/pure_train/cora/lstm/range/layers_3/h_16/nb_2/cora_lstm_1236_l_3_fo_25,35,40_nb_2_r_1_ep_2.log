main start at this time 1648429872.5963554
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013246536254882812
range selection method range initialization spend 8.273124694824219e-05
time for parepare:  5.793571472167969e-05
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0012865066528320312
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00013017654418945312
----------------------check_connections_block total spend ----------------------------- 0.0021126270294189453
generate_one_block  0.0014863014221191406
generate_one_block  0.0011098384857177734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000461578369140625
gen group dst list time:  2.7418136596679688e-05
time for parepare:  0.0001277923583984375
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0006434917449951172
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0006568431854248047
----------------------check_connections_block total spend ----------------------------- 0.002389669418334961
generate_one_block  0.0017249584197998047
generate_one_block  0.0019078254699707031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005402565002441406
gen group dst list time:  5.435943603515625e-05
time for parepare:  0.00016927719116210938
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0017077922821044922
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0016522407531738281
----------------------check_connections_block total spend ----------------------------- 0.005284786224365234
generate_one_block  0.0029032230377197266
generate_one_block  0.0028562545776367188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.007674455642700195
block generation total time  0.009392261505126953
average batch blocks generation time:  0.0046961307525634766
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07306528091430664  GigaBytes
Max Memory Allocated: 0.07306528091430664  GigaBytes

torch.Size([1923, 1433])
torch.Size([1118, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5376181602478027  GigaBytes
Max Memory Allocated: 0.5758547782897949  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.1355762481689453  GigaBytes
Max Memory Allocated: 0.6517796516418457  GigaBytes

torch.Size([1880, 1433])
torch.Size([1089, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.5944294929504395  GigaBytes
Max Memory Allocated: 0.6517796516418457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0403444766998291 |0.1692594289779663 |0.367012619972229 |0.00016057491302490234 |0.18847012519836426 |0.011164426803588867 |
----------------------------------------------------------pseudo_mini_loss sum 2.732983112335205
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6709
Number of first layer input nodes during this epoch:  3803
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2611408233642578  GigaBytes
Max Memory Allocated: 0.7083625793457031  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005145072937011719
range selection method range initialization spend 5.888938903808594e-05
time for parepare:  6.437301635742188e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011539459228515625
----------------------check_connections_block total spend ----------------------------- 0.0008292198181152344
generate_one_block  0.0012507438659667969
generate_one_block  0.0011615753173828125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047850608825683594
gen group dst list time:  3.0517578125e-05
time for parepare:  0.00014591217041015625
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006246566772460938
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0006542205810546875
----------------------check_connections_block total spend ----------------------------- 0.002403736114501953
generate_one_block  0.001794576644897461
generate_one_block  0.0017864704132080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005447864532470703
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.00017976760864257812
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0015459060668945312
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.001672506332397461
----------------------check_connections_block total spend ----------------------------- 0.005145072937011719
generate_one_block  0.002985239028930664
generate_one_block  0.0029265880584716797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2611408233642578  GigaBytes
Max Memory Allocated: 0.7083625793457031  GigaBytes

connection checking time:  0.007548809051513672
block generation total time  0.009492874145507812
average batch blocks generation time:  0.004746437072753906
block dataloader generation time/epoch 0.032053232192993164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2607612609863281  GigaBytes
Max Memory Allocated: 0.7083625793457031  GigaBytes
Using backend: pytorch

torch.Size([1827, 1433])
torch.Size([1048, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.6983928680419922  GigaBytes
Max Memory Allocated: 0.7335305213928223  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2612466812133789  GigaBytes
Max Memory Allocated: 0.8126578330993652  GigaBytes

torch.Size([1917, 1433])
torch.Size([1114, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.7316527366638184  GigaBytes
Max Memory Allocated: 0.8126578330993652  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03321802616119385 |0.0004172325134277344 |0.13042473793029785 |0.00012302398681640625 |0.1812955141067505 |0.008783102035522461 |
----------------------------------------------------------pseudo_mini_loss sum 2.202685832977295
Total (block generation + training)time/epoch 0.7922525405883789
Training time/epoch 0.7599678039550781
Training time without block to device /epoch 0.7591333389282227
Training time without total dataloading part /epoch 0.632469654083252
load block tensor time/epoch 0.0664360523223877
block to device time/epoch 0.0008344650268554688
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6603
Number of first layer input nodes during this epoch:  3744
