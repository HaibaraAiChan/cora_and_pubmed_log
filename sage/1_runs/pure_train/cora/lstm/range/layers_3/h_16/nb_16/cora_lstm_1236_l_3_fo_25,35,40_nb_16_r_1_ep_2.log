main start at this time 1648429908.8884344
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013682842254638672
range selection method range initialization spend 0.00011682510375976562
time for parepare:  6.151199340820312e-05
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0023889541625976562
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.005475759506225586
generate_one_block  0.0013093948364257812
generate_one_block  0.0010898113250732422
generate_one_block  0.0010173320770263672
generate_one_block  0.0010578632354736328
generate_one_block  0.0010235309600830078
generate_one_block  0.0010137557983398438
generate_one_block  0.00104522705078125
generate_one_block  0.0010378360748291016
generate_one_block  0.0010085105895996094
generate_one_block  0.0010662078857421875
generate_one_block  0.0010423660278320312
generate_one_block  0.0010216236114501953
generate_one_block  0.0010063648223876953
generate_one_block  0.0009953975677490234
generate_one_block  0.0009779930114746094
generate_one_block  0.0009570121765136719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  9.322166442871094e-05
time for parepare:  0.00014352798461914062
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011706352233886719
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00019121170043945312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001227855682373047
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00019693374633789062
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00016617774963378906
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.673004150390625e-05
----------------------check_connections_block total spend ----------------------------- 0.005620002746582031
generate_one_block  0.0011649131774902344
generate_one_block  0.0011525154113769531
generate_one_block  0.0011305809020996094
generate_one_block  0.0011718273162841797
generate_one_block  0.0010814666748046875
generate_one_block  0.0011477470397949219
generate_one_block  0.0012481212615966797
generate_one_block  0.0011262893676757812
generate_one_block  0.0011174678802490234
generate_one_block  0.0011746883392333984
generate_one_block  0.001054525375366211
generate_one_block  0.0010421276092529297
generate_one_block  0.0010802745819091797
generate_one_block  0.001119852066040039
generate_one_block  0.0011363029479980469
generate_one_block  0.0010228157043457031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007126331329345703
gen group dst list time:  0.00015211105346679688
time for parepare:  0.00021076202392578125
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004315376281738281
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004947185516357422
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003223419189453125
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00047087669372558594
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00028252601623535156
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00038433074951171875
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006544589996337891
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00046443939208984375
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005619525909423828
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0006089210510253906
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003211498260498047
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002772808074951172
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003504753112792969
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004372596740722656
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0005991458892822266
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0001361370086669922
----------------------check_connections_block total spend ----------------------------- 0.01269078254699707
generate_one_block  0.0015077590942382812
generate_one_block  0.0016443729400634766
generate_one_block  0.0013217926025390625
generate_one_block  0.0014619827270507812
generate_one_block  0.0012531280517578125
generate_one_block  0.0016355514526367188
generate_one_block  0.0017223358154296875
generate_one_block  0.0014476776123046875
generate_one_block  0.0015990734100341797
generate_one_block  0.002410411834716797
generate_one_block  0.0013158321380615234
generate_one_block  0.0012555122375488281
generate_one_block  0.0013363361358642578
generate_one_block  0.0014181137084960938
generate_one_block  0.0016777515411376953
generate_one_block  0.001096487045288086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06273937225341797  GigaBytes
Max Memory Allocated: 0.06273937225341797  GigaBytes

connection checking time:  0.0183107852935791
block generation total time  0.04207563400268555
average batch blocks generation time:  0.0026297271251678467
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.0664377212524414  GigaBytes
Max Memory Allocated: 0.0664377212524414  GigaBytes

torch.Size([690, 1433])
torch.Size([231, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3826904296875 GB
    Memory Allocated: 0.17552709579467773  GigaBytes
Max Memory Allocated: 0.18424701690673828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.12978553771972656  GigaBytes
Max Memory Allocated: 0.29802942276000977  GigaBytes

torch.Size([804, 1433])
torch.Size([269, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.25643491744995117  GigaBytes
Max Memory Allocated: 0.29802942276000977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12789535522460938  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

torch.Size([451, 1433])
torch.Size([139, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.20171356201171875  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.1293787956237793  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

torch.Size([728, 1433])
torch.Size([250, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.2465806007385254  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12789535522460938  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

torch.Size([445, 1433])
torch.Size([138, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.19590473175048828  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.12856531143188477  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

torch.Size([576, 1433])
torch.Size([231, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.22663164138793945  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6014404296875 GB
    Memory Allocated: 0.13083839416503906  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

torch.Size([1000, 1433])
torch.Size([370, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.3071727752685547  GigaBytes
Max Memory Allocated: 0.37767791748046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6424560546875 GB
    Memory Allocated: 0.12903165817260742  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([663, 1433])
torch.Size([228, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.24106550216674805  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1302943229675293  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([899, 1433])
torch.Size([317, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2706890106201172  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13011550903320312  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([865, 1433])
torch.Size([324, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.29057788848876953  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12802505493164062  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([475, 1433])
torch.Size([157, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.20625019073486328  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.12791109085083008  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([454, 1433])
torch.Size([152, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.19562339782714844  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1283411979675293  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([534, 1433])
torch.Size([176, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.21715307235717773  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1289196014404297  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([642, 1433])
torch.Size([238, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2382183074951172  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.13052034378051758  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([941, 1433])
torch.Size([328, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.2898540496826172  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.1267104148864746  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([230, 1433])
torch.Size([53, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.15536832809448242  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05281408131122589 |0.02187184989452362 |0.10341489315032959 |0.00011332333087921143 |0.10519048571586609 |0.013946294784545898 |
----------------------------------------------------------pseudo_mini_loss sum 2.8053083419799805
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14762
Number of first layer input nodes during this epoch:  10397
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.25219202041625977  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005743503570556641
range selection method range initialization spend 0.00010323524475097656
time for parepare:  8.0108642578125e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0032646656036376953
generate_one_block  0.001192331314086914
generate_one_block  0.0010476112365722656
generate_one_block  0.001008749008178711
generate_one_block  0.0014297962188720703
generate_one_block  0.0010402202606201172
generate_one_block  0.0010094642639160156
generate_one_block  0.0010075569152832031
generate_one_block  0.0010576248168945312
generate_one_block  0.0010247230529785156
generate_one_block  0.0010058879852294922
generate_one_block  0.0010335445404052734
generate_one_block  0.0010018348693847656
generate_one_block  0.0009882450103759766
generate_one_block  0.0009667873382568359
generate_one_block  0.0009722709655761719
generate_one_block  0.0009546279907226562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006225109100341797
gen group dst list time:  0.00010180473327636719
time for parepare:  0.0001647472381591797
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00019288063049316406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001728534698486328
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00023818016052246094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.510185241699219e-05
----------------------check_connections_block total spend ----------------------------- 0.0058362483978271484
generate_one_block  0.0013611316680908203
generate_one_block  0.0011451244354248047
generate_one_block  0.0011179447174072266
generate_one_block  0.0012345314025878906
generate_one_block  0.0011632442474365234
generate_one_block  0.001131296157836914
generate_one_block  0.0011806488037109375
generate_one_block  0.001186370849609375
generate_one_block  0.001199960708618164
generate_one_block  0.001142263412475586
generate_one_block  0.0010640621185302734
generate_one_block  0.0011010169982910156
generate_one_block  0.0013248920440673828
generate_one_block  0.0011374950408935547
generate_one_block  0.001070261001586914
generate_one_block  0.0010983943939208984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007469654083251953
gen group dst list time:  0.00016355514526367188
time for parepare:  0.00022363662719726562
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0002720355987548828
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0005590915679931641
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005981922149658203
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005023479461669922
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00029730796813964844
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00048422813415527344
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0004916191101074219
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004260540008544922
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00041556358337402344
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00032138824462890625
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.000518798828125
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0007638931274414062
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0004215240478515625
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00035643577575683594
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0002846717834472656
----------------------check_connections_block total spend ----------------------------- 0.013695716857910156
generate_one_block  0.0017740726470947266
generate_one_block  0.0014998912811279297
generate_one_block  0.0013637542724609375
generate_one_block  0.0016791820526123047
generate_one_block  0.001535654067993164
generate_one_block  0.0013132095336914062
generate_one_block  0.0015683174133300781
generate_one_block  0.0014989376068115234
generate_one_block  0.0014674663543701172
generate_one_block  0.001554250717163086
generate_one_block  0.0013420581817626953
generate_one_block  0.0015211105346679688
generate_one_block  0.0018520355224609375
generate_one_block  0.0014641284942626953
generate_one_block  0.0013933181762695312
generate_one_block  0.0013098716735839844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.25219202041625977  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

connection checking time:  0.019531965255737305
block generation total time  0.04279589653015137
average batch blocks generation time:  0.0026747435331344604
block dataloader generation time/epoch 0.13982439041137695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.25532960891723633  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

torch.Size([817, 1433])
torch.Size([293, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.3986048698425293  GigaBytes
Max Memory Allocated: 0.42755556106567383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2541031837463379  GigaBytes
Max Memory Allocated: 0.5195713043212891  GigaBytes

torch.Size([588, 1433])
torch.Size([221, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.35436010360717773  GigaBytes
Max Memory Allocated: 0.5195713043212891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25357627868652344  GigaBytes
Max Memory Allocated: 0.5195713043212891  GigaBytes

torch.Size([490, 1433])
torch.Size([140, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.3190326690673828  GigaBytes
Max Memory Allocated: 0.5195713043212891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25551319122314453  GigaBytes
Max Memory Allocated: 0.5195713043212891  GigaBytes

torch.Size([851, 1433])
torch.Size([323, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.4129676818847656  GigaBytes
Max Memory Allocated: 0.5195713043212891  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25486326217651367  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([730, 1433])
torch.Size([257, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.37572669982910156  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25357627868652344  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([490, 1433])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.32393550872802734  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.254915714263916  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([740, 1433])
torch.Size([224, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.36789512634277344  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2544841766357422  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([659, 1433])
torch.Size([240, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.3719964027404785  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25461578369140625  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([684, 1433])
torch.Size([243, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.35924482345581055  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25427961349487305  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([621, 1433])
torch.Size([236, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.35671281814575195  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25461292266845703  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([512, 1433])
torch.Size([165, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.33232545852661133  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.25479936599731445  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([718, 1433])
torch.Size([251, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.3785409927368164  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7401123046875 GB
    Memory Allocated: 0.2565321922302246  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

torch.Size([1041, 1433])
torch.Size([391, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.4493083953857422  GigaBytes
Max Memory Allocated: 0.5343875885009766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.25461578369140625  GigaBytes
Max Memory Allocated: 0.5692667961120605  GigaBytes

torch.Size([684, 1433])
torch.Size([239, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.3590888977050781  GigaBytes
Max Memory Allocated: 0.5692667961120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.2538728713989258  GigaBytes
Max Memory Allocated: 0.5692667961120605  GigaBytes

torch.Size([545, 1433])
torch.Size([170, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.34131431579589844  GigaBytes
Max Memory Allocated: 0.5692667961120605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.25368309020996094  GigaBytes
Max Memory Allocated: 0.5692667961120605  GigaBytes

torch.Size([510, 1433])
torch.Size([144, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.32323598861694336  GigaBytes
Max Memory Allocated: 0.5692667961120605  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051976755261421204 |0.0003967583179473877 |0.073446124792099 |0.0001071542501449585 |0.10273870825767517 |0.010414600372314453 |
----------------------------------------------------------pseudo_mini_loss sum 2.2291903495788574
Total (block generation + training)time/epoch 3.871894121170044
Training time/epoch 3.731720447540283
Training time without block to device /epoch 3.725372314453125
Training time without total dataloading part /epoch 2.8310863971710205
load block tensor time/epoch 0.8316280841827393
block to device time/epoch 0.006348133087158203
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15136
Number of first layer input nodes during this epoch:  10680
