main start at this time 1648430213.3673098
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016980171203613281
range selection method range initialization spend 0.0001342296600341797
time for parepare:  6.103515625e-05
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.007333278656005859
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.14984130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.00869441032409668
generate_one_block  0.0016217231750488281
generate_one_block  0.0010530948638916016
generate_one_block  0.0011086463928222656
generate_one_block  0.0010194778442382812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004870891571044922
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0001323223114013672
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003521442413330078
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004715919494628906
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004894733428955078
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003483295440673828
----------------------check_connections_block total spend ----------------------------- 0.003132343292236328
generate_one_block  0.0013952255249023438
generate_one_block  0.0015289783477783203
generate_one_block  0.0017156600952148438
generate_one_block  0.0014057159423828125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005886554718017578
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.00016760826110839844
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0010578632354736328
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0013506412506103516
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0012912750244140625
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.001070261001586914
----------------------check_connections_block total spend ----------------------------- 0.007666826248168945
generate_one_block  0.0022323131561279297
generate_one_block  0.0025267601013183594
generate_one_block  0.002511262893676758
generate_one_block  0.0021381378173828125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.010799169540405273
block generation total time  0.01545405387878418
average batch blocks generation time:  0.003863513469696045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07093334197998047  GigaBytes
Max Memory Allocated: 0.07093334197998047  GigaBytes

torch.Size([1486, 1433])
torch.Size([678, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.372342586517334  GigaBytes
Max Memory Allocated: 0.3961520195007324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.13466501235961914  GigaBytes
Max Memory Allocated: 0.48948001861572266  GigaBytes

torch.Size([1629, 1433])
torch.Size([822, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.49337148666381836  GigaBytes
Max Memory Allocated: 0.5207009315490723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.13433027267456055  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

torch.Size([1566, 1433])
torch.Size([832, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.4927215576171875  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.13317108154296875  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

torch.Size([1351, 1433])
torch.Size([683, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.41434669494628906  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04772806167602539 |0.08583730459213257 |0.24256569147109985 |0.00015908479690551758 |0.19152075052261353 |0.011425256729125977 |
----------------------------------------------------------pseudo_mini_loss sum 2.7144083976745605
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9782
Number of first layer input nodes during this epoch:  6032
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.2591419219970703  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005087852478027344
range selection method range initialization spend 6.4849853515625e-05
time for parepare:  7.128715515136719e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011515617370605469Using backend: pytorch

mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0015718936920166016
generate_one_block  0.0012738704681396484
generate_one_block  0.0011959075927734375
generate_one_block  0.0010919570922851562
generate_one_block  0.0010864734649658203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005490779876708984
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.00015401840209960938
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004839897155761719
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.00047779083251953125
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00041937828063964844
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0004303455352783203
----------------------check_connections_block total spend ----------------------------- 0.003505706787109375
generate_one_block  0.0017080307006835938
generate_one_block  0.0016202926635742188
generate_one_block  0.0015821456909179688
generate_one_block  0.0015568733215332031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005745887756347656
gen group dst list time:  9.202957153320312e-05
time for parepare:  0.00019979476928710938
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.00032138824462890625
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0013761520385742188
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00019311904907226562
r_  generation:  0.0013926029205322266
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.0012962818145751953
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.001338958740234375
----------------------check_connections_block total spend ----------------------------- 0.00885152816772461
generate_one_block  0.0027990341186523438
generate_one_block  0.0027914047241210938
generate_one_block  0.002629995346069336
generate_one_block  0.002531290054321289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.2591419219970703  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

connection checking time:  0.012357234954833984
block generation total time  0.017219066619873047
average batch blocks generation time:  0.004304766654968262
block dataloader generation time/epoch 0.057064056396484375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.26079750061035156  GigaBytes
Max Memory Allocated: 0.6083431243896484  GigaBytes

torch.Size([1669, 1433])
torch.Size([843, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9002685546875 GB
    Memory Allocated: 0.6186861991882324  GigaBytes
Max Memory Allocated: 0.6461873054504395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2607088088989258  GigaBytes
Max Memory Allocated: 0.7334718704223633  GigaBytes

torch.Size([1652, 1433])
torch.Size([813, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.6228542327880859  GigaBytes
Max Memory Allocated: 0.7334718704223633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.26079559326171875  GigaBytes
Max Memory Allocated: 0.7376837730407715  GigaBytes

torch.Size([1590, 1433])
torch.Size([760, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.6033596992492676  GigaBytes
Max Memory Allocated: 0.7376837730407715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.26032161712646484  GigaBytes
Max Memory Allocated: 0.7376837730407715  GigaBytes

torch.Size([1580, 1433])
torch.Size([814, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.6074028015136719  GigaBytes
Max Memory Allocated: 0.7376837730407715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046913325786590576 |0.0004534721374511719 |0.1319255232810974 |0.00012063980102539062 |0.2028917670249939 |0.006200551986694336 |
----------------------------------------------------------pseudo_mini_loss sum 2.269864320755005
Total (block generation + training)time/epoch 1.649345874786377
Training time/epoch 1.5919320583343506
Training time without block to device /epoch 1.590118169784546
Training time without total dataloading part /epoch 1.3459522724151611
load block tensor time/epoch 0.1876533031463623
block to device time/epoch 0.0018138885498046875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10466
Number of first layer input nodes during this epoch:  6491
