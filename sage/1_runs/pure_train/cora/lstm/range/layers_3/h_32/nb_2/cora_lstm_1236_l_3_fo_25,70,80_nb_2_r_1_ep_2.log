main start at this time 1648430203.0316293
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010890960693359375
range selection method range initialization spend 9.894371032714844e-05
time for parepare:  8.273124694824219e-05
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0018110275268554688
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001437664031982422
----------------------check_connections_block total spend ----------------------------- 0.0027942657470703125
generate_one_block  0.0016984939575195312
generate_one_block  0.0014519691467285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006041526794433594
gen group dst list time:  3.814697265625e-05
time for parepare:  0.00018906593322753906
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0008409023284912109
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0008594989776611328
----------------------check_connections_block total spend ----------------------------- 0.0031130313873291016
generate_one_block  0.0022907257080078125
generate_one_block  0.002335786819458008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00067138671875
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.00022745132446289062
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.00038695335388183594
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0021572113037109375
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0002932548522949219
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.002124786376953125
----------------------check_connections_block total spend ----------------------------- 0.00685882568359375
generate_one_block  0.0037724971771240234
generate_one_block  0.0035355091094970703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.009971857070922852
block generation total time  0.011934518814086914
average batch blocks generation time:  0.005967259407043457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1561279296875 GB
    Memory Allocated: 0.07315587997436523  GigaBytes
Max Memory Allocated: 0.07315587997436523  GigaBytes

torch.Size([1898, 1433])
torch.Size([1141, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.546607494354248  GigaBytes
Max Memory Allocated: 0.5828118324279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.13553142547607422  GigaBytes
Max Memory Allocated: 0.6583094596862793  GigaBytes

torch.Size([1788, 1433])
torch.Size([1108, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.5943660736083984  GigaBytes
Max Memory Allocated: 0.6583094596862793  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037404775619506836 |0.1814333200454712 |0.3847343921661377 |0.00018513202667236328 |0.21865427494049072 |0.010440826416015625 |
----------------------------------------------------------pseudo_mini_loss sum 2.7798333168029785
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6633
Number of first layer input nodes during this epoch:  3686
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.26154232025146484  GigaBytes
Max Memory Allocated: 0.705681324005127  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005784034729003906
range selection method range initialization spend 7.891654968261719e-05
time for parepare:  8.559226989746094e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001366138458251953
----------------------check_connections_block total spend ----------------------------- 0.0010547637939453125
generate_one_block  0.0015697479248046875
generate_one_block  0.0014405250549316406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005805492401123047
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.00020170211791992188
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0009174346923828125
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0009942054748535156
----------------------check_connections_block total spend ----------------------------- 0.003415822982788086
generate_one_block  0.0024216175079345703
generate_one_block  0.002300739288330078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006680488586425781
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0002372264862060547
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.00040078163146972656
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.0022192001342773438
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.0003039836883544922
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.002279520034790039
----------------------check_connections_block total spend ----------------------------- 0.007181882858276367
generate_one_block  0.004021167755126953
generate_one_block  0.0038139820098876953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.26154232025146484  GigaBytes
Max Memory Allocated: 0.705681324005127  GigaBytes

connection checking time:  0.010597705841064453
block generation total time  0.012557506561279297
average batch blocks generation time:  0.0062787532806396484
block dataloader generation time/epoch 0.0410001277923584
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2623772621154785  GigaBytes
Max Memory Allocated: 0.705681324005127  GigaBytes
Using backend: pytorch

torch.Size([1961, 1433])
torch.Size([1188, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0916748046875 GB
    Memory Allocated: 0.7516417503356934  GigaBytes
Max Memory Allocated: 0.7882237434387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.2624025344848633  GigaBytes
Max Memory Allocated: 0.8620500564575195  GigaBytes

torch.Size([1966, 1433])
torch.Size([1189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1287841796875 GB
    Memory Allocated: 0.7585983276367188  GigaBytes
Max Memory Allocated: 0.8620500564575195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03435397148132324 |0.00048601627349853516 |0.1527770757675171 |0.00013065338134765625 |0.22429883480072021 |0.007817268371582031 |
----------------------------------------------------------pseudo_mini_loss sum 2.4472737312316895
Total (block generation + training)time/epoch 0.9336287975311279
Training time/epoch 0.892399787902832
Training time without block to device /epoch 0.891427755355835
Training time without total dataloading part /epoch 0.762230396270752
load block tensor time/epoch 0.06870794296264648
block to device time/epoch 0.0009720325469970703
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7007
Number of first layer input nodes during this epoch:  3927
