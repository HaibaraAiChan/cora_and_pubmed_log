main start at this time 1648430133.355687
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010747909545898438
range selection method range initialization spend 9.5367431640625e-05
time for parepare:  9.1552734375e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.001764059066772461
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  2.3365020751953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0061185359954833984
generate_one_block  0.0017771720886230469
generate_one_block  0.0014033317565917969
generate_one_block  0.001132965087890625
generate_one_block  0.001130819320678711
generate_one_block  0.0011284351348876953
generate_one_block  0.0011382102966308594
generate_one_block  0.0011603832244873047
generate_one_block  0.0010745525360107422
generate_one_block  0.0010764598846435547
generate_one_block  0.0010848045349121094
generate_one_block  0.0010259151458740234
generate_one_block  0.0010352134704589844
generate_one_block  0.0010237693786621094
generate_one_block  0.0010285377502441406
generate_one_block  0.001020193099975586
generate_one_block  0.0010144710540771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005958080291748047
gen group dst list time:  9.489059448242188e-05
time for parepare:  0.0001571178436279297
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011682510375976562
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00018143653869628906
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001761913299560547
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.005697011947631836
generate_one_block  0.0012612342834472656
generate_one_block  0.0012555122375488281
generate_one_block  0.0012574195861816406
generate_one_block  0.0012297630310058594
generate_one_block  0.001279592514038086
generate_one_block  0.0013403892517089844
generate_one_block  0.0012671947479248047
generate_one_block  0.0013058185577392578
generate_one_block  0.0016512870788574219
generate_one_block  0.0011057853698730469
generate_one_block  0.0011534690856933594
generate_one_block  0.0011224746704101562
generate_one_block  0.0010914802551269531
generate_one_block  0.001093149185180664
generate_one_block  0.0010385513305664062
generate_one_block  0.0010380744934082031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006544589996337891
gen group dst list time:  0.0001571178436279297
time for parepare:  0.0002276897430419922
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004057884216308594
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003364086151123047
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00045299530029296875
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003445148468017578
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004668235778808594
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006237030029296875
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00043392181396484375
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004963874816894531
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00029397010803222656
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0005273818969726562
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006186962127685547
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005764961242675781
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.00045490264892578125
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004935264587402344
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0002887248992919922
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00021600723266601562
----------------------check_connections_block total spend ----------------------------- 0.013077020645141602
generate_one_block  0.0015246868133544922
generate_one_block  0.0014183521270751953
generate_one_block  0.0015614032745361328
generate_one_block  0.0014452934265136719
generate_one_block  0.0014569759368896484
generate_one_block  0.0018999576568603516
generate_one_block  0.0013959407806396484
generate_one_block  0.0014629364013671875
generate_one_block  0.0012614727020263672
generate_one_block  0.001508474349975586
generate_one_block  0.0015892982482910156
generate_one_block  0.001556396484375
generate_one_block  0.0014350414276123047
generate_one_block  0.00146484375
generate_one_block  0.0012819766998291016
generate_one_block  0.001172780990600586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.018774032592773438
block generation total time  0.04292702674865723
average batch blocks generation time:  0.0026829391717910767
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06641340255737305  GigaBytes
Max Memory Allocated: 0.06641340255737305  GigaBytes

torch.Size([644, 1433])
torch.Size([205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.16360998153686523  GigaBytes
Max Memory Allocated: 0.1710987091064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.12882375717163086  GigaBytes
Max Memory Allocated: 0.28640222549438477  GigaBytes

torch.Size([541, 1433])
torch.Size([147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.20935535430908203  GigaBytes
Max Memory Allocated: 0.28640222549438477  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.12958478927612305  GigaBytes
Max Memory Allocated: 0.3320932388305664  GigaBytes

torch.Size([683, 1433])
torch.Size([220, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5506591796875 GB
    Memory Allocated: 0.24168825149536133  GigaBytes
Max Memory Allocated: 0.3320932388305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.12881231307983398  GigaBytes
Max Memory Allocated: 0.3635597229003906  GigaBytes

torch.Size([539, 1433])
torch.Size([184, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.20740413665771484  GigaBytes
Max Memory Allocated: 0.3635597229003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.12945127487182617  GigaBytes
Max Memory Allocated: 0.3635597229003906  GigaBytes

torch.Size([658, 1433])
torch.Size([238, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.24347543716430664  GigaBytes
Max Memory Allocated: 0.3635597229003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.13092947006225586  GigaBytes
Max Memory Allocated: 0.3650784492492676  GigaBytes

torch.Size([934, 1433])
torch.Size([328, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5838623046875 GB
    Memory Allocated: 0.28848743438720703  GigaBytes
Max Memory Allocated: 0.3650784492492676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6151123046875 GB
    Memory Allocated: 0.12947702407836914  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([663, 1433])
torch.Size([228, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.2318711280822754  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.1299271583557129  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([747, 1433])
torch.Size([234, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2517867088317871  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.12947320938110352  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([496, 1433])
torch.Size([143, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.1993427276611328  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.12982702255249023  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([728, 1433])
torch.Size([283, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2607555389404297  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.13009119033813477  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([777, 1433])
torch.Size([324, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2848854064941406  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.13061904907226562  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([876, 1433])
torch.Size([288, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.27309370040893555  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.12928056716918945  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([626, 1433])
torch.Size([230, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.2420191764831543  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.130615234375  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([720, 1433])
torch.Size([261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.24881410598754883  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.12827205657958984  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([438, 1433])
torch.Size([164, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.19427728652954102  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.12797117233276367  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([382, 1433])
torch.Size([96, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.1764984130859375  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05260336399078369 |0.021896541118621826 |0.10296617448329926 |0.00011196732521057129 |0.10251908004283905 |0.014721393585205078 |
----------------------------------------------------------pseudo_mini_loss sum 3.034331798553467
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14789
Number of first layer input nodes during this epoch:  10452
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.2539029121398926  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005648136138916016
range selection method range initialization spend 7.915496826171875e-05
time for parepare:  8.749961853027344e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00016427040100097656
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.0035448074340820312
generate_one_block  0.0011658668518066406
generate_one_block  0.0010786056518554688
generate_one_block  0.0010945796966552734
generate_one_block  0.001451730728149414
generate_one_block  0.0010709762573242188
generate_one_block  0.0010912418365478516
generate_one_block  0.0010578632354736328
generate_one_block  0.001066446304321289
generate_one_block  0.0010716915130615234
generate_one_block  0.0010724067687988281
generate_one_block  0.0010614395141601562
generate_one_block  0.0010678768157958984
generate_one_block  0.0010526180267333984
generate_one_block  0.001049041748046875
generate_one_block  0.0010464191436767578
generate_one_block  0.0010132789611816406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006208419799804688
gen group dst list time:  0.00010776519775390625
time for parepare:  0.00019621849060058594
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00016188621520996094
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  9.655952453613281e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00016260147094726562
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00013113021850585938
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011706352233886719
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.034706115722656e-05
----------------------check_connections_block total spend ----------------------------- 0.005953073501586914
generate_one_block  0.0013265609741210938
generate_one_block  0.0011577606201171875
generate_one_block  0.0013303756713867188
generate_one_block  0.0011849403381347656
generate_one_block  0.0011932849884033203
generate_one_block  0.0012810230255126953
generate_one_block  0.0011751651763916016
generate_one_block  0.0011532306671142578
generate_one_block  0.0011162757873535156
generate_one_block  0.0011126995086669922
generate_one_block  0.0011098384857177734
generate_one_block  0.0011413097381591797
generate_one_block  0.0010573863983154297
generate_one_block  0.0011374950408935547
generate_one_block  0.0011565685272216797
generate_one_block  0.0010433197021484375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007913112640380859
gen group dst list time:  0.00018739700317382812
time for parepare:  0.00023746490478515625
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00033593177795410156
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0004222393035888672
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00029397010803222656
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0007297992706298828
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.00033473968505859375
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004317760467529297
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005853176116943359
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003337860107421875
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005781650543212891
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005300045013427734
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00042057037353515625
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00041747093200683594
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006103515625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00025272369384765625
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0004322528839111328
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0006046295166015625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0002384185791015625
----------------------check_connections_block total spend ----------------------------- 0.013982295989990234
generate_one_block  0.0016713142395019531
generate_one_block  0.0013935565948486328
generate_one_block  0.0020225048065185547
generate_one_block  0.0014333724975585938
generate_one_block  0.0014576911926269531
generate_one_block  0.0016417503356933594
generate_one_block  0.0013585090637207031
generate_one_block  0.0016224384307861328
generate_one_block  0.0016248226165771484
generate_one_block  0.001550436019897461
generate_one_block  0.0014331340789794922
generate_one_block  0.0016543865203857422
generate_one_block  0.0012459754943847656
generate_one_block  0.0014591217041015625
generate_one_block  0.0016460418701171875
generate_one_block  0.001230001449584961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.2539029121398926  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

connection checking time:  0.01993536949157715
block generation total time  0.043122291564941406
average batch blocks generation time:  0.002695143222808838
block dataloader generation time/epoch 0.130845308303833
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.25542211532592773  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

torch.Size([668, 1433])
torch.Size([228, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.35768985748291016  GigaBytes
Max Memory Allocated: 0.40883350372314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.2539501190185547  GigaBytes
Max Memory Allocated: 0.4799065589904785  GigaBytes

torch.Size([393, 1433])
torch.Size([139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.3151736259460449  GigaBytes
Max Memory Allocated: 0.4799065589904785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.25747108459472656  GigaBytes
Max Memory Allocated: 0.4799065589904785  GigaBytes

torch.Size([1042, 1433])
torch.Size([394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.4412059783935547  GigaBytes
Max Memory Allocated: 0.4799065589904785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.25452327728271484  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([500, 1433])
torch.Size([156, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.3310985565185547  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.2551136016845703  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([610, 1433])
torch.Size([200, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.3576068878173828  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.25608348846435547  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([791, 1433])
torch.Size([299, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.39632558822631836  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.2551107406616211  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([550, 1433])
torch.Size([157, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.3321390151977539  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.25639867782592773  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([850, 1433])
torch.Size([266, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.39600324630737305  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25565433502197266  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([711, 1433])
torch.Size([264, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3802914619445801  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25530004501342773  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([645, 1433])
torch.Size([199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3533201217651367  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2547760009765625  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([547, 1433])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3514542579650879  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25638866424560547  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([848, 1433])
torch.Size([300, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.40143680572509766  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25377845764160156  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([361, 1433])
torch.Size([134, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.30606603622436523  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25513458251953125  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([614, 1433])
torch.Size([210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3587779998779297  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2562127113342285  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([815, 1433])
torch.Size([299, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.4013481140136719  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25376224517822266  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

torch.Size([358, 1433])
torch.Size([125, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.30614614486694336  GigaBytes
Max Memory Allocated: 0.5608601570129395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05201873183250427 |0.00041840970516204834 |0.07233455777168274 |0.00011113286018371582 |0.09562692046165466 |0.006470918655395508 |
----------------------------------------------------------pseudo_mini_loss sum 2.3864288330078125
Total (block generation + training)time/epoch 3.728656053543091
Training time/epoch 3.5975732803344727
Training time without block to device /epoch 3.59087872505188
Training time without total dataloading part /epoch 2.6956326961517334
load block tensor time/epoch 0.8322997093200684
block to device time/epoch 0.0066945552825927734
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14654
Number of first layer input nodes during this epoch:  10303
