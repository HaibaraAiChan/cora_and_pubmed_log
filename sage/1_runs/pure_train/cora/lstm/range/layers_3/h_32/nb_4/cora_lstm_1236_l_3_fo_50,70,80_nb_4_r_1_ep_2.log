main start at this time 1648430268.7223022
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009741783142089844
range selection method range initialization spend 9.512901306152344e-05
time for parepare:  7.748603820800781e-05
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0016105175018310547
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  9.298324584960938e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.079673767089844e-05
----------------------check_connections_block total spend ----------------------------- 0.003094911575317383
generate_one_block  0.0016894340515136719
generate_one_block  0.0013451576232910156
generate_one_block  0.001337289810180664
generate_one_block  0.0013022422790527344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005867481231689453
gen group dst list time:  9.775161743164062e-05
time for parepare:  0.000179290771484375
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004622936248779297
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005609989166259766
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006170272827148438
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0004570484161376953
----------------------check_connections_block total spend ----------------------------- 0.003986358642578125
generate_one_block  0.0017933845520019531
generate_one_block  0.0019276142120361328
generate_one_block  0.0019421577453613281
generate_one_block  0.0017666816711425781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006823539733886719
gen group dst list time:  0.00010323524475097656
time for parepare:  0.0002186298370361328
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0015087127685546875
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0017964839935302734
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0017948150634765625
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.001430511474609375
----------------------check_connections_block total spend ----------------------------- 0.010431766510009766
generate_one_block  0.002963542938232422
generate_one_block  0.0027647018432617188
generate_one_block  0.0025701522827148438
generate_one_block  0.0021910667419433594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.01441812515258789
block generation total time  0.017919301986694336
average batch blocks generation time:  0.004479825496673584
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07106208801269531  GigaBytes
Max Memory Allocated: 0.07106208801269531  GigaBytes

torch.Size([1510, 1433])
torch.Size([679, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5975341796875 GB
    Memory Allocated: 0.38753509521484375  GigaBytes
Max Memory Allocated: 0.4115123748779297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.1346602439880371  GigaBytes
Max Memory Allocated: 0.5058932304382324  GigaBytes

torch.Size([1628, 1433])
torch.Size([821, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.5087294578552246  GigaBytes
Max Memory Allocated: 0.5370306968688965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.13450336456298828  GigaBytes
Max Memory Allocated: 0.6251797676086426  GigaBytes

torch.Size([1598, 1433])
torch.Size([836, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.5093302726745605  GigaBytes
Max Memory Allocated: 0.6251797676086426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.13330650329589844  GigaBytes
Max Memory Allocated: 0.6254124641418457  GigaBytes

torch.Size([1376, 1433])
torch.Size([691, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.43358325958251953  GigaBytes
Max Memory Allocated: 0.6254124641418457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04498851299285889 |0.08585333824157715 |0.2886222004890442 |0.0001423358917236328 |0.36990559101104736 |0.009872198104858398 |
----------------------------------------------------------pseudo_mini_loss sum 2.71189284324646
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9874
Number of first layer input nodes during this epoch:  6112
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.2592792510986328  GigaBytes
Max Memory Allocated: 0.6254124641418457  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006241798400878906
range selection method range initialization spend 7.915496826171875e-05
time for parepare:  8.940696716308594e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  9.250640869140625e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00014543533325195312Using backend: pytorch

mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.510185241699219e-05
----------------------check_connections_block total spend ----------------------------- 0.0016276836395263672
generate_one_block  0.0014522075653076172
generate_one_block  0.0013861656188964844
generate_one_block  0.0013418197631835938
generate_one_block  0.0013282299041748047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006005764007568359
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.00019097328186035156
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005893707275390625
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0006091594696044922
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005297660827636719
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.000560760498046875
----------------------check_connections_block total spend ----------------------------- 0.004350900650024414
generate_one_block  0.0020422935485839844
generate_one_block  0.0020134449005126953
generate_one_block  0.0018968582153320312
generate_one_block  0.0019335746765136719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006926059722900391
gen group dst list time:  0.00011467933654785156
time for parepare:  0.0002415180206298828
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0018074512481689453
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002655982971191406
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.0018167495727539062
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0017125606536865234
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.0017857551574707031
----------------------check_connections_block total spend ----------------------------- 0.01129913330078125
generate_one_block  0.003395557403564453
generate_one_block  0.0027170181274414062
generate_one_block  0.0026307106018066406
generate_one_block  0.0025167465209960938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.2592792510986328  GigaBytes
Max Memory Allocated: 0.6254124641418457  GigaBytes

connection checking time:  0.015650033950805664
block generation total time  0.019146203994750977
average batch blocks generation time:  0.004786550998687744
block dataloader generation time/epoch 0.07154202461242676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.26090097427368164  GigaBytes
Max Memory Allocated: 0.6254124641418457  GigaBytes

torch.Size([1688, 1433])
torch.Size([847, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9158935546875 GB
    Memory Allocated: 0.6374611854553223  GigaBytes
Max Memory Allocated: 0.6661872863769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.2608966827392578  GigaBytes
Max Memory Allocated: 0.753697395324707  GigaBytes

torch.Size([1687, 1433])
torch.Size([810, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6370539665222168  GigaBytes
Max Memory Allocated: 0.753697395324707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2608981132507324  GigaBytes
Max Memory Allocated: 0.753697395324707  GigaBytes

torch.Size([1600, 1433])
torch.Size([766, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6152372360229492  GigaBytes
Max Memory Allocated: 0.753697395324707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2604398727416992  GigaBytes
Max Memory Allocated: 0.753697395324707  GigaBytes

torch.Size([1602, 1433])
torch.Size([824, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.6224894523620605  GigaBytes
Max Memory Allocated: 0.753697395324707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0446963906288147 |0.0006780028343200684 |0.18102288246154785 |0.0001271367073059082 |0.38724273443222046 |0.006530284881591797 |
----------------------------------------------------------pseudo_mini_loss sum 2.3795955181121826
Total (block generation + training)time/epoch 2.592820405960083
Training time/epoch 2.5209763050079346
Training time without block to device /epoch 2.5182642936706543
Training time without total dataloading part /epoch 2.2801012992858887
load block tensor time/epoch 0.1787855625152588
block to device time/epoch 0.0027120113372802734
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10569
Number of first layer input nodes during this epoch:  6577
