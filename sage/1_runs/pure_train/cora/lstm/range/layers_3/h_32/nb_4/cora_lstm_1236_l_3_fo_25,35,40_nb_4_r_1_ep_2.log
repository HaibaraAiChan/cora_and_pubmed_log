main start at this time 1648430108.4780118
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001386404037475586
range selection method range initialization spend 0.00010728836059570312
time for parepare:  6.246566772460938e-05
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.002343893051147461
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.14984130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0035505294799804688
generate_one_block  0.0013082027435302734
generate_one_block  0.001096963882446289
generate_one_block  0.0010838508605957031
generate_one_block  0.0010521411895751953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004968643188476562
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0001361370086669922
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00036716461181640625
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004200935363769531
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00046133995056152344
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00032639503479003906
----------------------check_connections_block total spend ----------------------------- 0.0030515193939208984
generate_one_block  0.0014276504516601562
generate_one_block  0.0014977455139160156
generate_one_block  0.0015788078308105469
generate_one_block  0.0013928413391113281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005602836608886719
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.0001709461212158203
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0010373592376708984
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0012297630310058594
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0012662410736083984
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0009531974792480469
----------------------check_connections_block total spend ----------------------------- 0.007339000701904297
generate_one_block  0.0027370452880859375
generate_one_block  0.0024504661560058594
generate_one_block  0.0025298595428466797
generate_one_block  0.002000570297241211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.010390520095825195
block generation total time  0.015614986419677734
average batch blocks generation time:  0.0039037466049194336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07054710388183594  GigaBytes
Max Memory Allocated: 0.07054710388183594  GigaBytes

torch.Size([1414, 1433])
torch.Size([626, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.3485574722290039  GigaBytes
Max Memory Allocated: 0.3701200485229492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.13405895233154297  GigaBytes
Max Memory Allocated: 0.46648168563842773  GigaBytes

torch.Size([1516, 1433])
torch.Size([752, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6990966796875 GB
    Memory Allocated: 0.4658632278442383  GigaBytes
Max Memory Allocated: 0.4911489486694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.134002685546875  GigaBytes
Max Memory Allocated: 0.5815906524658203  GigaBytes

torch.Size([1505, 1433])
torch.Size([773, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.47531843185424805  GigaBytes
Max Memory Allocated: 0.5815906524658203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.1325535774230957  GigaBytes
Max Memory Allocated: 0.5905957221984863  GigaBytes

torch.Size([1236, 1433])
torch.Size([596, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8280029296875 GB
    Memory Allocated: 0.3831915855407715  GigaBytes
Max Memory Allocated: 0.5905957221984863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04709106683731079 |0.08589345216751099 |0.22555840015411377 |0.00014275312423706055 |0.1561012864112854 |0.013239145278930664 |
----------------------------------------------------------pseudo_mini_loss sum 2.7117929458618164
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9153
Number of first layer input nodes during this epoch:  5671
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.25851869583129883  GigaBytes
Max Memory Allocated: 0.5905957221984863  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046634674072265625
range selection method range initialization spend 6.151199340820312e-05
time for parepare:  6.318092346191406e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation: Using backend: pytorch
 0.00010633468627929688
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.008148193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.0012595653533935547
generate_one_block  0.0011560916900634766
generate_one_block  0.0010647773742675781
generate_one_block  0.001039266586303711
generate_one_block  0.001035451889038086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004792213439941406
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.00014019012451171875
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0004055500030517578
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003724098205566406
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003783702850341797
----------------------check_connections_block total spend ----------------------------- 0.003156900405883789
generate_one_block  0.001504659652709961
generate_one_block  0.0014979839324951172
generate_one_block  0.0014293193817138672
generate_one_block  0.0014562606811523438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005362033843994141
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0011713504791259766
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0012044906616210938
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011296272277832031
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0011432170867919922
----------------------check_connections_block total spend ----------------------------- 0.0075588226318359375
generate_one_block  0.002567768096923828
generate_one_block  0.002461671829223633
generate_one_block  0.0025353431701660156
generate_one_block  0.002349376678466797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.25851869583129883  GigaBytes
Max Memory Allocated: 0.5905957221984863  GigaBytes

connection checking time:  0.010715723037719727
block generation total time  0.015802383422851562
average batch blocks generation time:  0.003950595855712891
block dataloader generation time/epoch 0.05002903938293457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.2602972984313965  GigaBytes
Max Memory Allocated: 0.5905957221984863  GigaBytes

torch.Size([1576, 1433])
torch.Size([759, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.5924434661865234  GigaBytes
Max Memory Allocated: 0.6178689002990723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.26039552688598633  GigaBytes
Max Memory Allocated: 0.7081751823425293  GigaBytes

torch.Size([1594, 1433])
torch.Size([757, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.5982198715209961  GigaBytes
Max Memory Allocated: 0.7081751823425293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.26029539108276367  GigaBytes
Max Memory Allocated: 0.7136702537536621  GigaBytes

torch.Size([1497, 1433])
torch.Size([696, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.5752506256103516  GigaBytes
Max Memory Allocated: 0.7136702537536621  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.2597508430480957  GigaBytes
Max Memory Allocated: 0.7136702537536621  GigaBytes

torch.Size([1474, 1433])
torch.Size([728, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.5748038291931152  GigaBytes
Max Memory Allocated: 0.7136702537536621  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04676300287246704 |0.0004019737243652344 |0.11195290088653564 |0.00011414289474487305 |0.16000813245773315 |0.01022648811340332 |
----------------------------------------------------------pseudo_mini_loss sum 2.3027331829071045
Total (block generation + training)time/epoch 1.3940000534057617
Training time/epoch 1.3436644077301025
Training time without block to device /epoch 1.3420565128326416
Training time without total dataloading part /epoch 1.098527193069458
load block tensor time/epoch 0.18705201148986816
block to device time/epoch 0.0016078948974609375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9826
Number of first layer input nodes during this epoch:  6141
