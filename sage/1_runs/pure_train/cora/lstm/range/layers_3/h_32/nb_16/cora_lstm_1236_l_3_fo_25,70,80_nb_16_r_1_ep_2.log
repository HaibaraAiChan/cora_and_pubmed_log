main start at this time 1648430239.6748025
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014286041259765625
range selection method range initialization spend 0.0001354217529296875
time for parepare:  0.00012040138244628906
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0022470951080322266
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  2.2649765014648438e-05
----------------------check_connections_block total spend ----------------------------- 0.006952524185180664
generate_one_block  0.0015625953674316406
generate_one_block  0.0014526844024658203
generate_one_block  0.001375436782836914
generate_one_block  0.0013232231140136719
generate_one_block  0.0011599063873291016
generate_one_block  0.001168966293334961
generate_one_block  0.0011692047119140625
generate_one_block  0.0011565685272216797
generate_one_block  0.0010869503021240234
generate_one_block  0.0010874271392822266
generate_one_block  0.0010542869567871094
generate_one_block  0.0011184215545654297
generate_one_block  0.0010612010955810547
generate_one_block  0.0010509490966796875
generate_one_block  0.0010399818420410156
generate_one_block  0.0010466575622558594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007007122039794922
gen group dst list time:  0.00010204315185546875
time for parepare:  0.00016832351684570312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00013256072998046875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011587142944335938
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00015282630920410156
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002224445343017578
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00011539459228515625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00020432472229003906
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00011301040649414062
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.581710815429688e-05
----------------------check_connections_block total spend ----------------------------- 0.006670713424682617
generate_one_block  0.0012824535369873047
generate_one_block  0.0012562274932861328
generate_one_block  0.0012938976287841797
generate_one_block  0.0012559890747070312
generate_one_block  0.0013194084167480469
generate_one_block  0.001407623291015625
generate_one_block  0.0012831687927246094
generate_one_block  0.0013127326965332031
generate_one_block  0.0012645721435546875
generate_one_block  0.001352071762084961
generate_one_block  0.0012791156768798828
generate_one_block  0.0012409687042236328
generate_one_block  0.001196146011352539
generate_one_block  0.0012054443359375
generate_one_block  0.001157999038696289
generate_one_block  0.001146078109741211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007815361022949219
gen group dst list time:  0.00018405914306640625
time for parepare:  0.0002243518829345703
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004203319549560547
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00034046173095703125
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005104541778564453
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003769397735595703
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005476474761962891
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0007510185241699219
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0004508495330810547
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005056858062744141
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0006413459777832031
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0006721019744873047
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006144046783447266
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.000514984130859375
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005795955657958984
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003330707550048828
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00026988983154296875
----------------------check_connections_block total spend ----------------------------- 0.01506352424621582
generate_one_block  0.0016546249389648438
generate_one_block  0.001524209976196289
generate_one_block  0.0017132759094238281
generate_one_block  0.001451253890991211
generate_one_block  0.0016045570373535156
generate_one_block  0.0021855831146240234
generate_one_block  0.0014982223510742188
generate_one_block  0.0015742778778076172
generate_one_block  0.0014233589172363281
generate_one_block  0.0017549991607666016
generate_one_block  0.0017528533935546875
generate_one_block  0.0017104148864746094
generate_one_block  0.0015878677368164062
generate_one_block  0.0016684532165527344
generate_one_block  0.0014400482177734375
generate_one_block  0.0013325214385986328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06296253204345703  GigaBytes
Max Memory Allocated: 0.06296253204345703  GigaBytes

connection checking time:  0.021734237670898438
block generation total time  0.04613041877746582
average batch blocks generation time:  0.0028831511735916138
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06645727157592773  GigaBytes
Max Memory Allocated: 0.06645727157592773  GigaBytes

torch.Size([652, 1433])
torch.Size([210, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.16554975509643555  GigaBytes
Max Memory Allocated: 0.17319536209106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.12883996963500977  GigaBytes
Max Memory Allocated: 0.2883009910583496  GigaBytes

torch.Size([544, 1433])
torch.Size([147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4881591796875 GB
    Memory Allocated: 0.20937156677246094  GigaBytes
Max Memory Allocated: 0.2883009910583496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5506591796875 GB
    Memory Allocated: 0.1297779083251953  GigaBytes
Max Memory Allocated: 0.3321094512939453  GigaBytes

torch.Size([719, 1433])
torch.Size([246, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.2552156448364258  GigaBytes
Max Memory Allocated: 0.3321094512939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.1290745735168457  GigaBytes
Max Memory Allocated: 0.3768486976623535  GigaBytes

torch.Size([588, 1433])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.21663188934326172  GigaBytes
Max Memory Allocated: 0.3768486976623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.12981176376342773  GigaBytes
Max Memory Allocated: 0.3768486976623535  GigaBytes

torch.Size([725, 1433])
torch.Size([286, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5955810546875 GB
    Memory Allocated: 0.2634096145629883  GigaBytes
Max Memory Allocated: 0.3768486976623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.13175535202026367  GigaBytes
Max Memory Allocated: 0.38460874557495117  GigaBytes

torch.Size([1088, 1433])
torch.Size([411, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.32478904724121094  GigaBytes
Max Memory Allocated: 0.38460874557495117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.12953567504882812  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([674, 1433])
torch.Size([233, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.23381280899047852  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6639404296875 GB
    Memory Allocated: 0.12993288040161133  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([748, 1433])
torch.Size([239, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.2531733512878418  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.12898921966552734  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([572, 1433])
torch.Size([176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.21135187149047852  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.13054513931274414  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([862, 1433])
torch.Size([361, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.2916374206542969  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.13032293319702148  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([820, 1433])
torch.Size([355, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.2971334457397461  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.13083791732788086  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([917, 1433])
torch.Size([315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.2835702896118164  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.13031721115112305  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([680, 1433])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.2551565170288086  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.13030385971069336  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([817, 1433])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.27339649200439453  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.12862539291381836  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([504, 1433])
torch.Size([203, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.20563125610351562  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.12843656539916992  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([469, 1433])
torch.Size([131, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.19183731079101562  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05253252387046814 |0.023167684674263 |0.10814118385314941 |0.00011855363845825195 |0.11209771037101746 |0.011907577514648438 |
----------------------------------------------------------pseudo_mini_loss sum 3.035167932510376
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16243
Number of first layer input nodes during this epoch:  11379
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.25437021255493164  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005660057067871094
range selection method range initialization spend 8.034706115722656e-05
time for parepare:  8.58306884765625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.7881393432617188e-05
----------------------check_connections_block total spend ----------------------------- 0.0034427642822265625
generate_one_block  0.0012433528900146484
generate_one_block  0.001100301742553711
generate_one_block  0.0011136531829833984
generate_one_block  0.0014483928680419922
generate_one_block  0.0010869503021240234
generate_one_block  0.0011105537414550781
generate_one_block  0.0010762214660644531
generate_one_block  0.0010879039764404297
generate_one_block  0.0010776519775390625
generate_one_block  0.0010836124420166016
generate_one_block  0.0010826587677001953
generate_one_block  0.001077413558959961
generate_one_block  0.0010919570922851562
generate_one_block  0.0010743141174316406
generate_one_block  0.0010898113250732422
generate_one_block  0.0010733604431152344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006346702575683594
gen group dst list time:  0.00010776519775390625
time for parepare:  0.00018668174743652344
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00015282630920410156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002601146697998047
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012135505676269531
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00012421607971191406
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00019598007202148438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00016117095947265625
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00015044212341308594
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00014448165893554688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00013899803161621094
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00018405914306640625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001285076141357422
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001876354217529297
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  8.463859558105469e-05
----------------------check_connections_block total spend ----------------------------- 0.006224393844604492
generate_one_block  0.0013875961303710938
generate_one_block  0.001176595687866211
generate_one_block  0.0014264583587646484
generate_one_block  0.0012140274047851562
generate_one_block  0.0012176036834716797
generate_one_block  0.0013282299041748047
generate_one_block  0.0011129379272460938
generate_one_block  0.0011615753173828125
generate_one_block  0.0011644363403320312
generate_one_block  0.0011320114135742188
generate_one_block  0.0011229515075683594
generate_one_block  0.0011935234069824219
generate_one_block  0.0010845661163330078
generate_one_block  0.0011756420135498047
generate_one_block  0.0011911392211914062
generate_one_block  0.0010750293731689453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007216930389404297
gen group dst list time:  0.0001938343048095703
time for parepare:  0.0002396106719970703
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005319118499755859
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0008389949798583984
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00043773651123046875
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0006287097930908203
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00039315223693847656
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0005853176116943359
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006003379821777344
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.00047278404235839844
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0004239082336425781
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0006959438323974609
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00029921531677246094
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004718303680419922
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.000652313232421875
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00028634071350097656
----------------------check_connections_block total spend ----------------------------- 0.015157222747802734
generate_one_block  0.0018019676208496094
generate_one_block  0.0014133453369140625
generate_one_block  0.0019483566284179688
generate_one_block  0.0014472007751464844
generate_one_block  0.001477956771850586
generate_one_block  0.0016772747039794922
generate_one_block  0.0014410018920898438
generate_one_block  0.0016050338745117188
generate_one_block  0.001665353775024414
generate_one_block  0.0016129016876220703
generate_one_block  0.0014350414276123047
generate_one_block  0.0017924308776855469
generate_one_block  0.0013051033020019531
generate_one_block  0.0015861988067626953
generate_one_block  0.0017213821411132812
generate_one_block  0.0012819766998291016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.25437021255493164  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

connection checking time:  0.021381616592407227
block generation total time  0.04437685012817383
average batch blocks generation time:  0.0027735531330108643
block dataloader generation time/epoch 0.13470101356506348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.25615644454956055  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

torch.Size([805, 1433])
torch.Size([293, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.3848705291748047  GigaBytes
Max Memory Allocated: 0.44436073303222656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.25396108627319336  GigaBytes
Max Memory Allocated: 0.5064692497253418  GigaBytes

torch.Size([395, 1433])
torch.Size([139, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.3151845932006836  GigaBytes
Max Memory Allocated: 0.5064692497253418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.2578163146972656  GigaBytes
Max Memory Allocated: 0.5064692497253418  GigaBytes

torch.Size([1114, 1433])
torch.Size([479, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.4671921730041504  GigaBytes
Max Memory Allocated: 0.5064692497253418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25478172302246094  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([548, 1433])
torch.Size([188, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.34825944900512695  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25513458251953125  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([614, 1433])
torch.Size([205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3592343330383301  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2561922073364258  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([811, 1433])
torch.Size([326, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.4062047004699707  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25518083572387695  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([623, 1433])
torch.Size([189, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3463726043701172  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2563505172729492  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([841, 1433])
torch.Size([266, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.39478588104248047  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2560896873474121  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([792, 1433])
torch.Size([311, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.39917659759521484  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25634765625  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([727, 1433])
torch.Size([229, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.36621999740600586  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25476551055908203  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([545, 1433])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3513965606689453  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2570204734802246  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([966, 1433])
torch.Size([371, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.4298591613769531  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2541799545288086  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([436, 1433])
torch.Size([163, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3177361488342285  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25528526306152344  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([642, 1433])
torch.Size([233, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.36754322052001953  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25652313232421875  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([873, 1433])
torch.Size([327, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.4115719795227051  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.25397682189941406  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

torch.Size([398, 1433])
torch.Size([155, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.31408071517944336  GigaBytes
Max Memory Allocated: 0.5860514640808105  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05197185277938843 |0.0004169940948486328 |0.0779431164264679 |0.00029397010803222656 |0.10810132324695587 |0.006237983703613281 |
----------------------------------------------------------pseudo_mini_loss sum 2.277700662612915
Total (block generation + training)time/epoch 4.023620843887329
Training time/epoch 3.8885574340820312
Training time without block to device /epoch 3.881885528564453
Training time without total dataloading part /epoch 2.987652540206909
load block tensor time/epoch 0.8315496444702148
block to device time/epoch 0.006671905517578125
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15985
Number of first layer input nodes during this epoch:  11130
