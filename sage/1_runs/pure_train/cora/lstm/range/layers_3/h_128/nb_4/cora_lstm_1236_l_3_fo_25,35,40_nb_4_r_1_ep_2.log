main start at this time 1648430556.3145704
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009734630584716797
range selection method range initialization spend 9.703636169433594e-05
time for parepare:  7.677078247070312e-05
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.001615762710571289
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.771087646484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0030639171600341797
generate_one_block  0.001687765121459961
generate_one_block  0.0013339519500732422
generate_one_block  0.001333475112915039
generate_one_block  0.0013146400451660156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005955696105957031
gen group dst list time:  9.846687316894531e-05
time for parepare:  0.0001850128173828125
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005602836608886719
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003991127014160156
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00048804283142089844
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005223751068115234
----------------------check_connections_block total spend ----------------------------- 0.0038080215454101562
generate_one_block  0.0019021034240722656
generate_one_block  0.0016827583312988281
generate_one_block  0.0018012523651123047
generate_one_block  0.0018448829650878906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006814002990722656
gen group dst list time:  0.00011301040649414062
time for parepare:  0.0002269744873046875
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0016102790832519531
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0013489723205566406
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0014388561248779297
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0015933513641357422
----------------------check_connections_block total spend ----------------------------- 0.009719133377075195
generate_one_block  0.003133535385131836
generate_one_block  0.002529621124267578
generate_one_block  0.0022745132446289062
generate_one_block  0.002335786819458008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.013527154922485352
block generation total time  0.017504453659057617
average batch blocks generation time:  0.004376113414764404
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07360601425170898  GigaBytes
Max Memory Allocated: 0.07360601425170898  GigaBytes

torch.Size([1599, 1433])
torch.Size([768, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6326904296875 GB
    Memory Allocated: 0.4239363670349121  GigaBytes
Max Memory Allocated: 0.44070863723754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.1379837989807129  GigaBytes
Max Memory Allocated: 0.5325889587402344  GigaBytes

torch.Size([1479, 1433])
torch.Size([613, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.42419004440307617  GigaBytes
Max Memory Allocated: 0.5325889587402344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.13751792907714844  GigaBytes
Max Memory Allocated: 0.5350360870361328  GigaBytes

torch.Size([1391, 1433])
torch.Size([663, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.44267892837524414  GigaBytes
Max Memory Allocated: 0.5350360870361328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.13832616806030273  GigaBytes
Max Memory Allocated: 0.5513343811035156  GigaBytes

torch.Size([1542, 1433])
torch.Size([765, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.4766268730163574  GigaBytes
Max Memory Allocated: 0.5513343811035156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04703599214553833 |0.08815747499465942 |0.22904640436172485 |0.0001519322395324707 |0.15947991609573364 |0.013511180877685547 |
----------------------------------------------------------pseudo_mini_loss sum 3.035153388977051
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9552
Number of first layer input nodes during this epoch:  6011
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.2684340476989746  GigaBytes
Max Memory Allocated: 0.5837545394897461  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004963874816894531
range selection method range initialization spend 6.461143493652344e-05
time for parepare:  7.104873657226562e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011491775512695312Using backend: pytorch

mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.008148193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.001375436782836914
generate_one_block  0.0012140274047851562
generate_one_block  0.0011532306671142578
generate_one_block  0.0011188983917236328
generate_one_block  0.005699872970581055
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005102157592773438
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.0001575946807861328
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004215240478515625
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0005390644073486328
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0003867149353027344
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00040268898010253906
----------------------check_connections_block total spend ----------------------------- 0.003481149673461914
generate_one_block  0.0016040802001953125
generate_one_block  0.0017194747924804688
generate_one_block  0.0015437602996826172
generate_one_block  0.001554250717163086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005812644958496094
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.00018548965454101562
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0011742115020751953
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0014469623565673828
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0011522769927978516
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0012164115905761719
----------------------check_connections_block total spend ----------------------------- 0.008227109909057617
generate_one_block  0.0025277137756347656
generate_one_block  0.0032570362091064453
generate_one_block  0.0024242401123046875
generate_one_block  0.002294778823852539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.2684340476989746  GigaBytes
Max Memory Allocated: 0.5837545394897461  GigaBytes

connection checking time:  0.011708259582519531
block generation total time  0.016925334930419922
average batch blocks generation time:  0.0042313337326049805
block dataloader generation time/epoch 0.05699014663696289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.26771974563598633  GigaBytes
Max Memory Allocated: 0.5837545394897461  GigaBytes

torch.Size([1420, 1433])
torch.Size([664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5692253112792969  GigaBytes
Max Memory Allocated: 0.5837545394897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.2686944007873535  GigaBytes
Max Memory Allocated: 0.6778421401977539  GigaBytes

torch.Size([1601, 1433])
torch.Size([839, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9530029296875 GB
    Memory Allocated: 0.6412343978881836  GigaBytes
Max Memory Allocated: 0.6778421401977539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2677187919616699  GigaBytes
Max Memory Allocated: 0.7460079193115234  GigaBytes

torch.Size([1384, 1433])
torch.Size([660, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.5576653480529785  GigaBytes
Max Memory Allocated: 0.7460079193115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.26791810989379883  GigaBytes
Max Memory Allocated: 0.7460079193115234  GigaBytes

torch.Size([1457, 1433])
torch.Size([671, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.5791926383972168  GigaBytes
Max Memory Allocated: 0.7460079193115234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04633164405822754 |0.0004405379295349121 |0.11801338195800781 |0.00012385845184326172 |0.15821200609207153 |0.009797811508178711 |
----------------------------------------------------------pseudo_mini_loss sum 2.4410243034362793
Total (block generation + training)time/epoch 1.4171054363250732
Training time/epoch 1.3597996234893799
Training time without block to device /epoch 1.3580374717712402
Training time without total dataloading part /epoch 1.1151947975158691
load block tensor time/epoch 0.18532657623291016
block to device time/epoch 0.0017621517181396484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9432
Number of first layer input nodes during this epoch:  5862
