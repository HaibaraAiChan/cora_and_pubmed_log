main start at this time 1648430651.295393
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014996528625488281
range selection method range initialization spend 0.00011348724365234375
time for parepare:  6.151199340820312e-05
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0022881031036376953
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.0031630992889404297
generate_one_block  0.0015861988067626953
generate_one_block  0.0011718273162841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005033016204833984
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.00014710426330566406
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0006773471832275391
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0007233619689941406
----------------------check_connections_block total spend ----------------------------- 0.002557039260864258
generate_one_block  0.0018572807312011719
generate_one_block  0.0019290447235107422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005893707275390625
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.0001800060272216797
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0003209114074707031
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0017652511596679688
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0017848014831542969
----------------------check_connections_block total spend ----------------------------- 0.005664348602294922
generate_one_block  0.0030570030212402344
generate_one_block  0.0030524730682373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.00822138786315918
block generation total time  0.009895801544189453
average batch blocks generation time:  0.0049479007720947266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07554197311401367  GigaBytes
Max Memory Allocated: 0.07554197311401367  GigaBytes

torch.Size([1958, 1433])
torch.Size([1156, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.5744509696960449  GigaBytes
Max Memory Allocated: 0.5963387489318848  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.14037799835205078  GigaBytes
Max Memory Allocated: 0.6727242469787598  GigaBytes

torch.Size([1922, 1433])
torch.Size([1176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9471435546875 GB
    Memory Allocated: 0.6424150466918945  GigaBytes
Max Memory Allocated: 0.6727242469787598  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.037531375885009766 |0.17585813999176025 |0.39341890811920166 |0.0001857280731201172 |0.22798144817352295 |0.01030588150024414 |
----------------------------------------------------------pseudo_mini_loss sum 2.8516740798950195
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6911
Number of first layer input nodes during this epoch:  3880
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.2705211639404297  GigaBytes
Max Memory Allocated: 0.7375516891479492  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004899501800537109
range selection method range initialization spend 6.198883056640625e-05
time for parepare:  6.532669067382812e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001385211944580078
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00010967254638671875
----------------------check_connections_block total spend ----------------------------- 0.0008873939514160156
generate_one_block  0.0013833045959472656
generate_one_block  0.0012240409851074219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005054473876953125
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.000156402587890625
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0007696151733398438
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0006830692291259766
----------------------check_connections_block total spend ----------------------------- 0.0027120113372802734
generate_one_block  0.0020716190338134766
generate_one_block  0.0019083023071289062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005764961242675781
gen group dst list time:  0.0001804828643798828
time for parepare:  0.00018548965454101562
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.0003514289855957031
mini_batch_src_global generation:  0.00016689300537109375
r_  generation:  0.0019757747650146484
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.00024247169494628906
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0017862319946289062
----------------------check_connections_block total spend ----------------------------- 0.005949258804321289
generate_one_block  0.0035037994384765625
generate_one_block  0.003192901611328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.2705211639404297  GigaBytes
Max Memory Allocated: 0.7375516891479492  GigaBytes

connection checking time:  0.008661270141601562
block generation total time  0.01067662239074707
average batch blocks generation time:  0.005338311195373535
block dataloader generation time/epoch 0.03620123863220215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.2706918716430664  GigaBytes
Max Memory Allocated: 0.7375516891479492  GigaBytes
Using backend: pytorch

torch.Size([1971, 1433])
torch.Size([1268, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.8082032203674316  GigaBytes
Max Memory Allocated: 0.829646110534668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.2705092430114746  GigaBytes
Max Memory Allocated: 0.8998661041259766  GigaBytes

torch.Size([1938, 1433])
torch.Size([1134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1365966796875 GB
    Memory Allocated: 0.7615504264831543  GigaBytes
Max Memory Allocated: 0.8998661041259766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03551602363586426 |0.0004642009735107422 |0.1585153341293335 |0.00012230873107910156 |0.23121857643127441 |0.010685920715332031 |
----------------------------------------------------------pseudo_mini_loss sum 2.5971269607543945
Total (block generation + training)time/epoch 0.9590291976928711
Training time/epoch 0.9223775863647461
Training time without block to device /epoch 0.9214491844177246
Training time without total dataloading part /epoch 0.790398359298706
load block tensor time/epoch 0.07103204727172852
block to device time/epoch 0.0009284019470214844
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7014
Number of first layer input nodes during this epoch:  3909
