main start at this time 1648430716.811879
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012102127075195312
range selection method range initialization spend 9.036064147949219e-05
time for parepare:  6.031990051269531e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0012619495391845703
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.817413330078125e-05
----------------------check_connections_block total spend ----------------------------- 0.0024313926696777344
generate_one_block  0.0013375282287597656
generate_one_block  0.0010790824890136719
generate_one_block  0.0010833740234375
generate_one_block  0.0011126995086669922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005121231079101562
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004818439483642578
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00036025047302246094
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0004279613494873047
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004544258117675781
----------------------check_connections_block total spend ----------------------------- 0.0032873153686523438
generate_one_block  0.0016138553619384766
generate_one_block  0.0014400482177734375
generate_one_block  0.0015246868133544922
generate_one_block  0.0015361309051513672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006170272827148438
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.00018072128295898438
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0014142990112304688
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0012679100036621094
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.001219034194946289
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.0014379024505615234
----------------------check_connections_block total spend ----------------------------- 0.00855398178100586
generate_one_block  0.0026869773864746094
generate_one_block  0.0025110244750976562
generate_one_block  0.002452373504638672
generate_one_block  0.0024895668029785156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.011841297149658203
block generation total time  0.016254663467407227
average batch blocks generation time:  0.004063665866851807
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07411861419677734  GigaBytes
Max Memory Allocated: 0.07411861419677734  GigaBytes

torch.Size([1694, 1433])
torch.Size([865, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.47188282012939453  GigaBytes
Max Memory Allocated: 0.4909963607788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.13858556747436523  GigaBytes
Max Memory Allocated: 0.5801262855529785  GigaBytes

torch.Size([1591, 1433])
torch.Size([706, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.47481536865234375  GigaBytes
Max Memory Allocated: 0.5801262855529785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.13793087005615234  GigaBytes
Max Memory Allocated: 0.5857324600219727  GigaBytes

torch.Size([1468, 1433])
torch.Size([713, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.47351694107055664  GigaBytes
Max Memory Allocated: 0.5857324600219727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.1389179229736328  GigaBytes
Max Memory Allocated: 0.5857324600219727  GigaBytes

torch.Size([1652, 1433])
torch.Size([847, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8865966796875 GB
    Memory Allocated: 0.5202226638793945  GigaBytes
Max Memory Allocated: 0.5857324600219727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046713054180145264 |0.08609867095947266 |0.2942955493927002 |0.0001347064971923828 |0.3810346722602844 |0.009945869445800781 |
----------------------------------------------------------pseudo_mini_loss sum 3.0465548038482666
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10268
Number of first layer input nodes during this epoch:  6405
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0115966796875 GB
    Memory Allocated: 0.26903247833251953  GigaBytes
Max Memory Allocated: 0.6273250579833984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00052642822265625
range selection method range initialization spend 6.699562072753906e-05
time for parepare:  6.985664367675781e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.393692016601562e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011587142944335938Using backend: pytorch

mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  8.821487426757812e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.031990051269531e-05
----------------------check_connections_block total spend ----------------------------- 0.0013935565948486328
generate_one_block  0.0013506412506103516
generate_one_block  0.001168966293334961
generate_one_block  0.0011069774627685547
generate_one_block  0.001131296157836914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005359649658203125
gen group dst list time:  4.4345855712890625e-05
time for parepare:  0.0001614093780517578
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004363059997558594
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005164146423339844
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0003936290740966797
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004496574401855469
----------------------check_connections_block total spend ----------------------------- 0.0035157203674316406
generate_one_block  0.0016474723815917969
generate_one_block  0.0017306804656982422
generate_one_block  0.0015795230865478516
generate_one_block  0.0015554428100585938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005726814270019531
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00019979476928710938
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0013270378112792969
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0015530586242675781
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0012140274047851562
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0013289451599121094
----------------------check_connections_block total spend ----------------------------- 0.00867915153503418
generate_one_block  0.0026323795318603516
generate_one_block  0.002962350845336914
generate_one_block  0.0024890899658203125
generate_one_block  0.0024662017822265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0115966796875 GB
    Memory Allocated: 0.26903247833251953  GigaBytes
Max Memory Allocated: 0.6273250579833984  GigaBytes

connection checking time:  0.01219487190246582
block generation total time  0.017063140869140625
average batch blocks generation time:  0.004265785217285156
block dataloader generation time/epoch 0.06194281578063965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0115966796875 GB
    Memory Allocated: 0.2685093879699707  GigaBytes
Max Memory Allocated: 0.6273250579833984  GigaBytes

torch.Size([1567, 1433])
torch.Size([744, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0115966796875 GB
    Memory Allocated: 0.6193361282348633  GigaBytes
Max Memory Allocated: 0.6364235877990723  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0115966796875 GB
    Memory Allocated: 0.2691478729248047  GigaBytes
Max Memory Allocated: 0.7279057502746582  GigaBytes

torch.Size([1685, 1433])
torch.Size([910, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.6836452484130859  GigaBytes
Max Memory Allocated: 0.7279057502746582  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2685065269470215  GigaBytes
Max Memory Allocated: 0.788154125213623  GigaBytes

torch.Size([1468, 1433])
torch.Size([709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.5944504737854004  GigaBytes
Max Memory Allocated: 0.788154125213623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.2684621810913086  GigaBytes
Max Memory Allocated: 0.788154125213623  GigaBytes

torch.Size([1558, 1433])
torch.Size([732, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0233154296875 GB
    Memory Allocated: 0.6205239295959473  GigaBytes
Max Memory Allocated: 0.788154125213623  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04717069864273071 |0.0005808472633361816 |0.17561697959899902 |0.00011652708053588867 |0.374633252620697 |0.009445428848266602 |
----------------------------------------------------------pseudo_mini_loss sum 2.516669511795044
Total (block generation + training)time/epoch 2.5250463485717773
Training time/epoch 2.4628264904022217
Training time without block to device /epoch 2.460503101348877
Training time without total dataloading part /epoch 2.2109124660491943
load block tensor time/epoch 0.18868279457092285
block to device time/epoch 0.0023233890533447266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10109
Number of first layer input nodes during this epoch:  6278
