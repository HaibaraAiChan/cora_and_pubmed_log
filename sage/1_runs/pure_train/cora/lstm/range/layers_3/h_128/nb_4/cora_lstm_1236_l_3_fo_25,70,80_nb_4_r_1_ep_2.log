main start at this time 1648430662.1170259
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011968612670898438
range selection method range initialization spend 8.511543273925781e-05
time for parepare:  6.246566772460938e-05
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.001748800277709961
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.745887756347656e-05
----------------------check_connections_block total spend ----------------------------- 0.003020048141479492
generate_one_block  0.0014934539794921875
generate_one_block  0.00112152099609375
generate_one_block  0.0011065006256103516
generate_one_block  0.0010726451873779297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005009174346923828
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.00015234947204589844
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0004928112030029297
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00036597251892089844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00042748451232910156
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004405975341796875
----------------------check_connections_block total spend ----------------------------- 0.003345489501953125
generate_one_block  0.0016355514526367188
generate_one_block  0.0014374256134033203
generate_one_block  0.0014929771423339844
generate_one_block  0.0016014575958251953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005910396575927734
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.00017452239990234375
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.0014050006866455078
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0011682510375976562
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.001207113265991211
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0013446807861328125
----------------------check_connections_block total spend ----------------------------- 0.008280754089355469
generate_one_block  0.0026924610137939453
generate_one_block  0.0024030208587646484
generate_one_block  0.002422332763671875
generate_one_block  0.002457141876220703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.011626243591308594
block generation total time  0.01614236831665039
average batch blocks generation time:  0.004035592079162598
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07393550872802734  GigaBytes
Max Memory Allocated: 0.07393550872802734  GigaBytes

torch.Size([1660, 1433])
torch.Size([866, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.453707218170166  GigaBytes
Max Memory Allocated: 0.4722428321838379  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.13845109939575195  GigaBytes
Max Memory Allocated: 0.5605945587158203  GigaBytes

torch.Size([1566, 1433])
torch.Size([703, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8026123046875 GB
    Memory Allocated: 0.4570889472961426  GigaBytes
Max Memory Allocated: 0.5605945587158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.1376204490661621  GigaBytes
Max Memory Allocated: 0.5663633346557617  GigaBytes

torch.Size([1410, 1433])
torch.Size([714, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.4552297592163086  GigaBytes
Max Memory Allocated: 0.5663633346557617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.13879966735839844  GigaBytes
Max Memory Allocated: 0.5663633346557617  GigaBytes

torch.Size([1630, 1433])
torch.Size([851, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.5054993629455566  GigaBytes
Max Memory Allocated: 0.5663633346557617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04764199256896973 |0.08622598648071289 |0.24653422832489014 |0.00013715028762817383 |0.19783657789230347 |0.010965108871459961 |
----------------------------------------------------------pseudo_mini_loss sum 3.042088747024536
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10132
Number of first layer input nodes during this epoch:  6266
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.26891326904296875  GigaBytes
Max Memory Allocated: 0.6112251281738281  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005016326904296875
range selection method range initialization spend 6.747245788574219e-05
time for parepare:  7.2479248046875e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011920928955078125Using backend: pytorch

mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.8650970458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0014073848724365234
generate_one_block  0.0013110637664794922
generate_one_block  0.0011661052703857422
generate_one_block  0.0011363029479980469
generate_one_block  0.0011110305786132812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00052642822265625
gen group dst list time:  4.506111145019531e-05
time for parepare:  0.0001571178436279297
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004436969757080078
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0005347728729248047
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00040459632873535156
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004241466522216797
----------------------check_connections_block total spend ----------------------------- 0.0035347938537597656
generate_one_block  0.001650094985961914
generate_one_block  0.0017538070678710938
generate_one_block  0.001535177230834961
generate_one_block  0.0015730857849121094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005784034729003906
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.00019121170043945312
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.0012726783752441406
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0014998912811279297
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0001289844512939453
r_  generation:  0.0012085437774658203
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.001257181167602539
----------------------check_connections_block total spend ----------------------------- 0.00847172737121582
generate_one_block  0.002671480178833008
generate_one_block  0.003175020217895508
generate_one_block  0.002476930618286133
generate_one_block  0.0024154186248779297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.26891326904296875  GigaBytes
Max Memory Allocated: 0.6112251281738281  GigaBytes

connection checking time:  0.012006521224975586
block generation total time  0.017251014709472656
average batch blocks generation time:  0.004312753677368164
block dataloader generation time/epoch 0.056693077087402344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.26832056045532227  GigaBytes
Max Memory Allocated: 0.6112251281738281  GigaBytes

torch.Size([1532, 1433])
torch.Size([748, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.6044764518737793  GigaBytes
Max Memory Allocated: 0.6207723617553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9901123046875 GB
    Memory Allocated: 0.26910924911499023  GigaBytes
Max Memory Allocated: 0.7117900848388672  GigaBytes

torch.Size([1678, 1433])
torch.Size([917, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.6686854362487793  GigaBytes
Max Memory Allocated: 0.7117900848388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.26831865310668945  GigaBytes
Max Memory Allocated: 0.771796703338623  GigaBytes

torch.Size([1439, 1433])
torch.Size([710, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.576418399810791  GigaBytes
Max Memory Allocated: 0.771796703338623  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.26830530166625977  GigaBytes
Max Memory Allocated: 0.771796703338623  GigaBytes

torch.Size([1529, 1433])
torch.Size([729, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.600405216217041  GigaBytes
Max Memory Allocated: 0.771796703338623  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04658615589141846 |0.0004684925079345703 |0.1296299695968628 |0.00012105703353881836 |0.2008439302444458 |0.0063915252685546875 |
----------------------------------------------------------pseudo_mini_loss sum 2.5821313858032227
Total (block generation + training)time/epoch 1.6308012008666992
Training time/epoch 1.5738139152526855
Training time without block to device /epoch 1.5719399452209473
Training time without total dataloading part /epoch 1.3287713527679443
load block tensor time/epoch 0.18634462356567383
block to device time/epoch 0.0018739700317382812
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10018
Number of first layer input nodes during this epoch:  6178
