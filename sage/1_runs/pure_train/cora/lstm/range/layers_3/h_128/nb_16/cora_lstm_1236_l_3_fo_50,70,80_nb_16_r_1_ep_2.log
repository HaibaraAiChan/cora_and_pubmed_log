main start at this time 1648430747.9498022
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009510517120361328
range selection method range initialization spend 8.58306884765625e-05
time for parepare:  6.4849853515625e-05
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0012536048889160156
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
----------------------check_connections_block total spend ----------------------------- 0.004361867904663086
generate_one_block  0.0012230873107910156
generate_one_block  0.001138448715209961
generate_one_block  0.0010623931884765625
generate_one_block  0.0010466575622558594
generate_one_block  0.0010409355163574219
generate_one_block  0.0010631084442138672
generate_one_block  0.0010533332824707031
generate_one_block  0.0010538101196289062
generate_one_block  0.001051187515258789
generate_one_block  0.0010907649993896484
generate_one_block  0.0010428428649902344
generate_one_block  0.0010590553283691406
generate_one_block  0.0010454654693603516
generate_one_block  0.0010411739349365234
generate_one_block  0.001046895980834961
generate_one_block  0.0010461807250976562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005893707275390625
gen group dst list time:  9.560585021972656e-05
time for parepare:  0.00015473365783691406
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00018167495727539062
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00022125244140625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00014781951904296875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00013899803161621094
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00016045570373535156
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011968612670898438
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013780593872070312
----------------------check_connections_block total spend ----------------------------- 0.005944967269897461
generate_one_block  0.0012755393981933594
generate_one_block  0.0012938976287841797
generate_one_block  0.0012078285217285156
generate_one_block  0.0011472702026367188
generate_one_block  0.001115560531616211
generate_one_block  0.0011661052703857422
generate_one_block  0.0012290477752685547
generate_one_block  0.0011444091796875
generate_one_block  0.0011286735534667969
generate_one_block  0.001058340072631836
generate_one_block  0.0011022090911865234
generate_one_block  0.0011789798736572266
generate_one_block  0.001077413558959961
generate_one_block  0.0010991096496582031
generate_one_block  0.001100301742553711
generate_one_block  0.001135110855102539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006840229034423828
gen group dst list time:  0.00018072128295898438
time for parepare:  0.0002307891845703125
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0006730556488037109
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0007543563842773438
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005536079406738281
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003211498260498047
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00026416778564453125
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00046515464782714844
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0006530284881591797
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005388259887695312
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0006206035614013672
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0003998279571533203
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005319118499755859
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0007317066192626953
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0004584789276123047
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004863739013671875
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005285739898681641
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004253387451171875
----------------------check_connections_block total spend ----------------------------- 0.015015602111816406
generate_one_block  0.0018491744995117188
generate_one_block  0.0019311904907226562
generate_one_block  0.0015735626220703125
generate_one_block  0.0012731552124023438
generate_one_block  0.0012183189392089844
generate_one_block  0.0017366409301757812
generate_one_block  0.0016689300537109375
generate_one_block  0.0015382766723632812
generate_one_block  0.0016040802001953125
generate_one_block  0.0013856887817382812
generate_one_block  0.001497507095336914
generate_one_block  0.0017254352569580078
generate_one_block  0.0014264583587646484
generate_one_block  0.0014662742614746094
generate_one_block  0.001516103744506836
generate_one_block  0.0013856887817382812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.020960569381713867
block generation total time  0.043256282806396484
average batch blocks generation time:  0.0027035176753997803
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07018327713012695  GigaBytes
Max Memory Allocated: 0.07018327713012695  GigaBytes

torch.Size([962, 1433])
torch.Size([325, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.24473094940185547  GigaBytes
Max Memory Allocated: 0.25438880920410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1354522705078125  GigaBytes
Max Memory Allocated: 0.36542177200317383  GigaBytes

torch.Size([1007, 1433])
torch.Size([377, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.3357858657836914  GigaBytes
Max Memory Allocated: 0.36542177200317383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1352062225341797  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([830, 1433])
torch.Size([308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.2742767333984375  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1327376365661621  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([501, 1433])
torch.Size([130, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.21006107330322266  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1322188377380371  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([404, 1433])
torch.Size([121, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.19342803955078125  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13470697402954102  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([869, 1433])
torch.Size([220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.25238752365112305  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1350865364074707  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([939, 1433])
torch.Size([323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.30661821365356445  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13480520248413086  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([887, 1433])
torch.Size([284, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.2702608108520508  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13445043563842773  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([820, 1433])
torch.Size([309, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.2931709289550781  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1333012580871582  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([606, 1433])
torch.Size([207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.22913742065429688  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13390302658081055  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([718, 1433])
torch.Size([244, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.26972150802612305  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13513755798339844  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([948, 1433])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.3271293640136719  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1333298683166504  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([611, 1433])
torch.Size([229, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.2453446388244629  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13415193557739258  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([765, 1433])
torch.Size([253, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.2550363540649414  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.13372564315795898  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([685, 1433])
torch.Size([251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.26302051544189453  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.1331954002380371  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([586, 1433])
torch.Size([224, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6815185546875 GB
    Memory Allocated: 0.23794031143188477  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051632359623909 |0.02187769114971161 |0.13315872848033905 |0.00011788308620452881 |0.21385085582733154 |0.015093564987182617 |
----------------------------------------------------------pseudo_mini_loss sum 3.130558967590332
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17074
Number of first layer input nodes during this epoch:  12138
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.26326417922973633  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007376670837402344
range selection method range initialization spend 8.296966552734375e-05
time for parepare:  8.249282836914062e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.811981201171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0034415721893310547
generate_one_block  0.0012965202331542969
generate_one_block  0.001125335693359375
generate_one_block  0.0011429786682128906
generate_one_block  0.0014965534210205078
generate_one_block  0.0011434555053710938
generate_one_block  0.0011363029479980469
generate_one_block  0.0011212825775146484
generate_one_block  0.0011181831359863281
generate_one_block  0.001117706298828125
generate_one_block  0.00112152099609375
generate_one_block  0.0010995864868164062
generate_one_block  0.0011057853698730469
generate_one_block  0.0011227130889892578
generate_one_block  0.001102447509765625
generate_one_block  0.00110626220703125
generate_one_block  0.0010020732879638672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006086826324462891
gen group dst list time:  0.00010800361633300781
time for parepare:  0.0001895427703857422
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00019097328186035156
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00023508071899414062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00015306472778320312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016689300537109375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00013327598571777344
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013899803161621094
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00011563301086425781
----------------------check_connections_block total spend ----------------------------- 0.006363630294799805
generate_one_block  0.0014126300811767578
generate_one_block  0.0011811256408691406
generate_one_block  0.001310586929321289
generate_one_block  0.0013239383697509766
generate_one_block  0.0013892650604248047
generate_one_block  0.001271963119506836
generate_one_block  0.0012202262878417969
generate_one_block  0.0011897087097167969
generate_one_block  0.0011477470397949219
generate_one_block  0.00122833251953125
generate_one_block  0.0010569095611572266
generate_one_block  0.0011372566223144531
generate_one_block  0.0012514591217041016
generate_one_block  0.0011782646179199219
generate_one_block  0.0011556148529052734
generate_one_block  0.00113677978515625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007407665252685547
gen group dst list time:  0.00019621849060058594
time for parepare:  0.00023698806762695312
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005161762237548828
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00023484230041503906
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006406307220458984
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0007560253143310547
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0008232593536376953
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0004954338073730469
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0007147789001464844
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0006620883941650391
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0005698204040527344
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0008170604705810547
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00025463104248046875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00036406517028808594
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0007200241088867188
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.00044035911560058594
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005381107330322266
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0005114078521728516
----------------------check_connections_block total spend ----------------------------- 0.016851186752319336
generate_one_block  0.0017898082733154297
generate_one_block  0.0013430118560791016
generate_one_block  0.0019216537475585938
generate_one_block  0.0018224716186523438
generate_one_block  0.0019180774688720703
generate_one_block  0.0015263557434082031
generate_one_block  0.001852273941040039
generate_one_block  0.00173187255859375
generate_one_block  0.0016019344329833984
generate_one_block  0.002002239227294922
generate_one_block  0.0012755393981933594
generate_one_block  0.0013992786407470703
generate_one_block  0.0018177032470703125
generate_one_block  0.0014848709106445312
generate_one_block  0.0016071796417236328
generate_one_block  0.0015850067138671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.26326417922973633  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

connection checking time:  0.02321481704711914
block generation total time  0.04627108573913574
average batch blocks generation time:  0.002891942858695984
block dataloader generation time/epoch 0.15133333206176758
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2644357681274414  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

torch.Size([809, 1433])
torch.Size([228, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.39284849166870117  GigaBytes
Max Memory Allocated: 0.4527425765991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2617063522338867  GigaBytes
Max Memory Allocated: 0.5125179290771484  GigaBytes

torch.Size([299, 1433])
torch.Size([104, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.30919694900512695  GigaBytes
Max Memory Allocated: 0.5125179290771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.2650914192199707  GigaBytes
Max Memory Allocated: 0.5125179290771484  GigaBytes

torch.Size([931, 1433])
torch.Size([323, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.42851734161376953  GigaBytes
Max Memory Allocated: 0.5125179290771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.26531219482421875  GigaBytes
Max Memory Allocated: 0.5474252700805664  GigaBytes

torch.Size([972, 1433])
torch.Size([354, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.4459061622619629  GigaBytes
Max Memory Allocated: 0.5474252700805664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.26558828353881836  GigaBytes
Max Memory Allocated: 0.5638937950134277  GigaBytes

torch.Size([1023, 1433])
torch.Size([434, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.4740734100341797  GigaBytes
Max Memory Allocated: 0.5638937950134277  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26369333267211914  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([670, 1433])
torch.Size([233, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3762936592102051  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26558446884155273  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([1019, 1433])
torch.Size([330, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4507870674133301  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26466894149780273  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([852, 1433])
torch.Size([331, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4150276184082031  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26419734954833984  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([764, 1433])
torch.Size([251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4017820358276367  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26546382904052734  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([1000, 1433])
torch.Size([409, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4638400077819824  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26233625411987305  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([417, 1433])
torch.Size([104, 128])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.31696033477783203  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2631664276123047  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([572, 1433])
torch.Size([160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.34976673126220703  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2653818130493164  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([985, 1433])
torch.Size([360, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.4463987350463867  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.2630038261413574  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([541, 1433])
torch.Size([193, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3690218925476074  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26427650451660156  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([779, 1433])
torch.Size([263, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.39616966247558594  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.26384925842285156  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

torch.Size([699, 1433])
torch.Size([248, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.3896775245666504  GigaBytes
Max Memory Allocated: 0.5903177261352539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051764219999313354 |0.00046518445014953613 |0.10591374337673187 |0.00011508166790008545 |0.21758317947387695 |0.0074214935302734375 |
----------------------------------------------------------pseudo_mini_loss sum 2.533994197845459
Total (block generation + training)time/epoch 6.238945007324219
Training time/epoch 6.087312698364258
Training time without block to device /epoch 6.079869747161865
Training time without total dataloading part /epoch 5.185213565826416
load block tensor time/epoch 0.8282275199890137
block to device time/epoch 0.007442951202392578
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17432
Number of first layer input nodes during this epoch:  12332
