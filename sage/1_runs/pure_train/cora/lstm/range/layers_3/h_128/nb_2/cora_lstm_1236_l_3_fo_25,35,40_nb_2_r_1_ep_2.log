main start at this time 1648430545.8526294
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009303092956542969
range selection method range initialization spend 8.058547973632812e-05
time for parepare:  6.580352783203125e-05
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.001737833023071289
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00013375282287597656
----------------------check_connections_block total spend ----------------------------- 0.0025701522827148438
generate_one_block  0.0014214515686035156
generate_one_block  0.001215219497680664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005195140838623047
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0006847381591796875
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0007352828979492188
----------------------check_connections_block total spend ----------------------------- 0.002595186233520508
generate_one_block  0.0018925666809082031
generate_one_block  0.0019643306732177734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006017684936523438
gen group dst list time:  5.6743621826171875e-05
time for parepare:  0.0001881122589111328
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0017671585083007812
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.001825571060180664
----------------------check_connections_block total spend ----------------------------- 0.005734682083129883
generate_one_block  0.0031020641326904297
generate_one_block  0.003095865249633789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.00832986831665039
block generation total time  0.010054826736450195
average batch blocks generation time:  0.005027413368225098
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07518672943115234  GigaBytes
Max Memory Allocated: 0.07518672943115234  GigaBytes

torch.Size([1892, 1433])
torch.Size([1075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7733154296875 GB
    Memory Allocated: 0.5451807975769043  GigaBytes
Max Memory Allocated: 0.5655460357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.1399855613708496  GigaBytes
Max Memory Allocated: 0.645136833190918  GigaBytes

torch.Size([1849, 1433])
torch.Size([1112, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8983154296875 GB
    Memory Allocated: 0.6193451881408691  GigaBytes
Max Memory Allocated: 0.645136833190918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038514137268066406 |0.16989243030548096 |0.3668797016143799 |0.00018513202667236328 |0.18908143043518066 |0.011129140853881836 |
----------------------------------------------------------pseudo_mini_loss sum 2.8556747436523438
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6627
Number of first layer input nodes during this epoch:  3741
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2701239585876465  GigaBytes
Max Memory Allocated: 0.7148609161376953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000568389892578125
range selection method range initialization spend 7.486343383789062e-05
time for parepare:  8.0108642578125e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001399517059326172
----------------------check_connections_block total spend ----------------------------- 0.0010464191436767578
generate_one_block  0.0015647411346435547
generate_one_block  0.0014576911926269531
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005993843078613281
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00019311904907226562
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0009555816650390625
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0008111000061035156
----------------------check_connections_block total spend ----------------------------- 0.0032224655151367188
generate_one_block  0.0024971961975097656
generate_one_block  0.00237274169921875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006945133209228516
gen group dst list time:  8.225440979003906e-05
time for parepare:  0.00022983551025390625
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.002386808395385742
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0021851062774658203
----------------------check_connections_block total spend ----------------------------- 0.007187843322753906
generate_one_block  0.003448009490966797
generate_one_block  0.003150463104248047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2701239585876465  GigaBytes
Max Memory Allocated: 0.7148609161376953  GigaBytes

connection checking time:  0.010410308837890625
block generation total time  0.01146841049194336
average batch blocks generation time:  0.00573420524597168
block dataloader generation time/epoch 0.03873419761657715
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.2703742980957031  GigaBytes
Max Memory Allocated: 0.7148609161376953  GigaBytes
Using backend: pytorch

torch.Size([1912, 1433])
torch.Size([1197, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0858154296875 GB
    Memory Allocated: 0.7840290069580078  GigaBytes
Max Memory Allocated: 0.8053169250488281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.2701549530029297  GigaBytes
Max Memory Allocated: 0.8779559135437012  GigaBytes

torch.Size([1872, 1433])
torch.Size([1073, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1170654296875 GB
    Memory Allocated: 0.7361655235290527  GigaBytes
Max Memory Allocated: 0.8779559135437012  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0352780818939209 |0.0004941225051879883 |0.13337230682373047 |0.00012218952178955078 |0.1863846778869629 |0.010481834411621094 |
----------------------------------------------------------pseudo_mini_loss sum 2.493058919906616
Total (block generation + training)time/epoch 0.8195421695709229
Training time/epoch 0.7804977893829346
Training time without block to device /epoch 0.7795095443725586
Training time without total dataloading part /epoch 0.6502401828765869
load block tensor time/epoch 0.0705561637878418
block to device time/epoch 0.0009882450103759766
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6757
Number of first layer input nodes during this epoch:  3784
