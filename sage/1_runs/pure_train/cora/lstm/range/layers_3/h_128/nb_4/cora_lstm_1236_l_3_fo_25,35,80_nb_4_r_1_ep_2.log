main start at this time 1648430608.8495784
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013391971588134766
range selection method range initialization spend 0.00012254714965820312
time for parepare:  8.0108642578125e-05
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0028791427612304688
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.866455078125e-05
----------------------check_connections_block total spend ----------------------------- 0.004337787628173828
generate_one_block  0.0020732879638671875
generate_one_block  0.0015158653259277344
generate_one_block  0.0014171600341796875
generate_one_block  0.0014386177062988281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005931854248046875
gen group dst list time:  0.00010132789611816406
time for parepare:  0.00019311904907226562
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005660057067871094
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004038810729980469
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.000484466552734375
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005345344543457031
----------------------check_connections_block total spend ----------------------------- 0.0038709640502929688
generate_one_block  0.0020024776458740234
generate_one_block  0.0017740726470947266
generate_one_block  0.00188446044921875
generate_one_block  0.0019235610961914062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007038116455078125
gen group dst list time:  0.00010180473327636719
time for parepare:  0.00022983551025390625
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00034737586975097656
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0016427040100097656
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0013630390167236328
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.001415252685546875
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0016181468963623047
----------------------check_connections_block total spend ----------------------------- 0.009836435317993164
generate_one_block  0.0032379627227783203
generate_one_block  0.002543210983276367
generate_one_block  0.0023348331451416016
generate_one_block  0.0024170875549316406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06502723693847656  GigaBytes
Max Memory Allocated: 0.06502723693847656  GigaBytes

connection checking time:  0.013707399368286133
block generation total time  0.018117666244506836
average batch blocks generation time:  0.004529416561126709
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1658935546875 GB
    Memory Allocated: 0.07357501983642578  GigaBytes
Max Memory Allocated: 0.07357501983642578  GigaBytes

torch.Size([1593, 1433])
torch.Size([779, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.42737388610839844  GigaBytes
Max Memory Allocated: 0.44425058364868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.1380319595336914  GigaBytes
Max Memory Allocated: 0.53594970703125  GigaBytes

torch.Size([1488, 1433])
torch.Size([620, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7752685546875 GB
    Memory Allocated: 0.4274482727050781  GigaBytes
Max Memory Allocated: 0.53594970703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.1374211311340332  GigaBytes
Max Memory Allocated: 0.5383691787719727  GigaBytes

torch.Size([1373, 1433])
torch.Size([663, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.4431028366088867  GigaBytes
Max Memory Allocated: 0.5383691787719727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.13825750350952148  GigaBytes
Max Memory Allocated: 0.5517582893371582  GigaBytes

torch.Size([1529, 1433])
torch.Size([771, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8377685546875 GB
    Memory Allocated: 0.47811126708984375  GigaBytes
Max Memory Allocated: 0.5517582893371582  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0478668212890625 |0.08609402179718018 |0.2302546501159668 |0.0001589059829711914 |0.16916602849960327 |0.014099597930908203 |
----------------------------------------------------------pseudo_mini_loss sum 3.0428736209869385
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9548
Number of first layer input nodes during this epoch:  5983
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.26836729049682617  GigaBytes
Max Memory Allocated: 0.585197925567627  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048732757568359375
range selection method range initialization spend 6.246566772460938e-05
time for parepare:  7.176399230957031e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011515617370605469Using backend: pytorch

mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.888938903808594e-05
----------------------check_connections_block total spend ----------------------------- 0.0013570785522460938
generate_one_block  0.0012357234954833984
generate_one_block  0.0011348724365234375
generate_one_block  0.001047372817993164
generate_one_block  0.0010433197021484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005214214324951172
gen group dst list time:  4.315376281738281e-05
time for parepare:  0.0001499652862548828
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040912628173828125
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0004596710205078125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0003418922424316406
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003616809844970703
----------------------check_connections_block total spend ----------------------------- 0.0031812191009521484
generate_one_block  0.001560211181640625
generate_one_block  0.0015726089477539062
generate_one_block  0.0014507770538330078
generate_one_block  0.0014922618865966797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005695819854736328
gen group dst list time:  8.416175842285156e-05
time for parepare:  0.000186920166015625
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0011224746704101562
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.0013675689697265625
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0010759830474853516
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0011610984802246094
----------------------check_connections_block total spend ----------------------------- 0.0077822208404541016
generate_one_block  0.0024318695068359375
generate_one_block  0.0025925636291503906
generate_one_block  0.002405881881713867
generate_one_block  0.002323150634765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.26836729049682617  GigaBytes
Max Memory Allocated: 0.585197925567627  GigaBytes

connection checking time:  0.01096343994140625
block generation total time  0.01582932472229004
average batch blocks generation time:  0.00395733118057251
block dataloader generation time/epoch 0.05041241645812988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2678956985473633  GigaBytes
Max Memory Allocated: 0.585197925567627  GigaBytes

torch.Size([1453, 1433])
torch.Size([669, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.5719285011291504  GigaBytes
Max Memory Allocated: 0.5862388610839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.2687106132507324  GigaBytes
Max Memory Allocated: 0.6805105209350586  GigaBytes

torch.Size([1604, 1433])
torch.Size([832, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.6366128921508789  GigaBytes
Max Memory Allocated: 0.6805105209350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.2678947448730469  GigaBytes
Max Memory Allocated: 0.7414350509643555  GigaBytes

torch.Size([1372, 1433])
torch.Size([656, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.5548238754272461  GigaBytes
Max Memory Allocated: 0.7414350509643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.26806211471557617  GigaBytes
Max Memory Allocated: 0.7414350509643555  GigaBytes

torch.Size([1484, 1433])
torch.Size([669, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.5818800926208496  GigaBytes
Max Memory Allocated: 0.7414350509643555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04611331224441528 |0.000424802303314209 |0.11036825180053711 |0.00011521577835083008 |0.15505355596542358 |0.01082921028137207 |
----------------------------------------------------------pseudo_mini_loss sum 2.493051528930664
Total (block generation + training)time/epoch 1.3671488761901855
Training time/epoch 1.3164072036743164
Training time without block to device /epoch 1.3147079944610596
Training time without total dataloading part /epoch 1.0729773044586182
load block tensor time/epoch 0.18445324897766113
block to device time/epoch 0.001699209213256836
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9475
Number of first layer input nodes during this epoch:  5913
