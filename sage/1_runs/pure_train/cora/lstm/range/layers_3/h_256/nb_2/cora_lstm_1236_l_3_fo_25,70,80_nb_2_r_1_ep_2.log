main start at this time 1648430875.3642938
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014836788177490234
range selection method range initialization spend 0.0001125335693359375
time for parepare:  5.984306335449219e-05
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0019736289978027344
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00013756752014160156
----------------------check_connections_block total spend ----------------------------- 0.002784252166748047
generate_one_block  0.001397848129272461
generate_one_block  0.0011897087097167969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000507354736328125
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.0001480579376220703
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.000720977783203125
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0006554126739501953
----------------------check_connections_block total spend ----------------------------- 0.002500772476196289
generate_one_block  0.0018706321716308594
generate_one_block  0.0017669200897216797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005693435668945312
gen group dst list time:  5.412101745605469e-05
time for parepare:  0.00016999244689941406
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.0018534660339355469
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0016069412231445312
----------------------check_connections_block total spend ----------------------------- 0.005551338195800781
generate_one_block  0.003048419952392578
generate_one_block  0.0027534961700439453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.00805211067199707
block generation total time  0.009439468383789062
average batch blocks generation time:  0.004719734191894531
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.08045673370361328  GigaBytes
Max Memory Allocated: 0.08045673370361328  GigaBytes

torch.Size([2001, 1433])
torch.Size([1255, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6347875595092773  GigaBytes
Max Memory Allocated: 0.6357269287109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.15046024322509766  GigaBytes
Max Memory Allocated: 0.7144227027893066  GigaBytes

torch.Size([1854, 1433])
torch.Size([1040, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9744873046875 GB
    Memory Allocated: 0.6189517974853516  GigaBytes
Max Memory Allocated: 0.7144227027893066  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.038430213928222656 |0.1714954376220703 |0.3877716064453125 |0.00020945072174072266 |0.2244335412979126 |0.010393619537353516 |
----------------------------------------------------------pseudo_mini_loss sum 3.1064610481262207
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6839
Number of first layer input nodes during this epoch:  3855
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.2905001640319824  GigaBytes
Max Memory Allocated: 0.7144227027893066  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004630088806152344
range selection method range initialization spend 5.91278076171875e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001308917999267578
----------------------check_connections_block total spend ----------------------------- 0.0009808540344238281
generate_one_block  0.0012633800506591797
generate_one_block  0.0012118816375732422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005133152008056641
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0006299018859863281
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0006935596466064453
----------------------check_connections_block total spend ----------------------------- 0.002458333969116211
generate_one_block  0.0018105506896972656
generate_one_block  0.0018498897552490234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006122589111328125
gen group dst list time:  6.151199340820312e-05
time for parepare:  0.00020313262939453125
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0016045570373535156
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0018012523651123047
----------------------check_connections_block total spend ----------------------------- 0.005482673645019531
generate_one_block  0.0031588077545166016
generate_one_block  0.0031938552856445312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.2905001640319824  GigaBytes
Max Memory Allocated: 0.7144227027893066  GigaBytes

connection checking time:  0.007941007614135742
block generation total time  0.010013103485107422
average batch blocks generation time:  0.005006551742553711
block dataloader generation time/epoch 0.03429555892944336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.29061269760131836  GigaBytes
Max Memory Allocated: 0.7144227027893066  GigaBytes
Using backend: pytorch

torch.Size([1891, 1433])
torch.Size([1127, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1619873046875 GB
    Memory Allocated: 0.7838902473449707  GigaBytes
Max Memory Allocated: 0.7843222618103027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1932373046875 GB
    Memory Allocated: 0.2908797264099121  GigaBytes
Max Memory Allocated: 0.8600845336914062  GigaBytes

torch.Size([1940, 1433])
torch.Size([1166, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1971435546875 GB
    Memory Allocated: 0.8211746215820312  GigaBytes
Max Memory Allocated: 0.8600845336914062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03497135639190674 |0.00045430660247802734 |0.15542304515838623 |0.00012195110321044922 |0.2278146743774414 |0.009793758392333984 |
----------------------------------------------------------pseudo_mini_loss sum 2.7727575302124023
Total (block generation + training)time/epoch 0.942408561706543
Training time/epoch 0.9076483249664307
Training time without block to device /epoch 0.9067397117614746
Training time without total dataloading part /epoch 0.7765130996704102
load block tensor time/epoch 0.06994271278381348
block to device time/epoch 0.0009086132049560547
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6811
Number of first layer input nodes during this epoch:  3831
