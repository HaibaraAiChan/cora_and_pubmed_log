main start at this time 1648430913.1503358
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001039266586303711
range selection method range initialization spend 8.96453857421875e-05
time for parepare:  6.413459777832031e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0012357234954833984
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0043544769287109375
generate_one_block  0.0012085437774658203
generate_one_block  0.0011010169982910156
generate_one_block  0.0010421276092529297
generate_one_block  0.0010404586791992188
generate_one_block  0.001039743423461914
generate_one_block  0.0010349750518798828
generate_one_block  0.00102996826171875
generate_one_block  0.0010256767272949219
generate_one_block  0.001020193099975586
generate_one_block  0.0010721683502197266
generate_one_block  0.001049041748046875
generate_one_block  0.0010416507720947266
generate_one_block  0.0010333061218261719
generate_one_block  0.0010495185852050781
generate_one_block  0.0009908676147460938
generate_one_block  0.0009586811065673828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006079673767089844
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.0001533031463623047
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00015735626220703125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010323524475097656
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00014829635620117188
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.005913734436035156
generate_one_block  0.0012211799621582031
generate_one_block  0.0012235641479492188
generate_one_block  0.0011873245239257812
generate_one_block  0.001203298568725586
generate_one_block  0.0012905597686767578
generate_one_block  0.0011715888977050781
generate_one_block  0.0011019706726074219
generate_one_block  0.0010616779327392578
generate_one_block  0.0010142326354980469
generate_one_block  0.001132965087890625
generate_one_block  0.001245260238647461
generate_one_block  0.001168966293334961
generate_one_block  0.001127004623413086
generate_one_block  0.0011429786682128906
generate_one_block  0.0011048316955566406
generate_one_block  0.0010380744934082031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007038116455078125
gen group dst list time:  0.00016760826110839844
time for parepare:  0.0002262592315673828
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0002655982971191406
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0005469322204589844
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006258487701416016
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004992485046386719
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0005898475646972656
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0007641315460205078
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00040435791015625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00030112266540527344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002281665802001953
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00020456314086914062
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0006022453308105469
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0006043910980224609
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0006146430969238281
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.00047707557678222656
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005717277526855469
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00043773651123046875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0001857280731201172
----------------------check_connections_block total spend ----------------------------- 0.014095544815063477
generate_one_block  0.0017075538635253906
generate_one_block  0.001766204833984375
generate_one_block  0.0015897750854492188
generate_one_block  0.00168609619140625
generate_one_block  0.0019240379333496094
generate_one_block  0.0016689300537109375
generate_one_block  0.0013394355773925781
generate_one_block  0.0011975765228271484
generate_one_block  0.001165628433227539
generate_one_block  0.0016565322875976562
generate_one_block  0.001634359359741211
generate_one_block  0.0016596317291259766
generate_one_block  0.001478433609008789
generate_one_block  0.001608133316040039
generate_one_block  0.0014889240264892578
generate_one_block  0.0011479854583740234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.020009279251098633
block generation total time  0.04315471649169922
average batch blocks generation time:  0.002697169780731201
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07416725158691406  GigaBytes
Max Memory Allocated: 0.07416725158691406  GigaBytes

torch.Size([832, 1433])
torch.Size([316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.22176885604858398  GigaBytes
Max Memory Allocated: 0.22566509246826172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.14432239532470703  GigaBytes
Max Memory Allocated: 0.3428835868835449  GigaBytes

torch.Size([856, 1433])
torch.Size([353, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5623779296875 GB
    Memory Allocated: 0.30947399139404297  GigaBytes
Max Memory Allocated: 0.3428835868835449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6561279296875 GB
    Memory Allocated: 0.14419031143188477  GigaBytes
Max Memory Allocated: 0.4232196807861328  GigaBytes

torch.Size([730, 1433])
torch.Size([249, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.2716374397277832  GigaBytes
Max Memory Allocated: 0.4232196807861328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6756591796875 GB
    Memory Allocated: 0.14457225799560547  GigaBytes
Max Memory Allocated: 0.4232196807861328  GigaBytes

torch.Size([903, 1433])
torch.Size([333, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6756591796875 GB
    Memory Allocated: 0.3028244972229004  GigaBytes
Max Memory Allocated: 0.4232196807861328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6756591796875 GB
    Memory Allocated: 0.14592695236206055  GigaBytes
Max Memory Allocated: 0.4232196807861328  GigaBytes

torch.Size([1091, 1433])
torch.Size([415, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6873779296875 GB
    Memory Allocated: 0.35904741287231445  GigaBytes
Max Memory Allocated: 0.4232196807861328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.1431899070739746  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([645, 1433])
torch.Size([210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.2489633560180664  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14220428466796875  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([461, 1433])
torch.Size([174, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.21631240844726562  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14155101776123047  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([339, 1433])
torch.Size([106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.19771718978881836  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14237165451049805  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([385, 1433])
torch.Size([94, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.19124078750610352  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.1446690559387207  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([921, 1433])
torch.Size([329, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.30973339080810547  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14582538604736328  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([984, 1433])
torch.Size([341, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.30802202224731445  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.1446700096130371  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([904, 1433])
torch.Size([333, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.31555652618408203  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14318132400512695  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([643, 1433])
torch.Size([275, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.26888275146484375  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14468955993652344  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([925, 1433])
torch.Size([314, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.29929161071777344  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14418935775756836  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([661, 1433])
torch.Size([233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.2601299285888672  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.14130353927612305  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([293, 1433])
torch.Size([94, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.18295001983642578  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05247566103935242 |0.02201804518699646 |0.1102326363325119 |0.00011359155178070068 |0.12884968519210815 |0.009225845336914062 |
----------------------------------------------------------pseudo_mini_loss sum 3.082848310470581
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16504
Number of first layer input nodes during this epoch:  11573
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28106117248535156  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005266666412353516
range selection method range initialization spend 6.914138793945312e-05
time for parepare:  8.296966552734375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.0032279491424560547
generate_one_block  0.001184225082397461
generate_one_block  0.00104522705078125
generate_one_block  0.0010502338409423828
generate_one_block  0.0013909339904785156
generate_one_block  0.0010409355163574219
generate_one_block  0.0010631084442138672
generate_one_block  0.0010318756103515625
generate_one_block  0.0010344982147216797
generate_one_block  0.001028299331665039
generate_one_block  0.00106048583984375
generate_one_block  0.0010561943054199219
generate_one_block  0.0010366439819335938
generate_one_block  0.0010385513305664062
generate_one_block  0.0010373592376708984
generate_one_block  0.0009710788726806641
generate_one_block  0.0009622573852539062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006110668182373047
gen group dst list time:  9.918212890625e-05
time for parepare:  0.00018072128295898438
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00022459030151367188
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00018548965454101562
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001385211944580078
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00011992454528808594
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002434253692626953
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00023102760314941406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00015401840209960938
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  8.106231689453125e-05
----------------------check_connections_block total spend ----------------------------- 0.006083965301513672
generate_one_block  0.00128173828125
generate_one_block  0.001184225082397461
generate_one_block  0.0010952949523925781
generate_one_block  0.001325368881225586
generate_one_block  0.0011501312255859375
generate_one_block  0.0012607574462890625
generate_one_block  0.0011441707611083984
generate_one_block  0.0011267662048339844
generate_one_block  0.001096487045288086
generate_one_block  0.0012645721435546875
generate_one_block  0.0012292861938476562
generate_one_block  0.001056671142578125
generate_one_block  0.0010280609130859375
generate_one_block  0.0012297630310058594
generate_one_block  0.0011525154113769531
generate_one_block  0.0010552406311035156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.004607439041137695
gen group dst list time:  0.00018548965454101562
time for parepare:  0.00022745132446289062
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00038743019104003906
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00043511390686035156
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00021576881408691406
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0006768703460693359
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0003631114959716797
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006327629089355469
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003180503845214844
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0005366802215576172
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0008249282836914062
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0007481575012207031
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0002849102020263672
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00019860267639160156
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005934238433837891
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005757808685302734
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00031876564025878906
----------------------check_connections_block total spend ----------------------------- 0.01446986198425293
generate_one_block  0.0015718936920166016
generate_one_block  0.0015516281127929688
generate_one_block  0.001287698745727539
generate_one_block  0.0018825531005859375
generate_one_block  0.0013966560363769531
generate_one_block  0.0017294883728027344
generate_one_block  0.0013096332550048828
generate_one_block  0.0015857219696044922
generate_one_block  0.001476287841796875
generate_one_block  0.0020313262939453125
generate_one_block  0.0018475055694580078
generate_one_block  0.0012328624725341797
generate_one_block  0.0011622905731201172
generate_one_block  0.001619577407836914
generate_one_block  0.0016429424285888672
generate_one_block  0.0013175010681152344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28106117248535156  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

connection checking time:  0.0205538272857666
block generation total time  0.043326616287231445
average batch blocks generation time:  0.0027079135179519653
block dataloader generation time/epoch 0.1352531909942627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28278160095214844  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

torch.Size([616, 1433])
torch.Size([182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.3797178268432617  GigaBytes
Max Memory Allocated: 0.4690546989440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.2825431823730469  GigaBytes
Max Memory Allocated: 0.49793577194213867  GigaBytes

torch.Size([571, 1433])
torch.Size([230, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.39465808868408203  GigaBytes
Max Memory Allocated: 0.49793577194213867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28121042251586914  GigaBytes
Max Memory Allocated: 0.510739803314209  GigaBytes

torch.Size([315, 1433])
torch.Size([102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.33216047286987305  GigaBytes
Max Memory Allocated: 0.510739803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.28472900390625  GigaBytes
Max Memory Allocated: 0.510739803314209  GigaBytes

torch.Size([979, 1433])
torch.Size([374, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.464566707611084  GigaBytes
Max Memory Allocated: 0.510739803314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.2826099395751953  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

torch.Size([584, 1433])
torch.Size([208, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.3732309341430664  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.2841672897338867  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

torch.Size([874, 1433])
torch.Size([381, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7889404296875 GB
    Memory Allocated: 0.45168209075927734  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.2828836441040039  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

torch.Size([453, 1433])
torch.Size([157, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.35959815979003906  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.2841634750366211  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

torch.Size([762, 1433])
torch.Size([277, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.42407798767089844  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.2834186553955078  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

torch.Size([735, 1433])
torch.Size([228, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.39232587814331055  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.2850484848022461  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

torch.Size([1038, 1433])
torch.Size([456, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8240966796875 GB
    Memory Allocated: 0.5091104507446289  GigaBytes
Max Memory Allocated: 0.5749425888061523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.2850775718688965  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

torch.Size([1044, 1433])
torch.Size([418, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.4869065284729004  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.28123044967651367  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

torch.Size([326, 1433])
torch.Size([128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.341888427734375  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.2810525894165039  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

torch.Size([259, 1433])
torch.Size([88, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.32250547409057617  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.2834615707397461  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

torch.Size([742, 1433])
torch.Size([312, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.441312313079834  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.28381872177124023  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

torch.Size([809, 1433])
torch.Size([310, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.4362678527832031  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.2821922302246094  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

torch.Size([506, 1433])
torch.Size([146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.3579845428466797  GigaBytes
Max Memory Allocated: 0.6169886589050293  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0500527024269104 |0.000410616397857666 |0.07608295977115631 |0.00010575354099273682 |0.12192849814891815 |0.010161876678466797 |
----------------------------------------------------------pseudo_mini_loss sum 2.8857665061950684
Total (block generation + training)time/epoch 4.187362909317017
Training time/epoch 4.051854848861694
Training time without block to device /epoch 4.045284986495972
Training time without total dataloading part /epoch 3.180037260055542
load block tensor time/epoch 0.8008432388305664
block to device time/epoch 0.006569862365722656
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15379
Number of first layer input nodes during this epoch:  10613
