main start at this time 1648430822.2068474
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009207725524902344
range selection method range initialization spend 9.441375732421875e-05
time for parepare:  7.653236389160156e-05
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0015912055969238281
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001704692840576172
----------------------check_connections_block total spend ----------------------------- 0.002560138702392578
generate_one_block  0.0016317367553710938
generate_one_block  0.0014650821685791016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005950927734375
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.0001780986785888672
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0008571147918701172
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0008177757263183594
----------------------check_connections_block total spend ----------------------------- 0.0030438899993896484
generate_one_block  0.0022759437561035156
generate_one_block  0.002263307571411133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006880760192871094
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.00022268295288085938
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0003769397735595703
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.002287149429321289
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.0019745826721191406
----------------------check_connections_block total spend ----------------------------- 0.006816864013671875
generate_one_block  0.0038521289825439453
generate_one_block  0.0034601688385009766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.009860754013061523
block generation total time  0.01185154914855957
average batch blocks generation time:  0.005925774574279785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.08006858825683594  GigaBytes
Max Memory Allocated: 0.08006858825683594  GigaBytes

torch.Size([1929, 1433])
torch.Size([1171, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.604736328125  GigaBytes
Max Memory Allocated: 0.6060771942138672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.15067243576049805  GigaBytes
Max Memory Allocated: 0.6888279914855957  GigaBytes

torch.Size([1787, 1433])
torch.Size([982, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9451904296875 GB
    Memory Allocated: 0.5976338386535645  GigaBytes
Max Memory Allocated: 0.6888279914855957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03644108772277832 |0.17172586917877197 |0.36827874183654785 |0.00016164779663085938 |0.19460546970367432 |0.01117706298828125 |
----------------------------------------------------------pseudo_mini_loss sum 3.102142810821533
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6558
Number of first layer input nodes during this epoch:  3716
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2901616096496582  GigaBytes
Max Memory Allocated: 0.6888279914855957  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005638599395751953
range selection method range initialization spend 7.677078247070312e-05
time for parepare:  8.058547973632812e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00021457672119140625
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00015974044799804688
----------------------check_connections_block total spend ----------------------------- 0.0010576248168945312
generate_one_block  0.001489400863647461
generate_one_block  0.0014748573303222656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005877017974853516
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.0001857280731201172
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0008008480072021484
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0008916854858398438
----------------------check_connections_block total spend ----------------------------- 0.0031249523162841797
generate_one_block  0.0023779869079589844
generate_one_block  0.002346515655517578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006971359252929688
gen group dst list time:  7.200241088867188e-05
time for parepare:  0.0002334117889404297
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0003650188446044922
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.0020668506622314453
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.002253293991088867
----------------------check_connections_block total spend ----------------------------- 0.006940126419067383
generate_one_block  0.0036878585815429688
generate_one_block  0.003827333450317383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2901616096496582  GigaBytes
Max Memory Allocated: 0.6888279914855957  GigaBytes

connection checking time:  0.010065078735351562
block generation total time  0.012239694595336914
average batch blocks generation time:  0.006119847297668457
block dataloader generation time/epoch 0.03882598876953125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.2902545928955078  GigaBytes
Max Memory Allocated: 0.6888279914855957  GigaBytes
Using backend: pytorch

torch.Size([1820, 1433])
torch.Size([1035, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.7516889572143555  GigaBytes
Max Memory Allocated: 0.7521209716796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.29061365127563477  GigaBytes
Max Memory Allocated: 0.8316187858581543  GigaBytes

torch.Size([1886, 1433])
torch.Size([1105, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1717529296875 GB
    Memory Allocated: 0.8031039237976074  GigaBytes
Max Memory Allocated: 0.8316187858581543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03403782844543457 |0.0004773139953613281 |0.1325141191482544 |0.00012803077697753906 |0.19407975673675537 |0.010392189025878906 |
----------------------------------------------------------pseudo_mini_loss sum 2.9024124145507812
Total (block generation + training)time/epoch 0.8316953182220459
Training time/epoch 0.7926020622253418
Training time without block to device /epoch 0.7916474342346191
Training time without total dataloading part /epoch 0.6638360023498535
load block tensor time/epoch 0.06807565689086914
block to device time/epoch 0.0009546279907226562
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6533
Number of first layer input nodes during this epoch:  3706
