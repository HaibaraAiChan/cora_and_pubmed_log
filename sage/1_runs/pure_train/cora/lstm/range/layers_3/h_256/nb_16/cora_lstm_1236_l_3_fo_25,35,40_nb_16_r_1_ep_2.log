main start at this time 1648430805.6801686
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016179084777832031
range selection method range initialization spend 0.00011277198791503906
time for parepare:  6.389617919921875e-05
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00392460823059082
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.4781951904296875e-05
----------------------check_connections_block total spend ----------------------------- 0.007004261016845703
generate_one_block  0.0012958049774169922
generate_one_block  0.0011188983917236328
generate_one_block  0.0010209083557128906
generate_one_block  0.0009970664978027344
generate_one_block  0.0010235309600830078
generate_one_block  0.0010056495666503906
generate_one_block  0.0010020732879638672
generate_one_block  0.0009915828704833984
generate_one_block  0.001028299331665039
generate_one_block  0.0010614395141601562
generate_one_block  0.0010068416595458984
generate_one_block  0.0009624958038330078
generate_one_block  0.0009608268737792969
generate_one_block  0.0009672641754150391
generate_one_block  0.0009565353393554688
generate_one_block  0.0009779930114746094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006170272827148438
gen group dst list time:  0.00010251998901367188
time for parepare:  0.00014448165893554688
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013637542724609375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00019693374633789062
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00011134147644042969
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.630752563476562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0001323223114013672
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001575946807861328
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001270771026611328
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00012302398681640625
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.817413330078125e-05
----------------------check_connections_block total spend ----------------------------- 0.005578279495239258
generate_one_block  0.001191854476928711
generate_one_block  0.00116729736328125
generate_one_block  0.0011365413665771484
generate_one_block  0.001146078109741211
generate_one_block  0.0012385845184326172
generate_one_block  0.0011129379272460938
generate_one_block  0.0010759830474853516
generate_one_block  0.0010957717895507812
generate_one_block  0.0009951591491699219
generate_one_block  0.00110626220703125
generate_one_block  0.0011875629425048828
generate_one_block  0.0011277198791503906
generate_one_block  0.0010862350463867188
generate_one_block  0.0011310577392578125
generate_one_block  0.0010716915130615234
generate_one_block  0.0010263919830322266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006763935089111328
gen group dst list time:  0.00014829635620117188
time for parepare:  0.00021505355834960938
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00046372413635253906
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005242824554443359
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0005066394805908203
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005371570587158203
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0007417201995849609
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00037598609924316406
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002646446228027344
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00020122528076171875
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0005152225494384766
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005619525909423828
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005598068237304688
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003914833068847656
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00037789344787597656
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00020432472229003906
----------------------check_connections_block total spend ----------------------------- 0.012831687927246094
generate_one_block  0.001589059829711914
generate_one_block  0.0016016960144042969
generate_one_block  0.0015583038330078125
generate_one_block  0.0015180110931396484
generate_one_block  0.0017399787902832031
generate_one_block  0.0015840530395507812
generate_one_block  0.001230478286743164
generate_one_block  0.0011925697326660156
generate_one_block  0.001165628433227539
generate_one_block  0.0015501976013183594
generate_one_block  0.0015411376953125
generate_one_block  0.001580953598022461
generate_one_block  0.0013916492462158203
generate_one_block  0.0015244483947753906
generate_one_block  0.0014178752899169922
generate_one_block  0.0011293888092041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.01840996742248535
block generation total time  0.04121255874633789
average batch blocks generation time:  0.002575784921646118
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07349157333374023  GigaBytes
Max Memory Allocated: 0.07349157333374023  GigaBytes

torch.Size([706, 1433])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4041748046875 GB
    Memory Allocated: 0.19715309143066406  GigaBytes
Max Memory Allocated: 0.20023155212402344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5350341796875 GB
    Memory Allocated: 0.1435561180114746  GigaBytes
Max Memory Allocated: 0.3203001022338867  GigaBytes

torch.Size([769, 1433])
torch.Size([283, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5447998046875 GB
    Memory Allocated: 0.28351688385009766  GigaBytes
Max Memory Allocated: 0.3203001022338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6112060546875 GB
    Memory Allocated: 0.14335107803344727  GigaBytes
Max Memory Allocated: 0.3989834785461426  GigaBytes

torch.Size([731, 1433])
torch.Size([243, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6190185546875 GB
    Memory Allocated: 0.2682180404663086  GigaBytes
Max Memory Allocated: 0.3989834785461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.1436138153076172  GigaBytes
Max Memory Allocated: 0.3989834785461426  GigaBytes

torch.Size([780, 1433])
torch.Size([289, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.27957677841186523  GigaBytes
Max Memory Allocated: 0.3989834785461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6229248046875 GB
    Memory Allocated: 0.14476299285888672  GigaBytes
Max Memory Allocated: 0.3989834785461426  GigaBytes

torch.Size([994, 1433])
torch.Size([363, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.33544492721557617  GigaBytes
Max Memory Allocated: 0.3989834785461426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14321565628051758  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([544, 1433])
torch.Size([180, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.23489809036254883  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14166927337646484  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([417, 1433])
torch.Size([146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2075362205505371  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14122533798217773  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([334, 1433])
torch.Size([106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.19739151000976562  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1414647102355957  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([379, 1433])
torch.Size([94, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1899118423461914  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14374828338623047  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([805, 1433])
torch.Size([268, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2864513397216797  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1447925567626953  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([867, 1433])
torch.Size([283, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2862558364868164  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14374923706054688  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([805, 1433])
torch.Size([280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.29367685317993164  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14321565628051758  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([561, 1433])
torch.Size([217, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.24725866317749023  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14385032653808594  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([824, 1433])
torch.Size([282, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2831711769104004  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14321565628051758  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([567, 1433])
torch.Size([195, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.24324846267700195  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14092445373535156  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([278, 1433])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1802840232849121  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.051788121461868286 |0.022122040390968323 |0.10423018038272858 |0.00011667609214782715 |0.10284285247325897 |0.009547233581542969 |
----------------------------------------------------------pseudo_mini_loss sum 3.0813190937042236
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14701
Number of first layer input nodes during this epoch:  10361
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2803616523742676  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005011558532714844
range selection method range initialization spend 7.200241088867188e-05
time for parepare:  7.295608520507812e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
----------------------check_connections_block total spend ----------------------------- 0.002986907958984375
generate_one_block  0.0010495185852050781
generate_one_block  0.0009701251983642578
generate_one_block  0.0009624958038330078
generate_one_block  0.0013360977172851562
generate_one_block  0.0009639263153076172
generate_one_block  0.0009579658508300781
generate_one_block  0.0009567737579345703
generate_one_block  0.0009744167327880859
generate_one_block  0.0009584426879882812
generate_one_block  0.0009715557098388672
generate_one_block  0.0009686946868896484
generate_one_block  0.0010077953338623047
generate_one_block  0.0010082721710205078
generate_one_block  0.0009682178497314453
generate_one_block  0.0009553432464599609
generate_one_block  0.0009515285491943359
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005981922149658203
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.0001628398895263672
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010943412780761719
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.916854858398438e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00012493133544921875
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.390975952148438e-05
----------------------check_connections_block total spend ----------------------------- 0.005301475524902344
generate_one_block  0.0011892318725585938
generate_one_block  0.0010786056518554688
generate_one_block  0.0010187625885009766
generate_one_block  0.001207113265991211
generate_one_block  0.0010724067687988281
generate_one_block  0.0011715888977050781
generate_one_block  0.0010535717010498047
generate_one_block  0.0010945796966552734
generate_one_block  0.001055002212524414
generate_one_block  0.0012118816375732422
generate_one_block  0.0011832714080810547
generate_one_block  0.0010426044464111328
generate_one_block  0.0010199546813964844
generate_one_block  0.0012049674987792969
generate_one_block  0.0011038780212402344
generate_one_block  0.0010361671447753906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007078647613525391
gen group dst list time:  0.00014734268188476562
time for parepare:  0.00022149085998535156
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0003559589385986328
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0001976490020751953
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0005867481231689453
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0002918243408203125
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00048422813415527344
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0002875328063964844
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00041675567626953125
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003039836883544922
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0007379055023193359
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006256103515625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00025463104248046875
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00016736984252929688
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005202293395996094
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0004527568817138672
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00030541419982910156
----------------------check_connections_block total spend ----------------------------- 0.012468576431274414
generate_one_block  0.001428842544555664
generate_one_block  0.0013959407806396484
generate_one_block  0.001207113265991211
generate_one_block  0.0017123222351074219
generate_one_block  0.0013265609741210938
generate_one_block  0.0015637874603271484
generate_one_block  0.0012841224670410156
generate_one_block  0.0015141963958740234
generate_one_block  0.0013499259948730469
generate_one_block  0.0019233226776123047
generate_one_block  0.0017018318176269531
generate_one_block  0.0012238025665283203
generate_one_block  0.0011506080627441406
generate_one_block  0.0015718936920166016
generate_one_block  0.0015268325805664062
generate_one_block  0.0013098716735839844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2803616523742676  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

connection checking time:  0.017770051956176758
block generation total time  0.04093456268310547
average batch blocks generation time:  0.002558410167694092
block dataloader generation time/epoch 0.12143492698669434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28212451934814453  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

torch.Size([609, 1433])
torch.Size([181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.3777623176574707  GigaBytes
Max Memory Allocated: 0.44690847396850586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28171443939208984  GigaBytes
Max Memory Allocated: 0.4960026741027832  GigaBytes

torch.Size([532, 1433])
torch.Size([198, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.3794441223144531  GigaBytes
Max Memory Allocated: 0.4960026741027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2805619239807129  GigaBytes
Max Memory Allocated: 0.4965353012084961  GigaBytes

torch.Size([317, 1433])
torch.Size([102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.3315119743347168  GigaBytes
Max Memory Allocated: 0.4965353012084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2838735580444336  GigaBytes
Max Memory Allocated: 0.4965353012084961  GigaBytes

torch.Size([935, 1433])
torch.Size([348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7576904296875 GB
    Memory Allocated: 0.4528512954711914  GigaBytes
Max Memory Allocated: 0.4965353012084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.28168487548828125  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

torch.Size([527, 1433])
torch.Size([168, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.3591790199279785  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.2828073501586914  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

torch.Size([736, 1433])
torch.Size([279, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.4137234687805176  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.2812047004699707  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

torch.Size([437, 1433])
torch.Size([152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.35619688034057617  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.2828054428100586  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

torch.Size([695, 1433])
torch.Size([224, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.3983187675476074  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.2820863723754883  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

torch.Size([602, 1433])
torch.Size([169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.36428070068359375  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7928466796875 GB
    Memory Allocated: 0.2840590476989746  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

torch.Size([969, 1433])
torch.Size([402, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.4874153137207031  GigaBytes
Max Memory Allocated: 0.5641350746154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2838897705078125  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

torch.Size([938, 1433])
torch.Size([336, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.4540996551513672  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28061628341674805  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

torch.Size([327, 1433])
torch.Size([128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.3412742614746094  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2803530693054199  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

torch.Size([262, 1433])
torch.Size([88, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.3218059539794922  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28274965286254883  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

torch.Size([725, 1433])
torch.Size([290, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.4311819076538086  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28281736373901367  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

torch.Size([738, 1433])
torch.Size([255, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.41074419021606445  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2815518379211426  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

torch.Size([502, 1433])
torch.Size([146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.3573441505432129  GigaBytes
Max Memory Allocated: 0.5967955589294434  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05027934908866882 |0.00039505958557128906 |0.06997238099575043 |0.00010699033737182617 |0.09459848701953888 |0.010376453399658203 |
----------------------------------------------------------pseudo_mini_loss sum 2.985114336013794
Total (block generation + training)time/epoch 3.640779495239258
Training time/epoch 3.519007921218872
Training time without block to device /epoch 3.5126869678497314
Training time without total dataloading part /epoch 2.6452221870422363
load block tensor time/epoch 0.8044695854187012
block to device time/epoch 0.006320953369140625
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14086
Number of first layer input nodes during this epoch:  9851
