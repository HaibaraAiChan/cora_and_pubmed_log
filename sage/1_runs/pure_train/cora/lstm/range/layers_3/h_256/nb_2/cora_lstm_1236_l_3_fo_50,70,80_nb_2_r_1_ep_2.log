main start at this time 1648430930.7450767
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011243820190429688
range selection method range initialization spend 0.00010609626770019531
time for parepare:  6.628036499023438e-05
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.002474069595336914
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00014543533325195312
----------------------check_connections_block total spend ----------------------------- 0.0033910274505615234
generate_one_block  0.0015697479248046875
generate_one_block  0.0012333393096923828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005218982696533203
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00015473365783691406
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0007624626159667969
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007154941558837891
----------------------check_connections_block total spend ----------------------------- 0.0026617050170898438
generate_one_block  0.0019965171813964844
generate_one_block  0.001954317092895508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006062984466552734
gen group dst list time:  6.079673767089844e-05
time for parepare:  0.00018644332885742188
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0003352165222167969
mini_batch_src_global generation:  0.0001926422119140625
r_  generation:  0.002062082290649414
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0017545223236083984
----------------------check_connections_block total spend ----------------------------- 0.0060367584228515625
generate_one_block  0.0034024715423583984
generate_one_block  0.003065824508666992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.008698463439941406
block generation total time  0.010419130325317383
average batch blocks generation time:  0.005209565162658691
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.08050680160522461  GigaBytes
Max Memory Allocated: 0.08050680160522461  GigaBytes

torch.Size([2010, 1433])
torch.Size([1258, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6510782241821289  GigaBytes
Max Memory Allocated: 0.6537108421325684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.14955520629882812  GigaBytes
Max Memory Allocated: 0.7313895225524902  GigaBytes

torch.Size([1877, 1433])
torch.Size([1033, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9959716796875 GB
    Memory Allocated: 0.6354742050170898  GigaBytes
Max Memory Allocated: 0.7313895225524902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03501248359680176 |0.17049145698547363 |0.4430347681045532 |0.0002079010009765625 |0.44245338439941406 |0.009021282196044922 |
----------------------------------------------------------pseudo_mini_loss sum 3.102647304534912
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6867
Number of first layer input nodes during this epoch:  3887
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.2890501022338867  GigaBytes
Max Memory Allocated: 0.7313895225524902  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005135536193847656
range selection method range initialization spend 6.604194641113281e-05
time for parepare:  7.05718994140625e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013947486877441406
----------------------check_connections_block total spend ----------------------------- 0.0009732246398925781
generate_one_block  0.001322031021118164
generate_one_block  0.0012657642364501953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005216598510742188
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00015807151794433594
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0007088184356689453
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0007789134979248047
----------------------check_connections_block total spend ----------------------------- 0.0027463436126708984
generate_one_block  0.0019998550415039062
generate_one_block  0.0021924972534179688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005955696105957031
gen group dst list time:  6.461143493652344e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.001865386962890625
local_output_nid generation:  9.274482727050781e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.0002067089080810547
r_  generation:  0.0019865036010742188
----------------------check_connections_block total spend ----------------------------- 0.006076335906982422
generate_one_block  0.0033550262451171875
generate_one_block  0.0034127235412597656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.2890501022338867  GigaBytes
Max Memory Allocated: 0.7313895225524902  GigaBytes

connection checking time:  0.00882267951965332
block generation total time  0.010960102081298828
average batch blocks generation time:  0.005480051040649414
block dataloader generation time/epoch 0.040035247802734375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.2890176773071289  GigaBytes
Max Memory Allocated: 0.7313895225524902  GigaBytes
Using backend: pytorch

torch.Size([1899, 1433])
torch.Size([1121, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1873779296875 GB
    Memory Allocated: 0.7974205017089844  GigaBytes
Max Memory Allocated: 0.7983255386352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.289247989654541  GigaBytes
Max Memory Allocated: 0.8751883506774902  GigaBytes

torch.Size([1941, 1433])
torch.Size([1160, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.8310966491699219  GigaBytes
Max Memory Allocated: 0.8751883506774902  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031884074211120605 |0.0005029439926147461 |0.20644962787628174 |0.0001329183578491211 |0.44365155696868896 |0.009417295455932617 |
----------------------------------------------------------pseudo_mini_loss sum 2.7875542640686035
Total (block generation + training)time/epoch 1.4732043743133545
Training time/epoch 1.4327301979064941
Training time without block to device /epoch 1.4317243099212646
Training time without total dataloading part /epoch 1.3098855018615723
load block tensor time/epoch 0.06376814842224121
block to device time/epoch 0.0010058879852294922
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6808
Number of first layer input nodes during this epoch:  3840
