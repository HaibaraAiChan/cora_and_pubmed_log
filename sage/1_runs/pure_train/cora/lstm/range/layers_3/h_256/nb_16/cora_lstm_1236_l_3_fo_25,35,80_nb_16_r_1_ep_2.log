main start at this time 1648430858.6412938
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011632442474365234
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  6.413459777832031e-05
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0013399124145507812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.811981201171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.004502058029174805
generate_one_block  0.001394033432006836
generate_one_block  0.0011134147644042969
generate_one_block  0.0010344982147216797
generate_one_block  0.0010216236114501953
generate_one_block  0.0010318756103515625
generate_one_block  0.0010347366333007812
generate_one_block  0.0010237693786621094
generate_one_block  0.0010142326354980469
generate_one_block  0.0010178089141845703
generate_one_block  0.0010614395141601562
generate_one_block  0.001031637191772461
generate_one_block  0.001028299331665039
generate_one_block  0.0010328292846679688
generate_one_block  0.0010101795196533203
generate_one_block  0.0010030269622802734
generate_one_block  0.0010228157043457031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006232261657714844
gen group dst list time:  9.036064147949219e-05
time for parepare:  0.00014710426330566406
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00013971328735351562
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.000133514404296875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00013113021850585938
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00013375282287597656
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00016498565673828125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00012159347534179688
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.0055828094482421875
generate_one_block  0.0012047290802001953
generate_one_block  0.0011773109436035156
generate_one_block  0.0011603832244873047
generate_one_block  0.0011739730834960938
generate_one_block  0.0012552738189697266
generate_one_block  0.0011370182037353516
generate_one_block  0.0011086463928222656
generate_one_block  0.0011131763458251953
generate_one_block  0.0009949207305908203
generate_one_block  0.0011081695556640625
generate_one_block  0.001222848892211914
generate_one_block  0.001150369644165039
generate_one_block  0.001085519790649414
generate_one_block  0.0011785030364990234
generate_one_block  0.0011048316955566406
generate_one_block  0.001027822494506836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006835460662841797
gen group dst list time:  0.00015592575073242188
time for parepare:  0.00021910667419433594
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0004820823669433594
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005147457122802734
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00048804283142089844
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005285739898681641
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0006823539733886719
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00036144256591796875
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00022649765014648438
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00020384788513183594
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0005393028259277344
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005233287811279297
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005435943603515625
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005276203155517578
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00039386749267578125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00017309188842773438
----------------------check_connections_block total spend ----------------------------- 0.012802600860595703
generate_one_block  0.0016105175018310547
generate_one_block  0.0016129016876220703
generate_one_block  0.0015747547149658203
generate_one_block  0.0016241073608398438
generate_one_block  0.0017347335815429688
generate_one_block  0.0015859603881835938
generate_one_block  0.001232147216796875
generate_one_block  0.0011763572692871094
generate_one_block  0.0011603832244873047
generate_one_block  0.0015671253204345703
generate_one_block  0.0015289783477783203
generate_one_block  0.0015492439270019531
generate_one_block  0.001386404037475586
generate_one_block  0.0015301704406738281
generate_one_block  0.001428365707397461
generate_one_block  0.0011293888092041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.01838541030883789
block generation total time  0.04163503646850586
average batch blocks generation time:  0.002602189779281616
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.0736689567565918  GigaBytes
Max Memory Allocated: 0.0736689567565918  GigaBytes

torch.Size([739, 1433])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.2008509635925293  GigaBytes
Max Memory Allocated: 0.20412874221801758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.1434483528137207  GigaBytes
Max Memory Allocated: 0.32399797439575195  GigaBytes

torch.Size([749, 1433])
torch.Size([280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.28028297424316406  GigaBytes
Max Memory Allocated: 0.32399797439575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.14339494705200195  GigaBytes
Max Memory Allocated: 0.39577531814575195  GigaBytes

torch.Size([727, 1433])
torch.Size([245, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.2687416076660156  GigaBytes
Max Memory Allocated: 0.39577531814575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.14379072189331055  GigaBytes
Max Memory Allocated: 0.39577531814575195  GigaBytes

torch.Size([813, 1433])
torch.Size([292, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.2840404510498047  GigaBytes
Max Memory Allocated: 0.39577531814575195  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.14476299285888672  GigaBytes
Max Memory Allocated: 0.39926958084106445  GigaBytes

torch.Size([994, 1433])
torch.Size([364, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6248779296875 GB
    Memory Allocated: 0.3360328674316406  GigaBytes
Max Memory Allocated: 0.39926958084106445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14238834381103516  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([551, 1433])
torch.Size([179, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.23454713821411133  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1416158676147461  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([407, 1433])
torch.Size([144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.20672225952148438  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14122533798217773  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([334, 1433])
torch.Size([106, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.19739151000976562  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1416029930114746  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([381, 1433])
torch.Size([94, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1900501251220703  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14379596710205078  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([814, 1433])
torch.Size([276, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.28886985778808594  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14406919479370117  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([865, 1433])
torch.Size([280, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2839322090148926  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1437969207763672  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([804, 1433])
torch.Size([278, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.29090356826782227  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14235639572143555  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([545, 1433])
torch.Size([223, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.24679994583129883  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.1439518928527832  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([843, 1433])
torch.Size([282, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.28429698944091797  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14339208602905273  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([578, 1433])
torch.Size([195, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.2446122169494629  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.14087629318237305  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([269, 1433])
torch.Size([89, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6600341796875 GB
    Memory Allocated: 0.17983484268188477  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05222126841545105 |0.021834924817085266 |0.10299570858478546 |0.0001131892204284668 |0.10373398661613464 |0.009379863739013672 |
----------------------------------------------------------pseudo_mini_loss sum 3.0858821868896484
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14762
Number of first layer input nodes during this epoch:  10413
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28031349182128906  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005042552947998047
range selection method range initialization spend 7.2479248046875e-05
time for parepare:  7.987022399902344e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0032122135162353516
generate_one_block  0.0010802745819091797
generate_one_block  0.0010385513305664062
generate_one_block  0.0010209083557128906
generate_one_block  0.0013701915740966797
generate_one_block  0.001003265380859375
generate_one_block  0.001035451889038086
generate_one_block  0.0009980201721191406
generate_one_block  0.0010004043579101562
generate_one_block  0.00102996826171875
generate_one_block  0.001041412353515625
generate_one_block  0.001016378402709961
generate_one_block  0.000995635986328125
generate_one_block  0.0010211467742919922
generate_one_block  0.0010118484497070312
generate_one_block  0.0010023117065429688
generate_one_block  0.001028299331665039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005109310150146484
gen group dst list time:  0.00010824203491210938
time for parepare:  0.0001685619354248047
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011491775512695312
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001373291015625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00022649765014648438
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00019025802612304688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.179115295410156e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015926361083984375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.82012939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0056514739990234375
generate_one_block  0.0012493133544921875
generate_one_block  0.0011615753173828125
generate_one_block  0.0010597705841064453
generate_one_block  0.0012502670288085938
generate_one_block  0.001131296157836914
generate_one_block  0.0011684894561767578
generate_one_block  0.001100301742553711
generate_one_block  0.0010988712310791016
generate_one_block  0.001058816909790039
generate_one_block  0.00121307373046875
generate_one_block  0.001184701919555664
generate_one_block  0.001043081283569336
generate_one_block  0.0010273456573486328
generate_one_block  0.0012094974517822266
generate_one_block  0.0011074542999267578
generate_one_block  0.0010323524475097656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007119178771972656
gen group dst list time:  0.00016498565673828125
time for parepare:  0.0002315044403076172
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00037550926208496094
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00037789344787597656
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002090930938720703
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006282329559326172
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0003075599670410156
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005052089691162109
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003178119659423828
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004477500915527344
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0003402233123779297
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0007619857788085938
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006504058837890625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0002586841583251953
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005500316619873047
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005171298980712891
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00031375885009765625
----------------------check_connections_block total spend ----------------------------- 0.013106584548950195
generate_one_block  0.001516103744506836
generate_one_block  0.0014564990997314453
generate_one_block  0.0012760162353515625
generate_one_block  0.0017347335815429688
generate_one_block  0.0013339519500732422
generate_one_block  0.0015463829040527344
generate_one_block  0.0012845993041992188
generate_one_block  0.0014972686767578125
generate_one_block  0.0013811588287353516
generate_one_block  0.001971006393432617
generate_one_block  0.0017123222351074219
generate_one_block  0.0012285709381103516
generate_one_block  0.0011448860168457031
generate_one_block  0.0015747547149658203
generate_one_block  0.0015401840209960938
generate_one_block  0.0013043880462646484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28031349182128906  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

connection checking time:  0.018758058547973633
block generation total time  0.04159903526306152
average batch blocks generation time:  0.002599939703941345
block dataloader generation time/epoch 0.12665987014770508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28217267990112305  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

torch.Size([618, 1433])
torch.Size([182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.37909460067749023  GigaBytes
Max Memory Allocated: 0.44782400131225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28176259994506836  GigaBytes
Max Memory Allocated: 0.4973268508911133  GigaBytes

torch.Size([541, 1433])
torch.Size([201, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.3795585632324219  GigaBytes
Max Memory Allocated: 0.4973268508911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.28136539459228516  GigaBytes
Max Memory Allocated: 0.4973268508911133  GigaBytes

torch.Size([316, 1433])
torch.Size([102, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.33231544494628906  GigaBytes
Max Memory Allocated: 0.4973268508911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7537841796875 GB
    Memory Allocated: 0.2839374542236328  GigaBytes
Max Memory Allocated: 0.4973268508911133  GigaBytes

torch.Size([947, 1433])
torch.Size([348, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.45577335357666016  GigaBytes
Max Memory Allocated: 0.4973268508911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2824993133544922  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

torch.Size([515, 1433])
torch.Size([166, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3585023880004883  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.28291940689086914  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

torch.Size([757, 1433])
torch.Size([278, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.4158010482788086  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.2812633514404297  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

torch.Size([448, 1433])
torch.Size([152, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.35650157928466797  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.28291749954223633  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

torch.Size([705, 1433])
torch.Size([220, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3997988700866699  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.28221988677978516  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

torch.Size([627, 1433])
torch.Size([172, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.3703341484069824  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.28406429290771484  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

torch.Size([970, 1433])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.48609304428100586  GigaBytes
Max Memory Allocated: 0.5670571327209473  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28400182723999023  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

torch.Size([959, 1433])
torch.Size([334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.45673561096191406  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2806220054626465  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

torch.Size([328, 1433])
torch.Size([128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.3412799835205078  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2803049087524414  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

torch.Size([264, 1433])
torch.Size([88, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.32175779342651367  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28277111053466797  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

torch.Size([729, 1433])
torch.Size([291, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.43102359771728516  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28366851806640625  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

torch.Size([750, 1433])
torch.Size([253, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.41448211669921875  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.28156232833862305  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

torch.Size([504, 1433])
torch.Size([146, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.35735464096069336  GigaBytes
Max Memory Allocated: 0.595456600189209  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050343841314315796 |0.0003966093063354492 |0.07079178094863892 |0.0001052170991897583 |0.10015605390071869 |0.010106563568115234 |
----------------------------------------------------------pseudo_mini_loss sum 3.016491174697876
Total (block generation + training)time/epoch 3.7490909099578857
Training time/epoch 3.622131109237671
Training time without block to device /epoch 3.6157853603363037
Training time without total dataloading part /epoch 2.746955394744873
load block tensor time/epoch 0.8055014610290527
block to device time/epoch 0.0063457489013671875
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14212
Number of first layer input nodes during this epoch:  9978
