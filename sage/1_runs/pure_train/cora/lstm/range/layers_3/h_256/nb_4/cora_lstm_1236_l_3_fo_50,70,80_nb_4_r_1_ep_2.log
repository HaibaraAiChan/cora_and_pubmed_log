main start at this time 1648430942.893485
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012705326080322266
range selection method range initialization spend 7.867813110351562e-05
time for parepare:  5.8650970458984375e-05
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0012862682342529297
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.818771362304688e-05
----------------------check_connections_block total spend ----------------------------- 0.002497434616088867
generate_one_block  0.0014600753784179688
generate_one_block  0.0011124610900878906
generate_one_block  0.0011172294616699219
generate_one_block  0.0010809898376464844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004909038543701172
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.00014090538024902344
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00044655799865722656
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00043654441833496094
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00039005279541015625
----------------------check_connections_block total spend ----------------------------- 0.003149747848510742
generate_one_block  0.0015943050384521484
generate_one_block  0.001504659652709961
generate_one_block  0.0015172958374023438
generate_one_block  0.0015184879302978516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006072521209716797
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.00016808509826660156
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  0.0001442432403564453
r_  generation:  0.0014612674713134766
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0012891292572021484
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0012302398681640625
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0012693405151367188
----------------------check_connections_block total spend ----------------------------- 0.008312225341796875
generate_one_block  0.0027697086334228516
generate_one_block  0.0025048255920410156
generate_one_block  0.002648591995239258
generate_one_block  0.002422332763671875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.011461973190307617
block generation total time  0.016480207443237305
average batch blocks generation time:  0.004120051860809326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07889127731323242  GigaBytes
Max Memory Allocated: 0.07889127731323242  GigaBytes

torch.Size([1711, 1433])
torch.Size([919, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.506385326385498  GigaBytes
Max Memory Allocated: 0.5150532722473145  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.14765501022338867  GigaBytes
Max Memory Allocated: 0.6063342094421387  GigaBytes

torch.Size([1536, 1433])
torch.Size([751, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8670654296875 GB
    Memory Allocated: 0.5110397338867188  GigaBytes
Max Memory Allocated: 0.6063342094421387  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.14792728424072266  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

torch.Size([1587, 1433])
torch.Size([734, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.5064964294433594  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.14781999588012695  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

torch.Size([1567, 1433])
torch.Size([721, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.49918270111083984  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04619497060775757 |0.0850682258605957 |0.29493218660354614 |0.00014078617095947266 |0.3862956166267395 |0.010047435760498047 |
----------------------------------------------------------pseudo_mini_loss sum 3.1304805278778076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10250
Number of first layer input nodes during this epoch:  6401
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.28728628158569336  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005128383636474609
range selection method range initialization spend 6.437301635742188e-05
time for parepare:  7.2479248046875e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011467933654785156
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.628036499023438e-05
----------------------check_connections_block total spend ----------------------------- 0.0014107227325439453
generate_one_block  0.0013017654418945312
generate_one_block  0.0011572837829589844
generate_one_block  0.0011463165283203125
generate_one_block  0.0011150836944580078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005121231079101562
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.000152587890625
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004372596740722656
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.00041747093200683594
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0004792213439941406
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.00046181678771972656
----------------------check_connections_block total spend ----------------------------- 0.0034952163696289062
generate_one_block  0.0016155242919921875
generate_one_block  0.0015850067138671875
generate_one_block  0.0016436576843261719
generate_one_block  0.0016069412231445312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005781650543212891
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00018835067749023438
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.001276254653930664
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0013513565063476562
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.0014443397521972656
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0014226436614990234
----------------------check_connections_block total spend ----------------------------- 0.008736133575439453
generate_one_block  0.0026023387908935547
generate_one_block  0.0026547908782958984
generate_one_block  0.002794981002807617
generate_one_block  0.0025899410247802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.28728628158569336  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

connection checking time:  0.01223134994506836
block generation total time  0.017093181610107422
average batch blocks generation time:  0.0042732954025268555
block dataloader generation time/epoch 0.06199789047241211
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.28669023513793945  GigaBytes
Max Memory Allocated: 0.6079163551330566  GigaBytes

torch.Size([1467, 1433])
torch.Size([721, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.6313223838806152  GigaBytes
Max Memory Allocated: 0.6355156898498535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.2878270149230957  GigaBytes
Max Memory Allocated: 0.7288856506347656  GigaBytes

torch.Size([1590, 1433])
torch.Size([752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.6459245681762695  GigaBytes
Max Memory Allocated: 0.7288856506347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.2876410484313965  GigaBytes
Max Memory Allocated: 0.7439966201782227  GigaBytes

torch.Size([1644, 1433])
torch.Size([785, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.6791138648986816  GigaBytes
Max Memory Allocated: 0.7439966201782227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.28745317459106445  GigaBytes
Max Memory Allocated: 0.7730307579040527  GigaBytes

torch.Size([1609, 1433])
torch.Size([782, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.670987606048584  GigaBytes
Max Memory Allocated: 0.7730307579040527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04691201448440552 |0.0006906390190124512 |0.17889028787612915 |0.00012969970703125 |0.39096546173095703 |0.006501913070678711 |
----------------------------------------------------------pseudo_mini_loss sum 3.0905001163482666
Total (block generation + training)time/epoch 2.5979979038238525
Training time/epoch 2.5356597900390625
Training time without block to device /epoch 2.5328972339630127
Training time without total dataloading part /epoch 2.2864437103271484
load block tensor time/epoch 0.18764805793762207
block to device time/epoch 0.0027625560760498047
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10085
Number of first layer input nodes during this epoch:  6310
