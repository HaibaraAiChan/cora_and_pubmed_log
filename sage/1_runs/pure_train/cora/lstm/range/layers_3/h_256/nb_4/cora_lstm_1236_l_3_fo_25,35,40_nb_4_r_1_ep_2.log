main start at this time 1648430780.0245953
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014979839324951172
range selection method range initialization spend 0.00010395050048828125
time for parepare:  6.318092346191406e-05
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.001984834671020508
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.628036499023438e-05
----------------------check_connections_block total spend ----------------------------- 0.003194093704223633
generate_one_block  0.0014111995697021484
generate_one_block  0.0010478496551513672
generate_one_block  0.0010328292846679688
generate_one_block  0.001054525375366211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004901885986328125
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.0001342296600341797
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003581047058105469
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00038552284240722656
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003421306610107422
----------------------check_connections_block total spend ----------------------------- 0.0029058456420898438
generate_one_block  0.0015072822570800781
generate_one_block  0.001371622085571289
generate_one_block  0.001443624496459961
generate_one_block  0.001383066177368164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005502700805664062
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.00016427040100097656
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0013289451599121094
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0010786056518554688
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0011165142059326172
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0010242462158203125
----------------------check_connections_block total spend ----------------------------- 0.007348299026489258
generate_one_block  0.0024881362915039062
generate_one_block  0.0022237300872802734
generate_one_block  0.0023550987243652344
generate_one_block  0.002155303955078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.010254144668579102
block generation total time  0.014927864074707031
average batch blocks generation time:  0.003731966018676758
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07839536666870117  GigaBytes
Max Memory Allocated: 0.07839536666870117  GigaBytes

torch.Size([1619, 1433])
torch.Size([818, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6697998046875 GB
    Memory Allocated: 0.4569830894470215  GigaBytes
Max Memory Allocated: 0.46363258361816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.14839792251586914  GigaBytes
Max Memory Allocated: 0.5595846176147461  GigaBytes

torch.Size([1437, 1433])
torch.Size([670, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.4710869789123535  GigaBytes
Max Memory Allocated: 0.5595846176147461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.14888238906860352  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

torch.Size([1477, 1433])
torch.Size([667, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.46791839599609375  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.14796161651611328  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

torch.Size([1446, 1433])
torch.Size([639, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8612060546875 GB
    Memory Allocated: 0.45500898361206055  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04858684539794922 |0.08490288257598877 |0.22819668054580688 |0.00014150142669677734 |0.164189875125885 |0.01365518569946289 |
----------------------------------------------------------pseudo_mini_loss sum 3.1179404258728027
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9497
Number of first layer input nodes during this epoch:  5979
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.28742122650146484  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048828125
range selection method range initialization spend 6.151199340820312e-05
time for parepare:  6.461143493652344e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001068115234375Using backend: pytorch

mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.081031799316406e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.0012776851654052734
generate_one_block  0.0011532306671142578
generate_one_block  0.001100301742553711
generate_one_block  0.0010533332824707031
generate_one_block  0.0010445117950439453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005190372467041016
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.0001494884490966797
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00036597251892089844
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004119873046875
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00040721893310546875
----------------------check_connections_block total spend ----------------------------- 0.0031783580780029297
generate_one_block  0.0015256404876708984
generate_one_block  0.0013988018035888672
generate_one_block  0.0014998912811279297
generate_one_block  0.0015075206756591797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005326271057128906
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.00017976760864257812
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0010685920715332031
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0010433197021484375
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0011637210845947266
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.001214742660522461
----------------------check_connections_block total spend ----------------------------- 0.007429838180541992
generate_one_block  0.0023059844970703125
generate_one_block  0.002413034439086914
generate_one_block  0.0025916099548339844
generate_one_block  0.0023996829986572266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.28742122650146484  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

connection checking time:  0.010608196258544922
block generation total time  0.015642166137695312
average batch blocks generation time:  0.003910541534423828
block dataloader generation time/epoch 0.04984402656555176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.28699207305908203  GigaBytes
Max Memory Allocated: 0.5690388679504395  GigaBytes

torch.Size([1376, 1433])
torch.Size([665, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.5926971435546875  GigaBytes
Max Memory Allocated: 0.5957441329956055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.2875704765319824  GigaBytes
Max Memory Allocated: 0.6905298233032227  GigaBytes

torch.Size([1484, 1433])
torch.Size([663, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.5978102684020996  GigaBytes
Max Memory Allocated: 0.6905298233032227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.28829145431518555  GigaBytes
Max Memory Allocated: 0.6965551376342773  GigaBytes

torch.Size([1512, 1433])
torch.Size([720, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.638984203338623  GigaBytes
Max Memory Allocated: 0.6965551376342773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.28780508041381836  GigaBytes
Max Memory Allocated: 0.7335233688354492  GigaBytes

torch.Size([1527, 1433])
torch.Size([744, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.6412715911865234  GigaBytes
Max Memory Allocated: 0.7335233688354492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045982420444488525 |0.00040352344512939453 |0.11062216758728027 |0.00011533498764038086 |0.16409754753112793 |0.008717536926269531 |
----------------------------------------------------------pseudo_mini_loss sum 3.2036726474761963
Total (block generation + training)time/epoch 1.400416374206543
Training time/epoch 1.3502390384674072
Training time without block to device /epoch 1.3486249446868896
Training time without total dataloading part /epoch 1.1080577373504639
load block tensor time/epoch 0.1839296817779541
block to device time/epoch 0.0016140937805175781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9426
Number of first layer input nodes during this epoch:  5899
