main start at this time 1648430886.2431996
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012142658233642578
range selection method range initialization spend 0.00010204315185546875
time for parepare:  5.936622619628906e-05
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0023801326751708984
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.580352783203125e-05
----------------------check_connections_block total spend ----------------------------- 0.003577709197998047
generate_one_block  0.0013892650604248047
generate_one_block  0.0010564327239990234
generate_one_block  0.0010461807250976562
generate_one_block  0.0010194778442382812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004813671112060547
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.00014543533325195312
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0004551410675048828
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0003943443298339844
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00041961669921875
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003724098205566406
----------------------check_connections_block total spend ----------------------------- 0.0031239986419677734
generate_one_block  0.0015287399291992188
generate_one_block  0.0014157295227050781
generate_one_block  0.0014410018920898438
generate_one_block  0.0014138221740722656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005676746368408203
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.0001628398895263672
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.001346588134765625
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0011565685272216797
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0011477470397949219
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.00113677978515625
----------------------check_connections_block total spend ----------------------------- 0.007738590240478516
generate_one_block  0.0025794506072998047
generate_one_block  0.002332448959350586
generate_one_block  0.002420186996459961
generate_one_block  0.002321958541870117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.010862588882446289
block generation total time  0.015453338623046875
average batch blocks generation time:  0.0038633346557617188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07881546020507812  GigaBytes
Max Memory Allocated: 0.07881546020507812  GigaBytes

torch.Size([1697, 1433])
torch.Size([910, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.48657941818237305  GigaBytes
Max Memory Allocated: 0.4934349060058594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.14759445190429688  GigaBytes
Max Memory Allocated: 0.5853786468505859  GigaBytes

torch.Size([1525, 1433])
torch.Size([745, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8494873046875 GB
    Memory Allocated: 0.49525928497314453  GigaBytes
Max Memory Allocated: 0.5853786468505859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.14778757095336914  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

torch.Size([1561, 1433])
torch.Size([732, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.4966259002685547  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.1479182243347168  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

torch.Size([1566, 1433])
torch.Size([719, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.48921918869018555  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047611117362976074 |0.08653241395950317 |0.24821436405181885 |0.00015205144882202148 |0.20138496160507202 |0.011431455612182617 |
----------------------------------------------------------pseudo_mini_loss sum 3.1166832447052
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10179
Number of first layer input nodes during this epoch:  6349
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.28804826736450195  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004787445068359375
range selection method range initialization spend 6.151199340820312e-05
time for parepare:  6.413459777832031e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.0011432170867919922
r_  generation:  9.012222290039062e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001251697540283203Using backend: pytorch

mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.91278076171875e-05
----------------------check_connections_block total spend ----------------------------- 0.002465486526489258
generate_one_block  0.0012345314025878906
generate_one_block  0.0011119842529296875
generate_one_block  0.0011258125305175781
generate_one_block  0.0010976791381835938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00051116943359375
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0003821849822998047
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004401206970214844
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.00044465065002441406
----------------------check_connections_block total spend ----------------------------- 0.0033986568450927734
generate_one_block  0.0016074180603027344
generate_one_block  0.001482248306274414
generate_one_block  0.0015566349029541016
generate_one_block  0.0015430450439453125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005595684051513672
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0011966228485107422
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0011684894561767578
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0013120174407958984
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0012373924255371094
----------------------check_connections_block total spend ----------------------------- 0.008088111877441406
generate_one_block  0.002491474151611328
generate_one_block  0.0024039745330810547
generate_one_block  0.003011465072631836
generate_one_block  0.002462148666381836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.28804826736450195  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

connection checking time:  0.01148676872253418
block generation total time  0.016558408737182617
average batch blocks generation time:  0.004139602184295654
block dataloader generation time/epoch 0.05607008934020996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.2878556251525879  GigaBytes
Max Memory Allocated: 0.5909605026245117  GigaBytes

torch.Size([1457, 1433])
torch.Size([726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.6174192428588867  GigaBytes
Max Memory Allocated: 0.6211628913879395  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.28798913955688477  GigaBytes
Max Memory Allocated: 0.7135491371154785  GigaBytes

torch.Size([1550, 1433])
torch.Size([753, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.6284093856811523  GigaBytes
Max Memory Allocated: 0.7135491371154785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0369873046875 GB
    Memory Allocated: 0.28812313079833984  GigaBytes
Max Memory Allocated: 0.724998950958252  GigaBytes

torch.Size([1610, 1433])
torch.Size([787, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0389404296875 GB
    Memory Allocated: 0.6656007766723633  GigaBytes
Max Memory Allocated: 0.724998950958252  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.28786611557006836  GigaBytes
Max Memory Allocated: 0.7580275535583496  GigaBytes

torch.Size([1562, 1433])
torch.Size([784, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.6525702476501465  GigaBytes
Max Memory Allocated: 0.7580275535583496  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04644489288330078 |0.0004228949546813965 |0.12913990020751953 |0.00011742115020751953 |0.1960749626159668 |0.010479450225830078 |
----------------------------------------------------------pseudo_mini_loss sum 3.132378339767456
Total (block generation + training)time/epoch 1.615546464920044
Training time/epoch 1.5591449737548828
Training time without block to device /epoch 1.5574533939361572
Training time without total dataloading part /epoch 1.3118085861206055
load block tensor time/epoch 0.18577957153320312
block to device time/epoch 0.001691579818725586
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9964
Number of first layer input nodes during this epoch:  6179
