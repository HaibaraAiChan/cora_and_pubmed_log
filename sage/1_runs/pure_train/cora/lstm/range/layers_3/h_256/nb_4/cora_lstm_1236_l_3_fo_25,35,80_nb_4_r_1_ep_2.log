main start at this time 1648430833.0008078
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012331008911132812
range selection method range initialization spend 0.00010251998901367188
time for parepare:  6.341934204101562e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0024051666259765625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.104873657226562e-05
----------------------check_connections_block total spend ----------------------------- 0.0036399364471435547
generate_one_block  0.0013995170593261719
generate_one_block  0.0011882781982421875
generate_one_block  0.0011878013610839844
generate_one_block  0.0011374950408935547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004944801330566406
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0001442432403564453
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0004515647888183594
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00040268898010253906
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004088878631591797
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00036334991455078125
----------------------check_connections_block total spend ----------------------------- 0.0031201839447021484
generate_one_block  0.0016283988952636719
generate_one_block  0.0015492439270019531
generate_one_block  0.0015397071838378906
generate_one_block  0.0015676021575927734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005788803100585938
gen group dst list time:  7.581710815429688e-05
time for parepare:  0.0001697540283203125
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0013458728790283203
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0011451244354248047
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0011148452758789062
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0011200904846191406
----------------------check_connections_block total spend ----------------------------- 0.007697343826293945
generate_one_block  0.002672910690307617
generate_one_block  0.0024008750915527344
generate_one_block  0.0024831295013427734
generate_one_block  0.0022683143615722656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.06970787048339844  GigaBytes
Max Memory Allocated: 0.06970787048339844  GigaBytes

connection checking time:  0.010817527770996094
block generation total time  0.01611018180847168
average batch blocks generation time:  0.00402754545211792
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.0782938003540039  GigaBytes
Max Memory Allocated: 0.0782938003540039  GigaBytes

torch.Size([1600, 1433])
torch.Size([819, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6658935546875 GB
    Memory Allocated: 0.45592689514160156  GigaBytes
Max Memory Allocated: 0.4624300003051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.1477069854736328  GigaBytes
Max Memory Allocated: 0.557218074798584  GigaBytes

torch.Size([1422, 1433])
torch.Size([670, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.468564510345459  GigaBytes
Max Memory Allocated: 0.557218074798584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.14799213409423828  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

torch.Size([1449, 1433])
torch.Size([667, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.46540117263793945  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.1477060317993164  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

torch.Size([1452, 1433])
torch.Size([645, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.45659399032592773  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0480879545211792 |0.08572185039520264 |0.23149484395980835 |0.00014024972915649414 |0.17199581861495972 |0.013598442077636719 |
----------------------------------------------------------pseudo_mini_loss sum 3.115391492843628
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9448
Number of first layer input nodes during this epoch:  5923
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2871665954589844  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004715919494628906
range selection method range initialization spend 6.103515625e-05
time for parepare:  6.461143493652344e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011587142944335938Using backend: pytorch

mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.175041198730469e-05
----------------------check_connections_block total spend ----------------------------- 0.0012967586517333984
generate_one_block  0.0011293888092041016
generate_one_block  0.0010695457458496094
generate_one_block  0.0022363662719726562
generate_one_block  0.0010673999786376953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048613548278808594
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.00015735626220703125
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0004036426544189453
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00035762786865234375
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00043654441833496094
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0004286766052246094
----------------------check_connections_block total spend ----------------------------- 0.0032057762145996094
generate_one_block  0.0015063285827636719
generate_one_block  0.0014438629150390625
generate_one_block  0.0015244483947753906
generate_one_block  0.0015225410461425781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005648136138916016
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.0001857280731201172
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00027251243591308594
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0011076927185058594
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0011138916015625
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0012395381927490234
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0012485980987548828
----------------------check_connections_block total spend ----------------------------- 0.007714986801147461
generate_one_block  0.002349853515625
generate_one_block  0.002402067184448242
generate_one_block  0.002620220184326172
generate_one_block  0.0023920536041259766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2871665954589844  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

connection checking time:  0.01092076301574707
block generation total time  0.015761375427246094
average batch blocks generation time:  0.0039403438568115234
block dataloader generation time/epoch 0.05091524124145508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.2863502502441406  GigaBytes
Max Memory Allocated: 0.5665163993835449  GigaBytes

torch.Size([1404, 1433])
torch.Size([666, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.5956573486328125  GigaBytes
Max Memory Allocated: 0.5985736846923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.28671932220458984  GigaBytes
Max Memory Allocated: 0.6934814453125  GigaBytes

torch.Size([1473, 1433])
torch.Size([657, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.5948519706726074  GigaBytes
Max Memory Allocated: 0.6934814453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.2870340347290039  GigaBytes
Max Memory Allocated: 0.6944851875305176  GigaBytes

torch.Size([1531, 1433])
torch.Size([712, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.6360950469970703  GigaBytes
Max Memory Allocated: 0.6944851875305176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.28702735900878906  GigaBytes
Max Memory Allocated: 0.7307014465332031  GigaBytes

torch.Size([1530, 1433])
torch.Size([736, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9920654296875 GB
    Memory Allocated: 0.6363625526428223  GigaBytes
Max Memory Allocated: 0.7307014465332031  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04567760229110718 |0.00041419267654418945 |0.11272305250167847 |0.00011616945266723633 |0.17181545495986938 |0.010555505752563477 |
----------------------------------------------------------pseudo_mini_loss sum 3.0984110832214355
Total (block generation + training)time/epoch 1.4437255859375
Training time/epoch 1.3924570083618164
Training time without block to device /epoch 1.3908002376556396
Training time without total dataloading part /epoch 1.1491742134094238
load block tensor time/epoch 0.1827104091644287
block to device time/epoch 0.0016567707061767578
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9444
Number of first layer input nodes during this epoch:  5938
