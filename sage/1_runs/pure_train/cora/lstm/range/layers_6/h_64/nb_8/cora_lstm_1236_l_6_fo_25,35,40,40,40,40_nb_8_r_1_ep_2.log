main start at this time 1648434099.473012
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011591911315917969
range selection method range initialization spend 0.00011038780212402344
time for parepare:  8.106231689453125e-05
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.002446889877319336
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.0531158447265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0047283172607421875
generate_one_block  0.0014801025390625
generate_one_block  0.001293182373046875
generate_one_block  0.0012507438659667969
generate_one_block  0.0012955665588378906
generate_one_block  0.0012693405151367188
generate_one_block  0.0012753009796142578
generate_one_block  0.001272439956665039
generate_one_block  0.0010581016540527344
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
gen group dst list time:  7.581710815429688e-05
time for parepare:  0.00019025802612304688
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002589225769042969
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003600120544433594
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002701282501220703
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0004105567932128906
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00020313262939453125
----------------------check_connections_block total spend ----------------------------- 0.004839897155761719
generate_one_block  0.0015320777893066406
generate_one_block  0.0015594959259033203
generate_one_block  0.0014345645904541016
generate_one_block  0.0016770362854003906
generate_one_block  0.0015387535095214844
generate_one_block  0.0014519691467285156
generate_one_block  0.001338958740234375
generate_one_block  0.0011420249938964844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006642341613769531
gen group dst list time:  0.00013494491577148438
time for parepare:  0.0002617835998535156
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0002868175506591797
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0008733272552490234
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0009663105010986328
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0006592273712158203
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0013256072998046875
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0009167194366455078
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007455348968505859
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.001285552978515625
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0007824897766113281
----------------------check_connections_block total spend ----------------------------- 0.01287388801574707
generate_one_block  0.0021941661834716797
generate_one_block  0.0018074512481689453
generate_one_block  0.001508474349975586
generate_one_block  0.002183675765991211
generate_one_block  0.0017704963684082031
generate_one_block  0.0015840530395507812
generate_one_block  0.002093791961669922
generate_one_block  0.0016417503356933594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007128715515136719
gen group dst list time:  0.00025534629821777344
time for parepare:  0.0002512931823730469
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.0004010200500488281
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.002137899398803711
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.002226114273071289
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.0013401508331298828
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.0001895427703857422
r_  generation:  0.002282381057739258
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.00018548965454101562
r_  generation:  0.0019423961639404297
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.0014913082122802734
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.001993894577026367
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0014345645904541016
----------------------check_connections_block total spend ----------------------------- 0.02339339256286621
generate_one_block  0.0030679702758789062
generate_one_block  0.00290679931640625
generate_one_block  0.0025115013122558594
generate_one_block  0.0033113956451416016
generate_one_block  0.0029261112213134766
generate_one_block  0.002511739730834961
generate_one_block  0.0031363964080810547
generate_one_block  0.002648591995239258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007393360137939453
gen group dst list time:  0.00038242340087890625
time for parepare:  0.00019979476928710938
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0027954578399658203
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.00031256675720214844
r_  generation:  0.0028808116912841797
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.002390623092651367
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.00035119056701660156
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.003067493438720703
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.002783060073852539
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.002337217330932617
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.002586841583251953
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.0023522377014160156
----------------------check_connections_block total spend ----------------------------- 0.0319819450378418
generate_one_block  0.004624843597412109
generate_one_block  0.004288434982299805
generate_one_block  0.003326892852783203
generate_one_block  0.0039730072021484375
generate_one_block  0.00461125373840332
generate_one_block  0.0035593509674072266
generate_one_block  0.0037491321563720703
generate_one_block  0.0035195350646972656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007791519165039062
gen group dst list time:  0.0004780292510986328
time for parepare:  0.00020170211791992188
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.0005404949188232422
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0032427310943603516
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.0003783702850341797
mini_batch_src_global generation:  0.00033092498779296875
r_  generation:  0.003223896026611328
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.0002663135528564453
r_  generation:  0.003046274185180664
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.0003762245178222656
mini_batch_src_global generation:  0.0002665519714355469
r_  generation:  0.003278493881225586
local_output_nid generation:  0.00016927719116210938
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0032303333282470703
local_output_nid generation:  0.00016736984252929688
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.00286865234375
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0028586387634277344
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0027997493743896484
----------------------check_connections_block total spend ----------------------------- 0.036797523498535156
generate_one_block  0.004569053649902344
generate_one_block  0.004867076873779297
generate_one_block  0.003920078277587891
generate_one_block  0.004072427749633789
generate_one_block  0.004035234451293945
generate_one_block  0.004021644592285156
generate_one_block  0.004051685333251953
generate_one_block  0.004012107849121094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

connection checking time:  0.10988664627075195
block generation total time  0.11468100547790527
average batch blocks generation time:  0.01433512568473816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.0778493881225586  GigaBytes
Max Memory Allocated: 0.0778493881225586  GigaBytes

torch.Size([2409, 1433])
torch.Size([2251, 64])
torch.Size([1800, 64])
torch.Size([1031, 64])
torch.Size([372, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.9429001808166504  GigaBytes
Max Memory Allocated: 0.9502949714660645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.1401991844177246  GigaBytes
Max Memory Allocated: 0.988309383392334  GigaBytes

torch.Size([2377, 1433])
torch.Size([2248, 64])
torch.Size([1880, 64])
torch.Size([1104, 64])
torch.Size([422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 1.0072736740112305  GigaBytes
Max Memory Allocated: 1.0112214088439941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.14006614685058594  GigaBytes
Max Memory Allocated: 1.048722267150879  GigaBytes

torch.Size([2358, 1433])
torch.Size([2071, 64])
torch.Size([1503, 64])
torch.Size([719, 64])
torch.Size([257, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.951289176940918  GigaBytes
Max Memory Allocated: 1.048722267150879  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.14120244979858398  GigaBytes
Max Memory Allocated: 1.048722267150879  GigaBytes

torch.Size([2395, 1433])
torch.Size([2301, 64])
torch.Size([2032, 64])
torch.Size([1397, 64])
torch.Size([582, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 1.0226812362670898  GigaBytes
Max Memory Allocated: 1.048722267150879  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.14118432998657227  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

torch.Size([2395, 1433])
torch.Size([2264, 64])
torch.Size([1943, 64])
torch.Size([1137, 64])
torch.Size([409, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 1.0111808776855469  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.14116239547729492  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

torch.Size([2402, 1433])
torch.Size([2191, 64])
torch.Size([1670, 64])
torch.Size([859, 64])
torch.Size([336, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.989842414855957  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.14119768142700195  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

torch.Size([2390, 1433])
torch.Size([2227, 64])
torch.Size([1916, 64])
torch.Size([1307, 64])
torch.Size([579, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 1.0100631713867188  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.14002180099487305  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

torch.Size([2347, 1433])
torch.Size([2162, 64])
torch.Size([1662, 64])
torch.Size([927, 64])
torch.Size([326, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4295654296875 GB
    Memory Allocated: 0.9768352508544922  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061546653509140015 |0.04350915551185608 |0.33784034848213196 |0.00015020370483398438 |0.3708260655403137 |0.020964860916137695 |
----------------------------------------------------------pseudo_mini_loss sum 3.134690999984741
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63701
Number of first layer input nodes during this epoch:  19073
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.268308162689209  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008075237274169922
range selection method range initialization spend 9.775161743164062e-05
time for parepare:  0.00010585784912109375
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.8623809814453125e-05
----------------------check_connections_block total spend ----------------------------- 0.002428770065307617
generate_one_block  0.0014717578887939453
generate_one_block  0.0013537406921386719
generate_one_block  0.001331329345703125
generate_one_block  0.0013554096221923828
generate_one_block  0.001336812973022461
generate_one_block  0.0013103485107421875
generate_one_block  0.0013475418090820312
generate_one_block  0.0012977123260498047
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000579833984375
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.0002422332763671875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00034356117248535156
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002551078796386719
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003490447998046875
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0002987384796142578
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003466606140136719
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00019669532775878906
----------------------check_connections_block total spend ----------------------------- 0.00540924072265625
generate_one_block  0.0019083023071289062
generate_one_block  0.0016031265258789062
generate_one_block  0.0015840530395507812
generate_one_block  0.0016870498657226562
generate_one_block  0.0016045570373535156
generate_one_block  0.0014410018920898438
generate_one_block  0.0013473033905029297
generate_one_block  0.0011553764343261719
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007660388946533203
gen group dst list time:  0.0001537799835205078
time for parepare:  0.00029206275939941406
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0003666877746582031
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.001180410385131836
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0008985996246337891
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0008983612060546875
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.0010523796081542969
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0009682178497314453
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0011239051818847656
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0011856555938720703
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0006656646728515625
----------------------check_connections_block total spend ----------------------------- 0.014101266860961914
generate_one_block  0.0024302005767822266
generate_one_block  0.001964569091796875
generate_one_block  0.0019702911376953125
generate_one_block  0.0020432472229003906
generate_one_block  0.001968860626220703
generate_one_block  0.0021927356719970703
generate_one_block  0.002141237258911133
generate_one_block  0.0015878677368164062
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008177757263183594
gen group dst list time:  0.00028586387634277344
time for parepare:  0.00026988983154296875
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.002501964569091797
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.00030875205993652344
mini_batch_src_global generation:  0.00026917457580566406
r_  generation:  0.0021665096282958984
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.0003046989440917969
mini_batch_src_global generation:  0.0002155303955078125
r_  generation:  0.0019593238830566406
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.0001838207244873047
r_  generation:  0.0019180774688720703
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.001928091049194336
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.00027370452880859375
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.002061605453491211
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.001998424530029297
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0012230873107910156
----------------------check_connections_block total spend ----------------------------- 0.024973154067993164
generate_one_block  0.003479480743408203
generate_one_block  0.002936124801635742
generate_one_block  0.0029304027557373047
generate_one_block  0.003077983856201172
generate_one_block  0.003087759017944336
generate_one_block  0.0032367706298828125
generate_one_block  0.0033788681030273438
generate_one_block  0.002508878707885742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008225440979003906
gen group dst list time:  0.0003886222839355469
time for parepare:  0.00021767616271972656
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.0004994869232177734
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.002944469451904297
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0003044605255126953
r_  generation:  0.002752542495727539
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.00035119056701660156
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.002746105194091797
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.0029211044311523438
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.0003428459167480469
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.00284576416015625
local_output_nid generation:  0.00018405914306640625
local_in_edges_tensor generation:  0.00033545494079589844
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0026607513427734375
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.00032401084899902344
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0027167797088623047
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0021593570709228516
----------------------check_connections_block total spend ----------------------------- 0.0332486629486084
generate_one_block  0.004261016845703125
generate_one_block  0.004185914993286133
generate_one_block  0.0038733482360839844
generate_one_block  0.0040051937103271484
generate_one_block  0.003936290740966797
generate_one_block  0.004035472869873047
generate_one_block  0.00467991828918457
generate_one_block  0.003566741943359375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008072853088378906
gen group dst list time:  0.0004851818084716797
time for parepare:  0.00021600723266601562
local_output_nid generation:  0.00020813941955566406
local_in_edges_tensor generation:  0.0005352497100830078
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0032644271850585938
local_output_nid generation:  0.00020265579223632812
local_in_edges_tensor generation:  0.0003883838653564453
mini_batch_src_global generation:  0.0003292560577392578
r_  generation:  0.003261566162109375
local_output_nid generation:  0.0001976490020751953
local_in_edges_tensor generation:  0.00038433074951171875
mini_batch_src_global generation:  0.000278472900390625
r_  generation:  0.0032334327697753906
local_output_nid generation:  0.00020933151245117188
local_in_edges_tensor generation:  0.000396728515625
mini_batch_src_global generation:  0.00027179718017578125
r_  generation:  0.00334930419921875
local_output_nid generation:  0.00020742416381835938
local_in_edges_tensor generation:  0.00039124488830566406
mini_batch_src_global generation:  0.0002722740173339844
r_  generation:  0.003278017044067383
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.0003764629364013672
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.0029838085174560547
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation: Using backend: pytorch
 0.0003514289855957031
mini_batch_src_global generation:  0.0002560615539550781
r_  generation:  0.0030159950256347656
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.0028641223907470703
----------------------check_connections_block total spend ----------------------------- 0.0380549430847168
generate_one_block  0.00465083122253418
generate_one_block  0.004327535629272461
generate_one_block  0.004208564758300781
generate_one_block  0.004327535629272461
generate_one_block  0.004270315170288086
generate_one_block  0.004243373870849609
generate_one_block  0.004688262939453125
generate_one_block  0.004156351089477539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.268308162689209  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

connection checking time:  0.11578726768493652
block generation total time  0.1206827163696289
average batch blocks generation time:  0.015085339546203613
block dataloader generation time/epoch 0.34484243392944336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.26914453506469727  GigaBytes
Max Memory Allocated: 1.0529265403747559  GigaBytes

torch.Size([2387, 1433])
torch.Size([2241, 64])
torch.Size([1934, 64])
torch.Size([1207, 64])
torch.Size([502, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 1.134228229522705  GigaBytes
Max Memory Allocated: 1.1342682838439941  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.26912736892700195  GigaBytes
Max Memory Allocated: 1.1711101531982422  GigaBytes

torch.Size([2401, 1433])
torch.Size([2208, 64])
torch.Size([1757, 64])
torch.Size([987, 64])
torch.Size([356, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 1.124002456665039  GigaBytes
Max Memory Allocated: 1.1711101531982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.26807546615600586  GigaBytes
Max Memory Allocated: 1.1711101531982422  GigaBytes

torch.Size([2364, 1433])
torch.Size([2200, 64])
torch.Size([1762, 64])
torch.Size([1030, 64])
torch.Size([356, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 1.1156306266784668  GigaBytes
Max Memory Allocated: 1.1711101531982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 0.26913976669311523  GigaBytes
Max Memory Allocated: 1.1711101531982422  GigaBytes

torch.Size([2442, 1433])
torch.Size([2299, 64])
torch.Size([1881, 64])
torch.Size([1116, 64])
torch.Size([444, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5233154296875 GB
    Memory Allocated: 1.145859718322754  GigaBytes
Max Memory Allocated: 1.1711101531982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.2691349983215332  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

torch.Size([2395, 1433])
torch.Size([2242, 64])
torch.Size([1828, 64])
torch.Size([1120, 64])
torch.Size([411, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.1313962936401367  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.2681450843811035  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

torch.Size([2374, 1433])
torch.Size([2235, 64])
torch.Size([1927, 64])
torch.Size([1208, 64])
torch.Size([488, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.1306753158569336  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.2691521644592285  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

torch.Size([2411, 1433])
torch.Size([2286, 64])
torch.Size([1984, 64])
torch.Size([1336, 64])
torch.Size([503, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.1500787734985352  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 0.26799821853637695  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

torch.Size([2354, 1433])
torch.Size([2098, 64])
torch.Size([1484, 64])
torch.Size([731, 64])
torch.Size([267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.0833415985107422  GigaBytes
Max Memory Allocated: 1.185624122619629  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06249341368675232 |0.0015175938606262207 |0.28031212091445923 |0.00012993812561035156 |0.35971298813819885 |0.021078824996948242 |
----------------------------------------------------------pseudo_mini_loss sum 2.332719564437866
Total (block generation + training)time/epoch 6.067776679992676
Training time/epoch 5.722555875778198
Training time without block to device /epoch 5.7104151248931885
Training time without total dataloading part /epoch 5.142319202423096
load block tensor time/epoch 0.49994730949401855
block to device time/epoch 0.012140750885009766
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64315
Number of first layer input nodes during this epoch:  19128
