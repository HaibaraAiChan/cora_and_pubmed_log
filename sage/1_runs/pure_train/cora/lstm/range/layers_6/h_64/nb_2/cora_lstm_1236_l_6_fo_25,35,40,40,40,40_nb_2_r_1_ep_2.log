main start at this time 1648434071.2458239
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010843276977539062
range selection method range initialization spend 0.00010704994201660156
time for parepare:  7.200241088867188e-05
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0023233890533447266
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00013065338134765625
----------------------check_connections_block total spend ----------------------------- 0.0031883716583251953
generate_one_block  0.0014424324035644531
generate_one_block  0.0012350082397460938
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005245208740234375
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00015401840209960938
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0006625652313232422
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007810592651367188
----------------------check_connections_block total spend ----------------------------- 0.002614259719848633
generate_one_block  0.001851797103881836
generate_one_block  0.001991748809814453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005886554718017578
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.00017976760864257812
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.001720428466796875
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.001990795135498047
----------------------check_connections_block total spend ----------------------------- 0.0058825016021728516
generate_one_block  0.0030679702758789062
generate_one_block  0.003304004669189453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006406307220458984
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.00019669532775878906
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.00041174888610839844
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.0029642581939697266
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.002915620803833008
----------------------check_connections_block total spend ----------------------------- 0.00887155532836914
generate_one_block  0.00420379638671875
generate_one_block  0.004013538360595703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007357597351074219
gen group dst list time:  0.00011372566223144531
time for parepare:  0.0001957416534423828
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.00022125244140625
r_  generation:  0.0033071041107177734
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.0003788471221923828
mini_batch_src_global generation:  0.00029778480529785156
r_  generation:  0.0033113956451416016
----------------------check_connections_block total spend ----------------------------- 0.01000070571899414
generate_one_block  0.004587650299072266
generate_one_block  0.004197120666503906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007197856903076172
gen group dst list time:  0.0001220703125
time for parepare:  0.00019550323486328125
local_output_nid generation:  0.0001671314239501953
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0034308433532714844
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.00039005279541015625
mini_batch_src_global generation:  0.00031113624572753906
r_  generation:  0.0034058094024658203
----------------------check_connections_block total spend ----------------------------- 0.010276556015014648
generate_one_block  0.0048143863677978516
generate_one_block  0.005240678787231445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

connection checking time:  0.037645578384399414
block generation total time  0.03727269172668457
average batch blocks generation time:  0.018636345863342285
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07792139053344727  GigaBytes
Max Memory Allocated: 0.07792139053344727  GigaBytes

torch.Size([2499, 1433])
torch.Size([2450, 64])
torch.Size([2297, 64])
torch.Size([1865, 64])
torch.Size([1026, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2908935546875 GB
    Memory Allocated: 1.0285000801086426  GigaBytes
Max Memory Allocated: 1.0286202430725098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.14126062393188477  GigaBytes
Max Memory Allocated: 1.0367417335510254  GigaBytes

torch.Size([2480, 1433])
torch.Size([2433, 64])
torch.Size([2305, 64])
torch.Size([1928, 64])
torch.Size([1202, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.0953640937805176  GigaBytes
Max Memory Allocated: 1.0954914093017578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0433582067489624 |0.17066609859466553 |0.568229079246521 |0.00021791458129882812 |0.5396685600280762 |0.02117776870727539 |
----------------------------------------------------------pseudo_mini_loss sum 3.1119441986083984
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21185
Number of first layer input nodes during this epoch:  4979
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.2691044807434082  GigaBytes
Max Memory Allocated: 1.0965628623962402  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005350112915039062
range selection method range initialization spend 6.771087646484375e-05
time for parepare:  7.43865966796875e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00012874603271484375
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001423358917236328
----------------------check_connections_block total spend ----------------------------- 0.001058340072631836
generate_one_block  0.0013360977172851562
generate_one_block  0.0012760162353515625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005352497100830078
gen group dst list time:  3.528594970703125e-05
time for parepare:  0.0001659393310546875
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0007061958312988281
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0007417201995849609
----------------------check_connections_block total spend ----------------------------- 0.0027146339416503906
generate_one_block  0.002058744430541992
generate_one_block  0.0020723342895507812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006122589111328125
gen group dst list time:  6.604194641113281e-05
time for parepare:  0.00019931793212890625
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0018236637115478516
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.0003876686096191406
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.0020020008087158203
----------------------check_connections_block total spend ----------------------------- 0.006257295608520508
generate_one_block  0.0035898685455322266
generate_one_block  0.0034902095794677734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006589889526367188
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.00019550323486328125
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.00042247772216796875
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.002890348434448242
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0003342628479003906
r_  generation:  0.0029227733612060547
----------------------check_connections_block total spend ----------------------------- 0.009223461151123047
generate_one_block  0.004425048828125
generate_one_block  0.0042111873626708984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007586479187011719
gen group dst list time:  0.00011706352233886719
time for parepare:  0.00019931793212890625
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.0004801750183105469
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0033636093139648438
local_output_nid generation:  0.0001804828643798828
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0003159046173095703
r_  generation:  0.0034155845642089844
----------------------check_connections_block total spend ----------------------------- 0.010284900665283203
generate_one_block  0.004808664321899414
generate_one_block  0.004503726959228516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006968975067138672
gen group dst list time:  0.00013017654418945312
time for parepare:  0.00019788742065429688
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.001668691635131836
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.00344085693359375
local_output_nid generation:  0.000186920166015625
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0034058094024658203
----------------------check_connections_block total spend ----------------------------- 0.011681079864501953
generate_one_block  0.004923820495605469
generate_one_block  0.00522160530090332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.2691044807434082  GigaBytes
Max Memory Allocated: 1.0965628623962402  GigaBytes

connection checking time:  0.0401613712310791
block generation total time  0.03930521011352539
average batch blocks generation time:  0.019652605056762695
block dataloader generation time/epoch 0.112640380859375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6014404296875 GB
    Memory Allocated: 0.2685542106628418  GigaBytes
Max Memory Allocated: 1.0965628623962402  GigaBytes

torch.Size([2492, 1433])
torch.Size([2449, 64])
torch.Size([2310, 64])
torch.Size([1871, 64])
torch.Size([1051, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 1.2173871994018555  GigaBytes
Max Memory Allocated: 1.2175102233886719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 0.26856184005737305  GigaBytes
Max Memory Allocated: 1.2236785888671875  GigaBytes

torch.Size([2480, 1433])
torch.Size([2424, 64])
torch.Size([2288, 64])
torch.Size([1942, 64])
torch.Size([1177, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6561279296875 GB
    Memory Allocated: 1.2174673080444336  GigaBytes
Max Memory Allocated: 1.2236785888671875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04130244255065918 |0.0019794702529907227 |0.33450639247894287 |0.0001442432403564453 |0.5580989122390747 |0.01648402214050293 |
----------------------------------------------------------pseudo_mini_loss sum 2.5370421409606934
Total (block generation + training)time/epoch 2.064394474029541
Training time/epoch 1.9511959552764893
Training time without block to device /epoch 1.9472370147705078
Training time without total dataloading part /epoch 1.801983118057251
load block tensor time/epoch 0.08260488510131836
block to device time/epoch 0.003958940505981445
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21178
Number of first layer input nodes during this epoch:  4972
