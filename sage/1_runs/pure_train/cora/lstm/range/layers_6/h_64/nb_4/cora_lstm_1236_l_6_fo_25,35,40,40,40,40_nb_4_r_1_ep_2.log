main start at this time 1648434083.4081864
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013415813446044922
range selection method range initialization spend 0.00011897087097167969
time for parepare:  0.00011706352233886719
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0023756027221679688
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.000133514404296875
----------------------check_connections_block total spend ----------------------------- 0.004339694976806641
generate_one_block  0.002038717269897461
generate_one_block  0.001371145248413086
generate_one_block  0.0012941360473632812
generate_one_block  0.001316070556640625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006172657012939453
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00019478797912597656
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005095005035400391
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00045680999755859375
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004324913024902344
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005817413330078125
----------------------check_connections_block total spend ----------------------------- 0.0038328170776367188
generate_one_block  0.0018188953399658203
generate_one_block  0.0017466545104980469
generate_one_block  0.0017726421356201172
generate_one_block  0.0019059181213378906
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006728172302246094
gen group dst list time:  0.00010824203491210938
time for parepare:  0.00023674964904785156
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0003037452697753906
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.0014998912811279297
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.00148773193359375
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.001363515853881836
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0017971992492675781
----------------------check_connections_block total spend ----------------------------- 0.00989389419555664
generate_one_block  0.0029764175415039062
generate_one_block  0.002625703811645508
generate_one_block  0.0020961761474609375
generate_one_block  0.0024776458740234375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007071495056152344
gen group dst list time:  0.00018262863159179688
time for parepare:  0.00023412704467773438
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00043964385986328125
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.0029845237731933594
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.0026221275329589844
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.0022895336151123047
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0025742053985595703
----------------------check_connections_block total spend ----------------------------- 0.016123294830322266
generate_one_block  0.003826618194580078
generate_one_block  0.0033354759216308594
generate_one_block  0.0032608509063720703
generate_one_block  0.0035102367401123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007421970367431641
gen group dst list time:  0.0002002716064453125
time for parepare:  0.00019693374633789062
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.003196239471435547
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.0003266334533691406
r_  generation:  0.003050565719604492
local_output_nid generation:  0.0001537799835205078
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.0031037330627441406
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003554821014404297
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.003106832504272461
----------------------check_connections_block total spend ----------------------------- 0.01860833168029785
generate_one_block  0.004050731658935547
generate_one_block  0.00399470329284668
generate_one_block  0.003929615020751953
generate_one_block  0.00397038459777832
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007658004760742188
gen group dst list time:  0.00022983551025390625
time for parepare:  0.000194549560546875
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0006093978881835938
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.0033769607543945312
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.0003750324249267578
mini_batch_src_global generation:  0.0002942085266113281
r_  generation:  0.003295421600341797
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.003309965133666992
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.0003769397735595703
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.00333404541015625
----------------------check_connections_block total spend ----------------------------- 0.02002882957458496
generate_one_block  0.004389047622680664
generate_one_block  0.004072904586791992
generate_one_block  0.004103183746337891
generate_one_block  0.00422215461730957
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06398439407348633  GigaBytes
Max Memory Allocated: 0.06398439407348633  GigaBytes

connection checking time:  0.06848716735839844
block generation total time  0.0640859603881836
average batch blocks generation time:  0.0160214900970459
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07789325714111328  GigaBytes
Max Memory Allocated: 0.07789325714111328  GigaBytes

torch.Size([2469, 1433])
torch.Size([2400, 64])
torch.Size([2196, 64])
torch.Size([1540, 64])
torch.Size([703, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.0091581344604492  GigaBytes
Max Memory Allocated: 1.0092248916625977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3631591796875 GB
    Memory Allocated: 0.14121341705322266  GigaBytes
Max Memory Allocated: 1.0315313339233398  GigaBytes

torch.Size([2434, 1433])
torch.Size([2337, 64])
torch.Size([2091, 64])
torch.Size([1518, 64])
torch.Size([671, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4139404296875 GB
    Memory Allocated: 1.0481867790222168  GigaBytes
Max Memory Allocated: 1.0482521057128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.14121150970458984  GigaBytes
Max Memory Allocated: 1.073366641998291  GigaBytes

torch.Size([2448, 1433])
torch.Size([2347, 64])
torch.Size([2110, 64])
torch.Size([1411, 64])
torch.Size([642, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 1.052750587463379  GigaBytes
Max Memory Allocated: 1.073366641998291  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4451904296875 GB
    Memory Allocated: 0.14122962951660156  GigaBytes
Max Memory Allocated: 1.07989501953125  GigaBytes

torch.Size([2434, 1433])
torch.Size([2363, 64])
torch.Size([2159, 64])
torch.Size([1638, 64])
torch.Size([839, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4510498046875 GB
    Memory Allocated: 1.0634098052978516  GigaBytes
Max Memory Allocated: 1.07989501953125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05671703815460205 |0.08645939826965332 |0.4218870997428894 |0.00014960765838623047 |0.41958558559417725 |0.020708799362182617 |
----------------------------------------------------------pseudo_mini_loss sum 3.496420383453369
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37481
Number of first layer input nodes during this epoch:  9785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5760498046875 GB
    Memory Allocated: 0.26900577545166016  GigaBytes
Max Memory Allocated: 1.080502986907959  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006630420684814453
range selection method range initialization spend 8.940696716308594e-05
time for parepare:  0.00010967254638671875
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  9.34600830078125e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.463859558105469e-05
----------------------check_connections_block total spend ----------------------------- 0.0016121864318847656
generate_one_block  0.0015163421630859375
generate_one_block  0.0014300346374511719
generate_one_block  0.0014023780822753906
generate_one_block  0.0014209747314453125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006387233734130859
gen group dst list time:  5.984306335449219e-05
time for parepare:  0.000225067138671875
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0004992485046386719
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0004906654357910156
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0004971027374267578
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0005650520324707031
----------------------check_connections_block total spend ----------------------------- 0.0042722225189208984
generate_one_block  0.002045869827270508
generate_one_block  0.0019540786743164062
generate_one_block  0.001959562301635742
generate_one_block  0.002031564712524414
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007140636444091797
gen group dst list time:  0.00011801719665527344
time for parepare:  0.0002505779266357422
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0003829002380371094
mini_batch_src_global generation:  0.0001850128173828125
r_  generation:  0.0014960765838623047
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0015113353729248047
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0016703605651855469
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.0016987323760986328
----------------------check_connections_block total spend ----------------------------- 0.010703802108764648
generate_one_block  0.0031664371490478516
generate_one_block  0.002596616744995117
generate_one_block  0.0025932788848876953
generate_one_block  0.0027244091033935547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007531642913818359
gen group dst list time:  0.0002067089080810547
time for parepare:  0.00024962425231933594
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.002785921096801758
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  0.00034689903259277344
r_  generation:  0.0029218196868896484
local_output_nid generation:  0.00019168853759765625
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation: Using backend: pytorch
 0.0003037452697753906
r_  generation:  0.003093719482421875
local_output_nid generation:  0.0001990795135498047
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.0025620460510253906
----------------------check_connections_block total spend ----------------------------- 0.017961978912353516
generate_one_block  0.0038051605224609375
generate_one_block  0.0036268234252929688
generate_one_block  0.0037059783935546875
generate_one_block  0.003697633743286133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007619857788085938
gen group dst list time:  0.000274658203125
time for parepare:  0.00025725364685058594
local_output_nid generation:  0.00023245811462402344
local_in_edges_tensor generation:  0.0005421638488769531
mini_batch_src_global generation:  0.0002751350402832031
r_  generation:  0.0037512779235839844
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0004379749298095703
mini_batch_src_global generation:  0.0004291534423828125
r_  generation:  0.003896474838256836
local_output_nid generation:  0.0002472400665283203
local_in_edges_tensor generation:  0.000438690185546875
mini_batch_src_global generation:  0.0003440380096435547
r_  generation:  0.003345489501953125
local_output_nid generation:  0.0001857280731201172
local_in_edges_tensor generation:  0.00036334991455078125
mini_batch_src_global generation:  0.0002694129943847656
r_  generation:  0.0031592845916748047
----------------------check_connections_block total spend ----------------------------- 0.0217742919921875
generate_one_block  0.004300832748413086
generate_one_block  0.0042264461517333984
generate_one_block  0.004210710525512695
generate_one_block  0.004194974899291992
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008413791656494141
gen group dst list time:  0.0003147125244140625
time for parepare:  0.0002613067626953125
local_output_nid generation:  0.0002541542053222656
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.0003154277801513672
r_  generation:  0.004124641418457031
local_output_nid generation:  0.0002758502960205078
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.0004067420959472656
r_  generation:  0.004182577133178711
local_output_nid generation:  0.0002713203430175781
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.00035071372985839844
r_  generation:  0.0034046173095703125
local_output_nid generation:  0.00020265579223632812
local_in_edges_tensor generation:  0.0003857612609863281
mini_batch_src_global generation:  0.00029206275939941406
r_  generation:  0.0032815933227539062
----------------------check_connections_block total spend ----------------------------- 0.023000001907348633
generate_one_block  0.0053157806396484375
generate_one_block  0.004394054412841797
generate_one_block  0.0043523311614990234
generate_one_block  0.004593372344970703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5760498046875 GB
    Memory Allocated: 0.26900577545166016  GigaBytes
Max Memory Allocated: 1.080502986907959  GigaBytes

connection checking time:  0.0777122974395752
block generation total time  0.06949591636657715
average batch blocks generation time:  0.017373979091644287
block dataloader generation time/epoch 0.21415376663208008
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5760498046875 GB
    Memory Allocated: 0.2685108184814453  GigaBytes
Max Memory Allocated: 1.080502986907959  GigaBytes

torch.Size([2431, 1433])
torch.Size([2305, 64])
torch.Size([2048, 64])
torch.Size([1403, 64])
torch.Size([670, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 1.1570758819580078  GigaBytes
Max Memory Allocated: 1.1571407318115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.26851749420166016  GigaBytes
Max Memory Allocated: 1.18556547164917  GigaBytes

torch.Size([2455, 1433])
torch.Size([2368, 64])
torch.Size([2106, 64])
torch.Size([1482, 64])
torch.Size([638, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 1.185802936553955  GigaBytes
Max Memory Allocated: 1.1858735084533691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.2685260772705078  GigaBytes
Max Memory Allocated: 1.2117962837219238  GigaBytes

torch.Size([2442, 1433])
torch.Size([2363, 64])
torch.Size([2129, 64])
torch.Size([1588, 64])
torch.Size([755, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 1.1916537284851074  GigaBytes
Max Memory Allocated: 1.2117962837219238  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 0.2685270309448242  GigaBytes
Max Memory Allocated: 1.2137880325317383  GigaBytes

torch.Size([2424, 1433])
torch.Size([2348, 64])
torch.Size([2129, 64])
torch.Size([1597, 64])
torch.Size([759, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6268310546875 GB
    Memory Allocated: 1.185720443725586  GigaBytes
Max Memory Allocated: 1.2137880325317383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.053204894065856934 |0.0015060901641845703 |0.31938105821609497 |0.00015753507614135742 |0.4167579412460327 |0.015291929244995117 |
----------------------------------------------------------pseudo_mini_loss sum 2.09244966506958
Total (block generation + training)time/epoch 3.45798921585083
Training time/epoch 3.2435786724090576
Training time without block to device /epoch 3.2375543117523193
Training time without total dataloading part /epoch 2.9604780673980713
load block tensor time/epoch 0.21281957626342773
block to device time/epoch 0.006024360656738281
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37165
Number of first layer input nodes during this epoch:  9752
