main start at this time 1648434018.2927065
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014553070068359375
range selection method range initialization spend 0.00011515617370605469
time for parepare:  6.365776062011719e-05
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0018732547760009766
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.910064697265625e-05
----------------------check_connections_block total spend ----------------------------- 0.0037038326263427734
generate_one_block  0.0012426376342773438
generate_one_block  0.000993490219116211
generate_one_block  0.0009908676147460938
generate_one_block  0.0010213851928710938
generate_one_block  0.0009996891021728516
generate_one_block  0.0009808540344238281
generate_one_block  0.0010597705841064453
generate_one_block  0.0010025501251220703
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004696846008300781
gen group dst list time:  5.412101745605469e-05
time for parepare:  0.00013375282287597656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002703666687011719
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00020551681518554688
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000194549560546875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000225067138671875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00018477439880371094
----------------------check_connections_block total spend ----------------------------- 0.003851175308227539
generate_one_block  0.0012912750244140625
generate_one_block  0.001249074935913086
generate_one_block  0.0012514591217041016
generate_one_block  0.0011677742004394531
generate_one_block  0.0012516975402832031
generate_one_block  0.0012278556823730469
generate_one_block  0.001222848892211914
generate_one_block  0.001216888427734375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006895065307617188
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.0001983642578125
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0008957386016845703
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0007827281951904297
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0007812976837158203
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006773471832275391
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0007309913635253906
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0006573200225830078
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008006095886230469
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0006163120269775391
----------------------check_connections_block total spend ----------------------------- 0.010121583938598633
generate_one_block  0.002091646194458008
generate_one_block  0.0018076896667480469
generate_one_block  0.001901865005493164
generate_one_block  0.0018377304077148438
generate_one_block  0.0017631053924560547
generate_one_block  0.001703500747680664
generate_one_block  0.0019021034240722656
generate_one_block  0.0016813278198242188
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007455348968505859
gen group dst list time:  0.00019288063049316406
time for parepare:  0.00017380714416503906
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00041103363037109375
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.0019385814666748047
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.0015990734100341797
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0018734931945800781
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.001516580581665039
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.0017385482788085938
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.001501321792602539
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0017769336700439453
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0016663074493408203
----------------------check_connections_block total spend ----------------------------- 0.021132230758666992
generate_one_block  0.003981828689575195
generate_one_block  0.002803802490234375
generate_one_block  0.003167390823364258
generate_one_block  0.002699613571166992
generate_one_block  0.002917051315307617
generate_one_block  0.0026531219482421875
generate_one_block  0.003038167953491211
generate_one_block  0.0028891563415527344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007541179656982422
gen group dst list time:  0.00033783912658691406
time for parepare:  0.0001838207244873047
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.0004432201385498047
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.0027163028717041016
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.0023758411407470703
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0026154518127441406
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.0002970695495605469
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0024352073669433594
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0025670528411865234
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.002374410629272461
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0025396347045898438
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.0025255680084228516
----------------------check_connections_block total spend ----------------------------- 0.030532360076904297
generate_one_block  0.004652261734008789
generate_one_block  0.004062652587890625
generate_one_block  0.0037581920623779297
generate_one_block  0.00362396240234375
generate_one_block  0.003887653350830078
generate_one_block  0.003643035888671875
generate_one_block  0.004537820816040039
generate_one_block  0.0037598609924316406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007753372192382812
gen group dst list time:  0.0004565715789794922
time for parepare:  0.00018286705017089844
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.0029802322387695312
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.0002963542938232422
r_  generation:  0.0027909278869628906
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.0029735565185546875
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.002843141555786133
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0003688335418701172
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.0029401779174804688
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0028264522552490234
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0003368854522705078
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.0028831958770751953
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.00033402442932128906
mini_batch_src_global generation:  0.0002541542053222656
r_  generation:  0.002907276153564453
----------------------check_connections_block total spend ----------------------------- 0.03479146957397461
generate_one_block  0.004434108734130859
generate_one_block  0.004746913909912109
generate_one_block  0.0040247440338134766
generate_one_block  0.004006147384643555
generate_one_block  0.004052400588989258
generate_one_block  0.0039920806884765625
generate_one_block  0.004026174545288086
generate_one_block  0.004050493240356445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

connection checking time:  0.10042881965637207
block generation total time  0.11397647857666016
average batch blocks generation time:  0.01424705982208252
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07697296142578125  GigaBytes
Max Memory Allocated: 0.07697296142578125  GigaBytes

torch.Size([2395, 1433])
torch.Size([2273, 32])
torch.Size([1985, 32])
torch.Size([1336, 32])
torch.Size([545, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1815185546875 GB
    Memory Allocated: 0.9128012657165527  GigaBytes
Max Memory Allocated: 0.9468059539794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 0.13813304901123047  GigaBytes
Max Memory Allocated: 0.9842138290405273  GigaBytes

torch.Size([2328, 1433])
torch.Size([2127, 32])
torch.Size([1717, 32])
torch.Size([1030, 32])
torch.Size([423, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3240966796875 GB
    Memory Allocated: 0.9376163482666016  GigaBytes
Max Memory Allocated: 0.9842138290405273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 0.1382923126220703  GigaBytes
Max Memory Allocated: 1.0154294967651367  GigaBytes

torch.Size([2355, 1433])
torch.Size([2226, 32])
torch.Size([1922, 32])
torch.Size([1212, 32])
torch.Size([453, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 0.9612512588500977  GigaBytes
Max Memory Allocated: 1.0154294967651367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 0.13937711715698242  GigaBytes
Max Memory Allocated: 1.0347490310668945  GigaBytes

torch.Size([2397, 1433])
torch.Size([2186, 32])
torch.Size([1698, 32])
torch.Size([993, 32])
torch.Size([392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 0.9601898193359375  GigaBytes
Max Memory Allocated: 1.0347490310668945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3553466796875 GB
    Memory Allocated: 0.1393885612487793  GigaBytes
Max Memory Allocated: 1.0384979248046875  GigaBytes

torch.Size([2418, 1433])
torch.Size([2278, 32])
torch.Size([1910, 32])
torch.Size([1117, 32])
torch.Size([411, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9775805473327637  GigaBytes
Max Memory Allocated: 1.0384979248046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.13837480545043945  GigaBytes
Max Memory Allocated: 1.052330493927002  GigaBytes

torch.Size([2374, 1433])
torch.Size([2203, 32])
torch.Size([1740, 32])
torch.Size([955, 32])
torch.Size([387, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.951786994934082  GigaBytes
Max Memory Allocated: 1.052330493927002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.13939428329467773  GigaBytes
Max Memory Allocated: 1.052330493927002  GigaBytes

torch.Size([2402, 1433])
torch.Size([2250, 32])
torch.Size([1878, 32])
torch.Size([1196, 32])
torch.Size([451, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.9746222496032715  GigaBytes
Max Memory Allocated: 1.052330493927002  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.13938474655151367  GigaBytes
Max Memory Allocated: 1.052330493927002  GigaBytes

torch.Size([2420, 1433])
torch.Size([2265, 32])
torch.Size([1861, 32])
torch.Size([1060, 32])
torch.Size([338, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4061279296875 GB
    Memory Allocated: 0.982966423034668  GigaBytes
Max Memory Allocated: 1.052330493927002  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06360593438148499 |0.04324054718017578 |0.3418678641319275 |0.0001519620418548584 |0.37755364179611206 |0.021239519119262695 |
----------------------------------------------------------pseudo_mini_loss sum 3.214548110961914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64659
Number of first layer input nodes during this epoch:  19089
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.2652573585510254  GigaBytes
Max Memory Allocated: 1.0591320991516113  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007143020629882812
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  8.225440979003906e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.267692565917969e-05
----------------------check_connections_block total spend ----------------------------- 0.002141237258911133
generate_one_block  0.001268148422241211
generate_one_block  0.0010938644409179688
generate_one_block  0.00112152099609375
generate_one_block  0.0010449886322021484
generate_one_block  0.0010800361633300781
generate_one_block  0.001092672348022461
generate_one_block  0.0010368824005126953
generate_one_block  0.0010273456573486328
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005707740783691406
gen group dst list time:  6.67572021484375e-05
time for parepare:  0.00020599365234375
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0002655982971191406
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00022411346435546875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0002837181091308594
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00017642974853515625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00024366378784179688
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002548694610595703
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001914501190185547
----------------------check_connections_block total spend ----------------------------- 0.00433349609375
generate_one_block  0.0015306472778320312
generate_one_block  0.0012891292572021484
generate_one_block  0.0014536380767822266
generate_one_block  0.0012044906616210938
generate_one_block  0.0013267993927001953
generate_one_block  0.00138092041015625
generate_one_block  0.0012049674987792969
generate_one_block  0.0012340545654296875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00072479248046875
gen group dst list time:  0.00011801719665527344
time for parepare:  0.00022745132446289062
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0008332729339599609
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0007691383361816406
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0009398460388183594
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0005543231964111328
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0008695125579833984
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0007889270782470703
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0005576610565185547
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0006232261657714844
----------------------check_connections_block total spend ----------------------------- 0.010799646377563477
generate_one_block  0.002187490463256836
generate_one_block  0.001950979232788086
generate_one_block  0.002228975296020508
generate_one_block  0.001684427261352539
generate_one_block  0.002012491226196289
generate_one_block  0.0021123886108398438
generate_one_block  0.0017087459564208984
generate_one_block  0.001714468002319336
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007882118225097656
gen group dst list time:  0.0002129077911376953
time for parepare:  0.00020241737365722656
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.00038743019104003906
mini_batch_src_global generation:  0.00022125244140625
r_  generation:  0.0019042491912841797
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.0016150474548339844
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.00021195411682128906
r_  generation:  0.001986980438232422
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0015289783477783203
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.0018894672393798828
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0017399787902832031
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0014951229095458984
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.001371622085571289
----------------------check_connections_block total spend ----------------------------- 0.021533966064453125
generate_one_block  0.003337860107421875
generate_one_block  0.0030171871185302734
generate_one_block  0.0033872127532958984
generate_one_block  0.0027861595153808594
generate_one_block  0.0031585693359375
generate_one_block  0.003126859664916992
generate_one_block  0.0028378963470458984
generate_one_block  0.002674579620361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007910728454589844
gen group dst list time:  0.00035762786865234375
time for parepare:  0.0001914501190185547
local_output_nid generation:  0.00016164779663085938
local_in_edges_tensor generation:  0.0004868507385253906
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0027260780334472656
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0003211498260498047
mini_batch_src_global generation:  0.00033092498779296875
r_  generation:  0.0024738311767578125
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  0.0002665519714355469
r_  generation:  0.0026984214782714844
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0023653507232666016
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.00032210350036621094
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.002716064453125
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003159046173095703
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0026154518127441406
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.0025162696838378906
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002230405807495117
----------------------check_connections_block total spend ----------------------------- 0.03143644332885742
generate_one_block  0.0042324066162109375
generate_one_block  0.004235506057739258
generate_one_block  0.004076957702636719
generate_one_block  0.004308462142944336
generate_one_block  0.004025936126708984
generate_one_block  0.004004478454589844
generate_one_block  0.003945589065551758
generate_one_block  0.0036079883575439453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007984638214111328
gen group dst list time:  0.00045561790466308594
time for parepare:  0.00020742416381835938
local_output_nid generation:  0.00018715858459472656
local_in_edges_tensor generation:  0.0004968643188476562
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0030832290649414062
local_output_nid generation:  0.0001850128173828125
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0003180503845214844
r_  generation:  0.002929210662841797
local_output_nid generation:  0.00018906593322753906
local_in_edges_tensor generation:  0.0003485679626464844
mini_batch_src_global generation:  0.00028967857360839844
r_  generation:  0.0029768943786621094
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.0028429031372070312
local_output_nid generation:  0.0001971721649169922
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.003114938735961914
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.0029883384704589844
local_output_nid generation:  0.0001857280731201172
local_in_edges_tensor generation:  0.0003457069396972656Using backend: pytorch

mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.0029630661010742188
local_output_nid generation:  0.00017309188842773438
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0027923583984375
----------------------check_connections_block total spend ----------------------------- 0.03592061996459961
generate_one_block  0.004743099212646484
generate_one_block  0.004391670227050781
generate_one_block  0.004400968551635742
generate_one_block  0.004202127456665039
generate_one_block  0.004310131072998047
generate_one_block  0.004924297332763672
generate_one_block  0.004706382751464844
generate_one_block  0.004126071929931641
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.2652573585510254  GigaBytes
Max Memory Allocated: 1.0591320991516113  GigaBytes

connection checking time:  0.10402417182922363
block generation total time  0.11879301071166992
average batch blocks generation time:  0.01484912633895874
block dataloader generation time/epoch 0.3290896415710449
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.26490354537963867  GigaBytes
Max Memory Allocated: 1.0591320991516113  GigaBytes

torch.Size([2433, 1433])
torch.Size([2310, 32])
torch.Size([1923, 32])
torch.Size([1192, 32])
torch.Size([485, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.1205477714538574  GigaBytes
Max Memory Allocated: 1.1590638160705566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.2648892402648926  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2403, 1433])
torch.Size([2213, 32])
torch.Size([1761, 32])
torch.Size([1017, 32])
torch.Size([410, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 1.0942001342773438  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4998779296875 GB
    Memory Allocated: 0.26491212844848633  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2410, 1433])
torch.Size([2268, 32])
torch.Size([1960, 32])
torch.Size([1317, 32])
torch.Size([537, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.1037397384643555  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26380252838134766  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2360, 1433])
torch.Size([2125, 32])
torch.Size([1631, 32])
torch.Size([883, 32])
torch.Size([309, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.0689616203308105  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26490259170532227  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2416, 1433])
torch.Size([2289, 32])
torch.Size([1931, 32])
torch.Size([1196, 32])
torch.Size([446, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.1094021797180176  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26489973068237305  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2427, 1433])
torch.Size([2289, 32])
torch.Size([1895, 32])
torch.Size([1113, 32])
torch.Size([459, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.1069903373718262  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26488351821899414  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2399, 1433])
torch.Size([2255, 32])
torch.Size([1786, 32])
torch.Size([922, 32])
torch.Size([307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.097261905670166  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.2636709213256836  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

torch.Size([2336, 1433])
torch.Size([2090, 32])
torch.Size([1561, 32])
torch.Size([840, 32])
torch.Size([308, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 1.0541601181030273  GigaBytes
Max Memory Allocated: 1.1937885284423828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061401933431625366 |0.0014354586601257324 |0.28064823150634766 |0.00012865662574768066 |0.37811043858528137 |0.016903400421142578 |
----------------------------------------------------------pseudo_mini_loss sum 2.382272720336914
Total (block generation + training)time/epoch 6.189633369445801
Training time/epoch 5.860279321670532
Training time without block to device /epoch 5.848795652389526
Training time without total dataloading part /epoch 5.288002014160156
load block tensor time/epoch 0.49121546745300293
block to device time/epoch 0.01148366928100586
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  63964
Number of first layer input nodes during this epoch:  19184
