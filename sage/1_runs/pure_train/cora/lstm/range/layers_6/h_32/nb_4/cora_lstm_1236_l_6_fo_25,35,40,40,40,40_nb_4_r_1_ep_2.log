main start at this time 1648434002.529195
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0012836456298828125
range selection method range initialization spend 0.00011181831359863281
time for parepare:  6.580352783203125e-05
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.002846240997314453
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.004106044769287109
generate_one_block  0.0015175342559814453
generate_one_block  0.0011000633239746094
generate_one_block  0.0010581016540527344
generate_one_block  0.0010902881622314453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005047321319580078
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.000148773193359375
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00045490264892578125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00039458274841308594
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003819465637207031
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0004467964172363281
----------------------check_connections_block total spend ----------------------------- 0.0032067298889160156
generate_one_block  0.001583099365234375
generate_one_block  0.0014524459838867188
generate_one_block  0.0015254020690917969
generate_one_block  0.0014772415161132812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005846023559570312
gen group dst list time:  7.748603820800781e-05
time for parepare:  0.0001709461212158203
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.001394510269165039
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0012123584747314453
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0012238025665283203
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0012383460998535156
----------------------check_connections_block total spend ----------------------------- 0.008177995681762695
generate_one_block  0.00267791748046875
generate_one_block  0.0024361610412597656
generate_one_block  0.0023124217987060547
generate_one_block  0.0023348331451416016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007390975952148438
gen group dst list time:  0.000133514404296875
time for parepare:  0.00019121170043945312
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.002488374710083008
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.002313852310180664
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.002362489700317383
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.002413034439086914
----------------------check_connections_block total spend ----------------------------- 0.014493703842163086
generate_one_block  0.0038499832153320312
generate_one_block  0.003358602523803711
generate_one_block  0.003381967544555664
generate_one_block  0.0034308433532714844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007650852203369141
gen group dst list time:  0.000186920166015625
time for parepare:  0.00019311904907226562
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.00048160552978515625
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0030651092529296875
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.000316619873046875
r_  generation:  0.0029752254486083984
local_output_nid generation:  0.00015592575073242188
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.0030972957611083984
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0029916763305664062
----------------------check_connections_block total spend ----------------------------- 0.01828169822692871
generate_one_block  0.005021095275878906
generate_one_block  0.003947734832763672
generate_one_block  0.004021883010864258
generate_one_block  0.003961086273193359
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007767677307128906
gen group dst list time:  0.00021767616271972656
time for parepare:  0.0001952648162841797
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.0006077289581298828
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.003203868865966797
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0003979206085205078
mini_batch_src_global generation:  0.0003452301025390625
r_  generation:  0.0031821727752685547
local_output_nid generation:  0.0001742839813232422
local_in_edges_tensor generation:  0.0003762245178222656
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.0032851696014404297
local_output_nid generation:  0.00016736984252929688
local_in_edges_tensor generation:  0.0003643035888671875
mini_batch_src_global generation:  0.0002753734588623047
r_  generation:  0.0032355785369873047
----------------------check_connections_block total spend ----------------------------- 0.01971745491027832
generate_one_block  0.004441022872924805
generate_one_block  0.004949808120727539
generate_one_block  0.004197120666503906
generate_one_block  0.004117012023925781
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

connection checking time:  0.06387758255004883
block generation total time  0.06447768211364746
average batch blocks generation time:  0.016119420528411865
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07700157165527344  GigaBytes
Max Memory Allocated: 0.07700157165527344  GigaBytes

torch.Size([2433, 1433])
torch.Size([2361, 32])
torch.Size([2187, 32])
torch.Size([1668, 32])
torch.Size([832, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2244873046875 GB
    Memory Allocated: 0.9582934379577637  GigaBytes
Max Memory Allocated: 0.9870939254760742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 0.13942241668701172  GigaBytes
Max Memory Allocated: 1.0215373039245605  GigaBytes

torch.Size([2431, 1433])
torch.Size([2354, 32])
torch.Size([2093, 32])
torch.Size([1523, 32])
torch.Size([692, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3690185546875 GB
    Memory Allocated: 1.0195565223693848  GigaBytes
Max Memory Allocated: 1.0514721870422363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4002685546875 GB
    Memory Allocated: 0.13942337036132812  GigaBytes
Max Memory Allocated: 1.0855498313903809  GigaBytes

torch.Size([2476, 1433])
torch.Size([2413, 32])
torch.Size([2175, 32])
torch.Size([1527, 32])
torch.Size([711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 1.024228572845459  GigaBytes
Max Memory Allocated: 1.0855498313903809  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.13942623138427734  GigaBytes
Max Memory Allocated: 1.0894842147827148  GigaBytes

torch.Size([2440, 1433])
torch.Size([2360, 32])
torch.Size([2129, 32])
torch.Size([1560, 32])
torch.Size([711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 1.0208148956298828  GigaBytes
Max Memory Allocated: 1.0894842147827148  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05954927206039429 |0.08601176738739014 |0.4236651659011841 |0.00017344951629638672 |0.4189058542251587 |0.008718729019165039 |
----------------------------------------------------------pseudo_mini_loss sum 3.1683349609375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37814
Number of first layer input nodes during this epoch:  9780
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.26538944244384766  GigaBytes
Max Memory Allocated: 1.0894842147827148  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005545616149902344
range selection method range initialization spend 9.465217590332031e-05
time for parepare:  8.058547973632812e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.842613220214844e-05
----------------------check_connections_block total spend ----------------------------- 0.0013914108276367188
generate_one_block  0.0012257099151611328
generate_one_block  0.0011448860168457031
generate_one_block  0.0011296272277832031
generate_one_block  0.0011057853698730469
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005290508270263672
gen group dst list time:  4.744529724121094e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00041294097900390625
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.000438690185546875
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.00047326087951660156
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0003707408905029297
----------------------check_connections_block total spend ----------------------------- 0.003475189208984375
generate_one_block  0.0015952587127685547
generate_one_block  0.0015730857849121094
generate_one_block  0.001651763916015625
generate_one_block  0.0015022754669189453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005817413330078125
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.00019812583923339844
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0011951923370361328
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00019168853759765625
r_  generation:  0.001252889633178711
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.0015225410461425781
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0011279582977294922
----------------------check_connections_block total spend ----------------------------- 0.008571863174438477
generate_one_block  0.0025925636291503906
generate_one_block  0.002566814422607422
generate_one_block  0.002678394317626953
generate_one_block  0.004614353179931641
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008480548858642578
gen group dst list time:  0.0001533031463623047
time for parepare:  0.0001957416534423828
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00044226646423339844
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.0023398399353027344
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.0002453327178955078
r_  generation:  0.0023393630981445312
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation: Using backend: pytorch
 0.0002491474151611328
r_  generation:  0.0026433467864990234
local_output_nid generation:  0.00012636184692382812
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.002331972122192383
----------------------check_connections_block total spend ----------------------------- 0.015097618103027344
generate_one_block  0.0038712024688720703
generate_one_block  0.003548860549926758
generate_one_block  0.003754854202270508
generate_one_block  0.0035047531127929688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000812530517578125
gen group dst list time:  0.00020074844360351562
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.002966165542602539
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.00034236907958984375
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0028831958770751953
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.003081083297729492
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.00026035308837890625
r_  generation:  0.002899169921875
----------------------check_connections_block total spend ----------------------------- 0.018164396286010742
generate_one_block  0.004240512847900391
generate_one_block  0.00406336784362793
generate_one_block  0.004213094711303711
generate_one_block  0.00413060188293457
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00078582763671875
gen group dst list time:  0.00021648406982421875
time for parepare:  0.00019359588623046875
local_output_nid generation:  0.0001823902130126953
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.003190279006958008
local_output_nid generation:  0.00018858909606933594
local_in_edges_tensor generation:  0.0003657341003417969
mini_batch_src_global generation:  0.00030422210693359375
r_  generation:  0.0031125545501708984
local_output_nid generation:  0.00019502639770507812
local_in_edges_tensor generation:  0.0003871917724609375
mini_batch_src_global generation:  0.00027489662170410156
r_  generation:  0.003264904022216797
local_output_nid generation:  0.000202178955078125
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.00028634071350097656
r_  generation:  0.003161907196044922
----------------------check_connections_block total spend ----------------------------- 0.0192105770111084
generate_one_block  0.005212068557739258
generate_one_block  0.004281282424926758
generate_one_block  0.00435328483581543
generate_one_block  0.004540920257568359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.26538944244384766  GigaBytes
Max Memory Allocated: 1.0894842147827148  GigaBytes

connection checking time:  0.06451964378356934
block generation total time  0.06848931312561035
average batch blocks generation time:  0.017122328281402588
block dataloader generation time/epoch 0.20224952697753906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.26492786407470703  GigaBytes
Max Memory Allocated: 1.0894842147827148  GigaBytes

torch.Size([2443, 1433])
torch.Size([2360, 32])
torch.Size([2093, 32])
torch.Size([1485, 32])
torch.Size([684, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.1388654708862305  GigaBytes
Max Memory Allocated: 1.172070026397705  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.26492786407470703  GigaBytes
Max Memory Allocated: 1.205596923828125  GigaBytes

torch.Size([2411, 1433])
torch.Size([2295, 32])
torch.Size([2045, 32])
torch.Size([1493, 32])
torch.Size([690, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.1112451553344727  GigaBytes
Max Memory Allocated: 1.205596923828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.26494407653808594  GigaBytes
Max Memory Allocated: 1.205596923828125  GigaBytes

torch.Size([2467, 1433])
torch.Size([2407, 32])
torch.Size([2207, 32])
torch.Size([1691, 32])
torch.Size([822, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.1492905616760254  GigaBytes
Max Memory Allocated: 1.205596923828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 0.2649250030517578  GigaBytes
Max Memory Allocated: 1.2113842964172363  GigaBytes

torch.Size([2406, 1433])
torch.Size([2321, 32])
torch.Size([2072, 32])
torch.Size([1430, 32])
torch.Size([614, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5467529296875 GB
    Memory Allocated: 1.1160821914672852  GigaBytes
Max Memory Allocated: 1.2113842964172363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05374819040298462 |0.001096487045288086 |0.3039681911468506 |0.00013709068298339844 |0.4159237742424011 |0.01629328727722168 |
----------------------------------------------------------pseudo_mini_loss sum 2.4056131839752197
Total (block generation + training)time/epoch 3.3823978900909424
Training time/epoch 3.179839849472046
Training time without block to device /epoch 3.1754539012908936
Training time without total dataloading part /epoch 2.896409511566162
load block tensor time/epoch 0.21499276161193848
block to device time/epoch 0.004385948181152344
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37174
Number of first layer input nodes during this epoch:  9727
