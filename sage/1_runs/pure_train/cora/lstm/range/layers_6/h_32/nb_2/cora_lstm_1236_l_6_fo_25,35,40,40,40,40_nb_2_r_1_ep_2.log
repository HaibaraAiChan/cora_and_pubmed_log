main start at this time 1648433989.7337968
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0012564659118652344
range selection method range initialization spend 8.153915405273438e-05
time for parepare:  6.079673767089844e-05
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0013818740844726562
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00011801719665527344
----------------------check_connections_block total spend ----------------------------- 0.0021834373474121094
generate_one_block  0.0013995170593261719
generate_one_block  0.0012087821960449219
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005106925964355469
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.00014066696166992188
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0007259845733642578
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0007276535034179688
----------------------check_connections_block total spend ----------------------------- 0.0026094913482666016
generate_one_block  0.0019078254699707031
generate_one_block  0.001811981201171875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005762577056884766
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0001761913299560547
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0017888545989990234
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0017442703247070312
----------------------check_connections_block total spend ----------------------------- 0.005623579025268555
generate_one_block  0.0030982494354248047
generate_one_block  0.003058910369873047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006151199340820312
gen group dst list time:  8.392333984375e-05
time for parepare:  0.00017547607421875
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00039267539978027344
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0028710365295410156
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00024271011352539062
r_  generation:  0.0027587413787841797
----------------------check_connections_block total spend ----------------------------- 0.008345842361450195
generate_one_block  0.003996372222900391
generate_one_block  0.0038623809814453125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007436275482177734
gen group dst list time:  0.00010323524475097656
time for parepare:  0.00017404556274414062
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0004589557647705078
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.003032207489013672
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.00029540061950683594
r_  generation:  0.0030672550201416016
----------------------check_connections_block total spend ----------------------------- 0.009315252304077148
generate_one_block  0.004221916198730469
generate_one_block  0.004135847091674805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007326602935791016
gen group dst list time:  0.00011134147644042969
time for parepare:  0.0001735687255859375
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.000438690185546875
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.003078460693359375
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.00308990478515625
----------------------check_connections_block total spend ----------------------------- 0.009361982345581055
generate_one_block  0.005039215087890625
generate_one_block  0.004233121871948242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06308698654174805  GigaBytes
Max Memory Allocated: 0.06308698654174805  GigaBytes

connection checking time:  0.035256147384643555
block generation total time  0.03536581993103027
average batch blocks generation time:  0.017682909965515137
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07703065872192383  GigaBytes
Max Memory Allocated: 0.07703065872192383  GigaBytes

torch.Size([2477, 1433])
torch.Size([2433, 32])
torch.Size([2305, 32])
torch.Size([1942, 32])
torch.Size([1154, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2420654296875 GB
    Memory Allocated: 0.9789977073669434  GigaBytes
Max Memory Allocated: 1.002737045288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3358154296875 GB
    Memory Allocated: 0.13946294784545898  GigaBytes
Max Memory Allocated: 1.0346293449401855  GigaBytes

torch.Size([2497, 1433])
torch.Size([2460, 32])
torch.Size([2325, 32])
torch.Size([1920, 32])
torch.Size([1110, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.0402617454528809  GigaBytes
Max Memory Allocated: 1.065162181854248  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04562711715698242 |0.17454838752746582 |0.556602954864502 |0.00016748905181884766 |0.42790162563323975 |0.021601200103759766 |
----------------------------------------------------------pseudo_mini_loss sum 3.1165380477905273
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21329
Number of first layer input nodes during this epoch:  4974
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 0.2655043601989746  GigaBytes
Max Memory Allocated: 1.0956664085388184  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005321502685546875
range selection method range initialization spend 6.818771362304688e-05
time for parepare:  7.462501525878906e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00013136863708496094
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00012254714965820312
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00012969970703125
----------------------check_connections_block total spend ----------------------------- 0.0010304450988769531
generate_one_block  0.0012865066528320312
generate_one_block  0.0012359619140625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005104541778564453
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00016236305236816406
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0006666183471679688
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0007135868072509766
----------------------check_connections_block total spend ----------------------------- 0.0025930404663085938
generate_one_block  0.002023935317993164
generate_one_block  0.0019884109497070312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007219314575195312
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0018029212951660156
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.0017926692962646484
----------------------check_connections_block total spend ----------------------------- 0.005818605422973633
generate_one_block  0.0035452842712402344
generate_one_block  0.003215789794921875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006365776062011719
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00018548965454101562
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.00040912628173828125
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.0029625892639160156
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.0003094673156738281
r_  generation:  0.0027327537536621094
----------------------check_connections_block total spend ----------------------------- 0.011116981506347656
generate_one_block  0.004213571548461914
generate_one_block  0.003980398178100586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007920265197753906
gen group dst list time:  0.00010943412780761719
time for parepare:  0.0001933574676513672
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0004928112030029297
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.0032095909118652344
local_output_nid generation:  0.0001704692840576172
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.0003001689910888672
r_  generation:  0.0031850337982177734
----------------------check_connections_block total spend ----------------------------- 0.00996255874633789
generate_one_block  0.004587888717651367
generate_one_block  0.004488468170166016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006630420684814453
gen group dst list time:  0.000125885009765625
time for parepare:  0.000186920166015625
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.003291606903076172
local_output_nid generation:  0.0001819133758544922
local_in_edges_tensor generation:  0.00037741661071777344
mini_batch_src_global generation:  0.00030112266540527344
r_  generation:  0.0033104419708251953
----------------------check_connections_block total spend ----------------------------- 0.010102033615112305
generate_one_block  0.004682064056396484
generate_one_block  0.005211591720581055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 0.2655043601989746  GigaBytes
Max Memory Allocated: 1.0956664085388184  GigaBytes

connection checking time:  0.03959321975708008
block generation total time  0.03793740272521973
average batch blocks generation time:  0.018968701362609863
block dataloader generation time/epoch 0.11039519309997559
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 0.2649693489074707  GigaBytes
Max Memory Allocated: 1.0956664085388184  GigaBytes

torch.Size([2513, 1433])
torch.Size([2464, 32])
torch.Size([2316, 32])
torch.Size([1907, 32])
torch.Size([1113, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.165419578552246  GigaBytes
Max Memory Allocated: 1.1906352043151855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.2649693489074707  GigaBytes
Max Memory Allocated: 1.22172212600708  GigaBytes

torch.Size([2503, 1433])
torch.Size([2455, 32])
torch.Size([2320, 32])
torch.Size([1868, 32])
torch.Size([1092, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.1666550636291504  GigaBytes
Max Memory Allocated: 1.22172212600708  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03799009323120117 |0.0011512041091918945 |0.33368003368377686 |0.00014829635620117188 |0.44149041175842285 |0.015378475189208984 |
----------------------------------------------------------pseudo_mini_loss sum 2.469862699508667
Total (block generation + training)time/epoch 1.8175475597381592
Training time/epoch 1.7068805694580078
Training time without block to device /epoch 1.704578161239624
Training time without total dataloading part /epoch 1.5660159587860107
load block tensor time/epoch 0.07598018646240234
block to device time/epoch 0.002302408218383789
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21253
Number of first layer input nodes during this epoch:  5016
