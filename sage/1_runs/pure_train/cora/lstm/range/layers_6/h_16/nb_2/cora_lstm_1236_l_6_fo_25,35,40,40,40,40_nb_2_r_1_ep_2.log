main start at this time 1648433907.8364623
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010128021240234375
range selection method range initialization spend 8.606910705566406e-05
time for parepare:  6.890296936035156e-05
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0015561580657958984
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001308917999267578
----------------------check_connections_block total spend ----------------------------- 0.0024590492248535156
generate_one_block  0.0016143321990966797
generate_one_block  0.0012211799621582031
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005128383636474609
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0007309913635253906
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006814002990722656
----------------------check_connections_block total spend ----------------------------- 0.002543210983276367
generate_one_block  0.0019428730010986328
generate_one_block  0.0018153190612792969
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006060600280761719
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.0001780986785888672
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.001850128173828125
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00018930435180664062
r_  generation:  0.0017933845520019531
----------------------check_connections_block total spend ----------------------------- 0.0057718753814697266
generate_one_block  0.0031783580780029297
generate_one_block  0.003072500228881836
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006303787231445312
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.00019240379333496094
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0030031204223632812
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.0003094673156738281
r_  generation:  0.0028116703033447266
----------------------check_connections_block total spend ----------------------------- 0.008913755416870117
generate_one_block  0.0041811466217041016
generate_one_block  0.003928422927856445
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007560253143310547
gen group dst list time:  0.00011086463928222656
time for parepare:  0.00019884109497070312
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0033037662506103516
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.00029587745666503906
r_  generation:  0.003289461135864258
----------------------check_connections_block total spend ----------------------------- 0.009933710098266602
generate_one_block  0.004558086395263672
generate_one_block  0.004255533218383789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007379055023193359
gen group dst list time:  0.00011992454528808594
time for parepare:  0.00019431114196777344
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.0034041404724121094
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.00039196014404296875
mini_batch_src_global generation:  0.0003070831298828125
r_  generation:  0.003416299819946289
----------------------check_connections_block total spend ----------------------------- 0.01032400131225586
generate_one_block  0.004735469818115234
generate_one_block  0.005266666412353516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

connection checking time:  0.03748655319213867
block generation total time  0.03693437576293945
average batch blocks generation time:  0.018467187881469727
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07671976089477539  GigaBytes
Max Memory Allocated: 0.07671976089477539  GigaBytes

torch.Size([2471, 1433])
torch.Size([2424, 16])
torch.Size([2294, 16])
torch.Size([1882, 16])
torch.Size([1114, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2225341796875 GB
    Memory Allocated: 0.9478602409362793  GigaBytes
Max Memory Allocated: 0.9971528053283691  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 0.13883543014526367  GigaBytes
Max Memory Allocated: 1.027933120727539  GigaBytes

torch.Size([2501, 1433])
torch.Size([2443, 16])
torch.Size([2282, 16])
torch.Size([1858, 16])
torch.Size([1061, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3690185546875 GB
    Memory Allocated: 1.009770393371582  GigaBytes
Max Memory Allocated: 1.059913158416748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04135477542877197 |0.16943609714508057 |0.5582334995269775 |0.00019407272338867188 |0.43606746196746826 |0.02169489860534668 |
----------------------------------------------------------pseudo_mini_loss sum 2.579667091369629
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21011
Number of first layer input nodes during this epoch:  4972
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.2642388343811035  GigaBytes
Max Memory Allocated: 1.0912632942199707  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005297660827636719
range selection method range initialization spend 6.794929504394531e-05
time for parepare:  7.605552673339844e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00014328956604003906
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00012636184692382812
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00013566017150878906
----------------------check_connections_block total spend ----------------------------- 0.0010504722595214844
generate_one_block  0.0013473033905029297
generate_one_block  0.0012536048889160156
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005235671997070312
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.00016021728515625
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0007877349853515625
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0006680488586425781
----------------------check_connections_block total spend ----------------------------- 0.0027036666870117188
generate_one_block  0.0021715164184570312
generate_one_block  0.0019257068634033203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006084442138671875
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.002003192901611328
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0017902851104736328
----------------------check_connections_block total spend ----------------------------- 0.006067514419555664
generate_one_block  0.0037453174591064453
generate_one_block  0.003249645233154297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006475448608398438
gen group dst list time:  9.298324584960938e-05
time for parepare:  0.00019979476928710938
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0004210472106933594
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.002996683120727539
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.0003139972686767578
r_  generation:  0.0028624534606933594
----------------------check_connections_block total spend ----------------------------- 0.009080648422241211
generate_one_block  0.004431486129760742
generate_one_block  0.004088163375854492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008275508880615234
gen group dst list time:  0.00011539459228515625
time for parepare:  0.00020360946655273438
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0002384185791015625
r_  generation:  0.003385305404663086
local_output_nid generation:  0.00018024444580078125
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.00030994415283203125
r_  generation:  0.0033638477325439453
----------------------check_connections_block total spend ----------------------------- 0.010330677032470703
generate_one_block  0.004821062088012695
generate_one_block  0.004432201385498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006833076477050781
gen group dst list time:  0.00012373924255371094
time for parepare:  0.00019669532775878906
local_output_nid generation:  0.00018286705017089844
local_in_edges_tensor generation:  0.0004761219024658203
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.0034508705139160156
local_output_nid generation:  0.000186920166015625
local_in_edges_tensor generation:  0.00039386749267578125
mini_batch_src_global generation:  0.0003123283386230469
r_  generation:  0.0034601688385009766
----------------------check_connections_block total spend ----------------------------- 0.010532617568969727
generate_one_block  0.004915952682495117
generate_one_block  0.005273580551147461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.2642388343811035  GigaBytes
Max Memory Allocated: 1.0912632942199707  GigaBytes

connection checking time:  0.03871512413024902
block generation total time  0.03905463218688965
average batch blocks generation time:  0.019527316093444824
block dataloader generation time/epoch 0.11214065551757812
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 0.26373815536499023  GigaBytes
Max Memory Allocated: 1.0912632942199707  GigaBytes

torch.Size([2495, 1433])
torch.Size([2452, 16])
torch.Size([2314, 16])
torch.Size([1934, 16])
torch.Size([1175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.139592170715332  GigaBytes
Max Memory Allocated: 1.1889195442199707  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 0.26372861862182617  GigaBytes
Max Memory Allocated: 1.2202105522155762  GigaBytes

torch.Size([2508, 1433])
torch.Size([2458, 16])
torch.Size([2323, 16])
torch.Size([1862, 16])
torch.Size([1027, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5799560546875 GB
    Memory Allocated: 1.1382055282592773  GigaBytes
Max Memory Allocated: 1.2202105522155762  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04194784164428711 |0.001842498779296875 |0.3269834518432617 |0.00013577938079833984 |0.4480116367340088 |0.01622748374938965 |
----------------------------------------------------------pseudo_mini_loss sum 2.0323121547698975
Total (block generation + training)time/epoch 1.8277661800384521
Training time/epoch 1.715341567993164
Training time without block to device /epoch 1.7116565704345703
Training time without total dataloading part /epoch 1.5664892196655273
load block tensor time/epoch 0.08389568328857422
block to device time/epoch 0.00368499755859375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21241
Number of first layer input nodes during this epoch:  5003
