main start at this time 1648433936.2273245
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001409769058227539
range selection method range initialization spend 0.00011992454528808594
time for parepare:  8.034706115722656e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.003840208053588867
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.4809112548828125e-05
----------------------check_connections_block total spend ----------------------------- 0.006120204925537109
generate_one_block  0.0018048286437988281
generate_one_block  0.0014190673828125
generate_one_block  0.0013349056243896484
generate_one_block  0.0012555122375488281
generate_one_block  0.0012938976287841797
generate_one_block  0.001201629638671875
generate_one_block  0.0011031627655029297
generate_one_block  0.0009663105010986328
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006203651428222656
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.000186920166015625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00029969215393066406
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00032210350036621094
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.000324249267578125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002818107604980469
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001876354217529297
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002677440643310547
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00018739700317382812
----------------------check_connections_block total spend ----------------------------- 0.004882097244262695
generate_one_block  0.0015721321105957031
generate_one_block  0.0015895366668701172
generate_one_block  0.0016102790832519531
generate_one_block  0.0015702247619628906
generate_one_block  0.0014197826385498047
generate_one_block  0.0015833377838134766
generate_one_block  0.0012099742889404297
generate_one_block  0.0011148452758789062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006573200225830078
gen group dst list time:  0.0001423358917236328
time for parepare:  0.00026035308837890625
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.000997304916381836
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0010075569152832031
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.001131296157836914
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0010342597961425781
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006532669067382812
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0012133121490478516
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0008711814880371094
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0007550716400146484
----------------------check_connections_block total spend ----------------------------- 0.013030052185058594
generate_one_block  0.0023331642150878906
generate_one_block  0.0019001960754394531
generate_one_block  0.001973867416381836
generate_one_block  0.0019562244415283203
generate_one_block  0.001491546630859375
generate_one_block  0.0020182132720947266
generate_one_block  0.001706838607788086
generate_one_block  0.0015206336975097656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007317066192626953
gen group dst list time:  0.0002536773681640625
time for parepare:  0.00024318695068359375
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0003998279571533203
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.002283334732055664
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.002292633056640625
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.00023698806762695312
r_  generation:  0.0023865699768066406
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0022788047790527344
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.001482248306274414
local_output_nid generation:  0.00010442733764648438
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0021457672119140625
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0016734600067138672
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0012760162353515625
----------------------check_connections_block total spend ----------------------------- 0.02485346794128418
generate_one_block  0.003071308135986328
generate_one_block  0.0029239654541015625
generate_one_block  0.0032334327697753906
generate_one_block  0.0029060840606689453
generate_one_block  0.0025005340576171875
generate_one_block  0.0031380653381347656
generate_one_block  0.002840757369995117
generate_one_block  0.0024442672729492188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007481575012207031
gen group dst list time:  0.0005102157592773438
time for parepare:  0.0002467632293701172
local_output_nid generation:  0.00017952919006347656
local_in_edges_tensor generation:  0.0005164146423339844
mini_batch_src_global generation:  0.000324249267578125
r_  generation:  0.003482341766357422
local_output_nid generation:  0.00018668174743652344
local_in_edges_tensor generation:  0.0003993511199951172
mini_batch_src_global generation:  0.0003795623779296875
r_  generation:  0.0034148693084716797
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation:  0.00040912628173828125
mini_batch_src_global generation:  0.0003173351287841797
r_  generation:  0.003236055374145508
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.0028340816497802734
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.00030875205993652344
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.002378225326538086
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.002667665481567383
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.002459287643432617
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.0022242069244384766
----------------------check_connections_block total spend ----------------------------- 0.03453803062438965
generate_one_block  0.004686117172241211
generate_one_block  0.00426936149597168
generate_one_block  0.0038099288940429688
generate_one_block  0.004514217376708984
generate_one_block  0.003519296646118164
generate_one_block  0.003844738006591797
generate_one_block  0.0036530494689941406
generate_one_block  0.0034351348876953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007948875427246094
gen group dst list time:  0.0006036758422851562
time for parepare:  0.00025081634521484375
local_output_nid generation:  0.0002143383026123047
local_in_edges_tensor generation:  0.0005886554718017578
mini_batch_src_global generation:  0.000324249267578125
r_  generation:  0.003192424774169922
local_output_nid generation:  0.00016808509826660156
local_in_edges_tensor generation:  0.0003752708435058594
mini_batch_src_global generation:  0.0003476142883300781
r_  generation:  0.003231048583984375
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.00037741661071777344
mini_batch_src_global generation:  0.00028324127197265625
r_  generation:  0.0032417774200439453
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0031964778900146484
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0030896663665771484
local_output_nid generation:  0.0001747608184814453
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.0029993057250976562
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.0028667449951171875
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00032258033752441406
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.002753734588623047
----------------------check_connections_block total spend ----------------------------- 0.03720831871032715
generate_one_block  0.005240440368652344
generate_one_block  0.004097700119018555
generate_one_block  0.0040340423583984375
generate_one_block  0.004010915756225586
generate_one_block  0.003919363021850586
generate_one_block  0.004171848297119141
generate_one_block  0.00408625602722168
generate_one_block  0.0040509700775146484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

connection checking time:  0.11451196670532227
block generation total time  0.11497259140014648
average batch blocks generation time:  0.01437157392501831
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07545089721679688  GigaBytes
Max Memory Allocated: 0.07545089721679688  GigaBytes

torch.Size([2337, 1433])
torch.Size([2211, 16])
torch.Size([1883, 16])
torch.Size([1115, 16])
torch.Size([426, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1405029296875 GB
    Memory Allocated: 0.8753881454467773  GigaBytes
Max Memory Allocated: 0.929194450378418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2342529296875 GB
    Memory Allocated: 0.13877058029174805  GigaBytes
Max Memory Allocated: 0.9668307304382324  GigaBytes

torch.Size([2417, 1433])
torch.Size([2275, 16])
torch.Size([1849, 16])
torch.Size([1134, 16])
torch.Size([416, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2908935546875 GB
    Memory Allocated: 0.9666357040405273  GigaBytes
Max Memory Allocated: 1.0210871696472168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.1387782096862793  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

torch.Size([2384, 1433])
torch.Size([2261, 16])
torch.Size([1919, 16])
torch.Size([1161, 16])
torch.Size([507, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.9563431739807129  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.1376652717590332  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

torch.Size([2354, 1433])
torch.Size([2218, 16])
torch.Size([1863, 16])
torch.Size([1103, 16])
torch.Size([461, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.9426264762878418  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.1375727653503418  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

torch.Size([2342, 1433])
torch.Size([2144, 16])
torch.Size([1660, 16])
torch.Size([843, 16])
torch.Size([264, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.9203462600708008  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.13878679275512695  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

torch.Size([2472, 1433])
torch.Size([2360, 16])
torch.Size([2010, 16])
torch.Size([1305, 16])
torch.Size([531, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.9940066337585449  GigaBytes
Max Memory Allocated: 1.0573911666870117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1387629508972168  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

torch.Size([2396, 1433])
torch.Size([2241, 16])
torch.Size([1819, 16])
torch.Size([1043, 16])
torch.Size([388, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.9555163383483887  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13767528533935547  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

torch.Size([2361, 1433])
torch.Size([2134, 16])
torch.Size([1616, 16])
torch.Size([811, 16])
torch.Size([275, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.9163742065429688  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061200857162475586 |0.043504804372787476 |0.34006890654563904 |0.00015246868133544922 |0.3790551424026489 |0.020773649215698242 |
----------------------------------------------------------pseudo_mini_loss sum 2.6207523345947266
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64061
Number of first layer input nodes during this epoch:  19063
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.2635307312011719  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009593963623046875
range selection method range initialization spend 8.511543273925781e-05
time for parepare:  8.797645568847656e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.743171691894531e-05
----------------------check_connections_block total spend ----------------------------- 0.0021867752075195312
generate_one_block  0.0012943744659423828
generate_one_block  0.0011663436889648438
generate_one_block  0.001138925552368164
generate_one_block  0.0011408329010009766
generate_one_block  0.0010991096496582031
generate_one_block  0.0011489391326904297
generate_one_block  0.001111745834350586
generate_one_block  0.0010869503021240234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005631446838378906
gen group dst list time:  6.747245788574219e-05
time for parepare:  0.0002124309539794922
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003070831298828125
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0003485679626464844
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00027489662170410156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00022673606872558594
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00023055076599121094
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00020003318786621094
----------------------check_connections_block total spend ----------------------------- 0.00465846061706543
generate_one_block  0.0016546249389648438
generate_one_block  0.0015230178833007812
generate_one_block  0.001413106918334961
generate_one_block  0.0013623237609863281
generate_one_block  0.0012631416320800781
generate_one_block  0.0014371871948242188
generate_one_block  0.0013232231140136719
generate_one_block  0.0012352466583251953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007336139678955078
gen group dst list time:  0.00012564659118652344
time for parepare:  0.0002493858337402344
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0010118484497070312
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.0012068748474121094
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0008955001831054688
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0006937980651855469
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0005679130554199219
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.00091552734375
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0007517337799072266
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0006418228149414062
----------------------check_connections_block total spend ----------------------------- 0.011893749237060547
generate_one_block  0.0024652481079101562
generate_one_block  0.0025413036346435547
generate_one_block  0.0020067691802978516
generate_one_block  0.0019254684448242188
generate_one_block  0.00162506103515625
generate_one_block  0.0021758079528808594
generate_one_block  0.0018391609191894531
generate_one_block  0.0017428398132324219
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007672309875488281
gen group dst list time:  0.00023174285888671875
time for parepare:  0.00021529197692871094
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.00215911865234375
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00029015541076660156
r_  generation:  0.0023674964904785156
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.002321481704711914
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.00024962425231933594
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.001676321029663086
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00016379356384277344
r_  generation:  0.0014836788177490234
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.0021479129791259766
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0019299983978271484
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0013873577117919922
----------------------check_connections_block total spend ----------------------------- 0.024243593215942383
generate_one_block  0.003591775894165039
generate_one_block  0.0035681724548339844
generate_one_block  0.003236532211303711
generate_one_block  0.0028219223022460938
generate_one_block  0.0026268959045410156
generate_one_block  0.003330230712890625
generate_one_block  0.003053903579711914
generate_one_block  0.002689838409423828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007903575897216797
gen group dst list time:  0.00039196014404296875
time for parepare:  0.00022101402282714844
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.000476837158203125
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.0030019283294677734
local_output_nid generation:  0.00018978118896484375
local_in_edges_tensor generation:  0.0003762245178222656
mini_batch_src_global generation:  0.0003399848937988281
r_  generation:  0.0031299591064453125
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.00034308433532714844
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0027952194213867188
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.0026845932006835938
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.002397298812866211
local_output_nid generation:  0.00018286705017089844
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.0029554367065429688
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.0025756359100341797
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.0022919178009033203
----------------------check_connections_block total spend ----------------------------- 0.033310651779174805
generate_one_block  0.0042858123779296875
generate_one_block  0.004621982574462891
generate_one_block  0.0038712024688720703
generate_one_block  0.0037987232208251953
generate_one_block  0.003528594970703125
generate_one_block  0.00410008430480957
generate_one_block  0.003919839859008789
generate_one_block  0.0036857128143310547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008261203765869141
gen group dst list time:  0.00044274330139160156
time for parepare:  0.00021958351135253906
local_output_nid generation:  0.0001990795135498047
local_in_edges_tensor generation:  0.0005199909210205078
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.003351449966430664
local_output_nid generation:  0.00021314620971679688
local_in_edges_tensor generation:  0.00040602684020996094
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.0034227371215820312
local_output_nid generation:  0.00019884109497070312
local_in_edges_tensor generation:  0.00037598609924316406
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.00318145751953125
local_output_nid generation:  0.0001952648162841797
local_in_edges_tensor generation:  0.00037384033203125
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0032100677490234375
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0002694129943847656
r_  generation:  0.0027980804443359375
local_output_nid generation:  0.00019407272338867188
local_in_edges_tensor generation:  0.00034689903259277344
mini_batch_src_global generation:  0.0002675056457519531
r_  generation:  0.002997159957885742
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation: Using backend: pytorch
 0.0003452301025390625
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0029289722442626953
local_output_nid generation:  0.0001842975616455078
local_in_edges_tensor generation:  0.00034165382385253906
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.0029163360595703125
----------------------check_connections_block total spend ----------------------------- 0.03766894340515137
generate_one_block  0.004518985748291016
generate_one_block  0.005128145217895508
generate_one_block  0.004180908203125
generate_one_block  0.00422358512878418
generate_one_block  0.004076957702636719
generate_one_block  0.004387855529785156
generate_one_block  0.004565238952636719
generate_one_block  0.0042302608489990234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.2635307312011719  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

connection checking time:  0.11177539825439453
block generation total time  0.11957669258117676
average batch blocks generation time:  0.014947086572647095
block dataloader generation time/epoch 0.3384718894958496
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 0.26432371139526367  GigaBytes
Max Memory Allocated: 1.0824766159057617  GigaBytes

torch.Size([2405, 1433])
torch.Size([2295, 16])
torch.Size([1962, 16])
torch.Size([1274, 16])
torch.Size([532, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4705810546875 GB
    Memory Allocated: 1.0914111137390137  GigaBytes
Max Memory Allocated: 1.1444587707519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5018310546875 GB
    Memory Allocated: 0.26433801651000977  GigaBytes
Max Memory Allocated: 1.1797795295715332  GigaBytes

torch.Size([2474, 1433])
torch.Size([2378, 16])
torch.Size([2062, 16])
torch.Size([1415, 16])
torch.Size([611, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.1251335144042969  GigaBytes
Max Memory Allocated: 1.1797795295715332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.2631525993347168  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

torch.Size([2344, 1433])
torch.Size([2177, 16])
torch.Size([1814, 16])
torch.Size([1164, 16])
torch.Size([450, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0527377128601074  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.2632441520690918  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

torch.Size([2364, 1433])
torch.Size([2182, 16])
torch.Size([1703, 16])
torch.Size([948, 16])
torch.Size([328, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.063094139099121  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.2629823684692383  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

torch.Size([2318, 1433])
torch.Size([2045, 16])
torch.Size([1496, 16])
torch.Size([818, 16])
torch.Size([269, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0246262550354004  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.26432371139526367  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

torch.Size([2428, 1433])
torch.Size([2306, 16])
torch.Size([1998, 16])
torch.Size([1266, 16])
torch.Size([476, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.098114013671875  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.2632589340209961  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

torch.Size([2365, 1433])
torch.Size([2216, 16])
torch.Size([1861, 16])
torch.Size([1082, 16])
torch.Size([375, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0701231956481934  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.26429128646850586  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

torch.Size([2422, 1433])
torch.Size([2193, 16])
torch.Size([1608, 16])
torch.Size([861, 16])
torch.Size([319, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0723376274108887  GigaBytes
Max Memory Allocated: 1.2113251686096191  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06082725524902344 |0.0012955069541931152 |0.2837999165058136 |0.00012674927711486816 |0.37934067845344543 |0.017240047454833984 |
----------------------------------------------------------pseudo_mini_loss sum 2.2187745571136475
Total (block generation + training)time/epoch 6.227914810180664
Training time/epoch 5.8891847133636475
Training time without block to device /epoch 5.8788206577301025
Training time without total dataloading part /epoch 5.323378801345825
load block tensor time/epoch 0.4866180419921875
block to device time/epoch 0.010364055633544922
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64355
Number of first layer input nodes during this epoch:  19120
