main start at this time 1648433920.4613779
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001493215560913086
range selection method range initialization spend 0.00010538101196289062
time for parepare:  7.772445678710938e-05
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0028717517852783203
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  9.393692016601562e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.534027099609375e-05
----------------------check_connections_block total spend ----------------------------- 0.0042345523834228516
generate_one_block  0.0015263557434082031
generate_one_block  0.0013093948364257812
generate_one_block  0.0012507438659667969
generate_one_block  0.0012409687042236328
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005831718444824219
gen group dst list time:  4.887580871582031e-05
time for parepare:  0.00016641616821289062
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005218982696533203
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0004787445068359375
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004558563232421875
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00043964385986328125
----------------------check_connections_block total spend ----------------------------- 0.0036346912384033203
generate_one_block  0.0018270015716552734
generate_one_block  0.0017251968383789062
generate_one_block  0.0017936229705810547
generate_one_block  0.0016658306121826172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006906986236572266
gen group dst list time:  0.00010156631469726562
time for parepare:  0.0002231597900390625
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.001493692398071289
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0014998912811279297
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0014889240264892578
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0014235973358154297
----------------------check_connections_block total spend ----------------------------- 0.009593009948730469
generate_one_block  0.002934694290161133
generate_one_block  0.0025396347045898438
generate_one_block  0.0023479461669921875
generate_one_block  0.0022115707397460938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007452964782714844
gen group dst list time:  0.0001678466796875
time for parepare:  0.0002276897430419922
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0004305839538574219
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.002855062484741211
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.0003268718719482422
r_  generation:  0.0028574466705322266
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.002971649169921875
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.002214193344116211
----------------------check_connections_block total spend ----------------------------- 0.016756772994995117
generate_one_block  0.003587007522583008
generate_one_block  0.0034151077270507812
generate_one_block  0.0034720897674560547
generate_one_block  0.003295421600341797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007889270782470703
gen group dst list time:  0.00023674964904785156
time for parepare:  0.00023293495178222656
local_output_nid generation:  0.00018739700317382812
local_in_edges_tensor generation:  0.0005528926849365234
mini_batch_src_global generation:  0.00030422210693359375
r_  generation:  0.006953716278076172
local_output_nid generation:  0.0003249645233154297
local_in_edges_tensor generation:  0.0007755756378173828
mini_batch_src_global generation:  0.0006861686706542969
r_  generation:  0.004473447799682617
local_output_nid generation:  0.00021958351135253906
local_in_edges_tensor generation:  0.0005168914794921875
mini_batch_src_global generation:  0.0003654956817626953
r_  generation:  0.003995656967163086
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.002874135971069336
----------------------check_connections_block total spend ----------------------------- 0.027518033981323242
generate_one_block  0.004680156707763672
generate_one_block  0.0039730072021484375
generate_one_block  0.0039920806884765625
generate_one_block  0.003952741622924805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007746219635009766
gen group dst list time:  0.0002148151397705078
time for parepare:  0.0001926422119140625
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0006012916564941406
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.003288745880126953
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.003159046173095703
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0032515525817871094
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.0002703666687011719
r_  generation:  0.0031571388244628906
----------------------check_connections_block total spend ----------------------------- 0.01955413818359375
generate_one_block  0.005026817321777344
generate_one_block  0.004114389419555664
generate_one_block  0.004167079925537109
generate_one_block  0.004109621047973633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06277799606323242  GigaBytes
Max Memory Allocated: 0.06277799606323242  GigaBytes

connection checking time:  0.0770566463470459
block generation total time  0.06483101844787598
average batch blocks generation time:  0.016207754611968994
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1580810546875 GB
    Memory Allocated: 0.07668685913085938  GigaBytes
Max Memory Allocated: 0.07668685913085938  GigaBytes

torch.Size([2449, 1433])
torch.Size([2365, 16])
torch.Size([2156, 16])
torch.Size([1541, 16])
torch.Size([733, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2088623046875 GB
    Memory Allocated: 0.9363374710083008  GigaBytes
Max Memory Allocated: 0.9878964424133301  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 0.1388072967529297  GigaBytes
Max Memory Allocated: 1.0219488143920898  GigaBytes

torch.Size([2412, 1433])
torch.Size([2331, 16])
torch.Size([2146, 16])
torch.Size([1568, 16])
torch.Size([740, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3533935546875 GB
    Memory Allocated: 0.9805402755737305  GigaBytes
Max Memory Allocated: 1.0315155982971191  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.1388101577758789  GigaBytes
Max Memory Allocated: 1.0659699440002441  GigaBytes

torch.Size([2479, 1433])
torch.Size([2404, 16])
torch.Size([2177, 16])
torch.Size([1610, 16])
torch.Size([725, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 1.0005407333374023  GigaBytes
Max Memory Allocated: 1.0659699440002441  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 0.13880062103271484  GigaBytes
Max Memory Allocated: 1.0857458114624023  GigaBytes

torch.Size([2444, 1433])
torch.Size([2351, 16])
torch.Size([2066, 16])
torch.Size([1468, 16])
torch.Size([679, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4373779296875 GB
    Memory Allocated: 0.9942770004272461  GigaBytes
Max Memory Allocated: 1.0857458114624023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05730694532394409 |0.08651500940322876 |0.4211657643318176 |0.00017011165618896484 |0.4216286540031433 |0.00882101058959961 |
----------------------------------------------------------pseudo_mini_loss sum 2.73935866355896
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37569
Number of first layer input nodes during this epoch:  9784
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.264129638671875  GigaBytes
Max Memory Allocated: 1.0857458114624023  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.000583648681640625
range selection method range initialization spend 7.414817810058594e-05
time for parepare:  8.344650268554688e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.05718994140625e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.246566772460938e-05
----------------------check_connections_block total spend ----------------------------- 0.00135040283203125
generate_one_block  0.0012700557708740234
generate_one_block  0.0011632442474365234
generate_one_block  0.0011477470397949219
generate_one_block  0.001108407974243164
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005116462707519531
gen group dst list time:  4.5299530029296875e-05
time for parepare:  0.00017786026000976562
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.00052642822265625
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.00039196014404296875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00035953521728515625
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003790855407714844
----------------------check_connections_block total spend ----------------------------- 0.0034227371215820312
generate_one_block  0.0018444061279296875
generate_one_block  0.0015647411346435547
generate_one_block  0.0015532970428466797
generate_one_block  0.0015540122985839844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005884170532226562
gen group dst list time:  8.392333984375e-05
time for parepare:  0.00019979476928710938
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.0003173351287841797
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0015649795532226562
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.0011463165283203125
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0011649131774902344
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0011560916900634766
----------------------check_connections_block total spend ----------------------------- 0.008463144302368164
generate_one_block  0.003023386001586914
generate_one_block  0.002505779266357422
generate_one_block  0.002357006072998047
generate_one_block  0.002480745315551758
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007529258728027344
gen group dst list time:  0.00014781951904296875
time for parepare:  0.00019431114196777344
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.0025513172149658203
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.00031685829162597656
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.002220630645751953
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0002875328063964844
mini_batch_src_global generation: Using backend: pytorch
 0.0002040863037109375
r_  generation:  0.002321481704711914
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.0023458003997802734
----------------------check_connections_block total spend ----------------------------- 0.014832496643066406
generate_one_block  0.004076719284057617
generate_one_block  0.0036313533782958984
generate_one_block  0.0037038326263427734
generate_one_block  0.0036084651947021484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008025169372558594
gen group dst list time:  0.0002124309539794922
time for parepare:  0.00019359588623046875
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0004909038543701172
mini_batch_src_global generation:  0.0002942085266113281
r_  generation:  0.0031239986419677734
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.006062746047973633
local_output_nid generation:  0.00020742416381835938
local_in_edges_tensor generation:  0.0005588531494140625
mini_batch_src_global generation:  0.00036597251892089844
r_  generation:  0.0030624866485595703
local_output_nid generation:  0.00017952919006347656
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.002882719039916992
----------------------check_connections_block total spend ----------------------------- 0.021900653839111328
generate_one_block  0.004736185073852539
generate_one_block  0.004244804382324219
generate_one_block  0.004222393035888672
generate_one_block  0.004331827163696289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008494853973388672
gen group dst list time:  0.00022745132446289062
time for parepare:  0.00020551681518554688
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0005335807800292969
mini_batch_src_global generation:  0.00024080276489257812
r_  generation:  0.0033178329467773438
local_output_nid generation:  0.000186920166015625
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.0031785964965820312
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.00037360191345214844
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.003304719924926758
local_output_nid generation:  0.00020003318786621094
local_in_edges_tensor generation:  0.0003972053527832031
mini_batch_src_global generation:  0.0002682209014892578
r_  generation:  0.0033173561096191406
----------------------check_connections_block total spend ----------------------------- 0.019809722900390625
generate_one_block  0.005471467971801758
generate_one_block  0.004441499710083008
generate_one_block  0.0044155120849609375
generate_one_block  0.004685878753662109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.264129638671875  GigaBytes
Max Memory Allocated: 1.0857458114624023  GigaBytes

connection checking time:  0.06842875480651855
block generation total time  0.06845331192016602
average batch blocks generation time:  0.017113327980041504
block dataloader generation time/epoch 0.2045753002166748
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5311279296875 GB
    Memory Allocated: 0.2637147903442383  GigaBytes
Max Memory Allocated: 1.0857458114624023  GigaBytes

torch.Size([2482, 1433])
torch.Size([2420, 16])
torch.Size([2244, 16])
torch.Size([1722, 16])
torch.Size([911, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.130225658416748  GigaBytes
Max Memory Allocated: 1.1815409660339355  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.2636871337890625  GigaBytes
Max Memory Allocated: 1.2133002281188965  GigaBytes

torch.Size([2410, 1433])
torch.Size([2299, 16])
torch.Size([2019, 16])
torch.Size([1446, 16])
torch.Size([620, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.092008113861084  GigaBytes
Max Memory Allocated: 1.2133002281188965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.2636909484863281  GigaBytes
Max Memory Allocated: 1.2133002281188965  GigaBytes

torch.Size([2475, 1433])
torch.Size([2359, 16])
torch.Size([2098, 16])
torch.Size([1493, 16])
torch.Size([621, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.1198444366455078  GigaBytes
Max Memory Allocated: 1.2133002281188965  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.26369285583496094  GigaBytes
Max Memory Allocated: 1.2133002281188965  GigaBytes

torch.Size([2475, 1433])
torch.Size([2386, 16])
torch.Size([2155, 16])
torch.Size([1476, 16])
torch.Size([666, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.126417636871338  GigaBytes
Max Memory Allocated: 1.2133002281188965  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05548220872879028 |0.0014080405235290527 |0.3035547137260437 |0.00013899803161621094 |0.41023385524749756 |0.014842987060546875 |
----------------------------------------------------------pseudo_mini_loss sum 2.1294174194335938
Total (block generation + training)time/epoch 3.3677549362182617
Training time/epoch 3.162865400314331
Training time without block to device /epoch 3.157233238220215
Training time without total dataloading part /epoch 2.8705532550811768
load block tensor time/epoch 0.22192883491516113
block to device time/epoch 0.005632162094116211
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37505
Number of first layer input nodes during this epoch:  9842
