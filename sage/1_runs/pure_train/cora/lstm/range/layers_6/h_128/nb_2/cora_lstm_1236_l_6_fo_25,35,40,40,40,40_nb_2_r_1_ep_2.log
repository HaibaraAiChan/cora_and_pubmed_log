main start at this time 1648434152.445701
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0012857913970947266
range selection method range initialization spend 0.00012874603271484375
time for parepare:  6.413459777832031e-05
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.002859354019165039
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00010657310485839844
----------------------check_connections_block total spend ----------------------------- 0.0036673545837402344
generate_one_block  0.0016124248504638672
generate_one_block  0.0011682510375976562
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004761219024658203
gen group dst list time:  2.86102294921875e-05
time for parepare:  0.0001316070556640625
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0006861686706542969
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005931854248046875
----------------------check_connections_block total spend ----------------------------- 0.0023365020751953125
generate_one_block  0.001912832260131836
generate_one_block  0.0017173290252685547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005857944488525391
gen group dst list time:  5.4836273193359375e-05
time for parepare:  0.00016307830810546875
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.0016884803771972656
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0015544891357421875
----------------------check_connections_block total spend ----------------------------- 0.005217313766479492
generate_one_block  0.00299072265625
generate_one_block  0.0027904510498046875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006043910980224609
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.00017571449279785156
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.00038504600524902344
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0027313232421875
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.0002980232238769531
mini_batch_src_global generation:  0.00023221969604492188
r_  generation:  0.002466917037963867
----------------------check_connections_block total spend ----------------------------- 0.007917165756225586
generate_one_block  0.003927707672119141
generate_one_block  0.0037124156951904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007529258728027344
gen group dst list time:  0.00010228157043457031
time for parepare:  0.00018405914306640625
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.0004723072052001953
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0029871463775634766
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.00034427642822265625
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.002892732620239258
----------------------check_connections_block total spend ----------------------------- 0.00901174545288086
generate_one_block  0.004221200942993164
generate_one_block  0.004055976867675781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006248950958251953
gen group dst list time:  0.00011038780212402344
time for parepare:  0.00017547607421875
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.0004448890686035156
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.003099203109741211
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.0003483295440673828
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.003005504608154297
----------------------check_connections_block total spend ----------------------------- 0.009345293045043945
generate_one_block  0.004380702972412109
generate_one_block  0.004137277603149414
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

connection checking time:  0.033828020095825195
block generation total time  0.03384661674499512
average batch blocks generation time:  0.01692330837249756
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.08082246780395508  GigaBytes
Max Memory Allocated: 0.08082246780395508  GigaBytes

torch.Size([2506, 1433])
torch.Size([2462, 128])
torch.Size([2329, 128])
torch.Size([1908, 128])
torch.Size([1134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4100341796875 GB
    Memory Allocated: 1.1467294692993164  GigaBytes
Max Memory Allocated: 1.1469831466674805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 0.14702844619750977  GigaBytes
Max Memory Allocated: 1.147519588470459  GigaBytes

torch.Size([2439, 1433])
torch.Size([2387, 128])
torch.Size([2242, 128])
torch.Size([1792, 128])
torch.Size([1054, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.1834912300109863  GigaBytes
Max Memory Allocated: 1.183699131011963  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047788143157958984 |0.17108964920043945 |0.5825450420379639 |0.00021660327911376953 |0.43298792839050293 |0.021504640579223633 |
----------------------------------------------------------pseudo_mini_loss sum 3.2458434104919434
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  20947
Number of first layer input nodes during this epoch:  4945
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 0.28062009811401367  GigaBytes
Max Memory Allocated: 1.1843018531799316  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009748935699462891
range selection method range initialization spend 8.440017700195312e-05
time for parepare:  0.00010180473327636719
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00017142295837402344
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0002219676971435547
----------------------check_connections_block total spend ----------------------------- 0.0013973712921142578
generate_one_block  0.0017414093017578125
generate_one_block  0.0017361640930175781
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007259845733642578
gen group dst list time:  4.76837158203125e-05
time for parepare:  0.00022292137145996094
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0008831024169921875
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0012252330780029297
----------------------check_connections_block total spend ----------------------------- 0.0037741661071777344
generate_one_block  0.0019180774688720703
generate_one_block  0.002172708511352539
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005972385406494141
gen group dst list time:  6.29425048828125e-05
time for parepare:  0.0002048015594482422
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.0001614093780517578
r_  generation:  0.0016551017761230469
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0019516944885253906
----------------------check_connections_block total spend ----------------------------- 0.005878448486328125
generate_one_block  0.003267526626586914
generate_one_block  0.0033774375915527344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006272792816162109
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.00017499923706054688
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.0003829002380371094
mini_batch_src_global generation:  0.00019741058349609375
r_  generation:  0.0025339126586914062
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.00031757354736328125
mini_batch_src_global generation:  0.00029969215393066406
r_  generation:  0.0026731491088867188
----------------------check_connections_block total spend ----------------------------- 0.008244752883911133
generate_one_block  0.0039789676666259766
generate_one_block  0.004099130630493164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007729530334472656
gen group dst list time:  0.00010609626770019531
time for parepare:  0.00018525123596191406
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.000431060791015625
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.002966642379760742
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.0030863285064697266
----------------------check_connections_block total spend ----------------------------- 0.009212732315063477
generate_one_block  0.004431724548339844
generate_one_block  0.0043523311614990234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017714500427246094
gen group dst list time:  0.00011444091796875
time for parepare:  0.00017905235290527344
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.0030994415283203125
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.0003044605255126953
r_  generation:  0.003141641616821289
----------------------check_connections_block total spend ----------------------------- 0.009675264358520508
generate_one_block  0.004569292068481445
generate_one_block  0.00528717041015625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 0.28062009811401367  GigaBytes
Max Memory Allocated: 1.1843018531799316  GigaBytes

connection checking time:  0.03678536415100098
block generation total time  0.03745436668395996
average batch blocks generation time:  0.01872718334197998
block dataloader generation time/epoch 0.13077020645141602
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 0.28011655807495117  GigaBytes
Max Memory Allocated: 1.1843018531799316  GigaBytes

torch.Size([2488, 1433])
torch.Size([2437, 128])
torch.Size([2261, 128])
torch.Size([1796, 128])
torch.Size([1004, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 1.3242931365966797  GigaBytes
Max Memory Allocated: 1.3244962692260742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7635498046875 GB
    Memory Allocated: 0.2801356315612793  GigaBytes
Max Memory Allocated: 1.3251657485961914  GigaBytes

torch.Size([2491, 1433])
torch.Size([2440, 128])
torch.Size([2327, 128])
torch.Size([1944, 128])
torch.Size([1233, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 1.3439984321594238  GigaBytes
Max Memory Allocated: 1.3442606925964355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03769207000732422 |0.0011034011840820312 |0.3422478437423706 |0.0001398324966430664 |0.45123231410980225 |0.015209674835205078 |
----------------------------------------------------------pseudo_mini_loss sum 2.6065239906311035
Total (block generation + training)time/epoch 1.8706941604614258
Training time/epoch 1.7394211292266846
Training time without block to device /epoch 1.7372143268585205
Training time without total dataloading part /epoch 1.602449655532837
load block tensor time/epoch 0.07538414001464844
block to device time/epoch 0.0022068023681640625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21115
Number of first layer input nodes during this epoch:  4979
