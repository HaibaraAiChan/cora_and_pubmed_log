main start at this time 1648434165.190722
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001180887222290039
range selection method range initialization spend 9.751319885253906e-05
time for parepare:  8.368492126464844e-05
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.001840829849243164
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.510185241699219e-05
----------------------check_connections_block total spend ----------------------------- 0.003257274627685547
generate_one_block  0.0019121170043945312
generate_one_block  0.001508474349975586
generate_one_block  0.0013887882232666016
generate_one_block  0.0013632774353027344
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006122589111328125
gen group dst list time:  5.2928924560546875e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0006525516510009766
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004436969757080078
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004830360412597656
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.000431060791015625
----------------------check_connections_block total spend ----------------------------- 0.003847360610961914
generate_one_block  0.002080678939819336
generate_one_block  0.0018031597137451172
generate_one_block  0.0018954277038574219
generate_one_block  0.0017974376678466797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007202625274658203
gen group dst list time:  0.00010538101196289062
time for parepare:  0.00022792816162109375
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.0017857551574707031
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0014662742614746094
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0015554428100585938
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0014328956604003906
----------------------check_connections_block total spend ----------------------------- 0.010067939758300781
generate_one_block  0.003304719924926758
generate_one_block  0.0026214122772216797
generate_one_block  0.002325296401977539
generate_one_block  0.002234935760498047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007524490356445312
gen group dst list time:  0.00017642974853515625
time for parepare:  0.0002505779266357422
local_output_nid generation:  0.0001475811004638672
local_in_edges_tensor generation:  0.00046825408935546875
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.0031452178955078125
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003616809844970703
mini_batch_src_global generation:  0.00034809112548828125
r_  generation:  0.003048419952392578
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0002644062042236328
r_  generation:  0.0029180049896240234
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0022912025451660156
----------------------check_connections_block total spend ----------------------------- 0.017629384994506836
generate_one_block  0.003829479217529297
generate_one_block  0.0034525394439697266
generate_one_block  0.0033876895904541016
generate_one_block  0.0032901763916015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008056163787841797
gen group dst list time:  0.00024962425231933594
time for parepare:  0.00024580955505371094
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation:  0.0005333423614501953
mini_batch_src_global generation:  0.00033283233642578125
r_  generation:  0.003911018371582031
local_output_nid generation:  0.00020885467529296875
local_in_edges_tensor generation:  0.00043463706970214844
mini_batch_src_global generation:  0.000400543212890625
r_  generation:  0.0038187503814697266
local_output_nid generation:  0.00021147727966308594
local_in_edges_tensor generation:  0.00043082237243652344
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.003357410430908203
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.00035119056701660156
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.002805948257446289
----------------------check_connections_block total spend ----------------------------- 0.021172523498535156
generate_one_block  0.004051923751831055
generate_one_block  0.004232645034790039
generate_one_block  0.003939628601074219
generate_one_block  0.0038535594940185547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000789642333984375
gen group dst list time:  0.0002949237823486328
time for parepare:  0.0002391338348388672
local_output_nid generation:  0.00022268295288085938
local_in_edges_tensor generation:  0.0007357597351074219
mini_batch_src_global generation:  0.0002949237823486328
r_  generation:  0.0042192935943603516
local_output_nid generation:  0.0002300739288330078
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0003726482391357422
r_  generation:  0.0038399696350097656
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0002830028533935547
r_  generation:  0.0033223628997802734
local_output_nid generation:  0.0001742839813232422
local_in_edges_tensor generation:  0.0003757476806640625
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.0033338069915771484
----------------------check_connections_block total spend ----------------------------- 0.022090673446655273
generate_one_block  0.004353761672973633
generate_one_block  0.0041997432708740234
generate_one_block  0.0041849613189697266
generate_one_block  0.0048716068267822266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

connection checking time:  0.07480788230895996
block generation total time  0.06571078300476074
average batch blocks generation time:  0.016427695751190186
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.08079338073730469  GigaBytes
Max Memory Allocated: 0.08079338073730469  GigaBytes

torch.Size([2485, 1433])
torch.Size([2406, 128])
torch.Size([2161, 128])
torch.Size([1615, 128])
torch.Size([801, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 1.1094532012939453  GigaBytes
Max Memory Allocated: 1.109611988067627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4530029296875 GB
    Memory Allocated: 0.14700031280517578  GigaBytes
Max Memory Allocated: 1.1103100776672363  GigaBytes

torch.Size([2442, 1433])
torch.Size([2330, 128])
torch.Size([2108, 128])
torch.Size([1524, 128])
torch.Size([653, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5037841796875 GB
    Memory Allocated: 1.140775203704834  GigaBytes
Max Memory Allocated: 1.1408815383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.14699840545654297  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

torch.Size([2394, 1433])
torch.Size([2322, 128])
torch.Size([2097, 128])
torch.Size([1488, 128])
torch.Size([722, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.1243810653686523  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 0.14699172973632812  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

torch.Size([2411, 1433])
torch.Size([2315, 128])
torch.Size([2048, 128])
torch.Size([1426, 128])
torch.Size([656, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5350341796875 GB
    Memory Allocated: 1.113663673400879  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05521559715270996 |0.08525270223617554 |0.4213554263114929 |0.00016605854034423828 |0.4244050979614258 |0.01159811019897461 |
----------------------------------------------------------pseudo_mini_loss sum 3.124626636505127
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37137
Number of first layer input nodes during this epoch:  9732
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.28050708770751953  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.000789642333984375
range selection method range initialization spend 0.00010037422180175781
time for parepare:  8.535385131835938e-05
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.602836608886719e-05
----------------------check_connections_block total spend ----------------------------- 0.0015232563018798828
generate_one_block  0.0013039112091064453
generate_one_block  0.001163482666015625
generate_one_block  0.0012426376342773438
generate_one_block  0.0011417865753173828
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005466938018798828
gen group dst list time:  5.1021575927734375e-05
time for parepare:  0.00023865699768066406
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0004153251647949219
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0006313323974609375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0003566741943359375
----------------------check_connections_block total spend ----------------------------- 0.0038373470306396484
generate_one_block  0.0016541481018066406
generate_one_block  0.0015866756439208984
generate_one_block  0.0019295215606689453
generate_one_block  0.0015308856964111328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006110668182373047
gen group dst list time:  8.893013000488281e-05
time for parepare:  0.00020360946655273438
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.00030875205993652344
r_  generation:  0.0012311935424804688
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00028204917907714844
r_  generation:  0.0011794567108154297
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.0016608238220214844
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0011572837829589844
----------------------check_connections_block total spend ----------------------------- 0.009220600128173828
generate_one_block  0.0026748180389404297
generate_one_block  0.0025374889373779297
generate_one_block  0.002869844436645508
generate_one_block  0.002384185791015625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007305145263671875
gen group dst list time:  0.00014781951904296875
time for parepare:  0.0002048015594482422
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0004112720489501953
mini_batch_src_global generation:  0.00018858909606933594
r_  generation:  0.002385377883911133
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  0.0002741813659667969
r_  generation:  0.0023763179779052734
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.0026662349700927734Using backend: pytorch

local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.00022792816162109375
r_  generation:  0.002318859100341797
----------------------check_connections_block total spend ----------------------------- 0.015271186828613281
generate_one_block  0.003999233245849609
generate_one_block  0.003505706787109375
generate_one_block  0.003744363784790039
generate_one_block  0.0034897327423095703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007717609405517578
gen group dst list time:  0.00020194053649902344
time for parepare:  0.0002048015594482422
local_output_nid generation:  0.00017952919006347656
local_in_edges_tensor generation:  0.0005135536193847656
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0031692981719970703
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.0003600120544433594
mini_batch_src_global generation:  0.0003330707550048828
r_  generation:  0.003068685531616211
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.0003685951232910156
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.0031838417053222656
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.003089427947998047
----------------------check_connections_block total spend ----------------------------- 0.01895904541015625
generate_one_block  0.00442957878112793
generate_one_block  0.004075050354003906
generate_one_block  0.00415802001953125
generate_one_block  0.004102468490600586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007593631744384766
gen group dst list time:  0.000232696533203125
time for parepare:  0.0002048015594482422
local_output_nid generation:  0.00019598007202148438
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0033724308013916016
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.00039005279541015625
mini_batch_src_global generation:  0.0003211498260498047
r_  generation:  0.0033555030822753906
local_output_nid generation:  0.00019478797912597656
local_in_edges_tensor generation:  0.00038933753967285156
mini_batch_src_global generation:  0.00027632713317871094
r_  generation:  0.0033416748046875
local_output_nid generation:  0.00020241737365722656
local_in_edges_tensor generation:  0.00038743019104003906
mini_batch_src_global generation:  0.0002753734588623047
r_  generation:  0.00337982177734375
----------------------check_connections_block total spend ----------------------------- 0.02016901969909668
generate_one_block  0.0056247711181640625
generate_one_block  0.00433039665222168
generate_one_block  0.004293680191040039
generate_one_block  0.004567146301269531
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.28050708770751953  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

connection checking time:  0.06745719909667969
block generation total time  0.06748771667480469
average batch blocks generation time:  0.016871929168701172
block dataloader generation time/epoch 0.20769834518432617
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6600341796875 GB
    Memory Allocated: 0.2800865173339844  GigaBytes
Max Memory Allocated: 1.141667366027832  GigaBytes

torch.Size([2447, 1433])
torch.Size([2363, 128])
torch.Size([2092, 128])
torch.Size([1459, 128])
torch.Size([672, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 1.2866730690002441  GigaBytes
Max Memory Allocated: 1.2867822647094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 0.28008079528808594  GigaBytes
Max Memory Allocated: 1.2875661849975586  GigaBytes

torch.Size([2439, 1433])
torch.Size([2336, 128])
torch.Size([2046, 128])
torch.Size([1445, 128])
torch.Size([637, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 1.2707452774047852  GigaBytes
Max Memory Allocated: 1.2875661849975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7108154296875 GB
    Memory Allocated: 0.2801084518432617  GigaBytes
Max Memory Allocated: 1.2875661849975586  GigaBytes

torch.Size([2445, 1433])
torch.Size([2337, 128])
torch.Size([2157, 128])
torch.Size([1711, 128])
torch.Size([954, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 1.2899203300476074  GigaBytes
Max Memory Allocated: 1.2900934219360352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.28007984161376953  GigaBytes
Max Memory Allocated: 1.2907567024230957  GigaBytes

torch.Size([2451, 1433])
torch.Size([2354, 128])
torch.Size([2054, 128])
torch.Size([1385, 128])
torch.Size([591, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 1.2760915756225586  GigaBytes
Max Memory Allocated: 1.2907567024230957  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.052095115184783936 |0.001156449317932129 |0.3011438250541687 |0.0001373291015625 |0.42125648260116577 |0.016869783401489258 |
----------------------------------------------------------pseudo_mini_loss sum 2.41878342628479
Total (block generation + training)time/epoch 3.3916494846343994
Training time/epoch 3.183685064315796
Training time without block to device /epoch 3.1790592670440674
Training time without total dataloading part /epoch 2.907020330429077
load block tensor time/epoch 0.20838046073913574
block to device time/epoch 0.004625797271728516
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37105
Number of first layer input nodes during this epoch:  9782
