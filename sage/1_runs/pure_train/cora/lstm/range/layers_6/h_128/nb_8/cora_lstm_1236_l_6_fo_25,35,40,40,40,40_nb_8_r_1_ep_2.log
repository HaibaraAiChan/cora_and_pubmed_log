main start at this time 1648434181.0272713
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0016400814056396484
range selection method range initialization spend 0.00010061264038085938
time for parepare:  6.270408630371094e-05
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.003660440444946289
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.7179718017578125e-05
----------------------check_connections_block total spend ----------------------------- 0.005434989929199219
generate_one_block  0.0014138221740722656
generate_one_block  0.0010223388671875
generate_one_block  0.0009710788726806641
generate_one_block  0.0009684562683105469
generate_one_block  0.0010027885437011719
generate_one_block  0.0009617805480957031
generate_one_block  0.0009927749633789062
generate_one_block  0.0009899139404296875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004987716674804688
gen group dst list time:  6.723403930664062e-05
time for parepare:  0.00013327598571777344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002930164337158203
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00027108192443847656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00019502639770507812
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00018596649169921875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00022983551025390625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00018548965454101562
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00018262863159179688
----------------------check_connections_block total spend ----------------------------- 0.003782510757446289
generate_one_block  0.001318216323852539
generate_one_block  0.0012545585632324219
generate_one_block  0.0012166500091552734
generate_one_block  0.001178741455078125
generate_one_block  0.0011510848999023438
generate_one_block  0.0012853145599365234
generate_one_block  0.0011501312255859375
generate_one_block  0.001132965087890625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006513595581054688
gen group dst list time:  9.560585021972656e-05
time for parepare:  0.0002028942108154297
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0008792877197265625
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0008373260498046875
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0007138252258300781
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006816387176513672
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006620883941650391
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.000732421875
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006401538848876953
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006248950958251953
----------------------check_connections_block total spend ----------------------------- 0.009890079498291016
generate_one_block  0.0020177364349365234
generate_one_block  0.0019834041595458984
generate_one_block  0.001775979995727539
generate_one_block  0.0018367767333984375
generate_one_block  0.001753091812133789
generate_one_block  0.0018718242645263672
generate_one_block  0.0016486644744873047
generate_one_block  0.0016491413116455078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007460117340087891
gen group dst list time:  0.0001761913299560547
time for parepare:  0.00017762184143066406
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0018668174743652344
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0019307136535644531
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.0015692710876464844
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.001558065414428711
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0016505718231201172
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.001688241958618164
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0015761852264404297
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0014500617980957031
----------------------check_connections_block total spend ----------------------------- 0.020633220672607422
generate_one_block  0.0030477046966552734
generate_one_block  0.0030655860900878906
generate_one_block  0.002904653549194336
generate_one_block  0.0026454925537109375
generate_one_block  0.002804994583129883
generate_one_block  0.002950429916381836
generate_one_block  0.002661466598510742
generate_one_block  0.002541065216064453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007538795471191406
gen group dst list time:  0.0003101825714111328
time for parepare:  0.000179290771484375
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.0004401206970214844
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.002610921859741211
local_output_nid generation:  0.0001373291015625
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.0002911090850830078
r_  generation:  0.002704620361328125
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.0024614334106445312
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.002419710159301758
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.002516508102416992
local_output_nid generation:  0.0001609325408935547
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.0025870800018310547
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.002521991729736328
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.002284526824951172
----------------------check_connections_block total spend ----------------------------- 0.030436992645263672
generate_one_block  0.003814220428466797
generate_one_block  0.004354953765869141
generate_one_block  0.004586935043334961
generate_one_block  0.0035827159881591797
generate_one_block  0.003599882125854492
generate_one_block  0.003711700439453125
generate_one_block  0.003622293472290039
generate_one_block  0.0034821033477783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007734298706054688
gen group dst list time:  0.0004379749298095703
time for parepare:  0.0001735687255859375
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.000469207763671875
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.002980947494506836
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.0003135204315185547
r_  generation:  0.003083467483520508
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.002911090850830078
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0028977394104003906
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.0029239654541015625
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.002959012985229492
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.0003254413604736328
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0028328895568847656
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003218650817871094
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.0027942657470703125
----------------------check_connections_block total spend ----------------------------- 0.0345916748046875
generate_one_block  0.005202531814575195
generate_one_block  0.004109382629394531
generate_one_block  0.003979206085205078
generate_one_block  0.00395655632019043
generate_one_block  0.0039784908294677734
generate_one_block  0.00409698486328125
generate_one_block  0.004065275192260742
generate_one_block  0.004051923751831055
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0838623046875 GB
    Memory Allocated: 0.06687688827514648  GigaBytes
Max Memory Allocated: 0.06687688827514648  GigaBytes

connection checking time:  0.0993344783782959
block generation total time  0.11104083061218262
average batch blocks generation time:  0.013880103826522827
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.08075809478759766  GigaBytes
Max Memory Allocated: 0.08075809478759766  GigaBytes

torch.Size([2432, 1433])
torch.Size([2264, 128])
torch.Size([1887, 128])
torch.Size([1214, 128])
torch.Size([512, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2908935546875 GB
    Memory Allocated: 1.0298643112182617  GigaBytes
Max Memory Allocated: 1.029956340789795  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3846435546875 GB
    Memory Allocated: 0.14698171615600586  GigaBytes
Max Memory Allocated: 1.0307741165161133  GigaBytes

torch.Size([2456, 1433])
torch.Size([2348, 128])
torch.Size([1992, 128])
torch.Size([1269, 128])
torch.Size([479, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 1.1318426132202148  GigaBytes
Max Memory Allocated: 1.131925106048584  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.1469588279724121  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2386, 1433])
torch.Size([2197, 128])
torch.Size([1777, 128])
torch.Size([1031, 128])
torch.Size([381, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0599961280822754  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.1469559669494629  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2380, 1433])
torch.Size([2185, 128])
torch.Size([1741, 128])
torch.Size([977, 128])
torch.Size([392, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0622692108154297  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.14591217041015625  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2365, 1433])
torch.Size([2209, 128])
torch.Size([1796, 128])
torch.Size([1073, 128])
torch.Size([384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0670514106750488  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.14595746994018555  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2372, 1433])
torch.Size([2250, 128])
torch.Size([1874, 128])
torch.Size([1097, 128])
torch.Size([434, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.0796971321105957  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.14587116241455078  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2358, 1433])
torch.Size([2212, 128])
torch.Size([1766, 128])
torch.Size([963, 128])
torch.Size([356, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.060053825378418  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 0.14576292037963867  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2339, 1433])
torch.Size([2167, 128])
torch.Size([1654, 128])
torch.Size([905, 128])
torch.Size([357, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.037069320678711  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06193667650222778 |0.04324817657470703 |0.3391924500465393 |0.00014704465866088867 |0.39592912793159485 |0.020389318466186523 |
----------------------------------------------------------pseudo_mini_loss sum 3.3367578983306885
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63983
Number of first layer input nodes during this epoch:  19088
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.2798323631286621  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.000579833984375
range selection method range initialization spend 7.843971252441406e-05
time for parepare:  8.344650268554688e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.8133392333984375e-05
----------------------check_connections_block total spend ----------------------------- 0.0020210742950439453
generate_one_block  0.0012333393096923828
generate_one_block  0.0010974407196044922
generate_one_block  0.0010409355163574219
generate_one_block  0.0010228157043457031
generate_one_block  0.0012059211730957031
generate_one_block  0.0010814666748046875
generate_one_block  0.0011701583862304688
generate_one_block  0.0010554790496826172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005602836608886719
gen group dst list time:  6.318092346191406e-05
time for parepare:  0.00019240379333496094
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002346038818359375
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00021409988403320312
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00017499923706054688
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004038810729980469
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00011491775512695312
----------------------check_connections_block total spend ----------------------------- 0.0043392181396484375
generate_one_block  0.0014827251434326172
generate_one_block  0.0012674331665039062
generate_one_block  0.0012884140014648438
generate_one_block  0.0012135505676269531
generate_one_block  0.0015702247619628906
generate_one_block  0.0013551712036132812
generate_one_block  0.0012478828430175781
generate_one_block  0.0011301040649414062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007641315460205078
gen group dst list time:  0.00011968612670898438
time for parepare:  0.0002143383026123047
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0008153915405273438
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0005927085876464844
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0007169246673583984
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0006160736083984375
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0011904239654541016
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0008625984191894531
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0007646083831787109
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.00039649009704589844
----------------------check_connections_block total spend ----------------------------- 0.01074361801147461
generate_one_block  0.0020973682403564453
generate_one_block  0.0016918182373046875
generate_one_block  0.0019316673278808594
generate_one_block  0.0018062591552734375
generate_one_block  0.002398252487182617
generate_one_block  0.002234220504760742
generate_one_block  0.0019295215606689453
generate_one_block  0.0014395713806152344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008165836334228516
gen group dst list time:  0.00020885467529296875
time for parepare:  0.0002086162567138672
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00043392181396484375
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0017886161804199219
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.001394510269165039
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.0016837120056152344
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.001684427261352539
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0022203922271728516
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.0001850128173828125
r_  generation:  0.0018825531005859375
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0016384124755859375
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0010540485382080078
----------------------check_connections_block total spend ----------------------------- 0.021439790725708008
generate_one_block  0.003319978713989258
generate_one_block  0.002696990966796875
generate_one_block  0.002992868423461914
generate_one_block  0.002956867218017578
generate_one_block  0.0035262107849121094
generate_one_block  0.0032699108123779297
generate_one_block  0.0029480457305908203
generate_one_block  0.0023298263549804688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007915496826171875
gen group dst list time:  0.00034356117248535156
time for parepare:  0.00019621849060058594
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.0004916191101074219
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.002543926239013672
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.00029349327087402344
r_  generation:  0.002414226531982422
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.0025310516357421875
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0024924278259277344
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.002742290496826172
local_output_nid generation:  0.00016808509826660156
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00023317337036132812
r_  generation:  0.002732515335083008
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.002485990524291992
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.001955747604370117
----------------------check_connections_block total spend ----------------------------- 0.030866146087646484
generate_one_block  0.004090070724487305
generate_one_block  0.004159688949584961
generate_one_block  0.003935337066650391
generate_one_block  0.0038564205169677734
generate_one_block  0.004099607467651367
generate_one_block  0.004125118255615234
generate_one_block  0.0038843154907226562
generate_one_block  0.0033359527587890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008168220520019531
gen group dst list time:  0.00044035911560058594
time for parepare:  0.00019788742065429688
local_output_nid generation:  0.00018525123596191406
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.003066539764404297
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.00030612945556640625
r_  generation:  0.003007650375366211
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.00024819374084472656
r_  generation:  0.0029838085174560547
local_output_nid generation:  0.000179290771484375
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0029172897338867188
local_output_nid generation:  0.00019097328186035156
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0029332637786865234
local_output_nid generation:  0.00019502639770507812
local_in_edges_tensor generation:  0.0003674030303955078
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.0030143260955810547
local_output_nid generation:  0.0001938343048095703
local_in_edges_tensor generation: Using backend: pytorch
 0.00034356117248535156
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.0029218196868896484
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.002597808837890625
----------------------check_connections_block total spend ----------------------------- 0.03548574447631836
generate_one_block  0.0046236515045166016
generate_one_block  0.004384040832519531
generate_one_block  0.004246950149536133
generate_one_block  0.00422978401184082
generate_one_block  0.004262685775756836
generate_one_block  0.0043735504150390625
generate_one_block  0.004553794860839844
generate_one_block  0.003969907760620117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.2798323631286621  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

connection checking time:  0.1028745174407959
block generation total time  0.1162557601928711
average batch blocks generation time:  0.014531970024108887
block dataloader generation time/epoch 0.3353605270385742
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.28070783615112305  GigaBytes
Max Memory Allocated: 1.13275146484375  GigaBytes

torch.Size([2414, 1433])
torch.Size([2242, 128])
torch.Size([1838, 128])
torch.Size([1139, 128])
torch.Size([446, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.2199883460998535  GigaBytes
Max Memory Allocated: 1.2200465202331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.2806859016418457  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

torch.Size([2396, 1433])
torch.Size([2209, 128])
torch.Size([1689, 128])
torch.Size([798, 128])
torch.Size([307, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.1899876594543457  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.2796645164489746  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

torch.Size([2367, 1433])
torch.Size([2211, 128])
torch.Size([1790, 128])
torch.Size([1073, 128])
torch.Size([407, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.2044882774353027  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.27965879440307617  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

torch.Size([2367, 1433])
torch.Size([2184, 128])
torch.Size([1767, 128])
torch.Size([1004, 128])
torch.Size([338, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.182093620300293  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 0.2807307243347168  GigaBytes
Max Memory Allocated: 1.2209177017211914  GigaBytes

torch.Size([2399, 1433])
torch.Size([2265, 128])
torch.Size([2001, 128])
torch.Size([1447, 128])
torch.Size([638, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6190185546875 GB
    Memory Allocated: 1.2387914657592773  GigaBytes
Max Memory Allocated: 1.2388954162597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 0.2807183265686035  GigaBytes
Max Memory Allocated: 1.2396798133850098  GigaBytes

torch.Size([2451, 1433])
torch.Size([2335, 128])
torch.Size([1996, 128])
torch.Size([1244, 128])
torch.Size([504, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6209716796875 GB
    Memory Allocated: 1.2571444511413574  GigaBytes
Max Memory Allocated: 1.2572221755981445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 0.27968502044677734  GigaBytes
Max Memory Allocated: 1.2580561637878418  GigaBytes

torch.Size([2371, 1433])
torch.Size([2205, 128])
torch.Size([1769, 128])
torch.Size([1016, 128])
torch.Size([405, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 1.1951088905334473  GigaBytes
Max Memory Allocated: 1.2580561637878418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 0.27896833419799805  GigaBytes
Max Memory Allocated: 1.2580561637878418  GigaBytes

torch.Size([2245, 1433])
torch.Size([1910, 128])
torch.Size([1336, 128])
torch.Size([629, 128])
torch.Size([184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6522216796875 GB
    Memory Allocated: 1.0813093185424805  GigaBytes
Max Memory Allocated: 1.2580561637878418  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06292524933815002 |0.0011101961135864258 |0.27974846959114075 |0.00012552738189697266 |0.39163509011268616 |0.016769886016845703 |
----------------------------------------------------------pseudo_mini_loss sum 2.4535398483276367
Total (block generation + training)time/epoch 6.30708122253418
Training time/epoch 5.971412181854248
Training time without block to device /epoch 5.962530612945557
Training time without total dataloading part /epoch 5.388842582702637
load block tensor time/epoch 0.5034019947052002
block to device time/epoch 0.008881568908691406
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  63089
Number of first layer input nodes during this epoch:  19010
