main start at this time 1648434235.567588
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001361846923828125
range selection method range initialization spend 9.059906005859375e-05
time for parepare:  7.343292236328125e-05
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0017001628875732422
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00018596649169921875
----------------------check_connections_block total spend ----------------------------- 0.0027060508728027344
generate_one_block  0.001728057861328125
generate_one_block  0.0013501644134521484
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005829334259033203
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.00017142295837402344
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0006780624389648438
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0008442401885986328
----------------------check_connections_block total spend ----------------------------- 0.002802133560180664
generate_one_block  0.0019965171813964844
generate_one_block  0.0021572113037109375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006783008575439453
gen group dst list time:  6.818771362304688e-05
time for parepare:  0.00020551681518554688
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00037288665771484375
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.0018382072448730469
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  0.00025844573974609375
r_  generation:  0.002154827117919922
----------------------check_connections_block total spend ----------------------------- 0.006520986557006836
generate_one_block  0.0033423900604248047
generate_one_block  0.003536701202392578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006666183471679688
gen group dst list time:  0.00010418891906738281
time for parepare:  0.00021529197692871094
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0004553794860839844
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.003189563751220703
local_output_nid generation:  0.00019240379333496094
local_in_edges_tensor generation:  0.0004048347473144531
mini_batch_src_global generation:  0.0003273487091064453
r_  generation:  0.0032532215118408203
----------------------check_connections_block total spend ----------------------------- 0.009985685348510742
generate_one_block  0.0044171810150146484
generate_one_block  0.003881692886352539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007758140563964844
gen group dst list time:  0.0001327991485595703
time for parepare:  0.0002219676971435547
local_output_nid generation:  0.00018262863159179688
local_in_edges_tensor generation:  0.0005619525909423828
mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.003645181655883789
local_output_nid generation:  0.0002143383026123047
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0003752708435058594
r_  generation:  0.003785848617553711
----------------------check_connections_block total spend ----------------------------- 0.011396646499633789
generate_one_block  0.0046024322509765625
generate_one_block  0.004153251647949219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00067901611328125
gen group dst list time:  0.0001480579376220703
time for parepare:  0.00022554397583007812
local_output_nid generation:  0.00020885467529296875
local_in_edges_tensor generation:  0.0005750656127929688
mini_batch_src_global generation:  0.0002913475036621094
r_  generation:  0.003833293914794922
local_output_nid generation:  0.0002105236053466797
local_in_edges_tensor generation:  0.00044083595275878906
mini_batch_src_global generation:  0.0003559589385986328
r_  generation:  0.003780364990234375
----------------------check_connections_block total spend ----------------------------- 0.011775732040405273
generate_one_block  0.004579782485961914
generate_one_block  0.004200458526611328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

connection checking time:  0.042481184005737305
block generation total time  0.036867618560791016
average batch blocks generation time:  0.018433809280395508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0906376838684082  GigaBytes
Max Memory Allocated: 0.0906376838684082  GigaBytes

torch.Size([2493, 1433])
torch.Size([2432, 256])
torch.Size([2286, 256])
torch.Size([1818, 256])
torch.Size([1008, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5506591796875 GB
    Memory Allocated: 1.3419532775878906  GigaBytes
Max Memory Allocated: 1.3423566818237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6678466796875 GB
    Memory Allocated: 0.16749811172485352  GigaBytes
Max Memory Allocated: 1.3455705642700195  GigaBytes

torch.Size([2488, 1433])
torch.Size([2448, 256])
torch.Size([2342, 256])
torch.Size([1970, 256])
torch.Size([1194, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.453725814819336  GigaBytes
Max Memory Allocated: 1.4542236328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044802188873291016 |0.17189276218414307 |0.5753524303436279 |0.00020229816436767578 |0.5525466203689575 |0.021456003189086914 |
----------------------------------------------------------pseudo_mini_loss sum 3.234363555908203
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21173
Number of first layer input nodes during this epoch:  4981
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.32209014892578125  GigaBytes
Max Memory Allocated: 1.4572415351867676  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005273818969726562
range selection method range initialization spend 6.651878356933594e-05
time for parepare:  7.343292236328125e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00012564659118652344
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00014019012451171875
----------------------check_connections_block total spend ----------------------------- 0.0010402202606201172
generate_one_block  0.0012984275817871094
generate_one_block  0.0012388229370117188
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005304813385009766
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.00015807151794433594
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006797313690185547
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0007174015045166016
----------------------check_connections_block total spend ----------------------------- 0.0026221275329589844
generate_one_block  0.0020322799682617188
generate_one_block  0.001985311508178711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
gen group dst list time:  6.270408630371094e-05
time for parepare:  0.00019311904907226562
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.0003345012664794922
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0019526481628417969
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.001798391342163086
----------------------check_connections_block total spend ----------------------------- 0.005995035171508789
generate_one_block  0.003581523895263672
generate_one_block  0.003266572952270508
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006546974182128906
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.00018858909606933594
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.00042128562927246094
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.0028285980224609375
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.00033402442932128906
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.0028526782989501953
----------------------check_connections_block total spend ----------------------------- 0.008794069290161133
generate_one_block  0.004267454147338867
generate_one_block  0.0040280818939208984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008127689361572266
gen group dst list time:  0.00010991096496582031
time for parepare:  0.00018525123596191406
local_output_nid generation:  0.00016117095947265625
local_in_edges_tensor generation:  0.00045943260192871094
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.0031671524047851562
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0003669261932373047
mini_batch_src_global generation:  0.00029277801513671875
r_  generation:  0.003276824951171875
----------------------check_connections_block total spend ----------------------------- 0.009844779968261719
generate_one_block  0.0045735836029052734
generate_one_block  0.0043375492095947266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007450580596923828
gen group dst list time:  0.000118255615234375
time for parepare:  0.0001838207244873047
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.004376649856567383
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0003020763397216797
r_  generation:  0.003252744674682617
----------------------check_connections_block total spend ----------------------------- 0.011101722717285156
generate_one_block  0.004621744155883789
generate_one_block  0.0052220821380615234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.32209014892578125  GigaBytes
Max Memory Allocated: 1.4572415351867676  GigaBytes

connection checking time:  0.03835773468017578
block generation total time  0.03791618347167969
average batch blocks generation time:  0.018958091735839844
block dataloader generation time/epoch 0.10895347595214844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9002685546875 GB
    Memory Allocated: 0.32186031341552734  GigaBytes
Max Memory Allocated: 1.4572415351867676  GigaBytes

torch.Size([2469, 1433])
torch.Size([2428, 256])
torch.Size([2298, 256])
torch.Size([1929, 256])
torch.Size([1143, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.59236478805542  GigaBytes
Max Memory Allocated: 1.5928034782409668  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9783935546875 GB
    Memory Allocated: 0.3215446472167969  GigaBytes
Max Memory Allocated: 1.5959386825561523  GigaBytes

torch.Size([2502, 1433])
torch.Size([2461, 256])
torch.Size([2313, 256])
torch.Size([1899, 256])
torch.Size([1103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9783935546875 GB
    Memory Allocated: 1.5930299758911133  GigaBytes
Max Memory Allocated: 1.5959386825561523  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027406811714172363 |0.0013964176177978516 |0.33586597442626953 |0.0001513957977294922 |0.5815236568450928 |0.01578807830810547 |
----------------------------------------------------------pseudo_mini_loss sum 3.573155403137207
Total (block generation + training)time/epoch 2.08030104637146
Training time/epoch 1.9711015224456787
Training time without block to device /epoch 1.968308687210083
Training time without total dataloading part /epoch 1.850870132446289
load block tensor time/epoch 0.05481362342834473
block to device time/epoch 0.002792835235595703
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21244
Number of first layer input nodes during this epoch:  4971
