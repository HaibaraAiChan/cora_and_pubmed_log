main start at this time 1648434265.1913345
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008766651153564453
range selection method range initialization spend 8.296966552734375e-05
time for parepare:  6.866455078125e-05
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0013630390167236328
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.363059997558594e-05
----------------------check_connections_block total spend ----------------------------- 0.003255128860473633
generate_one_block  0.001233816146850586
generate_one_block  0.0010974407196044922
generate_one_block  0.0010619163513183594
generate_one_block  0.0010745525360107422
generate_one_block  0.0011148452758789062
generate_one_block  0.0010733604431152344
generate_one_block  0.00110626220703125
generate_one_block  0.0010755062103271484
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005195140838623047
gen group dst list time:  6.0558319091796875e-05
time for parepare:  0.00015044212341308594
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002231597900390625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002315044403076172
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0003056526184082031
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00023484230041503906
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00023412704467773438
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00025844573974609375
----------------------check_connections_block total spend ----------------------------- 0.004118204116821289
generate_one_block  0.0012784004211425781
generate_one_block  0.001299142837524414
generate_one_block  0.0012843608856201172
generate_one_block  0.001318216323852539
generate_one_block  0.0014042854309082031
generate_one_block  0.0013582706451416016
generate_one_block  0.0013279914855957031
generate_one_block  0.001344442367553711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007193088531494141
gen group dst list time:  0.00010561943054199219
time for parepare:  0.00021219253540039062
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0006487369537353516
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0007486343383789062
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0007266998291015625
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008025169372558594
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.000993967056274414
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0007841587066650391
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.00089263916015625
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007832050323486328
----------------------check_connections_block total spend ----------------------------- 0.010842323303222656
generate_one_block  0.001821756362915039
generate_one_block  0.0019378662109375
generate_one_block  0.0017735958099365234
generate_one_block  0.0018956661224365234
generate_one_block  0.0020215511322021484
generate_one_block  0.0018732547760009766
generate_one_block  0.0019636154174804688
generate_one_block  0.001773834228515625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007674694061279297
gen group dst list time:  0.0002002716064453125
time for parepare:  0.0002002716064453125
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0015697479248046875
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.0017998218536376953
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0017328262329101562
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0017659664154052734
local_output_nid generation:  0.00010442733764648438
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.002189159393310547
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00018548965454101562
r_  generation:  0.0018148422241210938
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00026297569274902344
mini_batch_src_global generation:  0.00019431114196777344
r_  generation:  0.0020551681518554688
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0014858245849609375
----------------------check_connections_block total spend ----------------------------- 0.022211551666259766
generate_one_block  0.0027213096618652344
generate_one_block  0.0028269290924072266
generate_one_block  0.002901315689086914
generate_one_block  0.002732515335083008
generate_one_block  0.0031380653381347656
generate_one_block  0.0028333663940429688
generate_one_block  0.0030400753021240234
generate_one_block  0.002656221389770508
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007648468017578125
gen group dst list time:  0.00033926963806152344
time for parepare:  0.00020241737365722656
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.00041484832763671875
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.002457141876220703
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.0003151893615722656
r_  generation:  0.0028400421142578125
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003254413604736328
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0026803016662597656
local_output_nid generation:  0.0001347064971923828
local_in_edges_tensor generation:  0.0003197193145751953
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.00275421142578125
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.002997159957885742
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0026404857635498047
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0003294944763183594
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.002584218978881836
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002777576446533203
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0022306442260742188
----------------------check_connections_block total spend ----------------------------- 0.032083749771118164
generate_one_block  0.003559112548828125
generate_one_block  0.004266977310180664
generate_one_block  0.0036017894744873047
generate_one_block  0.003621339797973633
generate_one_block  0.0038597583770751953
generate_one_block  0.003676176071166992
generate_one_block  0.003767728805541992
generate_one_block  0.003422975540161133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007684230804443359
gen group dst list time:  0.00045990943908691406
time for parepare:  0.00020313262939453125
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0004630088806152344
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0030548572540283203
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.00033164024353027344
r_  generation:  0.0032799243927001953
local_output_nid generation:  0.00017523765563964844
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.00026345252990722656
r_  generation:  0.0031402111053466797
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.00036907196044921875
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.0031812191009521484
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.002972841262817383
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.002885580062866211
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.002872467041015625
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.0026540756225585938
----------------------check_connections_block total spend ----------------------------- 0.035880327224731445
generate_one_block  0.0043506622314453125
generate_one_block  0.004086017608642578
generate_one_block  0.003962516784667969
generate_one_block  0.0040090084075927734
generate_one_block  0.00412750244140625
generate_one_block  0.0040433406829833984
generate_one_block  0.004030466079711914
generate_one_block  0.003814697265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

connection checking time:  0.10513615608215332
block generation total time  0.11072611808776855
average batch blocks generation time:  0.01384076476097107
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.0897517204284668  GigaBytes
Max Memory Allocated: 0.0897517204284668  GigaBytes

torch.Size([2343, 1433])
torch.Size([2074, 256])
torch.Size([1574, 256])
torch.Size([896, 256])
torch.Size([319, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2869873046875 GB
    Memory Allocated: 1.0780301094055176  GigaBytes
Max Memory Allocated: 1.078139305114746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3865966796875 GB
    Memory Allocated: 0.16657209396362305  GigaBytes
Max Memory Allocated: 1.08272123336792  GigaBytes

torch.Size([2417, 1433])
torch.Size([2284, 256])
torch.Size([1856, 256])
torch.Size([1054, 256])
torch.Size([399, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4666748046875 GB
    Memory Allocated: 1.2448186874389648  GigaBytes
Max Memory Allocated: 1.2449359893798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5643310546875 GB
    Memory Allocated: 0.1660294532775879  GigaBytes
Max Memory Allocated: 1.2486262321472168  GigaBytes

torch.Size([2317, 1433])
torch.Size([2147, 256])
torch.Size([1741, 256])
torch.Size([1000, 256])
torch.Size([383, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5643310546875 GB
    Memory Allocated: 1.1874165534973145  GigaBytes
Max Memory Allocated: 1.2486262321472168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5643310546875 GB
    Memory Allocated: 0.16644620895385742  GigaBytes
Max Memory Allocated: 1.2486262321472168  GigaBytes

torch.Size([2394, 1433])
torch.Size([2205, 256])
torch.Size([1763, 256])
torch.Size([1048, 256])
torch.Size([430, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5643310546875 GB
    Memory Allocated: 1.2169313430786133  GigaBytes
Max Memory Allocated: 1.2486262321472168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5662841796875 GB
    Memory Allocated: 0.1667041778564453  GigaBytes
Max Memory Allocated: 1.2486262321472168  GigaBytes

torch.Size([2438, 1433])
torch.Size([2324, 256])
torch.Size([1997, 256])
torch.Size([1330, 256])
torch.Size([526, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5877685546875 GB
    Memory Allocated: 1.2999186515808105  GigaBytes
Max Memory Allocated: 1.3000683784484863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5916748046875 GB
    Memory Allocated: 0.16654539108276367  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

torch.Size([2412, 1433])
torch.Size([2225, 256])
torch.Size([1818, 256])
torch.Size([1051, 256])
torch.Size([395, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5916748046875 GB
    Memory Allocated: 1.2269010543823242  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5916748046875 GB
    Memory Allocated: 0.16631364822387695  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

torch.Size([2367, 1433])
torch.Size([2229, 256])
torch.Size([1910, 256])
torch.Size([1245, 256])
torch.Size([473, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5916748046875 GB
    Memory Allocated: 1.2464122772216797  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5916748046875 GB
    Memory Allocated: 0.1657876968383789  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

torch.Size([2273, 1433])
torch.Size([2028, 256])
torch.Size([1622, 256])
torch.Size([954, 256])
torch.Size([411, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5916748046875 GB
    Memory Allocated: 1.1432490348815918  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060396820306777954 |0.04364338517189026 |0.34558236598968506 |0.00014546513557434082 |0.4103674590587616 |0.02193760871887207 |
----------------------------------------------------------pseudo_mini_loss sum 3.309328079223633
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63418
Number of first layer input nodes during this epoch:  18961
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 0.3207974433898926  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0008039474487304688
range selection method range initialization spend 0.000102996826171875
time for parepare:  0.00010466575622558594
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.002396106719970703
generate_one_block  0.0014562606811523438
generate_one_block  0.0013468265533447266
generate_one_block  0.0013124942779541016
generate_one_block  0.0013194084167480469
generate_one_block  0.0013208389282226562
generate_one_block  0.0013391971588134766
generate_one_block  0.0013217926025390625
generate_one_block  0.0013055801391601562
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005843639373779297
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.0002522468566894531
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.00033545494079589844
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00033402442932128906
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003077983856201172
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00030040740966796875
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00029087066650390625
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003027915954589844
----------------------check_connections_block total spend ----------------------------- 0.005514383316040039
generate_one_block  0.0018830299377441406
generate_one_block  0.0017168521881103516
generate_one_block  0.0016090869903564453
generate_one_block  0.001664876937866211
generate_one_block  0.0015826225280761719
generate_one_block  0.0013098716735839844
generate_one_block  0.0012392997741699219
generate_one_block  0.0012645721435546875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007653236389160156
gen group dst list time:  0.0001537799835205078
time for parepare:  0.00031256675720214844
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0011255741119384766
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0012040138244628906
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0008060932159423828
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0008499622344970703
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0007829666137695312
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0007693767547607422
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0006906986236572266
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0008521080017089844
----------------------check_connections_block total spend ----------------------------- 0.012755870819091797
generate_one_block  0.0023584365844726562
generate_one_block  0.0022373199462890625
generate_one_block  0.0019330978393554688
generate_one_block  0.001980304718017578
generate_one_block  0.0018887519836425781
generate_one_block  0.0020134449005126953
generate_one_block  0.0017626285552978516
generate_one_block  0.0019991397857666016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008060932159423828
gen group dst list time:  0.00023102760314941406
time for parepare:  0.00022721290588378906
local_output_nid generation:  0.00012683868408203125
local_in_edges_tensor generation:  0.0004611015319824219
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.0021369457244873047
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00025844573974609375
r_  generation:  0.0021491050720214844
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0018463134765625
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0019505023956298828
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0018541812896728516
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.00018453598022460938
r_  generation:  0.001917123794555664
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0014004707336425781
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.0017826557159423828
----------------------check_connections_block total spend ----------------------------- 0.02380990982055664
generate_one_block  0.00350189208984375
generate_one_block  0.0033295154571533203
generate_one_block  0.002985715866088867
generate_one_block  0.003091096878051758
generate_one_block  0.0030219554901123047
generate_one_block  0.003083944320678711
generate_one_block  0.002697467803955078
generate_one_block  0.003150463104248047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00078582763671875
gen group dst list time:  0.00039458274841308594
time for parepare:  0.0002491474151611328
local_output_nid generation:  0.0002009868621826172
local_in_edges_tensor generation:  0.0004799365997314453
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.003123044967651367
local_output_nid generation:  0.00018310546875
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.0003294944763183594
r_  generation:  0.003016948699951172
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.002755880355834961
local_output_nid generation:  0.00018095970153808594
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0029268264770507812
local_output_nid generation:  0.00017261505126953125
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.0026934146881103516
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.002577066421508789
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0003192424774169922
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.002330303192138672
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0025963783264160156
----------------------check_connections_block total spend ----------------------------- 0.03361392021179199
generate_one_block  0.004301548004150391
generate_one_block  0.004407405853271484
generate_one_block  0.00394129753112793
generate_one_block  0.004009723663330078
generate_one_block  0.00398564338684082
generate_one_block  0.003930091857910156
generate_one_block  0.003719329833984375
generate_one_block  0.003950357437133789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008158683776855469
gen group dst list time:  0.0004506111145019531
time for parepare:  0.00022149085998535156
local_output_nid generation:  0.00021195411682128906
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.003423929214477539
local_output_nid generation:  0.00020647048950195312
local_in_edges_tensor generation:  0.00039315223693847656
mini_batch_src_global generation:  0.00033926963806152344
r_  generation:  0.0033347606658935547
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.0003829002380371094
mini_batch_src_global generation:  0.0002791881561279297
r_  generation:  0.0032415390014648438
local_output_nid generation:  0.0002067089080810547
local_in_edges_tensor generation:  0.00038695335388183594
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.003345012664794922
local_output_nid generation:  0.00020956993103027344
local_in_edges_tensor generation:  0.00038933753967285156
mini_batch_src_global generation:  0.00027489662170410156
r_  generation:  0.0033578872680664062
local_output_nid generation:  0.00020456314086914062
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002951383590698242
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation: Using backend: pytorch
 0.00033664703369140625
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0029342174530029297
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.0030434131622314453
----------------------check_connections_block total spend ----------------------------- 0.03844881057739258
generate_one_block  0.004713535308837891
generate_one_block  0.004317760467529297
generate_one_block  0.004227399826049805
generate_one_block  0.0043315887451171875
generate_one_block  0.0043184757232666016
generate_one_block  0.004271030426025391
generate_one_block  0.004651784896850586
generate_one_block  0.0043637752532958984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 0.3207974433898926  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

connection checking time:  0.11414289474487305
block generation total time  0.12074613571166992
average batch blocks generation time:  0.01509326696395874
block dataloader generation time/epoch 0.3546319007873535
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6541748046875 GB
    Memory Allocated: 0.32132720947265625  GigaBytes
Max Memory Allocated: 1.3036870956420898  GigaBytes

torch.Size([2429, 1433])
torch.Size([2333, 256])
torch.Size([2009, 256])
torch.Size([1227, 256])
torch.Size([463, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 1.4483308792114258  GigaBytes
Max Memory Allocated: 1.4484577178955078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.3211703300476074  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2400, 1433])
torch.Size([2285, 256])
torch.Size([1969, 256])
torch.Size([1260, 256])
torch.Size([499, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.422044277191162  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.32099199295043945  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2370, 1433])
torch.Size([2193, 256])
torch.Size([1758, 256])
torch.Size([1044, 256])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.3638677597045898  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.3211841583251953  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2404, 1433])
torch.Size([2272, 256])
torch.Size([1869, 256])
torch.Size([1114, 256])
torch.Size([423, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.397852897644043  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.3212423324584961  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2416, 1433])
torch.Size([2264, 256])
torch.Size([1840, 256])
torch.Size([1057, 256])
torch.Size([394, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.392566204071045  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.3211669921875  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2402, 1433])
torch.Size([2234, 256])
torch.Size([1836, 256])
torch.Size([1082, 256])
torch.Size([390, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.379277229309082  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.32113027572631836  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2398, 1433])
torch.Size([2157, 256])
torch.Size([1597, 256])
torch.Size([867, 256])
torch.Size([333, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.3285174369812012  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 0.32122135162353516  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

torch.Size([2411, 1433])
torch.Size([2268, 256])
torch.Size([1859, 256])
torch.Size([1168, 256])
torch.Size([415, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7420654296875 GB
    Memory Allocated: 1.3935341835021973  GigaBytes
Max Memory Allocated: 1.452127456665039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06269699335098267 |0.001381516456604004 |0.29381507635116577 |0.0001271963119506836 |0.4071793258190155 |0.017119169235229492 |
----------------------------------------------------------pseudo_mini_loss sum 3.4256136417388916
Total (block generation + training)time/epoch 6.566562175750732
Training time/epoch 6.211603879928589
Training time without block to device /epoch 6.200551748275757
Training time without total dataloading part /epoch 5.626091957092285
load block tensor time/epoch 0.5015759468078613
block to device time/epoch 0.011052131652832031
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64870
Number of first layer input nodes during this epoch:  19230
