main start at this time 1648434248.9510841
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014994144439697266
range selection method range initialization spend 0.00011515617370605469
time for parepare:  8.511543273925781e-05
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.003444671630859375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.106231689453125e-05
----------------------check_connections_block total spend ----------------------------- 0.004955768585205078
generate_one_block  0.0020830631256103516
generate_one_block  0.001415252685546875
generate_one_block  0.0014104843139648438
generate_one_block  0.0013649463653564453
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007598400115966797
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.0001888275146484375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00022602081298828125
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004508495330810547
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004277229309082031
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005693435668945312
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005447864532470703
----------------------check_connections_block total spend ----------------------------- 0.003841400146484375
generate_one_block  0.001802682876586914
generate_one_block  0.00174713134765625
generate_one_block  0.0019533634185791016
generate_one_block  0.0018913745880126953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007121562957763672
gen group dst list time:  0.0001087188720703125
time for parepare:  0.00022602081298828125
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.001453399658203125
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0013866424560546875
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.00025177001953125
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0016260147094726562
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0016446113586425781
----------------------check_connections_block total spend ----------------------------- 0.009888887405395508
generate_one_block  0.0029191970825195312
generate_one_block  0.0025577545166015625
generate_one_block  0.0023822784423828125
generate_one_block  0.0024008750915527344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007405281066894531
gen group dst list time:  0.0001761913299560547
time for parepare:  0.0002372264862060547
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0028696060180664062
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.00028777122497558594
r_  generation:  0.0027108192443847656
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.00027489662170410156
r_  generation:  0.002459287643432617
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0024216175079345703
----------------------check_connections_block total spend ----------------------------- 0.016374588012695312
generate_one_block  0.0037384033203125
generate_one_block  0.0033981800079345703
generate_one_block  0.0034537315368652344
generate_one_block  0.0034711360931396484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007522106170654297
gen group dst list time:  0.00019741058349609375
time for parepare:  0.0002033710479736328
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.00022935867309570312
r_  generation:  0.003107786178588867
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.0003573894500732422
mini_batch_src_global generation:  0.0003247261047363281
r_  generation:  0.0029430389404296875
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0003724098205566406
mini_batch_src_global generation:  0.0002682209014892578
r_  generation:  0.0031588077545166016
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.00025844573974609375
r_  generation:  0.003047943115234375
----------------------check_connections_block total spend ----------------------------- 0.018633365631103516
generate_one_block  0.004368305206298828
generate_one_block  0.0038340091705322266
generate_one_block  0.004036426544189453
generate_one_block  0.003926753997802734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007870197296142578
gen group dst list time:  0.00023746490478515625
time for parepare:  0.00019693374633789062
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.0006191730499267578
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.003371000289916992
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003905296325683594
mini_batch_src_global generation:  0.00028967857360839844
r_  generation:  0.003233194351196289
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.00038886070251464844
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.0033981800079345703
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.0003876686096191406
mini_batch_src_global generation:  0.0002741813659667969
r_  generation:  0.003272533416748047
----------------------check_connections_block total spend ----------------------------- 0.020015716552734375
generate_one_block  0.004645347595214844
generate_one_block  0.004082918167114258
generate_one_block  0.004196882247924805
generate_one_block  0.004116535186767578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.1112060546875 GB
    Memory Allocated: 0.07706785202026367  GigaBytes
Max Memory Allocated: 0.07706785202026367  GigaBytes

connection checking time:  0.06875395774841309
block generation total time  0.06492328643798828
average batch blocks generation time:  0.01623082160949707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1756591796875 GB
    Memory Allocated: 0.09050559997558594  GigaBytes
Max Memory Allocated: 0.09050559997558594  GigaBytes

torch.Size([2474, 1433])
torch.Size([2382, 256])
torch.Size([2113, 256])
torch.Size([1464, 256])
torch.Size([658, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4686279296875 GB
    Memory Allocated: 1.270319938659668  GigaBytes
Max Memory Allocated: 1.2705321311950684  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.5877685546875 GB
    Memory Allocated: 0.16814661026000977  GigaBytes
Max Memory Allocated: 1.274071216583252  GigaBytes

torch.Size([2379, 1433])
torch.Size([2267, 256])
torch.Size([1990, 256])
torch.Size([1372, 256])
torch.Size([653, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6405029296875 GB
    Memory Allocated: 1.2836742401123047  GigaBytes
Max Memory Allocated: 1.2838740348815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6756591796875 GB
    Memory Allocated: 0.1681656837463379  GigaBytes
Max Memory Allocated: 1.28741455078125  GigaBytes

torch.Size([2460, 1433])
torch.Size([2391, 256])
torch.Size([2148, 256])
torch.Size([1554, 256])
torch.Size([741, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 1.3649325370788574  GigaBytes
Max Memory Allocated: 1.3652019500732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7283935546875 GB
    Memory Allocated: 0.16815996170043945  GigaBytes
Max Memory Allocated: 1.3686118125915527  GigaBytes

torch.Size([2419, 1433])
torch.Size([2296, 256])
torch.Size([2074, 256])
torch.Size([1532, 256])
torch.Size([760, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 1.3167214393615723  GigaBytes
Max Memory Allocated: 1.3686118125915527  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055006325244903564 |0.08538347482681274 |0.42775529623031616 |0.00016796588897705078 |0.44990217685699463 |0.018368959426879883 |
----------------------------------------------------------pseudo_mini_loss sum 3.156273126602173
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  36861
Number of first layer input nodes during this epoch:  9732
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.3220658302307129  GigaBytes
Max Memory Allocated: 1.3686118125915527  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006761550903320312
range selection method range initialization spend 8.7738037109375e-05
time for parepare:  0.00010943412780761719
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.918212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0015575885772705078
generate_one_block  0.0013394355773925781
generate_one_block  0.0011844635009765625
generate_one_block  0.0011832714080810547
generate_one_block  0.001171112060546875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00054168701171875
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.0003933906555175781
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0004909038543701172
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0003974437713623047
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00043463706970214844
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004398822784423828
----------------------check_connections_block total spend ----------------------------- 0.003946065902709961
generate_one_block  0.0017745494842529297
generate_one_block  0.0016171932220458984
generate_one_block  0.0016565322875976562
generate_one_block  0.0016586780548095703
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006093978881835938
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.0002932548522949219
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation:  0.0003199577331542969
mini_batch_src_global generation:  0.0003826618194580078
r_  generation:  0.0014772415161132812
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0012264251708984375
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.001329660415649414
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.001237630844116211
----------------------check_connections_block total spend ----------------------------- 0.009319782257080078
generate_one_block  0.0029876232147216797
generate_one_block  0.002626657485961914
generate_one_block  0.0025272369384765625
generate_one_block  0.0025207996368408203
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007152557373046875
gen group dst list time:  0.0001666545867919922
time for parepare:  0.00020074844360351562
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0004851818084716797
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.0026826858520507812
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.002438783645629883
local_output_nid generation:  0.0001418590545654297
local_in_edges_tensor generation:  0.00031256675720214844Using backend: pytorch

mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.002606630325317383
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.0024111270904541016
----------------------check_connections_block total spend ----------------------------- 0.01595020294189453
generate_one_block  0.004033327102661133
generate_one_block  0.0036056041717529297
generate_one_block  0.003717660903930664
generate_one_block  0.0035228729248046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007874965667724609
gen group dst list time:  0.0002181529998779297
time for parepare:  0.00021004676818847656
local_output_nid generation:  0.00018215179443359375
local_in_edges_tensor generation:  0.0005228519439697266
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0032739639282226562
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.0002899169921875
r_  generation:  0.0031630992889404297
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.0003743171691894531
r_  generation:  0.0032444000244140625
local_output_nid generation:  0.00018286705017089844
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.003161191940307617
----------------------check_connections_block total spend ----------------------------- 0.01959061622619629
generate_one_block  0.004548549652099609
generate_one_block  0.004179954528808594
generate_one_block  0.004269599914550781
generate_one_block  0.004189014434814453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007977485656738281
gen group dst list time:  0.00024700164794921875
time for parepare:  0.0002162456512451172
local_output_nid generation:  0.0002033710479736328
local_in_edges_tensor generation:  0.0005011558532714844
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.0034372806549072266
local_output_nid generation:  0.00020456314086914062
local_in_edges_tensor generation:  0.0003986358642578125
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.003397703170776367
local_output_nid generation:  0.00020694732666015625
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.00028014183044433594
r_  generation:  0.0034525394439697266
local_output_nid generation:  0.00020194053649902344
local_in_edges_tensor generation:  0.00039458274841308594
mini_batch_src_global generation:  0.00029754638671875
r_  generation:  0.0034584999084472656
----------------------check_connections_block total spend ----------------------------- 0.02066493034362793
generate_one_block  0.005370616912841797
generate_one_block  0.004377126693725586
generate_one_block  0.004404544830322266
generate_one_block  0.00465083122253418
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.3220658302307129  GigaBytes
Max Memory Allocated: 1.3686118125915527  GigaBytes

connection checking time:  0.06947159767150879
block generation total time  0.06823897361755371
average batch blocks generation time:  0.017059743404388428
block dataloader generation time/epoch 0.20520782470703125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8280029296875 GB
    Memory Allocated: 0.32163286209106445  GigaBytes
Max Memory Allocated: 1.3686118125915527  GigaBytes

torch.Size([2453, 1433])
torch.Size([2387, 256])
torch.Size([2190, 256])
torch.Size([1654, 256])
torch.Size([812, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8475341796875 GB
    Memory Allocated: 1.5305018424987793  GigaBytes
Max Memory Allocated: 1.530740737915039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.32161855697631836  GigaBytes
Max Memory Allocated: 1.5342187881469727  GigaBytes

torch.Size([2434, 1433])
torch.Size([2361, 256])
torch.Size([2085, 256])
torch.Size([1472, 256])
torch.Size([643, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 1.495382308959961  GigaBytes
Max Memory Allocated: 1.5342187881469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.3216280937194824  GigaBytes
Max Memory Allocated: 1.5342187881469727  GigaBytes

torch.Size([2486, 1433])
torch.Size([2415, 256])
torch.Size([2182, 256])
torch.Size([1588, 256])
torch.Size([703, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 1.5239486694335938  GigaBytes
Max Memory Allocated: 1.5342187881469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8514404296875 GB
    Memory Allocated: 0.32161951065063477  GigaBytes
Max Memory Allocated: 1.5342187881469727  GigaBytes

torch.Size([2481, 1433])
torch.Size([2399, 256])
torch.Size([2090, 256])
torch.Size([1479, 256])
torch.Size([660, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8533935546875 GB
    Memory Allocated: 1.5018010139465332  GigaBytes
Max Memory Allocated: 1.5342187881469727  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05298507213592529 |0.001173257827758789 |0.3130819797515869 |0.00013518333435058594 |0.44046086072921753 |0.01429438591003418 |
----------------------------------------------------------pseudo_mini_loss sum 3.4455156326293945
Total (block generation + training)time/epoch 3.5174710750579834
Training time/epoch 3.3119020462036133
Training time without block to device /epoch 3.307209014892578
Training time without total dataloading part /epoch 3.0290064811706543
load block tensor time/epoch 0.21194028854370117
block to device time/epoch 0.004693031311035156
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37704
Number of first layer input nodes during this epoch:  9854
