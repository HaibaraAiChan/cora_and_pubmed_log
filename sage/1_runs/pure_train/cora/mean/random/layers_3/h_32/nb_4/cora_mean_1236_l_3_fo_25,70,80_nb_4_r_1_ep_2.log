main start at this time 1648427493.3318257
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001157522201538086
random selection method range initialization spend 0.0002143383026123047
time for parepare:  7.772445678710938e-05
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0023283958435058594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.581710815429688e-05
----------------------check_connections_block total spend ----------------------------- 0.0037894248962402344
generate_one_block  0.0015790462493896484
generate_one_block  0.00135040283203125
generate_one_block  0.0013265609741210938
generate_one_block  0.0013172626495361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006074905395507812
gen group dst list time:  5.030632019042969e-05
time for parepare:  0.00017881393432617188
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0006237030029296875
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005326271057128906
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.000507354736328125
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005002021789550781
----------------------check_connections_block total spend ----------------------------- 0.004162788391113281
generate_one_block  0.002013683319091797
generate_one_block  0.0018925666809082031
generate_one_block  0.0018482208251953125
generate_one_block  0.001804351806640625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006890296936035156
gen group dst list time:  0.000102996826171875
time for parepare:  0.00022912025451660156
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00034689903259277344
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0018024444580078125
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0016140937805175781
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0016789436340332031
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0014731884002685547
----------------------check_connections_block total spend ----------------------------- 0.010493278503417969
generate_one_block  0.0032837390899658203
generate_one_block  0.0025222301483154297
generate_one_block  0.0023975372314453125
generate_one_block  0.0023365020751953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.01465606689453125
block generation total time  0.018098831176757812
average batch blocks generation time:  0.004524707794189453
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009357452392578125  GigaBytes
Max Memory Allocated: 0.009357452392578125  GigaBytes

torch.Size([1677, 1433])
torch.Size([859, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009867668151855469  GigaBytes
Max Memory Allocated: 0.009905338287353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00891733169555664  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

torch.Size([1529, 1433])
torch.Size([789, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009366035461425781  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009707450866699219  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

torch.Size([1624, 1433])
torch.Size([814, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010163307189941406  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008672237396240234  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

torch.Size([1484, 1433])
torch.Size([698, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009079456329345703  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004232347011566162 |0.08598995208740234 |0.193406879901886 |0.0001696944236755371 |0.0031623244285583496 |0.002469301223754883 |
----------------------------------------------------------pseudo_mini_loss sum 4.01055908203125
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10203
Number of first layer input nodes during this epoch:  6314
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009467601776123047  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048732757568359375
random selection method range initialization spend 0.00011324882507324219
time for parepare:  6.890296936035156e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.916854858398438e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00011229515075683594
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.0013322830200195312
generate_one_block  0.001161336898803711
generate_one_block  0.0010991096496582031
generate_one_block  0.0010809898376464844
generate_one_block  0.0010814666748046875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004951953887939453
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.00015783309936523438
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004773139953613281
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0004532337188720703
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.000385284423828125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004372596740722656
----------------------check_connections_block total spend ----------------------------- 0.0033690929412841797
generate_one_block  0.0016717910766601562
generate_one_block  0.0015501976013183594
generate_one_block  0.0014722347259521484
generate_one_block  0.0015234947204589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005996227264404297
gen group dst list time:  8.368492126464844e-05
time for parepare:  0.00018215179443359375
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00029754638671875
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0013320446014404297
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.001344442367553711
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0011470317840576172
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0013649463653564453
----------------------check_connections_block total spend ----------------------------- 0.008386373519897461
generate_one_block  0.002565622329711914
generate_one_block  0.0026607513427734375
generate_one_block  0.0023736953735351562
generate_one_block  0.002753019332885742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009467601776123047  GigaBytes
Max Memory Allocated: 0.01782846450805664  GigaBytes

connection checking time:  0.01175546646118164
block generation total time  0.0165708065032959
average batch blocks generation time:  0.004142701625823975
block dataloader generation time/epoch 0.043622732162475586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010415077209472656  GigaBytes
Max Memory Allocated: 0.018294811248779297  GigaBytes

torch.Size([1531, 1433])
torch.Size([794, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010882377624511719  GigaBytes
Max Memory Allocated: 0.018294811248779297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010138511657714844  GigaBytes
Max Memory Allocated: 0.019048690795898438  GigaBytes

torch.Size([1625, 1433])
torch.Size([819, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01060342788696289  GigaBytes
Max Memory Allocated: 0.019048690795898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009133338928222656  GigaBytes
Max Memory Allocated: 0.019048690795898438  GigaBytes

torch.Size([1438, 1433])
torch.Size([662, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009525775909423828  GigaBytes
Max Memory Allocated: 0.019048690795898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010394573211669922  GigaBytes
Max Memory Allocated: 0.019048690795898438  GigaBytes

torch.Size([1673, 1433])
torch.Size([805, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010854721069335938  GigaBytes
Max Memory Allocated: 0.019048690795898438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025416016578674316 |0.0005155205726623535 |0.004298985004425049 |0.00014698505401611328 |0.0057642459869384766 |0.0016055107116699219 |
----------------------------------------------------------pseudo_mini_loss sum 2.602761745452881
Total (block generation + training)time/epoch 0.10401129722595215
Training time/epoch 0.06000566482543945
Training time without block to device /epoch 0.05794358253479004
Training time without total dataloading part /epoch 0.04244637489318848
load block tensor time/epoch 0.010166406631469727
block to device time/epoch 0.002062082290649414
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10075
Number of first layer input nodes during this epoch:  6267
