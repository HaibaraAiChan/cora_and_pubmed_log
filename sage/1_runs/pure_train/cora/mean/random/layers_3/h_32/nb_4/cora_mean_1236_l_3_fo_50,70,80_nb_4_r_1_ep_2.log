main start at this time 1648427530.5541544
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006229877471923828
random selection method range initialization spend 0.00016236305236816406
time for parepare:  6.628036499023438e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0011348724365234375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0023834705352783203
generate_one_block  0.0013852119445800781
generate_one_block  0.0012247562408447266
generate_one_block  0.0012097358703613281
generate_one_block  0.0012021064758300781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005171298980712891
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0001583099365234375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0005192756652832031
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004527568817138672
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004298686981201172
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0004057884216308594
----------------------check_connections_block total spend ----------------------------- 0.0035326480865478516
generate_one_block  0.003729581832885742
generate_one_block  0.0017490386962890625
generate_one_block  0.0016505718231201172
generate_one_block  0.0016124248504638672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008406639099121094
gen group dst list time:  8.440017700195312e-05
time for parepare:  0.0002052783966064453
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0002875328063964844
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0015308856964111328
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.00138092041015625
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0014429092407226562
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0012786388397216797
----------------------check_connections_block total spend ----------------------------- 0.008970975875854492
generate_one_block  0.002965211868286133
generate_one_block  0.002740621566772461
generate_one_block  0.0025434494018554688
generate_one_block  0.0024764537811279297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.012503623962402344
block generation total time  0.01946735382080078
average batch blocks generation time:  0.004866838455200195
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.00958251953125  GigaBytes
Max Memory Allocated: 0.00958251953125  GigaBytes

torch.Size([1719, 1433])
torch.Size([860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.01009368896484375  GigaBytes
Max Memory Allocated: 0.010136127471923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008982181549072266  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

torch.Size([1541, 1433])
torch.Size([792, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009431838989257812  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009932518005371094  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

torch.Size([1641, 1433])
torch.Size([812, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010387897491455078  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008807659149169922  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

torch.Size([1509, 1433])
torch.Size([702, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009218215942382812  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003095686435699463 |0.08602666854858398 |0.19419682025909424 |0.00017750263214111328 |0.003350973129272461 |0.0025687217712402344 |
----------------------------------------------------------pseudo_mini_loss sum 4.006449222564697
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10305
Number of first layer input nodes during this epoch:  6410
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00960683822631836  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005807876586914062
random selection method range initialization spend 0.00015020370483398438
time for parepare:  8.177757263183594e-05
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013566017150878906
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.890296936035156e-05
----------------------check_connections_block total spend ----------------------------- 0.0015976428985595703
generate_one_block  0.0014111995697021484
generate_one_block  0.0013420581817626953
generate_one_block  0.0013217926025390625
generate_one_block  0.001325845718383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005979537963867188
gen group dst list time:  5.364418029785156e-05
time for parepare:  0.0002167224884033203
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0006122589111328125
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0005667209625244141
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.00047469139099121094
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005290508270263672
----------------------check_connections_block total spend ----------------------------- 0.004192352294921875
generate_one_block  0.002019166946411133
generate_one_block  0.0018794536590576172
generate_one_block  0.0017650127410888672
generate_one_block  0.0018448829650878906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007033348083496094
gen group dst list time:  0.00011682510375976562
time for parepare:  0.00023651123046875
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0017006397247314453
local_output_nid generation:  9.560585021972656e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.001735687255859375
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00016689300537109375
r_  generation:  0.001482248306274414
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.001795053482055664
----------------------check_connections_block total spend ----------------------------- 0.010880470275878906
generate_one_block  0.0032579898834228516
generate_one_block  0.0025932788848876953
generate_one_block  0.002227306365966797
generate_one_block  0.002942323684692383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00960683822631836  GigaBytes
Max Memory Allocated: 0.018116474151611328  GigaBytes

connection checking time:  0.015072822570800781
block generation total time  0.018529415130615234
average batch blocks generation time:  0.004632353782653809
block dataloader generation time/epoch 0.05173230171203613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010640144348144531  GigaBytes
Max Memory Allocated: 0.01865243911743164  GigaBytes

torch.Size([1588, 1433])
torch.Size([792, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01110696792602539  GigaBytes
Max Memory Allocated: 0.01865243911743164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010193824768066406  GigaBytes
Max Memory Allocated: 0.019326210021972656  GigaBytes

torch.Size([1635, 1433])
torch.Size([811, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010657310485839844  GigaBytes
Max Memory Allocated: 0.019326210021972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0092315673828125  GigaBytes
Max Memory Allocated: 0.019326210021972656  GigaBytes

torch.Size([1456, 1433])
torch.Size([661, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009625911712646484  GigaBytes
Max Memory Allocated: 0.019326210021972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01058340072631836  GigaBytes
Max Memory Allocated: 0.019326210021972656  GigaBytes

torch.Size([1708, 1433])
torch.Size([808, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011045455932617188  GigaBytes
Max Memory Allocated: 0.019326210021972656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0016065239906311035 |0.00048214197158813477 |0.003533780574798584 |0.0001207590103149414 |0.0037346482276916504 |0.0016701221466064453 |
----------------------------------------------------------pseudo_mini_loss sum 2.5597686767578125
Total (block generation + training)time/epoch 0.09611725807189941
Training time/epoch 0.04421210289001465
Training time without block to device /epoch 0.04228353500366211
Training time without total dataloading part /epoch 0.03122687339782715
load block tensor time/epoch 0.006426095962524414
block to device time/epoch 0.001928567886352539
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10187
Number of first layer input nodes during this epoch:  6387
