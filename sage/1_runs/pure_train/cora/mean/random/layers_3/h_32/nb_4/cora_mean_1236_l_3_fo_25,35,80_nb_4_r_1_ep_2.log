main start at this time 1648427456.2042599
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010685920715332031
random selection method range initialization spend 0.00020432472229003906
time for parepare:  6.794929504394531e-05
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0024445056915283203
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.628036499023438e-05
----------------------check_connections_block total spend ----------------------------- 0.003725290298461914
generate_one_block  0.0014431476593017578
generate_one_block  0.0012090206146240234
generate_one_block  0.0011839866638183594
generate_one_block  0.0011749267578125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005075931549072266
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.0001418590545654297
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004985332489013672
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0004138946533203125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00039315223693847656
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0003731250762939453
----------------------check_connections_block total spend ----------------------------- 0.003317117691040039
generate_one_block  0.0017290115356445312
generate_one_block  0.001596689224243164
generate_one_block  0.0015819072723388672
generate_one_block  0.001531362533569336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005795955657958984
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.00017499923706054688
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.0013928413391113281
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.001209259033203125
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0012443065643310547
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0011022090911865234
----------------------check_connections_block total spend ----------------------------- 0.00798487663269043
generate_one_block  0.0031447410583496094
generate_one_block  0.0024611949920654297
generate_one_block  0.002399921417236328
generate_one_block  0.002253293991088867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.011301994323730469
block generation total time  0.016698122024536133
average batch blocks generation time:  0.004174530506134033
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008986473083496094  GigaBytes
Max Memory Allocated: 0.008986473083496094  GigaBytes

torch.Size([1608, 1433])
torch.Size([801, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009472370147705078  GigaBytes
Max Memory Allocated: 0.009503841400146484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008411884307861328  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

torch.Size([1435, 1433])
torch.Size([697, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008820056915283203  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009335517883300781  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

torch.Size([1543, 1433])
torch.Size([713, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009747982025146484  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008141040802001953  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

torch.Size([1385, 1433])
torch.Size([619, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008513450622558594  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036882758140563965 |0.0853986144065857 |0.19274824857711792 |0.00018477439880371094 |0.0032806396484375 |0.002538442611694336 |
----------------------------------------------------------pseudo_mini_loss sum 3.9812171459198
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9530
Number of first layer input nodes during this epoch:  5971
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008929252624511719  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006060600280761719
random selection method range initialization spend 0.0001468658447265625
time for parepare:  8.440017700195312e-05
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013375282287597656
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.916854858398438e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.794929504394531e-05
----------------------check_connections_block total spend ----------------------------- 0.0016036033630371094
generate_one_block  0.0014035701751708984
generate_one_block  0.0013349056243896484
generate_one_block  0.001318216323852539
generate_one_block  0.0013113021850585938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006127357482910156
gen group dst list time:  5.3882598876953125e-05
time for parepare:  0.00020503997802734375
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005669593811035156
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0005121231079101562
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004410743713378906
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005016326904296875
----------------------check_connections_block total spend ----------------------------- 0.003944873809814453
generate_one_block  0.0020122528076171875
generate_one_block  0.0018262863159179688
generate_one_block  0.001739501953125
generate_one_block  0.0017962455749511719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006666183471679688
gen group dst list time:  0.0001125335693359375
time for parepare:  0.00025272369384765625
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0016009807586669922
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.0015606880187988281
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.0013129711151123047
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0016055107116699219
----------------------check_connections_block total spend ----------------------------- 0.00987100601196289
generate_one_block  0.003111600875854492
generate_one_block  0.0027513504028320312
generate_one_block  0.0021054744720458984
generate_one_block  0.002677440643310547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008929252624511719  GigaBytes
Max Memory Allocated: 0.01695871353149414  GigaBytes

connection checking time:  0.013815879821777344
block generation total time  0.018020153045654297
average batch blocks generation time:  0.004505038261413574
block dataloader generation time/epoch 0.04938340187072754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010045051574707031  GigaBytes
Max Memory Allocated: 0.017398357391357422  GigaBytes

torch.Size([1499, 1433])
torch.Size([749, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010492324829101562  GigaBytes
Max Memory Allocated: 0.017398357391357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00961160659790039  GigaBytes
Max Memory Allocated: 0.018157482147216797  GigaBytes

torch.Size([1527, 1433])
torch.Size([716, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01003122329711914  GigaBytes
Max Memory Allocated: 0.018157482147216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008799552917480469  GigaBytes
Max Memory Allocated: 0.018157482147216797  GigaBytes

torch.Size([1376, 1433])
torch.Size([592, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009160041809082031  GigaBytes
Max Memory Allocated: 0.018157482147216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010006427764892578  GigaBytes
Max Memory Allocated: 0.018157482147216797  GigaBytes

torch.Size([1601, 1433])
torch.Size([725, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01043081283569336  GigaBytes
Max Memory Allocated: 0.018157482147216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0026971101760864258 |0.0006267428398132324 |0.00418323278427124 |0.0001245737075805664 |0.002055525779724121 |0.0013604164123535156 |
----------------------------------------------------------pseudo_mini_loss sum 2.5312561988830566
Total (block generation + training)time/epoch 0.09535980224609375
Training time/epoch 0.04542088508605957
Training time without block to device /epoch 0.04291391372680664
Training time without total dataloading part /epoch 0.026813745498657227
load block tensor time/epoch 0.010788440704345703
block to device time/epoch 0.0025069713592529297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9513
Number of first layer input nodes during this epoch:  6003
