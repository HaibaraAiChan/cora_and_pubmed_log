main start at this time 1648427418.7262897
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014903545379638672
random selection method range initialization spend 0.0002040863037109375
time for parepare:  6.365776062011719e-05
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0023970603942871094
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.0035707950592041016
generate_one_block  0.0014276504516601562
generate_one_block  0.0011091232299804688
generate_one_block  0.0010759830474853516
generate_one_block  0.0011239051818847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005016326904296875
gen group dst list time:  3.790855407714844e-05
time for parepare:  0.00012993812561035156
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00044536590576171875
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00037097930908203125
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003666877746582031
----------------------check_connections_block total spend ----------------------------- 0.003040313720703125
generate_one_block  0.0016150474548339844
generate_one_block  0.0014445781707763672
generate_one_block  0.0015070438385009766
generate_one_block  0.0013861656188964844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005373954772949219
gen group dst list time:  7.390975952148438e-05
time for parepare:  0.00016021728515625
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.0012958049774169922
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0010879039764404297
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.001215219497680664
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0010089874267578125
----------------------check_connections_block total spend ----------------------------- 0.00743865966796875
generate_one_block  0.0030333995819091797
generate_one_block  0.0022623538970947266
generate_one_block  0.00231170654296875
generate_one_block  0.0022258758544921875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.010478973388671875
block generation total time  0.015786170959472656
average batch blocks generation time:  0.003946542739868164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009013175964355469  GigaBytes
Max Memory Allocated: 0.009013175964355469  GigaBytes

torch.Size([1613, 1433])
torch.Size([809, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009501934051513672  GigaBytes
Max Memory Allocated: 0.009534358978271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008368968963623047  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

torch.Size([1427, 1433])
torch.Size([701, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008778572082519531  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009362220764160156  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

torch.Size([1552, 1433])
torch.Size([721, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009778022766113281  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008301258087158203  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

torch.Size([1415, 1433])
torch.Size([627, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008677005767822266  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011007070541381836 |0.08561283349990845 |0.19430923461914062 |0.00019425153732299805 |0.003137350082397461 |0.0024967193603515625 |
----------------------------------------------------------pseudo_mini_loss sum 4.021053314208984
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9594
Number of first layer input nodes during this epoch:  6007
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009089946746826172  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005850791931152344
random selection method range initialization spend 0.0001437664031982422
time for parepare:  8.893013000488281e-05
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001323223114013672
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0015795230865478516
generate_one_block  0.0014193058013916016
generate_one_block  0.001329183578491211
generate_one_block  0.0013151168823242188
generate_one_block  0.001306295394897461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005841255187988281
gen group dst list time:  5.459785461425781e-05
time for parepare:  0.0002052783966064453
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0005521774291992188
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0005021095275878906
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00043702125549316406
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004916191101074219
----------------------check_connections_block total spend ----------------------------- 0.0038979053497314453
generate_one_block  0.001935720443725586
generate_one_block  0.001539468765258789
generate_one_block  0.001462697982788086
generate_one_block  0.001531362533569336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005793571472167969
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.00018906593322753906
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.0013179779052734375
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0012454986572265625
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0010738372802734375
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0012767314910888672
----------------------check_connections_block total spend ----------------------------- 0.007935285568237305
generate_one_block  0.002560853958129883
generate_one_block  0.0025212764739990234
generate_one_block  0.0022847652435302734
generate_one_block  0.0026824474334716797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009089946746826172  GigaBytes
Max Memory Allocated: 0.016942501068115234  GigaBytes

connection checking time:  0.01183319091796875
block generation total time  0.016518592834472656
average batch blocks generation time:  0.004129648208618164
block dataloader generation time/epoch 0.045999765396118164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010071754455566406  GigaBytes
Max Memory Allocated: 0.017585277557373047  GigaBytes

torch.Size([1487, 1433])
torch.Size([750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010519027709960938  GigaBytes
Max Memory Allocated: 0.017585277557373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009531497955322266  GigaBytes
Max Memory Allocated: 0.018104076385498047  GigaBytes

torch.Size([1512, 1433])
torch.Size([716, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009951114654541016  GigaBytes
Max Memory Allocated: 0.018104076385498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008591651916503906  GigaBytes
Max Memory Allocated: 0.018104076385498047  GigaBytes

torch.Size([1337, 1433])
torch.Size([594, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008954048156738281  GigaBytes
Max Memory Allocated: 0.018104076385498047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00982522964477539  GigaBytes
Max Memory Allocated: 0.018104076385498047  GigaBytes

torch.Size([1567, 1433])
torch.Size([723, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010248184204101562  GigaBytes
Max Memory Allocated: 0.018104076385498047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012187361717224121 |0.0004240870475769043 |0.003255009651184082 |0.0001150965690612793 |0.0016776323318481445 |0.0014193058013916016 |
----------------------------------------------------------pseudo_mini_loss sum 2.5352437496185303
Total (block generation + training)time/epoch 0.07848286628723145
Training time/epoch 0.032311201095581055
Training time without block to device /epoch 0.030614852905273438
Training time without total dataloading part /epoch 0.021610260009765625
load block tensor time/epoch 0.0048749446868896484
block to device time/epoch 0.0016963481903076172
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9414
Number of first layer input nodes during this epoch:  5903
