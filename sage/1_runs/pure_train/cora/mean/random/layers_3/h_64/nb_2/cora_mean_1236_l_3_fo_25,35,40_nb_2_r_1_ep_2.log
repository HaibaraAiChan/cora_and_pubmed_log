main start at this time 1648427559.000372
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015332698822021484
random selection method range initialization spend 0.00020074844360351562
time for parepare:  6.29425048828125e-05
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0029244422912597656
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011539459228515625
----------------------check_connections_block total spend ----------------------------- 0.0038127899169921875
generate_one_block  0.0016827583312988281
generate_one_block  0.0011944770812988281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004971027374267578
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.00014090538024902344
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0007252693176269531
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0006554126739501953
----------------------check_connections_block total spend ----------------------------- 0.002519369125366211
generate_one_block  0.0018892288208007812
generate_one_block  0.0018169879913330078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005702972412109375
gen group dst list time:  5.340576171875e-05
time for parepare:  0.00017333030700683594
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.001786947250366211
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0016016960144042969
----------------------check_connections_block total spend ----------------------------- 0.005429267883300781
generate_one_block  0.0031702518463134766
generate_one_block  0.0029473304748535156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.007948637008666992
block generation total time  0.009823799133300781
average batch blocks generation time:  0.004911899566650391
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010911941528320312  GigaBytes
Max Memory Allocated: 0.010911941528320312  GigaBytes

torch.Size([1897, 1433])
torch.Size([1135, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.012248516082763672  GigaBytes
Max Memory Allocated: 0.012329578399658203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011400699615478516  GigaBytes
Max Memory Allocated: 0.021472454071044922  GigaBytes

torch.Size([1854, 1433])
torch.Size([1023, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01259613037109375  GigaBytes
Max Memory Allocated: 0.021472454071044922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014453291893005371 |0.17174053192138672 |0.38247227668762207 |0.000213623046875 |0.0044384002685546875 |0.0026438236236572266 |
----------------------------------------------------------pseudo_mini_loss sum 3.5324554443359375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6607
Number of first layer input nodes during this epoch:  3751
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012970924377441406  GigaBytes
Max Memory Allocated: 0.021472454071044922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005326271057128906
random selection method range initialization spend 0.00012302398681640625
time for parepare:  7.677078247070312e-05
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001556873321533203
----------------------check_connections_block total spend ----------------------------- 0.0010104179382324219
generate_one_block  0.0011749267578125
generate_one_block  0.0011744499206542969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048613548278808594
gen group dst list time:  4.4345855712890625e-05
time for parepare:  0.0001552104949951172
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005826950073242188
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0006794929504394531
----------------------check_connections_block total spend ----------------------------- 0.002372264862060547
generate_one_block  0.0017328262329101562
generate_one_block  0.0018870830535888672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00054168701171875
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.0001780986785888672
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0014944076538085938
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0017368793487548828
----------------------check_connections_block total spend ----------------------------- 0.005222797393798828
generate_one_block  0.002650022506713867
generate_one_block  0.0029015541076660156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012970924377441406  GigaBytes
Max Memory Allocated: 0.021472454071044922  GigaBytes

connection checking time:  0.007595062255859375
block generation total time  0.009171485900878906
average batch blocks generation time:  0.004585742950439453
block dataloader generation time/epoch 0.028562068939208984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012414932250976562  GigaBytes
Max Memory Allocated: 0.022260189056396484  GigaBytes
Using backend: pytorch

torch.Size([1775, 1433])
torch.Size([1018, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013588905334472656  GigaBytes
Max Memory Allocated: 0.022260189056396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012759685516357422  GigaBytes
Max Memory Allocated: 0.022260189056396484  GigaBytes

torch.Size([1838, 1433])
torch.Size([1129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014096260070800781  GigaBytes
Max Memory Allocated: 0.022260189056396484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0026973485946655273 |0.00038933753967285156 |0.00298154354095459 |0.00011277198791503906 |0.002004265785217285 |0.0012767314910888672 |
----------------------------------------------------------pseudo_mini_loss sum 1.9418179988861084
Total (block generation + training)time/epoch 0.04844808578491211
Training time/epoch 0.019628047943115234
Training time without block to device /epoch 0.01884937286376953
Training time without total dataloading part /epoch 0.011473894119262695
load block tensor time/epoch 0.005394697189331055
block to device time/epoch 0.0007786750793457031
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6448
Number of first layer input nodes during this epoch:  3613
