main start at this time 1648427642.229214
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012786388397216797
random selection method range initialization spend 0.00020813941955566406
time for parepare:  6.031990051269531e-05
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.002252340316772461
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.003506183624267578
generate_one_block  0.0015873908996582031
generate_one_block  0.0011162757873535156
generate_one_block  0.001062631607055664
generate_one_block  0.0011463165283203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005273818969726562
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0001423358917236328
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004000663757324219
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0004742145538330078
----------------------check_connections_block total spend ----------------------------- 0.003222942352294922
generate_one_block  0.001542806625366211
generate_one_block  0.0015299320220947266
generate_one_block  0.0014667510986328125
generate_one_block  0.0016787052154541016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005385875701904297
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.0001971721649169922
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0012028217315673828
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0012664794921875
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.0010423660278320312
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.001215219497680664
----------------------check_connections_block total spend ----------------------------- 0.007673501968383789
generate_one_block  0.0024361610412597656
generate_one_block  0.0024759769439697266
generate_one_block  0.0021448135375976562
generate_one_block  0.0024750232696533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.010896444320678711
block generation total time  0.01575016975402832
average batch blocks generation time:  0.00393754243850708
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.00915670394897461  GigaBytes
Max Memory Allocated: 0.00915670394897461  GigaBytes

torch.Size([1572, 1433])
torch.Size([773, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010011672973632812  GigaBytes
Max Memory Allocated: 0.010121345520019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010105609893798828  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

torch.Size([1614, 1433])
torch.Size([842, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011013507843017578  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00987100601196289  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

torch.Size([1426, 1433])
torch.Size([635, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010556221008300781  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009902477264404297  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

torch.Size([1576, 1433])
torch.Size([806, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01078033447265625  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0048348307609558105 |0.08540606498718262 |0.1963263750076294 |0.00022172927856445312 |0.003730475902557373 |0.0027320384979248047 |
----------------------------------------------------------pseudo_mini_loss sum 3.224153757095337
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9978
Number of first layer input nodes during this epoch:  6188
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011445045471191406  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004718303680419922
random selection method range initialization spend 0.00010848045349121094
time for parepare:  6.175041198730469e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00010800361633300781
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  7.605552673339844e-05
----------------------check_connections_block total spend ----------------------------- 0.0012784004211425781
generate_one_block  0.0011053085327148438
generate_one_block  0.0010662078857421875
generate_one_block  0.0010960102081298828
generate_one_block  0.0010764598846435547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004928112030029297
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0001533031463623047
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00035309791564941406
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00043082237243652344
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004382133483886719
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004901885986328125
----------------------check_connections_block total spend ----------------------------- 0.0033364295959472656
generate_one_block  0.0015153884887695312
generate_one_block  0.0015254020690917969
generate_one_block  0.0014879703521728516
generate_one_block  0.0016117095947265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005946159362792969
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.00017881393432617188
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0002701282501220703
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0010623931884765625
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0013370513916015625
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0012297630310058594
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0014190673828125
----------------------check_connections_block total spend ----------------------------- 0.008307218551635742
generate_one_block  0.0022974014282226562
generate_one_block  0.0025436878204345703
generate_one_block  0.0024394989013671875
generate_one_block  0.0029366016387939453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011445045471191406  GigaBytes
Max Memory Allocated: 0.018454551696777344  GigaBytes

connection checking time:  0.011643648147583008
block generation total time  0.0163576602935791
average batch blocks generation time:  0.004089415073394775
block dataloader generation time/epoch 0.04331398010253906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011312007904052734  GigaBytes
Max Memory Allocated: 0.019690513610839844  GigaBytes

torch.Size([1428, 1433])
torch.Size([643, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01201629638671875  GigaBytes
Max Memory Allocated: 0.019690513610839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011629104614257812  GigaBytes
Max Memory Allocated: 0.01997995376586914  GigaBytes

torch.Size([1630, 1433])
torch.Size([818, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012494087219238281  GigaBytes
Max Memory Allocated: 0.01997995376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011317729949951172  GigaBytes
Max Memory Allocated: 0.01997995376586914  GigaBytes

torch.Size([1534, 1433])
torch.Size([771, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01215505599975586  GigaBytes
Max Memory Allocated: 0.01997995376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011655330657958984  GigaBytes
Max Memory Allocated: 0.02000141143798828  GigaBytes

torch.Size([1634, 1433])
torch.Size([850, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012600421905517578  GigaBytes
Max Memory Allocated: 0.02000141143798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025789737701416016 |0.00039702653884887695 |0.0030770301818847656 |0.00010263919830322266 |0.003136575222015381 |0.0012884140014648438 |
----------------------------------------------------------pseudo_mini_loss sum 2.002119541168213
Total (block generation + training)time/epoch 0.0858914852142334
Training time/epoch 0.042238712310791016
Training time without block to device /epoch 0.04065060615539551
Training time without total dataloading part /epoch 0.02655339241027832
load block tensor time/epoch 0.010315895080566406
block to device time/epoch 0.0015881061553955078
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10042
Number of first layer input nodes during this epoch:  6226
