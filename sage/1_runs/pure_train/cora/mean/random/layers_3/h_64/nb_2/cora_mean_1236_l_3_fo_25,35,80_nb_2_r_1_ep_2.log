main start at this time 1648427596.2460103
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011484622955322266
random selection method range initialization spend 0.00019097328186035156
time for parepare:  6.508827209472656e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.002112150192260742
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00012063980102539062
----------------------check_connections_block total spend ----------------------------- 0.0029497146606445312
generate_one_block  0.0015420913696289062
generate_one_block  0.001264810562133789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005075931549072266
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.00014543533325195312
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0007219314575195312
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006527900695800781
----------------------check_connections_block total spend ----------------------------- 0.002513885498046875
generate_one_block  0.001984834671020508
generate_one_block  0.0019161701202392578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005707740783691406
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.0001742839813232422
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0018429756164550781
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0016400814056396484
----------------------check_connections_block total spend ----------------------------- 0.005541324615478516
generate_one_block  0.0037152767181396484
generate_one_block  0.0029282569885253906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.00805521011352539
block generation total time  0.010544538497924805
average batch blocks generation time:  0.005272269248962402
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010912895202636719  GigaBytes
Max Memory Allocated: 0.010912895202636719  GigaBytes

torch.Size([1897, 1433])
torch.Size([1138, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.012252330780029297  GigaBytes
Max Memory Allocated: 0.012333393096923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011314868927001953  GigaBytes
Max Memory Allocated: 0.02138662338256836  GigaBytes

torch.Size([1838, 1433])
torch.Size([1018, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01250600814819336  GigaBytes
Max Memory Allocated: 0.02138662338256836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016812682151794434 |0.17036819458007812 |0.38313329219818115 |0.00019109249114990234 |0.005011558532714844 |0.004258632659912109 |
----------------------------------------------------------pseudo_mini_loss sum 3.4483625888824463
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6589
Number of first layer input nodes during this epoch:  3735
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012885093688964844  GigaBytes
Max Memory Allocated: 0.02138662338256836  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000644683837890625
random selection method range initialization spend 0.0001423358917236328
time for parepare:  9.465217590332031e-05
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00015234947204589844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013780593872070312
----------------------check_connections_block total spend ----------------------------- 0.0010497570037841797
generate_one_block  0.0012295246124267578
generate_one_block  0.0011911392211914062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004942417144775391
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.00015306472778320312
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006265640258789062
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0007507801055908203
----------------------check_connections_block total spend ----------------------------- 0.0025267601013183594
generate_one_block  0.0017704963684082031
generate_one_block  0.002042055130004883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005648136138916016
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0014812946319580078
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.001680612564086914
----------------------check_connections_block total spend ----------------------------- 0.005113363265991211
generate_one_block  0.002924203872680664
generate_one_block  0.002896547317504883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012885093688964844  GigaBytes
Max Memory Allocated: 0.02138662338256836  GigaBytes

connection checking time:  0.00764012336730957
block generation total time  0.009633302688598633
average batch blocks generation time:  0.004816651344299316
block dataloader generation time/epoch 0.04360795021057129
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012585639953613281  GigaBytes
Max Memory Allocated: 0.02234506607055664  GigaBytes
Using backend: pytorch

torch.Size([1807, 1433])
torch.Size([1021, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013762474060058594  GigaBytes
Max Memory Allocated: 0.02234506607055664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012930870056152344  GigaBytes
Max Memory Allocated: 0.02251720428466797  GigaBytes

torch.Size([1870, 1433])
torch.Size([1129, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014267444610595703  GigaBytes
Max Memory Allocated: 0.02251720428466797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002831578254699707 |0.0003777742385864258 |0.0029202699661254883 |0.0001024007797241211 |0.003216981887817383 |0.00125885009765625 |
----------------------------------------------------------pseudo_mini_loss sum 1.9169414043426514
Total (block generation + training)time/epoch 0.06588149070739746
Training time/epoch 0.022031068801879883
Training time without block to device /epoch 0.02127552032470703
Training time without total dataloading part /epoch 0.013738155364990234
load block tensor time/epoch 0.005663156509399414
block to device time/epoch 0.0007555484771728516
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6515
Number of first layer input nodes during this epoch:  3677
