main start at this time 1648427679.8635101
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014984607696533203
random selection method range initialization spend 0.00019288063049316406
time for parepare:  6.198883056640625e-05
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0023801326751708984
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.556510925292969e-05
----------------------check_connections_block total spend ----------------------------- 0.003595590591430664
generate_one_block  0.0014939308166503906
generate_one_block  0.0010890960693359375
generate_one_block  0.0010495185852050781
generate_one_block  0.0011026859283447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005104541778564453
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.000156402587890625
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003993511199951172
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00043201446533203125
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003216266632080078
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00047898292541503906
----------------------check_connections_block total spend ----------------------------- 0.003214597702026367
generate_one_block  0.0014929771423339844
generate_one_block  0.0015194416046142578
generate_one_block  0.0013780593872070312
generate_one_block  0.0015406608581542969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005509853363037109
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.00016617774963378906
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0012280941009521484
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.0001468658447265625
r_  generation:  0.0013175010681152344
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.0010466575622558594
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.001268148422241211
----------------------check_connections_block total spend ----------------------------- 0.007858514785766602
generate_one_block  0.0024116039276123047
generate_one_block  0.0025157928466796875
generate_one_block  0.0022013187408447266
generate_one_block  0.002527952194213867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.011073112487792969
block generation total time  0.015587806701660156
average batch blocks generation time:  0.003896951675415039
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009370803833007812  GigaBytes
Max Memory Allocated: 0.009370803833007812  GigaBytes

torch.Size([1612, 1433])
torch.Size([773, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010226726531982422  GigaBytes
Max Memory Allocated: 0.010345935821533203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010229110717773438  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

torch.Size([1637, 1433])
torch.Size([841, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011137962341308594  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010085105895996094  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

torch.Size([1468, 1433])
torch.Size([632, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010767936706542969  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01002645492553711  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

torch.Size([1599, 1433])
torch.Size([802, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01090240478515625  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006904423236846924 |0.08619958162307739 |0.195561945438385 |0.0001774430274963379 |0.0033161044120788574 |0.0025360584259033203 |
----------------------------------------------------------pseudo_mini_loss sum 3.268575429916382
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10098
Number of first layer input nodes during this epoch:  6316
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011570930480957031  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006003379821777344
random selection method range initialization spend 0.00015234947204589844
time for parepare:  8.988380432128906e-05
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.083747863769531e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013399124145507812
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.512901306152344e-05
----------------------check_connections_block total spend ----------------------------- 0.0016086101531982422
generate_one_block  0.0015256404876708984
generate_one_block  0.0014078617095947266
generate_one_block  0.001390218734741211
generate_one_block  0.0014023780822753906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005955696105957031
gen group dst list time:  5.3882598876953125e-05
time for parepare:  0.0002269744873046875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0004596710205078125
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005304813385009766
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0005424022674560547
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0006270408630371094
----------------------check_connections_block total spend ----------------------------- 0.004153251647949219
generate_one_block  0.0019524097442626953
generate_one_block  0.0019183158874511719
generate_one_block  0.0019190311431884766
generate_one_block  0.0020532608032226562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007023811340332031
gen group dst list time:  0.0001308917999267578
time for parepare:  0.00024771690368652344
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0014448165893554688
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.0017719268798828125
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.0016407966613769531
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.00018715858459472656
r_  generation:  0.0018684864044189453
----------------------check_connections_block total spend ----------------------------- 0.010840415954589844
generate_one_block  0.002997159957885742
generate_one_block  0.002707242965698242
generate_one_block  0.0023946762084960938
generate_one_block  0.0029611587524414062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011570930480957031  GigaBytes
Max Memory Allocated: 0.018790245056152344  GigaBytes

connection checking time:  0.014993667602539062
block generation total time  0.018903255462646484
average batch blocks generation time:  0.004725813865661621
block dataloader generation time/epoch 0.052340030670166016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011527061462402344  GigaBytes
Max Memory Allocated: 0.020026683807373047  GigaBytes

torch.Size([1496, 1433])
torch.Size([642, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012231826782226562  GigaBytes
Max Memory Allocated: 0.020026683807373047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011806964874267578  GigaBytes
Max Memory Allocated: 0.02036905288696289  GigaBytes

torch.Size([1663, 1433])
torch.Size([813, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012670516967773438  GigaBytes
Max Memory Allocated: 0.02036905288696289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011531829833984375  GigaBytes
Max Memory Allocated: 0.02036905288696289  GigaBytes

torch.Size([1557, 1433])
torch.Size([766, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012364387512207031  GigaBytes
Max Memory Allocated: 0.02036905288696289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01188039779663086  GigaBytes
Max Memory Allocated: 0.020438671112060547  GigaBytes

torch.Size([1676, 1433])
torch.Size([849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01282644271850586  GigaBytes
Max Memory Allocated: 0.020438671112060547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012981295585632324 |0.0005087852478027344 |0.003693521022796631 |0.0001322627067565918 |0.002265334129333496 |0.001691579818725586 |
----------------------------------------------------------pseudo_mini_loss sum 2.041332244873047
Total (block generation + training)time/epoch 0.0906991958618164
Training time/epoch 0.03818082809448242
Training time without block to device /epoch 0.036145687103271484
Training time without total dataloading part /epoch 0.02605605125427246
load block tensor time/epoch 0.00519251823425293
block to device time/epoch 0.0020351409912109375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10196
Number of first layer input nodes during this epoch:  6392
