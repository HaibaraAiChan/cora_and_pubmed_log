main start at this time 1648427698.3215048
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008745193481445312
random selection method range initialization spend 0.00020122528076171875
time for parepare:  6.580352783203125e-05
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0024404525756835938
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.005571842193603516
generate_one_block  0.0015368461608886719
generate_one_block  0.0011031627655029297
generate_one_block  0.0011401176452636719
generate_one_block  0.0010941028594970703
generate_one_block  0.0011005401611328125
generate_one_block  0.0010921955108642578
generate_one_block  0.00110626220703125
generate_one_block  0.0010838508605957031
generate_one_block  0.0010943412780761719
generate_one_block  0.0010814666748046875
generate_one_block  0.001107931137084961
generate_one_block  0.0010981559753417969
generate_one_block  0.001012563705444336
generate_one_block  0.001020193099975586
generate_one_block  0.0010268688201904297
generate_one_block  0.0010018348693847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006117820739746094
gen group dst list time:  9.322166442871094e-05
time for parepare:  0.000152587890625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001125335693359375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00018548965454101562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017023086547851562
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00015616416931152344
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00014972686767578125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.220008850097656e-05
----------------------check_connections_block total spend ----------------------------- 0.005726814270019531
generate_one_block  0.0014100074768066406
generate_one_block  0.0012116432189941406
generate_one_block  0.0011668205261230469
generate_one_block  0.001249074935913086
generate_one_block  0.0012977123260498047
generate_one_block  0.0012509822845458984
generate_one_block  0.0011968612670898438
generate_one_block  0.0010743141174316406
generate_one_block  0.001146554946899414
generate_one_block  0.0009927749633789062
generate_one_block  0.0010824203491210938
generate_one_block  0.0011396408081054688
generate_one_block  0.0010986328125
generate_one_block  0.0011420249938964844
generate_one_block  0.001150369644165039
generate_one_block  0.0009591579437255859
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007004737854003906
gen group dst list time:  0.00015211105346679688
time for parepare:  0.00023031234741210938
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0007393360137939453
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0004134178161621094
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003314018249511719
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.0005736351013183594
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005762577056884766
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0007317066192626953
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005824565887451172
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003540515899658203
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005691051483154297
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0005130767822265625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004315376281738281
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005249977111816406
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006964206695556641
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006129741668701172
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001010894775390625
----------------------check_connections_block total spend ----------------------------- 0.014546871185302734
generate_one_block  0.0018832683563232422
generate_one_block  0.0014705657958984375
generate_one_block  0.0012979507446289062
generate_one_block  0.0015747547149658203
generate_one_block  0.0015544891357421875
generate_one_block  0.001775979995727539
generate_one_block  0.0018491744995117188
generate_one_block  0.0013437271118164062
generate_one_block  0.0015299320220947266
generate_one_block  0.0012097358703613281
generate_one_block  0.0015110969543457031
generate_one_block  0.0013887882232666016
generate_one_block  0.0014793872833251953
generate_one_block  0.0017192363739013672
generate_one_block  0.001583099365234375
generate_one_block  0.0010364055633544922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.020273685455322266
block generation total time  0.04277658462524414
average batch blocks generation time:  0.002673536539077759
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006245136260986328  GigaBytes
Max Memory Allocated: 0.006245136260986328  GigaBytes

torch.Size([1030, 1433])
torch.Size([387, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006669044494628906  GigaBytes
Max Memory Allocated: 0.006789207458496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004907131195068359  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

torch.Size([646, 1433])
torch.Size([203, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005129814147949219  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004781246185302734  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

torch.Size([623, 1433])
torch.Size([134, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004938602447509766  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005883216857910156  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

torch.Size([828, 1433])
torch.Size([299, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0061817169189453125  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005734920501708984  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

torch.Size([800, 1433])
torch.Size([304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006069660186767578  GigaBytes
Max Memory Allocated: 0.010393142700195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0071258544921875  GigaBytes
Max Memory Allocated: 0.01137542724609375  GigaBytes

torch.Size([1060, 1433])
torch.Size([415, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007523059844970703  GigaBytes
Max Memory Allocated: 0.01137542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006369113922119141  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([919, 1433])
torch.Size([313, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0066928863525390625  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004631996154785156  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([595, 1433])
torch.Size([183, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004827976226806641  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006369113922119141  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([746, 1433])
torch.Size([290, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006670475006103516  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003929615020751953  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([464, 1433])
torch.Size([100, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004050731658935547  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006367206573486328  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([784, 1433])
torch.Size([244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006623744964599609  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005295753479003906  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([719, 1433])
torch.Size([209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00551605224609375  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005358219146728516  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([730, 1433])
torch.Size([283, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005648612976074219  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006554603576660156  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([953, 1433])
torch.Size([374, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006920337677001953  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0061626434326171875  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([880, 1433])
torch.Size([283, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006491184234619141  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023403167724609375  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([167, 1433])
torch.Size([37, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0023975372314453125  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003744453191757202 |0.022350400686264038 |0.05073142051696777 |0.00012351572513580322 |0.0020532310009002686 |0.00812220573425293 |
----------------------------------------------------------pseudo_mini_loss sum 3.6750192642211914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16760
Number of first layer input nodes during this epoch:  11944
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037908554077148438  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012154579162597656
random selection method range initialization spend 0.00015878677368164062
time for parepare:  0.00010204315185546875
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.3126602172851562e-05
----------------------check_connections_block total spend ----------------------------- 0.004439592361450195
generate_one_block  0.0013689994812011719
generate_one_block  0.0010323524475097656
generate_one_block  0.0010287761688232422
generate_one_block  0.0010249614715576172
generate_one_block  0.0010216236114501953
generate_one_block  0.0010302066802978516
generate_one_block  0.0012402534484863281
generate_one_block  0.0010225772857666016
generate_one_block  0.0010254383087158203
generate_one_block  0.0009987354278564453
generate_one_block  0.0009646415710449219
generate_one_block  0.0009508132934570312
generate_one_block  0.0009531974792480469
generate_one_block  0.0009648799896240234
generate_one_block  0.0009672641754150391
generate_one_block  0.0010311603546142578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000591278076171875
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.392333984375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00021147727966308594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00014352798461914062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001633167266845703
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015115737915039062
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001049041748046875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0001277923583984375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00018453598022460938
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002315044403076172
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  4.7206878662109375e-05
----------------------check_connections_block total spend ----------------------------- 0.005717039108276367
generate_one_block  0.0010957717895507812
generate_one_block  0.0012633800506591797
generate_one_block  0.001218557357788086
generate_one_block  0.0010480880737304688
generate_one_block  0.0011279582977294922
generate_one_block  0.0012540817260742188
generate_one_block  0.0011620521545410156
generate_one_block  0.0011527538299560547
generate_one_block  0.0011708736419677734
generate_one_block  0.00112152099609375
generate_one_block  0.0010492801666259766
generate_one_block  0.001085042953491211
generate_one_block  0.001068115234375
generate_one_block  0.001146078109741211
generate_one_block  0.0011894702911376953
generate_one_block  0.0010211467742919922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007061958312988281
gen group dst list time:  0.00019049644470214844
time for parepare:  0.00022363662719726562
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00029349327087402344
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0007846355438232422
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004627704620361328
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0004248619079589844
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0007796287536621094
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005164146423339844
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005941390991210938
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0006489753723144531
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.00054168701171875
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003254413604736328
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0005128383636474609
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004611015319824219
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0006656646728515625
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0007658004760742188
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00011944770812988281
----------------------check_connections_block total spend ----------------------------- 0.014745473861694336
generate_one_block  0.0013844966888427734
generate_one_block  0.0019502639770507812
generate_one_block  0.0015261173248291016
generate_one_block  0.001140594482421875
generate_one_block  0.0014057159423828125
generate_one_block  0.0019145011901855469
generate_one_block  0.0014462471008300781
generate_one_block  0.0015869140625
generate_one_block  0.0016214847564697266
generate_one_block  0.0015208721160888672
generate_one_block  0.001271963119506836
generate_one_block  0.001600503921508789
generate_one_block  0.0014162063598632812
generate_one_block  0.0016565322875976562
generate_one_block  0.0017914772033691406
generate_one_block  0.001020669937133789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0037908554077148438  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

connection checking time:  0.020462512969970703
block generation total time  0.04242873191833496
average batch blocks generation time:  0.002651795744895935
block dataloader generation time/epoch 0.10461950302124023
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006032466888427734  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([588, 1433])
torch.Size([109, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006173133850097656  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008556842803955078  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

torch.Size([1058, 1433])
torch.Size([432, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00897836685180664  GigaBytes
Max Memory Allocated: 0.012010574340820312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0064067840576171875  GigaBytes
Max Memory Allocated: 0.012041091918945312  GigaBytes

torch.Size([657, 1433])
torch.Size([211, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006630420684814453  GigaBytes
Max Memory Allocated: 0.012041091918945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00463104248046875  GigaBytes
Max Memory Allocated: 0.012041091918945312  GigaBytes

torch.Size([326, 1433])
torch.Size([77, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004734992980957031  GigaBytes
Max Memory Allocated: 0.012041091918945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006619453430175781  GigaBytes
Max Memory Allocated: 0.012041091918945312  GigaBytes

torch.Size([697, 1433])
torch.Size([203, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006842136383056641  GigaBytes
Max Memory Allocated: 0.012041091918945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00854635238647461  GigaBytes
Max Memory Allocated: 0.012244224548339844  GigaBytes

torch.Size([1056, 1433])
torch.Size([425, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008967876434326172  GigaBytes
Max Memory Allocated: 0.012244224548339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006732463836669922  GigaBytes
Max Memory Allocated: 0.012356281280517578  GigaBytes

torch.Size([718, 1433])
torch.Size([271, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007005214691162109  GigaBytes
Max Memory Allocated: 0.012356281280517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008541584014892578  GigaBytes
Max Memory Allocated: 0.012356281280517578  GigaBytes

torch.Size([935, 1433])
torch.Size([304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008858203887939453  GigaBytes
Max Memory Allocated: 0.012356281280517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008019447326660156  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([958, 1433])
torch.Size([314, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008349418640136719  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0068836212158203125  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([746, 1433])
torch.Size([316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007196903228759766  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005394935607910156  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes
Using backend: pytorch

torch.Size([468, 1433])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0055828094482421875  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007283210754394531  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([821, 1433])
torch.Size([269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007557868957519531  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006801605224609375  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([731, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007041454315185547  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008228302001953125  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([997, 1433])
torch.Size([337, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008597850799560547  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008328437805175781  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([1015, 1433])
torch.Size([404, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008749961853027344  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0035457611083984375  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

torch.Size([123, 1433])
torch.Size([34, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0036020278930664062  GigaBytes
Max Memory Allocated: 0.013637542724609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001854434609413147 |0.0004234015941619873 |0.0032227933406829834 |0.0001055598258972168 |0.0021135807037353516 |0.0013430118560791016 |
----------------------------------------------------------pseudo_mini_loss sum 2.002431631088257
Total (block generation + training)time/epoch 0.2456672191619873
Training time/epoch 0.14069080352783203
Training time without block to device /epoch 0.13391637802124023
Training time without total dataloading part /epoch 0.08841395378112793
load block tensor time/epoch 0.02967095375061035
block to device time/epoch 0.006774425506591797
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16741
Number of first layer input nodes during this epoch:  11894
