main start at this time 1648427670.5728958
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016682147979736328
random selection method range initialization spend 0.00022721290588378906
time for parepare:  6.437301635742188e-05
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0034003257751464844
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00011610984802246094
----------------------check_connections_block total spend ----------------------------- 0.004263401031494141
generate_one_block  0.001706838607788086
generate_one_block  0.0012273788452148438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00052642822265625
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00014710426330566406
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0007345676422119141
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006587505340576172
----------------------check_connections_block total spend ----------------------------- 0.002530336380004883
generate_one_block  0.0019652843475341797
generate_one_block  0.0018320083618164062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005648136138916016
gen group dst list time:  5.6743621826171875e-05
time for parepare:  0.00017213821411132812
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00033402442932128906
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0018694400787353516
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.0001735687255859375
r_  generation:  0.00173187255859375
----------------------check_connections_block total spend ----------------------------- 0.00570368766784668
generate_one_block  0.003255605697631836
generate_one_block  0.0029904842376708984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.008234024047851562
block generation total time  0.01004338264465332
average batch blocks generation time:  0.00502169132232666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011210441589355469  GigaBytes
Max Memory Allocated: 0.011210441589355469  GigaBytes

torch.Size([1952, 1433])
torch.Size([1198, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.012600898742675781  GigaBytes
Max Memory Allocated: 0.012681961059570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011633872985839844  GigaBytes
Max Memory Allocated: 0.02199554443359375  GigaBytes

torch.Size([1897, 1433])
torch.Size([1082, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012879371643066406  GigaBytes
Max Memory Allocated: 0.02199554443359375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014426469802856445 |0.16977250576019287 |0.3828408718109131 |0.00022482872009277344 |0.004944324493408203 |0.002460002899169922 |
----------------------------------------------------------pseudo_mini_loss sum 3.4560627937316895
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6827
Number of first layer input nodes during this epoch:  3849
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01321268081665039  GigaBytes
Max Memory Allocated: 0.02199554443359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006020069122314453
random selection method range initialization spend 0.000152587890625
time for parepare:  9.274482727050781e-05
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00015854835510253906
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00017333030700683594
----------------------check_connections_block total spend ----------------------------- 0.0010957717895507812
generate_one_block  0.0016293525695800781
generate_one_block  0.0015783309936523438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005919933319091797
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.000213623046875
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0008196830749511719
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0009732246398925781
----------------------check_connections_block total spend ----------------------------- 0.0033299922943115234
generate_one_block  0.0023241043090820312
generate_one_block  0.002593517303466797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007038116455078125
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.00026226043701171875
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0003573894500732422
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.002246379852294922
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.000308990478515625
r_  generation:  0.0024390220642089844
----------------------check_connections_block total spend ----------------------------- 0.007508277893066406
generate_one_block  0.003771543502807617
generate_one_block  0.0037994384765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01321268081665039  GigaBytes
Max Memory Allocated: 0.02199554443359375  GigaBytes

connection checking time:  0.01083827018737793
block generation total time  0.012488603591918945
average batch blocks generation time:  0.006244301795959473
block dataloader generation time/epoch 0.03801155090332031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013135910034179688  GigaBytes
Max Memory Allocated: 0.023204803466796875  GigaBytes
Using backend: pytorch

torch.Size([1909, 1433])
torch.Size([1115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014392375946044922  GigaBytes
Max Memory Allocated: 0.023204803466796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013255596160888672  GigaBytes
Max Memory Allocated: 0.023381710052490234  GigaBytes

torch.Size([1930, 1433])
torch.Size([1194, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014647483825683594  GigaBytes
Max Memory Allocated: 0.023381710052490234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0016796588897705078 |0.0005201101303100586 |0.0037755966186523438 |0.00014281272888183594 |0.002417922019958496 |0.0016779899597167969 |
----------------------------------------------------------pseudo_mini_loss sum 1.9254300594329834
Total (block generation + training)time/epoch 0.059366464614868164
Training time/epoch 0.021179676055908203
Training time without block to device /epoch 0.020139455795288086
Training time without total dataloading part /epoch 0.014350652694702148
load block tensor time/epoch 0.0033593177795410156
block to device time/epoch 0.0010402202606201172
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6836
Number of first layer input nodes during this epoch:  3839
