main start at this time 1648427605.446448
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013878345489501953
random selection method range initialization spend 0.00019931793212890625
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0011785030364990234
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.747245788574219e-05
----------------------check_connections_block total spend ----------------------------- 0.002340078353881836
generate_one_block  0.0013048648834228516
generate_one_block  0.0010943412780761719
generate_one_block  0.0010662078857421875
generate_one_block  0.0010843276977539062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047659873962402344
gen group dst list time:  3.790855407714844e-05
time for parepare:  0.00013399124145507812
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003879070281982422
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004124641418457031
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003058910369873047
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0004076957702636719
----------------------check_connections_block total spend ----------------------------- 0.0030517578125
generate_one_block  0.0014834403991699219
generate_one_block  0.0015072822570800781
generate_one_block  0.0013599395751953125
generate_one_block  0.001493215560913086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005369186401367188
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.00016951560974121094
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0011229515075683594
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0011582374572753906
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.0009255409240722656
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0011413097381591797
----------------------check_connections_block total spend ----------------------------- 0.0071375370025634766
generate_one_block  0.002767324447631836
generate_one_block  0.0023391246795654297
generate_one_block  0.0020530223846435547
generate_one_block  0.002396821975708008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.010189294815063477
block generation total time  0.015400171279907227
average batch blocks generation time:  0.0038500428199768066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009011268615722656  GigaBytes
Max Memory Allocated: 0.009011268615722656  GigaBytes

torch.Size([1545, 1433])
torch.Size([717, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009820938110351562  GigaBytes
Max Memory Allocated: 0.009927749633789062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009680747985839844  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

torch.Size([1535, 1433])
torch.Size([752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01051473617553711  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009724617004394531  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

torch.Size([1391, 1433])
torch.Size([581, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010365962982177734  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009680747985839844  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

torch.Size([1535, 1433])
torch.Size([732, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010497570037841797  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008652746677398682 |0.08573055267333984 |0.19406771659851074 |0.00018358230590820312 |0.003368973731994629 |0.002980947494506836 |
----------------------------------------------------------pseudo_mini_loss sum 3.235401153564453
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9522
Number of first layer input nodes during this epoch:  6006
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011216163635253906  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004863739013671875
random selection method range initialization spend 0.00011610984802246094
time for parepare:  6.461143493652344e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.128715515136719e-05
local_output_nid generation:  1.0728836059570312e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.486343383789062e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.082389831542969e-05
----------------------check_connections_block total spend ----------------------------- 0.0013527870178222656
generate_one_block  0.0011582374572753906
generate_one_block  0.0011050701141357422
generate_one_block  0.0010497570037841797
generate_one_block  0.0010302066802978516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004646778106689453
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.0001461505889892578
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003151893615722656
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0003695487976074219
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.00044083595275878906
----------------------check_connections_block total spend ----------------------------- 0.0030050277709960938
generate_one_block  0.001413106918334961
generate_one_block  0.001401662826538086
generate_one_block  0.0013897418975830078
generate_one_block  0.0015170574188232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005731582641601562
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.00017118453979492188
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0008857250213623047
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.0011441707611083984
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0010638236999511719
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0012586116790771484
----------------------check_connections_block total spend ----------------------------- 0.007229804992675781
generate_one_block  0.0020592212677001953
generate_one_block  0.0025882720947265625
generate_one_block  0.002212047576904297
generate_one_block  0.0027158260345458984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011216163635253906  GigaBytes
Max Memory Allocated: 0.01788806915283203  GigaBytes

connection checking time:  0.010234832763671875
block generation total time  0.01529693603515625
average batch blocks generation time:  0.0038242340087890625
block dataloader generation time/epoch 0.040669918060302734
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009953022003173828  GigaBytes
Max Memory Allocated: 0.018115520477294922  GigaBytes

torch.Size([1318, 1433])
torch.Size([568, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010594367980957031  GigaBytes
Max Memory Allocated: 0.018115520477294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011283397674560547  GigaBytes
Max Memory Allocated: 0.018281936645507812  GigaBytes

torch.Size([1566, 1433])
torch.Size([730, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012075424194335938  GigaBytes
Max Memory Allocated: 0.018281936645507812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0106964111328125  GigaBytes
Max Memory Allocated: 0.01901865005493164  GigaBytes

torch.Size([1456, 1433])
torch.Size([695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011471748352050781  GigaBytes
Max Memory Allocated: 0.01901865005493164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011476993560791016  GigaBytes
Max Memory Allocated: 0.019205570220947266  GigaBytes

torch.Size([1601, 1433])
torch.Size([795, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012378215789794922  GigaBytes
Max Memory Allocated: 0.019205570220947266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027660131454467773 |0.0005851387977600098 |0.004306316375732422 |0.00013524293899536133 |0.0031130313873291016 |0.0015604496002197266 |
----------------------------------------------------------pseudo_mini_loss sum 2.0364065170288086
Total (block generation + training)time/epoch 0.09150052070617676
Training time/epoch 0.05054926872253418
Training time without block to device /epoch 0.04820871353149414
Training time without total dataloading part /epoch 0.031778812408447266
load block tensor time/epoch 0.01106405258178711
block to device time/epoch 0.002340555191040039
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9463
Number of first layer input nodes during this epoch:  5941
