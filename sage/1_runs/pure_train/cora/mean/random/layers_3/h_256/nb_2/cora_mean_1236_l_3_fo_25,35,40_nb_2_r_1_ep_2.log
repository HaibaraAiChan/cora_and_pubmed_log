main start at this time 1648427857.5900824
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015587806701660156
random selection method range initialization spend 0.0002541542053222656
time for parepare:  7.605552673339844e-05
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00394129753112793
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00014662742614746094
----------------------check_connections_block total spend ----------------------------- 0.0049839019775390625
generate_one_block  0.0019359588623046875
generate_one_block  0.001489877700805664
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005948543548583984
gen group dst list time:  3.838539123535156e-05
time for parepare:  0.0001766681671142578
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0008082389831542969
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0008206367492675781
----------------------check_connections_block total spend ----------------------------- 0.003033161163330078
generate_one_block  0.002280712127685547
generate_one_block  0.002225160598754883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006849765777587891
gen group dst list time:  6.985664367675781e-05
time for parepare:  0.00022864341735839844
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.00038433074951171875
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.0020897388458251953
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.0020284652709960938
----------------------check_connections_block total spend ----------------------------- 0.00666046142578125
generate_one_block  0.0037872791290283203
generate_one_block  0.0035474300384521484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.009693622589111328
block generation total time  0.011840581893920898
average batch blocks generation time:  0.005920290946960449
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013617515563964844  GigaBytes
Max Memory Allocated: 0.013617515563964844  GigaBytes

torch.Size([1932, 1433])
torch.Size([1115, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.018923282623291016  GigaBytes
Max Memory Allocated: 0.019240856170654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016211986541748047  GigaBytes
Max Memory Allocated: 0.026468753814697266  GigaBytes

torch.Size([1811, 1433])
torch.Size([1073, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021053314208984375  GigaBytes
Max Memory Allocated: 0.026468753814697266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0203554630279541 |0.17375993728637695 |0.3834691047668457 |0.00022971630096435547 |0.004854917526245117 |0.0022203922271728516 |
----------------------------------------------------------pseudo_mini_loss sum 4.104527950286865
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6627
Number of first layer input nodes during this epoch:  3743
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02282428741455078  GigaBytes
Max Memory Allocated: 0.028588294982910156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005931854248046875
random selection method range initialization spend 0.0001475811004638672
time for parepare:  9.107589721679688e-05
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00016307830810546875
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00015664100646972656
----------------------check_connections_block total spend ----------------------------- 0.0011031627655029297
generate_one_block  0.0015025138854980469
generate_one_block  0.0014553070068359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005958080291748047
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.000202178955078125
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.000850677490234375
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0008609294891357422
----------------------check_connections_block total spend ----------------------------- 0.0031974315643310547
generate_one_block  0.0022869110107421875
generate_one_block  0.002404451370239258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006740093231201172
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0002410411834716797
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0021581649780273438
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00024819374084472656
r_  generation:  0.0021910667419433594
----------------------check_connections_block total spend ----------------------------- 0.006971597671508789
generate_one_block  0.0037736892700195312
generate_one_block  0.003648042678833008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02282428741455078  GigaBytes
Max Memory Allocated: 0.028588294982910156  GigaBytes

connection checking time:  0.010169029235839844
block generation total time  0.012113094329833984
average batch blocks generation time:  0.006056547164916992
block dataloader generation time/epoch 0.04903817176818848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023052215576171875  GigaBytes
Max Memory Allocated: 0.03266191482543945  GigaBytes
Using backend: pytorch

torch.Size([1879, 1433])
torch.Size([1101, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02897787094116211  GigaBytes
Max Memory Allocated: 0.03266191482543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.02297353744506836  GigaBytes
Max Memory Allocated: 0.032946109771728516  GigaBytes

torch.Size([1864, 1433])
torch.Size([1096, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.028890609741210938  GigaBytes
Max Memory Allocated: 0.032946109771728516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0019347667694091797 |0.0005055665969848633 |0.0038698911666870117 |0.00013518333435058594 |0.0018836259841918945 |0.0016331672668457031 |
----------------------------------------------------------pseudo_mini_loss sum 1.0334504842758179
Total (block generation + training)time/epoch 0.06989240646362305
Training time/epoch 0.020689010620117188
Training time without block to device /epoch 0.01967787742614746
Training time without total dataloading part /epoch 0.013410568237304688
load block tensor time/epoch 0.0038695335388183594
block to device time/epoch 0.0010111331939697266
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6645
Number of first layer input nodes during this epoch:  3743
