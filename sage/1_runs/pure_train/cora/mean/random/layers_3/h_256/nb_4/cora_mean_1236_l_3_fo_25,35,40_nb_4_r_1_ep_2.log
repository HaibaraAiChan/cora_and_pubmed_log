main start at this time 1648427866.906014
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008265972137451172
random selection method range initialization spend 0.00017833709716796875
time for parepare:  6.4849853515625e-05
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0013115406036376953
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.152557373046875e-05
----------------------check_connections_block total spend ----------------------------- 0.0025713443756103516
generate_one_block  0.0013649463653564453
generate_one_block  0.001226186752319336
generate_one_block  0.0011949539184570312
generate_one_block  0.001184225082397461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005269050598144531
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.00015425682067871094
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004544258117675781
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00046563148498535156
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003886222839355469
----------------------check_connections_block total spend ----------------------------- 0.0033524036407470703
generate_one_block  0.0015938282012939453
generate_one_block  0.0016231536865234375
generate_one_block  0.0016674995422363281
generate_one_block  0.0016031265258789062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006022453308105469
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.00018453598022460938
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0012195110321044922
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0012249946594238281
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0013489723205566406
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.001177072525024414
----------------------check_connections_block total spend ----------------------------- 0.008080720901489258
generate_one_block  0.002590656280517578
generate_one_block  0.0025272369384765625
generate_one_block  0.0026001930236816406
generate_one_block  0.0023326873779296875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.011433124542236328
block generation total time  0.016538381576538086
average batch blocks generation time:  0.0041345953941345215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011540889739990234  GigaBytes
Max Memory Allocated: 0.011540889739990234  GigaBytes

torch.Size([1547, 1433])
torch.Size([705, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.014415264129638672  GigaBytes
Max Memory Allocated: 0.01506662368774414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014076709747314453  GigaBytes
Max Memory Allocated: 0.02229785919189453  GigaBytes

torch.Size([1415, 1433])
torch.Size([698, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017077922821044922  GigaBytes
Max Memory Allocated: 0.02229785919189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014850139617919922  GigaBytes
Max Memory Allocated: 0.02236175537109375  GigaBytes

torch.Size([1559, 1433])
torch.Size([784, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018136024475097656  GigaBytes
Max Memory Allocated: 0.02236175537109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014780521392822266  GigaBytes
Max Memory Allocated: 0.02306652069091797  GigaBytes

torch.Size([1431, 1433])
torch.Size([651, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017562389373779297  GigaBytes
Max Memory Allocated: 0.02306652069091797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004080235958099365 |0.0859498381614685 |0.19239360094070435 |0.00016373395919799805 |0.004100680351257324 |0.0040361881256103516 |
----------------------------------------------------------pseudo_mini_loss sum 4.118210315704346
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9514
Number of first layer input nodes during this epoch:  5952
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021685123443603516  GigaBytes
Max Memory Allocated: 0.027152061462402344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008141994476318359
random selection method range initialization spend 0.00018095970153808594
time for parepare:  0.00012254714965820312
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  2.1219253540039062e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001220703125
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00012493133544921875
----------------------check_connections_block total spend ----------------------------- 0.002267599105834961
generate_one_block  0.0019648075103759766
generate_one_block  0.0015993118286132812
generate_one_block  0.001314401626586914
generate_one_block  0.0013201236724853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006020069122314453
gen group dst list time:  4.792213439941406e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005145072937011719
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005331039428710938
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0004572868347167969
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0005562305450439453
----------------------check_connections_block total spend ----------------------------- 0.0039637088775634766
generate_one_block  0.0018322467803955078
generate_one_block  0.0015151500701904297
generate_one_block  0.0014455318450927734
generate_one_block  0.0015912055969238281
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.00018668174743652344
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.001219034194946289
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.0001385211944580078
r_  generation:  0.0012438297271728516
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.0010998249053955078
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0013456344604492188
----------------------check_connections_block total spend ----------------------------- 0.007939577102661133
generate_one_block  0.0025010108947753906
generate_one_block  0.0024900436401367188
generate_one_block  0.002282857894897461
generate_one_block  0.0026428699493408203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021685123443603516  GigaBytes
Max Memory Allocated: 0.027152061462402344  GigaBytes

connection checking time:  0.01190328598022461
block generation total time  0.01630091667175293
average batch blocks generation time:  0.004075229167938232
block dataloader generation time/epoch 0.05051732063293457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021303653717041016  GigaBytes
Max Memory Allocated: 0.029524803161621094  GigaBytes

torch.Size([1492, 1433])
torch.Size([702, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024272918701171875  GigaBytes
Max Memory Allocated: 0.029524803161621094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021599292755126953  GigaBytes
Max Memory Allocated: 0.0295257568359375  GigaBytes

torch.Size([1473, 1433])
torch.Size([730, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02465200424194336  GigaBytes
Max Memory Allocated: 0.0295257568359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020660877227783203  GigaBytes
Max Memory Allocated: 0.0295257568359375  GigaBytes

torch.Size([1372, 1433])
torch.Size([631, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02333354949951172  GigaBytes
Max Memory Allocated: 0.0295257568359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021602153778076172  GigaBytes
Max Memory Allocated: 0.0295257568359375  GigaBytes

torch.Size([1540, 1433])
torch.Size([761, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024843215942382812  GigaBytes
Max Memory Allocated: 0.0295257568359375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023998022079467773 |0.00041794776916503906 |0.003229081630706787 |0.00011390447616577148 |0.00325697660446167 |0.001374959945678711 |
----------------------------------------------------------pseudo_mini_loss sum 0.8440138101577759
Total (block generation + training)time/epoch 0.09386491775512695
Training time/epoch 0.04301285743713379
Training time without block to device /epoch 0.04134106636047363
Training time without total dataloading part /epoch 0.027774810791015625
load block tensor time/epoch 0.00959920883178711
block to device time/epoch 0.0016717910766601562
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9435
Number of first layer input nodes during this epoch:  5877
