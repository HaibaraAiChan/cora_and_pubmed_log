main start at this time 1648427922.163321
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001245260238647461
random selection method range initialization spend 0.00023674964904785156
time for parepare:  6.556510925292969e-05
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0022912025451660156
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.005363941192626953
generate_one_block  0.001402139663696289
generate_one_block  0.0011000633239746094
generate_one_block  0.001096487045288086
generate_one_block  0.0010256767272949219
generate_one_block  0.0010609626770019531
generate_one_block  0.0010728836059570312
generate_one_block  0.0010287761688232422
generate_one_block  0.0010156631469726562
generate_one_block  0.0011098384857177734
generate_one_block  0.0010230541229248047
generate_one_block  0.001070261001586914
generate_one_block  0.0010237693786621094
generate_one_block  0.0010383129119873047
generate_one_block  0.0010187625885009766
generate_one_block  0.0010228157043457031
generate_one_block  0.001007080078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006263256072998047
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.0001385211944580078
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011706352233886719
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.441375732421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001590251922607422
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.34600830078125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014019012451171875
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.008148193359375e-05
----------------------check_connections_block total spend ----------------------------- 0.005254507064819336
generate_one_block  0.0012617111206054688
generate_one_block  0.0011398792266845703
generate_one_block  0.0011794567108154297
generate_one_block  0.00110626220703125
generate_one_block  0.0011608600616455078
generate_one_block  0.0011675357818603516
generate_one_block  0.0012047290802001953
generate_one_block  0.0011456012725830078
generate_one_block  0.0012755393981933594
generate_one_block  0.001100301742553711
generate_one_block  0.0012156963348388672
generate_one_block  0.0010972023010253906
generate_one_block  0.0011832714080810547
generate_one_block  0.0011289119720458984
generate_one_block  0.0011725425720214844
generate_one_block  0.0010685920715332031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007014274597167969
gen group dst list time:  0.00013947486877441406
time for parepare:  0.000202178955078125
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00029754638671875
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0005207061767578125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002052783966064453
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.000331878662109375
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004811286926269531
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004181861877441406
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00023889541625976562
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0006406307220458984
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00030875205993652344
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005629062652587891
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00031685829162597656
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004494190216064453
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003910064697265625
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0005762577056884766
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0002448558807373047
----------------------check_connections_block total spend ----------------------------- 0.012150764465332031
generate_one_block  0.00156402587890625
generate_one_block  0.0013492107391357422
generate_one_block  0.0017254352569580078
generate_one_block  0.0012252330780029297
generate_one_block  0.0013515949249267578
generate_one_block  0.0015263557434082031
generate_one_block  0.001733541488647461
generate_one_block  0.00128936767578125
generate_one_block  0.001783132553100586
generate_one_block  0.0013875961303710938
generate_one_block  0.0016450881958007812
generate_one_block  0.0013909339904785156
generate_one_block  0.001520395278930664
generate_one_block  0.001493215560913086
generate_one_block  0.0016758441925048828
generate_one_block  0.0012848377227783203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.017405271530151367
block generation total time  0.04255390167236328
average batch blocks generation time:  0.002659618854522705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007182121276855469  GigaBytes
Max Memory Allocated: 0.007182121276855469  GigaBytes

torch.Size([735, 1433])
torch.Size([273, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00823068618774414  GigaBytes
Max Memory Allocated: 0.008677482604980469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0094146728515625  GigaBytes
Max Memory Allocated: 0.01332855224609375  GigaBytes

torch.Size([547, 1433])
torch.Size([155, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010067939758300781  GigaBytes
Max Memory Allocated: 0.01332855224609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010943889617919922  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

torch.Size([832, 1433])
torch.Size([289, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012082099914550781  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009270668029785156  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

torch.Size([344, 1433])
torch.Size([98, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009212017059326172  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

torch.Size([509, 1433])
torch.Size([169, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009937286376953125  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010449886322021484  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

torch.Size([740, 1433])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011487007141113281  GigaBytes
Max Memory Allocated: 0.013846397399902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01042318344116211  GigaBytes
Max Memory Allocated: 0.014358997344970703  GigaBytes

torch.Size([630, 1433])
torch.Size([220, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011400222778320312  GigaBytes
Max Memory Allocated: 0.014358997344970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008617401123046875  GigaBytes
Max Memory Allocated: 0.014358997344970703  GigaBytes

torch.Size([398, 1433])
torch.Size([145, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009221553802490234  GigaBytes
Max Memory Allocated: 0.014358997344970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01183938980102539  GigaBytes
Max Memory Allocated: 0.014358997344970703  GigaBytes

torch.Size([999, 1433])
torch.Size([386, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.013363838195800781  GigaBytes
Max Memory Allocated: 0.014358997344970703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009243965148925781  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

torch.Size([515, 1433])
torch.Size([171, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00993490219116211  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010725975036621094  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

torch.Size([791, 1433])
torch.Size([307, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011993885040283203  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00943613052368164  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

torch.Size([551, 1433])
torch.Size([162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01007843017578125  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010332584381103516  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

torch.Size([718, 1433])
torch.Size([249, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011456489562988281  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010421276092529297  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

torch.Size([683, 1433])
torch.Size([227, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011264324188232422  GigaBytes
Max Memory Allocated: 0.01497030258178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011606693267822266  GigaBytes
Max Memory Allocated: 0.01551198959350586  GigaBytes

torch.Size([956, 1433])
torch.Size([303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012781143188476562  GigaBytes
Max Memory Allocated: 0.01551198959350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00877237319946289  GigaBytes
Max Memory Allocated: 0.01551198959350586  GigaBytes

torch.Size([427, 1433])
torch.Size([117, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009232044219970703  GigaBytes
Max Memory Allocated: 0.01551198959350586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022829920053482056 |0.02205274999141693 |0.051735684275627136 |0.00013916194438934326 |0.002120077610015869 |0.0022459030151367188 |
----------------------------------------------------------pseudo_mini_loss sum 4.029193878173828
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14667
Number of first layer input nodes during this epoch:  10375
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015548229217529297  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004649162292480469
random selection method range initialization spend 0.0001125335693359375
time for parepare:  6.556510925292969e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.7404556274414062e-05
----------------------check_connections_block total spend ----------------------------- 0.0030412673950195312
generate_one_block  0.001077890396118164
generate_one_block  0.0010211467742919922
generate_one_block  0.0010132789611816406
generate_one_block  0.0010440349578857422
generate_one_block  0.0010218620300292969
generate_one_block  0.0010106563568115234
generate_one_block  0.001186370849609375
generate_one_block  0.0010328292846679688
generate_one_block  0.0010156631469726562
generate_one_block  0.0010159015655517578
generate_one_block  0.0009810924530029297
generate_one_block  0.0009777545928955078
generate_one_block  0.0009877681732177734
generate_one_block  0.0009770393371582031
generate_one_block  0.001010894775390625
generate_one_block  0.0009701251983642578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005843639373779297
gen group dst list time:  9.775161743164062e-05
time for parepare:  0.00017261505126953125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012826919555664062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.319450378417969e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00011944770812988281
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00021147727966308594
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  9.655952453613281e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.822845458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.005445957183837891
generate_one_block  0.0011568069458007812
generate_one_block  0.0011262893676757812
generate_one_block  0.00118255615234375
generate_one_block  0.0012118816375732422
generate_one_block  0.0011608600616455078
generate_one_block  0.0011811256408691406
generate_one_block  0.001127481460571289
generate_one_block  0.0012116432189941406
generate_one_block  0.0011284351348876953
generate_one_block  0.0011744499206542969
generate_one_block  0.0010213851928710938
generate_one_block  0.001085519790649414
generate_one_block  0.0012538433074951172
generate_one_block  0.0011055469512939453
generate_one_block  0.0010554790496826172
generate_one_block  0.0011250972747802734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006597042083740234
gen group dst list time:  0.00018215179443359375
time for parepare:  0.0002148151397705078
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0004687309265136719
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0003871917724609375
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00034236907958984375
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0006051063537597656
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005009174346923828
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003528594970703125
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0003600120544433594
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005576610565185547
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00043010711669921875
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00016617774963378906
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00036835670471191406
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0007047653198242188
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00043702125549316406
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00037384033203125
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00040721893310546875
----------------------check_connections_block total spend ----------------------------- 0.012840509414672852
generate_one_block  0.0016989707946777344
generate_one_block  0.0014629364013671875
generate_one_block  0.0014102458953857422
generate_one_block  0.0017244815826416016
generate_one_block  0.0015671253204345703
generate_one_block  0.0014107227325439453
generate_one_block  0.0014121532440185547
generate_one_block  0.0016183853149414062
generate_one_block  0.0014905929565429688
generate_one_block  0.0015132427215576172
generate_one_block  0.0011661052703857422
generate_one_block  0.0015110969543457031
generate_one_block  0.0018000602722167969
generate_one_block  0.0015041828155517578
generate_one_block  0.0014500617980957031
generate_one_block  0.0014843940734863281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015548229217529297  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

connection checking time:  0.018286466598510742
block generation total time  0.042533159255981445
average batch blocks generation time:  0.0026583224534988403
block dataloader generation time/epoch 0.0946354866027832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01731586456298828  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

torch.Size([761, 1433])
torch.Size([250, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.018264293670654297  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.016828060150146484  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

torch.Size([670, 1433])
torch.Size([205, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01766681671142578  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01645803451538086  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

torch.Size([601, 1433])
torch.Size([191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01720285415649414  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01836252212524414  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

torch.Size([956, 1433])
torch.Size([313, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019690513610839844  GigaBytes
Max Memory Allocated: 0.02158975601196289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01735973358154297  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([769, 1433])
torch.Size([270, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018431663513183594  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016326427459716797  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([576, 1433])
torch.Size([210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01715993881225586  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0165557861328125  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([619, 1433])
torch.Size([208, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01735067367553711  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01738452911376953  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([773, 1433])
torch.Size([290, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01861572265625  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017033100128173828  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([708, 1433])
torch.Size([217, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017894744873046875  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017358779907226562  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([769, 1433])
torch.Size([241, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018335342407226562  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014505863189697266  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes
Using backend: pytorch

torch.Size([236, 1433])
torch.Size([81, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01492929458618164  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016192913055419922  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([551, 1433])
torch.Size([182, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016976356506347656  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018349647521972656  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([953, 1433])
torch.Size([383, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019889354705810547  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017091751098632812  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([719, 1433])
torch.Size([219, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018012046813964844  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017024993896484375  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([707, 1433])
torch.Size([191, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01778697967529297  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016626358032226562  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

torch.Size([632, 1433])
torch.Size([201, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017376422882080078  GigaBytes
Max Memory Allocated: 0.02244853973388672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0007809847593307495 |0.0004167407751083374 |0.0032740533351898193 |0.00010523200035095215 |0.0018126964569091797 |0.0016624927520751953 |
----------------------------------------------------------pseudo_mini_loss sum 1.1826035976409912
Total (block generation + training)time/epoch 0.21448755264282227
Training time/epoch 0.11950373649597168
Training time without block to device /epoch 0.11283588409423828
Training time without total dataloading part /epoch 0.08473420143127441
load block tensor time/epoch 0.012495756149291992
block to device time/epoch 0.0066678524017333984
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15423
Number of first layer input nodes during this epoch:  11000
