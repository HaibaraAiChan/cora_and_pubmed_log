main start at this time 1648427940.9627023
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00109100341796875
random selection method range initialization spend 0.00018215179443359375
time for parepare:  7.700920104980469e-05
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0019364356994628906
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.273124694824219e-05
----------------------check_connections_block total spend ----------------------------- 0.003414154052734375
generate_one_block  0.0016303062438964844
generate_one_block  0.0014078617095947266
generate_one_block  0.0014002323150634766
generate_one_block  0.001383066177368164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  4.935264587402344e-05
time for parepare:  0.00018596649169921875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004994869232177734
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005471706390380859
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005919933319091797
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0005087852478027344
----------------------check_connections_block total spend ----------------------------- 0.004157066345214844
generate_one_block  0.0019183158874511719
generate_one_block  0.001917123794555664
generate_one_block  0.0020034313201904297
generate_one_block  0.0018756389617919922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007076263427734375
gen group dst list time:  0.0001049041748046875
time for parepare:  0.0002238750457763672
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0015683174133300781
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0015041828155517578
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.001764535903930664
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.001516103744506836
----------------------check_connections_block total spend ----------------------------- 0.010246515274047852
generate_one_block  0.0031948089599609375
generate_one_block  0.002546072006225586
generate_one_block  0.002518177032470703
generate_one_block  0.002428770065307617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.014403581619262695
block generation total time  0.0184023380279541
average batch blocks generation time:  0.004600584506988525
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011954784393310547  GigaBytes
Max Memory Allocated: 0.011954784393310547  GigaBytes

torch.Size([1624, 1433])
torch.Size([797, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015118122100830078  GigaBytes
Max Memory Allocated: 0.015820026397705078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014174461364746094  GigaBytes
Max Memory Allocated: 0.022804737091064453  GigaBytes

torch.Size([1433, 1433])
torch.Size([719, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017242908477783203  GigaBytes
Max Memory Allocated: 0.022804737091064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01533365249633789  GigaBytes
Max Memory Allocated: 0.022938251495361328  GigaBytes

torch.Size([1649, 1433])
torch.Size([869, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018886089324951172  GigaBytes
Max Memory Allocated: 0.022938251495361328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015193462371826172  GigaBytes
Max Memory Allocated: 0.023958206176757812  GigaBytes

torch.Size([1494, 1433])
torch.Size([717, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018181800842285156  GigaBytes
Max Memory Allocated: 0.023958206176757812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0073356032371521 |0.0857095718383789 |0.19285637140274048 |0.00017017126083374023 |0.0039986371994018555 |0.002198934555053711 |
----------------------------------------------------------pseudo_mini_loss sum 4.061912536621094
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10026
Number of first layer input nodes during this epoch:  6200
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021944522857666016  GigaBytes
Max Memory Allocated: 0.027411460876464844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005941390991210938
random selection method range initialization spend 0.00014710426330566406
time for parepare:  8.726119995117188e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013589859008789062
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  9.34600830078125e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.772445678710938e-05
----------------------check_connections_block total spend ----------------------------- 0.0015988349914550781
generate_one_block  0.0014531612396240234
generate_one_block  0.0013375282287597656
generate_one_block  0.001306295394897461
generate_one_block  0.0013339519500732422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005953311920166016
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00020432472229003906
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005304813385009766
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0005614757537841797
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0004937648773193359
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005750656127929688
----------------------check_connections_block total spend ----------------------------- 0.004177093505859375
generate_one_block  0.0019905567169189453
generate_one_block  0.0019085407257080078
generate_one_block  0.0017971992492675781
generate_one_block  0.0019261837005615234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007274150848388672
gen group dst list time:  0.00011920928955078125
time for parepare:  0.00023818016052246094
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0003237724304199219
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0015873908996582031
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.00024271011352539062
r_  generation:  0.001688241958618164
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.001435995101928711
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0017371177673339844
----------------------check_connections_block total spend ----------------------------- 0.01049947738647461
generate_one_block  0.0031244754791259766
generate_one_block  0.0026404857635498047
generate_one_block  0.002213716506958008
generate_one_block  0.0029144287109375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021944522857666016  GigaBytes
Max Memory Allocated: 0.027411460876464844  GigaBytes

connection checking time:  0.014676570892333984
block generation total time  0.018515586853027344
average batch blocks generation time:  0.004628896713256836
block dataloader generation time/epoch 0.05119657516479492
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02167224884033203  GigaBytes
Max Memory Allocated: 0.030301570892333984  GigaBytes

torch.Size([1590, 1433])
torch.Size([775, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024871826171875  GigaBytes
Max Memory Allocated: 0.030301570892333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02185678482055664  GigaBytes
Max Memory Allocated: 0.03030252456665039  GigaBytes

torch.Size([1601, 1433])
torch.Size([831, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02522754669189453  GigaBytes
Max Memory Allocated: 0.03030252456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020969867706298828  GigaBytes
Max Memory Allocated: 0.03030252456665039  GigaBytes

torch.Size([1459, 1433])
torch.Size([689, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02382516860961914  GigaBytes
Max Memory Allocated: 0.03030252456665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021857738494873047  GigaBytes
Max Memory Allocated: 0.03030252456665039  GigaBytes

torch.Size([1619, 1433])
torch.Size([816, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.025271892547607422  GigaBytes
Max Memory Allocated: 0.03030252456665039  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0047454833984375 |0.0005891919136047363 |0.003938853740692139 |0.00012862682342529297 |0.004020988941192627 |0.0016207695007324219 |
----------------------------------------------------------pseudo_mini_loss sum 0.8321164846420288
Total (block generation + training)time/epoch 0.11269879341125488
Training time/epoch 0.06085062026977539
Training time without block to device /epoch 0.058493852615356445
Training time without total dataloading part /epoch 0.033974647521972656
load block tensor time/epoch 0.01898193359375
block to device time/epoch 0.0023567676544189453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10114
Number of first layer input nodes during this epoch:  6269
