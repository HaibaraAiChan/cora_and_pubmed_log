main start at this time 1648427903.4105415
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007915496826171875
random selection method range initialization spend 0.00019073486328125
time for parepare:  6.318092346191406e-05
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0021369457244873047
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.771087646484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0033659934997558594
generate_one_block  0.0013244152069091797
generate_one_block  0.0012125968933105469
generate_one_block  0.0011301040649414062
generate_one_block  0.0011630058288574219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005433559417724609
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003731250762939453
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004229545593261719
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00043892860412597656
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00036525726318359375
----------------------check_connections_block total spend ----------------------------- 0.0032165050506591797
generate_one_block  0.0015654563903808594
generate_one_block  0.0015683174133300781
generate_one_block  0.0016524791717529297
generate_one_block  0.0015094280242919922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005748271942138672
gen group dst list time:  7.343292236328125e-05
time for parepare:  0.00017571449279785156
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0011718273162841797
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.001138448715209961
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.0013408660888671875
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.001100778579711914
----------------------check_connections_block total spend ----------------------------- 0.0077669620513916016
generate_one_block  0.002515077590942383
generate_one_block  0.002368927001953125
generate_one_block  0.0025415420532226562
generate_one_block  0.002323150634765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.010983467102050781
block generation total time  0.01604437828063965
average batch blocks generation time:  0.004011094570159912
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011647701263427734  GigaBytes
Max Memory Allocated: 0.011647701263427734  GigaBytes

torch.Size([1567, 1433])
torch.Size([694, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.014487743377685547  GigaBytes
Max Memory Allocated: 0.01516103744506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01398611068725586  GigaBytes
Max Memory Allocated: 0.022314071655273438  GigaBytes

torch.Size([1398, 1433])
torch.Size([691, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016965866088867188  GigaBytes
Max Memory Allocated: 0.022314071655273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01502084732055664  GigaBytes
Max Memory Allocated: 0.022441864013671875  GigaBytes

torch.Size([1591, 1433])
torch.Size([793, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01833486557006836  GigaBytes
Max Memory Allocated: 0.022441864013671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01488637924194336  GigaBytes
Max Memory Allocated: 0.023344039916992188  GigaBytes

torch.Size([1445, 1433])
torch.Size([649, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.017661094665527344  GigaBytes
Max Memory Allocated: 0.023344039916992188  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01441282033920288 |0.08614808320999146 |0.19257986545562744 |0.00016617774963378906 |0.005079746246337891 |0.00404667854309082 |
----------------------------------------------------------pseudo_mini_loss sum 4.086884498596191
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9552
Number of first layer input nodes during this epoch:  6001
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021682262420654297  GigaBytes
Max Memory Allocated: 0.027149200439453125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007700920104980469
random selection method range initialization spend 0.0001709461212158203
time for parepare:  0.00011277198791503906
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00011420249938964844
local_output_nid generation:  2.0742416381835938e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00011467933654785156
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00011754035949707031
----------------------check_connections_block total spend ----------------------------- 0.0021810531616210938
generate_one_block  0.001855611801147461
generate_one_block  0.001583099365234375
generate_one_block  0.0012309551239013672
generate_one_block  0.001249551773071289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005657672882080078
gen group dst list time:  4.57763671875e-05
time for parepare:  0.00018072128295898438
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004703998565673828
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0004954338073730469
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00042629241943359375
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0005218982696533203
----------------------check_connections_block total spend ----------------------------- 0.00373077392578125
generate_one_block  0.001829385757446289
generate_one_block  0.0015060901641845703
generate_one_block  0.0014188289642333984
generate_one_block  0.00150299072265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005669593811035156
gen group dst list time:  7.915496826171875e-05
time for parepare:  0.0001766681671142578
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0002770423889160156
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0011463165283203125
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0011682510375976562
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0010242462158203125
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.001255035400390625
----------------------check_connections_block total spend ----------------------------- 0.007487058639526367
generate_one_block  0.0023946762084960938
generate_one_block  0.0025870800018310547
generate_one_block  0.0022072792053222656
generate_one_block  0.0026416778564453125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021682262420654297  GigaBytes
Max Memory Allocated: 0.027149200439453125  GigaBytes

connection checking time:  0.011217832565307617
block generation total time  0.016088008880615234
average batch blocks generation time:  0.004022002220153809
block dataloader generation time/epoch 0.04870247840881348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021250247955322266  GigaBytes
Max Memory Allocated: 0.029578208923339844  GigaBytes

torch.Size([1502, 1433])
torch.Size([697, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024204254150390625  GigaBytes
Max Memory Allocated: 0.029578208923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021599292755126953  GigaBytes
Max Memory Allocated: 0.02957916259765625  GigaBytes

torch.Size([1495, 1433])
torch.Size([728, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02464580535888672  GigaBytes
Max Memory Allocated: 0.02957916259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020553112030029297  GigaBytes
Max Memory Allocated: 0.02957916259765625  GigaBytes

torch.Size([1372, 1433])
torch.Size([616, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0231781005859375  GigaBytes
Max Memory Allocated: 0.02957916259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021602153778076172  GigaBytes
Max Memory Allocated: 0.02957916259765625  GigaBytes

torch.Size([1538, 1433])
torch.Size([751, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02481222152709961  GigaBytes
Max Memory Allocated: 0.02957916259765625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002397298812866211 |0.000392913818359375 |0.0030771493911743164 |0.00010526180267333984 |0.0034450292587280273 |0.0012862682342529297 |
----------------------------------------------------------pseudo_mini_loss sum 0.8521054983139038
Total (block generation + training)time/epoch 0.09178376197814941
Training time/epoch 0.04273080825805664
Training time without block to device /epoch 0.04115915298461914
Training time without total dataloading part /epoch 0.027796030044555664
load block tensor time/epoch 0.009589195251464844
block to device time/epoch 0.0015716552734375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9433
Number of first layer input nodes during this epoch:  5907
