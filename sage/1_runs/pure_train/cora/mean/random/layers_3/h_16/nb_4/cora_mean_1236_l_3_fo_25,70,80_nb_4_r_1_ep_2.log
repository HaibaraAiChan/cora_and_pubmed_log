main start at this time 1648498476.8382869
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013089179992675781
random selection method range initialization spend 0.0001914501190185547
time for parepare:  6.413459777832031e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.002347230911254883
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.269050598144531e-05
----------------------check_connections_block total spend ----------------------------- 0.003573179244995117
generate_one_block  0.001409769058227539
generate_one_block  0.0011529922485351562
generate_one_block  0.0011343955993652344
generate_one_block  0.0011241436004638672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004956722259521484
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0005092620849609375
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003936290740966797
----------------------check_connections_block total spend ----------------------------- 0.0032279491424560547
generate_one_block  0.0017158985137939453
generate_one_block  0.0014901161193847656
generate_one_block  0.0016007423400878906
generate_one_block  0.0014617443084716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005598068237304688
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0001735687255859375
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0014455318450927734
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0011057853698730469
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0010035037994384766
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0012142658233642578
----------------------check_connections_block total spend ----------------------------- 0.007750034332275391
generate_one_block  0.0027103424072265625
generate_one_block  0.0022890567779541016
generate_one_block  0.0021224021911621094
generate_one_block  0.0024213790893554688
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.010977983474731445
block generation total time  0.015811681747436523
average batch blocks generation time:  0.003952920436859131
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009490489959716797  GigaBytes
Max Memory Allocated: 0.009490489959716797  GigaBytes

torch.Size([1735, 1433])
torch.Size([942, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009793281555175781  GigaBytes
Max Memory Allocated: 0.009804725646972656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008070945739746094  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1438, 1433])
torch.Size([638, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008290290832519531  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00742340087890625  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1317, 1433])
torch.Size([607, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007628917694091797  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008564949035644531  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1530, 1433])
torch.Size([774, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00880575180053711  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007658839225769043 |0.08733624219894409 |0.19297057390213013 |0.00016742944717407227 |0.003054022789001465 |0.0021326541900634766 |
----------------------------------------------------------pseudo_mini_loss sum 2.997267723083496
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9702
Number of first layer input nodes during this epoch:  6020
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00901031494140625  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005800724029541016
random selection method range initialization spend 0.0001442432403564453
time for parepare:  8.20159912109375e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.893013000488281e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013303756713867188
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.486343383789062e-05
----------------------check_connections_block total spend ----------------------------- 0.0015501976013183594
generate_one_block  0.001453399658203125
generate_one_block  0.0013422966003417969
generate_one_block  0.0013039112091064453
generate_one_block  0.0013186931610107422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006000995635986328
gen group dst list time:  5.030632019042969e-05
time for parepare:  0.00021505355834960938
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0004937648773193359
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0005927085876464844
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0004982948303222656
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006108283996582031
----------------------check_connections_block total spend ----------------------------- 0.004204988479614258
generate_one_block  0.0019190311431884766
generate_one_block  0.001917123794555664
generate_one_block  0.0017881393432617188
generate_one_block  0.001956939697265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006618499755859375
gen group dst list time:  0.00011539459228515625
time for parepare:  0.00022721290588378906
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0003204345703125
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0014917850494384766
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.0016734600067138672
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.0015077590942382812
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.001859903335571289
----------------------check_connections_block total spend ----------------------------- 0.010549306869506836
generate_one_block  0.003008127212524414
generate_one_block  0.0026597976684570312
generate_one_block  0.002348184585571289
generate_one_block  0.002890348434448242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00901031494140625  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

connection checking time:  0.014754295349121094
block generation total time  0.01848769187927246
average batch blocks generation time:  0.004621922969818115
block dataloader generation time/epoch 0.050936222076416016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008959770202636719  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1538, 1433])
torch.Size([758, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009200572967529297  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009104251861572266  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1564, 1433])
torch.Size([813, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009371757507324219  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008960723876953125  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1514, 1433])
torch.Size([714, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009195804595947266  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010037899017333984  GigaBytes
Max Memory Allocated: 0.018200397491455078  GigaBytes

torch.Size([1738, 1433])
torch.Size([915, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010329246520996094  GigaBytes
Max Memory Allocated: 0.018200397491455078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00246351957321167 |0.0007408857345581055 |0.004878997802734375 |0.0001704096794128418 |0.0027513504028320312 |0.0014770030975341797 |
----------------------------------------------------------pseudo_mini_loss sum 2.604473829269409
Total (block generation + training)time/epoch 0.10270309448242188
Training time/epoch 0.05156421661376953
Training time without block to device /epoch 0.04860067367553711
Training time without total dataloading part /epoch 0.03268003463745117
load block tensor time/epoch 0.00985407829284668
block to device time/epoch 0.002963542938232422
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10294
Number of first layer input nodes during this epoch:  6354
