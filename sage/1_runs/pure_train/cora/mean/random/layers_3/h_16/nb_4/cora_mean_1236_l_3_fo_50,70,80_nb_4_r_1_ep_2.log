main start at this time 1648498513.3835955
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011210441589355469
random selection method range initialization spend 0.00018072128295898438
time for parepare:  5.936622619628906e-05
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0022954940795898438
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.078315734863281e-05
----------------------check_connections_block total spend ----------------------------- 0.003521442413330078
generate_one_block  0.0014729499816894531
generate_one_block  0.0011005401611328125
generate_one_block  0.0010764598846435547
generate_one_block  0.0010557174682617188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004734992980957031
gen group dst list time:  3.695487976074219e-05
time for parepare:  0.00013899803161621094
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004906654357910156
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003662109375
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0003361701965332031
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.000370025634765625
----------------------check_connections_block total spend ----------------------------- 0.0030965805053710938
generate_one_block  0.0016236305236816406
generate_one_block  0.001468658447265625
generate_one_block  0.0014121532440185547
generate_one_block  0.0014064311981201172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005481243133544922
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.00016808509826660156
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.00013446807861328125
r_  generation:  0.001443624496459961
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0010898113250732422
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0009946823120117188
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0012187957763671875
----------------------check_connections_block total spend ----------------------------- 0.007625579833984375
generate_one_block  0.0026171207427978516
generate_one_block  0.0022220611572265625
generate_one_block  0.0020720958709716797
generate_one_block  0.0024461746215820312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.010722160339355469
block generation total time  0.015268325805664062
average batch blocks generation time:  0.0038170814514160156
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009700775146484375  GigaBytes
Max Memory Allocated: 0.009700775146484375  GigaBytes

torch.Size([1774, 1433])
torch.Size([945, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010006904602050781  GigaBytes
Max Memory Allocated: 0.010020732879638672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008356094360351562  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

torch.Size([1491, 1433])
torch.Size([634, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008577346801757812  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007611274719238281  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

torch.Size([1352, 1433])
torch.Size([607, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007817745208740234  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008684635162353516  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

torch.Size([1552, 1433])
torch.Size([777, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008928775787353516  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00733417272567749 |0.08612054586410522 |0.1936115026473999 |0.00021153688430786133 |0.0031715035438537598 |0.0024077892303466797 |
----------------------------------------------------------pseudo_mini_loss sum 2.9654338359832764
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9853
Number of first layer input nodes during this epoch:  6169
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009134292602539062  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
random selection method range initialization spend 0.0001087188720703125
time for parepare:  6.628036499023438e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00010895729064941406
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  8.034706115722656e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.175041198730469e-05
----------------------check_connections_block total spend ----------------------------- 0.0012857913970947266
generate_one_block  0.0011222362518310547
generate_one_block  0.0010869503021240234
generate_one_block  0.001051187515258789
generate_one_block  0.001066446304321289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004868507385253906
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0001533031463623047
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004169940948486328
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.000469207763671875
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00037384033203125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.00045609474182128906
----------------------check_connections_block total spend ----------------------------- 0.0033032894134521484
generate_one_block  0.0015075206756591797
generate_one_block  0.0015461444854736328
generate_one_block  0.0014066696166992188
generate_one_block  0.0015707015991210938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005695819854736328
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.00016927719116210938
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.001196146011352539
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0013289451599121094
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0012280941009521484
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0014529228210449219
----------------------check_connections_block total spend ----------------------------- 0.008404016494750977
generate_one_block  0.0023729801177978516
generate_one_block  0.002597808837890625
generate_one_block  0.0023453235626220703
generate_one_block  0.002885103225708008
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009134292602539062  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

connection checking time:  0.011707305908203125
block generation total time  0.01623225212097168
average batch blocks generation time:  0.00405806303024292
block dataloader generation time/epoch 0.04386591911315918
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0089874267578125  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

torch.Size([1543, 1433])
torch.Size([753, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009229183197021484  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009367942810058594  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

torch.Size([1613, 1433])
torch.Size([812, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00963735580444336  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009037494659423828  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

torch.Size([1552, 1433])
torch.Size([713, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009274482727050781  GigaBytes
Max Memory Allocated: 0.01778888702392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010157108306884766  GigaBytes
Max Memory Allocated: 0.018392562866210938  GigaBytes

torch.Size([1760, 1433])
torch.Size([908, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010448932647705078  GigaBytes
Max Memory Allocated: 0.018392562866210938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028551220893859863 |0.0003815293312072754 |0.003033280372619629 |9.97781753540039e-05 |0.002481400966644287 |0.0012559890747070312 |
----------------------------------------------------------pseudo_mini_loss sum 2.608870506286621
Total (block generation + training)time/epoch 0.08445310592651367
Training time/epoch 0.04035067558288574
Training time without block to device /epoch 0.03882455825805664
Training time without total dataloading part /epoch 0.02371382713317871
load block tensor time/epoch 0.011420488357543945
block to device time/epoch 0.0015261173248291016
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10394
Number of first layer input nodes during this epoch:  6468
