main start at this time 1648498402.5205586
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001302957534790039
random selection method range initialization spend 0.00015592575073242188
time for parepare:  5.984306335449219e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00167083740234375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.125999450683594e-05
----------------------check_connections_block total spend ----------------------------- 0.0028231143951416016
generate_one_block  0.001341104507446289
generate_one_block  0.001094818115234375
generate_one_block  0.0010800361633300781
generate_one_block  0.0010678768157958984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004787445068359375
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00012922286987304688
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004849433898925781
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00034809112548828125
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00031685829162597656
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00033855438232421875
----------------------check_connections_block total spend ----------------------------- 0.0029914379119873047
generate_one_block  0.0015866756439208984
generate_one_block  0.0014140605926513672
generate_one_block  0.0013680458068847656
generate_one_block  0.0013916492462158203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005393028259277344
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.0001652240753173828
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0012700557708740234
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0010650157928466797
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0009236335754394531
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0010628700256347656
----------------------check_connections_block total spend ----------------------------- 0.00710606575012207
generate_one_block  0.0024650096893310547
generate_one_block  0.0021898746490478516
generate_one_block  0.0020165443420410156
generate_one_block  0.0022814273834228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.010097503662109375
block generation total time  0.014713287353515625
average batch blocks generation time:  0.0036783218383789062
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008948802947998047  GigaBytes
Max Memory Allocated: 0.008948802947998047  GigaBytes

torch.Size([1634, 1433])
torch.Size([849, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009230613708496094  GigaBytes
Max Memory Allocated: 0.00923919677734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007899284362792969  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

torch.Size([1406, 1433])
torch.Size([614, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008113384246826172  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007164955139160156  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

torch.Size([1269, 1433])
torch.Size([565, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007360935211181641  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008070945739746094  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

torch.Size([1438, 1433])
torch.Size([681, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008290767669677734  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005686402320861816 |0.08590739965438843 |0.19441688060760498 |0.00018703937530517578 |0.004053831100463867 |0.0035598278045654297 |
----------------------------------------------------------pseudo_mini_loss sum 2.980170726776123
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9177
Number of first layer input nodes during this epoch:  5747
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008509635925292969  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006322860717773438
random selection method range initialization spend 0.00012946128845214844
time for parepare:  7.677078247070312e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.3113021850585938e-05
Using backend: pytorch
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.82012939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0015921592712402344
generate_one_block  0.0013580322265625
generate_one_block  0.0013399124145507812
generate_one_block  0.0013194084167480469
generate_one_block  0.001336812973022461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006098747253417969
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.0001895427703857422
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.00047206878662109375
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.00044155120849609375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0003616809844970703
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00044846534729003906
----------------------check_connections_block total spend ----------------------------- 0.003482341766357422
generate_one_block  0.0015256404876708984
generate_one_block  0.0015180110931396484
generate_one_block  0.0014259815216064453
generate_one_block  0.0015425682067871094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005705356597900391
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.00019431114196777344
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0010848045349121094
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0012307167053222656
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0011031627655029297
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0013470649719238281
----------------------check_connections_block total spend ----------------------------- 0.007903099060058594
generate_one_block  0.0023202896118164062
generate_one_block  0.002770662307739258
generate_one_block  0.002229928970336914
generate_one_block  0.002742767333984375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008509635925292969  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

connection checking time:  0.011385440826416016
block generation total time  0.016075849533081055
average batch blocks generation time:  0.004018962383270264
block dataloader generation time/epoch 0.04688239097595215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0085296630859375  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

torch.Size([1458, 1433])
torch.Size([683, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008753776550292969  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008739471435546875  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

torch.Size([1496, 1433])
torch.Size([752, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008991718292236328  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008530616760253906  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

torch.Size([1430, 1433])
torch.Size([645, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008749008178710938  GigaBytes
Max Memory Allocated: 0.01658773422241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009665489196777344  GigaBytes
Max Memory Allocated: 0.017404556274414062  GigaBytes

torch.Size([1669, 1433])
torch.Size([833, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009936809539794922  GigaBytes
Max Memory Allocated: 0.017404556274414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002579212188720703 |0.00038868188858032227 |0.003072500228881836 |0.00010073184967041016 |0.002893388271331787 |0.0013203620910644531 |
----------------------------------------------------------pseudo_mini_loss sum 2.6201977729797363
Total (block generation + training)time/epoch 0.08835005760192871
Training time/epoch 0.04120898246765137
Training time without block to device /epoch 0.03965425491333008
Training time without total dataloading part /epoch 0.025586843490600586
load block tensor time/epoch 0.010316848754882812
block to device time/epoch 0.001554727554321289
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9706
Number of first layer input nodes during this epoch:  6053
