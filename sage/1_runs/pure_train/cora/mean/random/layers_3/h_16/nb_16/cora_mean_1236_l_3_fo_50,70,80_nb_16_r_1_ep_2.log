main start at this time 1648498532.0901892
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012555122375488281
random selection method range initialization spend 0.000232696533203125
time for parepare:  6.842613220214844e-05
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0025854110717773438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.005906581878662109
generate_one_block  0.001516103744506836
generate_one_block  0.0011494159698486328
generate_one_block  0.0012047290802001953
generate_one_block  0.0011305809020996094
generate_one_block  0.0011301040649414062
generate_one_block  0.0011398792266845703
generate_one_block  0.0011343955993652344
generate_one_block  0.001132965087890625
generate_one_block  0.001119375228881836
generate_one_block  0.0010979175567626953
generate_one_block  0.0010633468627929688
generate_one_block  0.0010237693786621094
generate_one_block  0.0011246204376220703
generate_one_block  0.0010173320770263672
generate_one_block  0.0010159015655517578
generate_one_block  0.001001119613647461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006015300750732422
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.00014901161193847656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00017499923706054688
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001308917999267578
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000240325927734375
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001437664031982422
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00015425682067871094
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00016450881958007812
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015497207641601562
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001971721649169922
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.005948305130004883
generate_one_block  0.0013775825500488281
generate_one_block  0.001256704330444336
generate_one_block  0.0013899803161621094
generate_one_block  0.0012614727020263672
generate_one_block  0.001184701919555664
generate_one_block  0.0012638568878173828
generate_one_block  0.0012819766998291016
generate_one_block  0.0012669563293457031
generate_one_block  0.0011582374572753906
generate_one_block  0.0010769367218017578
generate_one_block  0.0011279582977294922
generate_one_block  0.0011260509490966797
generate_one_block  0.0011768341064453125
generate_one_block  0.0010993480682373047
generate_one_block  0.0010540485382080078
generate_one_block  0.0009980201721191406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006630420684814453
gen group dst list time:  0.0001704692840576172
time for parepare:  0.0002243518829345703
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0006511211395263672
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0004971027374267578
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0007622241973876953
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005269050598144531
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00025200843811035156
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005354881286621094
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005545616149902344
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004968643188476562
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004086494445800781
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004189014434814453
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0006227493286132812
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005292892456054688
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0008533000946044922
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.00054168701171875
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003275871276855469
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001838207244873047
----------------------check_connections_block total spend ----------------------------- 0.014909982681274414
generate_one_block  0.0017817020416259766
generate_one_block  0.0016276836395263672
generate_one_block  0.0018579959869384766
generate_one_block  0.0014941692352294922
generate_one_block  0.001216888427734375
generate_one_block  0.0015137195587158203
generate_one_block  0.001779317855834961
generate_one_block  0.0014619827270507812
generate_one_block  0.0013735294342041016
generate_one_block  0.0013737678527832031
generate_one_block  0.0016427040100097656
generate_one_block  0.0015263557434082031
generate_one_block  0.0018613338470458984
generate_one_block  0.0015254020690917969
generate_one_block  0.0012717247009277344
generate_one_block  0.0011377334594726562
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.020858287811279297
block generation total time  0.04354667663574219
average batch blocks generation time:  0.0027216672897338867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0046138763427734375  GigaBytes
Max Memory Allocated: 0.0046138763427734375  GigaBytes

torch.Size([827, 1433])
torch.Size([323, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0047206878662109375  GigaBytes
Max Memory Allocated: 0.004739284515380859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004429340362548828  GigaBytes
Max Memory Allocated: 0.008830547332763672  GigaBytes

torch.Size([760, 1433])
torch.Size([270, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004514217376708984  GigaBytes
Max Memory Allocated: 0.008830547332763672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005725383758544922  GigaBytes
Max Memory Allocated: 0.00975942611694336  GigaBytes

torch.Size([1001, 1433])
torch.Size([386, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005856037139892578  GigaBytes
Max Memory Allocated: 0.00975942611694336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004755973815917969  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([821, 1433])
torch.Size([261, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004844188690185547  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0025658607482910156  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([412, 1433])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026178359985351562  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0049381256103515625  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([855, 1433])
torch.Size([260, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005029201507568359  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004528045654296875  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([778, 1433])
torch.Size([278, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004621028900146484  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004259586334228516  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([728, 1433])
torch.Size([250, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004344940185546875  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003349781036376953  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([558, 1433])
torch.Size([211, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003421783447265625  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004256725311279297  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([704, 1433])
torch.Size([161, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004318714141845703  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0047435760498046875  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([818, 1433])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0048427581787109375  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004805088043212891  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

torch.Size([830, 1433])
torch.Size([266, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004897594451904297  GigaBytes
Max Memory Allocated: 0.010085105895996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007229804992675781  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([1126, 1433])
torch.Size([471, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007367610931396484  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004644870758056641  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([800, 1433])
torch.Size([302, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0047397613525390625  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0023336410522460938  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([368, 1433])
torch.Size([151, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002391338348388672  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018167495727539062  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([272, 1433])
torch.Size([91, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0018534660339355469  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025964975357055664 |0.02213631570339203 |0.05150304734706879 |0.00012631714344024658 |0.001996442675590515 |0.002125263214111328 |
----------------------------------------------------------pseudo_mini_loss sum 3.2128396034240723
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16535
Number of first layer input nodes during this epoch:  11658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002186298370361328  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
random selection method range initialization spend 0.000148773193359375
time for parepare:  8.082389831542969e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  1.811981201171875e-05
----------------------check_connections_block total spend ----------------------------- 0.003706216812133789
generate_one_block  0.0012891292572021484
generate_one_block  0.0013382434844970703
generate_one_block  0.0013055801391601562
generate_one_block  0.0012350082397460938
generate_one_block  0.0012531280517578125
generate_one_block  0.0012488365173339844
generate_one_block  0.0014307498931884766
generate_one_block  0.001092672348022461
generate_one_block  0.0009641647338867188
generate_one_block  0.0009434223175048828
generate_one_block  0.0009615421295166016
generate_one_block  0.0009486675262451172
generate_one_block  0.0009572505950927734
generate_one_block  0.0009834766387939453
generate_one_block  0.0009629726409912109
generate_one_block  0.0010254383087158203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006403923034667969
gen group dst list time:  0.00013113021850585938
time for parepare:  0.00023865699768066406
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001552104949951172
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00022530555725097656
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00018668174743652344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  9.608268737792969e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00017976760864257812
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001823902130126953
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.632110595703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0070819854736328125
generate_one_block  0.0013728141784667969
generate_one_block  0.0014522075653076172
generate_one_block  0.001489400863647461
generate_one_block  0.001409769058227539
generate_one_block  0.0014214515686035156
generate_one_block  0.0012097358703613281
generate_one_block  0.0011565685272216797
generate_one_block  0.0011751651763916016
generate_one_block  0.001138448715209961
generate_one_block  0.0010712146759033203
generate_one_block  0.001104593276977539
generate_one_block  0.0010249614715576172
generate_one_block  0.001117706298828125
generate_one_block  0.0012242794036865234
generate_one_block  0.0011203289031982422
generate_one_block  0.0010688304901123047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007483959197998047
gen group dst list time:  0.00026488304138183594
time for parepare:  0.00024247169494628906
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003070831298828125
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0006232261657714844
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005059242248535156
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005245208740234375
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.00067138671875
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005071163177490234
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00037598609924316406
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006597042083740234
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006792545318603516
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005242824554443359
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005550384521484375
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003368854522705078
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0006275177001953125
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0008668899536132812
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005991458892822266
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003745555877685547
----------------------check_connections_block total spend ----------------------------- 0.01575326919555664
generate_one_block  0.0014057159423828125
generate_one_block  0.0017631053924560547
generate_one_block  0.0014986991882324219
generate_one_block  0.0015172958374023438
generate_one_block  0.0016672611236572266
generate_one_block  0.0014641284942626953
generate_one_block  0.0013294219970703125
generate_one_block  0.0016324520111083984
generate_one_block  0.0016582012176513672
generate_one_block  0.0015254020690917969
generate_one_block  0.0015294551849365234
generate_one_block  0.0013682842254638672
generate_one_block  0.001623392105102539
generate_one_block  0.001903533935546875
generate_one_block  0.001561880111694336
generate_one_block  0.00130462646484375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.002186298370361328  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

connection checking time:  0.022835254669189453
block generation total time  0.04431033134460449
average batch blocks generation time:  0.0027693957090377808
block dataloader generation time/epoch 0.10480165481567383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0030050277709960938  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([428, 1433])
torch.Size([157, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0030670166015625  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005379676818847656  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([871, 1433])
torch.Size([312, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005480766296386719  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0045795440673828125  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([722, 1433])
torch.Size([264, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004662990570068359  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0049915313720703125  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([799, 1433])
torch.Size([286, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005080223083496094  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005424022674560547  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([879, 1433])
torch.Size([329, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005533695220947266  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004794597625732422  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([762, 1433])
torch.Size([251, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004885196685791016  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0036220550537109375  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([543, 1433])
torch.Size([174, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0036873817443847656  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0051937103271484375  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([836, 1433])
torch.Size([330, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005298614501953125  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005519390106201172  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([897, 1433])
torch.Size([328, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0056247711181640625  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005295753479003906  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([856, 1433])
torch.Size([264, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005377769470214844  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005009174346923828  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes
Using backend: pytorch

torch.Size([802, 1433])
torch.Size([238, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005095481872558594  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0033788681030273438  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([498, 1433])
torch.Size([142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0034332275390625  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005827903747558594  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

torch.Size([955, 1433])
torch.Size([326, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005930423736572266  GigaBytes
Max Memory Allocated: 0.011635780334472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007073879241943359  GigaBytes
Max Memory Allocated: 0.01214599609375  GigaBytes

torch.Size([1187, 1433])
torch.Size([458, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0072193145751953125  GigaBytes
Max Memory Allocated: 0.01214599609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004839420318603516  GigaBytes
Max Memory Allocated: 0.01214599609375  GigaBytes

torch.Size([770, 1433])
torch.Size([289, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004934787750244141  GigaBytes
Max Memory Allocated: 0.01214599609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003262042999267578  GigaBytes
Max Memory Allocated: 0.01214599609375  GigaBytes

torch.Size([476, 1433])
torch.Size([151, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003314495086669922  GigaBytes
Max Memory Allocated: 0.01214599609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00133553147315979 |0.0005643367767333984 |0.004154041409492493 |0.00012880563735961914 |0.0031233131885528564 |0.0016987323760986328 |
----------------------------------------------------------pseudo_mini_loss sum 2.4938385486602783
Total (block generation + training)time/epoch 0.27689099311828613
Training time/epoch 0.17134451866149902
Training time without block to device /epoch 0.16231513023376465
Training time without total dataloading part /epoch 0.12019729614257812
load block tensor time/epoch 0.02136850357055664
block to device time/epoch 0.009029388427734375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17352
Number of first layer input nodes during this epoch:  12281
