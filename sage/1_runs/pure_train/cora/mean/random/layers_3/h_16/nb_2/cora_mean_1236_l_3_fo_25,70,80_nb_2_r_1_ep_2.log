main start at this time 1648498467.780681
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013494491577148438
random selection method range initialization spend 0.0002028942108154297
time for parepare:  6.508827209472656e-05
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0021953582763671875
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00011467933654785156
----------------------check_connections_block total spend ----------------------------- 0.0030198097229003906
generate_one_block  0.0014486312866210938
generate_one_block  0.0011942386627197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004913806915283203
gen group dst list time:  2.956390380859375e-05
time for parepare:  0.00013875961303710938
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0007770061492919922
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006330013275146484
----------------------check_connections_block total spend ----------------------------- 0.002538919448852539
generate_one_block  0.002012968063354492
generate_one_block  0.0018279552459716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005557537078857422
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.00017642974853515625
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0018792152404785156
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0016713142395019531
----------------------check_connections_block total spend ----------------------------- 0.005656003952026367
generate_one_block  0.0032372474670410156
generate_one_block  0.0034203529357910156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.008194923400878906
block generation total time  0.010498523712158203
average batch blocks generation time:  0.0052492618560791016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.01090240478515625  GigaBytes
Max Memory Allocated: 0.01090240478515625  GigaBytes

torch.Size([1996, 1433])
torch.Size([1245, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.011330604553222656  GigaBytes
Max Memory Allocated: 0.01134634017944336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010282039642333984  GigaBytes
Max Memory Allocated: 0.020881175994873047  GigaBytes

torch.Size([1848, 1433])
torch.Size([1083, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010645389556884766  GigaBytes
Max Memory Allocated: 0.020881175994873047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012732505798339844 |0.17174744606018066 |0.3817096948623657 |0.0002167224884033203 |0.004297137260437012 |0.0028252601623535156 |
----------------------------------------------------------pseudo_mini_loss sum 3.1936206817626953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6867
Number of first layer input nodes during this epoch:  3844
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010767936706542969  GigaBytes
Max Memory Allocated: 0.020881175994873047  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007143020629882812
random selection method range initialization spend 0.0001652240753173828
time for parepare:  9.965896606445312e-05
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0001857280731201172
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.000148773193359375
----------------------check_connections_block total spend ----------------------------- 0.0012464523315429688
generate_one_block  0.0017228126525878906
generate_one_block  0.0016210079193115234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007102489471435547
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00020575523376464844
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0002982616424560547
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.00093841552734375
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.000949859619140625
----------------------check_connections_block total spend ----------------------------- 0.003580331802368164
generate_one_block  0.002561330795288086
generate_one_block  0.0026602745056152344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008149147033691406
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.00024819374084472656
local_output_nid generation:  0.00011396408081054688
local_in_edges_tensor generation:  0.0004329681396484375
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.002428770065307617
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0003445148468017578
mini_batch_src_global generation:  0.00032520294189453125
r_  generation:  0.0024116039276123047
----------------------check_connections_block total spend ----------------------------- 0.007830619812011719
generate_one_block  0.004146099090576172
generate_one_block  0.0036690235137939453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010767936706542969  GigaBytes
Max Memory Allocated: 0.020881175994873047  GigaBytes

connection checking time:  0.011410951614379883
block generation total time  0.013036727905273438
average batch blocks generation time:  0.006518363952636719
block dataloader generation time/epoch 0.04007458686828613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011518001556396484  GigaBytes
Max Memory Allocated: 0.021318435668945312  GigaBytes
Using backend: pytorch

torch.Size([2012, 1433])
torch.Size([1265, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011939048767089844  GigaBytes
Max Memory Allocated: 0.021318435668945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011234283447265625  GigaBytes
Max Memory Allocated: 0.021912097930908203  GigaBytes

torch.Size([1959, 1433])
torch.Size([1190, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011635780334472656  GigaBytes
Max Memory Allocated: 0.021912097930908203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004715085029602051 |0.0008561611175537109 |0.0050508975982666016 |0.00016891956329345703 |0.0033758878707885742 |0.0016808509826660156 |
----------------------------------------------------------pseudo_mini_loss sum 2.577791690826416
Total (block generation + training)time/epoch 0.07463383674621582
Training time/epoch 0.033873558044433594
Training time without block to device /epoch 0.03216123580932617
Training time without total dataloading part /epoch 0.01887226104736328
load block tensor time/epoch 0.009430170059204102
block to device time/epoch 0.0017123222351074219
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7134
Number of first layer input nodes during this epoch:  3971
