main start at this time 1648498439.8979473
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010762214660644531
random selection method range initialization spend 0.00018858909606933594
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0012364387512207031
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.887580871582031e-05
----------------------check_connections_block total spend ----------------------------- 0.0023920536041259766
generate_one_block  0.001279592514038086
generate_one_block  0.0011570453643798828
generate_one_block  0.0010700225830078125
generate_one_block  0.001055002212524414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00046896934509277344
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.0001361370086669922
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0005035400390625
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0003676414489746094
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003352165222167969
----------------------check_connections_block total spend ----------------------------- 0.0030634403228759766
generate_one_block  0.001631021499633789
generate_one_block  0.0014216899871826172
generate_one_block  0.0013701915740966797
generate_one_block  0.0014891624450683594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005307197570800781
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0001628398895263672
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00027680397033691406
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0013513565063476562
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.001070261001586914
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0009055137634277344
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0010988712310791016
----------------------check_connections_block total spend ----------------------------- 0.0072481632232666016
generate_one_block  0.00292205810546875
generate_one_block  0.0022296905517578125
generate_one_block  0.002048015594482422
generate_one_block  0.0022487640380859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.010311603546142578
block generation total time  0.015360593795776367
average batch blocks generation time:  0.003840148448944092
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.00887298583984375  GigaBytes
Max Memory Allocated: 0.00887298583984375  GigaBytes

torch.Size([1620, 1433])
torch.Size([849, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00915384292602539  GigaBytes
Max Memory Allocated: 0.009162425994873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00792074203491211  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

torch.Size([1410, 1433])
torch.Size([612, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008134841918945312  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007191658020019531  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

torch.Size([1274, 1433])
torch.Size([568, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007387638092041016  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008006095886230469  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

torch.Size([1426, 1433])
torch.Size([681, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008224964141845703  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008011341094970703 |0.085757315158844 |0.19398009777069092 |0.00018167495727539062 |0.0030676722526550293 |0.0021944046020507812 |
----------------------------------------------------------pseudo_mini_loss sum 2.9914755821228027
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9161
Number of first layer input nodes during this epoch:  5730
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008442878723144531  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005810260772705078
random selection method range initialization spend 0.00014591217041015625
time for parepare:  9.393692016601562e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013446807861328125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  7.510185241699219e-05
----------------------check_connections_block total spend ----------------------------- 0.0015857219696044922
generate_one_block  0.0013780593872070312
generate_one_block  0.0013496875762939453
generate_one_block  0.0013146400451660156
generate_one_block  0.0013267993927001953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005872249603271484
gen group dst list time:  5.2928924560546875e-05
time for parepare:  0.00021409988403320312
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.00048232078552246094
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0005702972412109375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.00045561790466308594
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005686283111572266
----------------------check_connections_block total spend ----------------------------- 0.0040585994720458984
generate_one_block  0.0018935203552246094
generate_one_block  0.0018765926361083984
generate_one_block  0.0017573833465576172
generate_one_block  0.0018870830535888672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006642341613769531
gen group dst list time:  0.00011920928955078125
time for parepare:  0.0002512931823730469
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0013840198516845703
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0015935897827148438
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0013954639434814453
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0017268657684326172
----------------------check_connections_block total spend ----------------------------- 0.009941577911376953
generate_one_block  0.0029144287109375
generate_one_block  0.002713441848754883
generate_one_block  0.0021927356719970703
generate_one_block  0.0028879642486572266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008442878723144531  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

connection checking time:  0.014000177383422852
block generation total time  0.018123149871826172
average batch blocks generation time:  0.004530787467956543
block dataloader generation time/epoch 0.04975557327270508
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008449554443359375  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

torch.Size([1443, 1433])
torch.Size([683, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008673667907714844  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008722305297851562  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

torch.Size([1493, 1433])
torch.Size([746, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00897359848022461  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008450508117675781  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

torch.Size([1408, 1433])
torch.Size([644, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008668899536132812  GigaBytes
Max Memory Allocated: 0.01653432846069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009520530700683594  GigaBytes
Max Memory Allocated: 0.017180442810058594  GigaBytes

torch.Size([1642, 1433])
torch.Size([823, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009787559509277344  GigaBytes
Max Memory Allocated: 0.017180442810058594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028942227363586426 |0.000623166561126709 |0.0045580267906188965 |0.00013774633407592773 |0.002771139144897461 |0.0012812614440917969 |
----------------------------------------------------------pseudo_mini_loss sum 2.6046016216278076
Total (block generation + training)time/epoch 0.10139894485473633
Training time/epoch 0.051076412200927734
Training time without block to device /epoch 0.0485837459564209
Training time without total dataloading part /epoch 0.031148910522460938
load block tensor time/epoch 0.01157689094543457
block to device time/epoch 0.002492666244506836
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9622
Number of first layer input nodes during this epoch:  5986
