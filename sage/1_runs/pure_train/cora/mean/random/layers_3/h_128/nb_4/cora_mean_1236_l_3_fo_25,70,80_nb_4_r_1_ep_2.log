main start at this time 1648427791.863542
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010311603546142578
random selection method range initialization spend 0.00018143653869628906
time for parepare:  6.29425048828125e-05
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.001378774642944336
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.6743621826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.002674579620361328
generate_one_block  0.0015044212341308594
generate_one_block  0.0011637210845947266
generate_one_block  0.0011560916900634766
generate_one_block  0.0011057853698730469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005195140838623047
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00014853477478027344
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0004544258117675781
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004515647888183594
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004744529724121094
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003790855407714844
----------------------check_connections_block total spend ----------------------------- 0.0034449100494384766
generate_one_block  0.001627206802368164
generate_one_block  0.0015933513641357422
generate_one_block  0.0015883445739746094
generate_one_block  0.0015215873718261719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005900859832763672
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0012750625610351562
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.0012514591217041016
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0013349056243896484
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0011148452758789062
----------------------check_connections_block total spend ----------------------------- 0.00813150405883789
generate_one_block  0.0025839805603027344
generate_one_block  0.0024924278259277344
generate_one_block  0.0025582313537597656
generate_one_block  0.0023550987243652344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.011576414108276367
block generation total time  0.016320228576660156
average batch blocks generation time:  0.004080057144165039
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009949684143066406  GigaBytes
Max Memory Allocated: 0.009949684143066406  GigaBytes

torch.Size([1575, 1433])
torch.Size([755, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011576652526855469  GigaBytes
Max Memory Allocated: 0.011816024780273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011198997497558594  GigaBytes
Max Memory Allocated: 0.019565582275390625  GigaBytes

torch.Size([1528, 1433])
torch.Size([784, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012845516204833984  GigaBytes
Max Memory Allocated: 0.019565582275390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011594772338867188  GigaBytes
Max Memory Allocated: 0.01970958709716797  GigaBytes

torch.Size([1602, 1433])
torch.Size([784, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01325845718383789  GigaBytes
Max Memory Allocated: 0.01970958709716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010718345642089844  GigaBytes
Max Memory Allocated: 0.01970958709716797  GigaBytes

torch.Size([1439, 1433])
torch.Size([690, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012141704559326172  GigaBytes
Max Memory Allocated: 0.01970958709716797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011126101016998291 |0.0860711932182312 |0.19449865818023682 |0.0001798868179321289 |0.004570186138153076 |0.002730131149291992 |
----------------------------------------------------------pseudo_mini_loss sum 3.4923529624938965
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9887
Number of first layer input nodes during this epoch:  6144
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013798713684082031  GigaBytes
Max Memory Allocated: 0.01970958709716797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004951953887939453
random selection method range initialization spend 0.00011491775512695312
time for parepare:  6.723403930664062e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  1.1205673217773438e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.939338684082031e-05
----------------------check_connections_block total spend ----------------------------- 0.0013766288757324219
generate_one_block  0.0012047290802001953
generate_one_block  0.0011518001556396484
generate_one_block  0.0011446475982666016
generate_one_block  0.001165628433227539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005283355712890625
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.00016689300537109375
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00035881996154785156
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0004494190216064453
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004980564117431641
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.000446319580078125
----------------------check_connections_block total spend ----------------------------- 0.0034110546112060547
generate_one_block  0.001538991928100586
generate_one_block  0.001558065414428711
generate_one_block  0.0016129016876220703
generate_one_block  0.0015330314636230469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006029605865478516
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0001804828643798828
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0010890960693359375
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0013136863708496094
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.001447916030883789
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0013027191162109375
----------------------check_connections_block total spend ----------------------------- 0.008307695388793945
generate_one_block  0.0023283958435058594
generate_one_block  0.0025572776794433594
generate_one_block  0.0025992393493652344
generate_one_block  0.002619028091430664
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013798713684082031  GigaBytes
Max Memory Allocated: 0.01970958709716797  GigaBytes

connection checking time:  0.01171875
block generation total time  0.01634693145751953
average batch blocks generation time:  0.004086732864379883
block dataloader generation time/epoch 0.043796539306640625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014581680297851562  GigaBytes
Max Memory Allocated: 0.022228240966796875  GigaBytes

torch.Size([1428, 1433])
torch.Size([642, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01593494415283203  GigaBytes
Max Memory Allocated: 0.022228240966796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014465808868408203  GigaBytes
Max Memory Allocated: 0.022976398468017578  GigaBytes

torch.Size([1579, 1433])
torch.Size([781, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01611185073852539  GigaBytes
Max Memory Allocated: 0.022976398468017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015030860900878906  GigaBytes
Max Memory Allocated: 0.023414134979248047  GigaBytes

torch.Size([1684, 1433])
torch.Size([907, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01687765121459961  GigaBytes
Max Memory Allocated: 0.023414134979248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014460563659667969  GigaBytes
Max Memory Allocated: 0.023414134979248047  GigaBytes

torch.Size([1578, 1433])
torch.Size([762, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01611471176147461  GigaBytes
Max Memory Allocated: 0.023414134979248047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023553967475891113 |0.00040024518966674805 |0.003124415874481201 |0.00010353326797485352 |0.00208437442779541 |0.0013546943664550781 |
----------------------------------------------------------pseudo_mini_loss sum 1.744713306427002
Total (block generation + training)time/epoch 0.08154153823852539
Training time/epoch 0.037474870681762695
Training time without block to device /epoch 0.0358738899230957
Training time without total dataloading part /epoch 0.022603988647460938
load block tensor time/epoch 0.009421586990356445
block to device time/epoch 0.0016009807586669922
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10097
Number of first layer input nodes during this epoch:  6269
