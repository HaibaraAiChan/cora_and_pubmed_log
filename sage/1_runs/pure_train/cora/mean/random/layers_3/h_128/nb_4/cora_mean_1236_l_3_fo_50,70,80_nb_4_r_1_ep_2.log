main start at this time 1648427829.344546
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008828639984130859
random selection method range initialization spend 0.00020074844360351562
time for parepare:  6.413459777832031e-05
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0026459693908691406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.003926515579223633
generate_one_block  0.0015430450439453125
generate_one_block  0.0011463165283203125
generate_one_block  0.0011479854583740234
generate_one_block  0.0011203289031982422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005099773406982422
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0001480579376220703
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0004227161407470703
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0004470348358154297
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004582405090332031
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00036835670471191406
----------------------check_connections_block total spend ----------------------------- 0.003336191177368164
generate_one_block  0.001573801040649414
generate_one_block  0.0015876293182373047
generate_one_block  0.0016131401062011719
generate_one_block  0.0015041828155517578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006024837493896484
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.00017952919006347656
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0012829303741455078
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0013031959533691406
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0013210773468017578
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0011663436889648438
----------------------check_connections_block total spend ----------------------------- 0.008246183395385742
generate_one_block  0.0026035308837890625
generate_one_block  0.002538442611694336
generate_one_block  0.0026187896728515625
generate_one_block  0.0024175643920898438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.011582374572753906
block generation total time  0.016457080841064453
average batch blocks generation time:  0.004114270210266113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010185718536376953  GigaBytes
Max Memory Allocated: 0.010185718536376953  GigaBytes

torch.Size([1619, 1433])
torch.Size([763, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011826038360595703  GigaBytes
Max Memory Allocated: 0.012085437774658203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011136054992675781  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

torch.Size([1516, 1433])
torch.Size([783, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012782096862792969  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01168680191040039  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

torch.Size([1618, 1433])
torch.Size([780, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01334524154663086  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010783195495605469  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

torch.Size([1451, 1433])
torch.Size([686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012201309204101562  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007732987403869629 |0.08618855476379395 |0.1940709948539734 |0.00018292665481567383 |0.004201769828796387 |0.005086660385131836 |
----------------------------------------------------------pseudo_mini_loss sum 3.476147413253784
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9946
Number of first layer input nodes during this epoch:  6204
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013865470886230469  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006613731384277344
random selection method range initialization spend 0.00015091896057128906
time for parepare:  9.703636169433594e-05
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.000102996826171875
local_output_nid generation:  1.5020370483398438e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00010991096496582031
----------------------check_connections_block total spend ----------------------------- 0.0019078254699707031
generate_one_block  0.0016088485717773438
generate_one_block  0.0015323162078857422
generate_one_block  0.0015132427215576172
generate_one_block  0.0011739730834960938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004944801330566406
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.00015854835510253906
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003566741943359375
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0004413127899169922
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.00048661231994628906
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.00044417381286621094
----------------------check_connections_block total spend ----------------------------- 0.003373861312866211
generate_one_block  0.0015783309936523438
generate_one_block  0.0015687942504882812
generate_one_block  0.00164031982421875
generate_one_block  0.0014255046844482422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005383491516113281
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.00017189979553222656
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0010526180267333984
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0012459754943847656
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0013937950134277344
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0012280941009521484
----------------------check_connections_block total spend ----------------------------- 0.007886409759521484
generate_one_block  0.0021915435791015625
generate_one_block  0.002461671829223633
generate_one_block  0.0025720596313476562
generate_one_block  0.002693653106689453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013865470886230469  GigaBytes
Max Memory Allocated: 0.019736766815185547  GigaBytes

connection checking time:  0.011260271072387695
block generation total time  0.016131877899169922
average batch blocks generation time:  0.0040329694747924805
block dataloader generation time/epoch 0.04851698875427246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014673709869384766  GigaBytes
Max Memory Allocated: 0.02238321304321289  GigaBytes

torch.Size([1439, 1433])
torch.Size([636, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016017436981201172  GigaBytes
Max Memory Allocated: 0.02238321304321289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014515876770019531  GigaBytes
Max Memory Allocated: 0.02311563491821289  GigaBytes

torch.Size([1588, 1433])
torch.Size([787, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01617288589477539  GigaBytes
Max Memory Allocated: 0.02311563491821289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01501607894897461  GigaBytes
Max Memory Allocated: 0.02344655990600586  GigaBytes

torch.Size([1681, 1433])
torch.Size([910, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01686859130859375  GigaBytes
Max Memory Allocated: 0.02344655990600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0145416259765625  GigaBytes
Max Memory Allocated: 0.023473262786865234  GigaBytes

torch.Size([1593, 1433])
torch.Size([762, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016196727752685547  GigaBytes
Max Memory Allocated: 0.023473262786865234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002512693405151367 |0.0003771781921386719 |0.0031111836433410645 |0.00010210275650024414 |0.003407776355743408 |0.0012888908386230469 |
----------------------------------------------------------pseudo_mini_loss sum 1.7782478332519531
Total (block generation + training)time/epoch 0.09170269966125488
Training time/epoch 0.04292011260986328
Training time without block to device /epoch 0.041411399841308594
Training time without total dataloading part /epoch 0.027773141860961914
load block tensor time/epoch 0.010050773620605469
block to device time/epoch 0.0015087127685546875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10132
Number of first layer input nodes during this epoch:  6301
