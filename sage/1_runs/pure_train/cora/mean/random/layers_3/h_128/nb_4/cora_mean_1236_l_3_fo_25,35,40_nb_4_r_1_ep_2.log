main start at this time 1648427717.1226575
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001016378402709961
random selection method range initialization spend 0.00019121170043945312
time for parepare:  6.842613220214844e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0023326873779296875
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.91278076171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0035855770111083984
generate_one_block  0.0013775825500488281
generate_one_block  0.0011820793151855469
generate_one_block  0.0011603832244873047
generate_one_block  0.0011386871337890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005254745483398438
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0001499652862548828
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00043892860412597656
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004570484161376953
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00035381317138671875
----------------------check_connections_block total spend ----------------------------- 0.0033423900604248047
generate_one_block  0.0015888214111328125
generate_one_block  0.0015749931335449219
generate_one_block  0.0016164779663085938
generate_one_block  0.0014863014221191406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005934238433837891
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.0001838207244873047
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0012962818145751953
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00015211105346679688
r_  generation:  0.0012173652648925781
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0012786388397216797
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0010821819305419922
----------------------check_connections_block total spend ----------------------------- 0.00794076919555664
generate_one_block  0.0025539398193359375
generate_one_block  0.002483367919921875
generate_one_block  0.0025398731231689453
generate_one_block  0.002288818359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.011283159255981445
block generation total time  0.016132593154907227
average batch blocks generation time:  0.004033148288726807
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009654045104980469  GigaBytes
Max Memory Allocated: 0.009654045104980469  GigaBytes

torch.Size([1520, 1433])
torch.Size([703, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01119852066040039  GigaBytes
Max Memory Allocated: 0.011417865753173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.010720252990722656  GigaBytes
Max Memory Allocated: 0.018796920776367188  GigaBytes

torch.Size([1439, 1433])
torch.Size([709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012246131896972656  GigaBytes
Max Memory Allocated: 0.018796920776367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011224746704101562  GigaBytes
Max Memory Allocated: 0.018866539001464844  GigaBytes

torch.Size([1533, 1433])
torch.Size([718, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012783527374267578  GigaBytes
Max Memory Allocated: 0.018866539001464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010234832763671875  GigaBytes
Max Memory Allocated: 0.018866539001464844  GigaBytes

torch.Size([1349, 1433])
torch.Size([618, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011542797088623047  GigaBytes
Max Memory Allocated: 0.018866539001464844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003549516201019287 |0.0858917236328125 |0.1944807767868042 |0.00017058849334716797 |0.005574464797973633 |0.0025315284729003906 |
----------------------------------------------------------pseudo_mini_loss sum 3.4880974292755127
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9319
Number of first layer input nodes during this epoch:  5841
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013308048248291016  GigaBytes
Max Memory Allocated: 0.018866539001464844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046539306640625
random selection method range initialization spend 0.00010967254638671875
time for parepare:  6.413459777832031e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  1.1205673217773438e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.510185241699219e-05
----------------------check_connections_block total spend ----------------------------- 0.001306772232055664
generate_one_block  0.001125335693359375
generate_one_block  0.0010981559753417969
generate_one_block  0.001089334487915039
generate_one_block  0.0011005401611328125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005009174346923828
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.00015544891357421875
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.00033164024353027344
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004229545593261719
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00045752525329589844
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004291534423828125
----------------------check_connections_block total spend ----------------------------- 0.0032379627227783203
generate_one_block  0.0015187263488769531
generate_one_block  0.0015003681182861328
generate_one_block  0.0015609264373779297
generate_one_block  0.0014989376068115234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
gen group dst list time:  8.392333984375e-05
time for parepare:  0.00018262863159179688
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0009889602661132812
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0012199878692626953
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0013349056243896484
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.001211404800415039
----------------------check_connections_block total spend ----------------------------- 0.007851600646972656
generate_one_block  0.0022270679473876953
generate_one_block  0.0026581287384033203
generate_one_block  0.0025451183319091797
generate_one_block  0.002554655075073242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013308048248291016  GigaBytes
Max Memory Allocated: 0.018866539001464844  GigaBytes

connection checking time:  0.011089563369750977
block generation total time  0.016063928604125977
average batch blocks generation time:  0.004015982151031494
block dataloader generation time/epoch 0.04175925254821777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.012992382049560547  GigaBytes
Max Memory Allocated: 0.020162105560302734  GigaBytes

torch.Size([1305, 1433])
torch.Size([569, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014227867126464844  GigaBytes
Max Memory Allocated: 0.020162105560302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013934612274169922  GigaBytes
Max Memory Allocated: 0.020862579345703125  GigaBytes

torch.Size([1480, 1433])
torch.Size([708, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01546335220336914  GigaBytes
Max Memory Allocated: 0.020862579345703125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014461517333984375  GigaBytes
Max Memory Allocated: 0.022320270538330078  GigaBytes

torch.Size([1578, 1433])
torch.Size([811, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016154766082763672  GigaBytes
Max Memory Allocated: 0.022320270538330078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01400899887084961  GigaBytes
Max Memory Allocated: 0.022394657135009766  GigaBytes

torch.Size([1494, 1433])
torch.Size([701, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015565872192382812  GigaBytes
Max Memory Allocated: 0.022394657135009766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0016186237335205078 |0.000406801700592041 |0.003174722194671631 |0.00010532140731811523 |0.003435075283050537 |0.0013234615325927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.7562984228134155
Total (block generation + training)time/epoch 0.08231472969055176
Training time/epoch 0.040203094482421875
Training time without block to device /epoch 0.03857588768005371
Training time without total dataloading part /epoch 0.028183937072753906
load block tensor time/epoch 0.006474494934082031
block to device time/epoch 0.001627206802368164
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9382
Number of first layer input nodes during this epoch:  5857
