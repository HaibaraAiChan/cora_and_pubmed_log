main start at this time 1648427772.9120386
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00130462646484375
random selection method range initialization spend 0.00022530555725097656
time for parepare:  6.914138793945312e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.0023038387298583984
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.574920654296875e-05
----------------------check_connections_block total spend ----------------------------- 0.005589962005615234
generate_one_block  0.001384735107421875
generate_one_block  0.0012378692626953125
generate_one_block  0.0012493133544921875
generate_one_block  0.0011920928955078125
generate_one_block  0.0012056827545166016
generate_one_block  0.0010538101196289062
generate_one_block  0.0010118484497070312
generate_one_block  0.0010251998901367188
generate_one_block  0.0010433197021484375
generate_one_block  0.001016378402709961
generate_one_block  0.0010581016540527344
generate_one_block  0.0010166168212890625
generate_one_block  0.0010175704956054688
generate_one_block  0.0010142326354980469
generate_one_block  0.0010251998901367188
generate_one_block  0.001016378402709961
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006005764007568359
gen group dst list time:  0.00011110305786132812
time for parepare:  0.00016546249389648438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002129077911376953
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010919570922851562
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.226799011230469e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  0.00010323524475097656
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001499652862548828
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00012230873107910156
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010061264038085938
----------------------check_connections_block total spend ----------------------------- 0.005918741226196289
generate_one_block  0.0014367103576660156
generate_one_block  0.0014569759368896484
generate_one_block  0.0012879371643066406
generate_one_block  0.0013506412506103516
generate_one_block  0.001344919204711914
generate_one_block  0.0010862350463867188
generate_one_block  0.0010986328125
generate_one_block  0.0011627674102783203
generate_one_block  0.0012629032135009766
generate_one_block  0.0011568069458007812
generate_one_block  0.00110626220703125
generate_one_block  0.0011332035064697266
generate_one_block  0.0011563301086425781
generate_one_block  0.001065969467163086
generate_one_block  0.0011239051818847656
generate_one_block  0.0011134147644042969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006964206695556641
gen group dst list time:  0.00016832351684570312
time for parepare:  0.000244140625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00033926963806152344
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0007481575012207031
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0006389617919921875
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006794929504394531
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003361701965332031
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00031447410583496094
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005788803100585938
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0006945133209228516
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005338191986083984
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0002961158752441406
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0004456043243408203
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0004990100860595703
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002384185791015625
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00035881996154785156
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00028014183044433594
----------------------check_connections_block total spend ----------------------------- 0.01393890380859375
generate_one_block  0.0013997554779052734
generate_one_block  0.0017676353454589844
generate_one_block  0.0013549327850341797
generate_one_block  0.0016279220581054688
generate_one_block  0.00165557861328125
generate_one_block  0.0012869834899902344
generate_one_block  0.0014729499816894531
generate_one_block  0.00153350830078125
generate_one_block  0.0016319751739501953
generate_one_block  0.001466989517211914
generate_one_block  0.0012311935424804688
generate_one_block  0.0013422966003417969
generate_one_block  0.0014307498931884766
generate_one_block  0.001161813735961914
generate_one_block  0.0013756752014160156
generate_one_block  0.0012722015380859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.01985764503479004
block generation total time  0.04235577583312988
average batch blocks generation time:  0.0026472359895706177
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004312992095947266  GigaBytes
Max Memory Allocated: 0.004312992095947266  GigaBytes

torch.Size([525, 1433])
torch.Size([147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004660606384277344  GigaBytes
Max Memory Allocated: 0.004782199859619141  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008220195770263672  GigaBytes
Max Memory Allocated: 0.011002540588378906  GigaBytes

torch.Size([974, 1433])
torch.Size([344, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008937835693359375  GigaBytes
Max Memory Allocated: 0.011002540588378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005870342254638672  GigaBytes
Max Memory Allocated: 0.01106119155883789  GigaBytes

torch.Size([536, 1433])
torch.Size([159, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006224155426025391  GigaBytes
Max Memory Allocated: 0.01106119155883789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007569313049316406  GigaBytes
Max Memory Allocated: 0.01106119155883789  GigaBytes

torch.Size([853, 1433])
torch.Size([291, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008124828338623047  GigaBytes
Max Memory Allocated: 0.01106119155883789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007263660430908203  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

torch.Size([795, 1433])
torch.Size([330, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007954597473144531  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0056247711181640625  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

torch.Size([490, 1433])
torch.Size([157, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005947113037109375  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005443572998046875  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

torch.Size([456, 1433])
torch.Size([135, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005753993988037109  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007740020751953125  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

torch.Size([885, 1433])
torch.Size([298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008327007293701172  GigaBytes
Max Memory Allocated: 0.011797904968261719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008069992065429688  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([898, 1433])
torch.Size([332, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008763790130615234  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007022857666015625  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([751, 1433])
torch.Size([255, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007534027099609375  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005154132843017578  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([402, 1433])
torch.Size([139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005469799041748047  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006081581115722656  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([575, 1433])
torch.Size([200, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006495475769042969  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006771087646484375  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([704, 1433])
torch.Size([257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00726318359375  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004811763763427734  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([338, 1433])
torch.Size([102, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005050182342529297  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006641864776611328  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([680, 1433])
torch.Size([203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0070667266845703125  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005138874053955078  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([399, 1433])
torch.Size([143, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005435466766357422  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005157172679901123 |0.02197173237800598 |0.05143004655838013 |0.00013111531734466553 |0.0030018389225006104 |0.002584218978881836 |
----------------------------------------------------------pseudo_mini_loss sum 3.7667288780212402
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14513
Number of first layer input nodes during this epoch:  10261
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00815725326538086  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004444122314453125
random selection method range initialization spend 0.00010728836059570312
time for parepare:  5.888938903808594e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.5020370483398438e-05
----------------------check_connections_block total spend ----------------------------- 0.0029506683349609375
generate_one_block  0.0010628700256347656
generate_one_block  0.0009763240814208984
generate_one_block  0.001001119613647461
generate_one_block  0.0009636878967285156
generate_one_block  0.0009486675262451172
generate_one_block  0.0009887218475341797
generate_one_block  0.0011510848999023438
generate_one_block  0.0009629726409912109
generate_one_block  0.0009515285491943359
generate_one_block  0.0010166168212890625
generate_one_block  0.0009732246398925781
generate_one_block  0.0009481906890869141
generate_one_block  0.0009484291076660156
generate_one_block  0.0009613037109375
generate_one_block  0.0009546279907226562
generate_one_block  0.0009486675262451172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005707740783691406
gen group dst list time:  0.00011968612670898438
time for parepare:  0.00019288063049316406
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00015592575073242188
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011849403381347656
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011777877807617188
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.0052149295806884766
generate_one_block  0.0010807514190673828
generate_one_block  0.0010144710540771484
generate_one_block  0.001176595687866211
generate_one_block  0.0011222362518310547
generate_one_block  0.0010528564453125
generate_one_block  0.0010836124420166016
generate_one_block  0.0010809898376464844
generate_one_block  0.001500844955444336
generate_one_block  0.001125335693359375
generate_one_block  0.0011382102966308594
generate_one_block  0.0011219978332519531
generate_one_block  0.0010821819305419922
generate_one_block  0.0010144710540771484
generate_one_block  0.0010991096496582031
generate_one_block  0.0011188983917236328
generate_one_block  0.0010745525360107422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005505084991455078
gen group dst list time:  0.00017189979553222656
time for parepare:  0.00021123886108398438
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0002562999725341797
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003666877746582031
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0004730224609375
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0003464221954345703
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004341602325439453
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004730224609375
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00041985511779785156
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004956722259521484
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005371570587158203
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004279613494873047
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00026035308837890625
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004410743713378906
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004668235778808594
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0001499652862548828
----------------------check_connections_block total spend ----------------------------- 0.012059211730957031
generate_one_block  0.0014095306396484375
generate_one_block  0.0012786388397216797
generate_one_block  0.0014109611511230469
generate_one_block  0.0014989376068115234
generate_one_block  0.0013790130615234375
generate_one_block  0.0014493465423583984
generate_one_block  0.001493692398071289
generate_one_block  0.0014667510986328125
generate_one_block  0.0014278888702392578
generate_one_block  0.0015299320220947266
generate_one_block  0.001565694808959961
generate_one_block  0.0015537738800048828
generate_one_block  0.0012509822845458984
generate_one_block  0.0014379024505615234
generate_one_block  0.0014803409576416016
generate_one_block  0.0011115074157714844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00815725326538086  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

connection checking time:  0.017274141311645508
block generation total time  0.040632009506225586
average batch blocks generation time:  0.002539500594139099
block dataloader generation time/epoch 0.09062385559082031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009273529052734375  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([612, 1433])
torch.Size([197, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009685993194580078  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008443355560302734  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([457, 1433])
torch.Size([119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008723735809326172  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009274482727050781  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

torch.Size([578, 1433])
torch.Size([217, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009701728820800781  GigaBytes
Max Memory Allocated: 0.012774944305419922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010067462921142578  GigaBytes
Max Memory Allocated: 0.013319015502929688  GigaBytes

torch.Size([760, 1433])
torch.Size([277, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010638236999511719  GigaBytes
Max Memory Allocated: 0.013319015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009273529052734375  GigaBytes
Max Memory Allocated: 0.013319015502929688  GigaBytes

torch.Size([610, 1433])
torch.Size([188, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009662628173828125  GigaBytes
Max Memory Allocated: 0.013319015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010060310363769531  GigaBytes
Max Memory Allocated: 0.013319015502929688  GigaBytes

torch.Size([759, 1433])
torch.Size([255, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010553359985351562  GigaBytes
Max Memory Allocated: 0.013319015502929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00997018814086914  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

torch.Size([742, 1433])
torch.Size([254, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010480880737304688  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010030269622802734  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

torch.Size([753, 1433])
torch.Size([251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010579586029052734  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009418487548828125  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

torch.Size([639, 1433])
torch.Size([242, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00989675521850586  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010356426239013672  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

torch.Size([814, 1433])
torch.Size([289, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0109405517578125  GigaBytes
Max Memory Allocated: 0.014007568359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010256290435791016  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes
Using backend: pytorch

torch.Size([795, 1433])
torch.Size([306, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010879993438720703  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00993204116821289  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

torch.Size([735, 1433])
torch.Size([257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010449409484863281  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008496761322021484  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

torch.Size([467, 1433])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008815288543701172  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009895801544189453  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

torch.Size([728, 1433])
torch.Size([251, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010460376739501953  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009725570678710938  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

torch.Size([696, 1433])
torch.Size([269, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010300159454345703  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0075855255126953125  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

torch.Size([297, 1433])
torch.Size([65, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0077362060546875  GigaBytes
Max Memory Allocated: 0.014584064483642578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012038648128509521 |0.0004647970199584961 |0.0036514103412628174 |0.00011457502841949463 |0.003138795495033264 |0.0020999908447265625 |
----------------------------------------------------------pseudo_mini_loss sum 1.7435193061828613
Total (block generation + training)time/epoch 0.24730134010314941
Training time/epoch 0.1562964916229248
Training time without block to device /epoch 0.14885973930358887
Training time without total dataloading part /epoch 0.11257648468017578
load block tensor time/epoch 0.019261837005615234
block to device time/epoch 0.0074367523193359375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14798
Number of first layer input nodes during this epoch:  10442
