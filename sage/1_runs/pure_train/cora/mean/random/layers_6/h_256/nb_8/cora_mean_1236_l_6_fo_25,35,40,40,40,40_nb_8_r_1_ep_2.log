main start at this time 1648433280.676692
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013184547424316406
random selection method range initialization spend 0.00017690658569335938
time for parepare:  6.461143493652344e-05
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0023369789123535156
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.4332275390625e-05
----------------------check_connections_block total spend ----------------------------- 0.004258632659912109
generate_one_block  0.0012772083282470703
generate_one_block  0.0010960102081298828
generate_one_block  0.0010581016540527344
generate_one_block  0.0010826587677001953
generate_one_block  0.0010564327239990234
generate_one_block  0.0010578632354736328
generate_one_block  0.0010504722595214844
generate_one_block  0.001089334487915039
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005044937133789062
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.0001442432403564453
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00024890899658203125
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.000263214111328125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002789497375488281
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00020885467529296875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001800060272216797
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00021839141845703125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00020623207092285156
----------------------check_connections_block total spend ----------------------------- 0.003954648971557617
generate_one_block  0.0013418197631835938
generate_one_block  0.0013339519500732422
generate_one_block  0.0012485980987548828
generate_one_block  0.0013582706451416016
generate_one_block  0.0012624263763427734
generate_one_block  0.0012423992156982422
generate_one_block  0.0013344287872314453
generate_one_block  0.0012390613555908203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006988048553466797
gen group dst list time:  0.00010275840759277344
time for parepare:  0.000194549560546875
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0008068084716796875
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0008544921875
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006508827209472656
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  9.1552734375e-05
r_  generation:  0.0008950233459472656
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0007548332214355469
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006520748138427734
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007412433624267578
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0006978511810302734
----------------------check_connections_block total spend ----------------------------- 0.010446310043334961
generate_one_block  0.0020318031311035156
generate_one_block  0.002014636993408203
generate_one_block  0.0017094612121582031
generate_one_block  0.001992940902709961
generate_one_block  0.0018534660339355469
generate_one_block  0.0018208026885986328
generate_one_block  0.0018188953399658203
generate_one_block  0.0017960071563720703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007731914520263672
gen group dst list time:  0.0001919269561767578
time for parepare:  0.00021028518676757812
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0004227161407470703
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0018434524536132812
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0019078254699707031
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0015990734100341797
local_output_nid generation:  9.369850158691406e-05
local_in_edges_tensor generation:  0.00025773048400878906
mini_batch_src_global generation:  0.00018644332885742188
r_  generation:  0.001928091049194336
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0018439292907714844
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0017709732055664062
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.0015094280242919922
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.001657724380493164
----------------------check_connections_block total spend ----------------------------- 0.021953105926513672
generate_one_block  0.0031557083129882812
generate_one_block  0.0029909610748291016
generate_one_block  0.002689838409423828
generate_one_block  0.0030481815338134766
generate_one_block  0.0031321048736572266
generate_one_block  0.0028891563415527344
generate_one_block  0.002719879150390625
generate_one_block  0.0028390884399414062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007452964782714844
gen group dst list time:  0.00032639503479003906
time for parepare:  0.00021648406982421875
local_output_nid generation:  0.0001277923583984375
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.0027437210083007812
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.0003082752227783203
r_  generation:  0.002691984176635742
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0024678707122802734
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.0027480125427246094
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.0027360916137695312
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.0027124881744384766
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0023686885833740234
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.0024306774139404297
----------------------check_connections_block total spend ----------------------------- 0.03181815147399902
generate_one_block  0.004195213317871094
generate_one_block  0.003699064254760742
generate_one_block  0.0035097599029541016
generate_one_block  0.004360198974609375
generate_one_block  0.0045604705810546875
generate_one_block  0.0037937164306640625
generate_one_block  0.003598928451538086
generate_one_block  0.003606557846069336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007717609405517578
gen group dst list time:  0.0004665851593017578
time for parepare:  0.00019097328186035156
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.0005106925964355469
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0031833648681640625
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0003273487091064453
r_  generation:  0.003107309341430664
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  0.00026869773864746094
r_  generation:  0.0029845237731933594
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.003154754638671875
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0031442642211914062
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.0003616809844970703
mini_batch_src_global generation:  0.00026297569274902344
r_  generation:  0.0030133724212646484
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.002849578857421875
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.0002422332763671875
r_  generation:  0.0028269290924072266
----------------------check_connections_block total spend ----------------------------- 0.036218881607055664
generate_one_block  0.005025625228881836
generate_one_block  0.00401759147644043
generate_one_block  0.004193544387817383
generate_one_block  0.0040283203125
generate_one_block  0.0040454864501953125
generate_one_block  0.004042387008666992
generate_one_block  0.004080057144165039
generate_one_block  0.004080057144165039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

connection checking time:  0.10439109802246094
block generation total time  0.11370086669921875
average batch blocks generation time:  0.014212608337402344
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01798248291015625  GigaBytes
Max Memory Allocated: 0.01798248291015625  GigaBytes

torch.Size([2446, 1433])
torch.Size([2313, 256])
torch.Size([1930, 256])
torch.Size([1173, 256])
torch.Size([468, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.04032182693481445  GigaBytes
Max Memory Allocated: 0.0404210090637207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.023318767547607422  GigaBytes
Max Memory Allocated: 0.04166460037231445  GigaBytes

torch.Size([2406, 1433])
torch.Size([2234, 256])
torch.Size([1891, 256])
torch.Size([1188, 256])
torch.Size([460, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.04608726501464844  GigaBytes
Max Memory Allocated: 0.046193599700927734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023510456085205078  GigaBytes
Max Memory Allocated: 0.046509742736816406  GigaBytes

torch.Size([2355, 1433])
torch.Size([2127, 256])
torch.Size([1700, 256])
torch.Size([963, 256])
torch.Size([349, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.043230533599853516  GigaBytes
Max Memory Allocated: 0.046509742736816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.023231983184814453  GigaBytes
Max Memory Allocated: 0.046509742736816406  GigaBytes

torch.Size([2389, 1433])
torch.Size([2281, 256])
torch.Size([1929, 256])
torch.Size([1238, 256])
torch.Size([532, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.046507835388183594  GigaBytes
Max Memory Allocated: 0.04662942886352539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02353048324584961  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

torch.Size([2405, 1433])
torch.Size([2268, 256])
torch.Size([1885, 256])
torch.Size([1134, 256])
torch.Size([402, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.045627593994140625  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.023272037506103516  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

torch.Size([2399, 1433])
torch.Size([2263, 256])
torch.Size([1912, 256])
torch.Size([1081, 256])
torch.Size([365, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04548501968383789  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.023517131805419922  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

torch.Size([2385, 1433])
torch.Size([2215, 256])
torch.Size([1737, 256])
torch.Size([1020, 256])
torch.Size([421, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04409933090209961  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02322530746459961  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

torch.Size([2391, 1433])
torch.Size([2195, 256])
torch.Size([1802, 256])
torch.Size([1061, 256])
torch.Size([375, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04445505142211914  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005584269762039185 |0.04381054639816284 |0.10359105467796326 |0.0001608431339263916 |0.005699634552001953 |0.0046007633209228516 |
----------------------------------------------------------pseudo_mini_loss sum 3.277470111846924
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64846
Number of first layer input nodes during this epoch:  19176
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033537864685058594  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00048279762268066406
random selection method range initialization spend 0.00011396408081054688
time for parepare:  6.914138793945312e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.410743713378906e-05
----------------------check_connections_block total spend ----------------------------- 0.0018200874328613281
generate_one_block  0.0011563301086425781
generate_one_block  0.00104522705078125
generate_one_block  0.001035451889038086
generate_one_block  0.001012563705444336
generate_one_block  0.0010428428649902344
generate_one_block  0.0010449886322021484
generate_one_block  0.0010294914245605469
generate_one_block  0.0010154247283935547
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005335807800292969
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.00016260147094726562
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00017833709716796875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00021767616271972656
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00023555755615234375
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00025463104248046875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021386146545410156
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00024890899658203125
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002288818359375
----------------------check_connections_block total spend ----------------------------- 0.004195213317871094
generate_one_block  0.0013866424560546875
generate_one_block  0.0012621879577636719
generate_one_block  0.001325845718383789
generate_one_block  0.001354217529296875
generate_one_block  0.001264810562133789
generate_one_block  0.0013670921325683594
generate_one_block  0.0013017654418945312
generate_one_block  0.0012485980987548828
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007741451263427734
gen group dst list time:  0.00010514259338378906
time for parepare:  0.00019931793212890625
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005121231079101562
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0007445812225341797
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  0.0001163482666015625
r_  generation:  0.0007708072662353516
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0009083747863769531
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0007474422454833984
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0008018016815185547
local_output_nid generation:  6.532669067382812e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0008485317230224609
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0006928443908691406
----------------------check_connections_block total spend ----------------------------- 0.010455846786499023
generate_one_block  0.0016896724700927734
generate_one_block  0.0018851757049560547
generate_one_block  0.0018916130065917969
generate_one_block  0.002148866653442383
generate_one_block  0.0019369125366210938
generate_one_block  0.0019073486328125
generate_one_block  0.0020537376403808594
generate_one_block  0.0017633438110351562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007703304290771484
gen group dst list time:  0.0002231597900390625
time for parepare:  0.00019359588623046875
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0003669261932373047
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0012657642364501953
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.0018041133880615234
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00020241737365722656
r_  generation:  0.0018389225006103516
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.00199127197265625
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0017311573028564453
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0017852783203125
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.0018339157104492188
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0017018318176269531
----------------------check_connections_block total spend ----------------------------- 0.021732568740844727
generate_one_block  0.002558469772338867
generate_one_block  0.002885103225708008
generate_one_block  0.002947568893432617
generate_one_block  0.0032150745391845703
generate_one_block  0.002897977828979492
generate_one_block  0.002875804901123047
generate_one_block  0.003022909164428711
generate_one_block  0.002936124801635742
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007746219635009766
gen group dst list time:  0.0003261566162109375
time for parepare:  0.00019025802612304688
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.00042891502380371094
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0023026466369628906
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.00032258033752441406
mini_batch_src_global generation:  0.00028634071350097656
r_  generation:  0.0026755332946777344
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.002682924270629883
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.0003371238708496094
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.0028133392333984375
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.0026090145111083984
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  0.0002167224884033203
r_  generation:  0.0024619102478027344
local_output_nid generation:  0.00013494491577148438
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0025207996368408203
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.00022363662719726562
r_  generation:  0.0024895668029785156
----------------------check_connections_block total spend ----------------------------- 0.031159162521362305
generate_one_block  0.003882884979248047
generate_one_block  0.0040433406829833984
generate_one_block  0.003724336624145508
generate_one_block  0.003813505172729492
generate_one_block  0.0036704540252685547
generate_one_block  0.003673076629638672
generate_one_block  0.004164218902587891
generate_one_block  0.003718852996826172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008051395416259766
gen group dst list time:  0.0004513263702392578
time for parepare:  0.00019550323486328125
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.00026917457580566406
r_  generation:  0.0029473304748535156
local_output_nid generation:  0.00016188621520996094
local_in_edges_tensor generation:  0.0003733634948730469
mini_batch_src_global generation:  0.0003066062927246094
r_  generation:  0.003012418746948242
local_output_nid generation:  0.0001685619354248047
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.00031113624572753906
r_  generation:  0.00305938720703125
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.0003819465637207031
mini_batch_src_global generation:  0.0002608299255371094
r_  generation:  0.003093242645263672
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.003050088882446289
local_output_nid generation:  0.00016736984252929688
local_in_edges_tensor generation:  0.00036716461181640625
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.0028955936431884766
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation: Using backend: pytorch
 0.0003330707550048828
mini_batch_src_global generation:  0.0002448558807373047
r_  generation:  0.002883434295654297
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.0003342628479003906
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.002863168716430664
----------------------check_connections_block total spend ----------------------------- 0.03577566146850586
generate_one_block  0.004091739654541016
generate_one_block  0.004109859466552734
generate_one_block  0.004866361618041992
generate_one_block  0.004065036773681641
generate_one_block  0.003987789154052734
generate_one_block  0.004037618637084961
generate_one_block  0.00436711311340332
generate_one_block  0.0040531158447265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.033537864685058594  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

connection checking time:  0.10331845283508301
block generation total time  0.11339616775512695
average batch blocks generation time:  0.01417452096939087
block dataloader generation time/epoch 0.252455472946167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03337526321411133  GigaBytes
Max Memory Allocated: 0.04700326919555664  GigaBytes

torch.Size([2408, 1433])
torch.Size([2150, 256])
torch.Size([1564, 256])
torch.Size([781, 256])
torch.Size([276, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0520024299621582  GigaBytes
Max Memory Allocated: 0.052082061767578125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03311014175415039  GigaBytes
Max Memory Allocated: 0.0521845817565918  GigaBytes

torch.Size([2374, 1433])
torch.Size([2243, 256])
torch.Size([1854, 256])
torch.Size([1080, 256])
torch.Size([411, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.05525970458984375  GigaBytes
Max Memory Allocated: 0.055338382720947266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03340578079223633  GigaBytes
Max Memory Allocated: 0.05570411682128906  GigaBytes

torch.Size([2401, 1433])
torch.Size([2250, 256])
torch.Size([1860, 256])
torch.Size([1073, 256])
torch.Size([420, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.05534791946411133  GigaBytes
Max Memory Allocated: 0.05570411682128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033124446868896484  GigaBytes
Max Memory Allocated: 0.055760860443115234  GigaBytes

torch.Size([2391, 1433])
torch.Size([2269, 256])
torch.Size([1950, 256])
torch.Size([1264, 256])
torch.Size([529, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0565190315246582  GigaBytes
Max Memory Allocated: 0.0566558837890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0334019660949707  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

torch.Size([2376, 1433])
torch.Size([2222, 256])
torch.Size([1801, 256])
torch.Size([1081, 256])
torch.Size([407, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.05509471893310547  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03319597244262695  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

torch.Size([2407, 1433])
torch.Size([2262, 256])
torch.Size([1799, 256])
torch.Size([1049, 256])
torch.Size([401, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.054268836975097656  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03311777114868164  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

torch.Size([2372, 1433])
torch.Size([2237, 256])
torch.Size([1866, 256])
torch.Size([1182, 256])
torch.Size([473, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.05588388442993164  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033403873443603516  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

torch.Size([2387, 1433])
torch.Size([2244, 256])
torch.Size([1842, 256])
torch.Size([1133, 256])
torch.Size([376, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.055281639099121094  GigaBytes
Max Memory Allocated: 0.05717802047729492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003760010004043579 |0.000866621732711792 |0.007231026887893677 |0.00012323260307312012 |0.006225258111953735 |0.0034935474395751953 |
----------------------------------------------------------pseudo_mini_loss sum 3.1414403915405273
Total (block generation + training)time/epoch 0.4113762378692627
Training time/epoch 0.158583402633667
Training time without block to device /epoch 0.15165042877197266
Training time without total dataloading part /epoch 0.11212968826293945
load block tensor time/epoch 0.030080080032348633
block to device time/epoch 0.006932973861694336
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64221
Number of first layer input nodes during this epoch:  19116
