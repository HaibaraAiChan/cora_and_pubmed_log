main start at this time 1648433261.472326
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001336812973022461
random selection method range initialization spend 0.00022530555725097656
time for parepare:  8.177757263183594e-05
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0029535293579101562
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00013518333435058594
----------------------check_connections_block total spend ----------------------------- 0.003987550735473633
generate_one_block  0.0019593238830566406
generate_one_block  0.0015196800231933594
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005900859832763672
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.00018358230590820312
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0009434223175048828
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0007467269897460938
----------------------check_connections_block total spend ----------------------------- 0.0031075477600097656
generate_one_block  0.002438783645629883
generate_one_block  0.0021238327026367188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007047653198242188
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0002243518829345703
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0004169940948486328
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.002415895462036133
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.0020160675048828125
----------------------check_connections_block total spend ----------------------------- 0.007119178771972656
generate_one_block  0.004027366638183594
generate_one_block  0.0035033226013183594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007750988006591797
gen group dst list time:  0.00011610984802246094
time for parepare:  0.00023937225341796875
local_output_nid generation:  0.0001785755157470703
local_in_edges_tensor generation:  0.0005340576171875
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0036077499389648438
local_output_nid generation:  0.00017714500427246094
local_in_edges_tensor generation:  0.0003991127014160156
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.0033483505249023438
----------------------check_connections_block total spend ----------------------------- 0.010687589645385742
generate_one_block  0.004926204681396484
generate_one_block  0.003874063491821289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008015632629394531
gen group dst list time:  0.0001456737518310547
time for parepare:  0.00023865699768066406
local_output_nid generation:  0.00021457672119140625
local_in_edges_tensor generation:  0.0006089210510253906
mini_batch_src_global generation:  0.0002994537353515625
r_  generation:  0.004090309143066406
local_output_nid generation:  0.00022149085998535156
local_in_edges_tensor generation:  0.0004668235778808594
mini_batch_src_global generation:  0.0003647804260253906
r_  generation:  0.0039789676666259766
----------------------check_connections_block total spend ----------------------------- 0.012274742126464844
generate_one_block  0.005074501037597656
generate_one_block  0.0042591094970703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007028579711914062
gen group dst list time:  0.00015807151794433594
time for parepare:  0.00024175643920898438
local_output_nid generation:  0.00022268295288085938
local_in_edges_tensor generation:  0.0006072521209716797
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.004174709320068359
local_output_nid generation:  0.00023746490478515625
local_in_edges_tensor generation:  0.0004658699035644531
mini_batch_src_global generation:  0.0003819465637207031
r_  generation:  0.0034034252166748047
----------------------check_connections_block total spend ----------------------------- 0.011745214462280273
generate_one_block  0.004738330841064453
generate_one_block  0.004754304885864258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

connection checking time:  0.04493427276611328
block generation total time  0.03971982002258301
average batch blocks generation time:  0.019859910011291504
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.018274307250976562  GigaBytes
Max Memory Allocated: 0.018274307250976562  GigaBytes

torch.Size([2487, 1433])
torch.Size([2451, 256])
torch.Size([2333, 256])
torch.Size([1984, 256])
torch.Size([1219, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.050859928131103516  GigaBytes
Max Memory Allocated: 0.05123281478881836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023976802825927734  GigaBytes
Max Memory Allocated: 0.05211496353149414  GigaBytes

torch.Size([2494, 1433])
torch.Size([2427, 256])
torch.Size([2255, 256])
torch.Size([1801, 256])
torch.Size([989, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.05409526824951172  GigaBytes
Max Memory Allocated: 0.054375648498535156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020293712615966797 |0.17560231685638428 |0.38569211959838867 |0.0001971721649169922 |0.009225130081176758 |0.0042705535888671875 |
----------------------------------------------------------pseudo_mini_loss sum 4.074545860290527
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21139
Number of first layer input nodes during this epoch:  4981
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.034768104553222656  GigaBytes
Max Memory Allocated: 0.054782867431640625  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005500316619873047
random selection method range initialization spend 0.0001277923583984375
time for parepare:  8.702278137207031e-05
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  2.3365020751953125e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00017762184143066406
----------------------check_connections_block total spend ----------------------------- 0.0011675357818603516
generate_one_block  0.00147247314453125
generate_one_block  0.0014386177062988281
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005693435668945312
gen group dst list time:  3.838539123535156e-05
time for parepare:  0.0001976490020751953
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0008063316345214844
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0008931159973144531
----------------------check_connections_block total spend ----------------------------- 0.0031621456146240234
generate_one_block  0.0023238658905029297
generate_one_block  0.002269744873046875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006740093231201172
gen group dst list time:  7.62939453125e-05
time for parepare:  0.00023698806762695312
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.00035881996154785156
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.0022318363189697266
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.0002872943878173828
r_  generation:  0.0022764205932617188
----------------------check_connections_block total spend ----------------------------- 0.007200717926025391
generate_one_block  0.0037407875061035156
generate_one_block  0.0037102699279785156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007348060607910156
gen group dst list time:  0.00011801719665527344
time for parepare:  0.00023818016052246094
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0002722740173339844
r_  generation:  0.003522157669067383
local_output_nid generation:  0.0001881122589111328
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.0003993511199951172
r_  generation:  0.0035102367401123047
----------------------check_connections_block total spend ----------------------------- 0.010993480682373047
generate_one_block  0.004773378372192383
generate_one_block  0.0038003921508789062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006949901580810547
gen group dst list time:  0.00014925003051757812
time for parepare:  0.0002391338348388672
local_output_nid generation:  0.000213623046875
local_in_edges_tensor generation:  0.00054931640625
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.0040967464447021484
local_output_nid generation:  0.0002281665802001953
local_in_edges_tensor generation:  0.0004603862762451172
mini_batch_src_global generation:  0.00042319297790527344
r_  generation:  0.004033803939819336
----------------------check_connections_block total spend ----------------------------- 0.012440204620361328
generate_one_block  0.00483393669128418
generate_one_block  0.004735469818115234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007054805755615234
gen group dst list time:  0.0001609325408935547
time for parepare:  0.00023818016052246094
local_output_nid generation:  0.00023245811462402344
local_in_edges_tensor generation:  0.0005533695220947266
mini_batch_src_global generation:  0.00029397010803222656
r_  generation:  0.00420379638671875
local_output_nid generation:  0.0002465248107910156
local_in_edges_tensor generation:  0.0004763603210449219
mini_batch_src_global generation:  0.0004343986511230469
r_  generation:  0.0041501522064208984
----------------------check_connections_block total spend ----------------------------- 0.012737751007080078
generate_one_block  0.005054473876953125
generate_one_block  0.004235982894897461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.034768104553222656  GigaBytes
Max Memory Allocated: 0.054782867431640625  GigaBytes

connection checking time:  0.04653429985046387
block generation total time  0.039478302001953125
average batch blocks generation time:  0.019739151000976562
block dataloader generation time/epoch 0.22866153717041016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03427839279174805  GigaBytes
Max Memory Allocated: 0.054782867431640625  GigaBytes

torch.Size([2510, 1433])
torch.Size([2467, 256])
torch.Size([2341, 256])
torch.Size([1893, 256])
torch.Size([1111, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.06633710861206055  GigaBytes
Max Memory Allocated: 0.06663656234741211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.034554481506347656  GigaBytes
Max Memory Allocated: 0.06726503372192383  GigaBytes

torch.Size([2499, 1433])
torch.Size([2453, 256])
torch.Size([2318, 256])
torch.Size([1924, 256])
torch.Size([1108, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06637763977050781  GigaBytes
Max Memory Allocated: 0.06726503372192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0038623809814453125 |0.001078486442565918 |0.007837414741516113 |0.00014257431030273438 |0.006798744201660156 |0.0029532909393310547 |
----------------------------------------------------------pseudo_mini_loss sum 2.9670908451080322
Total (block generation + training)time/epoch 0.27421116828918457
Training time/epoch 0.0451810359954834
Training time without block to device /epoch 0.04302406311035156
Training time without total dataloading part /epoch 0.03251075744628906
load block tensor time/epoch 0.007724761962890625
block to device time/epoch 0.002156972885131836
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21314
Number of first layer input nodes during this epoch:  5009
