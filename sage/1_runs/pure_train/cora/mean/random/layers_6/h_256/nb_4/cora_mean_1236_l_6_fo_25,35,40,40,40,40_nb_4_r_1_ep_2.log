main start at this time 1648433271.03031
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006778240203857422
random selection method range initialization spend 0.00016236305236816406
time for parepare:  6.985664367675781e-05
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0013413429260253906
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.818771362304688e-05
----------------------check_connections_block total spend ----------------------------- 0.0026276111602783203
generate_one_block  0.0013840198516845703
generate_one_block  0.0011916160583496094
generate_one_block  0.001138925552368164
generate_one_block  0.001149892807006836
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005335807800292969
gen group dst list time:  4.38690185546875e-05
time for parepare:  0.0001614093780517578
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00047779083251953125
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00046443939208984375
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0003612041473388672
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003838539123535156
----------------------check_connections_block total spend ----------------------------- 0.0033142566680908203
generate_one_block  0.0016617774963378906
generate_one_block  0.0016100406646728516
generate_one_block  0.0015168190002441406
generate_one_block  0.0015985965728759766
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006394386291503906
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0002849102020263672
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0013318061828613281
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.001363992691040039
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.0012583732604980469
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0011970996856689453
----------------------check_connections_block total spend ----------------------------- 0.008359193801879883
generate_one_block  0.002671480178833008
generate_one_block  0.0026755332946777344
generate_one_block  0.0023992061614990234
generate_one_block  0.0022325515747070312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007948875427246094
gen group dst list time:  0.0001404285430908203
time for parepare:  0.0002048015594482422
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0003952980041503906
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.003487825393676758
local_output_nid generation:  0.00036597251892089844
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.0005548000335693359
r_  generation:  0.002521991729736328
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.0004248619079589844
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.002220630645751953
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.0020694732666015625
----------------------check_connections_block total spend ----------------------------- 0.023226022720336914
generate_one_block  0.004178285598754883
generate_one_block  0.003527402877807617
generate_one_block  0.003743410110473633
generate_one_block  0.003438711166381836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016446113586425781
gen group dst list time:  0.00019931793212890625
time for parepare:  0.00021386146545410156
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.0010428428649902344
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.003158092498779297
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.00042057037353515625
mini_batch_src_global generation:  0.00033545494079589844
r_  generation:  0.003315448760986328
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0032210350036621094
local_output_nid generation:  0.0001537799835205078
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.0030736923217773438
----------------------check_connections_block total spend ----------------------------- 0.01981639862060547
generate_one_block  0.004418373107910156
generate_one_block  0.004363536834716797
generate_one_block  0.0039653778076171875
generate_one_block  0.003903627395629883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0010352134704589844
gen group dst list time:  0.00023365020751953125
time for parepare:  0.00043272972106933594
local_output_nid generation:  0.00018143653869628906
local_in_edges_tensor generation:  0.0005125999450683594
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.007276058197021484
local_output_nid generation:  0.0005698204040527344
local_in_edges_tensor generation:  0.0009667873382568359
mini_batch_src_global generation:  0.0008263587951660156
r_  generation:  0.00586247444152832
local_output_nid generation:  0.0003361701965332031
local_in_edges_tensor generation:  0.0005784034729003906
mini_batch_src_global generation:  0.00039458274841308594
r_  generation:  0.004812479019165039
local_output_nid generation:  0.0002961158752441406
local_in_edges_tensor generation:  0.0004494190216064453
mini_batch_src_global generation:  0.0002739429473876953
r_  generation:  0.003191232681274414
----------------------check_connections_block total spend ----------------------------- 0.03220677375793457
generate_one_block  0.010223388671875
generate_one_block  0.007931709289550781
generate_one_block  0.006166219711303711
generate_one_block  0.0052509307861328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

connection checking time:  0.08692264556884766
block generation total time  0.07747697830200195
average batch blocks generation time:  0.01936924457550049
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.018175125122070312  GigaBytes
Max Memory Allocated: 0.018175125122070312  GigaBytes

torch.Size([2476, 1433])
torch.Size([2396, 256])
torch.Size([2153, 256])
torch.Size([1557, 256])
torch.Size([726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.04474353790283203  GigaBytes
Max Memory Allocated: 0.04493904113769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02355480194091797  GigaBytes
Max Memory Allocated: 0.04579353332519531  GigaBytes

torch.Size([2429, 1433])
torch.Size([2369, 256])
torch.Size([2152, 256])
torch.Size([1580, 256])
torch.Size([762, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.05145883560180664  GigaBytes
Max Memory Allocated: 0.05165433883666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02379894256591797  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

torch.Size([2444, 1433])
torch.Size([2366, 256])
torch.Size([2131, 256])
torch.Size([1534, 256])
torch.Size([666, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.05063819885253906  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.023741722106933594  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

torch.Size([2466, 1433])
torch.Size([2363, 256])
torch.Size([2076, 256])
torch.Size([1432, 256])
torch.Size([666, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.050566673278808594  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01023876667022705 |0.08721643686294556 |0.19618993997573853 |0.00015294551849365234 |0.005899667739868164 |0.0041828155517578125 |
----------------------------------------------------------pseudo_mini_loss sum 3.8740835189819336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37474
Number of first layer input nodes during this epoch:  9815
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.034522056579589844  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00048089027404785156
random selection method range initialization spend 0.00012159347534179688
time for parepare:  7.319450378417969e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.723403930664062e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  8.535385131835938e-05
----------------------check_connections_block total spend ----------------------------- 0.0012507438659667969
generate_one_block  0.0011448860168457031
generate_one_block  0.0010924339294433594
generate_one_block  0.0011386871337890625
generate_one_block  0.0011153221130371094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004944801330566406
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.00017380714416503906
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0003643035888671875
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.00042176246643066406
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00038909912109375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004444122314453125
----------------------check_connections_block total spend ----------------------------- 0.0032732486724853516
generate_one_block  0.001466989517211914
generate_one_block  0.0016407966613769531
generate_one_block  0.0014584064483642578
generate_one_block  0.0015769004821777344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005958080291748047
gen group dst list time:  8.368492126464844e-05
time for parepare:  0.0001995563507080078
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0011928081512451172
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.0013298988342285156
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0011508464813232422
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0013267993927001953
----------------------check_connections_block total spend ----------------------------- 0.008333921432495117
generate_one_block  0.002445220947265625
generate_one_block  0.002551555633544922
generate_one_block  0.0023391246795654297
generate_one_block  0.0024700164794921875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007176399230957031
gen group dst list time:  0.00013947486877441406
time for parepare:  0.0001914501190185547
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.0004096031188964844
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0023272037506103516
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.0002551078796386719
r_  generation:  0.002496957778930664
local_output_nid generation:  0.00010943412780761719
local_in_edges_tensor generation: Using backend: pytorch
 0.00029158592224121094
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0022993087768554688
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.002454996109008789
----------------------check_connections_block total spend ----------------------------- 0.01487421989440918
generate_one_block  0.0036242008209228516
generate_one_block  0.003562450408935547
generate_one_block  0.003452777862548828
generate_one_block  0.0034363269805908203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007665157318115234
gen group dst list time:  0.0001971721649169922
time for parepare:  0.00019073486328125
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0004525184631347656
mini_batch_src_global generation:  0.00026988983154296875
r_  generation:  0.0030851364135742188
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003604888916015625
mini_batch_src_global generation:  0.0003261566162109375
r_  generation:  0.0031964778900146484
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.003064870834350586
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.0002529621124267578
r_  generation:  0.003039836883544922
----------------------check_connections_block total spend ----------------------------- 0.01859569549560547
generate_one_block  0.004521369934082031
generate_one_block  0.004137754440307617
generate_one_block  0.0040018558502197266
generate_one_block  0.0039598941802978516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007681846618652344
gen group dst list time:  0.00023555755615234375
time for parepare:  0.0001888275146484375
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0005166530609130859
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.003435373306274414
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.00039458274841308594
mini_batch_src_global generation:  0.00032138824462890625
r_  generation:  0.0033254623413085938
local_output_nid generation:  0.00017189979553222656
local_in_edges_tensor generation:  0.0004112720489501953
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.0033111572265625
local_output_nid generation:  0.0001747608184814453
local_in_edges_tensor generation:  0.0003924369812011719
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0032455921173095703
----------------------check_connections_block total spend ----------------------------- 0.019986629486083984
generate_one_block  0.004467010498046875
generate_one_block  0.004480600357055664
generate_one_block  0.0041620731353759766
generate_one_block  0.004108428955078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.034522056579589844  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

connection checking time:  0.0650637149810791
block generation total time  0.06386375427246094
average batch blocks generation time:  0.015965938568115234
block dataloader generation time/epoch 0.15439343452453613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03407478332519531  GigaBytes
Max Memory Allocated: 0.05207633972167969  GigaBytes

torch.Size([2478, 1433])
torch.Size([2397, 256])
torch.Size([2163, 256])
torch.Size([1496, 256])
torch.Size([660, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.06084585189819336  GigaBytes
Max Memory Allocated: 0.061002254486083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.03452777862548828  GigaBytes
Max Memory Allocated: 0.06143474578857422  GigaBytes

torch.Size([2475, 1433])
torch.Size([2397, 256])
torch.Size([2204, 256])
torch.Size([1590, 256])
torch.Size([753, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.06278133392333984  GigaBytes
Max Memory Allocated: 0.06293964385986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03400707244873047  GigaBytes
Max Memory Allocated: 0.06353998184204102  GigaBytes

torch.Size([2465, 1433])
torch.Size([2377, 256])
torch.Size([2080, 256])
torch.Size([1434, 256])
torch.Size([622, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.05992555618286133  GigaBytes
Max Memory Allocated: 0.06353998184204102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.034523963928222656  GigaBytes
Max Memory Allocated: 0.06353998184204102  GigaBytes

torch.Size([2428, 1433])
torch.Size([2359, 256])
torch.Size([2123, 256])
torch.Size([1561, 256])
torch.Size([742, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.061763763427734375  GigaBytes
Max Memory Allocated: 0.06353998184204102  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027976632118225098 |0.0009829998016357422 |0.007218778133392334 |0.00012171268463134766 |0.005596637725830078 |0.006108522415161133 |
----------------------------------------------------------pseudo_mini_loss sum 3.259934663772583
Total (block generation + training)time/epoch 0.23227405548095703
Training time/epoch 0.07763290405273438
Training time without block to device /epoch 0.0737009048461914
Training time without total dataloading part /epoch 0.05785703659057617
load block tensor time/epoch 0.011190652847290039
block to device time/epoch 0.003931999206542969
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37526
Number of first layer input nodes during this epoch:  9846
