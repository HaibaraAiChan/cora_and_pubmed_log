main start at this time 1648433122.8916085
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014698505401611328
random selection method range initialization spend 0.00020885467529296875
time for parepare:  5.91278076171875e-05
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0019953250885009766
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  3.0040740966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.003955841064453125
generate_one_block  0.0013365745544433594
generate_one_block  0.0010056495666503906
generate_one_block  0.0010540485382080078
generate_one_block  0.0010051727294921875
generate_one_block  0.0010063648223876953
generate_one_block  0.0010068416595458984
generate_one_block  0.0010080337524414062
generate_one_block  0.001009225845336914
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004673004150390625
gen group dst list time:  5.555152893066406e-05
time for parepare:  0.0001277923583984375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00020265579223632812
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00021910667419433594
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002636909484863281
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002624988555908203
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021123886108398438
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015401840209960938
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00015878677368164062
----------------------check_connections_block total spend ----------------------------- 0.003820180892944336
generate_one_block  0.0012230873107910156
generate_one_block  0.0012469291687011719
generate_one_block  0.0012142658233642578
generate_one_block  0.0012829303741455078
generate_one_block  0.0013000965118408203
generate_one_block  0.001203298568725586
generate_one_block  0.001222848892211914
generate_one_block  0.0011675357818603516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006678104400634766
gen group dst list time:  9.226799011230469e-05
time for parepare:  0.00018072128295898438
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0006000995635986328
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0008215904235839844
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007717609405517578
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0008203983306884766
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0007774829864501953
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0007565021514892578
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005676746368408203
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0006043910980224609
----------------------check_connections_block total spend ----------------------------- 0.009830474853515625
generate_one_block  0.0017430782318115234
generate_one_block  0.0018458366394042969
generate_one_block  0.0018706321716308594
generate_one_block  0.0019431114196777344
generate_one_block  0.0018014907836914062
generate_one_block  0.0019257068634033203
generate_one_block  0.0016055107116699219
generate_one_block  0.0016186237335205078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007607936859130859
gen group dst list time:  0.00019097328186035156
time for parepare:  0.00018453598022460938
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0015006065368652344
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.0017194747924804688
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0017654895782470703
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0018186569213867188
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.001627206802368164
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00024247169494628906
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0017254352569580078
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0014591217041015625
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0016109943389892578
----------------------check_connections_block total spend ----------------------------- 0.020510196685791016
generate_one_block  0.0027360916137695312
generate_one_block  0.0029163360595703125
generate_one_block  0.0028891563415527344
generate_one_block  0.0029244422912597656
generate_one_block  0.0029790401458740234
generate_one_block  0.0028085708618164062
generate_one_block  0.002596616744995117
generate_one_block  0.0027959346771240234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007352828979492188
gen group dst list time:  0.0002968311309814453
time for parepare:  0.0001747608184814453
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0004374980926513672
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0024454593658447266
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.0002684593200683594
r_  generation:  0.0025589466094970703
local_output_nid generation:  0.00012683868408203125
local_in_edges_tensor generation:  0.0002982616424560547
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.0026035308837890625
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0026094913482666016
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.0024957656860351562
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.0024662017822265625
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0002803802490234375
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.0023331642150878906
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.0025017261505126953
----------------------check_connections_block total spend ----------------------------- 0.030087709426879883
generate_one_block  0.004391670227050781
generate_one_block  0.0037419795989990234
generate_one_block  0.0037593841552734375
generate_one_block  0.004205226898193359
generate_one_block  0.003688335418701172
generate_one_block  0.0037567615509033203
generate_one_block  0.0035872459411621094
generate_one_block  0.004491329193115234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007598400115966797
gen group dst list time:  0.0004248619079589844
time for parepare:  0.00017762184143066406
local_output_nid generation:  0.0001404285430908203
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.0028460025787353516
local_output_nid generation:  0.0001785755157470703
local_in_edges_tensor generation:  0.0003600120544433594
mini_batch_src_global generation:  0.00030875205993652344
r_  generation:  0.002973794937133789
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0029392242431640625
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.0028846263885498047
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.000339508056640625
mini_batch_src_global generation:  0.0002384185791015625
r_  generation:  0.002882719039916992
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.002847909927368164
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.0003249645233154297
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0028133392333984375
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.002902507781982422
----------------------check_connections_block total spend ----------------------------- 0.03455018997192383
generate_one_block  0.004045724868774414
generate_one_block  0.004092693328857422
generate_one_block  0.005105733871459961
generate_one_block  0.003970146179199219
generate_one_block  0.0039670467376708984
generate_one_block  0.003992319107055664
generate_one_block  0.00395965576171875
generate_one_block  0.004065036773681641
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

connection checking time:  0.09879875183105469
block generation total time  0.11168146133422852
average batch blocks generation time:  0.013960182666778564
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.013020038604736328  GigaBytes
Max Memory Allocated: 0.013020038604736328  GigaBytes

torch.Size([2368, 1433])
torch.Size([2216, 16])
torch.Size([1753, 16])
torch.Size([1009, 16])
torch.Size([362, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.014507770538330078  GigaBytes
Max Memory Allocated: 0.014511585235595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014247417449951172  GigaBytes
Max Memory Allocated: 0.026692867279052734  GigaBytes

torch.Size([2415, 1433])
torch.Size([2251, 16])
torch.Size([1821, 16])
torch.Size([1106, 16])
torch.Size([425, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015810012817382812  GigaBytes
Max Memory Allocated: 0.026692867279052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014252185821533203  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2403, 1433])
torch.Size([2264, 16])
torch.Size([1870, 16])
torch.Size([1143, 16])
torch.Size([456, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015850067138671875  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01313018798828125  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2351, 1433])
torch.Size([2209, 16])
torch.Size([1854, 16])
torch.Size([1163, 16])
torch.Size([479, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014726638793945312  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013115882873535156  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2350, 1433])
torch.Size([2186, 16])
torch.Size([1751, 16])
torch.Size([1042, 16])
torch.Size([412, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0146331787109375  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014246463775634766  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2392, 1433])
torch.Size([2228, 16])
torch.Size([1803, 16])
torch.Size([1087, 16])
torch.Size([452, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015799522399902344  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013226509094238281  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2373, 1433])
torch.Size([2181, 16])
torch.Size([1687, 16])
torch.Size([923, 16])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014644145965576172  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014238834381103516  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2422, 1433])
torch.Size([2261, 16])
torch.Size([1826, 16])
torch.Size([974, 16])
torch.Size([308, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01572418212890625  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011912733316421509 |0.04426094889640808 |0.10154053568840027 |0.0001430511474609375 |0.005094707012176514 |0.003834962844848633 |
----------------------------------------------------------pseudo_mini_loss sum 3.4806246757507324
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63669
Number of first layer input nodes during this epoch:  19074
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015036582946777344  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00044655799865722656
random selection method range initialization spend 0.00010943412780761719
time for parepare:  6.365776062011719e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.1021575927734375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0279159545898438e-05
----------------------check_connections_block total spend ----------------------------- 0.0017766952514648438
generate_one_block  0.0010738372802734375
generate_one_block  0.0010128021240234375
generate_one_block  0.0009810924530029297
generate_one_block  0.0010151863098144531
generate_one_block  0.0009706020355224609
generate_one_block  0.0009851455688476562
generate_one_block  0.0010373592376708984
generate_one_block  0.001004934310913086
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004608631134033203
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.0001480579376220703
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00018262863159179688
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00025963783264160156
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00018739700317382812
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017523765563964844
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00022554397583007812
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00029730796813964844
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00019741058349609375
----------------------check_connections_block total spend ----------------------------- 0.004016876220703125
generate_one_block  0.0013308525085449219
generate_one_block  0.001329183578491211
generate_one_block  0.0012102127075195312
generate_one_block  0.0011475086212158203
generate_one_block  0.0012023448944091797
generate_one_block  0.0012018680572509766
generate_one_block  0.0012929439544677734
generate_one_block  0.0012392997741699219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005841255187988281
gen group dst list time:  9.775161743164062e-05
time for parepare:  0.000186920166015625
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005829334259033203
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0008077621459960938
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0007026195526123047
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005435943603515625
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005664825439453125
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006892681121826172
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0008401870727539062
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006527900695800781
----------------------check_connections_block total spend ----------------------------- 0.009440898895263672
generate_one_block  0.0017654895782470703
generate_one_block  0.0018756389617919922
generate_one_block  0.0018153190612792969
generate_one_block  0.001590728759765625
generate_one_block  0.0016312599182128906
generate_one_block  0.0018699169158935547
generate_one_block  0.0019588470458984375
generate_one_block  0.0017516613006591797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007154941558837891
gen group dst list time:  0.00017786026000976562
time for parepare:  0.0001876354217529297
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0015232563018798828
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00023698806762695312
r_  generation:  0.001958131790161133
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.0014672279357910156
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.00133514404296875
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.001468658447265625
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.00167083740234375
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.00023055076599121094
mini_batch_src_global generation:  0.00016379356384277344
r_  generation:  0.0017893314361572266
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0016644001007080078
----------------------check_connections_block total spend ----------------------------- 0.020117998123168945
generate_one_block  0.0028934478759765625
generate_one_block  0.003091096878051758
generate_one_block  0.0026443004608154297
generate_one_block  0.0024759769439697266
generate_one_block  0.002661466598510742
generate_one_block  0.002875804901123047
generate_one_block  0.0029366016387939453
generate_one_block  0.0028052330017089844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007619857788085938
gen group dst list time:  0.0003097057342529297
time for parepare:  0.0001780986785888672
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.002424478530883789
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00031280517578125
r_  generation:  0.002686738967895508
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation:  0.0002918243408203125
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.002305269241333008
local_output_nid generation:  0.00012421607971191406
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.002273082733154297
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.0003261566162109375
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0024716854095458984
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.0025577545166015625
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation:  0.00022935867309570312
r_  generation:  0.0026214122772216797
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.0025184154510498047
----------------------check_connections_block total spend ----------------------------- 0.03033614158630371
generate_one_block  0.0040740966796875
generate_one_block  0.004178524017333984
generate_one_block  0.003439188003540039
generate_one_block  0.00354766845703125
generate_one_block  0.003681182861328125
generate_one_block  0.0041615962982177734
generate_one_block  0.003922462463378906
generate_one_block  0.0037567615509033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007808208465576172
gen group dst list time:  0.00042724609375
time for parepare:  0.00017762184143066406
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.0004818439483642578
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.0029129981994628906
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.0003178119659423828
r_  generation:  0.003132343292236328
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.002840280532836914
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0030117034912109375
local_output_nid generation:  0.00016951560974121094
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.003064870834350586
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.002908468246459961
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation: Using backend: pytorch
 0.0003483295440673828
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.002984762191772461
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0029380321502685547
----------------------check_connections_block total spend ----------------------------- 0.03559422492980957
generate_one_block  0.004589557647705078
generate_one_block  0.004296541213989258
generate_one_block  0.003902435302734375
generate_one_block  0.0040628910064697266
generate_one_block  0.004082679748535156
generate_one_block  0.004083871841430664
generate_one_block  0.004461765289306641
generate_one_block  0.004155874252319336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015036582946777344  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

connection checking time:  0.09950613975524902
block generation total time  0.11099410057067871
average batch blocks generation time:  0.013874262571334839
block dataloader generation time/epoch 0.24498414993286133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014603137969970703  GigaBytes
Max Memory Allocated: 0.028092384338378906  GigaBytes

torch.Size([2384, 1433])
torch.Size([2183, 16])
torch.Size([1737, 16])
torch.Size([995, 16])
torch.Size([352, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016065120697021484  GigaBytes
Max Memory Allocated: 0.028092384338378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014627933502197266  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2454, 1433])
torch.Size([2326, 16])
torch.Size([1956, 16])
torch.Size([1224, 16])
torch.Size([435, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016289234161376953  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01322174072265625  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2303, 1433])
torch.Size([2063, 16])
torch.Size([1622, 16])
torch.Size([944, 16])
torch.Size([386, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014622211456298828  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013581275939941406  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2371, 1433])
torch.Size([2172, 16])
torch.Size([1629, 16])
torch.Size([814, 16])
torch.Size([316, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014946460723876953  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014605998992919922  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2407, 1433])
torch.Size([2258, 16])
torch.Size([1795, 16])
torch.Size([974, 16])
torch.Size([336, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016088485717773438  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014614582061767578  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2414, 1433])
torch.Size([2243, 16])
torch.Size([1871, 16])
torch.Size([1075, 16])
torch.Size([388, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01616954803466797  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014627933502197266  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2450, 1433])
torch.Size([2320, 16])
torch.Size([1944, 16])
torch.Size([1151, 16])
torch.Size([505, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016282081604003906  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014614582061767578  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2421, 1433])
torch.Size([2285, 16])
torch.Size([1849, 16])
torch.Size([1043, 16])
torch.Size([409, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016162395477294922  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003828376531600952 |0.0009423196315765381 |0.006984680891036987 |0.00010758638381958008 |0.00614282488822937 |0.0025272369384765625 |
----------------------------------------------------------pseudo_mini_loss sum 3.2184135913848877
Total (block generation + training)time/epoch 0.40052270889282227
Training time/epoch 0.15521717071533203
Training time without block to device /epoch 0.14767861366271973
Training time without total dataloading part /epoch 0.10840797424316406
load block tensor time/epoch 0.030627012252807617
block to device time/epoch 0.007538557052612305
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  63551
Number of first layer input nodes during this epoch:  19204
