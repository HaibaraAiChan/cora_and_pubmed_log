main start at this time 1648433104.4609644
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006899833679199219
random selection method range initialization spend 0.00017642974853515625
time for parepare:  6.461143493652344e-05
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0012562274932861328
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00012683868408203125
----------------------check_connections_block total spend ----------------------------- 0.0021572113037109375
generate_one_block  0.0015106201171875
generate_one_block  0.001283407211303711
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005106925964355469
gen group dst list time:  3.1948089599609375e-05
time for parepare:  0.0001418590545654297
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0007336139678955078
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007214546203613281
----------------------check_connections_block total spend ----------------------------- 0.002624988555908203
generate_one_block  0.004761934280395508
generate_one_block  0.0019257068634033203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009512901306152344
gen group dst list time:  6.175041198730469e-05
time for parepare:  0.00018644332885742188
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.001920461654663086
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0001838207244873047
r_  generation:  0.0018243789672851562
----------------------check_connections_block total spend ----------------------------- 0.005948066711425781
generate_one_block  0.0032439231872558594
generate_one_block  0.0031163692474365234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006396770477294922
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.00019311904907226562
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0004169940948486328
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.0028977394104003906
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0028839111328125
----------------------check_connections_block total spend ----------------------------- 0.008759498596191406
generate_one_block  0.005030632019042969
generate_one_block  0.004057645797729492
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007359981536865234
gen group dst list time:  0.00011801719665527344
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.0004894733428955078
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0033347606658935547
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.0034012794494628906
----------------------check_connections_block total spend ----------------------------- 0.010088920593261719
generate_one_block  0.004575014114379883
generate_one_block  0.004343748092651367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007050037384033203
gen group dst list time:  0.00012826919555664062
time for parepare:  0.00019478797912597656
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.00023412704467773438
r_  generation:  0.0034410953521728516
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.00039076805114746094
mini_batch_src_global generation:  0.0003044605255126953
r_  generation:  0.003464937210083008
----------------------check_connections_block total spend ----------------------------- 0.01036691665649414
generate_one_block  0.004757881164550781
generate_one_block  0.005369424819946289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

connection checking time:  0.03778839111328125
block generation total time  0.04118227958679199
average batch blocks generation time:  0.020591139793395996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014134883880615234  GigaBytes
Max Memory Allocated: 0.014134883880615234  GigaBytes

torch.Size([2495, 1433])
torch.Size([2439, 16])
torch.Size([2310, 16])
torch.Size([1920, 16])
torch.Size([1165, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.016411781311035156  GigaBytes
Max Memory Allocated: 0.016425609588623047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014320850372314453  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

torch.Size([2495, 1433])
torch.Size([2458, 16])
torch.Size([2338, 16])
torch.Size([1871, 16])
torch.Size([1074, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01656818389892578  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007180929183959961 |0.17004632949829102 |0.3884481191635132 |0.00021588802337646484 |0.00667417049407959 |0.0037572383880615234 |
----------------------------------------------------------pseudo_mini_loss sum 3.1168079376220703
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21270
Number of first layer input nodes during this epoch:  4990
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015299320220947266  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005972385406494141
random selection method range initialization spend 0.0001590251922607422
time for parepare:  0.00010180473327636719
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00018167495727539062
local_output_nid generation: Using backend: pytorch
 2.47955322265625e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0001513957977294922
----------------------check_connections_block total spend ----------------------------- 0.0012545585632324219
generate_one_block  0.0015287399291992188
generate_one_block  0.0014462471008300781
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00021600723266601562
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0008203983306884766
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0008912086486816406
----------------------check_connections_block total spend ----------------------------- 0.003270387649536133
generate_one_block  0.0023393630981445312
generate_one_block  0.002292633056640625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007090568542480469
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.00024437904357910156
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.00036644935607910156
mini_batch_src_global generation:  0.00024080276489257812
r_  generation:  0.002136707305908203
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003097057342529297
mini_batch_src_global generation:  0.00034737586975097656
r_  generation:  0.0023860931396484375
----------------------check_connections_block total spend ----------------------------- 0.007361412048339844
generate_one_block  0.0036613941192626953
generate_one_block  0.003742218017578125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007491111755371094
gen group dst list time:  0.00012254714965820312
time for parepare:  0.000240325927734375
local_output_nid generation:  0.00016570091247558594
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0002694129943847656
r_  generation:  0.0034084320068359375
local_output_nid generation:  0.0001888275146484375
local_in_edges_tensor generation:  0.0004134178161621094
mini_batch_src_global generation:  0.00041222572326660156
r_  generation:  0.0036416053771972656
----------------------check_connections_block total spend ----------------------------- 0.011057615280151367
generate_one_block  0.00467681884765625
generate_one_block  0.003821849822998047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007197856903076172
gen group dst list time:  0.00015616416931152344
time for parepare:  0.0002396106719970703
local_output_nid generation:  0.00020360946655273438
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.0002868175506591797
r_  generation:  0.004010200500488281
local_output_nid generation:  0.00022912025451660156
local_in_edges_tensor generation:  0.00047016143798828125
mini_batch_src_global generation:  0.00042700767517089844
r_  generation:  0.004118919372558594
----------------------check_connections_block total spend ----------------------------- 0.012353658676147461
generate_one_block  0.004886150360107422
generate_one_block  0.006372690200805664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009577274322509766
gen group dst list time:  0.00017142295837402344
time for parepare:  0.00025653839111328125
local_output_nid generation:  0.00023436546325683594
local_in_edges_tensor generation:  0.0006210803985595703
mini_batch_src_global generation:  0.00039887428283691406
r_  generation:  0.0044023990631103516
local_output_nid generation:  0.0002224445343017578
local_in_edges_tensor generation:  0.0005204677581787109
mini_batch_src_global generation:  0.0004723072052001953
r_  generation:  0.00360107421875
----------------------check_connections_block total spend ----------------------------- 0.012791872024536133
generate_one_block  0.005078792572021484
generate_one_block  0.004414796829223633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015299320220947266  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

connection checking time:  0.04683494567871094
block generation total time  0.04128670692443848
average batch blocks generation time:  0.02064335346221924
block dataloader generation time/epoch 0.11181783676147461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014682292938232422  GigaBytes
Max Memory Allocated: 0.028094768524169922  GigaBytes

torch.Size([2485, 1433])
torch.Size([2417, 16])
torch.Size([2244, 16])
torch.Size([1809, 16])
torch.Size([1031, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016860008239746094  GigaBytes
Max Memory Allocated: 0.028094768524169922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014696598052978516  GigaBytes
Max Memory Allocated: 0.028095722198486328  GigaBytes

torch.Size([2507, 1433])
torch.Size([2466, 16])
torch.Size([2352, 16])
torch.Size([1951, 16])
torch.Size([1172, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01699972152709961  GigaBytes
Max Memory Allocated: 0.028095722198486328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0042171478271484375 |0.0008938312530517578 |0.006341099739074707 |0.00012981891632080078 |0.006828784942626953 |0.0028438568115234375 |
----------------------------------------------------------pseudo_mini_loss sum 3.5511269569396973
Total (block generation + training)time/epoch 0.15413379669189453
Training time/epoch 0.04203438758850098
Training time without block to device /epoch 0.04024672508239746
Training time without total dataloading part /epoch 0.02944326400756836
load block tensor time/epoch 0.008434295654296875
block to device time/epoch 0.0017876625061035156
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21127
Number of first layer input nodes during this epoch:  4992
