main start at this time 1648433113.3374825
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011944770812988281
random selection method range initialization spend 0.00020360946655273438
time for parepare:  6.556510925292969e-05
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0023298263549804688
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.602836608886719e-05
----------------------check_connections_block total spend ----------------------------- 0.003606081008911133
generate_one_block  0.0014691352844238281
generate_one_block  0.001127481460571289
generate_one_block  0.001115560531616211
generate_one_block  0.0010943412780761719
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005078315734863281
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.00014638900756835938
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003802776336669922
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00045609474182128906
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0004601478576660156
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00035572052001953125
----------------------check_connections_block total spend ----------------------------- 0.003208637237548828
generate_one_block  0.0015058517456054688
generate_one_block  0.0015645027160644531
generate_one_block  0.0015716552734375
generate_one_block  0.0014979839324951172
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00058746337890625
gen group dst list time:  8.487701416015625e-05
time for parepare:  0.00017523765563964844
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0011560916900634766
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0013720989227294922
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.00130462646484375
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.001196146011352539
----------------------check_connections_block total spend ----------------------------- 0.008092403411865234
generate_one_block  0.002401113510131836
generate_one_block  0.0026187896728515625
generate_one_block  0.0024871826171875
generate_one_block  0.002236604690551758
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007464885711669922
gen group dst list time:  0.00013518333435058594
time for parepare:  0.0001881122589111328
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.00042176246643066406
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0023047924041748047
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.002415180206298828
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation:  0.0002892017364501953
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.002417325973510742
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0024046897888183594
----------------------check_connections_block total spend ----------------------------- 0.014519691467285156
generate_one_block  0.0034461021423339844
generate_one_block  0.003345012664794922
generate_one_block  0.0035104751586914062
generate_one_block  0.0033431053161621094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007407665252685547
gen group dst list time:  0.0001888275146484375
time for parepare:  0.00019073486328125
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.00048804283142089844
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.003045797348022461
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.003065347671508789
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.0031135082244873047
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.0003631114959716797
mini_batch_src_global generation:  0.0002675056457519531
r_  generation:  0.003193378448486328
----------------------check_connections_block total spend ----------------------------- 0.018678903579711914
generate_one_block  0.004105329513549805
generate_one_block  0.0038976669311523438
generate_one_block  0.003935337066650391
generate_one_block  0.0039675235748291016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007328987121582031
gen group dst list time:  0.00022149085998535156
time for parepare:  0.00020384788513183594
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.0004928112030029297
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0033435821533203125
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0003428459167480469
r_  generation:  0.0032858848571777344
local_output_nid generation:  0.0001704692840576172
local_in_edges_tensor generation:  0.0003771781921386719
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0033371448516845703
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.0003829002380371094
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0033965110778808594
----------------------check_connections_block total spend ----------------------------- 0.019930601119995117
generate_one_block  0.005228519439697266
generate_one_block  0.004226207733154297
generate_one_block  0.004221916198730469
generate_one_block  0.0042302608489990234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

connection checking time:  0.06443023681640625
block generation total time  0.06334114074707031
average batch blocks generation time:  0.015835285186767578
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014088630676269531  GigaBytes
Max Memory Allocated: 0.014088630676269531  GigaBytes

torch.Size([2448, 1433])
torch.Size([2344, 16])
torch.Size([2061, 16])
torch.Size([1450, 16])
torch.Size([653, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.015933513641357422  GigaBytes
Max Memory Allocated: 0.015940189361572266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014285087585449219  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

torch.Size([2425, 1433])
torch.Size([2334, 16])
torch.Size([2101, 16])
torch.Size([1541, 16])
torch.Size([767, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016202449798583984  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014286041259765625  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

torch.Size([2440, 1433])
torch.Size([2349, 16])
torch.Size([2114, 16])
torch.Size([1518, 16])
torch.Size([729, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01619863510131836  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0142822265625  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

torch.Size([2480, 1433])
torch.Size([2397, 16])
torch.Size([2169, 16])
torch.Size([1508, 16])
torch.Size([658, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016181468963623047  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016220390796661377 |0.08521270751953125 |0.19488680362701416 |0.00016891956329345703 |0.005170941352844238 |0.003602266311645508 |
----------------------------------------------------------pseudo_mini_loss sum 3.419255256652832
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37220
Number of first layer input nodes during this epoch:  9793
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015176773071289062  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005097389221191406
random selection method range initialization spend 0.00014710426330566406
time for parepare:  9.655952453613281e-05
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.224082946777344e-05
----------------------check_connections_block total spend ----------------------------- 0.0013470649719238281
generate_one_block  0.0011386871337890625
generate_one_block  0.0010869503021240234
generate_one_block  0.001077413558959961
generate_one_block  0.0011012554168701172
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004999637603759766
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.00016450881958007812
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004050731658935547
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00036334991455078125
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00035381317138671875
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004858970642089844
----------------------check_connections_block total spend ----------------------------- 0.0032188892364501953
generate_one_block  0.0015132427215576172
generate_one_block  0.001516580581665039
generate_one_block  0.0014500617980957031
generate_one_block  0.0016150474548339844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000598907470703125
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.00019669532775878906
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0002868175506591797
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.001194000244140625
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.001066446304321289
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.001110076904296875
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0014948844909667969
----------------------check_connections_block total spend ----------------------------- 0.008010149002075195
generate_one_block  0.0024492740631103516
generate_one_block  0.0022690296173095703
generate_one_block  0.0022690296173095703
generate_one_block  0.0025250911712646484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007381439208984375
gen group dst list time:  0.00013566017150878906
time for parepare:  0.00019121170043945312
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0003917217254638672
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.0023756027221679688
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  0.00022125244140625
r_  generation:  0.0020821094512939453
local_output_nid generation:  0.00011157989501953125
local_in_edges_tensor generation: Using backend: pytorch
 0.0002846717834472656
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0023751258850097656
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0025453567504882812
----------------------check_connections_block total spend ----------------------------- 0.01443171501159668
generate_one_block  0.0036280155181884766
generate_one_block  0.003149747848510742
generate_one_block  0.003544330596923828
generate_one_block  0.0035614967346191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007910728454589844
gen group dst list time:  0.00019240379333496094
time for parepare:  0.00019216537475585938
local_output_nid generation:  0.00014281272888183594
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0030417442321777344
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.0003113746643066406
r_  generation:  0.002888202667236328
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.00025463104248046875
r_  generation:  0.0030944347381591797
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.00026726722717285156
r_  generation:  0.0031366348266601562
----------------------check_connections_block total spend ----------------------------- 0.018317699432373047
generate_one_block  0.004335641860961914
generate_one_block  0.0039119720458984375
generate_one_block  0.004015922546386719
generate_one_block  0.004027366638183594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008008480072021484
gen group dst list time:  0.0002243518829345703
time for parepare:  0.00019860267639160156
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.0005133152008056641
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.003268003463745117
local_output_nid generation:  0.0001685619354248047
local_in_edges_tensor generation:  0.00037932395935058594
mini_batch_src_global generation:  0.0002970695495605469
r_  generation:  0.003154277801513672
local_output_nid generation:  0.00017118453979492188
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.00328826904296875
local_output_nid generation:  0.00017213821411132812
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.00027823448181152344
r_  generation:  0.0033082962036132812
----------------------check_connections_block total spend ----------------------------- 0.019464731216430664
generate_one_block  0.0047795772552490234
generate_one_block  0.004134178161621094
generate_one_block  0.004160642623901367
generate_one_block  0.004189252853393555
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015176773071289062  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

connection checking time:  0.06344318389892578
block generation total time  0.06304550170898438
average batch blocks generation time:  0.015761375427246094
block dataloader generation time/epoch 0.15215229988098145
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014654159545898438  GigaBytes
Max Memory Allocated: 0.02809286117553711  GigaBytes

torch.Size([2481, 1433])
torch.Size([2380, 16])
torch.Size([2133, 16])
torch.Size([1541, 16])
torch.Size([671, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01656484603881836  GigaBytes
Max Memory Allocated: 0.02809286117553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014637947082519531  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

torch.Size([2393, 1433])
torch.Size([2280, 16])
torch.Size([1979, 16])
torch.Size([1317, 16])
torch.Size([597, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01638507843017578  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014650344848632812  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

torch.Size([2465, 1433])
torch.Size([2394, 16])
torch.Size([2162, 16])
torch.Size([1501, 16])
torch.Size([623, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016534805297851562  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014668464660644531  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

torch.Size([2488, 1433])
torch.Size([2420, 16])
torch.Size([2209, 16])
torch.Size([1678, 16])
torch.Size([867, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016708850860595703  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037900805473327637 |0.0008668303489685059 |0.006399273872375488 |0.00011372566223144531 |0.005115211009979248 |0.0024933815002441406 |
----------------------------------------------------------pseudo_mini_loss sum 3.360222339630127
Total (block generation + training)time/epoch 0.2245645523071289
Training time/epoch 0.07192301750183105
Training time without block to device /epoch 0.06845569610595703
Training time without total dataloading part /epoch 0.04900622367858887
load block tensor time/epoch 0.015160322189331055
block to device time/epoch 0.0034673213958740234
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37311
Number of first layer input nodes during this epoch:  9827
