main start at this time 1648433231.4643295
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013937950134277344
random selection method range initialization spend 0.0001766681671142578
time for parepare:  6.461143493652344e-05
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.002226591110229492
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.413459777832031e-05
----------------------check_connections_block total spend ----------------------------- 0.003524303436279297
generate_one_block  0.0015664100646972656
generate_one_block  0.0011057853698730469
generate_one_block  0.0011184215545654297
generate_one_block  0.001135110855102539
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00048041343688964844
gen group dst list time:  3.7670135498046875e-05
time for parepare:  0.0001354217529296875
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00032973289489746094
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00039696693420410156
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003802776336669922
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004458427429199219
----------------------check_connections_block total spend ----------------------------- 0.0030112266540527344
generate_one_block  0.001434326171875
generate_one_block  0.0015201568603515625
generate_one_block  0.0014524459838867188
generate_one_block  0.0015728473663330078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000598907470703125
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0010042190551757812
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0012445449829101562
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0010559558868408203
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.0012998580932617188
----------------------check_connections_block total spend ----------------------------- 0.0075609683990478516
generate_one_block  0.0023250579833984375
generate_one_block  0.002458810806274414
generate_one_block  0.002168893814086914
generate_one_block  0.0024683475494384766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007166862487792969
gen group dst list time:  0.0001251697540283203
time for parepare:  0.00017571449279785156
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.00214385986328125
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.002364635467529297
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.0021240711212158203
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0002770423889160156
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.002397775650024414
----------------------check_connections_block total spend ----------------------------- 0.013697385787963867
generate_one_block  0.0033969879150390625
generate_one_block  0.0034890174865722656
generate_one_block  0.0034046173095703125
generate_one_block  0.0038864612579345703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007476806640625
gen group dst list time:  0.00017714500427246094
time for parepare:  0.00018262863159179688
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.0004515647888183594
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.002991914749145508
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003371238708496094
mini_batch_src_global generation:  0.0003001689910888672
r_  generation:  0.0030629634857177734
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.002904653549194336
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002999544143676758
----------------------check_connections_block total spend ----------------------------- 0.017714977264404297
generate_one_block  0.0041272640228271484
generate_one_block  0.004202365875244141
generate_one_block  0.004057168960571289
generate_one_block  0.004204750061035156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007686614990234375
gen group dst list time:  0.00021338462829589844
time for parepare:  0.00019598007202148438
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.0030777454376220703
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0003170967102050781
r_  generation:  0.0031054019927978516
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.00034809112548828125
mini_batch_src_global generation:  0.0002491474151611328
r_  generation:  0.0030660629272460938
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.0003497600555419922
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.003074169158935547
----------------------check_connections_block total spend ----------------------------- 0.018456220626831055
generate_one_block  0.005018472671508789
generate_one_block  0.004358053207397461
generate_one_block  0.004133701324462891
generate_one_block  0.004125833511352539
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

connection checking time:  0.060440778732299805
block generation total time  0.06380558013916016
average batch blocks generation time:  0.01595139503479004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01577281951904297  GigaBytes
Max Memory Allocated: 0.01577281951904297  GigaBytes

torch.Size([2441, 1433])
torch.Size([2357, 128])
torch.Size([2102, 128])
torch.Size([1467, 128])
torch.Size([612, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.028554916381835938  GigaBytes
Max Memory Allocated: 0.028627395629882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.017243385314941406  GigaBytes
Max Memory Allocated: 0.030675411224365234  GigaBytes

torch.Size([2484, 1433])
torch.Size([2406, 128])
torch.Size([2214, 128])
torch.Size([1614, 128])
torch.Size([771, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.031617164611816406  GigaBytes
Max Memory Allocated: 0.03170633316040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01763916015625  GigaBytes
Max Memory Allocated: 0.03197002410888672  GigaBytes

torch.Size([2446, 1433])
torch.Size([2351, 128])
torch.Size([2057, 128])
torch.Size([1429, 128])
torch.Size([629, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.030317306518554688  GigaBytes
Max Memory Allocated: 0.03197002410888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017054080963134766  GigaBytes
Max Memory Allocated: 0.03197002410888672  GigaBytes

torch.Size([2448, 1433])
torch.Size([2376, 128])
torch.Size([2186, 128])
torch.Size([1667, 128])
torch.Size([840, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03182792663574219  GigaBytes
Max Memory Allocated: 0.03197002410888672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01233363151550293 |0.08531880378723145 |0.1965283751487732 |0.00018841028213500977 |0.005396783351898193 |0.003795623779296875 |
----------------------------------------------------------pseudo_mini_loss sum 3.8769049644470215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37624
Number of first layer input nodes during this epoch:  9819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021339893341064453  GigaBytes
Max Memory Allocated: 0.0322575569152832  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005877017974853516
random selection method range initialization spend 0.0001468658447265625
time for parepare:  9.560585021972656e-05
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00010251998901367188
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.5367431640625e-05
----------------------check_connections_block total spend ----------------------------- 0.0014808177947998047
generate_one_block  0.001382589340209961
generate_one_block  0.0013048648834228516
generate_one_block  0.001313924789428711
generate_one_block  0.0013427734375
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005860328674316406
gen group dst list time:  5.435943603515625e-05
time for parepare:  0.00022029876708984375
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0005292892456054688
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.00041747093200683594
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005035400390625
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005619525909423828
----------------------check_connections_block total spend ----------------------------- 0.003961086273193359
generate_one_block  0.001894235610961914
generate_one_block  0.0018036365509033203
generate_one_block  0.001800537109375
generate_one_block  0.0018701553344726562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007128715515136719
gen group dst list time:  0.00011110305786132812
time for parepare:  0.000244140625
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00031185150146484375
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0017194747924804688
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00022935867309570312
r_  generation:  0.0014195442199707031
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0015823841094970703
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.0016698837280273438
----------------------check_connections_block total spend ----------------------------- 0.010450124740600586
generate_one_block  0.0031881332397460938
generate_one_block  0.0023720264434814453
generate_one_block  0.002318859100341797
generate_one_block  0.0023899078369140625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007212162017822266
gen group dst list time:  0.00018787384033203125
time for parepare:  0.0002524852752685547
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  0.0003147125244140625
r_  generation:  0.0031316280364990234
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.002893686294555664
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation: Using backend: pytorch
 0.0003542900085449219
mini_batch_src_global generation:  0.00027108192443847656
r_  generation:  0.0029790401458740234
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.002508878707885742
----------------------check_connections_block total spend ----------------------------- 0.017815589904785156
generate_one_block  0.003673076629638672
generate_one_block  0.0033178329467773438
generate_one_block  0.0035364627838134766
generate_one_block  0.003464221954345703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007388591766357422
gen group dst list time:  0.00025725364685058594
time for parepare:  0.0002434253692626953
local_output_nid generation:  0.0002117156982421875
local_in_edges_tensor generation:  0.0005238056182861328
mini_batch_src_global generation:  0.0003452301025390625
r_  generation:  0.003226041793823242
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.00032639503479003906
r_  generation:  0.003094196319580078
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.0003497600555419922
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.0030553340911865234
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.0002605915069580078
r_  generation:  0.003237009048461914
----------------------check_connections_block total spend ----------------------------- 0.01917576789855957
generate_one_block  0.004159212112426758
generate_one_block  0.0039446353912353516
generate_one_block  0.0038690567016601562
generate_one_block  0.004027366638183594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007305145263671875
gen group dst list time:  0.00022792816162109375
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.00049591064453125
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0033960342407226562
local_output_nid generation:  0.0001742839813232422
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation:  0.0003044605255126953
r_  generation:  0.0033409595489501953
local_output_nid generation:  0.00017118453979492188
local_in_edges_tensor generation:  0.0003745555877685547
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.003305673599243164
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.00038361549377441406
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.0034029483795166016
----------------------check_connections_block total spend ----------------------------- 0.019923925399780273
generate_one_block  0.004665374755859375
generate_one_block  0.004118680953979492
generate_one_block  0.004082918167114258
generate_one_block  0.004171848297119141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021339893341064453  GigaBytes
Max Memory Allocated: 0.0322575569152832  GigaBytes

connection checking time:  0.07132649421691895
block generation total time  0.06466817855834961
average batch blocks generation time:  0.016167044639587402
block dataloader generation time/epoch 0.16376304626464844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02138805389404297  GigaBytes
Max Memory Allocated: 0.03421497344970703  GigaBytes

torch.Size([2468, 1433])
torch.Size([2410, 128])
torch.Size([2200, 128])
torch.Size([1637, 128])
torch.Size([785, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03521251678466797  GigaBytes
Max Memory Allocated: 0.035300254821777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.020751476287841797  GigaBytes
Max Memory Allocated: 0.03558635711669922  GigaBytes

torch.Size([2445, 1433])
torch.Size([2346, 128])
torch.Size([2107, 128])
torch.Size([1463, 128])
torch.Size([621, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0344700813293457  GigaBytes
Max Memory Allocated: 0.03558635711669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0213775634765625  GigaBytes
Max Memory Allocated: 0.03558635711669922  GigaBytes

torch.Size([2425, 1433])
torch.Size([2333, 128])
torch.Size([2064, 128])
torch.Size([1544, 128])
torch.Size([710, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03445291519165039  GigaBytes
Max Memory Allocated: 0.03558635711669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.020959854125976562  GigaBytes
Max Memory Allocated: 0.03558635711669922  GigaBytes

torch.Size([2481, 1433])
torch.Size([2412, 128])
torch.Size([2187, 128])
torch.Size([1578, 128])
torch.Size([747, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03520536422729492  GigaBytes
Max Memory Allocated: 0.03558635711669922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004552900791168213 |0.0016471147537231445 |0.010514795780181885 |0.00014954805374145508 |0.006776750087738037 |0.0033333301544189453 |
----------------------------------------------------------pseudo_mini_loss sum 3.386061668395996
Total (block generation + training)time/epoch 0.2697107791900635
Training time/epoch 0.10522127151489258
Training time without block to device /epoch 0.0986328125
Training time without total dataloading part /epoch 0.07309770584106445
load block tensor time/epoch 0.01821160316467285
block to device time/epoch 0.006588459014892578
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37696
Number of first layer input nodes during this epoch:  9819
