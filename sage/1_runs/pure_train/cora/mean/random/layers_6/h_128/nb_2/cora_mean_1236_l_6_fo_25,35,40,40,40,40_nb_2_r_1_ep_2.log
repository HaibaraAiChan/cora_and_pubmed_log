main start at this time 1648433222.1591434
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007007122039794922
random selection method range initialization spend 0.00015997886657714844
time for parepare:  6.079673767089844e-05
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0012390613555908203
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001220703125
----------------------check_connections_block total spend ----------------------------- 0.002088308334350586
generate_one_block  0.001535177230834961
generate_one_block  0.001255035400390625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004973411560058594
gen group dst list time:  2.765655517578125e-05
time for parepare:  0.00013518333435058594
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0006120204925537109
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0006594657897949219
----------------------check_connections_block total spend ----------------------------- 0.002377748489379883
generate_one_block  0.0017943382263183594
generate_one_block  0.0018227100372314453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005879402160644531
gen group dst list time:  5.5789947509765625e-05
time for parepare:  0.00016951560974121094
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0016002655029296875
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00017571449279785156
r_  generation:  0.0017573833465576172
----------------------check_connections_block total spend ----------------------------- 0.0053675174713134766
generate_one_block  0.002901792526245117
generate_one_block  0.0029947757720947266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005972385406494141
gen group dst list time:  8.296966552734375e-05
time for parepare:  0.00017499923706054688
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.0004000663757324219
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0026595592498779297
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.005170583724975586
----------------------check_connections_block total spend ----------------------------- 0.010848522186279297
generate_one_block  0.004152059555053711
generate_one_block  0.003961324691772461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008521080017089844
gen group dst list time:  0.00010228157043457031
time for parepare:  0.00018286705017089844
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.0030679702758789062
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.0003085136413574219
r_  generation:  0.002987384796142578
----------------------check_connections_block total spend ----------------------------- 0.009222269058227539
generate_one_block  0.004159450531005859
generate_one_block  0.004130363464355469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000736236572265625
gen group dst list time:  0.000110626220703125
time for parepare:  0.00017547607421875
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.0006546974182128906
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.0030803680419921875
local_output_nid generation:  0.0001609325408935547
local_in_edges_tensor generation:  0.00036716461181640625
mini_batch_src_global generation:  0.000316619873046875
r_  generation:  0.0030498504638671875
----------------------check_connections_block total spend ----------------------------- 0.009568929672241211
generate_one_block  0.004767656326293945
generate_one_block  0.004192352294921875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

connection checking time:  0.037384986877441406
block generation total time  0.03487682342529297
average batch blocks generation time:  0.017438411712646484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015813350677490234  GigaBytes
Max Memory Allocated: 0.015813350677490234  GigaBytes

torch.Size([2503, 1433])
torch.Size([2444, 128])
torch.Size([2322, 128])
torch.Size([1921, 128])
torch.Size([1065, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.03142070770263672  GigaBytes
Max Memory Allocated: 0.03157615661621094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017244815826416016  GigaBytes
Max Memory Allocated: 0.03189277648925781  GigaBytes

torch.Size([2478, 1433])
torch.Size([2443, 128])
torch.Size([2324, 128])
torch.Size([1947, 128])
torch.Size([1173, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03365755081176758  GigaBytes
Max Memory Allocated: 0.03381967544555664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00869894027709961 |0.1729506254196167 |0.3869510889053345 |0.0002263784408569336 |0.006941318511962891 |0.003692150115966797 |
----------------------------------------------------------pseudo_mini_loss sum 3.9446141719818115
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21314
Number of first layer input nodes during this epoch:  4981
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02159738540649414  GigaBytes
Max Memory Allocated: 0.03408479690551758  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006051063537597656
random selection method range initialization spend 0.00015687942504882812
time for parepare:  0.00010395050048828125
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00015473365783691406
local_output_nid generation:  2.4318695068359375e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00016117095947265625
----------------------check_connections_block total spend ----------------------------- 0.0012602806091308594
generate_one_block  0.0015158653259277344
generate_one_block  0.0014634132385253906
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006275177001953125
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.0002243518829345703
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0008041858673095703
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0009260177612304688
----------------------check_connections_block total spend ----------------------------- 0.0033011436462402344
generate_one_block  0.0023415088653564453
generate_one_block  0.0023276805877685547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007295608520507812
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.00024890899658203125
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.0003676414489746094
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.002228260040283203
local_output_nid generation:  0.00013017654418945312
local_in_edges_tensor generation:  0.0003197193145751953
mini_batch_src_global generation:  0.0003325939178466797
r_  generation:  0.0023870468139648438
----------------------check_connections_block total spend ----------------------------- 0.007567882537841797
generate_one_block  0.0037224292755126953
generate_one_block  0.003778219223022461
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007200241088867188
gen group dst list time:  0.00011944770812988281
time for parepare:  0.00024509429931640625
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0005064010620117188
mini_batch_src_global generation:  0.0003094673156738281
r_  generation:  0.003404378890991211
local_output_nid generation:  0.00018668174743652344
local_in_edges_tensor generation:  0.0004107952117919922
mini_batch_src_global generation:  0.0003809928894042969
r_  generation:  0.0035140514373779297
----------------------check_connections_block total spend ----------------------------- 0.010879755020141602
generate_one_block  0.004785776138305664
generate_one_block  0.0038001537322998047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007178783416748047
gen group dst list time:  0.0001494884490966797
time for parepare:  0.00024056434631347656
local_output_nid generation:  0.00021314620971679688
local_in_edges_tensor generation:  0.0005536079406738281
mini_batch_src_global generation:  0.00028586387634277344
r_  generation:  0.004134178161621094
local_output_nid generation:  0.00023603439331054688
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  0.00041604042053222656
r_  generation:  0.004101991653442383
----------------------check_connections_block total spend ----------------------------- 0.012513399124145508
generate_one_block  0.0049669742584228516
generate_one_block  0.006494998931884766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016484260559082031
gen group dst list time:  0.0002586841583251953
time for parepare:  0.0004413127899169922
local_output_nid generation:  0.00040149688720703125
local_in_edges_tensor generation:  0.0009913444519042969
mini_batch_src_global generation:  0.0005500316619873047
r_  generation:  0.007523059844970703
local_output_nid generation:  0.0002498626708984375
local_in_edges_tensor generation:  0.0005800724029541016
mini_batch_src_global generation:  0.0005207061767578125
r_  generation:  0.004940986633300781
----------------------check_connections_block total spend ----------------------------- 0.019151687622070312
generate_one_block  0.00632929801940918
generate_one_block  0.0046198368072509766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02159738540649414  GigaBytes
Max Memory Allocated: 0.03408479690551758  GigaBytes

connection checking time:  0.05341386795043945
block generation total time  0.0431668758392334
average batch blocks generation time:  0.0215834379196167
block dataloader generation time/epoch 0.12156796455383301
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021412372589111328  GigaBytes
Max Memory Allocated: 0.03437662124633789  GigaBytes

torch.Size([2515, 1433])
torch.Size([2465, 128])
torch.Size([2309, 128])
torch.Size([1864, 128])
torch.Size([1075, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03688478469848633  GigaBytes
Max Memory Allocated: 0.0370335578918457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02110576629638672  GigaBytes
Max Memory Allocated: 0.037273406982421875  GigaBytes

torch.Size([2502, 1433])
torch.Size([2460, 128])
torch.Size([2303, 128])
torch.Size([1924, 128])
torch.Size([1154, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03731822967529297  GigaBytes
Max Memory Allocated: 0.03749275207519531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004134058952331543 |0.000950932502746582 |0.007039308547973633 |0.00012087821960449219 |0.004873394966125488 |0.0031976699829101562 |
----------------------------------------------------------pseudo_mini_loss sum 3.1960887908935547
Total (block generation + training)time/epoch 0.16173243522644043
Training time/epoch 0.039821624755859375
Training time without block to device /epoch 0.03791975975036621
Training time without total dataloading part /epoch 0.027264833450317383
load block tensor time/epoch 0.008268117904663086
block to device time/epoch 0.001901865005493164
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21273
Number of first layer input nodes during this epoch:  5017
