main start at this time 1648433201.686123
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001348257064819336
random selection method range initialization spend 0.0001876354217529297
time for parepare:  5.888938903808594e-05
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0012614727020263672
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.528594970703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0031964778900146484
generate_one_block  0.0014300346374511719
generate_one_block  0.0010750293731689453
generate_one_block  0.001077413558959961
generate_one_block  0.0010828971862792969
generate_one_block  0.0010428428649902344
generate_one_block  0.0010631084442138672
generate_one_block  0.0010995864868164062
generate_one_block  0.0010848045349121094
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004718303680419922
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.00013494491577148438
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00020122528076171875
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00023293495178222656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00023126602172851562
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0002970695495605469
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0002079010009765625
----------------------check_connections_block total spend ----------------------------- 0.003914356231689453
generate_one_block  0.001348257064819336
generate_one_block  0.0013384819030761719
generate_one_block  0.0012097358703613281
generate_one_block  0.0012421607971191406
generate_one_block  0.0013155937194824219
generate_one_block  0.001333475112915039
generate_one_block  0.0013186931610107422
generate_one_block  0.0012674331665039062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006759166717529297
gen group dst list time:  9.298324584960938e-05
time for parepare:  0.00018262863159179688
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0007250308990478516
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0007834434509277344
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0006020069122314453
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0005846023559570312
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0007154941558837891
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0008227825164794922
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006697177886962891
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006883144378662109
----------------------check_connections_block total spend ----------------------------- 0.009634733200073242
generate_one_block  0.0019125938415527344
generate_one_block  0.0019183158874511719
generate_one_block  0.0016889572143554688
generate_one_block  0.0016527175903320312
generate_one_block  0.0017423629760742188
generate_one_block  0.0020322799682617188
generate_one_block  0.0017518997192382812
generate_one_block  0.0016894340515136719
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007169246673583984
gen group dst list time:  0.00017523765563964844
time for parepare:  0.0001819133758544922
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.0016205310821533203
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.0017151832580566406
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.0016591548919677734
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.001547098159790039
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0015132427215576172
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00016379356384277344
r_  generation:  0.0018224716186523438
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.001676797866821289
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.0001506805419921875
r_  generation:  0.0015423297882080078
----------------------check_connections_block total spend ----------------------------- 0.020445823669433594
generate_one_block  0.002933979034423828
generate_one_block  0.002851724624633789
generate_one_block  0.002786874771118164
generate_one_block  0.002721548080444336
generate_one_block  0.002791881561279297
generate_one_block  0.0037412643432617188
generate_one_block  0.002886533737182617
generate_one_block  0.002675771713256836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007464885711669922
gen group dst list time:  0.00030112266540527344
time for parepare:  0.00018143653869628906
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00045037269592285156
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.0025277137756347656
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.000293731689453125
r_  generation:  0.002489805221557617
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.002507925033569336
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.00021219253540039062
r_  generation:  0.002471923828125
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.002410888671875
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.002685070037841797
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.00029468536376953125
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.002496957778930664
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0024476051330566406
----------------------check_connections_block total spend ----------------------------- 0.030307531356811523
generate_one_block  0.0037419795989990234
generate_one_block  0.0037453174591064453
generate_one_block  0.004466056823730469
generate_one_block  0.004130125045776367
generate_one_block  0.0035533905029296875
generate_one_block  0.003778219223022461
generate_one_block  0.003682374954223633
generate_one_block  0.003537893295288086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007579326629638672
gen group dst list time:  0.00042057037353515625
time for parepare:  0.00018405914306640625
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.0005080699920654297
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.003079652786254883
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  0.0003020763397216797
r_  generation:  0.0029985904693603516
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.00034809112548828125
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.003000497817993164
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.0002448558807373047
r_  generation:  0.0029897689819335938
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.0003483295440673828
mini_batch_src_global generation:  0.00025081634521484375
r_  generation:  0.0030226707458496094
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.003089427947998047
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.0028533935546875
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.0027899742126464844
----------------------check_connections_block total spend ----------------------------- 0.03548002243041992
generate_one_block  0.0049321651458740234
generate_one_block  0.0040187835693359375
generate_one_block  0.004278898239135742
generate_one_block  0.0039825439453125
generate_one_block  0.004055023193359375
generate_one_block  0.004190206527709961
generate_one_block  0.004132509231567383
generate_one_block  0.0040204524993896484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

connection checking time:  0.09978246688842773
block generation total time  0.11239790916442871
average batch blocks generation time:  0.014049738645553589
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014688491821289062  GigaBytes
Max Memory Allocated: 0.014688491821289062  GigaBytes

torch.Size([2404, 1433])
torch.Size([2260, 64])
torch.Size([1866, 64])
torch.Size([1079, 64])
torch.Size([414, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.02018451690673828  GigaBytes
Max Memory Allocated: 0.020203590393066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014422416687011719  GigaBytes
Max Memory Allocated: 0.027898311614990234  GigaBytes

torch.Size([2358, 1433])
torch.Size([2207, 64])
torch.Size([1812, 64])
torch.Size([1112, 64])
torch.Size([445, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.019907474517822266  GigaBytes
Max Memory Allocated: 0.027898311614990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01549673080444336  GigaBytes
Max Memory Allocated: 0.027898311614990234  GigaBytes

torch.Size([2387, 1433])
torch.Size([2208, 64])
torch.Size([1829, 64])
torch.Size([1013, 64])
torch.Size([359, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.020767688751220703  GigaBytes
Max Memory Allocated: 0.027898311614990234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015494823455810547  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

torch.Size([2380, 1433])
torch.Size([2197, 64])
torch.Size([1751, 64])
torch.Size([997, 64])
torch.Size([341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02064800262451172  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015495777130126953  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

torch.Size([2391, 1433])
torch.Size([2192, 64])
torch.Size([1672, 64])
torch.Size([963, 64])
torch.Size([412, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02060985565185547  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015514850616455078  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

torch.Size([2410, 1433])
torch.Size([2275, 64])
torch.Size([1922, 64])
torch.Size([1216, 64])
torch.Size([486, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.021347999572753906  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.014522075653076172  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

torch.Size([2377, 1433])
torch.Size([2215, 64])
torch.Size([1830, 64])
torch.Size([1095, 64])
torch.Size([377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01991558074951172  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01449441909790039  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

torch.Size([2374, 1433])
torch.Size([2144, 64])
torch.Size([1704, 64])
torch.Size([950, 64])
torch.Size([354, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01952362060546875  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009039729833602905 |0.043400466442108154 |0.10212770104408264 |0.00013175606727600098 |0.005349010229110718 |0.003446340560913086 |
----------------------------------------------------------pseudo_mini_loss sum 3.9875845909118652
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63527
Number of first layer input nodes during this epoch:  19081
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.016539573669433594  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
random selection method range initialization spend 0.00010704994201660156
time for parepare:  6.699562072753906e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7179718017578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0017981529235839844
generate_one_block  0.001068115234375
generate_one_block  0.0010616779327392578
generate_one_block  0.0010218620300292969
generate_one_block  0.0010273456573486328
generate_one_block  0.0010290145874023438
generate_one_block  0.0010268688201904297
generate_one_block  0.0010237693786621094
generate_one_block  0.0010042190551757812
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004811286926269531
gen group dst list time:  5.602836608886719e-05
time for parepare:  0.00015854835510253906
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00019979476928710938
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003199577331542969
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00023484230041503906
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00020122528076171875
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001506805419921875
----------------------check_connections_block total spend ----------------------------- 0.004019975662231445
generate_one_block  0.0013318061828613281
generate_one_block  0.0013828277587890625
generate_one_block  0.0012476444244384766
generate_one_block  0.0012803077697753906
generate_one_block  0.001230001449584961
generate_one_block  0.001302480697631836
generate_one_block  0.0012753009796142578
generate_one_block  0.001142263412475586
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006759166717529297
gen group dst list time:  0.00010919570922851562
time for parepare:  0.0001952648162841797
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0006394386291503906
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0009236335754394531
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0007827281951904297
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  9.465217590332031e-05
r_  generation:  0.0008077621459960938
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0006296634674072266
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0008673667907714844
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0008733272552490234
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005459785461425781
----------------------check_connections_block total spend ----------------------------- 0.010428190231323242
generate_one_block  0.0017673969268798828
generate_one_block  0.00208282470703125
generate_one_block  0.0018754005432128906
generate_one_block  0.0018625259399414062
generate_one_block  0.0016598701477050781
generate_one_block  0.0020515918731689453
generate_one_block  0.001943349838256836
generate_one_block  0.0015568733215332031
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007412433624267578
gen group dst list time:  0.00019311904907226562
time for parepare:  0.00018644332885742188
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00038051605224609375
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0015866756439208984
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  0.000247955322265625
r_  generation:  0.0019307136535644531
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.0018029212951660156
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0018072128295898438
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.0015783309936523438
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002474784851074219
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0019109249114990234
local_output_nid generation:  9.179115295410156e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0018558502197265625
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0013539791107177734
----------------------check_connections_block total spend ----------------------------- 0.02140665054321289
generate_one_block  0.0028450489044189453
generate_one_block  0.0030090808868408203
generate_one_block  0.0029211044311523438
generate_one_block  0.0028982162475585938
generate_one_block  0.002730846405029297
generate_one_block  0.003322601318359375
generate_one_block  0.003077983856201172
generate_one_block  0.002516508102416992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007812976837158203
gen group dst list time:  0.00033473968505859375
time for parepare:  0.0001933574676513672
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0004382133483886719
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0025777816772460938
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.0002970695495605469
r_  generation:  0.002730131149291992
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.00023055076599121094
r_  generation:  0.002668142318725586
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0003161430358886719
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.002698659896850586
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0025358200073242188
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.002604246139526367
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.0002307891845703125
r_  generation:  0.0026378631591796875
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0002803802490234375
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.002317190170288086
----------------------check_connections_block total spend ----------------------------- 0.03136420249938965
generate_one_block  0.003750324249267578
generate_one_block  0.0045013427734375
generate_one_block  0.0037953853607177734
generate_one_block  0.003743410110473633
generate_one_block  0.0035943984985351562
generate_one_block  0.003783702850341797
generate_one_block  0.003808736801147461
generate_one_block  0.0035016536712646484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007822513580322266
gen group dst list time:  0.00043702125549316406
time for parepare:  0.0001850128173828125
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0005071163177490234
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.003045320510864258
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.00036144256591796875
mini_batch_src_global generation:  0.0003082752227783203
r_  generation:  0.003080606460571289
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.00304412841796875
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.0003657341003417969
mini_batch_src_global generation:  0.00025272369384765625
r_  generation:  0.0030732154846191406
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.0003495216369628906
mini_batch_src_global generation:  0.00025010108947753906
r_  generation:  0.002986431121826172
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.00026297569274902344
r_  generation:  0.0029807090759277344
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation: Using backend: pytorch
 0.00034332275390625
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.0029764175415039062
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.002827167510986328
----------------------check_connections_block total spend ----------------------------- 0.035799264907836914
generate_one_block  0.0043239593505859375
generate_one_block  0.0043942928314208984
generate_one_block  0.004214763641357422
generate_one_block  0.0040607452392578125
generate_one_block  0.003998994827270508
generate_one_block  0.004102945327758789
generate_one_block  0.004448413848876953
generate_one_block  0.003990650177001953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.016539573669433594  GigaBytes
Max Memory Allocated: 0.028982162475585938  GigaBytes

connection checking time:  0.10301828384399414
block generation total time  0.11232757568359375
average batch blocks generation time:  0.014040946960449219
block dataloader generation time/epoch 0.2497265338897705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017123699188232422  GigaBytes
Max Memory Allocated: 0.029611587524414062  GigaBytes

torch.Size([2411, 1433])
torch.Size([2218, 64])
torch.Size([1768, 64])
torch.Size([989, 64])
torch.Size([326, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02230358123779297  GigaBytes
Max Memory Allocated: 0.029611587524414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017146587371826172  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2384, 1433])
torch.Size([2266, 64])
torch.Size([1916, 64])
torch.Size([1229, 64])
torch.Size([516, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.023021697998046875  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017136096954345703  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2384, 1433])
torch.Size([2232, 64])
torch.Size([1857, 64])
torch.Size([1130, 64])
torch.Size([439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.022673606872558594  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016160011291503906  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2378, 1433])
torch.Size([2260, 64])
torch.Size([1873, 64])
torch.Size([1140, 64])
torch.Size([463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.021770954132080078  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017122745513916016  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2386, 1433])
torch.Size([2179, 64])
torch.Size([1736, 64])
torch.Size([967, 64])
torch.Size([334, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.022222518920898438  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017143726348876953  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2417, 1433])
torch.Size([2286, 64])
torch.Size([1936, 64])
torch.Size([1194, 64])
torch.Size([490, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.022951602935791016  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017146587371826172  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2415, 1433])
torch.Size([2288, 64])
torch.Size([1956, 64])
torch.Size([1232, 64])
torch.Size([507, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.023003101348876953  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016017913818359375  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

torch.Size([2356, 1433])
torch.Size([2151, 64])
torch.Size([1660, 64])
torch.Size([882, 64])
torch.Size([307, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.02085399627685547  GigaBytes
Max Memory Allocated: 0.030611038208007812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037280023097991943 |0.0009490251541137695 |0.006966441869735718 |0.00010645389556884766 |0.006300777196884155 |0.0025353431701660156 |
----------------------------------------------------------pseudo_mini_loss sum 3.1911706924438477
Total (block generation + training)time/epoch 0.40600013732910156
Training time/epoch 0.15601325035095215
Training time without block to device /epoch 0.148421049118042
Training time without total dataloading part /epoch 0.10952472686767578
load block tensor time/epoch 0.029824018478393555
block to device time/epoch 0.007592201232910156
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64610
Number of first layer input nodes during this epoch:  19131
