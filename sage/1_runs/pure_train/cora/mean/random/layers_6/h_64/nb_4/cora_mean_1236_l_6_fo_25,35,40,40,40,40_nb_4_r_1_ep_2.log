main start at this time 1648433192.1558678
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001192331314086914
random selection method range initialization spend 0.0001900196075439453
time for parepare:  6.461143493652344e-05
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0020477771759033203
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0033431053161621094
generate_one_block  0.0014925003051757812
generate_one_block  0.0010657310485839844
generate_one_block  0.0011165142059326172
generate_one_block  0.0010607242584228516
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004968643188476562
gen group dst list time:  4.029273986816406e-05
time for parepare:  0.00013828277587890625
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0004367828369140625
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003402233123779297
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.00042891502380371094
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00037550926208496094
----------------------check_connections_block total spend ----------------------------- 0.003082752227783203
generate_one_block  0.0015027523040771484
generate_one_block  0.0014412403106689453
generate_one_block  0.0014812946319580078
generate_one_block  0.0015277862548828125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000579833984375
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0001678466796875
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0012617111206054688
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.0001468658447265625
r_  generation:  0.0010976791381835938
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.00113677978515625
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0012078285217285156
----------------------check_connections_block total spend ----------------------------- 0.0076427459716796875
generate_one_block  0.002513408660888672
generate_one_block  0.0022826194763183594
generate_one_block  0.002308368682861328
generate_one_block  0.002225160598754883
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007395744323730469
gen group dst list time:  0.0001277923583984375
time for parepare:  0.00018978118896484375
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0023376941680908203
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.002168416976928711
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.002187490463256836
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0023317337036132812
----------------------check_connections_block total spend ----------------------------- 0.013989686965942383
generate_one_block  0.0037033557891845703
generate_one_block  0.0034494400024414062
generate_one_block  0.0035042762756347656
generate_one_block  0.0034313201904296875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000782012939453125
gen group dst list time:  0.00018358230590820312
time for parepare:  0.00018334388732910156
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.0005202293395996094
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.0030469894409179688
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.00033545494079589844
mini_batch_src_global generation:  0.00029730796813964844
r_  generation:  0.0028846263885498047
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0003364086151123047
mini_batch_src_global generation:  0.00025963783264160156
r_  generation:  0.002919435501098633
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.0029349327087402344
----------------------check_connections_block total spend ----------------------------- 0.017920970916748047
generate_one_block  0.0045583248138427734
generate_one_block  0.0040585994720458984
generate_one_block  0.004080533981323242
generate_one_block  0.004064083099365234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007560253143310547
gen group dst list time:  0.000213623046875
time for parepare:  0.00018453598022460938
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.0005104541778564453
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.003167867660522461
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003960132598876953
mini_batch_src_global generation:  0.0003399848937988281
r_  generation:  0.003122568130493164
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.00316619873046875
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.0003628730773925781
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0032045841217041016
----------------------check_connections_block total spend ----------------------------- 0.019119739532470703
generate_one_block  0.005166769027709961
generate_one_block  0.00423884391784668
generate_one_block  0.0041120052337646484
generate_one_block  0.0041620731353759766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

connection checking time:  0.06175589561462402
block generation total time  0.063812255859375
average batch blocks generation time:  0.01595306396484375
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014731407165527344  GigaBytes
Max Memory Allocated: 0.014731407165527344  GigaBytes

torch.Size([2444, 1433])
torch.Size([2370, 64])
torch.Size([2176, 64])
torch.Size([1566, 64])
torch.Size([748, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.02161693572998047  GigaBytes
Max Memory Allocated: 0.021658897399902344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015530586242675781  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

torch.Size([2416, 1433])
torch.Size([2329, 64])
torch.Size([2052, 64])
torch.Size([1408, 64])
torch.Size([625, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.021908283233642578  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015536308288574219  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

torch.Size([2423, 1433])
torch.Size([2328, 64])
torch.Size([2068, 64])
torch.Size([1443, 64])
torch.Size([669, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02206707000732422  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01554107666015625  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

torch.Size([2461, 1433])
torch.Size([2353, 64])
torch.Size([2097, 64])
torch.Size([1509, 64])
torch.Size([645, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.022151947021484375  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00991755723953247 |0.08617967367172241 |0.19920897483825684 |0.00017082691192626953 |0.005922675132751465 |0.003983020782470703 |
----------------------------------------------------------pseudo_mini_loss sum 3.6868410110473633
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  36856
Number of first layer input nodes during this epoch:  9744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017694473266601562  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005125999450683594
random selection method range initialization spend 0.0001251697540283203
time for parepare:  7.891654968261719e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.53131103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.001413106918334961
generate_one_block  0.0012774467468261719
generate_one_block  0.0012035369873046875
generate_one_block  0.0012803077697753906
generate_one_block  0.0011837482452392578
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005359649658203125
gen group dst list time:  4.863739013671875e-05
time for parepare:  0.0001823902130126953
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0005359649658203125
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0004942417144775391
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004551410675048828
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004200935363769531
----------------------check_connections_block total spend ----------------------------- 0.003725290298461914
generate_one_block  0.0017938613891601562
generate_one_block  0.0017671585083007812
generate_one_block  0.0016889572143554688
generate_one_block  0.0016407966613769531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006170272827148438
gen group dst list time:  9.703636169433594e-05
time for parepare:  0.00021910667419433594
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0015048980712890625
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00019478797912597656
r_  generation:  0.001523733139038086
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.0013968944549560547
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0015261173248291016
----------------------check_connections_block total spend ----------------------------- 0.009700298309326172
generate_one_block  0.002827167510986328
generate_one_block  0.00254058837890625
generate_one_block  0.002315998077392578
generate_one_block  0.002344846725463867
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007603168487548828
gen group dst list time:  0.0001709461212158203
time for parepare:  0.00022125244140625
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.00047397613525390625
mini_batch_src_global generation:  0.00026345252990722656
r_  generation:  0.0027883052825927734
local_output_nid generation:  0.00014972686767578125
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.00029206275939941406
r_  generation:  0.004172325134277344
local_output_nid generation:  0.00022983551025390625
local_in_edges_tensor generation: Using backend: pytorch
 0.0006215572357177734
mini_batch_src_global generation:  0.00047135353088378906
r_  generation:  0.0052297115325927734
local_output_nid generation:  0.00023984909057617188
local_in_edges_tensor generation:  0.0006296634674072266
mini_batch_src_global generation:  0.0004622936248779297
r_  generation:  0.003518342971801758
----------------------check_connections_block total spend ----------------------------- 0.023884296417236328
generate_one_block  0.005502223968505859
generate_one_block  0.0037398338317871094
generate_one_block  0.0037784576416015625
generate_one_block  0.0035698413848876953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007739067077636719
gen group dst list time:  0.0001919269561767578
time for parepare:  0.00017499923706054688
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0004954338073730469
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0028192996978759766
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.0003161430358886719
r_  generation:  0.0028378963470458984
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002763032913208008
local_output_nid generation:  0.00014781951904296875
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.0028035640716552734
----------------------check_connections_block total spend ----------------------------- 0.01719188690185547
generate_one_block  0.00451350212097168
generate_one_block  0.0040547847747802734
generate_one_block  0.0039365291595458984
generate_one_block  0.003904581069946289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007638931274414062
gen group dst list time:  0.00020265579223632812
time for parepare:  0.00017952919006347656
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.003060579299926758
local_output_nid generation:  0.00015544891357421875
local_in_edges_tensor generation:  0.00040078163146972656
mini_batch_src_global generation:  0.0003008842468261719
r_  generation:  0.003013134002685547
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.0003631114959716797
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0031270980834960938
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.00035834312438964844
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.0030455589294433594
----------------------check_connections_block total spend ----------------------------- 0.018455982208251953
generate_one_block  0.0042040348052978516
generate_one_block  0.004471778869628906
generate_one_block  0.004158735275268555
generate_one_block  0.004073143005371094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017694473266601562  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

connection checking time:  0.07295775413513184
block generation total time  0.06682682037353516
average batch blocks generation time:  0.01670670509338379
block dataloader generation time/epoch 0.1674184799194336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017175674438476562  GigaBytes
Max Memory Allocated: 0.03061056137084961  GigaBytes

torch.Size([2477, 1433])
torch.Size([2400, 64])
torch.Size([2160, 64])
torch.Size([1572, 64])
torch.Size([750, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.024092674255371094  GigaBytes
Max Memory Allocated: 0.03061056137084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01717662811279297  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

torch.Size([2446, 1433])
torch.Size([2363, 64])
torch.Size([2131, 64])
torch.Size([1573, 64])
torch.Size([770, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.024030685424804688  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017169952392578125  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

torch.Size([2437, 1433])
torch.Size([2355, 64])
torch.Size([2073, 64])
torch.Size([1483, 64])
torch.Size([702, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023792743682861328  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01717090606689453  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

torch.Size([2430, 1433])
torch.Size([2338, 64])
torch.Size([2101, 64])
torch.Size([1551, 64])
torch.Size([759, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.023902416229248047  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003915548324584961 |0.0008398294448852539 |0.006457030773162842 |0.00011032819747924805 |0.00437086820602417 |0.0026590824127197266 |
----------------------------------------------------------pseudo_mini_loss sum 3.0728683471679688
Total (block generation + training)time/epoch 0.23743772506713867
Training time/epoch 0.06974411010742188
Training time without block to device /epoch 0.06638479232788086
Training time without total dataloading part /epoch 0.046411991119384766
load block tensor time/epoch 0.015662193298339844
block to device time/epoch 0.0033593177795410156
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37606
Number of first layer input nodes during this epoch:  9790
