main start at this time 1648433182.80544
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011510848999023438
random selection method range initialization spend 0.0002162456512451172
time for parepare:  8.034706115722656e-05
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.002694845199584961
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00015807151794433594
----------------------check_connections_block total spend ----------------------------- 0.0036940574645996094
generate_one_block  0.0016944408416748047
generate_one_block  0.0015206336975097656
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005881786346435547
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.00018262863159179688
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0007870197296142578
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0008912086486816406
----------------------check_connections_block total spend ----------------------------- 0.0030891895294189453
generate_one_block  0.0021903514862060547
generate_one_block  0.0022640228271484375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007002353668212891
gen group dst list time:  7.510185241699219e-05
time for parepare:  0.00022792816162109375
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.0022139549255371094
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.002151966094970703
----------------------check_connections_block total spend ----------------------------- 0.006990194320678711
generate_one_block  0.003771543502807617
generate_one_block  0.0036377906799316406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008037090301513672
gen group dst list time:  0.00011587142944335938
time for parepare:  0.0002334117889404297
local_output_nid generation:  0.00017142295837402344
local_in_edges_tensor generation:  0.0004889965057373047
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.0035233497619628906
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.0004029273986816406
mini_batch_src_global generation:  0.0003707408905029297
r_  generation:  0.003467559814453125
----------------------check_connections_block total spend ----------------------------- 0.0108489990234375
generate_one_block  0.004813432693481445
generate_one_block  0.003863811492919922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007312297821044922
gen group dst list time:  0.0001442432403564453
time for parepare:  0.00024008750915527344
local_output_nid generation:  0.0002071857452392578
local_in_edges_tensor generation:  0.0005807876586914062
mini_batch_src_global generation:  0.0002796649932861328
r_  generation:  0.0040585994720458984
local_output_nid generation:  0.0002193450927734375
local_in_edges_tensor generation:  0.0004448890686035156
mini_batch_src_global generation:  0.00033855438232421875
r_  generation:  0.003307819366455078
----------------------check_connections_block total spend ----------------------------- 0.011346101760864258
generate_one_block  0.004581451416015625
generate_one_block  0.004361867904663086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006792545318603516
gen group dst list time:  0.00012302398681640625
time for parepare:  0.00019931793212890625
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.0004858970642089844
mini_batch_src_global generation:  0.0002338886260986328
r_  generation:  0.003438234329223633
local_output_nid generation:  0.00017571449279785156
local_in_edges_tensor generation:  0.0003933906555175781
mini_batch_src_global generation:  0.00039315223693847656
r_  generation:  0.0034346580505371094
----------------------check_connections_block total spend ----------------------------- 0.010511636734008789
generate_one_block  0.005181312561035156
generate_one_block  0.004235744476318359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

connection checking time:  0.0427861213684082
block generation total time  0.038901329040527344
average batch blocks generation time:  0.019450664520263672
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014762401580810547  GigaBytes
Max Memory Allocated: 0.014762401580810547  GigaBytes

torch.Size([2484, 1433])
torch.Size([2434, 64])
torch.Size([2308, 64])
torch.Size([1909, 64])
torch.Size([1090, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.022696971893310547  GigaBytes
Max Memory Allocated: 0.022766590118408203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015578746795654297  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

torch.Size([2503, 1433])
torch.Size([2454, 64])
torch.Size([2290, 64])
torch.Size([1876, 64])
torch.Size([1070, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.02349853515625  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024419784545898438 |0.16988599300384521 |0.3880068063735962 |0.00020396709442138672 |0.007741570472717285 |0.004475116729736328 |
----------------------------------------------------------pseudo_mini_loss sum 3.8255343437194824
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21110
Number of first layer input nodes during this epoch:  4987
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01781320571899414  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009415149688720703
random selection method range initialization spend 0.00020503997802734375
time for parepare:  0.00013899803161621094
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0003325939178466797
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0002853870391845703
local_output_nid generation:  4.076957702636719e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00018072128295898438
----------------------check_connections_block total spend ----------------------------- 0.0018279552459716797
generate_one_block  0.0016911029815673828
generate_one_block  0.001628875732421875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006799697875976562
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.00021028518676757812
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0010721683502197266
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0009772777557373047
----------------------check_connections_block total spend ----------------------------- 0.0037009716033935547
generate_one_block  0.0028336048126220703
generate_one_block  0.0017588138580322266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005550384521484375
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.00018334388732910156
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0003256797790527344
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0018198490142822266
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.0017180442810058594
----------------------check_connections_block total spend ----------------------------- 0.005777597427368164
generate_one_block  0.003118753433227539
generate_one_block  0.002965211868286133
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006072521209716797
gen group dst list time:  8.7738037109375e-05
time for parepare:  0.0001819133758544922
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.00041747093200683594
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.0027751922607421875
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.00028705596923828125
r_  generation:  0.002651214599609375
----------------------check_connections_block total spend ----------------------------- 0.008527517318725586
generate_one_block  0.004056692123413086
generate_one_block  0.0037941932678222656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007867813110351562
gen group dst list time:  0.00010848045349121094
time for parepare:  0.00018143653869628906
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0002732276916503906
r_  generation:  0.003129720687866211
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.0003199577331542969
r_  generation:  0.003089427947998047
----------------------check_connections_block total spend ----------------------------- 0.009630203247070312
generate_one_block  0.004332065582275391
generate_one_block  0.004840850830078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006787776947021484
gen group dst list time:  0.00011587142944335938
time for parepare:  0.00018548965454101562
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.0002110004425048828
r_  generation:  0.003257274627685547
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.0003352165222167969
r_  generation:  0.0031948089599609375
----------------------check_connections_block total spend ----------------------------- 0.009854555130004883
generate_one_block  0.00445556640625
generate_one_block  0.004184722900390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01781320571899414  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

connection checking time:  0.0374908447265625
block generation total time  0.03634047508239746
average batch blocks generation time:  0.01817023754119873
block dataloader generation time/epoch 0.14556336402893066
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017208576202392578  GigaBytes
Max Memory Allocated: 0.030612468719482422  GigaBytes

torch.Size([2496, 1433])
torch.Size([2448, 64])
torch.Size([2304, 64])
torch.Size([1922, 64])
torch.Size([1124, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02525043487548828  GigaBytes
Max Memory Allocated: 0.030612468719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017203807830810547  GigaBytes
Max Memory Allocated: 0.030613422393798828  GigaBytes

torch.Size([2463, 1433])
torch.Size([2420, 64])
torch.Size([2281, 64])
torch.Size([1859, 64])
torch.Size([1089, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025035858154296875  GigaBytes
Max Memory Allocated: 0.030613422393798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0042266845703125 |0.0008378028869628906 |0.006303668022155762 |0.00012028217315673828 |0.004998683929443359 |0.002747058868408203 |
----------------------------------------------------------pseudo_mini_loss sum 3.3567745685577393
Total (block generation + training)time/epoch 0.18387603759765625
Training time/epoch 0.03797411918640137
Training time without block to device /epoch 0.036298513412475586
Training time without total dataloading part /epoch 0.025592327117919922
load block tensor time/epoch 0.008453369140625
block to device time/epoch 0.0016756057739257812
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21101
Number of first layer input nodes during this epoch:  4959
