main start at this time 1648433162.391697
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001199483871459961
random selection method range initialization spend 0.00022482872009277344
time for parepare:  8.082389831542969e-05
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0026137828826904297
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.3855438232421875e-05
----------------------check_connections_block total spend ----------------------------- 0.004925966262817383
generate_one_block  0.0015060901641845703
generate_one_block  0.0013155937194824219
generate_one_block  0.0012640953063964844
generate_one_block  0.0013082027435302734
generate_one_block  0.0012552738189697266
generate_one_block  0.0012366771697998047
generate_one_block  0.0011682510375976562
generate_one_block  0.0010814666748046875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005381107330322266
gen group dst list time:  7.724761962890625e-05
time for parepare:  0.0001766681671142578
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002384185791015625
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003573894500732422
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003116130828857422
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00030612945556640625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00018095970153808594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00028061866760253906
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001690387725830078
----------------------check_connections_block total spend ----------------------------- 0.004864215850830078
generate_one_block  0.0015139579772949219
generate_one_block  0.0016291141510009766
generate_one_block  0.001584768295288086
generate_one_block  0.0016622543334960938
generate_one_block  0.0015802383422851562
generate_one_block  0.0013322830200195312
generate_one_block  0.0012562274932861328
generate_one_block  0.001073598861694336
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006880760192871094
gen group dst list time:  0.00013327598571777344
time for parepare:  0.000244140625
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0007841587066650391
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0012290477752685547
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0010600090026855469
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.001234292984008789
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0011055469512939453
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006241798400878906
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0011065006256103516
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0005695819854736328
----------------------check_connections_block total spend ----------------------------- 0.012941122055053711
generate_one_block  0.0020530223846435547
generate_one_block  0.0020775794982910156
generate_one_block  0.0018277168273925781
generate_one_block  0.0020093917846679688
generate_one_block  0.0018696784973144531
generate_one_block  0.0015478134155273438
generate_one_block  0.0018606185913085938
generate_one_block  0.0014123916625976562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007290840148925781
gen group dst list time:  0.00025272369384765625
time for parepare:  0.00023627281188964844
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0003974437713623047
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0019555091857910156
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.0003237724304199219
mini_batch_src_global generation:  0.0002884864807128906
r_  generation:  0.0026001930236816406
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0003027915954589844
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.0023169517517089844
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.002526998519897461
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0018885135650634766
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.001505136489868164
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.001806020736694336
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0011038780212402344
----------------------check_connections_block total spend ----------------------------- 0.024288654327392578
generate_one_block  0.0027718544006347656
generate_one_block  0.003093242645263672
generate_one_block  0.002829313278198242
generate_one_block  0.00302886962890625
generate_one_block  0.003662586212158203
generate_one_block  0.0025582313537597656
generate_one_block  0.002897024154663086
generate_one_block  0.002205371856689453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008063316345214844
gen group dst list time:  0.0004343986511230469
time for parepare:  0.0002448558807373047
local_output_nid generation:  0.0001800060272216797
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.00029921531677246094
r_  generation:  0.0032720565795898438
local_output_nid generation:  0.00019669532775878906
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  0.0003833770751953125
r_  generation:  0.0029761791229248047
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.002804279327392578
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0029211044311523438
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.0003254413604736328
mini_batch_src_global generation:  0.000240325927734375
r_  generation:  0.002728700637817383
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.00020885467529296875
r_  generation:  0.0023453235626220703
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0027244091033935547
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00019311904907226562
r_  generation:  0.0021758079528808594
----------------------check_connections_block total spend ----------------------------- 0.03330564498901367
generate_one_block  0.003804922103881836
generate_one_block  0.003871440887451172
generate_one_block  0.003757953643798828
generate_one_block  0.005093097686767578
generate_one_block  0.0036776065826416016
generate_one_block  0.0035283565521240234
generate_one_block  0.00373077392578125
generate_one_block  0.0032236576080322266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007734298706054688
gen group dst list time:  0.00047469139099121094
time for parepare:  0.00019431114196777344
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0004947185516357422
mini_batch_src_global generation:  0.0002791881561279297
r_  generation:  0.00321197509765625
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.0003788471221923828
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.0033025741577148438
local_output_nid generation:  0.00017261505126953125
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0032236576080322266
local_output_nid generation:  0.00017452239990234375
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.0032622814178466797
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0003654956817626953
mini_batch_src_global generation:  0.0002639293670654297
r_  generation:  0.0032002925872802734
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.002923250198364258
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.00033545494079589844
mini_batch_src_global generation:  0.00024366378784179688
r_  generation:  0.0029273033142089844
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0026824474334716797
----------------------check_connections_block total spend ----------------------------- 0.036809682846069336
generate_one_block  0.0049741268157958984
generate_one_block  0.004090547561645508
generate_one_block  0.004296779632568359
generate_one_block  0.004019021987915039
generate_one_block  0.003975629806518555
generate_one_block  0.003918647766113281
generate_one_block  0.0041522979736328125
generate_one_block  0.003941059112548828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

connection checking time:  0.11220932006835938
block generation total time  0.11339306831359863
average batch blocks generation time:  0.014174133539199829
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014242172241210938  GigaBytes
Max Memory Allocated: 0.014242172241210938  GigaBytes

torch.Size([2411, 1433])
torch.Size([2228, 32])
torch.Size([1746, 32])
torch.Size([943, 32])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.016927242279052734  GigaBytes
Max Memory Allocated: 0.016934871673583984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014651775360107422  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2426, 1433])
torch.Size([2291, 32])
torch.Size([1937, 32])
torch.Size([1284, 32])
torch.Size([517, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017772674560546875  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014636516571044922  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2381, 1433])
torch.Size([2232, 32])
torch.Size([1846, 32])
torch.Size([1116, 32])
torch.Size([461, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017539024353027344  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01464986801147461  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2402, 1433])
torch.Size([2273, 32])
torch.Size([1958, 32])
torch.Size([1263, 32])
torch.Size([532, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01776409149169922  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014638423919677734  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2380, 1433])
torch.Size([2234, 32])
torch.Size([1839, 32])
torch.Size([1123, 32])
torch.Size([468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017542362213134766  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013416767120361328  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2337, 1433])
torch.Size([2157, 32])
torch.Size([1702, 32])
torch.Size([840, 32])
torch.Size([261, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015934467315673828  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01464223861694336  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2414, 1433])
torch.Size([2278, 32])
torch.Size([1896, 32])
torch.Size([1133, 32])
torch.Size([488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017603397369384766  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013277530670166016  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2314, 1433])
torch.Size([2021, 32])
torch.Size([1438, 32])
torch.Size([709, 32])
torch.Size([218, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015494346618652344  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009169399738311768 |0.04339301586151123 |0.10512349009513855 |0.00016629695892333984 |0.004456281661987305 |0.003993034362792969 |
----------------------------------------------------------pseudo_mini_loss sum 3.7389256954193115
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63605
Number of first layer input nodes during this epoch:  19065
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014393806457519531  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004913806915283203
random selection method range initialization spend 0.00011706352233886719
time for parepare:  7.462501525878906e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0018601417541503906
generate_one_block  0.0010716915130615234
generate_one_block  0.001087188720703125
generate_one_block  0.0010216236114501953
generate_one_block  0.0010712146759033203
generate_one_block  0.0010685920715332031
generate_one_block  0.0010461807250976562
generate_one_block  0.001026153564453125
generate_one_block  0.001035451889038086
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005047321319580078
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.00016450881958007812
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00022172927856445312
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00024175643920898438
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00023365020751953125
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0002799034118652344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00022077560424804688
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00020360946655273438
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00022125244140625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002148151397705078
----------------------check_connections_block total spend ----------------------------- 0.00416254997253418
generate_one_block  0.0013852119445800781
generate_one_block  0.0012912750244140625
generate_one_block  0.0013499259948730469
generate_one_block  0.001332998275756836
generate_one_block  0.0012693405151367188
generate_one_block  0.0012729167938232422
generate_one_block  0.001245737075805664
generate_one_block  0.0012438297271728516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006320476531982422
gen group dst list time:  0.00011849403381347656
time for parepare:  0.00020384788513183594
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0007379055023193359
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00010323524475097656
r_  generation:  0.0008296966552734375
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0008804798126220703
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0008592605590820312
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0006999969482421875
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0007593631744384766
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006933212280273438
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0007071495056152344
----------------------check_connections_block total spend ----------------------------- 0.010533809661865234
generate_one_block  0.002063751220703125
generate_one_block  0.0019795894622802734
generate_one_block  0.0018727779388427734
generate_one_block  0.0018634796142578125
generate_one_block  0.0016679763793945312
generate_one_block  0.0018680095672607422
generate_one_block  0.001695871353149414
generate_one_block  0.0016987323760986328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007441043853759766
gen group dst list time:  0.00019311904907226562
time for parepare:  0.0001876354217529297
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0003657341003417969
mini_batch_src_global generation:  0.00017213821411132812
r_  generation:  0.001688241958618164
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.0018541812896728516
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.001974344253540039
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0018627643585205078
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00015997886657714844
r_  generation:  0.0016252994537353516
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.00017380714416503906
r_  generation:  0.0018782615661621094
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0016438961029052734
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.001707315444946289
----------------------check_connections_block total spend ----------------------------- 0.021945476531982422
generate_one_block  0.0028476715087890625
generate_one_block  0.0028727054595947266
generate_one_block  0.0029456615447998047
generate_one_block  0.002888202667236328
generate_one_block  0.0025899410247802734
generate_one_block  0.0028486251831054688
generate_one_block  0.0026543140411376953
generate_one_block  0.0027358531951904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007450580596923828
gen group dst list time:  0.00032639503479003906
time for parepare:  0.00019812583923339844
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.0004687309265136719
mini_batch_src_global generation:  0.00023508071899414062
r_  generation:  0.002540111541748047
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00034618377685546875
mini_batch_src_global generation:  0.000293731689453125
r_  generation:  0.0026831626892089844
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.0003604888916015625
mini_batch_src_global generation:  0.0002903938293457031
r_  generation:  0.002830028533935547
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0027687549591064453
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0024671554565429688
local_output_nid generation:  0.00014281272888183594
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.0027496814727783203
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.002388477325439453
local_output_nid generation:  0.00012421607971191406
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.0002193450927734375
r_  generation:  0.0024106502532958984
----------------------check_connections_block total spend ----------------------------- 0.03168201446533203
generate_one_block  0.004046440124511719
generate_one_block  0.004061222076416016
generate_one_block  0.0037908554077148438
generate_one_block  0.0037071704864501953
generate_one_block  0.0034644603729248047
generate_one_block  0.003892183303833008
generate_one_block  0.0035905838012695312
generate_one_block  0.003571748733520508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007758140563964844
gen group dst list time:  0.00046825408935546875
time for parepare:  0.00019407272338867188
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0004980564117431641
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0031104087829589844
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0003650188446044922
mini_batch_src_global generation:  0.0003006458282470703
r_  generation:  0.0031120777130126953
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.0002715587615966797
r_  generation:  0.0032761096954345703
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.00036334991455078125
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.0032563209533691406
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.003038644790649414
local_output_nid generation:  0.00016760826110839844
local_in_edges_tensor generation:  0.0003674030303955078
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.0029082298278808594
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation: Using backend: pytorch
 0.0003294944763183594
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.002892732620239258
local_output_nid generation:  0.00015306472778320312
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.002840757369995117
----------------------check_connections_block total spend ----------------------------- 0.03635716438293457
generate_one_block  0.004082202911376953
generate_one_block  0.004331350326538086
generate_one_block  0.0041468143463134766
generate_one_block  0.0040187835693359375
generate_one_block  0.003928422927856445
generate_one_block  0.0040514469146728516
generate_one_block  0.004360198974609375
generate_one_block  0.00395655632019043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014393806457519531  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

connection checking time:  0.10468101501464844
block generation total time  0.11048483848571777
average batch blocks generation time:  0.013810604810714722
block dataloader generation time/epoch 0.2494809627532959
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01426839828491211  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2352, 1433])
torch.Size([2156, 32])
torch.Size([1719, 32])
torch.Size([1009, 32])
torch.Size([395, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016968250274658203  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014347076416015625  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2365, 1433])
torch.Size([2184, 32])
torch.Size([1814, 32])
torch.Size([1088, 32])
torch.Size([419, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01717233657836914  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015403270721435547  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2439, 1433])
torch.Size([2312, 32])
torch.Size([1933, 32])
torch.Size([1161, 32])
torch.Size([467, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01840829849243164  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015400409698486328  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2400, 1433])
torch.Size([2246, 32])
torch.Size([1860, 32])
torch.Size([1143, 32])
torch.Size([469, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018350601196289062  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014396190643310547  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2377, 1433])
torch.Size([2133, 32])
torch.Size([1651, 32])
torch.Size([954, 32])
torch.Size([357, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017006874084472656  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01539468765258789  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2413, 1433])
torch.Size([2269, 32])
torch.Size([1882, 32])
torch.Size([1084, 32])
torch.Size([383, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018263816833496094  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015384197235107422  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2418, 1433])
torch.Size([2227, 32])
torch.Size([1737, 32])
torch.Size([993, 32])
torch.Size([382, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018108844757080078  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01538705825805664  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2409, 1433])
torch.Size([2194, 32])
torch.Size([1746, 32])
torch.Size([1004, 32])
torch.Size([364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018096446990966797  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023780763149261475 |0.0009570717811584473 |0.00661054253578186 |0.00012162327766418457 |0.0037350058555603027 |0.0028150081634521484 |
----------------------------------------------------------pseudo_mini_loss sum 3.5545570850372314
Total (block generation + training)time/epoch 0.37247395515441895
Training time/epoch 0.12266302108764648
Training time without block to device /epoch 0.1150064468383789
Training time without total dataloading part /epoch 0.08655238151550293
load block tensor time/epoch 0.01902461051940918
block to device time/epoch 0.007656574249267578
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  63659
Number of first layer input nodes during this epoch:  19173
