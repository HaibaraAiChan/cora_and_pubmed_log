main start at this time 1648433143.2360394
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014743804931640625
random selection method range initialization spend 0.0001976490020751953
time for parepare:  6.175041198730469e-05
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0024766921997070312
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00010228157043457031
----------------------check_connections_block total spend ----------------------------- 0.0032432079315185547
generate_one_block  0.0013699531555175781
generate_one_block  0.001153707504272461
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004718303680419922
gen group dst list time:  2.7894973754882812e-05
time for parepare:  0.00013017654418945312
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0007181167602539062
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005590915679931641
----------------------check_connections_block total spend ----------------------------- 0.002335786819458008
generate_one_block  0.0018584728240966797
generate_one_block  0.0016112327575683594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.00017213821411132812
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0017292499542236328
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0015931129455566406
----------------------check_connections_block total spend ----------------------------- 0.005370140075683594
generate_one_block  0.0029561519622802734
generate_one_block  0.0027534961700439453
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005810260772705078
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00020194053649902344
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.00042247772216796875
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.002619504928588867
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.00023865699768066406
r_  generation:  0.0025234222412109375
----------------------check_connections_block total spend ----------------------------- 0.007906913757324219
generate_one_block  0.003815174102783203
generate_one_block  0.0038280487060546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007412433624267578
gen group dst list time:  0.00010371208190917969
time for parepare:  0.00017380714416503906
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0004382133483886719
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0030329227447509766
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.00033783912658691406
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.002954721450805664
----------------------check_connections_block total spend ----------------------------- 0.008973836898803711
generate_one_block  0.00417327880859375
generate_one_block  0.0042266845703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007491111755371094
gen group dst list time:  0.00011157989501953125
time for parepare:  0.00017523765563964844
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.0004935264587402344
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0030994415283203125
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.0002758502960205078
r_  generation:  0.0030591487884521484
----------------------check_connections_block total spend ----------------------------- 0.009307622909545898
generate_one_block  0.005029439926147461
generate_one_block  0.004177093505859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

connection checking time:  0.03389430046081543
block generation total time  0.034429073333740234
average batch blocks generation time:  0.017214536666870117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014333248138427734  GigaBytes
Max Memory Allocated: 0.014333248138427734  GigaBytes

torch.Size([2513, 1433])
torch.Size([2478, 32])
torch.Size([2353, 32])
torch.Size([1943, 32])
torch.Size([1180, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.018627166748046875  GigaBytes
Max Memory Allocated: 0.018668174743652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01470327377319336  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

torch.Size([2485, 1433])
torch.Size([2428, 32])
torch.Size([2285, 32])
torch.Size([1846, 32])
torch.Size([1038, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018744945526123047  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021456360816955566 |0.17397284507751465 |0.38802504539489746 |0.00020515918731689453 |0.006676077842712402 |0.0033724308013916016 |
----------------------------------------------------------pseudo_mini_loss sum 4.091370582580566
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21247
Number of first layer input nodes during this epoch:  4998
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016055583953857422  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005848407745361328
random selection method range initialization spend 0.00014019012451171875
time for parepare:  0.00010156631469726562
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00017762184143066406
local_output_nid generation:  2.5033950805664062e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00015974044799804688
----------------------check_connections_block total spend ----------------------------- 0.0012488365173339844
generate_one_block  0.0015459060668945312
generate_one_block  0.001438140869140625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
gen group dst list time:  3.838539123535156e-05
time for parepare:  0.00021076202392578125
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0008873939514160156
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.0008749961853027344
----------------------check_connections_block total spend ----------------------------- 0.0032815933227539062
generate_one_block  0.0024178028106689453
generate_one_block  0.0022330284118652344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00066375732421875
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.0002548694610595703
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0003573894500732422
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.002350330352783203
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  0.00035262107849121094
r_  generation:  0.002374410629272461
----------------------check_connections_block total spend ----------------------------- 0.0076024532318115234
generate_one_block  0.0038268566131591797
generate_one_block  0.0036258697509765625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006756782531738281
gen group dst list time:  0.00011944770812988281
time for parepare:  0.00023651123046875
local_output_nid generation:  0.0001761913299560547
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.00029921531677246094
r_  generation:  0.0036444664001464844
local_output_nid generation:  0.0001895427703857422
local_in_edges_tensor generation:  0.00040602684020996094
mini_batch_src_global generation:  0.0004208087921142578
r_  generation:  0.003604888916015625
----------------------check_connections_block total spend ----------------------------- 0.011321306228637695
generate_one_block  0.004719257354736328
generate_one_block  0.0037848949432373047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006914138793945312
gen group dst list time:  0.00014734268188476562
time for parepare:  0.00024247169494628906
local_output_nid generation:  0.00021457672119140625
local_in_edges_tensor generation:  0.0005173683166503906
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.004157304763793945
local_output_nid generation:  0.00023365020751953125
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.00041985511779785156
r_  generation:  0.0041539669036865234
----------------------check_connections_block total spend ----------------------------- 0.01252436637878418
generate_one_block  0.0048656463623046875
generate_one_block  0.0045948028564453125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007448196411132812
gen group dst list time:  0.0001595020294189453
time for parepare:  0.00024056434631347656
local_output_nid generation:  0.00022149085998535156
local_in_edges_tensor generation:  0.0005581378936767578
mini_batch_src_global generation:  0.00028252601623535156
r_  generation:  0.004252195358276367
local_output_nid generation:  0.00023794174194335938
local_in_edges_tensor generation:  0.0004990100860595703
mini_batch_src_global generation:  0.00037407875061035156
r_  generation:  0.004304647445678711
----------------------check_connections_block total spend ----------------------------- 0.01276397705078125
generate_one_block  0.005001068115234375
generate_one_block  0.004415035247802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016055583953857422  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

connection checking time:  0.047493696212768555
block generation total time  0.039484262466430664
average batch blocks generation time:  0.019742131233215332
block dataloader generation time/epoch 0.11029648780822754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01547098159790039  GigaBytes
Max Memory Allocated: 0.028872966766357422  GigaBytes

torch.Size([2506, 1433])
torch.Size([2455, 32])
torch.Size([2331, 32])
torch.Size([1922, 32])
torch.Size([1115, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019671916961669922  GigaBytes
Max Memory Allocated: 0.028872966766357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015471935272216797  GigaBytes
Max Memory Allocated: 0.028873920440673828  GigaBytes

torch.Size([2506, 1433])
torch.Size([2470, 32])
torch.Size([2341, 32])
torch.Size([1923, 32])
torch.Size([1147, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01969146728515625  GigaBytes
Max Memory Allocated: 0.028873920440673828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0092240571975708 |0.001674056053161621 |0.008909106254577637 |0.0001499652862548828 |0.0045468807220458984 |0.0027208328247070312 |
----------------------------------------------------------pseudo_mini_loss sum 3.500380039215088
Total (block generation + training)time/epoch 0.16623640060424805
Training time/epoch 0.05533409118652344
Training time without block to device /epoch 0.051985979080200195
Training time without total dataloading part /epoch 0.029932737350463867
load block tensor time/epoch 0.0184481143951416
block to device time/epoch 0.003348112106323242
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21419
Number of first layer input nodes during this epoch:  5012
