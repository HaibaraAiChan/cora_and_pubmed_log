main start at this time 1648433152.731547
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010845661163330078
random selection method range initialization spend 0.00026106834411621094
time for parepare:  7.867813110351562e-05
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0026009082794189453
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.532669067382812e-05
----------------------check_connections_block total spend ----------------------------- 0.004057168960571289
generate_one_block  0.0016705989837646484
generate_one_block  0.001361846923828125
generate_one_block  0.0013082027435302734
generate_one_block  0.00128936767578125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005872249603271484
gen group dst list time:  5.078315734863281e-05
time for parepare:  0.0001735687255859375
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00043892860412597656
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0006747245788574219
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004317760467529297
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00044417381286621094
----------------------check_connections_block total spend ----------------------------- 0.0038139820098876953
generate_one_block  0.0017595291137695312
generate_one_block  0.002004861831665039
generate_one_block  0.0017158985137939453
generate_one_block  0.0018045902252197266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006749629974365234
gen group dst list time:  0.00010204315185546875
time for parepare:  0.00021457672119140625
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0014107227325439453
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.001886129379272461
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00023674964904785156
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.0014617443084716797
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0015101432800292969
----------------------check_connections_block total spend ----------------------------- 0.010049581527709961
generate_one_block  0.002919912338256836
generate_one_block  0.002942323684692383
generate_one_block  0.0022466182708740234
generate_one_block  0.0022695064544677734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007381439208984375
gen group dst list time:  0.00017976760864257812
time for parepare:  0.0002372264862060547
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.00047659873962402344
mini_batch_src_global generation:  0.00021195411682128906
r_  generation:  0.002845287322998047
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0003814697265625
mini_batch_src_global generation:  0.00036025047302246094
r_  generation:  0.0032079219818115234
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.00034427642822265625
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0028481483459472656
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.0002608299255371094
r_  generation:  0.002420663833618164
----------------------check_connections_block total spend ----------------------------- 0.017536640167236328
generate_one_block  0.003514528274536133
generate_one_block  0.003557443618774414
generate_one_block  0.003488302230834961
generate_one_block  0.003422975540161133
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007469654083251953
gen group dst list time:  0.0002503395080566406
time for parepare:  0.00024247169494628906
local_output_nid generation:  0.00019788742065429688
local_in_edges_tensor generation:  0.0005426406860351562
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0037131309509277344
local_output_nid generation:  0.00021696090698242188
local_in_edges_tensor generation:  0.0004413127899169922
mini_batch_src_global generation:  0.0004055500030517578
r_  generation:  0.003946065902709961
local_output_nid generation:  0.0002110004425048828
local_in_edges_tensor generation:  0.00041747093200683594
mini_batch_src_global generation:  0.00032782554626464844
r_  generation:  0.003259420394897461
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.00025963783264160156
r_  generation:  0.00301361083984375
----------------------check_connections_block total spend ----------------------------- 0.02130126953125
generate_one_block  0.0044939517974853516
generate_one_block  0.004858732223510742
generate_one_block  0.003903627395629883
generate_one_block  0.003965854644775391
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007469654083251953
gen group dst list time:  0.0002930164337158203
time for parepare:  0.00024271011352539062
local_output_nid generation:  0.00022220611572265625
local_in_edges_tensor generation:  0.0006091594696044922
mini_batch_src_global generation:  0.0002968311309814453
r_  generation:  0.004138946533203125
local_output_nid generation:  0.0002384185791015625
local_in_edges_tensor generation:  0.0004677772521972656
mini_batch_src_global generation:  0.0004334449768066406
r_  generation:  0.0041124820709228516
local_output_nid generation:  0.00023651123046875
local_in_edges_tensor generation:  0.00045990943908691406
mini_batch_src_global generation:  0.0003457069396972656
r_  generation:  0.0033779144287109375
local_output_nid generation:  0.00017762184143066406
local_in_edges_tensor generation:  0.0003795623779296875
mini_batch_src_global generation:  0.0002732276916503906
r_  generation:  0.0032501220703125
----------------------check_connections_block total spend ----------------------------- 0.022681474685668945
generate_one_block  0.004248380661010742
generate_one_block  0.004354000091552734
generate_one_block  0.004212856292724609
generate_one_block  0.0049555301666259766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

connection checking time:  0.07538294792175293
block generation total time  0.06663942337036133
average batch blocks generation time:  0.016659855842590332
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014286994934082031  GigaBytes
Max Memory Allocated: 0.014286994934082031  GigaBytes

torch.Size([2460, 1433])
torch.Size([2365, 32])
torch.Size([2078, 32])
torch.Size([1460, 32])
torch.Size([647, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.01770496368408203  GigaBytes
Max Memory Allocated: 0.017721176147460938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014689445495605469  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([2476, 1433])
torch.Size([2394, 32])
torch.Size([2217, 32])
torch.Size([1714, 32])
torch.Size([897, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01851034164428711  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014667510986328125  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([2422, 1433])
torch.Size([2341, 32])
torch.Size([2072, 32])
torch.Size([1479, 32])
torch.Size([639, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018065452575683594  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01467132568359375  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([2479, 1433])
torch.Size([2392, 32])
torch.Size([2157, 32])
torch.Size([1534, 32])
torch.Size([698, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018193721771240234  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018361270427703857 |0.0857895016670227 |0.19547700881958008 |0.0001748800277709961 |0.005166828632354736 |0.003709077835083008 |
----------------------------------------------------------pseudo_mini_loss sum 3.3754212856292725
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37654
Number of first layer input nodes during this epoch:  9837
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015954971313476562  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006048679351806641
random selection method range initialization spend 0.00015735626220703125
time for parepare:  9.489059448242188e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  9.34600830078125e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.43865966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0015056133270263672
generate_one_block  0.001407623291015625
generate_one_block  0.0013403892517089844
generate_one_block  0.0013265609741210938
generate_one_block  0.0013167858123779297
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006046295166015625
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0002219676971435547
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.00047516822814941406
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0005731582641601562
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0004665851593017578
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0005002021789550781
----------------------check_connections_block total spend ----------------------------- 0.004015207290649414
generate_one_block  0.0018296241760253906
generate_one_block  0.0020012855529785156
generate_one_block  0.0017900466918945312
generate_one_block  0.0018076896667480469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006818771362304688
gen group dst list time:  0.00010752677917480469
time for parepare:  0.00024199485778808594
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.0001919269561767578
r_  generation:  0.0014193058013916016
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.00025844573974609375
r_  generation:  0.0017428398132324219
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0014863014221191406
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.001537322998046875
----------------------check_connections_block total spend ----------------------------- 0.010134696960449219
generate_one_block  0.002920866012573242
generate_one_block  0.0028078556060791016
generate_one_block  0.0022330284118652344
generate_one_block  0.002267122268676758
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000698089599609375
gen group dst list time:  0.0001862049102783203
time for parepare:  0.00023746490478515625
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0004513263702392578
mini_batch_src_global generation:  0.0002868175506591797
r_  generation:  0.002764463424682617
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.0003337860107421875
r_  generation:  0.003077268600463867
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.0003552436828613281Using backend: pytorch

mini_batch_src_global generation:  0.00028586387634277344
r_  generation:  0.0029785633087158203
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0003578662872314453
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.0024161338806152344
----------------------check_connections_block total spend ----------------------------- 0.017539024353027344
generate_one_block  0.003466367721557617
generate_one_block  0.0035305023193359375
generate_one_block  0.003570079803466797
generate_one_block  0.003378152847290039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007557868957519531
gen group dst list time:  0.00026106834411621094
time for parepare:  0.00024199485778808594
local_output_nid generation:  0.00020074844360351562
local_in_edges_tensor generation:  0.0005211830139160156
mini_batch_src_global generation:  0.00032639503479003906
r_  generation:  0.003386259078979492
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.0003371238708496094
r_  generation:  0.003215312957763672
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.00036072731018066406
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.0031599998474121094
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation:  0.00026106834411621094
r_  generation:  0.003155231475830078
----------------------check_connections_block total spend ----------------------------- 0.019520044326782227
generate_one_block  0.004117250442504883
generate_one_block  0.004073143005371094
generate_one_block  0.003985166549682617
generate_one_block  0.0039713382720947266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007808208465576172
gen group dst list time:  0.00023174285888671875
time for parepare:  0.00021314620971679688
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.00048470497131347656
mini_batch_src_global generation:  0.00023245811462402344
r_  generation:  0.0032939910888671875
local_output_nid generation:  0.0001811981201171875
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.0003085136413574219
r_  generation:  0.0033915042877197266
local_output_nid generation:  0.00017714500427246094
local_in_edges_tensor generation:  0.00039196014404296875
mini_batch_src_global generation:  0.0002777576446533203
r_  generation:  0.0033409595489501953
local_output_nid generation:  0.00017905235290527344
local_in_edges_tensor generation:  0.0003857612609863281
mini_batch_src_global generation:  0.0002753734588623047
r_  generation:  0.003401517868041992
----------------------check_connections_block total spend ----------------------------- 0.0199739933013916
generate_one_block  0.004391193389892578
generate_one_block  0.004313945770263672
generate_one_block  0.0041217803955078125
generate_one_block  0.004152774810791016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015954971313476562  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

connection checking time:  0.0711829662322998
block generation total time  0.06472921371459961
average batch blocks generation time:  0.016182303428649902
block dataloader generation time/epoch 0.19054841995239258
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015420913696289062  GigaBytes
Max Memory Allocated: 0.02887105941772461  GigaBytes

torch.Size([2421, 1433])
torch.Size([2305, 32])
torch.Size([2027, 32])
torch.Size([1429, 32])
torch.Size([645, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018767833709716797  GigaBytes
Max Memory Allocated: 0.02887105941772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015442848205566406  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

torch.Size([2488, 1433])
torch.Size([2405, 32])
torch.Size([2190, 32])
torch.Size([1636, 32])
torch.Size([811, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.019138813018798828  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015430450439453125  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

torch.Size([2452, 1433])
torch.Size([2364, 32])
torch.Size([2144, 32])
torch.Size([1513, 32])
torch.Size([679, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018928050994873047  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01543426513671875  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

torch.Size([2475, 1433])
torch.Size([2397, 32])
torch.Size([2132, 32])
torch.Size([1517, 32])
torch.Size([711, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01896190643310547  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00442194938659668 |0.0014544129371643066 |0.009113430976867676 |0.00013583898544311523 |0.006035745143890381 |0.0036153793334960938 |
----------------------------------------------------------pseudo_mini_loss sum 3.4420931339263916
Total (block generation + training)time/epoch 0.2861917018890381
Training time/epoch 0.09486746788024902
Training time without block to device /epoch 0.0890498161315918
Training time without total dataloading part /epoch 0.06475543975830078
load block tensor time/epoch 0.01768779754638672
block to device time/epoch 0.0058176517486572266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37479
Number of first layer input nodes during this epoch:  9836
