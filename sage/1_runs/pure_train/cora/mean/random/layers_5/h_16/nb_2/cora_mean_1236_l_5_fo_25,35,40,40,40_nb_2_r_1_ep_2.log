main start at this time 1648431998.4996116
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013895034790039062
random selection method range initialization spend 0.00022125244140625
time for parepare:  5.936622619628906e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.003607034683227539
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00012683868408203125
----------------------check_connections_block total spend ----------------------------- 0.00440669059753418
generate_one_block  0.0013980865478515625
generate_one_block  0.0011565685272216797
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004787445068359375
gen group dst list time:  2.8133392333984375e-05
time for parepare:  0.00013017654418945312
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0006086826324462891
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006916522979736328
----------------------check_connections_block total spend ----------------------------- 0.0024433135986328125
generate_one_block  0.0017092227935791016
generate_one_block  0.0017719268798828125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
gen group dst list time:  5.412101745605469e-05
time for parepare:  0.0001704692840576172
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0015835762023925781
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0017838478088378906
----------------------check_connections_block total spend ----------------------------- 0.005361318588256836
generate_one_block  0.002762317657470703
generate_one_block  0.0029709339141845703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
gen group dst list time:  8.225440979003906e-05
time for parepare:  0.0001735687255859375
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.00040793418884277344
mini_batch_src_global generation:  0.00018215179443359375
r_  generation:  0.002477407455444336
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.00026607513427734375
r_  generation:  0.0026841163635253906
----------------------check_connections_block total spend ----------------------------- 0.007938623428344727
generate_one_block  0.0037391185760498047
generate_one_block  0.0040247440338134766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007541179656982422
gen group dst list time:  0.00010251998901367188
time for parepare:  0.0001747608184814453
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0004725456237792969
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.0029954910278320312
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.0002532005310058594
r_  generation:  0.0029942989349365234
----------------------check_connections_block total spend ----------------------------- 0.00899648666381836
generate_one_block  0.004208803176879883
generate_one_block  0.004101753234863281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

connection checking time:  0.024739742279052734
block generation total time  0.025288820266723633
average batch blocks generation time:  0.012644410133361816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014048576354980469  GigaBytes
Max Memory Allocated: 0.014048576354980469  GigaBytes

torch.Size([2452, 1433])
torch.Size([2284, 16])
torch.Size([1825, 16])
torch.Size([1077, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.015552997589111328  GigaBytes
Max Memory Allocated: 0.015564918518066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014246940612792969  GigaBytes
Max Memory Allocated: 0.027718544006347656  GigaBytes

torch.Size([2465, 1433])
torch.Size([2336, 16])
torch.Size([1965, 16])
torch.Size([1206, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01585531234741211  GigaBytes
Max Memory Allocated: 0.027718544006347656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010097742080688477 |0.1709887981414795 |0.38609230518341064 |0.00022900104522705078 |0.007302641868591309 |0.0044901371002197266 |
----------------------------------------------------------pseudo_mini_loss sum 3.2819697856903076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16315
Number of first layer input nodes during this epoch:  4917
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015069007873535156  GigaBytes
Max Memory Allocated: 0.027718544006347656  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004622936248779297
random selection method range initialization spend 0.000110626220703125
time for parepare:  6.508827209472656e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001385211944580078
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  9.870529174804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0008492469787597656
generate_one_block  0.0012712478637695312
generate_one_block  0.0011157989501953125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004742145538330078
gen group dst list time:  2.9802322387695312e-05
time for parepare:  0.00015020370483398438
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00021648406982421875
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007388591766357422
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00014734268188476562
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0005805492401123047
----------------------check_connections_block total spend ----------------------------- 0.0026154518127441406
generate_one_block  0.0019087791442871094
generate_one_block  0.0016477108001708984
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005424022674560547
gen group dst list time:  5.888938903808594e-05
time for parepare:  0.0001761913299560547
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00031685829162597656
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0017905235290527344
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.00157928466796875
----------------------check_connections_block total spend ----------------------------- 0.0054166316986083984
generate_one_block  0.003084421157836914
generate_one_block  0.002981901168823242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005850791931152344
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0001735687255859375
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00038743019104003906
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.002721548080444336
local_output_nid generation:  0.00012421607971191406
local_in_edges_tensor generation:  0.0003123283386230469
mini_batch_src_global generation:  0.00028586387634277344
r_  generation:  0.0026717185974121094
----------------------check_connections_block total spend ----------------------------- 0.008304119110107422
generate_one_block  0.004075527191162109
generate_one_block  0.003868579864501953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007498264312744141
gen group dst list time:  0.0001246929168701172
time for parepare:  0.0001838207244873047
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.0004506111145019531
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.0030138492584228516
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.00031757354736328125
r_  generation:  0.002970457077026367
----------------------check_connections_block total spend ----------------------------- 0.00928497314453125
generate_one_block  0.004190921783447266
generate_one_block  0.004134416580200195
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015069007873535156  GigaBytes
Max Memory Allocated: 0.027718544006347656  GigaBytes

connection checking time:  0.02562117576599121
block generation total time  0.025892257690429688
average batch blocks generation time:  0.012946128845214844
block dataloader generation time/epoch 0.07066774368286133
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014609336853027344  GigaBytes
Max Memory Allocated: 0.028081893920898438  GigaBytes

torch.Size([2460, 1433])
torch.Size([2323, 16])
torch.Size([1960, 16])
torch.Size([1186, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016212940216064453  GigaBytes
Max Memory Allocated: 0.028081893920898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014600753784179688  GigaBytes
Max Memory Allocated: 0.028082847595214844  GigaBytes

torch.Size([2466, 1433])
torch.Size([2339, 16])
torch.Size([1895, 16])
torch.Size([1036, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01611804962158203  GigaBytes
Max Memory Allocated: 0.028082847595214844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003968954086303711 |0.0006862878799438477 |0.005005359649658203 |0.00011420249938964844 |0.0042073726654052734 |0.0047838687896728516 |
----------------------------------------------------------pseudo_mini_loss sum 2.984299421310425
Total (block generation + training)time/epoch 0.10659241676330566
Training time/epoch 0.03523588180541992
Training time without block to device /epoch 0.03386330604553223
Training time without total dataloading part /epoch 0.0234377384185791
load block tensor time/epoch 0.007937908172607422
block to device time/epoch 0.0013725757598876953
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16355
Number of first layer input nodes during this epoch:  4926
