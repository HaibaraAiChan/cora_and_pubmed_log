main start at this time 1648432007.704863
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013580322265625
random selection method range initialization spend 0.00025463104248046875
time for parepare:  7.534027099609375e-05
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.002267122268676758
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.298324584960938e-05
----------------------check_connections_block total spend ----------------------------- 0.003726959228515625
generate_one_block  0.0017039775848388672
generate_one_block  0.0012042522430419922
generate_one_block  0.0013213157653808594
generate_one_block  0.0012335777282714844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005459785461425781
gen group dst list time:  4.5299530029296875e-05
time for parepare:  0.00015664100646972656
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00047898292541503906
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005397796630859375
----------------------check_connections_block total spend ----------------------------- 0.003568887710571289
generate_one_block  0.0017075538635253906
generate_one_block  0.001642465591430664
generate_one_block  0.0015692710876464844
generate_one_block  0.0018551349639892578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006227493286132812
gen group dst list time:  9.775161743164062e-05
time for parepare:  0.00020051002502441406
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.001377105712890625
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0013318061828613281
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0013766288757324219
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00024366378784179688
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0016522407531738281
----------------------check_connections_block total spend ----------------------------- 0.009182929992675781
generate_one_block  0.002897977828979492
generate_one_block  0.0025441646575927734
generate_one_block  0.0021941661834716797
generate_one_block  0.002547740936279297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007383823394775391
gen group dst list time:  0.00016832351684570312
time for parepare:  0.00023627281188964844
local_output_nid generation:  0.00012421607971191406
local_in_edges_tensor generation:  0.0004787445068359375
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.002404928207397461
local_output_nid generation:  0.00018548965454101562
local_in_edges_tensor generation:  0.00034737586975097656
mini_batch_src_global generation:  0.00033593177795410156
r_  generation:  0.0025675296783447266
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.002518892288208008
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.0007672309875488281
mini_batch_src_global generation:  0.0004899501800537109
r_  generation:  0.005828857421875
----------------------check_connections_block total spend ----------------------------- 0.020676136016845703
generate_one_block  0.006158590316772461
generate_one_block  0.005201578140258789
generate_one_block  0.003945350646972656
generate_one_block  0.003873586654663086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007538795471191406
gen group dst list time:  0.00019788742065429688
time for parepare:  0.0001823902130126953
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.00047326087951660156
mini_batch_src_global generation:  0.0001926422119140625
r_  generation:  0.0028848648071289062
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0002913475036621094
r_  generation:  0.002945423126220703
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.002918243408203125
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.00034427642822265625
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.0030317306518554688
----------------------check_connections_block total spend ----------------------------- 0.017718791961669922
generate_one_block  0.0040891170501708984
generate_one_block  0.0047795772552490234
generate_one_block  0.00391077995300293
generate_one_block  0.0039789676666259766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

connection checking time:  0.051146745681762695
block generation total time  0.05289602279663086
average batch blocks generation time:  0.013224005699157715
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.012753009796142578  GigaBytes
Max Memory Allocated: 0.012753009796142578  GigaBytes

torch.Size([2325, 1433])
torch.Size([2055, 16])
torch.Size([1418, 16])
torch.Size([686, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.013930320739746094  GigaBytes
Max Memory Allocated: 0.01393747329711914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013133049011230469  GigaBytes
Max Memory Allocated: 0.02538919448852539  GigaBytes

torch.Size([2361, 1433])
torch.Size([2122, 16])
torch.Size([1496, 16])
torch.Size([720, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01434326171875  GigaBytes
Max Memory Allocated: 0.02538919448852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013202190399169922  GigaBytes
Max Memory Allocated: 0.025650501251220703  GigaBytes

torch.Size([2374, 1433])
torch.Size([2121, 16])
torch.Size([1475, 16])
torch.Size([649, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014398574829101562  GigaBytes
Max Memory Allocated: 0.025650501251220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014218807220458984  GigaBytes
Max Memory Allocated: 0.0267181396484375  GigaBytes

torch.Size([2410, 1433])
torch.Size([2213, 16])
torch.Size([1680, 16])
torch.Size([882, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015579700469970703  GigaBytes
Max Memory Allocated: 0.0267181396484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009351909160614014 |0.08603131771087646 |0.2051088809967041 |0.00018650293350219727 |0.005328953266143799 |0.003681182861328125 |
----------------------------------------------------------pseudo_mini_loss sum 3.3383450508117676
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27730
Number of first layer input nodes during this epoch:  9470
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014980316162109375  GigaBytes
Max Memory Allocated: 0.0267181396484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005698204040527344
random selection method range initialization spend 0.00011014938354492188
time for parepare:  6.651878356933594e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.221366882324219e-05
----------------------check_connections_block total spend ----------------------------- 0.0012450218200683594
generate_one_block  0.0011622905731201172
generate_one_block  0.0011243820190429688
generate_one_block  0.0011005401611328125
generate_one_block  0.0010883808135986328
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004942417144775391
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00015783309936523438
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00044345855712890625
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.00047969818115234375
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00034046173095703125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003428459167480469
----------------------check_connections_block total spend ----------------------------- 0.003215789794921875
generate_one_block  0.0014753341674804688
generate_one_block  0.0015041828155517578
generate_one_block  0.0014355182647705078
generate_one_block  0.0013370513916015625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005354881286621094
gen group dst list time:  9.870529174804688e-05
time for parepare:  0.00017595291137695312
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0012505054473876953
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00016188621520996094
r_  generation:  0.0012133121490478516
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.00099945068359375
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0010247230529785156
----------------------check_connections_block total spend ----------------------------- 0.007413148880004883
generate_one_block  0.002521038055419922
generate_one_block  0.002370595932006836
generate_one_block  0.0021331310272216797
generate_one_block  0.0021593570709228516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007431507110595703
gen group dst list time:  0.00013327598571777344
time for parepare:  0.0001811981201171875
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0004405975341796875
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.002312898635864258
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00024271011352539062
r_  generation:  0.002187013626098633
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00018835067749023438
r_  generation:  0.002061128616333008
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.0020089149475097656
----------------------check_connections_block total spend ----------------------------- 0.01332712173461914
generate_one_block  0.003803253173828125
generate_one_block  0.0033082962036132812
generate_one_block  0.003271341323852539
generate_one_block  0.003231048583984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007405281066894531
gen group dst list time:  0.00018858909606933594
time for parepare:  0.00018286705017089844
local_output_nid generation:  0.00013494491577148438
local_in_edges_tensor generation:  0.0004794597625732422
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.002798318862915039
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.002706766128540039
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.00035190582275390625
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.0028607845306396484
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation: Using backend: pytorch
 0.00025725364685058594
r_  generation:  0.0028238296508789062
----------------------check_connections_block total spend ----------------------------- 0.017119407653808594
generate_one_block  0.0044100284576416016
generate_one_block  0.003912210464477539
generate_one_block  0.0039424896240234375
generate_one_block  0.003899812698364258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014980316162109375  GigaBytes
Max Memory Allocated: 0.0267181396484375  GigaBytes

connection checking time:  0.04107546806335449
block generation total time  0.04471468925476074
average batch blocks generation time:  0.011178672313690186
block dataloader generation time/epoch 0.10987234115600586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014574527740478516  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

torch.Size([2394, 1433])
torch.Size([2162, 16])
torch.Size([1609, 16])
torch.Size([778, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015863895416259766  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013290882110595703  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

torch.Size([2322, 1433])
torch.Size([2061, 16])
torch.Size([1472, 16])
torch.Size([694, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014496326446533203  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014559268951416016  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

torch.Size([2397, 1433])
torch.Size([2104, 16])
torch.Size([1390, 16])
torch.Size([589, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01569843292236328  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01339864730834961  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

torch.Size([2344, 1433])
torch.Size([2080, 16])
torch.Size([1410, 16])
torch.Size([649, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014557361602783203  GigaBytes
Max Memory Allocated: 0.028079986572265625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002477884292602539 |0.0009012222290039062 |0.00609058141708374 |0.00012731552124023438 |0.0033792853355407715 |0.0025932788848876953 |
----------------------------------------------------------pseudo_mini_loss sum 3.244813919067383
Total (block generation + training)time/epoch 0.1696491241455078
Training time/epoch 0.05942511558532715
Training time without block to device /epoch 0.05582022666931152
Training time without total dataloading part /epoch 0.04098200798034668
load block tensor time/epoch 0.009911537170410156
block to device time/epoch 0.003604888916015625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27181
Number of first layer input nodes during this epoch:  9457
