main start at this time 1648432017.1959248
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013213157653808594
random selection method range initialization spend 0.0002009868621826172
time for parepare:  6.389617919921875e-05
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.002488374710083008
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.004441738128662109
generate_one_block  0.0014548301696777344
generate_one_block  0.001127481460571289
generate_one_block  0.0010485649108886719
generate_one_block  0.00104522705078125
generate_one_block  0.0010418891906738281
generate_one_block  0.0010504722595214844
generate_one_block  0.0010652542114257812
generate_one_block  0.0010571479797363281
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005018711090087891
gen group dst list time:  6.580352783203125e-05
time for parepare:  0.00013971328735351562
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002503395080566406
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002911090850830078
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002391338348388672
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002014636993408203
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.000217437744140625
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00021886825561523438
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00022983551025390625
----------------------check_connections_block total spend ----------------------------- 0.004359245300292969
generate_one_block  0.0013561248779296875
generate_one_block  0.0013880729675292969
generate_one_block  0.0013093948364257812
generate_one_block  0.0012352466583251953
generate_one_block  0.001257181167602539
generate_one_block  0.0012700557708740234
generate_one_block  0.0014050006866455078
generate_one_block  0.0011811256408691406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006673336029052734
gen group dst list time:  0.00011706352233886719
time for parepare:  0.00018739700317382812
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.000728607177734375
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0009722709655761719
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0008976459503173828
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0006570816040039062
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0007042884826660156
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0008127689361572266
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0010907649993896484
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0007011890411376953
----------------------check_connections_block total spend ----------------------------- 0.011164426803588867
generate_one_block  0.0019190311431884766
generate_one_block  0.0021240711212158203
generate_one_block  0.0019435882568359375
generate_one_block  0.0016570091247558594
generate_one_block  0.0017328262329101562
generate_one_block  0.0018396377563476562
generate_one_block  0.0021524429321289062
generate_one_block  0.0017788410186767578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000762939453125
gen group dst list time:  0.00020051002502441406
time for parepare:  0.00019049644470214844
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0016510486602783203
local_output_nid generation:  9.465217590332031e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.0002167224884033203
r_  generation:  0.002027273178100586
local_output_nid generation:  9.608268737792969e-05
local_in_edges_tensor generation:  0.00026035308837890625
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.002058744430541992
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.0015399456024169922
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0016903877258300781
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0019230842590332031
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.0002040863037109375
r_  generation:  0.0021779537200927734
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0017426013946533203
----------------------check_connections_block total spend ----------------------------- 0.022718429565429688
generate_one_block  0.002928495407104492
generate_one_block  0.003153085708618164
generate_one_block  0.003103971481323242
generate_one_block  0.002669811248779297
generate_one_block  0.0028023719787597656
generate_one_block  0.003203153610229492
generate_one_block  0.0033500194549560547
generate_one_block  0.0029876232147216797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007565021514892578
gen group dst list time:  0.00033354759216308594
time for parepare:  0.0001900196075439453
local_output_nid generation:  0.00011920928955078125
local_in_edges_tensor generation:  0.00044417381286621094
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.0025513172149658203
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.002813100814819336
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.0028154850006103516
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.0024995803833007812
local_output_nid generation:  0.00013494491577148438
local_in_edges_tensor generation:  0.00030922889709472656
mini_batch_src_global generation:  0.00024080276489257812
r_  generation:  0.002650737762451172
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.002569913864135742
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.002700328826904297
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.002484560012817383
----------------------check_connections_block total spend ----------------------------- 0.03169393539428711
generate_one_block  0.004374504089355469
generate_one_block  0.00379180908203125
generate_one_block  0.0038480758666992188
generate_one_block  0.003524303436279297
generate_one_block  0.004174709320068359
generate_one_block  0.004547834396362305
generate_one_block  0.0038809776306152344
generate_one_block  0.003664731979370117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

connection checking time:  0.06993603706359863
block generation total time  0.08155512809753418
average batch blocks generation time:  0.010194391012191772
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.012026309967041016  GigaBytes
Max Memory Allocated: 0.012026309967041016  GigaBytes

torch.Size([2194, 1433])
torch.Size([1745, 16])
torch.Size([1023, 16])
torch.Size([372, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.012897014617919922  GigaBytes
Max Memory Allocated: 0.012900829315185547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012469291687011719  GigaBytes
Max Memory Allocated: 0.02404928207397461  GigaBytes

torch.Size([2240, 1433])
torch.Size([1949, 16])
torch.Size([1260, 16])
torch.Size([550, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01351165771484375  GigaBytes
Max Memory Allocated: 0.02404928207397461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012717247009277344  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

torch.Size([2287, 1433])
torch.Size([1947, 16])
torch.Size([1243, 16])
torch.Size([504, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013731002807617188  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012202262878417969  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

torch.Size([2109, 1433])
torch.Size([1682, 16])
torch.Size([899, 16])
torch.Size([367, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01301431655883789  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012202739715576172  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

torch.Size([2194, 1433])
torch.Size([1759, 16])
torch.Size([1023, 16])
torch.Size([371, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013071060180664062  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012540817260742188  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

torch.Size([2255, 1433])
torch.Size([1918, 16])
torch.Size([1167, 16])
torch.Size([413, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013501167297363281  GigaBytes
Max Memory Allocated: 0.024539470672607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012927055358886719  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2324, 1433])
torch.Size([2044, 16])
torch.Size([1376, 16])
torch.Size([620, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.014048576354980469  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012495994567871094  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2248, 1433])
torch.Size([1828, 16])
torch.Size([1088, 16])
torch.Size([360, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013400077819824219  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007039964199066162 |0.04462766647338867 |0.10258179903030396 |0.00013378262519836426 |0.003859579563140869 |0.0029926300048828125 |
----------------------------------------------------------pseudo_mini_loss sum 3.2748587131500244
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  46124
Number of first layer input nodes during this epoch:  17851
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013141632080078125  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00047206878662109375
random selection method range initialization spend 0.0001125335693359375
time for parepare:  6.508827209472656e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.7894973754882812e-05
----------------------check_connections_block total spend ----------------------------- 0.0018415451049804688
generate_one_block  0.0010957717895507812
generate_one_block  0.0010612010955810547
generate_one_block  0.0010590553283691406
generate_one_block  0.0010633468627929688
generate_one_block  0.0010306835174560547
generate_one_block  0.0010340213775634766
generate_one_block  0.0010449886322021484
generate_one_block  0.0010256767272949219
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004942417144775391
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.00015497207641601562
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002143383026123047
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00026488304138183594
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002639293670654297
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0003097057342529297
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00017571449279785156
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00020647048950195312
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00022339820861816406
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00015115737915039062
----------------------check_connections_block total spend ----------------------------- 0.004066944122314453
generate_one_block  0.0012810230255126953
generate_one_block  0.0013289451599121094
generate_one_block  0.0014066696166992188
generate_one_block  0.0013637542724609375
generate_one_block  0.0012054443359375
generate_one_block  0.0012431144714355469
generate_one_block  0.0012745857238769531
generate_one_block  0.0011565685272216797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006806850433349609
gen group dst list time:  0.00010561943054199219
time for parepare:  0.00020122528076171875
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006914138793945312
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0009095668792724609
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0008873939514160156
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0009169578552246094
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006413459777832031
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0007174015045166016
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0007543563842773438
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005502700805664062
----------------------check_connections_block total spend ----------------------------- 0.010392904281616211
generate_one_block  0.0018312931060791016
generate_one_block  0.002087831497192383
generate_one_block  0.0019102096557617188
generate_one_block  0.0019407272338867188
generate_one_block  0.0016512870788574219
generate_one_block  0.0017638206481933594
generate_one_block  0.0017604827880859375
generate_one_block  0.0016300678253173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007135868072509766
gen group dst list time:  0.0001914501190185547
time for parepare:  0.0001995563507080078
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00034165382385253906
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.001613616943359375
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0002276897430419922
r_  generation:  0.002094745635986328
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.00019311904907226562
r_  generation:  0.0019178390502929688
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0018610954284667969
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0015406608581542969
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0018770694732666016
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0017824172973632812
local_output_nid generation:  6.914138793945312e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0014257431030273438
----------------------check_connections_block total spend ----------------------------- 0.021764039993286133
generate_one_block  0.0029172897338867188
generate_one_block  0.0030863285064697266
generate_one_block  0.00295257568359375
generate_one_block  0.0028378963470458984
generate_one_block  0.002592325210571289
generate_one_block  0.003038644790649414
generate_one_block  0.002919912338256836
generate_one_block  0.002504587173461914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007729530334472656
gen group dst list time:  0.0003223419189453125
time for parepare:  0.00019598007202148438
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0004417896270751953
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0026302337646484375
local_output_nid generation:  0.00014472007751464844
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.002847909927368164
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.0027709007263183594
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0026483535766601562
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0024874210357666016
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.00033736228942871094
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.0027990341186523438
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002485513687133789
local_output_nid generation:  0.00011348724365234375
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.00019788742065429688
r_  generation:  0.002149343490600586
----------------------check_connections_block total spend ----------------------------- 0.03122401237487793
generate_one_block  0.004079103469848633
generate_one_block  0.003817319869995117
generate_one_block  0.0036640167236328125
generate_one_block  0.003889322280883789
generate_one_block  0.0035614967346191406
generate_one_block  0.004191398620605469
generate_one_block  0.0037555694580078125
generate_one_block  0.003344297409057617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013141632080078125  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

connection checking time:  0.06744790077209473
block generation total time  0.0779879093170166
average batch blocks generation time:  0.009748488664627075
block dataloader generation time/epoch 0.17508554458618164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01278543472290039  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2236, 1433])
torch.Size([1712, 16])
torch.Size([947, 16])
torch.Size([380, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013621807098388672  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012964248657226562  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2265, 1433])
torch.Size([1925, 16])
torch.Size([1273, 16])
torch.Size([481, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013988018035888672  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012660503387451172  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2209, 1433])
torch.Size([1854, 16])
torch.Size([1179, 16])
torch.Size([450, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013629913330078125  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012583732604980469  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2183, 1433])
torch.Size([1769, 16])
torch.Size([1170, 16])
torch.Size([468, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013543128967285156  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01247406005859375  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2178, 1433])
torch.Size([1675, 16])
torch.Size([920, 16])
torch.Size([323, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013275623321533203  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013036727905273438  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

torch.Size([2280, 1433])
torch.Size([1930, 16])
torch.Size([1148, 16])
torch.Size([375, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013985157012939453  GigaBytes
Max Memory Allocated: 0.02481698989868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.012907981872558594  GigaBytes
Max Memory Allocated: 0.02495718002319336  GigaBytes

torch.Size([2257, 1433])
torch.Size([1838, 16])
torch.Size([1093, 16])Using backend: pytorch

torch.Size([428, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013832569122314453  GigaBytes
Max Memory Allocated: 0.02495718002319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0125579833984375  GigaBytes
Max Memory Allocated: 0.02495718002319336  GigaBytes

torch.Size([2048, 1433])
torch.Size([1550, 16])
torch.Size([850, 16])
torch.Size([281, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.013296127319335938  GigaBytes
Max Memory Allocated: 0.02495718002319336  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002236783504486084 |0.0008610785007476807 |0.006092876195907593 |0.00012308359146118164 |0.0031726956367492676 |0.0026862621307373047 |
----------------------------------------------------------pseudo_mini_loss sum 3.4081456661224365
Total (block generation + training)time/epoch 0.2870748043060303
Training time/epoch 0.11176395416259766
Training time without block to device /epoch 0.10487532615661621
Training time without total dataloading part /epoch 0.07779550552368164
load block tensor time/epoch 0.017894268035888672
block to device time/epoch 0.006888628005981445
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44420
Number of first layer input nodes during this epoch:  17656
