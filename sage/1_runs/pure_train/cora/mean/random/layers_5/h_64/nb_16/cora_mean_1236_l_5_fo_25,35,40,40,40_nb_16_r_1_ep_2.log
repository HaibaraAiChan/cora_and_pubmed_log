main start at this time 1648432103.4363017
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011463165283203125
random selection method range initialization spend 0.0001971721649169922
time for parepare:  6.628036499023438e-05
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.002504587173461914
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.09808349609375e-05
----------------------check_connections_block total spend ----------------------------- 0.005882740020751953
generate_one_block  0.0014598369598388672
generate_one_block  0.0011053085327148438
generate_one_block  0.0011060237884521484
generate_one_block  0.0010869503021240234
generate_one_block  0.001087188720703125
generate_one_block  0.0010807514190673828
generate_one_block  0.0010914802551269531
generate_one_block  0.0011250972747802734
generate_one_block  0.0010883808135986328
generate_one_block  0.0010707378387451172
generate_one_block  0.0010673999786376953
generate_one_block  0.0011086463928222656
generate_one_block  0.0009834766387939453
generate_one_block  0.0009882450103759766
generate_one_block  0.0009796619415283203
generate_one_block  0.0009849071502685547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005781650543212891
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.000152587890625
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00023436546325683594
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012421607971191406
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00017833709716796875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00015020370483398438
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.748603820800781e-05
----------------------check_connections_block total spend ----------------------------- 0.005788326263427734
generate_one_block  0.0011675357818603516
generate_one_block  0.001215219497680664
generate_one_block  0.0013475418090820312
generate_one_block  0.0012388229370117188
generate_one_block  0.0012030601501464844
generate_one_block  0.0011856555938720703
generate_one_block  0.001238107681274414
generate_one_block  0.001230478286743164
generate_one_block  0.0012347698211669922
generate_one_block  0.001081228256225586
generate_one_block  0.0010333061218261719
generate_one_block  0.0011048316955566406
generate_one_block  0.0011622905731201172
generate_one_block  0.0012042522430419922
generate_one_block  0.0011320114135742188
generate_one_block  0.0010416507720947266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007174015045166016
gen group dst list time:  0.00016570091247558594
time for parepare:  0.00021576881408691406
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00022530555725097656
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004744529724121094
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0008399486541748047
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0005130767822265625
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004458427429199219
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00029397010803222656
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00047707557678222656
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005033016204833984
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005199909210205078
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00040411949157714844
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0003447532653808594
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005919933319091797
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006773471832275391
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005872249603271484
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002377033233642578
----------------------check_connections_block total spend ----------------------------- 0.013563871383666992
generate_one_block  0.0014047622680664062
generate_one_block  0.0015985965728759766
generate_one_block  0.002070188522338867
generate_one_block  0.0018448829650878906
generate_one_block  0.0014448165893554688
generate_one_block  0.0013051033020019531
generate_one_block  0.0014522075653076172
generate_one_block  0.0015041828155517578
generate_one_block  0.0014925003051757812
generate_one_block  0.0013966560363769531
generate_one_block  0.0011951923370361328
generate_one_block  0.0013659000396728516
generate_one_block  0.0016090869903564453
generate_one_block  0.0017151832580566406
generate_one_block  0.0015990734100341797
generate_one_block  0.0012412071228027344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006933212280273438
gen group dst list time:  0.000274658203125
time for parepare:  0.00019979476928710938
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0008461475372314453
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0012311935424804688
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.0019137859344482422
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0014617443084716797
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0011749267578125
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0009920597076416016
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0013267993927001953
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0013880729675292969
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0012531280517578125
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0010654926300048828
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0005979537963867188
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0008144378662109375
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0014081001281738281
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.0014274120330810547
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0012764930725097656
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0007107257843017578
----------------------check_connections_block total spend ----------------------------- 0.030172348022460938
generate_one_block  0.002142190933227539
generate_one_block  0.0022420883178710938
generate_one_block  0.0028982162475585938
generate_one_block  0.002490520477294922
generate_one_block  0.002189159393310547
generate_one_block  0.0019953250885009766
generate_one_block  0.002331972122192383
generate_one_block  0.0034122467041015625
generate_one_block  0.002243518829345703
generate_one_block  0.002103090286254883
generate_one_block  0.001558065414428711
generate_one_block  0.0018877983093261719
generate_one_block  0.002559185028076172
generate_one_block  0.0026111602783203125
generate_one_block  0.0024755001068115234
generate_one_block  0.0017900466918945312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007281303405761719
gen group dst list time:  0.0007116794586181641
time for parepare:  0.00019812583923339844
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.001737833023071289
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  0.00023221969604492188
r_  generation:  0.0022077560424804688
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0028171539306640625
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0003008842468261719
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.0024590492248535156
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0002772808074951172
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0021414756774902344
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.001943349838256836
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.0002911090850830078
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.0021314620971679688
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.0021462440490722656
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0019583702087402344
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0018758773803710938
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0012619495391845703
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.001699209213256836
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0022857189178466797
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.000278472900390625
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.002290010452270508
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0021104812622070312
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0015139579772949219
----------------------check_connections_block total spend ----------------------------- 0.049536943435668945
generate_one_block  0.003702878952026367
generate_one_block  0.0032074451446533203
generate_one_block  0.0037102699279785156
generate_one_block  0.0037343502044677734
generate_one_block  0.0031518936157226562
generate_one_block  0.0029125213623046875
generate_one_block  0.0033583641052246094
generate_one_block  0.003471851348876953
generate_one_block  0.0032415390014648438
generate_one_block  0.0031392574310302734
generate_one_block  0.0024449825286865234
generate_one_block  0.002964496612548828
generate_one_block  0.003612995147705078
generate_one_block  0.004333019256591797
generate_one_block  0.003339529037475586
generate_one_block  0.0026819705963134766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

connection checking time:  0.09906148910522461
block generation total time  0.13299775123596191
average batch blocks generation time:  0.00831235945224762
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010101318359375  GigaBytes
Max Memory Allocated: 0.010101318359375  GigaBytes

torch.Size([1732, 1433])
torch.Size([1063, 64])
torch.Size([471, 64])
torch.Size([125, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011652469635009766  GigaBytes
Max Memory Allocated: 0.01165771484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013382911682128906  GigaBytes
Max Memory Allocated: 0.022539138793945312  GigaBytes

torch.Size([2017, 1433])
torch.Size([1436, 64])
torch.Size([696, 64])
torch.Size([243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015604972839355469  GigaBytes
Max Memory Allocated: 0.022539138793945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013704299926757812  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2248, 1433])
torch.Size([1892, 64])
torch.Size([1157, 64])
torch.Size([422, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01701641082763672  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013394355773925781  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2058, 1433])
torch.Size([1593, 64])
torch.Size([816, 64])
torch.Size([244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015890121459960938  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012337207794189453  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2000, 1433])
torch.Size([1366, 64])
torch.Size([649, 64])
torch.Size([206, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.0144195556640625  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011301040649414062  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1808, 1433])
torch.Size([1190, 64])
torch.Size([502, 64])
torch.Size([133, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012995243072509766  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012836933135986328  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2092, 1433])
torch.Size([1498, 64])
torch.Size([735, 64])
torch.Size([226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015164852142333984  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01338958740234375  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2059, 1433])
torch.Size([1564, 64])
torch.Size([782, 64])
torch.Size([250, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015825271606445312  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01211690902709961  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1958, 1433])
torch.Size([1416, 64])
torch.Size([678, 64])
torch.Size([259, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.014334678649902344  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01205587387084961  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1948, 1433])
torch.Size([1320, 64])
torch.Size([585, 64])
torch.Size([188, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.014010429382324219  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.009921073913574219  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1554, 1433])
torch.Size([843, 64])
torch.Size([324, 64])
torch.Size([97, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011106491088867188  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011512279510498047  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1848, 1433])
torch.Size([1192, 64])
torch.Size([486, 64])
torch.Size([185, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013263225555419922  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013401985168457031  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2159, 1433])
torch.Size([1671, 64])
torch.Size([920, 64])
torch.Size([305, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01614093780517578  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013195037841796875  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2156, 1433])
torch.Size([1665, 64])
torch.Size([924, 64])
torch.Size([348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015970230102539062  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013394355773925781  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2052, 1433])
torch.Size([1540, 64])
torch.Size([805, 64])
torch.Size([295, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01588153839111328  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.010451316833496094  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1651, 1433])
torch.Size([1007, 64])
torch.Size([414, 64])
torch.Size([101, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.011866569519042969  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003118842840194702 |0.022111013531684875 |0.05334910750389099 |0.00012920796871185303 |0.004158437252044678 |0.0033483505249023438 |
----------------------------------------------------------pseudo_mini_loss sum 3.9601681232452393
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  68926
Number of first layer input nodes during this epoch:  31340
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012164592742919922  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004942417144775391
random selection method range initialization spend 0.00011754035949707031
time for parepare:  7.82012939453125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5020370483398438e-05
----------------------check_connections_block total spend ----------------------------- 0.0032508373260498047
generate_one_block  0.0011172294616699219
generate_one_block  0.0013437271118164062
generate_one_block  0.0010561943054199219
generate_one_block  0.0010700225830078125
generate_one_block  0.0010561943054199219
generate_one_block  0.001073598861694336
generate_one_block  0.0010488033294677734
generate_one_block  0.0010590553283691406
generate_one_block  0.001055002212524414
generate_one_block  0.0010249614715576172
generate_one_block  0.00096893310546875
generate_one_block  0.0009624958038330078
generate_one_block  0.0009608268737792969
generate_one_block  0.0009701251983642578
generate_one_block  0.0009710788726806641
generate_one_block  0.0010068416595458984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005750656127929688
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.00016736984252929688
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001373291015625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00023293495178222656
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  9.441375732421875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00011563301086425781
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00012612342834472656
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013327598571777344
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.9604644775390625e-05
----------------------check_connections_block total spend ----------------------------- 0.005738735198974609
generate_one_block  0.0012445449829101562
generate_one_block  0.0011873245239257812
generate_one_block  0.0012052059173583984
generate_one_block  0.0013132095336914062
generate_one_block  0.0011756420135498047
generate_one_block  0.0013339519500732422
generate_one_block  0.0011348724365234375
generate_one_block  0.0011219978332519531
generate_one_block  0.0012001991271972656
generate_one_block  0.0010645389556884766
generate_one_block  0.0010912418365478516
generate_one_block  0.0011937618255615234
generate_one_block  0.0011289119720458984
generate_one_block  0.0010800361633300781
generate_one_block  0.0010974407196044922
generate_one_block  0.0010116100311279297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007128715515136719
gen group dst list time:  0.00015306472778320312
time for parepare:  0.00022983551025390625
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0005352497100830078
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00044798851013183594
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005037784576416016
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0007576942443847656
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.00044727325439453125
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0008003711700439453
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0003421306610107422
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002923011779785156
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.000518798828125
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00032591819763183594
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00048613548278808594
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00042438507080078125
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003657341003417969
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00042176246643066406
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005204677581787109
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002574920654296875
----------------------check_connections_block total spend ----------------------------- 0.013894081115722656
generate_one_block  0.0017058849334716797
generate_one_block  0.0015447139739990234
generate_one_block  0.0015375614166259766
generate_one_block  0.0017592906951904297
generate_one_block  0.0014164447784423828
generate_one_block  0.0019114017486572266
generate_one_block  0.0013458728790283203
generate_one_block  0.0018808841705322266
generate_one_block  0.0015447139739990234
generate_one_block  0.00138092041015625
generate_one_block  0.0014801025390625
generate_one_block  0.0013918876647949219
generate_one_block  0.0013518333435058594
generate_one_block  0.001417398452758789
generate_one_block  0.0015027523040771484
generate_one_block  0.0012233257293701172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007202625274658203
gen group dst list time:  0.00032901763916015625
time for parepare:  0.00021457672119140625
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0013287067413330078
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0011377334594726562
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0012671947479248047
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.001720428466796875
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0011165142059326172
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0018558502197265625
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0010304450988769531
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0010230541229248047
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0012807846069335938
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0010061264038085938
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0011327266693115234
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0010123252868652344
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0008985996246337891
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0010657310485839844
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0011272430419921875
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0007338523864746094
----------------------check_connections_block total spend ----------------------------- 0.030095815658569336
generate_one_block  0.002605438232421875
generate_one_block  0.0023539066314697266
generate_one_block  0.0023059844970703125
generate_one_block  0.002939939498901367
generate_one_block  0.002122640609741211
generate_one_block  0.0028841495513916016
generate_one_block  0.0020580291748046875
generate_one_block  0.0020623207092285156
generate_one_block  0.0023071765899658203
generate_one_block  0.0020444393157958984
generate_one_block  0.002254486083984375
generate_one_block  0.0021486282348632812
generate_one_block  0.0020194053649902344
generate_one_block  0.0022089481353759766
generate_one_block  0.0023093223571777344
generate_one_block  0.001828908920288086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007765293121337891
gen group dst list time:  0.0006864070892333984
time for parepare:  0.00022292137145996094
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0004241466522216797
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.0023670196533203125
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.00023412704467773438
r_  generation:  0.0020868778228759766
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.002248525619506836
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0026366710662841797
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0020389556884765625
local_output_nid generation:  0.00013399124145507812
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0027277469635009766
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0018568038940429688
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.001917123794555664
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.0020895004272460938
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0018761157989501953
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0020020008087158203
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0019121170043945312
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0018029212951660156
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0019686222076416016
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.002065420150756836
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0015892982482910156
----------------------check_connections_block total spend ----------------------------- 0.050417423248291016
generate_one_block  0.0041005611419677734
generate_one_block  0.003098011016845703
generate_one_block  0.0032591819763183594
generate_one_block  0.0038025379180908203
generate_one_block  0.0030150413513183594
generate_one_block  0.0036559104919433594
generate_one_block  0.003004312515258789
generate_one_block  0.0031147003173828125
generate_one_block  0.003319263458251953
generate_one_block  0.003086566925048828
generate_one_block  0.003225564956665039
generate_one_block  0.003117799758911133
generate_one_block  0.002984285354614258
generate_one_block  0.003282785415649414
generate_one_block  0.00393223762512207
generate_one_block  0.0028030872344970703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012164592742919922  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

connection checking time:  0.10014605522155762
block generation total time  0.13223505020141602
average batch blocks generation time:  0.008264690637588501
block dataloader generation time/epoch 0.27858686447143555
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.014952659606933594  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([2021, 1433])
torch.Size([1497, 64])
torch.Size([750, 64])
torch.Size([276, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017322063446044922  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013356685638427734  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1898, 1433])
torch.Size([1307, 64])
torch.Size([637, 64])
torch.Size([196, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015380859375  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013808250427246094  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

torch.Size([1981, 1433])
torch.Size([1432, 64])
torch.Size([682, 64])
torch.Size([245, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016022205352783203  GigaBytes
Max Memory Allocated: 0.025293827056884766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015040874481201172  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

torch.Size([2207, 1433])
torch.Size([1743, 64])
torch.Size([1037, 64])
torch.Size([363, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.018046855926513672  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013257980346679688  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

torch.Size([1880, 1433])
torch.Size([1273, 64])
torch.Size([611, 64])
torch.Size([213, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015227794647216797  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015089988708496094  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

torch.Size([2215, 1433])
torch.Size([1821, 64])
torch.Size([1104, 64])
torch.Size([416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01829242706298828  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013605594635009766  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

torch.Size([1946, 1433])
torch.Size([1254, 64])
torch.Size([581, 64])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015463829040527344  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013860225677490234  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes
Using backend: pytorch

torch.Size([1993, 1433])
torch.Size([1346, 64])
torch.Size([536, 64])
torch.Size([122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015710830688476562  GigaBytes
Max Memory Allocated: 0.0254974365234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01495361328125  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([2126, 1433])
torch.Size([1498, 64])
torch.Size([721, 64])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01727581024169922  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013782501220703125  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([1979, 1433])
torch.Size([1337, 64])
torch.Size([546, 64])
torch.Size([175, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01569366455078125  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.014948844909667969  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([2026, 1433])
torch.Size([1431, 64])
torch.Size([698, 64])
torch.Size([251, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01719045639038086  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013629913330078125  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([1949, 1433])
torch.Size([1367, 64])
torch.Size([627, 64])
torch.Size([204, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01568126678466797  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.013210296630859375  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([1872, 1433])
torch.Size([1262, 64])
torch.Size([551, 64])
torch.Size([190, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01508474349975586  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01362752914428711  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([1948, 1433])
torch.Size([1377, 64])
torch.Size([691, 64])
torch.Size([196, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01576375961303711  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.014952659606933594  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([2037, 1433])
torch.Size([1474, 64])
torch.Size([704, 64])
torch.Size([260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01723766326904297  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.012655258178710938  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

torch.Size([1770, 1433])
torch.Size([1073, 64])
torch.Size([421, 64])
torch.Size([102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.014123916625976562  GigaBytes
Max Memory Allocated: 0.025498390197753906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029651522636413574 |0.000719219446182251 |0.005425006151199341 |0.00013048946857452393 |0.004002049565315247 |0.0022745132446289062 |
----------------------------------------------------------pseudo_mini_loss sum 3.520874500274658
Total (block generation + training)time/epoch 0.5094430446624756
Training time/epoch 0.230574369430542
Training time without block to device /epoch 0.21906685829162598
Training time without total dataloading part /epoch 0.1551952362060547
load block tensor time/epoch 0.04744243621826172
block to device time/epoch 0.011507511138916016
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  69616
Number of first layer input nodes during this epoch:  31848
