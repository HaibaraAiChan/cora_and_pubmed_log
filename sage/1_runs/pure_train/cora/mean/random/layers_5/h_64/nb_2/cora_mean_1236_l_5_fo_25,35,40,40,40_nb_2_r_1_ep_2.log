main start at this time 1648432075.600611
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013637542724609375
random selection method range initialization spend 0.0002455711364746094
time for parepare:  6.604194641113281e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.003254413604736328
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00012350082397460938
----------------------check_connections_block total spend ----------------------------- 0.00413203239440918
generate_one_block  0.0015950202941894531
generate_one_block  0.0012965202331542969
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005247592926025391
gen group dst list time:  3.24249267578125e-05
time for parepare:  0.00014066696166992188
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0002262592315673828
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0007164478302001953
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007371902465820312
----------------------check_connections_block total spend ----------------------------- 0.0027267932891845703
generate_one_block  0.002021312713623047
generate_one_block  0.0019991397857666016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005931854248046875
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.0001881122589111328
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0018310546875
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0019261837005615234
----------------------check_connections_block total spend ----------------------------- 0.0059473514556884766
generate_one_block  0.0032165050506591797
generate_one_block  0.003299713134765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006291866302490234
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.00019168853759765625
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0004131793975830078
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.0028476715087890625
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.0003457069396972656
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0029556751251220703
----------------------check_connections_block total spend ----------------------------- 0.008781671524047852
generate_one_block  0.0043604373931884766
generate_one_block  0.0040073394775390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007829666137695312
gen group dst list time:  0.00011396408081054688
time for parepare:  0.0002009868621826172
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.0004963874816894531
mini_batch_src_global generation:  0.0002186298370361328
r_  generation:  0.0033168792724609375
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.0033524036407470703
----------------------check_connections_block total spend ----------------------------- 0.01002359390258789
generate_one_block  0.0047152042388916016
generate_one_block  0.004217863082885742
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

connection checking time:  0.02747941017150879
block generation total time  0.027837514877319336
average batch blocks generation time:  0.013918757438659668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014654159545898438  GigaBytes
Max Memory Allocated: 0.014654159545898438  GigaBytes

torch.Size([2451, 1433])
torch.Size([2312, 64])
torch.Size([1877, 64])
torch.Size([1102, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.02007150650024414  GigaBytes
Max Memory Allocated: 0.020148754119873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015445709228515625  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

torch.Size([2461, 1433])
torch.Size([2340, 64])
torch.Size([1958, 64])
torch.Size([1143, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.021007061004638672  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019268155097961426 |0.17475271224975586 |0.3878430128097534 |0.0002429485321044922 |0.0074117183685302734 |0.004708766937255859 |
----------------------------------------------------------pseudo_mini_loss sum 3.610698699951172
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16349
Number of first layer input nodes during this epoch:  4912
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017462730407714844  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00048422813415527344
random selection method range initialization spend 0.00011229515075683594
time for parepare:  6.937980651855469e-05
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00011372566223144531
----------------------check_connections_block total spend ----------------------------- 0.0008866786956787109
generate_one_block  0.0013403892517089844
generate_one_block  0.0012631416320800781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005037784576416016
gen group dst list time:  3.0517578125e-05
time for parepare:  0.0001556873321533203
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0007541179656982422
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  Using backend: pytorch
0.00015854835510253906
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0006649494171142578
----------------------check_connections_block total spend ----------------------------- 0.0028116703033447266
generate_one_block  0.0020418167114257812
generate_one_block  0.0018775463104248047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005767345428466797
gen group dst list time:  5.841255187988281e-05
time for parepare:  0.000186920166015625
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.001836538314819336
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.0018029212951660156
----------------------check_connections_block total spend ----------------------------- 0.0057871341705322266
generate_one_block  0.0032129287719726562
generate_one_block  0.003288745880126953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006334781646728516
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.0004169940948486328
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.002863645553588867
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.0003063678741455078
r_  generation:  0.002913236618041992
----------------------check_connections_block total spend ----------------------------- 0.008930206298828125
generate_one_block  0.004215240478515625
generate_one_block  0.004106760025024414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007963180541992188
gen group dst list time:  0.00011301040649414062
time for parepare:  0.0001938343048095703
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.00046181678771972656
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.003283262252807617
local_output_nid generation:  0.00017118453979492188
local_in_edges_tensor generation:  0.0003845691680908203
mini_batch_src_global generation:  0.0003368854522705078
r_  generation:  0.0033409595489501953
----------------------check_connections_block total spend ----------------------------- 0.010106563568115234
generate_one_block  0.00452113151550293
generate_one_block  0.0042154788970947266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017462730407714844  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

connection checking time:  0.027635574340820312
block generation total time  0.02747964859008789
average batch blocks generation time:  0.013739824295043945
block dataloader generation time/epoch 0.07453036308288574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017006874084472656  GigaBytes
Max Memory Allocated: 0.030485153198242188  GigaBytes

torch.Size([2432, 1433])
torch.Size([2295, 64])
torch.Size([1883, 64])
torch.Size([1106, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.0224456787109375  GigaBytes
Max Memory Allocated: 0.030485153198242188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01700592041015625  GigaBytes
Max Memory Allocated: 0.030486106872558594  GigaBytes

torch.Size([2460, 1433])
torch.Size([2347, 64])
torch.Size([1907, 64])
torch.Size([1090, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.022437572479248047  GigaBytes
Max Memory Allocated: 0.030486106872558594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035333633422851562 |0.0007255077362060547 |0.005354642868041992 |0.0001283884048461914 |0.003601551055908203 |0.0022704601287841797 |
----------------------------------------------------------pseudo_mini_loss sum 3.461038827896118
Total (block generation + training)time/epoch 0.10613894462585449
Training time/epoch 0.0312809944152832
Training time without block to device /epoch 0.029829978942871094
Training time without total dataloading part /epoch 0.020439624786376953
load block tensor time/epoch 0.0070667266845703125
block to device time/epoch 0.0014510154724121094
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16225
Number of first layer input nodes during this epoch:  4892
