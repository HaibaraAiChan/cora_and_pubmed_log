main start at this time 1648432085.068436
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0017545223236083984
random selection method range initialization spend 0.0002346038818359375
time for parepare:  6.198883056640625e-05
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.003993511199951172
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.00519251823425293
generate_one_block  0.001653432846069336
generate_one_block  0.0010464191436767578
generate_one_block  0.0011317729949951172
generate_one_block  0.0011110305786132812
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000476837158203125
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.0001316070556640625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0004088878631591797
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0003337860107421875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004336833953857422
----------------------check_connections_block total spend ----------------------------- 0.0029964447021484375
generate_one_block  0.0015146732330322266
generate_one_block  0.0013997554779052734
generate_one_block  0.001451253890991211
generate_one_block  0.0014603137969970703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000560760498046875
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.00016927719116210938
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0012691020965576172
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0010280609130859375
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0011496543884277344
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0013172626495361328
----------------------check_connections_block total spend ----------------------------- 0.007737636566162109
generate_one_block  0.002646207809448242
generate_one_block  0.0021893978118896484
generate_one_block  0.002246379852294922
generate_one_block  0.0024390220642089844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007193088531494141
gen group dst list time:  0.00013065338134765625
time for parepare:  0.00017118453979492188
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.002317190170288086
local_output_nid generation:  9.751319885253906e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.002131938934326172
local_output_nid generation:  9.822845458984375e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.0021173954010009766
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0022792816162109375
----------------------check_connections_block total spend ----------------------------- 0.013461828231811523
generate_one_block  0.0035898685455322266
generate_one_block  0.003395557403564453
generate_one_block  0.003421306610107422
generate_one_block  0.0036907196044921875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000766754150390625
gen group dst list time:  0.00022745132446289062
time for parepare:  0.0001895427703857422
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.00047779083251953125
mini_batch_src_global generation:  0.000202178955078125
r_  generation:  0.00284576416015625
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  0.0002865791320800781
r_  generation:  0.002812623977661133
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.00024175643920898438
r_  generation:  0.002756834030151367
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.002873659133911133
----------------------check_connections_block total spend ----------------------------- 0.017061471939086914
generate_one_block  0.003997325897216797
generate_one_block  0.003931283950805664
generate_one_block  0.003915548324584961
generate_one_block  0.004091739654541016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

connection checking time:  0.041257381439208984
block generation total time  0.045380353927612305
average batch blocks generation time:  0.011345088481903076
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014627933502197266  GigaBytes
Max Memory Allocated: 0.014627933502197266  GigaBytes

torch.Size([2379, 1433])
torch.Size([2169, 64])
torch.Size([1598, 64])
torch.Size([782, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.01912689208984375  GigaBytes
Max Memory Allocated: 0.01916790008544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014164447784423828  GigaBytes
Max Memory Allocated: 0.027685165405273438  GigaBytes

torch.Size([2330, 1433])
torch.Size([2055, 64])
torch.Size([1414, 64])
torch.Size([630, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.018203258514404297  GigaBytes
Max Memory Allocated: 0.027685165405273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014310359954833984  GigaBytes
Max Memory Allocated: 0.027685165405273438  GigaBytes

torch.Size([2357, 1433])
torch.Size([2080, 64])
torch.Size([1471, 64])
torch.Size([660, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01845550537109375  GigaBytes
Max Memory Allocated: 0.027685165405273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015413761138916016  GigaBytes
Max Memory Allocated: 0.02782917022705078  GigaBytes

torch.Size([2388, 1433])
torch.Size([2172, 64])
torch.Size([1629, 64])
torch.Size([791, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01995086669921875  GigaBytes
Max Memory Allocated: 0.02782917022705078  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009110629558563232 |0.08601301908493042 |0.19542169570922852 |0.00018662214279174805 |0.005975902080535889 |0.003083467483520508 |
----------------------------------------------------------pseudo_mini_loss sum 3.231354236602783
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27638
Number of first layer input nodes during this epoch:  9454
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01736164093017578  GigaBytes
Max Memory Allocated: 0.02782917022705078  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006079673767089844
random selection method range initialization spend 0.00015211105346679688
time for parepare:  9.250640869140625e-05
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.842613220214844e-05
----------------------check_connections_block total spend ----------------------------- 0.0014698505401611328
generate_one_block  0.0013992786407470703
generate_one_block  0.0013477802276611328
generate_one_block  0.0013167858123779297
generate_one_block  0.0013005733489990234
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005795955657958984
gen group dst list time:  5.412101745605469e-05
time for parepare:  0.00022459030151367188
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0005500316619873047
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0005440711975097656
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00047469139099121094
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.00043654441833496094
----------------------check_connections_block total spend ----------------------------- 0.003978252410888672
generate_one_block  0.0019066333770751953
generate_one_block  0.0018627643585205078
generate_one_block  0.001844644546508789
generate_one_block  0.001730203628540039
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006768703460693359
gen group dst list time:  0.00010943412780761719
time for parepare:  0.0002472400665283203
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.0001995563507080078
r_  generation:  0.0015804767608642578
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.0017046928405761719
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0014891624450683594
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0015039443969726562
----------------------check_connections_block total spend ----------------------------- 0.010252952575683594
generate_one_block  0.003062009811401367
generate_one_block  0.002657651901245117
generate_one_block  0.002186298370361328
generate_one_block  0.0022089481353759766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006809234619140625
gen group dst list time:  0.00018334388732910156
time for parepare:  0.00024008750915527344
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0004153251647949219
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0029244422912597656
local_output_nid generation:  0.0001633167266845703
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0003566741943359375
r_  generation:  0.003077983856201172
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.00034236907958984375
mini_batch_src_global generation:  0.0002675056457519531
r_  generation:  0.0028710365295410156
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00034356117248535156
mini_batch_src_global generation:  0.0002658367156982422
r_  generation:  0.0023462772369384766
----------------------check_connections_block total spend ----------------------------- 0.017374038696289062
generate_one_block  0.0036363601684570312
generate_one_block  0.003408193588256836
generate_one_block  0.0033304691314697266
generate_one_block  0.0033042430877685547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007150173187255859
gen group dst list time:  0.00025391578674316406
time for parepare:  0.0002574920654296875
local_output_nid generation:  0.00019598007202148438
local_in_edges_tensor generation:  0.0005271434783935547
mini_batch_src_global generation:  0.0002646446228027344
r_  generation:  0.003747224807739258
local_output_nid generation:  0.00021457672119140625
local_in_edges_tensor generation:  0.0004324913024902344
mini_batch_src_global generation:  0.0003962516784667969
r_  generation:  0.0037746429443359375
local_output_nid generation:  0.00021910667419433594
local_in_edges_tensor generation:  0.0004298686981201172
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.003375530242919922
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation: Using backend: pytorch
 0.00025916099548339844
r_  generation:  0.0031228065490722656
----------------------check_connections_block total spend ----------------------------- 0.021447420120239258
generate_one_block  0.004084110260009766
generate_one_block  0.0040836334228515625
generate_one_block  0.003978252410888672
generate_one_block  0.003916263580322266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01736164093017578  GigaBytes
Max Memory Allocated: 0.02782917022705078  GigaBytes

connection checking time:  0.053052663803100586
block generation total time  0.047200679779052734
average batch blocks generation time:  0.011800169944763184
block dataloader generation time/epoch 0.12585091590881348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015762805938720703  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

torch.Size([2335, 1433])
torch.Size([2085, 64])
torch.Size([1466, 64])
torch.Size([701, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.019980907440185547  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01593923568725586  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

torch.Size([2367, 1433])
torch.Size([2119, 64])
torch.Size([1572, 64])
torch.Size([752, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.020340919494628906  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015986919403076172  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

torch.Size([2377, 1433])
torch.Size([2157, 64])
torch.Size([1461, 64])
torch.Size([682, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.020206928253173828  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01592540740966797  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

torch.Size([2366, 1433])
torch.Size([2109, 64])
torch.Size([1464, 64])
torch.Size([668, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.020081043243408203  GigaBytes
Max Memory Allocated: 0.02927684783935547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006648540496826172 |0.001316070556640625 |0.007584750652313232 |0.00014168024063110352 |0.005080044269561768 |0.0022988319396972656 |
----------------------------------------------------------pseudo_mini_loss sum 3.4483275413513184
Total (block generation + training)time/epoch 0.21827244758605957
Training time/epoch 0.09185290336608887
Training time without block to device /epoch 0.08658862113952637
Training time without total dataloading part /epoch 0.05352473258972168
load block tensor time/epoch 0.026594161987304688
block to device time/epoch 0.0052642822265625
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27412
Number of first layer input nodes during this epoch:  9445
