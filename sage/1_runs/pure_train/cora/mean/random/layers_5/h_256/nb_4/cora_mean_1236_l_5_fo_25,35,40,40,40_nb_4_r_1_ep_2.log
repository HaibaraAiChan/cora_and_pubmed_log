main start at this time 1648432161.7535613
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011811256408691406
random selection method range initialization spend 0.00022339820861816406
time for parepare:  6.4849853515625e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.003406047821044922
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.0046634674072265625
generate_one_block  0.001491546630859375
generate_one_block  0.0012137889862060547
generate_one_block  0.0012650489807128906
generate_one_block  0.0011904239654541016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005130767822265625
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.00015091896057128906
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004506111145019531
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004017353057861328
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00047850608825683594
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003592967987060547
----------------------check_connections_block total spend ----------------------------- 0.003255128860473633
generate_one_block  0.0016734600067138672
generate_one_block  0.0015919208526611328
generate_one_block  0.0016963481903076172
generate_one_block  0.0015218257904052734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005898475646972656
gen group dst list time:  8.916854858398438e-05
time for parepare:  0.00017976760864257812
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0013022422790527344
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0012922286987304688
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0014262199401855469
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0009968280792236328
----------------------check_connections_block total spend ----------------------------- 0.008094549179077148
generate_one_block  0.0027818679809570312
generate_one_block  0.0026314258575439453
generate_one_block  0.0026502609252929688
generate_one_block  0.002080678939819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007038116455078125
gen group dst list time:  0.0001354217529296875
time for parepare:  0.00020122528076171875
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.002413511276245117
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.0023946762084960938
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.0002703666687011719
r_  generation:  0.0025124549865722656
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0021049976348876953
----------------------check_connections_block total spend ----------------------------- 0.014631509780883789
generate_one_block  0.003720521926879883
generate_one_block  0.003500699996948242
generate_one_block  0.003616809844970703
generate_one_block  0.003283262252807617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008063316345214844
gen group dst list time:  0.00019097328186035156
time for parepare:  0.0001964569091796875
local_output_nid generation:  0.00014495849609375
local_in_edges_tensor generation:  0.0004470348358154297
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0030717849731445312
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  0.0003066062927246094
r_  generation:  0.00305938720703125
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.00307464599609375
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.0002474784851074219
r_  generation:  0.0029077529907226562
----------------------check_connections_block total spend ----------------------------- 0.01832270622253418
generate_one_block  0.0041997432708740234
generate_one_block  0.00451207160949707
generate_one_block  0.003883838653564453
generate_one_block  0.0037832260131835938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.04430389404296875
block generation total time  0.04712796211242676
average batch blocks generation time:  0.01178199052810669
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01699972152709961  GigaBytes
Max Memory Allocated: 0.01699972152709961  GigaBytes

torch.Size([2362, 1433])
torch.Size([2089, 256])
torch.Size([1532, 256])
torch.Size([727, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.03439188003540039  GigaBytes
Max Memory Allocated: 0.03457975387573242  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.021271228790283203  GigaBytes
Max Memory Allocated: 0.0354762077331543  GigaBytes

torch.Size([2372, 1433])
torch.Size([2122, 256])
torch.Size([1529, 256])
torch.Size([726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03862905502319336  GigaBytes
Max Memory Allocated: 0.03877592086791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.021225452423095703  GigaBytes
Max Memory Allocated: 0.039383888244628906  GigaBytes

torch.Size([2338, 1433])
torch.Size([2115, 256])
torch.Size([1614, 256])
torch.Size([796, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03876495361328125  GigaBytes
Max Memory Allocated: 0.039383888244628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.020938873291015625  GigaBytes
Max Memory Allocated: 0.0395054817199707  GigaBytes

torch.Size([2313, 1433])
torch.Size([1972, 256])
torch.Size([1315, 256])
torch.Size([518, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03584146499633789  GigaBytes
Max Memory Allocated: 0.0395054817199707  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003895998001098633 |0.08543151617050171 |0.19655728340148926 |0.0001804828643798828 |0.00508803129196167 |0.00324249267578125 |
----------------------------------------------------------pseudo_mini_loss sum 3.9124808311462402
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27165
Number of first layer input nodes during this epoch:  9385
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.029789447784423828  GigaBytes
Max Memory Allocated: 0.0395054817199707  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006000995635986328
random selection method range initialization spend 0.00015163421630859375
time for parepare:  9.369850158691406e-05
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.369850158691406e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.4849853515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0014977455139160156
generate_one_block  0.0014142990112304688
generate_one_block  0.0013515949249267578
generate_one_block  0.0013256072998046875
generate_one_block  0.0013027191162109375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006062984466552734
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.00022292137145996094
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00024318695068359375
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00043463706970214844
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0006084442138671875
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0005393028259277344
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0004429817199707031
----------------------check_connections_block total spend ----------------------------- 0.004027843475341797
generate_one_block  0.0017650127410888672
generate_one_block  0.001936197280883789
generate_one_block  0.0019409656524658203
generate_one_block  0.0017402172088623047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006780624389648438
gen group dst list time:  0.00010371208190917969
time for parepare:  0.0002529621124267578
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0003714561462402344
mini_batch_src_global generation:  0.00019431114196777344
r_  generation:  0.0014348030090332031
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.0018486976623535156
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0016520023345947266
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00024509429931640625
mini_batch_src_global generation:  0.00019621849060058594
r_  generation:  0.0014715194702148438
----------------------check_connections_block total spend ----------------------------- 0.010583639144897461
generate_one_block  0.002910614013671875
generate_one_block  0.0027701854705810547
generate_one_block  0.002362966537475586
generate_one_block  0.0021877288818359375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007040500640869141
gen group dst list time:  0.00018668174743652344
time for parepare:  0.0002570152282714844
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.0004451274871826172
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.0028295516967773438
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0003726482391357422
mini_batch_src_global generation:  0.0003719329833984375
r_  generation:  0.00313568115234375
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.003099679946899414
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.002228975296020508
----------------------check_connections_block total spend ----------------------------- 0.017596721649169922
generate_one_block  0.0035583972930908203
generate_one_block  0.0034720897674560547
generate_one_block  0.0034897327423095703
generate_one_block  0.003225564956665039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007436275482177734
gen group dst list time:  0.0002532005310058594
time for parepare:  0.0002429485321044922
local_output_nid generation:  0.00020003318786621094
local_in_edges_tensor generation:  0.0005590915679931641
mini_batch_src_global generation:  0.0002651214599609375
r_  generation:  0.0037038326263427734
local_output_nid generation:  0.00021195411682128906
local_in_edges_tensor generation:  0.00043010711669921875
mini_batch_src_global generation:  0.0004112720489501953
r_  generation:  0.0037682056427001953
local_output_nid generation:  0.0002224445343017578
local_in_edges_tensor generation:  0.00043582916259765625
mini_batch_src_global generation:  0.0003349781036376953
r_  generation:  0.003408670425415039
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003807544708251953
mini_batch_src_global generation: Using backend: pytorch
 0.00025010108947753906
r_  generation:  0.0027227401733398438
----------------------check_connections_block total spend ----------------------------- 0.020992040634155273
generate_one_block  0.004281044006347656
generate_one_block  0.003949403762817383
generate_one_block  0.004014492034912109
generate_one_block  0.003812074661254883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.029789447784423828  GigaBytes
Max Memory Allocated: 0.0395054817199707  GigaBytes

connection checking time:  0.05320024490356445
block generation total time  0.04741668701171875
average batch blocks generation time:  0.011854171752929688
block dataloader generation time/epoch 0.12557458877563477
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.029736995697021484  GigaBytes
Max Memory Allocated: 0.041933536529541016  GigaBytes

torch.Size([2342, 1433])
torch.Size([2074, 256])
torch.Size([1434, 256])
torch.Size([619, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.04632282257080078  GigaBytes
Max Memory Allocated: 0.04648303985595703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02973461151123047  GigaBytes
Max Memory Allocated: 0.04681587219238281  GigaBytes

torch.Size([2358, 1433])
torch.Size([2137, 256])
torch.Size([1647, 256])
torch.Size([830, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04833555221557617  GigaBytes
Max Memory Allocated: 0.04854154586791992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.030814647674560547  GigaBytes
Max Memory Allocated: 0.049040794372558594  GigaBytes

torch.Size([2417, 1433])
torch.Size([2189, 256])
torch.Size([1599, 256])
torch.Size([742, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04804277420043945  GigaBytes
Max Memory Allocated: 0.049040794372558594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.02947521209716797  GigaBytes
Max Memory Allocated: 0.049040794372558594  GigaBytes

torch.Size([2305, 1433])
torch.Size([2012, 256])
torch.Size([1395, 256])
torch.Size([655, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.04485893249511719  GigaBytes
Max Memory Allocated: 0.049040794372558594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003976225852966309 |0.001017749309539795 |0.007006406784057617 |0.0001315474510192871 |0.0035310983657836914 |0.002287626266479492 |
----------------------------------------------------------pseudo_mini_loss sum 2.9814038276672363
Total (block generation + training)time/epoch 0.19698143005371094
Training time/epoch 0.07055211067199707
Training time without block to device /epoch 0.06648111343383789
Training time without total dataloading part /epoch 0.044963836669921875
load block tensor time/epoch 0.015904903411865234
block to device time/epoch 0.00407099723815918
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27489
Number of first layer input nodes during this epoch:  9422
