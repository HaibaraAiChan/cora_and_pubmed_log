main start at this time 1648432171.1745646
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012819766998291016
random selection method range initialization spend 0.00021886825561523438
time for parepare:  6.365776062011719e-05
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0024886131286621094
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
----------------------check_connections_block total spend ----------------------------- 0.004404783248901367
generate_one_block  0.0014755725860595703
generate_one_block  0.0011665821075439453
generate_one_block  0.001081705093383789
generate_one_block  0.0010771751403808594
generate_one_block  0.0010886192321777344
generate_one_block  0.0010883808135986328
generate_one_block  0.0010883808135986328
generate_one_block  0.0010693073272705078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004863739013671875
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.0001423358917236328
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00024628639221191406
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.000240325927734375
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00021600723266601562
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002391338348388672
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002586841583251953
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00022554397583007812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00011920928955078125
----------------------check_connections_block total spend ----------------------------- 0.0040051937103271484
generate_one_block  0.0013556480407714844
generate_one_block  0.0013535022735595703
generate_one_block  0.0013456344604492188
generate_one_block  0.0013287067413330078
generate_one_block  0.0013434886932373047
generate_one_block  0.001352548599243164
generate_one_block  0.0013093948364257812
generate_one_block  0.0011510848999023438
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006897449493408203
gen group dst list time:  9.846687316894531e-05
time for parepare:  0.00018453598022460938
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0007777214050292969
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.00086212158203125
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007979869842529297
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0008175373077392578
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0008149147033691406
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0008065700531005859
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0006666183471679688
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004177093505859375
----------------------check_connections_block total spend ----------------------------- 0.01025533676147461
generate_one_block  0.002071857452392578
generate_one_block  0.0020399093627929688
generate_one_block  0.0019054412841796875
generate_one_block  0.0019307136535644531
generate_one_block  0.0019016265869140625
generate_one_block  0.0019106864929199219
generate_one_block  0.0017330646514892578
generate_one_block  0.0015103816986083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000762939453125
gen group dst list time:  0.00018334388732910156
time for parepare:  0.000186920166015625
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0018329620361328125
local_output_nid generation:  8.893013000488281e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0018355846405029297
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0018572807312011719
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.001790761947631836
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0017750263214111328
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0017704963684082031
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0014264583587646484
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0010547637939453125
----------------------check_connections_block total spend ----------------------------- 0.02082037925720215
generate_one_block  0.0030612945556640625
generate_one_block  0.002990245819091797
generate_one_block  0.003012418746948242
generate_one_block  0.0029325485229492188
generate_one_block  0.0029222965240478516
generate_one_block  0.0030782222747802734
generate_one_block  0.002626180648803711
generate_one_block  0.002231597900390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007338523864746094
gen group dst list time:  0.00029730796813964844
time for parepare:  0.00018405914306640625
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.0004699230194091797
mini_batch_src_global generation:  0.00023245811462402344
r_  generation:  0.002618551254272461
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.0002799034118652344
r_  generation:  0.002633333206176758
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.00028586387634277344
r_  generation:  0.0027570724487304688
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0026102066040039062
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.002562284469604492
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.0025017261505126953
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.0023360252380371094
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0018699169158935547
----------------------check_connections_block total spend ----------------------------- 0.030041217803955078
generate_one_block  0.004253864288330078
generate_one_block  0.0036754608154296875
generate_one_block  0.0038416385650634766
generate_one_block  0.0037202835083007812
generate_one_block  0.004174232482910156
generate_one_block  0.0037713050842285156
generate_one_block  0.003570556640625
generate_one_block  0.0031113624572753906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.06512212753295898
block generation total time  0.07851719856262207
average batch blocks generation time:  0.009814649820327759
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0163116455078125  GigaBytes
Max Memory Allocated: 0.0163116455078125  GigaBytes

torch.Size([2239, 1433])
torch.Size([1854, 256])
torch.Size([1164, 256])
torch.Size([434, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.029814720153808594  GigaBytes
Max Memory Allocated: 0.029918670654296875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02058124542236328  GigaBytes
Max Memory Allocated: 0.03240394592285156  GigaBytes

torch.Size([2248, 1433])
torch.Size([1848, 256])
torch.Size([1150, 256])
torch.Size([448, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0334782600402832  GigaBytes
Max Memory Allocated: 0.033576011657714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.02093505859375  GigaBytes
Max Memory Allocated: 0.03391313552856445  GigaBytes

torch.Size([2314, 1433])
torch.Size([1977, 256])
torch.Size([1192, 256])
torch.Size([466, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.035587310791015625  GigaBytes
Max Memory Allocated: 0.035685062408447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.020600318908691406  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

torch.Size([2252, 1433])
torch.Size([1853, 256])
torch.Size([1120, 256])
torch.Size([473, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.03339052200317383  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02052927017211914  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

torch.Size([2170, 1433])
torch.Size([1815, 256])
torch.Size([1136, 256])
torch.Size([461, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.03356599807739258  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.020621776580810547  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

torch.Size([2256, 1433])
torch.Size([1861, 256])
torch.Size([1100, 256])
torch.Size([440, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.03467082977294922  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02051687240600586  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

torch.Size([2235, 1433])
torch.Size([1714, 256])
torch.Size([947, 256])
torch.Size([344, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.032634735107421875  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.01836872100830078  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

torch.Size([1842, 1433])
torch.Size([1317, 256])
torch.Size([670, 256])
torch.Size([214, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027273178100585938  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011502385139465332 |0.043241947889328 |0.10095661878585815 |0.00015184283256530762 |0.005029916763305664 |0.0030570030212402344 |
----------------------------------------------------------pseudo_mini_loss sum 3.851656436920166
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  44305
Number of first layer input nodes during this epoch:  17556
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027750015258789062  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005350112915039062
random selection method range initialization spend 0.00013971328735351562
time for parepare:  7.62939453125e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.001827239990234375
generate_one_block  0.001010894775390625
generate_one_block  0.0010027885437011719
generate_one_block  0.0010471343994140625
generate_one_block  0.0009698867797851562
generate_one_block  0.0009760856628417969
generate_one_block  0.0010104179382324219
generate_one_block  0.0009894371032714844
generate_one_block  0.0009636878967285156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004801750183105469
gen group dst list time:  5.6743621826171875e-05
time for parepare:  0.0001480579376220703
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002219676971435547
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001983642578125
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00034618377685546875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00019216537475585938
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00024056434631347656
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002396106719970703
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00015020370483398438
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00019121170043945312
----------------------check_connections_block total spend ----------------------------- 0.003940105438232422
generate_one_block  0.0012385845184326172
generate_one_block  0.0011835098266601562
generate_one_block  0.0014195442199707031
generate_one_block  0.0012216567993164062
generate_one_block  0.0012593269348144531
generate_one_block  0.001238107681274414
generate_one_block  0.0011677742004394531
generate_one_block  0.0011844635009765625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006635189056396484
gen group dst list time:  9.918212890625e-05
time for parepare:  0.00018548965454101562
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006394386291503906
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.00067901611328125
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.0001232624053955078
r_  generation:  0.0009946823120117188
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0007081031799316406
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0008742809295654297
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0008089542388916016
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005316734313964844
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0007121562957763672
----------------------check_connections_block total spend ----------------------------- 0.010173797607421875
generate_one_block  0.0017161369323730469
generate_one_block  0.0018153190612792969
generate_one_block  0.002103090286254883
generate_one_block  0.0017764568328857422
generate_one_block  0.001972675323486328
generate_one_block  0.001911163330078125
generate_one_block  0.0015566349029541016
generate_one_block  0.0018374919891357422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007076263427734375
gen group dst list time:  0.00018453598022460938
time for parepare:  0.0001742839813232422
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0003490447998046875
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.001668691635131836
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.00018715858459472656
r_  generation:  0.0016679763793945312
local_output_nid generation:  9.274482727050781e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.001943349838256836
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0016217231750488281
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.00018548965454101562
r_  generation:  0.0019304752349853516
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0018188953399658203
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0001480579376220703
r_  generation:  0.001402139663696289
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  0.00014138221740722656
r_  generation:  0.0014491081237792969
----------------------check_connections_block total spend ----------------------------- 0.020997047424316406
generate_one_block  0.002832651138305664
generate_one_block  0.003149271011352539
generate_one_block  0.0030829906463623047
generate_one_block  0.0028104782104492188
generate_one_block  0.0031578540802001953
generate_one_block  0.0029442310333251953
generate_one_block  0.002516031265258789
generate_one_block  0.0025968551635742188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007693767547607422
gen group dst list time:  0.0002987384796142578
time for parepare:  0.00018262863159179688
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.0004343986511230469
mini_batch_src_global generation:  0.0002040863037109375
r_  generation:  0.002444028854370117
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.00030875205993652344
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.0025298595428466797
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  0.0002491474151611328
r_  generation:  0.002593994140625
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0024330615997314453
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.002663850784301758
local_output_nid generation:  0.00016641616821289062
local_in_edges_tensor generation:  0.00036787986755371094
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.0026421546936035156
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.0002923011779785156
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.0022814273834228516
local_output_nid generation:  0.00011706352233886719
local_in_edges_tensor generation:  0.0002734661102294922
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0021905899047851562
----------------------check_connections_block total spend ----------------------------- 0.03029465675354004
generate_one_block  0.004106044769287109
generate_one_block  0.003772258758544922
generate_one_block  0.003748655319213867
generate_one_block  0.003953218460083008
generate_one_block  0.0038909912109375
generate_one_block  0.0038383007049560547
generate_one_block  0.003532886505126953
generate_one_block  0.0034322738647460938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027750015258789062  GigaBytes
Max Memory Allocated: 0.03614473342895508  GigaBytes

connection checking time:  0.06540560722351074
block generation total time  0.07796692848205566
average batch blocks generation time:  0.009745866060256958
block dataloader generation time/epoch 0.17346930503845215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02969217300415039  GigaBytes
Max Memory Allocated: 0.03940773010253906  GigaBytes

torch.Size([2237, 1433])
torch.Size([1766, 256])
torch.Size([1018, 256])
torch.Size([366, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.04216909408569336  GigaBytes
Max Memory Allocated: 0.042258262634277344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.029641151428222656  GigaBytes
Max Memory Allocated: 0.04248332977294922  GigaBytes

torch.Size([2226, 1433])
torch.Size([1857, 256])
torch.Size([1099, 256])
torch.Size([379, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.04297780990600586  GigaBytes
Max Memory Allocated: 0.04305458068847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.029912948608398438  GigaBytes
Max Memory Allocated: 0.04336881637573242  GigaBytes

torch.Size([2273, 1433])
torch.Size([1926, 256])
torch.Size([1349, 256])
torch.Size([602, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.04517793655395508  GigaBytes
Max Memory Allocated: 0.04531574249267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.029675960540771484  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

torch.Size([2233, 1433])
torch.Size([1804, 256])
torch.Size([1071, 256])
torch.Size([392, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.042835235595703125  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.030068397521972656  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

torch.Size([2303, 1433])
torch.Size([2014, 256])
torch.Size([1310, 256])
torch.Size([492, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.044879913330078125  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.030258655548095703  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

torch.Size([2340, 1433])
torch.Size([1964, 256])
torch.Size([1172, 256])
torch.Size([496, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.0445866584777832  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.02931976318359375  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

torch.Size([2169, 1433])
torch.Size([1653, 256])
torch.Size([860, 256])Using backend: pytorch

torch.Size([285, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.04000425338745117  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.02871084213256836  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

torch.Size([2054, 1433])
torch.Size([1601, 256])
torch.Size([929, 256])
torch.Size([397, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.03950691223144531  GigaBytes
Max Memory Allocated: 0.04573678970336914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003703683614730835 |0.0008250176906585693 |0.006225168704986572 |0.00011909008026123047 |0.005324572324752808 |0.002751588821411133 |
----------------------------------------------------------pseudo_mini_loss sum 3.2045695781707764
Total (block generation + training)time/epoch 0.31513190269470215
Training time/epoch 0.14135360717773438
Training time without block to device /epoch 0.13475346565246582
Training time without total dataloading part /epoch 0.09610223770141602
load block tensor time/epoch 0.02962946891784668
block to device time/epoch 0.006600141525268555
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45392
Number of first layer input nodes during this epoch:  17835
