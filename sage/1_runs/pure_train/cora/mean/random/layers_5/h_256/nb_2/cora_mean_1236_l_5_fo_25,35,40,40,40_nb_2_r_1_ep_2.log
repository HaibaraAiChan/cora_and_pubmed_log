main start at this time 1648432152.1349735
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011518001556396484
random selection method range initialization spend 0.0002193450927734375
time for parepare:  6.008148193359375e-05
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.002766847610473633
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00012683868408203125
----------------------check_connections_block total spend ----------------------------- 0.0036423206329345703
generate_one_block  0.0016121864318847656
generate_one_block  0.0011985301971435547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005173683166503906
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.0001418590545654297
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0006513595581054688
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0006375312805175781
----------------------check_connections_block total spend ----------------------------- 0.002501249313354492
generate_one_block  0.001895904541015625
generate_one_block  0.001779317855834961
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005660057067871094
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.00016498565673828125
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.001710653305053711
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0016760826110839844
----------------------check_connections_block total spend ----------------------------- 0.0054454803466796875
generate_one_block  0.0030791759490966797
generate_one_block  0.002918720245361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006210803985595703
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.0004353523254394531
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.0026307106018066406
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.0003020763397216797
r_  generation:  0.00258636474609375
----------------------check_connections_block total spend ----------------------------- 0.008299112319946289
generate_one_block  0.003942012786865234
generate_one_block  0.0038242340087890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007829666137695312
gen group dst list time:  0.00010418891906738281
time for parepare:  0.00017499923706054688
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0030786991119384766
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.00030541419982910156
r_  generation:  0.002981424331665039
----------------------check_connections_block total spend ----------------------------- 0.0092926025390625
generate_one_block  0.004437685012817383
generate_one_block  0.004093647003173828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.02553844451904297
block generation total time  0.0259706974029541
average batch blocks generation time:  0.01298534870147705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.017633438110351562  GigaBytes
Max Memory Allocated: 0.017633438110351562  GigaBytes

torch.Size([2474, 1433])
torch.Size([2346, 256])
torch.Size([1920, 256])
torch.Size([1145, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.039020538330078125  GigaBytes
Max Memory Allocated: 0.03933906555175781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.022350788116455078  GigaBytes
Max Memory Allocated: 0.0406031608581543  GigaBytes

torch.Size([2405, 1433])
torch.Size([2263, 256])
torch.Size([1887, 256])
torch.Size([1053, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.04412412643432617  GigaBytes
Max Memory Allocated: 0.0444493293762207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00966179370880127 |0.17196643352508545 |0.3887239694595337 |0.00025403499603271484 |0.006752967834472656 |0.005014896392822266 |
----------------------------------------------------------pseudo_mini_loss sum 3.8677358627319336
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16182
Number of first layer input nodes during this epoch:  4879
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03243303298950195  GigaBytes
Max Memory Allocated: 0.044788360595703125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007264614105224609
random selection method range initialization spend 0.00016760826110839844
time for parepare:  9.655952453613281e-05
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00018310546875
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001423358917236328
----------------------check_connections_block total spend ----------------------------- 0.0012125968933105469
generate_one_block  0.001695871353149414
generate_one_block  0.0016019344329833984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007085800170898438
gen group dst list time:  4.57763671875e-05
time for parepare:  0.0002307891845703125
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.00013399124145507812
r_  generation:  0.00090789794921875
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00022530555725097656Using backend: pytorch

mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0008530616760253906
----------------------check_connections_block total spend ----------------------------- 0.003539562225341797
generate_one_block  0.0025327205657958984
generate_one_block  0.002390623092651367
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008001327514648438
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.0002453327178955078
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.0004036426544189453
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.002367734909057617
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00034737586975097656
mini_batch_src_global generation:  0.0003349781036376953
r_  generation:  0.0023314952850341797
----------------------check_connections_block total spend ----------------------------- 0.0077362060546875
generate_one_block  0.004018068313598633
generate_one_block  0.0037076473236083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008111000061035156
gen group dst list time:  0.00012302398681640625
time for parepare:  0.0002391338348388672
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.00034809112548828125
r_  generation:  0.003564119338989258
local_output_nid generation:  0.0001914501190185547
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0003762245178222656
r_  generation:  0.0036046504974365234
----------------------check_connections_block total spend ----------------------------- 0.011244058609008789
generate_one_block  0.00475001335144043
generate_one_block  0.0038826465606689453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007987022399902344
gen group dst list time:  0.00015234947204589844
time for parepare:  0.0002455711364746094
local_output_nid generation:  0.00021648406982421875
local_in_edges_tensor generation:  0.0005762577056884766
mini_batch_src_global generation:  0.0003437995910644531
r_  generation:  0.004038810729980469
local_output_nid generation:  0.00023627281188964844
local_in_edges_tensor generation:  0.0005009174346923828
mini_batch_src_global generation:  0.00042510032653808594
r_  generation:  0.004143238067626953
----------------------check_connections_block total spend ----------------------------- 0.012665987014770508
generate_one_block  0.0048253536224365234
generate_one_block  0.004216670989990234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03243303298950195  GigaBytes
Max Memory Allocated: 0.044788360595703125  GigaBytes

connection checking time:  0.035185813903808594
block generation total time  0.03032374382019043
average batch blocks generation time:  0.015161871910095215
block dataloader generation time/epoch 0.11899876594543457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03237295150756836  GigaBytes
Max Memory Allocated: 0.04501914978027344  GigaBytes

torch.Size([2426, 1433])
torch.Size([2274, 256])
torch.Size([1862, 256])
torch.Size([1114, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.05391073226928711  GigaBytes
Max Memory Allocated: 0.05426359176635742  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03232860565185547  GigaBytes
Max Memory Allocated: 0.05463075637817383  GigaBytes

torch.Size([2465, 1433])
torch.Size([2335, 256])
torch.Size([1918, 256])
torch.Size([1113, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.05460405349731445  GigaBytes
Max Memory Allocated: 0.05516624450683594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019757747650146484 |0.0010813474655151367 |0.0075942277908325195 |0.0001493692398071289 |0.005479097366333008 |0.0030851364135742188 |
----------------------------------------------------------pseudo_mini_loss sum 2.6413753032684326
Total (block generation + training)time/epoch 0.19431853294372559
Training time/epoch 0.07462143898010254
Training time without block to device /epoch 0.07245874404907227
Training time without total dataloading part /epoch 0.02953052520751953
load block tensor time/epoch 0.03951549530029297
block to device time/epoch 0.0021626949310302734
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16211
Number of first layer input nodes during this epoch:  4891
