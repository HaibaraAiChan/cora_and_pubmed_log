main start at this time 1648432055.7898207
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006475448608398438
random selection method range initialization spend 0.00016117095947265625
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0011310577392578125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.457069396972656e-05
----------------------check_connections_block total spend ----------------------------- 0.003001689910888672
generate_one_block  0.001367330551147461
generate_one_block  0.0010907649993896484
generate_one_block  0.0010066032409667969
generate_one_block  0.0010063648223876953
generate_one_block  0.0009899139404296875
generate_one_block  0.0010018348693847656
generate_one_block  0.0034873485565185547
generate_one_block  0.0010461807250976562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010218620300292969
gen group dst list time:  5.364418029785156e-05
time for parepare:  0.0001347064971923828
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002589225769042969
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002474784851074219
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00021529197692871094
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00023055076599121094
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002067089080810547
----------------------check_connections_block total spend ----------------------------- 0.0039598941802978516
generate_one_block  0.001340627670288086
generate_one_block  0.0012831687927246094
generate_one_block  0.0011868476867675781
generate_one_block  0.0012707710266113281
generate_one_block  0.0011501312255859375
generate_one_block  0.0012118816375732422
generate_one_block  0.001238107681274414
generate_one_block  0.0012171268463134766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006177425384521484
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.0001800060272216797
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.000888824462890625
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0008404254913330078
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0006277561187744141
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0008251667022705078
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005214214324951172
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0007016658782958984
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0007889270782470703
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0006823539733886719
----------------------check_connections_block total spend ----------------------------- 0.0100555419921875
generate_one_block  0.002132415771484375
generate_one_block  0.0019423961639404297
generate_one_block  0.0017168521881103516
generate_one_block  0.0019550323486328125
generate_one_block  0.0015988349914550781
generate_one_block  0.0018041133880615234
generate_one_block  0.002145528793334961
generate_one_block  0.0017991065979003906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007266998291015625
gen group dst list time:  0.00018477439880371094
time for parepare:  0.0001728534698486328
local_output_nid generation:  8.20159912109375e-05
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.001865386962890625
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.0017993450164794922
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0015320777893066406
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0017659664154052734
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.00142669677734375
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0015916824340820312
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.0018739700317382812
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0016155242919921875
----------------------check_connections_block total spend ----------------------------- 0.02085590362548828
generate_one_block  0.0030994415283203125
generate_one_block  0.003000974655151367
generate_one_block  0.0026657581329345703
generate_one_block  0.003088235855102539
generate_one_block  0.0026450157165527344
generate_one_block  0.002953052520751953
generate_one_block  0.00388336181640625
generate_one_block  0.002785921096801758
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000728607177734375
gen group dst list time:  0.0004115104675292969
time for parepare:  0.0001773834228515625
local_output_nid generation:  0.00012230873107910156
local_in_edges_tensor generation:  0.0004448890686035156
mini_batch_src_global generation:  0.00022792816162109375
r_  generation:  0.002542734146118164
local_output_nid generation:  0.000133514404296875
local_in_edges_tensor generation:  0.0003170967102050781
mini_batch_src_global generation:  0.00028204917907714844
r_  generation:  0.002641916275024414
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.0003008842468261719
mini_batch_src_global generation:  0.00021505355834960938
r_  generation:  0.0023038387298583984
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.0025327205657958984
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0024547576904296875
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0023970603942871094
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.002726316452026367
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.0002892017364501953
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.0024137496948242188
----------------------check_connections_block total spend ----------------------------- 0.03014230728149414
generate_one_block  0.003827810287475586
generate_one_block  0.0039052963256835938
generate_one_block  0.003568410873413086
generate_one_block  0.004536867141723633
generate_one_block  0.004197835922241211
generate_one_block  0.0035245418548583984
generate_one_block  0.003795623779296875
generate_one_block  0.0035812854766845703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

connection checking time:  0.06501364707946777
block generation total time  0.08005237579345703
average batch blocks generation time:  0.010006546974182129
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.012549400329589844  GigaBytes
Max Memory Allocated: 0.012549400329589844  GigaBytes

torch.Size([2254, 1433])
torch.Size([1941, 32])
torch.Size([1291, 32])
torch.Size([563, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.014481067657470703  GigaBytes
Max Memory Allocated: 0.014492511749267578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013410091400146484  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2346, 1433])
torch.Size([1978, 32])
torch.Size([1227, 32])
torch.Size([477, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015275001525878906  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01262044906616211  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2202, 1433])
torch.Size([1711, 32])
torch.Size([973, 32])
torch.Size([370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014153003692626953  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012986183166503906  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2267, 1433])
torch.Size([1906, 32])
torch.Size([1190, 32])
torch.Size([509, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01480865478515625  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012911796569824219  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2257, 1433])
torch.Size([1791, 32])
torch.Size([925, 32])
torch.Size([313, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014416694641113281  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01231527328491211  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2144, 1433])
torch.Size([1748, 32])
torch.Size([1038, 32])
torch.Size([408, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01392364501953125  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013166427612304688  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2300, 1433])
torch.Size([1990, 32])
torch.Size([1264, 32])
torch.Size([457, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01503610610961914  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012759208679199219  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

torch.Size([2227, 1433])
torch.Size([1782, 32])
torch.Size([1072, 32])
torch.Size([382, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.0143890380859375  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00562635064125061 |0.04437267780303955 |0.1003102958202362 |0.00014188885688781738 |0.0039362311363220215 |0.002867460250854492 |
----------------------------------------------------------pseudo_mini_loss sum 4.0602617263793945
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  46064
Number of first layer input nodes during this epoch:  17997
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013777732849121094  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004649162292480469
random selection method range initialization spend 0.00011944770812988281
time for parepare:  6.4849853515625e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.574920654296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0018050670623779297
generate_one_block  0.0010998249053955078
generate_one_block  0.0010266304016113281
generate_one_block  0.0010542869567871094
generate_one_block  0.0010318756103515625
generate_one_block  0.0010271072387695312
generate_one_block  0.0010204315185546875
generate_one_block  0.0010170936584472656
generate_one_block  0.0010137557983398438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004775524139404297
gen group dst list time:  5.602836608886719e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002484321594238281
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.0003094673156738281
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00026345252990722656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00025343894958496094
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013446807861328125
----------------------check_connections_block total spend ----------------------------- 0.0040242671966552734
generate_one_block  0.0013146400451660156
generate_one_block  0.0011813640594482422
generate_one_block  0.0014722347259521484
generate_one_block  0.0013051033020019531
generate_one_block  0.0012354850769042969
generate_one_block  0.0012900829315185547
generate_one_block  0.0012259483337402344
generate_one_block  0.0011031627655029297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006308555603027344
gen group dst list time:  0.00010204315185546875
time for parepare:  0.00019407272338867188
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0008523464202880859
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0005888938903808594
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0009791851043701172
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0007712841033935547
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.000698089599609375
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0008027553558349609
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  8.463859558105469e-05
r_  generation:  0.0007021427154541016
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0004494190216064453
----------------------check_connections_block total spend ----------------------------- 0.010120630264282227
generate_one_block  0.002040863037109375
generate_one_block  0.0016734600067138672
generate_one_block  0.0020647048950195312
generate_one_block  0.001810312271118164
generate_one_block  0.0017461776733398438
generate_one_block  0.0018658638000488281
generate_one_block  0.001735687255859375
generate_one_block  0.0015499591827392578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007395744323730469
gen group dst list time:  0.0001881122589111328
time for parepare:  0.00019407272338867188
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.0004024505615234375
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.0019102096557617188
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0016095638275146484
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.0020377635955810547
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0016705989837646484
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0016236305236816406
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.0017347335815429688
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.001556396484375
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.001255035400390625
----------------------check_connections_block total spend ----------------------------- 0.020966768264770508
generate_one_block  0.0032417774200439453
generate_one_block  0.0026907920837402344
generate_one_block  0.0031392574310302734
generate_one_block  0.0027763843536376953
generate_one_block  0.002694845199584961
generate_one_block  0.0028619766235351562
generate_one_block  0.0027625560760498047
generate_one_block  0.002429485321044922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007441043853759766
gen group dst list time:  0.000362396240234375
time for parepare:  0.00020575523376464844
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.0004508495330810547
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0027370452880859375
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.00026345252990722656
r_  generation:  0.0025429725646972656
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.0002377033233642578
r_  generation:  0.0028145313262939453
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0026438236236572266
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0025658607482910156
local_output_nid generation:  0.00013136863708496094
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.002530813217163086
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0023488998413085938
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  0.0002014636993408203
r_  generation:  0.0022115707397460938
----------------------check_connections_block total spend ----------------------------- 0.03078174591064453
generate_one_block  0.004309654235839844
generate_one_block  0.0036661624908447266
generate_one_block  0.003879070281982422
generate_one_block  0.004021644592285156
generate_one_block  0.0036704540252685547
generate_one_block  0.004077911376953125
generate_one_block  0.0035881996154785156
generate_one_block  0.0034384727478027344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013777732849121094  GigaBytes
Max Memory Allocated: 0.025307178497314453  GigaBytes

connection checking time:  0.06589341163635254
block generation total time  0.07786369323730469
average batch blocks generation time:  0.009732961654663086
block dataloader generation time/epoch 0.17373132705688477
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01396322250366211  GigaBytes
Max Memory Allocated: 0.025716781616210938  GigaBytes

torch.Size([2311, 1433])
torch.Size([1945, 32])
torch.Size([1196, 32])
torch.Size([484, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015788555145263672  GigaBytes
Max Memory Allocated: 0.025716781616210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013203144073486328  GigaBytes
Max Memory Allocated: 0.025716781616210938  GigaBytes

torch.Size([2172, 1433])
torch.Size([1773, 32])
torch.Size([987, 32])
torch.Size([302, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014737129211425781  GigaBytes
Max Memory Allocated: 0.025716781616210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013881206512451172  GigaBytes
Max Memory Allocated: 0.025716781616210938  GigaBytes

torch.Size([2294, 1433])
torch.Size([1988, 32])
torch.Size([1327, 32])
torch.Size([576, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015870094299316406  GigaBytes
Max Memory Allocated: 0.025716781616210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013782978057861328  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

torch.Size([2279, 1433])
torch.Size([1838, 32])
torch.Size([1050, 32])
torch.Size([427, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015460491180419922  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013425827026367188  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

torch.Size([2213, 1433])
torch.Size([1771, 32])
torch.Size([1006, 32])
torch.Size([374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015008926391601562  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013704776763916016  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

torch.Size([2264, 1433])
torch.Size([1844, 32])
torch.Size([1072, 32])
torch.Size([450, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015400409698486328  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013102531433105469  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

torch.Size([2153, 1433])
torch.Size([1730, 32])Using backend: pytorch

torch.Size([1006, 32])
torch.Size([401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014678478240966797  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01297760009765625  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

torch.Size([2133, 1433])
torch.Size([1595, 32])
torch.Size([786, 32])
torch.Size([242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01427459716796875  GigaBytes
Max Memory Allocated: 0.025905132293701172  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003584623336791992 |0.0008074939250946045 |0.005899786949157715 |0.00011038780212402344 |0.0035960376262664795 |0.002208709716796875 |
----------------------------------------------------------pseudo_mini_loss sum 3.4658150672912598
Total (block generation + training)time/epoch 0.29761695861816406
Training time/epoch 0.12368130683898926
Training time without block to device /epoch 0.11722135543823242
Training time without total dataloading part /epoch 0.07905840873718262
load block tensor time/epoch 0.028676986694335938
block to device time/epoch 0.006459951400756836
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44741
Number of first layer input nodes during this epoch:  17819
