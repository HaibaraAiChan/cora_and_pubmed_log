main start at this time 1648432037.0923395
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013425350189208984
random selection method range initialization spend 0.0002155303955078125
time for parepare:  6.4849853515625e-05
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0028247833251953125
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00011587142944335938
----------------------check_connections_block total spend ----------------------------- 0.003695964813232422
generate_one_block  0.00164794921875
generate_one_block  0.0012054443359375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005180835723876953
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.00014495849609375
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0007069110870361328
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006711483001708984
----------------------check_connections_block total spend ----------------------------- 0.002613544464111328
generate_one_block  0.0019474029541015625
generate_one_block  0.00182342529296875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005962848663330078
gen group dst list time:  5.841255187988281e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0003495216369628906
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0018126964569091797
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.00018930435180664062
r_  generation:  0.0018045902252197266
----------------------check_connections_block total spend ----------------------------- 0.005789518356323242
generate_one_block  0.003140687942504883
generate_one_block  0.0030689239501953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006191730499267578
gen group dst list time:  8.845329284667969e-05
time for parepare:  0.0001850128173828125
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.00041604042053222656
mini_batch_src_global generation:  0.0001919269561767578
r_  generation:  0.002742767333984375
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.0027513504028320312
----------------------check_connections_block total spend ----------------------------- 0.008538007736206055
generate_one_block  0.004009723663330078
generate_one_block  0.00433802604675293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007758140563964844
gen group dst list time:  0.00010991096496582031
time for parepare:  0.0001881122589111328
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0005164146423339844
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0031766891479492188
local_output_nid generation:  0.00016808509826660156
local_in_edges_tensor generation:  0.0003769397735595703
mini_batch_src_global generation:  0.00036144256591796875
r_  generation:  0.003129243850708008
----------------------check_connections_block total spend ----------------------------- 0.009815692901611328
generate_one_block  0.0045244693756103516
generate_one_block  0.004188060760498047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

connection checking time:  0.026756763458251953
block generation total time  0.027040719985961914
average batch blocks generation time:  0.013520359992980957
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014247894287109375  GigaBytes
Max Memory Allocated: 0.014247894287109375  GigaBytes

torch.Size([2463, 1433])
torch.Size([2346, 32])
torch.Size([1938, 32])
torch.Size([1181, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.01717996597290039  GigaBytes
Max Memory Allocated: 0.017216205596923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014620780944824219  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

torch.Size([2459, 1433])
torch.Size([2332, 32])
torch.Size([1945, 32])
torch.Size([1129, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01750659942626953  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011907577514648438 |0.17086565494537354 |0.3889193534851074 |0.00021982192993164062 |0.007029891014099121 |0.0032079219818115234 |
----------------------------------------------------------pseudo_mini_loss sum 4.042133331298828
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16500
Number of first layer input nodes during this epoch:  4922
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015811920166015625  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006194114685058594
random selection method range initialization spend 0.00015044212341308594
time for parepare:  9.846687316894531e-05
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0001685619354248047
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00013375282287597656
----------------------check_connections_block total spend ----------------------------- 0.0010898113250732422
generate_one_block  0.0015239715576171875
generate_one_block  0.00142669677734375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005979537963867188
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00021576881408691406
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0009589195251464844
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00018715858459472656Using backend: pytorch

mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0008199214935302734
----------------------check_connections_block total spend ----------------------------- 0.003470182418823242
generate_one_block  0.0024192333221435547
generate_one_block  0.0021729469299316406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006859302520751953
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.0002372264862060547
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.0024340152740478516
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.0003037452697753906
r_  generation:  0.0021822452545166016
----------------------check_connections_block total spend ----------------------------- 0.007599353790283203
generate_one_block  0.00393366813659668
generate_one_block  0.003613710403442383
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006902217864990234
gen group dst list time:  0.00012111663818359375
time for parepare:  0.00024008750915527344
local_output_nid generation:  0.00017595291137695312
local_in_edges_tensor generation:  0.0005092620849609375
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0035512447357177734
local_output_nid generation:  0.00018596649169921875
local_in_edges_tensor generation:  0.0004019737243652344
mini_batch_src_global generation:  0.00035071372985839844
r_  generation:  0.0035562515258789062
----------------------check_connections_block total spend ----------------------------- 0.01097559928894043
generate_one_block  0.004837751388549805
generate_one_block  0.0037834644317626953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007696151733398438
gen group dst list time:  0.00014972686767578125
time for parepare:  0.00024127960205078125
local_output_nid generation:  0.00021266937255859375
local_in_edges_tensor generation:  0.0005438327789306641
mini_batch_src_global generation:  0.00033402442932128906
r_  generation:  0.0040378570556640625
local_output_nid generation:  0.00022983551025390625
local_in_edges_tensor generation:  0.00045228004455566406
mini_batch_src_global generation:  0.00041794776916503906
r_  generation:  0.00406193733215332
----------------------check_connections_block total spend ----------------------------- 0.01242971420288086
generate_one_block  0.004943370819091797
generate_one_block  0.004154205322265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015811920166015625  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

connection checking time:  0.034474849700927734
block generation total time  0.02985835075378418
average batch blocks generation time:  0.01492917537689209
block dataloader generation time/epoch 0.08389782905578613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015364646911621094  GigaBytes
Max Memory Allocated: 0.028837203979492188  GigaBytes

torch.Size([2463, 1433])
torch.Size([2323, 32])
torch.Size([1952, 32])
torch.Size([1211, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018324851989746094  GigaBytes
Max Memory Allocated: 0.028837203979492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015357017517089844  GigaBytes
Max Memory Allocated: 0.028838157653808594  GigaBytes

torch.Size([2445, 1433])
torch.Size([2312, 32])
torch.Size([1902, 32])
torch.Size([1068, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018157482147216797  GigaBytes
Max Memory Allocated: 0.028838157653808594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002256155014038086 |0.0008766651153564453 |0.006134629249572754 |0.00014662742614746094 |0.003968715667724609 |0.0024843215942382812 |
----------------------------------------------------------pseudo_mini_loss sum 3.7385878562927246
Total (block generation + training)time/epoch 0.1160879135131836
Training time/epoch 0.0319981575012207
Training time without block to device /epoch 0.030244827270507812
Training time without total dataloading part /epoch 0.02298426628112793
load block tensor time/epoch 0.004512310028076172
block to device time/epoch 0.0017533302307128906
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16381
Number of first layer input nodes during this epoch:  4908
