main start at this time 1648432046.3711948
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001196146011352539
random selection method range initialization spend 0.00019359588623046875
time for parepare:  6.103515625e-05
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0023813247680664062
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.246566772460938e-05
----------------------check_connections_block total spend ----------------------------- 0.0035359859466552734
generate_one_block  0.0012814998626708984
generate_one_block  0.0010340213775634766
generate_one_block  0.0010821819305419922
generate_one_block  0.0010330677032470703
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004756450653076172
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.00012731552124023438
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0004353523254394531
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00038552284240722656
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00028967857360839844
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0004317760467529297
----------------------check_connections_block total spend ----------------------------- 0.0029990673065185547
generate_one_block  0.0015630722045898438
generate_one_block  0.0014257431030273438
generate_one_block  0.0012927055358886719
generate_one_block  0.0014927387237548828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005478858947753906
gen group dst list time:  8.225440979003906e-05
time for parepare:  0.00016117095947265625
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0012669563293457031
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0012030601501464844
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0009512901306152344
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0013480186462402344
----------------------check_connections_block total spend ----------------------------- 0.00770258903503418
generate_one_block  0.0025870800018310547
generate_one_block  0.002369403839111328
generate_one_block  0.0020940303802490234
generate_one_block  0.0025491714477539062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007181167602539062
gen group dst list time:  0.00012969970703125
time for parepare:  0.00016951560974121094
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.0004131793975830078
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.002272367477416992
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.0002751350402832031
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.002177000045776367
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0019974708557128906
local_output_nid generation:  0.00011420249938964844
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.002371072769165039
----------------------check_connections_block total spend ----------------------------- 0.013468027114868164
generate_one_block  0.0037081241607666016
generate_one_block  0.0034036636352539062
generate_one_block  0.0032236576080322266
generate_one_block  0.003733396530151367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007481575012207031
gen group dst list time:  0.00018143653869628906
time for parepare:  0.00017380714416503906
local_output_nid generation:  0.00013709068298339844
local_in_edges_tensor generation:  0.00047135353088378906
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0028753280639648438
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.0003273487091064453
mini_batch_src_global generation:  0.0002880096435546875
r_  generation:  0.0027675628662109375
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.002722501754760742
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.002862691879272461
----------------------check_connections_block total spend ----------------------------- 0.016971588134765625
generate_one_block  0.004786491394042969
generate_one_block  0.003949403762817383
generate_one_block  0.0038995742797851562
generate_one_block  0.004014730453491211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

connection checking time:  0.04114127159118652
block generation total time  0.046092987060546875
average batch blocks generation time:  0.011523246765136719
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014218807220458984  GigaBytes
Max Memory Allocated: 0.014218807220458984  GigaBytes

torch.Size([2401, 1433])
torch.Size([2186, 32])
torch.Size([1647, 32])
torch.Size([808, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.016639232635498047  GigaBytes
Max Memory Allocated: 0.01666116714477539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013557910919189453  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

torch.Size([2369, 1433])
torch.Size([2141, 32])
torch.Size([1552, 32])
torch.Size([749, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01584625244140625  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01351165771484375  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

torch.Size([2363, 1433])
torch.Size([2070, 32])
torch.Size([1376, 32])
torch.Size([577, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015567302703857422  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014597415924072266  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

torch.Size([2409, 1433])
torch.Size([2222, 32])
torch.Size([1720, 32])
torch.Size([841, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017084121704101562  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011881053447723389 |0.08644527196884155 |0.19586724042892456 |0.00017273426055908203 |0.004591703414916992 |0.0031282901763916016 |
----------------------------------------------------------pseudo_mini_loss sum 3.8958377838134766
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  28176
Number of first layer input nodes during this epoch:  9542
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015738487243652344  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005860328674316406
random selection method range initialization spend 0.0001366138458251953
time for parepare:  8.797645568847656e-05
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001010894775390625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.82012939453125e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.0558319091796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0014545917510986328
generate_one_block  0.0014126300811767578
generate_one_block  0.0013682842254638672
generate_one_block  0.0013310909271240234
generate_one_block  0.0013272762298583984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005931854248046875
gen group dst list time:  5.245208740234375e-05
time for parepare:  0.00019598007202148438
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004673004150390625
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0006701946258544922
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0004544258117675781
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00045990943908691406
----------------------check_connections_block total spend ----------------------------- 0.004021167755126953
generate_one_block  0.0018067359924316406
generate_one_block  0.0019998550415039062
generate_one_block  0.0018134117126464844
generate_one_block  0.0017669200897216797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006818771362304688
gen group dst list time:  0.00011014938354492188
time for parepare:  0.00023102760314941406
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0003497600555419922
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0015895366668701172
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0018901824951171875
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.0001728534698486328
r_  generation:  0.0013871192932128906
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.0001697540283203125
r_  generation:  0.0015935897827148438
----------------------check_connections_block total spend ----------------------------- 0.010500431060791016
generate_one_block  0.003166675567626953
generate_one_block  0.0027725696563720703
generate_one_block  0.002146005630493164
generate_one_block  0.0023107528686523438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007467269897460938
gen group dst list time:  0.0001876354217529297
time for parepare:  0.00024366378784179688
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0004680156707763672
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.0031194686889648438
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00037407875061035156
mini_batch_src_global generation:  0.0003218650817871094
r_  generation:  0.003052234649658203
local_output_nid generation:  0.00014710426330566406
local_in_edges_tensor generation:  0.0003383159637451172
mini_batch_src_global generation:  0.0002639293670654297
r_  generation:  0.0027315616607666016
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.0002803802490234375
r_  generation:  0.0024347305297851562
----------------------check_connections_block total spend ----------------------------- 0.01764059066772461
generate_one_block  0.0038726329803466797
generate_one_block  0.003480672836303711
generate_one_block  0.0033273696899414062
generate_one_block  0.003419160842895508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007550716400146484
gen group dst list time:  0.0002598762512207031
time for parepare:  0.00024437904357910156
local_output_nid generation:  0.00020599365234375
local_in_edges_tensor generation:  0.0005648136138916016
mini_batch_src_global generation:  0.00027942657470703125
r_  generation:  0.0036013126373291016
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.0003352165222167969
r_  generation:  0.0031366348266601562
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.00035262107849121094
mini_batch_src_global generation:  0.00025534629821777344
r_  generation:  0.003001689910888672
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation: Using backend: pytorch
 0.0002589225769042969
r_  generation:  0.003116130828857422
----------------------check_connections_block total spend ----------------------------- 0.019600868225097656
generate_one_block  0.00445246696472168
generate_one_block  0.004046440124511719
generate_one_block  0.0038442611694335938
generate_one_block  0.003953695297241211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015738487243652344  GigaBytes
Max Memory Allocated: 0.027069091796875  GigaBytes

connection checking time:  0.051763057708740234
block generation total time  0.04817962646484375
average batch blocks generation time:  0.012044906616210938
block dataloader generation time/epoch 0.1515491008758545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015327930450439453  GigaBytes
Max Memory Allocated: 0.028835296630859375  GigaBytes

torch.Size([2394, 1433])
torch.Size([2191, 32])
torch.Size([1613, 32])
torch.Size([709, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017653942108154297  GigaBytes
Max Memory Allocated: 0.028835296630859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01533651351928711  GigaBytes
Max Memory Allocated: 0.02883625030517578  GigaBytes

torch.Size([2388, 1433])
torch.Size([2174, 32])
torch.Size([1639, 32])
torch.Size([865, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017794132232666016  GigaBytes
Max Memory Allocated: 0.02883625030517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014043807983398438  GigaBytes
Max Memory Allocated: 0.02883625030517578  GigaBytes

torch.Size([2323, 1433])
torch.Size([2041, 32])
torch.Size([1396, 32])
torch.Size([602, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01612377166748047  GigaBytes
Max Memory Allocated: 0.02883625030517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015323162078857422  GigaBytes
Max Memory Allocated: 0.02883625030517578  GigaBytes

torch.Size([2381, 1433])
torch.Size([2146, 32])
torch.Size([1549, 32])
torch.Size([729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017591476440429688  GigaBytes
Max Memory Allocated: 0.02883625030517578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003734588623046875 |0.0008219480514526367 |0.006023585796356201 |0.00013053417205810547 |0.005552172660827637 |0.0025153160095214844 |
----------------------------------------------------------pseudo_mini_loss sum 4.031508922576904
Total (block generation + training)time/epoch 0.22440576553344727
Training time/epoch 0.07239747047424316
Training time without block to device /epoch 0.06910967826843262
Training time without total dataloading part /epoch 0.04934048652648926
load block tensor time/epoch 0.0149383544921875
block to device time/epoch 0.003287792205810547
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27880
Number of first layer input nodes during this epoch:  9486
