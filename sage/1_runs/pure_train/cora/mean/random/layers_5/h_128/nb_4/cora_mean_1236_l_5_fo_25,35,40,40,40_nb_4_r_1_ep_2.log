main start at this time 1648432122.7961674
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016772747039794922
random selection method range initialization spend 0.00023627281188964844
time for parepare:  7.319450378417969e-05
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0038797855377197266
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.031990051269531e-05
----------------------check_connections_block total spend ----------------------------- 0.005117177963256836
generate_one_block  0.0013456344604492188
generate_one_block  0.0011026859283447266
generate_one_block  0.001102447509765625
generate_one_block  0.0010313987731933594
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004794597625732422
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00041294097900390625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.00040030479431152344
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00036263465881347656
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003895759582519531
----------------------check_connections_block total spend ----------------------------- 0.0031213760375976562
generate_one_block  0.001482248306274414
generate_one_block  0.0014560222625732422
generate_one_block  0.0013844966888427734
generate_one_block  0.0014834403991699219
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005710124969482422
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.00016498565673828125
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0011813640594482422
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0011725425720214844
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.00115203857421875
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0012280941009521484
----------------------check_connections_block total spend ----------------------------- 0.007656097412109375
generate_one_block  0.002483367919921875
generate_one_block  0.002360105514526367
generate_one_block  0.00231170654296875
generate_one_block  0.002339601516723633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000728607177734375
gen group dst list time:  0.0001327991485595703
time for parepare:  0.00017976760864257812
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.00039958953857421875
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.002290010452270508
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.00027251243591308594
r_  generation:  0.0021500587463378906
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.0021424293518066406
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.00019431114196777344
r_  generation:  0.002170562744140625
----------------------check_connections_block total spend ----------------------------- 0.013567209243774414
generate_one_block  0.003461599349975586
generate_one_block  0.0033714771270751953
generate_one_block  0.0033712387084960938
generate_one_block  0.003539562225341797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007417201995849609
gen group dst list time:  0.0001842975616455078
time for parepare:  0.0001780986785888672
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.002803802490234375
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.0002827644348144531
r_  generation:  0.002763986587524414
local_output_nid generation:  0.00014281272888183594
local_in_edges_tensor generation:  0.00032067298889160156
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.0027108192443847656
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.002753734588623047
----------------------check_connections_block total spend ----------------------------- 0.016750812530517578
generate_one_block  0.004716396331787109
generate_one_block  0.003934621810913086
generate_one_block  0.003876924514770508
generate_one_block  0.003927707672119141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

connection checking time:  0.04109549522399902
block generation total time  0.04550051689147949
average batch blocks generation time:  0.011375129222869873
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01558542251586914  GigaBytes
Max Memory Allocated: 0.01558542251586914  GigaBytes

torch.Size([2383, 1433])
torch.Size([2162, 128])
torch.Size([1591, 128])
torch.Size([740, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.024323463439941406  GigaBytes
Max Memory Allocated: 0.024401187896728516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.016226768493652344  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

torch.Size([2355, 1433])
torch.Size([2129, 128])
torch.Size([1538, 128])
torch.Size([700, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.024682044982910156  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015999794006347656  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

torch.Size([2313, 1433])
torch.Size([2081, 128])
torch.Size([1536, 128])
torch.Size([724, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02466440200805664  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016366958618164062  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

torch.Size([2381, 1433])
torch.Size([2109, 128])
torch.Size([1537, 128])
torch.Size([718, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.024812698364257812  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00911945104598999 |0.08640456199645996 |0.19695031642913818 |0.00018513202667236328 |0.004717051982879639 |0.003557443618774414 |
----------------------------------------------------------pseudo_mini_loss sum 4.093449115753174
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27737
Number of first layer input nodes during this epoch:  9432
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020221233367919922  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005984306335449219
random selection method range initialization spend 0.0001461505889892578
time for parepare:  9.107589721679688e-05
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.916854858398438e-05
----------------------check_connections_block total spend ----------------------------- 0.0014889240264892578
generate_one_block  0.0013921260833740234
generate_one_block  0.001310586929321289
generate_one_block  0.0013148784637451172
generate_one_block  0.0013320446014404297
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005810260772705078
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.0002033710479736328
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0005552768707275391
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.000423431396484375
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0004978179931640625
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005679130554199219
----------------------check_connections_block total spend ----------------------------- 0.004002571105957031
generate_one_block  0.0019028186798095703
generate_one_block  0.0017344951629638672
generate_one_block  0.0018591880798339844
generate_one_block  0.0018868446350097656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007042884826660156
gen group dst list time:  0.00011038780212402344
time for parepare:  0.0002377033233642578
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.0017142295837402344
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.001443624496459961
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0015554428100585938
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0017158985137939453
----------------------check_connections_block total spend ----------------------------- 0.010476350784301758
generate_one_block  0.0032155513763427734
generate_one_block  0.002404451370239258
generate_one_block  0.002284526824951172
generate_one_block  0.002418994903564453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000698089599609375
gen group dst list time:  0.00019240379333496094
time for parepare:  0.0002410411834716797
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.00044417381286621094
mini_batch_src_global generation:  0.0003025531768798828
r_  generation:  0.0031447410583496094
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0003535747528076172
mini_batch_src_global generation:  0.0003008842468261719
r_  generation:  0.002615213394165039
local_output_nid generation:  0.00011563301086425781
local_in_edges_tensor generation:  0.0002932548522949219
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.002402067184448242
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.0003027915954589844
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.0025148391723632812
----------------------check_connections_block total spend ----------------------------- 0.01643514633178711
generate_one_block  0.0039136409759521484
generate_one_block  0.0033588409423828125
generate_one_block  0.003355741500854492
generate_one_block  0.0034325122833251953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007524490356445312
gen group dst list time:  0.00020694732666015625
time for parepare:  0.00020003318786621094
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.0004374980926513672
mini_batch_src_global generation:  0.00021457672119140625
r_  generation:  0.003161191940307617
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.0003616809844970703
mini_batch_src_global generation:  0.00033211708068847656
r_  generation:  0.0031385421752929688
local_output_nid generation:  0.00015735626220703125
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.003064393997192383
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation: Using backend: pytorch
 0.0002608299255371094
r_  generation:  0.003174304962158203
----------------------check_connections_block total spend ----------------------------- 0.01894688606262207
generate_one_block  0.004305839538574219
generate_one_block  0.004068851470947266
generate_one_block  0.003893613815307617
generate_one_block  0.003962516784667969
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020221233367919922  GigaBytes
Max Memory Allocated: 0.029738903045654297  GigaBytes

connection checking time:  0.04986095428466797
block generation total time  0.04799842834472656
average batch blocks generation time:  0.01199960708618164
block dataloader generation time/epoch 0.12256979942321777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019811153411865234  GigaBytes
Max Memory Allocated: 0.03235483169555664  GigaBytes

torch.Size([2372, 1433])
torch.Size([2164, 128])
torch.Size([1633, 128])
torch.Size([794, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.028797149658203125  GigaBytes
Max Memory Allocated: 0.03235483169555664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019911766052246094  GigaBytes
Max Memory Allocated: 0.032419681549072266  GigaBytes

torch.Size([2393, 1433])
torch.Size([2155, 128])
torch.Size([1487, 128])
torch.Size([656, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02809906005859375  GigaBytes
Max Memory Allocated: 0.032419681549072266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019588947296142578  GigaBytes
Max Memory Allocated: 0.032419681549072266  GigaBytes

torch.Size([2332, 1433])
torch.Size([2087, 128])
torch.Size([1502, 128])
torch.Size([702, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02806997299194336  GigaBytes
Max Memory Allocated: 0.032419681549072266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020003318786621094  GigaBytes
Max Memory Allocated: 0.032419681549072266  GigaBytes

torch.Size([2408, 1433])
torch.Size([2167, 128])
torch.Size([1604, 128])
torch.Size([800, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02885293960571289  GigaBytes
Max Memory Allocated: 0.032419681549072266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010722041130065918 |0.0009444355964660645 |0.006305098533630371 |0.00013327598571777344 |0.005747795104980469 |0.004823923110961914 |
----------------------------------------------------------pseudo_mini_loss sum 3.013230800628662
Total (block generation + training)time/epoch 0.22952961921691895
Training time/epoch 0.10611271858215332
Training time without block to device /epoch 0.10233497619628906
Training time without total dataloading part /epoch 0.05356860160827637
load block tensor time/epoch 0.04288816452026367
block to device time/epoch 0.003777742385864258
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27983
Number of first layer input nodes during this epoch:  9505
