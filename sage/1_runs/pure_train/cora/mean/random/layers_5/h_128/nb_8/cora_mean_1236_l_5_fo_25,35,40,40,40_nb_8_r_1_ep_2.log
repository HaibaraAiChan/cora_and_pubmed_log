main start at this time 1648432132.2668378
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014462471008300781
random selection method range initialization spend 0.00024199485778808594
time for parepare:  8.058547973632812e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0033690929412841797
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  7.653236389160156e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.269050598144531e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.62396240234375e-05
----------------------check_connections_block total spend ----------------------------- 0.005649566650390625
generate_one_block  0.0018055438995361328
generate_one_block  0.0014984607696533203
generate_one_block  0.0013971328735351562
generate_one_block  0.0013594627380371094
generate_one_block  0.001354217529296875
generate_one_block  0.0012524127960205078
generate_one_block  0.0011610984802246094
generate_one_block  0.0011081695556640625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006043910980224609
gen group dst list time:  7.891654968261719e-05
time for parepare:  0.00019168853759765625
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002868175506591797
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003135204315185547
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003376007080078125
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00025177001953125
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00028061866760253906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002739429473876953
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0003113746643066406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00020456314086914062
----------------------check_connections_block total spend ----------------------------- 0.005024909973144531
generate_one_block  0.00167083740234375
generate_one_block  0.0016415119171142578
generate_one_block  0.0014190673828125
generate_one_block  0.001329660415649414
generate_one_block  0.0013892650604248047
generate_one_block  0.0013794898986816406
generate_one_block  0.0013208389282226562
generate_one_block  0.0011854171752929688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006756782531738281
gen group dst list time:  0.00011277198791503906
time for parepare:  0.0001971721649169922
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0003249645233154297
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0008814334869384766
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0007650852203369141
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0008571147918701172
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.000736236572265625
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0008094310760498047
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0008232593536376953
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0008382797241210938
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0005717277526855469
----------------------check_connections_block total spend ----------------------------- 0.01080012321472168
generate_one_block  0.0021386146545410156
generate_one_block  0.001992940902709961
generate_one_block  0.001950979232788086
generate_one_block  0.0018048286437988281
generate_one_block  0.0018601417541503906
generate_one_block  0.0019135475158691406
generate_one_block  0.0018541812896728516
generate_one_block  0.0016131401062011719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007097721099853516
gen group dst list time:  0.00020074844360351562
time for parepare:  0.0001933574676513672
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0003402233123779297
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.001940011978149414
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00023484230041503906
mini_batch_src_global generation:  0.00021529197692871094
r_  generation:  0.0016489028930664062
local_output_nid generation:  9.489059448242188e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00018644332885742188
r_  generation:  0.001903533935546875
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00017213821411132812
r_  generation:  0.0018017292022705078
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0018780231475830078
local_output_nid generation:  9.34600830078125e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  0.00018024444580078125
r_  generation:  0.0019211769104003906
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.001977682113647461
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0013988018035888672
----------------------check_connections_block total spend ----------------------------- 0.022359609603881836
generate_one_block  0.003060579299926758
generate_one_block  0.00267791748046875
generate_one_block  0.002900838851928711
generate_one_block  0.002817869186401367
generate_one_block  0.0029511451721191406
generate_one_block  0.003931999206542969
generate_one_block  0.0029892921447753906
generate_one_block  0.0024569034576416016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007658004760742188
gen group dst list time:  0.0003390312194824219
time for parepare:  0.0002028942108154297
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.00042724609375
mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.0028235912322998047
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.0002760887145996094
r_  generation:  0.002546072006225586
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.00033354759216308594
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0027947425842285156
local_output_nid generation:  0.00013971328735351562
local_in_edges_tensor generation:  0.0003292560577392578
mini_batch_src_global generation:  0.0002524852752685547
r_  generation:  0.002765178680419922
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003268718719482422
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.0027666091918945312
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0025801658630371094
local_output_nid generation:  0.0001342296600341797
local_in_edges_tensor generation:  0.0002989768981933594
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.0025179386138916016
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.0002028942108154297
r_  generation:  0.002184152603149414
----------------------check_connections_block total spend ----------------------------- 0.03181052207946777
generate_one_block  0.0039234161376953125
generate_one_block  0.0035283565521240234
generate_one_block  0.0038156509399414062
generate_one_block  0.003777742385864258
generate_one_block  0.004347562789916992
generate_one_block  0.004576206207275391
generate_one_block  0.003805875778198242
generate_one_block  0.0034193992614746094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

connection checking time:  0.06999516487121582
block generation total time  0.08144521713256836
average batch blocks generation time:  0.010180652141571045
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014058113098144531  GigaBytes
Max Memory Allocated: 0.014058113098144531  GigaBytes

torch.Size([2281, 1433])
torch.Size([1899, 128])
torch.Size([1177, 128])
torch.Size([467, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0206756591796875  GigaBytes
Max Memory Allocated: 0.020714282989501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015329360961914062  GigaBytes
Max Memory Allocated: 0.027390480041503906  GigaBytes

torch.Size([2097, 1433])
torch.Size([1692, 128])
torch.Size([943, 128])
torch.Size([413, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.021049976348876953  GigaBytes
Max Memory Allocated: 0.027390480041503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015668392181396484  GigaBytes
Max Memory Allocated: 0.027390480041503906  GigaBytes

torch.Size([2256, 1433])
torch.Size([1885, 128])
torch.Size([1165, 128])
torch.Size([447, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02228832244873047  GigaBytes
Max Memory Allocated: 0.027390480041503906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01554250717163086  GigaBytes
Max Memory Allocated: 0.02746438980102539  GigaBytes

torch.Size([2234, 1433])
torch.Size([1839, 128])
torch.Size([1050, 128])
torch.Size([388, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021622180938720703  GigaBytes
Max Memory Allocated: 0.02746438980102539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015482902526855469  GigaBytes
Max Memory Allocated: 0.02746438980102539  GigaBytes

torch.Size([2222, 1433])
torch.Size([1851, 128])
torch.Size([1109, 128])
torch.Size([437, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021831512451171875  GigaBytes
Max Memory Allocated: 0.02746438980102539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015709400177001953  GigaBytes
Max Memory Allocated: 0.02746438980102539  GigaBytes

torch.Size([2264, 1433])
torch.Size([1931, 128])
torch.Size([1158, 128])
torch.Size([454, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.022297382354736328  GigaBytes
Max Memory Allocated: 0.02746438980102539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01573801040649414  GigaBytes
Max Memory Allocated: 0.027694225311279297  GigaBytes

torch.Size([2269, 1433])
torch.Size([1895, 128])
torch.Size([1178, 128])
torch.Size([408, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02229928970336914  GigaBytes
Max Memory Allocated: 0.027694225311279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.015315055847167969  GigaBytes
Max Memory Allocated: 0.027694225311279297  GigaBytes

torch.Size([2139, 1433])
torch.Size([1582, 128])
torch.Size([813, 128])
torch.Size([307, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02030324935913086  GigaBytes
Max Memory Allocated: 0.027694225311279297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00427168607711792 |0.043483227491378784 |0.10187742114067078 |0.0001545250415802002 |0.00394633412361145 |0.0033528804779052734 |
----------------------------------------------------------pseudo_mini_loss sum 4.0172624588012695
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45008
Number of first layer input nodes during this epoch:  17762
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01903676986694336  GigaBytes
Max Memory Allocated: 0.027694225311279297  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004923343658447266
random selection method range initialization spend 0.00011610984802246094
time for parepare:  6.794929504394531e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.790855407714844e-05
----------------------check_connections_block total spend ----------------------------- 0.0018930435180664062
generate_one_block  0.0011188983917236328
generate_one_block  0.0011179447174072266
generate_one_block  0.0010683536529541016
generate_one_block  0.001070261001586914
generate_one_block  0.0010914802551269531
generate_one_block  0.0010733604431152344
generate_one_block  0.0010828971862792969
generate_one_block  0.0010752677917480469
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005135536193847656
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.00016689300537109375
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00022554397583007812
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0002968311309814453
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00020694732666015625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00021123886108398438
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00028777122497558594
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00027179718017578125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00021648406982421875
----------------------check_connections_block total spend ----------------------------- 0.0043027400970458984
generate_one_block  0.001331329345703125
generate_one_block  0.001425027847290039
generate_one_block  0.001367807388305664
generate_one_block  0.0012929439544677734
generate_one_block  0.0013954639434814453
generate_one_block  0.0012922286987304688
generate_one_block  0.0013725757598876953
generate_one_block  0.0012798309326171875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007035732269287109
gen group dst list time:  0.0001125335693359375
time for parepare:  0.0002276897430419922
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0007605552673339844
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0010325908660888672
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0006992816925048828
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0007462501525878906
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0009226799011230469
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007033348083496094
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0009152889251708984
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0007007122039794922
----------------------check_connections_block total spend ----------------------------- 0.011164426803588867
generate_one_block  0.0019834041595458984
generate_one_block  0.002243518829345703
generate_one_block  0.0016982555389404297
generate_one_block  0.0017840862274169922
generate_one_block  0.0019218921661376953
generate_one_block  0.0017266273498535156
generate_one_block  0.0019495487213134766
generate_one_block  0.0018045902252197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007352828979492188
gen group dst list time:  0.00020456314086914062
time for parepare:  0.00020885467529296875
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0003726482391357422
mini_batch_src_global generation:  0.00023984909057617188
r_  generation:  0.0018429756164550781
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  0.0002391338348388672
r_  generation:  0.002101898193359375
local_output_nid generation:  8.0108642578125e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0016238689422607422
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.0018968582153320312
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0019350051879882812
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0016472339630126953
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.0002009868621826172
r_  generation:  0.001855611801147461
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0015380382537841797
----------------------check_connections_block total spend ----------------------------- 0.022518634796142578
generate_one_block  0.0029783248901367188
generate_one_block  0.0030930042266845703
generate_one_block  0.002666950225830078
generate_one_block  0.0029375553131103516
generate_one_block  0.002978801727294922
generate_one_block  0.002664327621459961
generate_one_block  0.003033876419067383
generate_one_block  0.0027306079864501953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007414817810058594
gen group dst list time:  0.00038743019104003906
time for parepare:  0.00021648406982421875
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.00045680999755859375
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0026187896728515625
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.0003426074981689453
mini_batch_src_global generation:  0.0002892017364501953
r_  generation:  0.002878427505493164
local_output_nid generation:  0.00013899803161621094
local_in_edges_tensor generation:  0.0003147125244140625
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.002618074417114258
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.0003371238708496094
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.002844095230102539
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.0002512931823730469
r_  generation:  0.002828359603881836
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.0002295970916748047
r_  generation:  0.002389192581176758
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.00021958351135253906
r_  generation:  0.0025589466094970703
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0002911090850830078
mini_batch_src_global generation:  0.0002186298370361328
r_  generation:  0.002434253692626953
----------------------check_connections_block total spend ----------------------------- 0.03199625015258789
generate_one_block  0.004067420959472656
generate_one_block  0.0038657188415527344
generate_one_block  0.0035910606384277344
generate_one_block  0.004070758819580078
generate_one_block  0.0041120052337646484
generate_one_block  0.0035631656646728516
generate_one_block  0.0037827491760253906
generate_one_block  0.0036809444427490234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01903676986694336  GigaBytes
Max Memory Allocated: 0.027694225311279297  GigaBytes

connection checking time:  0.06998205184936523
block generation total time  0.07968640327453613
average batch blocks generation time:  0.009960800409317017
block dataloader generation time/epoch 0.17997479438781738
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.018535137176513672  GigaBytes
Max Memory Allocated: 0.030134201049804688  GigaBytes

torch.Size([2142, 1433])
torch.Size([1745, 128])
torch.Size([1046, 128])
torch.Size([399, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024501323699951172  GigaBytes
Max Memory Allocated: 0.030134201049804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.01934194564819336  GigaBytes
Max Memory Allocated: 0.030636310577392578  GigaBytes

torch.Size([2289, 1433])
torch.Size([1935, 128])
torch.Size([1289, 128])
torch.Size([546, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.026479244232177734  GigaBytes
Max Memory Allocated: 0.030636310577392578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.01891469955444336  GigaBytes
Max Memory Allocated: 0.031020641326904297  GigaBytes

torch.Size([2214, 1433])
torch.Size([1715, 128])
torch.Size([938, 128])
torch.Size([368, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.024514198303222656  GigaBytes
Max Memory Allocated: 0.031020641326904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.019284725189208984  GigaBytes
Max Memory Allocated: 0.031020641326904297  GigaBytes

torch.Size([2281, 1433])
torch.Size([1913, 128])
torch.Size([1130, 128])
torch.Size([402, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.025687217712402344  GigaBytes
Max Memory Allocated: 0.031020641326904297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.019242286682128906  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

torch.Size([2272, 1433])
torch.Size([1878, 128])
torch.Size([1161, 128])
torch.Size([487, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.025882720947265625  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.018815040588378906  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

torch.Size([2126, 1433])
torch.Size([1660, 128])
torch.Size([951, 128])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.024367809295654297  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.01925516128540039  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

torch.Size([2274, 1433])Using backend: pytorch

torch.Size([1916, 128])
torch.Size([1227, 128])
torch.Size([477, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.02606344223022461  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.01898670196533203  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

torch.Size([2227, 1433])
torch.Size([1788, 128])
torch.Size([976, 128])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.024780750274658203  GigaBytes
Max Memory Allocated: 0.031287193298339844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002249777317047119 |0.0007426440715789795 |0.005469530820846558 |0.00011214613914489746 |0.003432244062423706 |0.002326488494873047 |
----------------------------------------------------------pseudo_mini_loss sum 3.093926191329956
Total (block generation + training)time/epoch 0.2870514392852783
Training time/epoch 0.10674238204956055
Training time without block to device /epoch 0.10080122947692871
Training time without total dataloading part /epoch 0.07443785667419434
load block tensor time/epoch 0.017998218536376953
block to device time/epoch 0.005941152572631836
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45247
Number of first layer input nodes during this epoch:  17825
