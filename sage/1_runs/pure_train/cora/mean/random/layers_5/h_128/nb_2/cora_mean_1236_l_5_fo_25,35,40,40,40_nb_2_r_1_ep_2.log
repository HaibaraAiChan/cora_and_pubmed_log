main start at this time 1648432113.3344154
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010907649993896484
random selection method range initialization spend 0.0001747608184814453
time for parepare:  6.389617919921875e-05
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0013675689697265625
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001227855682373047
----------------------check_connections_block total spend ----------------------------- 0.0022361278533935547
generate_one_block  0.0016124248504638672
generate_one_block  0.0012559890747070312
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004978179931640625
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.00014090538024902344
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006871223449707031
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006802082061767578
----------------------check_connections_block total spend ----------------------------- 0.0026242733001708984
generate_one_block  0.0019176006317138672
generate_one_block  0.0018808841705322266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005919933319091797
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.00017523765563964844
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.0003292560577392578
mini_batch_src_global generation:  0.00015091896057128906
r_  generation:  0.0017371177673339844
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.0001785755157470703
r_  generation:  0.0018007755279541016
----------------------check_connections_block total spend ----------------------------- 0.005647897720336914
generate_one_block  0.0030913352966308594
generate_one_block  0.0030570030212402344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006096363067626953
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  0.00012111663818359375
local_in_edges_tensor generation:  0.0004143714904785156
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.002732515335083008
local_output_nid generation:  0.00013017654418945312
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  0.0002846717834472656
r_  generation:  0.002742290496826172
----------------------check_connections_block total spend ----------------------------- 0.00848078727722168
generate_one_block  0.003998517990112305
generate_one_block  0.003870725631713867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007567405700683594
gen group dst list time:  0.0001068115234375
time for parepare:  0.00018453598022460938
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.00045990943908691406
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.003102540969848633
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.00031757354736328125
r_  generation:  0.0031151771545410156
----------------------check_connections_block total spend ----------------------------- 0.00949859619140625
generate_one_block  0.004452943801879883
generate_one_block  0.00414276123046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

connection checking time:  0.026251554489135742
block generation total time  0.026411771774291992
average batch blocks generation time:  0.013205885887145996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.015615463256835938  GigaBytes
Max Memory Allocated: 0.015615463256835938  GigaBytes

torch.Size([2442, 1433])
torch.Size([2305, 128])
torch.Size([1917, 128])
torch.Size([1099, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.026349544525146484  GigaBytes
Max Memory Allocated: 0.026515483856201172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016782283782958984  GigaBytes
Max Memory Allocated: 0.030258655548095703  GigaBytes

torch.Size([2452, 1433])
torch.Size([2318, 128])
torch.Size([1922, 128])
torch.Size([1137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02836894989013672  GigaBytes
Max Memory Allocated: 0.030258655548095703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015350341796875 |0.16869497299194336 |0.3837900161743164 |0.0001977682113647461 |0.006119966506958008 |0.006585121154785156 |
----------------------------------------------------------pseudo_mini_loss sum 3.7733325958251953
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16299
Number of first layer input nodes during this epoch:  4894
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020716190338134766  GigaBytes
Max Memory Allocated: 0.030258655548095703  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006785392761230469
random selection method range initialization spend 0.0001506805419921875
time for parepare:  9.775161743164062e-05
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00016927719116210938
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00019669532775878906
----------------------check_connections_block total spend ----------------------------- 0.0012748241424560547
generate_one_block  0.0017142295837402344
generate_one_block  0.0016863346099853516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007059574127197266
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.00021457672119140625
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0006661415100097656
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00016260147094726562
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0007410049438476562
----------------------check_connections_block total spend ----------------------------- 0.0028040409088134766
generate_one_block  0.00185394287109375
generate_one_block  0.0019080638885498047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005674362182617188
gen group dst list time:  6.127357482910156e-05
time for parepare:  0.00018835067749023438
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.00032520294189453125
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.0017952919006347656
local_output_nid generation:  8.702278137207031e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0018725395202636719
----------------------check_connections_block total spend ----------------------------- 0.00598907470703125
generate_one_block  0.0030739307403564453
generate_one_block  0.0032002925872802734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006089210510253906
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.0004227161407470703
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.002765655517578125
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.0002808570861816406
r_  generation:  0.0027616024017333984
----------------------check_connections_block total spend ----------------------------- 0.00861215591430664
generate_one_block  0.004158496856689453
generate_one_block  0.003918886184692383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007572174072265625
gen group dst list time:  0.00011110305786132812
time for parepare:  0.00018477439880371094
local_output_nid generation:  0.00015401840209960938
local_in_edges_tensor generation:  0.0005023479461669922
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.0031571388244628906
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.00032329559326171875
r_  generation:  0.0031337738037109375
----------------------check_connections_block total spend ----------------------------- 0.009703397750854492
generate_one_block  0.0044248104095458984
generate_one_block  0.0041849613189697266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020716190338134766  GigaBytes
Max Memory Allocated: 0.030258655548095703  GigaBytes

connection checking time:  0.02710866928100586
block generation total time  0.026723384857177734
average batch blocks generation time:  0.013361692428588867
block dataloader generation time/epoch 0.07825613021850586
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020849227905273438  GigaBytes
Max Memory Allocated: 0.03374433517456055  GigaBytes

torch.Size([2459, 1433])
torch.Size([2343, 128])
torch.Size([1951, 128])
torch.Size([1137, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03173017501831055  GigaBytes
Max Memory Allocated: 0.03374433517456055  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020342350006103516  GigaBytes
Max Memory Allocated: 0.03381490707397461  GigaBytes

torch.Size([2465, 1433])
torch.Size([2334, 128])
torch.Size([1954, 128])
torch.Size([1177, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03203868865966797  GigaBytes
Max Memory Allocated: 0.03381490707397461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003267049789428711 |0.0009963512420654297 |0.006829380989074707 |0.0001386404037475586 |0.004690885543823242 |0.002450227737426758 |
----------------------------------------------------------pseudo_mini_loss sum 2.79084849357605
Total (block generation + training)time/epoch 0.11589431762695312
Training time/epoch 0.037311553955078125
Training time without block to device /epoch 0.035318851470947266
Training time without total dataloading part /epoch 0.025768041610717773
load block tensor time/epoch 0.006534099578857422
block to device time/epoch 0.0019927024841308594
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16523
Number of first layer input nodes during this epoch:  4924
