main start at this time 1648431176.2021105
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006923675537109375
random selection method range initialization spend 0.0001747608184814453
time for parepare:  6.747245788574219e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0015139579772949219
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.4080276489257812e-05
----------------------check_connections_block total spend ----------------------------- 0.004769802093505859
generate_one_block  0.001447916030883789
generate_one_block  0.0011467933654785156
generate_one_block  0.0010814666748046875
generate_one_block  0.0010862350463867188
generate_one_block  0.0010862350463867188
generate_one_block  0.0010809898376464844
generate_one_block  0.001070261001586914
generate_one_block  0.0010814666748046875
generate_one_block  0.0010764598846435547
generate_one_block  0.0011472702026367188
generate_one_block  0.0010895729064941406
generate_one_block  0.0010890960693359375
generate_one_block  0.0010080337524414062
generate_one_block  0.0009992122650146484
generate_one_block  0.0010101795196533203
generate_one_block  0.00098419189453125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005900859832763672
gen group dst list time:  9.489059448242188e-05
time for parepare:  0.0001499652862548828
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001556873321533203
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00010132789611816406
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.417533874511719e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001506805419921875
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00018930435180664062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00012755393981933594
----------------------check_connections_block total spend ----------------------------- 0.005806446075439453
generate_one_block  0.0012660026550292969
generate_one_block  0.001210927963256836
generate_one_block  0.001186370849609375
generate_one_block  0.0011453628540039062
generate_one_block  0.0012600421905517578
generate_one_block  0.0012128353118896484
generate_one_block  0.0011453628540039062
generate_one_block  0.0011196136474609375
generate_one_block  0.0010747909545898438
generate_one_block  0.0011913776397705078
generate_one_block  0.001093149185180664
generate_one_block  0.0011489391326904297
generate_one_block  0.0011723041534423828
generate_one_block  0.0011434555053710938
generate_one_block  0.0011725425720214844
generate_one_block  0.0011572837829589844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006804466247558594
gen group dst list time:  0.00016045570373535156
time for parepare:  0.00022339820861816406
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.000576019287109375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004303455352783203
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00026035308837890625
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0006306171417236328
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0003764629364013672
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002589225769042969
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0003230571746826172
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002968311309814453
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0006392002105712891
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00036406517028808594
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005800724029541016
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006494522094726562
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005779266357421875
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005829334259033203
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004374980926513672
----------------------check_connections_block total spend ----------------------------- 0.013527393341064453
generate_one_block  0.0017940998077392578
generate_one_block  0.0015783309936523438
generate_one_block  0.0014090538024902344
generate_one_block  0.0012884140014648438
generate_one_block  0.0016620159149169922
generate_one_block  0.0016107559204101562
generate_one_block  0.0012578964233398438
generate_one_block  0.0013468265533447266
generate_one_block  0.0012772083282470703
generate_one_block  0.0016398429870605469
generate_one_block  0.001361846923828125
generate_one_block  0.0016040802001953125
generate_one_block  0.001699209213256836
generate_one_block  0.0015861988067626953
generate_one_block  0.001653909683227539
generate_one_block  0.0014438629150390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007450580596923828
gen group dst list time:  0.0002777576446533203
time for parepare:  0.00019812583923339844
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0014801025390625
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.001220703125
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.001016855239868164
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0007503032684326172
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0015921592712402344
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0010187625885009766
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0007631778717041016
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0009796619415283203
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0008955001831054688
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.0015592575073242188
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0009746551513671875
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0013649463653564453
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0012726783752441406
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0012943744659423828
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00019598007202148438
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0012166500091552734
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0010151863098144531
----------------------check_connections_block total spend ----------------------------- 0.029613494873046875
generate_one_block  0.0026874542236328125
generate_one_block  0.003069162368774414
generate_one_block  0.0020415782928466797
generate_one_block  0.0017478466033935547
generate_one_block  0.0025849342346191406
generate_one_block  0.002069711685180664
generate_one_block  0.0018584728240966797
generate_one_block  0.001981973648071289
generate_one_block  0.0019249916076660156
generate_one_block  0.0025606155395507812
generate_one_block  0.002173900604248047
generate_one_block  0.0024590492248535156
generate_one_block  0.0024487972259521484
generate_one_block  0.002448558807373047
generate_one_block  0.0023801326751708984
generate_one_block  0.0021200180053710938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

connection checking time:  0.04894733428955078
block generation total time  0.07947111129760742
average batch blocks generation time:  0.004966944456100464
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011794567108154297  GigaBytes
Max Memory Allocated: 0.011794567108154297  GigaBytes

torch.Size([1500, 1433])
torch.Size([837, 256])
torch.Size([279, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015787601470947266  GigaBytes
Max Memory Allocated: 0.015845298767089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015354633331298828  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1470, 1433])
torch.Size([688, 256])
torch.Size([232, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018609046936035156  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013815879821777344  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1183, 1433])
torch.Size([569, 256])
torch.Size([162, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01641845703125  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013065814971923828  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1044, 1433])
torch.Size([427, 256])
torch.Size([112, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015027999877929688  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.016211986541748047  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1628, 1433])
torch.Size([927, 256])
torch.Size([303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.020593643188476562  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014132499694824219  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1242, 1433])
torch.Size([564, 256])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01684713363647461  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012687206268310547  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([973, 1433])
torch.Size([434, 256])
torch.Size([128, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014719963073730469  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0142364501953125  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1262, 1433])
torch.Size([541, 256])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016820430755615234  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014014720916748047  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1221, 1433])
torch.Size([487, 256])
torch.Size([138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016301631927490234  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016110897064208984  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1609, 1433])
torch.Size([919, 256])
torch.Size([320, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02071857452392578  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014018535614013672  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1171, 1433])
torch.Size([528, 256])
torch.Size([184, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016635417938232422  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01599407196044922  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

torch.Size([1588, 1433])
torch.Size([807, 256])
torch.Size([303, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01996135711669922  GigaBytes
Max Memory Allocated: 0.023322582244873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.01572275161743164  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

torch.Size([1537, 1433])
torch.Size([851, 256])
torch.Size([352, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.020050048828125  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.015813350677490234  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

torch.Size([1554, 1433])
torch.Size([813, 256])
torch.Size([275, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.019739627838134766  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.015522003173828125  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

torch.Size([1475, 1433])
torch.Size([808, 256])
torch.Size([278, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.01951456069946289  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.014706611633300781  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

torch.Size([1349, 1433])
torch.Size([656, 256])
torch.Size([229, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.01789236068725586  GigaBytes
Max Memory Allocated: 0.024150371551513672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003776460886001587 |0.021943747997283936 |0.052319735288619995 |0.00012737512588500977 |0.003935784101486206 |0.002756834030151367 |
----------------------------------------------------------pseudo_mini_loss sum 4.089744567871094
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37072
Number of first layer input nodes during this epoch:  21806
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02284526824951172  GigaBytes
Max Memory Allocated: 0.028312206268310547  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009925365447998047
random selection method range initialization spend 0.00011897087097167969
time for parepare:  6.389617919921875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5510787963867188e-05
----------------------check_connections_block total spend ----------------------------- 0.003021717071533203
generate_one_block  0.0010986328125
generate_one_block  0.0010523796081542969
generate_one_block  0.0010225772857666016
generate_one_block  0.0010271072387695312
generate_one_block  0.0010156631469726562
generate_one_block  0.0010242462158203125
generate_one_block  0.0010154247283935547
generate_one_block  0.0010399818420410156
generate_one_block  0.0010309219360351562
generate_one_block  0.001020193099975586
generate_one_block  0.0010700225830078125
generate_one_block  0.0009582042694091797
generate_one_block  0.0010528564453125
generate_one_block  0.0009517669677734375
generate_one_block  0.0009508132934570312
generate_one_block  0.0009558200836181641
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005955696105957031
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00015807151794433594
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011587142944335938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00012612342834472656
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00013828277587890625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00021767616271972656
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.557868957519531e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011897087097167969
----------------------check_connections_block total spend ----------------------------- 0.005624294281005859
generate_one_block  0.001233816146850586
generate_one_block  0.001148223876953125
generate_one_block  0.0011610984802246094
generate_one_block  0.0011720657348632812
generate_one_block  0.0011820793151855469
generate_one_block  0.0011758804321289062
generate_one_block  0.0011649131774902344
generate_one_block  0.0012443065643310547
generate_one_block  0.0010614395141601562
generate_one_block  0.0010154247283935547
generate_one_block  0.0011377334594726562
generate_one_block  0.0010690689086914062
generate_one_block  0.001087188720703125
generate_one_block  0.0012068748474121094
generate_one_block  0.0010988712310791016
generate_one_block  0.0010709762573242188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006864070892333984
gen group dst list time:  0.0001766681671142578
time for parepare:  0.0002200603485107422
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  8.893013000488281e-05
r_  generation:  0.0006134510040283203
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0003981590270996094
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005209445953369141
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004627704620361328
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005335807800292969
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00046539306640625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00029087066650390625
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0007464885711669922
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0003800392150878906
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00023889541625976562
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005855560302734375
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00044846534729003906
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004429817199707031
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00032901763916015625
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0004172325134277344
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00039005279541015625
----------------------check_connections_block total spend ----------------------------- 0.013451337814331055
generate_one_block  0.0017766952514648438
generate_one_block  0.0014865398406982422
generate_one_block  0.0016629695892333984
generate_one_block  0.0014951229095458984
generate_one_block  0.0016131401062011719
generate_one_block  0.0014278888702392578
generate_one_block  0.0012941360473632812
generate_one_block  0.0019252300262451172
generate_one_block  0.0013680458068847656
generate_one_block  0.001180410385131836
generate_one_block  0.0015625953674316406
generate_one_block  0.0014386177062988281
generate_one_block  0.0014109611511230469
generate_one_block  0.0012960433959960938
generate_one_block  0.0014102458953857422
generate_one_block  0.0014297962188720703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007433891296386719
gen group dst list time:  0.0003643035888671875
time for parepare:  0.0002799034118652344
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0014753341674804688
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.0010859966278076172
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0012924671173095703
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0011949539184570312
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0014319419860839844
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0010194778442382812
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0008666515350341797
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  0.00014925003051757812
r_  generation:  0.0017061233520507812
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.001100301742553711
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0006351470947265625
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.0001220703125
r_  generation:  0.0013380050659179688
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0011506080627441406
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0010972023010253906
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0008263587951660156
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0011038780212402344
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.001069784164428711
----------------------check_connections_block total spend ----------------------------- 0.029647350311279297
generate_one_block  0.0027022361755371094
generate_one_block  0.0021209716796875
generate_one_block  0.002344846725463867
generate_one_block  0.0022385120391845703
generate_one_block  0.002512693405151367
generate_one_block  0.0019910335540771484
generate_one_block  0.001888275146484375
generate_one_block  0.0030553340911865234
generate_one_block  0.002178192138671875
generate_one_block  0.0016582012176513672
generate_one_block  0.002356290817260742
generate_one_block  0.0029287338256835938
generate_one_block  0.002183675765991211
generate_one_block  0.0018849372863769531
generate_one_block  0.002274036407470703
generate_one_block  0.0022194385528564453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02284526824951172  GigaBytes
Max Memory Allocated: 0.028312206268310547  GigaBytes

connection checking time:  0.04872298240661621
block generation total time  0.07854580879211426
average batch blocks generation time:  0.004909113049507141
block dataloader generation time/epoch 0.16812777519226074
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.024162769317626953  GigaBytes
Max Memory Allocated: 0.0313115119934082  GigaBytes

torch.Size([1610, 1433])
torch.Size([906, 256])
torch.Size([334, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.028599262237548828  GigaBytes
Max Memory Allocated: 0.0313115119934082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.022754192352294922  GigaBytes
Max Memory Allocated: 0.03131246566772461  GigaBytes

torch.Size([1305, 1433])
torch.Size([622, 256])
torch.Size([192, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.0257110595703125  GigaBytes
Max Memory Allocated: 0.03131246566772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02356863021850586  GigaBytes
Max Memory Allocated: 0.03131246566772461  GigaBytes

torch.Size([1431, 1433])
torch.Size([754, 256])
torch.Size([254, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027163028717041016  GigaBytes
Max Memory Allocated: 0.03131246566772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02309417724609375  GigaBytes
Max Memory Allocated: 0.03131246566772461  GigaBytes

torch.Size([1412, 1433])
torch.Size([694, 256])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02657175064086914  GigaBytes
Max Memory Allocated: 0.03131246566772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.023945331573486328  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

torch.Size([1570, 1433])
torch.Size([826, 256])
torch.Size([268, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027836322784423828  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02174520492553711  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

torch.Size([1160, 1433])
torch.Size([587, 256])
torch.Size([238, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02480030059814453  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02140665054321289  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

torch.Size([1098, 1433])
torch.Size([469, 256])
torch.Size([135, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023597240447998047  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.025176048278808594  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

torch.Size([1798, 1433])
torch.Size([1061, 256])
torch.Size([379, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030657291412353516  GigaBytes
Max Memory Allocated: 0.03143501281738281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023560047149658203  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1437, 1433])
torch.Size([651, 256])
torch.Size([209, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02664470672607422  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.020699501037597656  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([967, 1433])
torch.Size([356, 256])
torch.Size([120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.022457122802734375  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023572444915771484  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1430, 1433])
torch.Size([788, 256])
torch.Size([293, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.027504920959472656  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.022989273071289062  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1392, 1433])
torch.Size([721, 256])
torch.Size([216, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.026324748992919922  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023563861846923828  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1328, 1433])
torch.Size([675, 256])
torch.Size([212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.026815414428710938  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.021402359008789062  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1097, 1433])
torch.Size([506, 256])
torch.Size([173, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02385854721069336  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.023563861846923828  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1460, 1433])
torch.Size([693, 256])
torch.Size([227, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.026839256286621094  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.022965431213378906  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

torch.Size([1388, 1433])
torch.Size([684, 256])
torch.Size([192, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.026122093200683594  GigaBytes
Max Memory Allocated: 0.03312206268310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006108313798904419 |0.0005912035703659058 |0.004547744989395142 |0.00011342763900756836 |0.0031236112117767334 |0.0021653175354003906 |
----------------------------------------------------------pseudo_mini_loss sum 2.171858549118042
Total (block generation + training)time/epoch 0.41962194442749023
Training time/epoch 0.2512397766113281
Training time without block to device /epoch 0.24178051948547363
Training time without total dataloading part /epoch 0.12672185897827148
load block tensor time/epoch 0.0977330207824707
block to device time/epoch 0.009459257125854492
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37347
Number of first layer input nodes during this epoch:  21883
