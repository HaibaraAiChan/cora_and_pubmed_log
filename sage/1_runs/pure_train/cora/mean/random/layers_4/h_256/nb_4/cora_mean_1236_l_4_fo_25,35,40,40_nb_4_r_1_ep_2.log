main start at this time 1648431157.2281747
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010528564453125
random selection method range initialization spend 0.0002162456512451172
time for parepare:  7.963180541992188e-05
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0022847652435302734
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010418891906738281
----------------------check_connections_block total spend ----------------------------- 0.003771543502807617
generate_one_block  0.0015573501586914062
generate_one_block  0.001384735107421875
generate_one_block  0.001402139663696289
generate_one_block  0.0014688968658447266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005779266357421875
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00018787384033203125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00039887428283691406
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004138946533203125
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0005183219909667969
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0006067752838134766
----------------------check_connections_block total spend ----------------------------- 0.0037670135498046875
generate_one_block  0.0017962455749511719
generate_one_block  0.0017671585083007812
generate_one_block  0.0018734931945800781
generate_one_block  0.001996755599975586
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006976127624511719
gen group dst list time:  9.870529174804688e-05
time for parepare:  0.00022411346435546875
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00030303001403808594
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0013875961303710938
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0013434886932373047
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00024247169494628906
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0014777183532714844
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.001676321029663086
----------------------check_connections_block total spend ----------------------------- 0.009563922882080078
generate_one_block  0.002942800521850586
generate_one_block  0.0027093887329101562
generate_one_block  0.0022988319396972656
generate_one_block  0.002471923828125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007097721099853516
gen group dst list time:  0.00017404556274414062
time for parepare:  0.0002357959747314453
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.00043773651123046875
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.0027036666870117188
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.0003464221954345703
mini_batch_src_global generation:  0.0002734661102294922
r_  generation:  0.0027790069580078125
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.0002582073211669922
r_  generation:  0.002843141555786133
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.0002739429473876953
r_  generation:  0.002508401870727539
----------------------check_connections_block total spend ----------------------------- 0.016849756240844727
generate_one_block  0.0033822059631347656
generate_one_block  0.0032973289489746094
generate_one_block  0.003361225128173828
generate_one_block  0.0034890174865722656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

connection checking time:  0.030180692672729492
block generation total time  0.031386375427246094
average batch blocks generation time:  0.007846593856811523
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014546394348144531  GigaBytes
Max Memory Allocated: 0.014546394348144531  GigaBytes

torch.Size([2009, 1433])
torch.Size([1438, 256])
torch.Size([644, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.022893428802490234  GigaBytes
Max Memory Allocated: 0.023025989532470703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01869821548461914  GigaBytes
Max Memory Allocated: 0.029338836669921875  GigaBytes

torch.Size([2087, 1433])
torch.Size([1417, 256])
torch.Size([605, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02628183364868164  GigaBytes
Max Memory Allocated: 0.029338836669921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.019281387329101562  GigaBytes
Max Memory Allocated: 0.030332565307617188  GigaBytes

torch.Size([2101, 1433])
torch.Size([1486, 256])
torch.Size([693, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.027644634246826172  GigaBytes
Max Memory Allocated: 0.030332565307617188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.01911306381225586  GigaBytes
Max Memory Allocated: 0.030733108520507812  GigaBytes

torch.Size([2162, 1433])
torch.Size([1609, 256])
torch.Size([798, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02834606170654297  GigaBytes
Max Memory Allocated: 0.030733108520507812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008442044258117676 |0.08607214689254761 |0.19593310356140137 |0.00017547607421875 |0.005578160285949707 |0.003022909164428711 |
----------------------------------------------------------pseudo_mini_loss sum 3.8527727127075195
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17770
Number of first layer input nodes during this epoch:  8359
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02740001678466797  GigaBytes
Max Memory Allocated: 0.0328669548034668  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005066394805908203
random selection method range initialization spend 0.000118255615234375
time for parepare:  7.605552673339844e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.390975952148438e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.677078247070312e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.0013244152069091797
generate_one_block  0.0012202262878417969
generate_one_block  0.0011644363403320312
generate_one_block  0.0011818408966064453
generate_one_block  0.0011677742004394531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005066394805908203
gen group dst list time:  4.482269287109375e-05
time for parepare:  0.0001609325408935547
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004010200500488281
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00042247772216796875
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.00046324729919433594
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00042247772216796875
----------------------check_connections_block total spend ----------------------------- 0.003358125686645508
generate_one_block  0.0015332698822021484
generate_one_block  0.0015299320220947266
generate_one_block  0.0018448829650878906
generate_one_block  0.0015337467193603516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005784034729003906
gen group dst list time:  8.416175842285156e-05
time for parepare:  0.00019025802612304688
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0012655258178710938
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.00125885009765625
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.001285552978515625
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.0001392364501953125
r_  generation:  0.0012829303741455078
----------------------check_connections_block total spend ----------------------------- 0.008268356323242188
generate_one_block  0.0025877952575683594
generate_one_block  0.002515554428100586
generate_one_block  0.002499103546142578
generate_one_block  0.0023779869079589844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007290840148925781
gen group dst list time:  0.00014066696166992188
time for parepare:  0.000194549560546875
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0024025440216064453
local_output_nid generation:  0.00011801719665527344
local_in_edges_tensor generation:  0.00029778480529785156
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.0024776458740234375
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.00029754638671875
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.0023741722106933594
local_output_nid generation:  0.00011897087097167969
local_in_edges_tensor generation:  0.0003001689910888672
mini_batch_src_global generation:  0.0002148151397705078
r_  generation:  0.002444744110107422
----------------------check_connections_block total spend ----------------------------- 0.014930009841918945
generate_one_block  0.003674745559692383
generate_one_block  0.0035276412963867188
generate_one_block  0.0033397674560546875
generate_one_block  0.0033974647521972656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02740001678466797  GigaBytes
Max Memory Allocated: 0.0328669548034668  GigaBytes

connection checking time:  0.02655649185180664
block generation total time  0.03036189079284668
average batch blocks generation time:  0.00759047269821167
block dataloader generation time/epoch 0.07582330703735352
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02734088897705078  GigaBytes
Max Memory Allocated: 0.038791656494140625  GigaBytes

torch.Size([2112, 1433])
torch.Size([1525, 256])
torch.Size([702, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.036629676818847656  GigaBytes
Max Memory Allocated: 0.038791656494140625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.027163982391357422  GigaBytes
Max Memory Allocated: 0.03879261016845703  GigaBytes

torch.Size([2136, 1433])
torch.Size([1521, 256])
torch.Size([697, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03645133972167969  GigaBytes
Max Memory Allocated: 0.03879261016845703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02734375  GigaBytes
Max Memory Allocated: 0.03879261016845703  GigaBytes

torch.Size([2121, 1433])
torch.Size([1518, 256])
torch.Size([733, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.036835670471191406  GigaBytes
Max Memory Allocated: 0.03879261016845703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02716684341430664  GigaBytes
Max Memory Allocated: 0.03879261016845703  GigaBytes

torch.Size([2111, 1433])
torch.Size([1563, 256])
torch.Size([713, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.036589622497558594  GigaBytes
Max Memory Allocated: 0.03879261016845703  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025417208671569824 |0.0007393360137939453 |0.005037486553192139 |0.00013267993927001953 |0.0029023289680480957 |0.0019505023956298828 |
----------------------------------------------------------pseudo_mini_loss sum 2.292367935180664
Total (block generation + training)time/epoch 0.12870478630065918
Training time/epoch 0.05257844924926758
Training time without block to device /epoch 0.0496211051940918
Training time without total dataloading part /epoch 0.0342404842376709
load block tensor time/epoch 0.01016688346862793
block to device time/epoch 0.0029573440551757812
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18191
Number of first layer input nodes during this epoch:  8480
