main start at this time 1648431005.9488633
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018358230590820312  GigaBytes
Max Memory Allocated: 0.00018358230590820312  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012879371643066406
random selection method range initialization spend 0.0002002716064453125
time for parepare:  6.699562072753906e-05
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0034787654876708984
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.988380432128906e-05
----------------------check_connections_block total spend ----------------------------- 0.004768848419189453
generate_one_block  0.0017867088317871094
generate_one_block  0.0011408329010009766
generate_one_block  0.0011143684387207031
generate_one_block  0.0011985301971435547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005040168762207031
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.00014591217041015625
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00034427642822265625
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00041556358337402344
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005245208740234375
----------------------check_connections_block total spend ----------------------------- 0.0032775402069091797
generate_one_block  0.0015709400177001953
generate_one_block  0.0014412403106689453
generate_one_block  0.0015268325805664062
generate_one_block  0.0016515254974365234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00058746337890625
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.00018525123596191406
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0012671947479248047
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0011229515075683594
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0013666152954101562
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0013968944549560547
----------------------check_connections_block total spend ----------------------------- 0.008298873901367188
generate_one_block  0.0025568008422851562
generate_one_block  0.0024328231811523438
generate_one_block  0.002568960189819336
generate_one_block  0.0024263858795166016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007524490356445312
gen group dst list time:  0.00013971328735351562
time for parepare:  0.00019216537475585938
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.000400543212890625
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0024199485778808594
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.0022547245025634766
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.00030422210693359375
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.002521514892578125
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00030422210693359375
r_  generation:  0.002449512481689453
----------------------check_connections_block total spend ----------------------------- 0.014760017395019531
generate_one_block  0.003849506378173828
generate_one_block  0.0032684803009033203
generate_one_block  0.0035092830657958984
generate_one_block  0.0033769607543945312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018358230590820312  GigaBytes
Max Memory Allocated: 0.00018358230590820312  GigaBytes

connection checking time:  0.0263364315032959
block generation total time  0.030179738998413086
average batch blocks generation time:  0.0075449347496032715
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011996269226074219  GigaBytes
Max Memory Allocated: 0.011996269226074219  GigaBytes

torch.Size([2129, 1433])
torch.Size([1535, 16])
torch.Size([708, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.012637615203857422  GigaBytes
Max Memory Allocated: 0.012644290924072266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012166023254394531  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

torch.Size([2058, 1433])
torch.Size([1397, 16])
torch.Size([620, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012740135192871094  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012181282043457031  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

torch.Size([2171, 1433])
torch.Size([1610, 16])
torch.Size([762, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01285409927368164  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012182235717773438  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

torch.Size([2097, 1433])
torch.Size([1568, 16])
torch.Size([763, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01286458969116211  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005002856254577637 |0.08584916591644287 |0.19525068998336792 |0.0001927018165588379 |0.004158318042755127 |0.002789020538330078 |
----------------------------------------------------------pseudo_mini_loss sum 3.4817280769348145
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18150
Number of first layer input nodes during this epoch:  8455
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01276540756225586  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004837512969970703
random selection method range initialization spend 0.00011444091796875
time for parepare:  7.390975952148438e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  5.2928924560546875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012803077697753906
generate_one_block  0.0011539459228515625
generate_one_block  0.0011150836944580078
generate_one_block  0.0010879039764404297
generate_one_block  0.0010921955108642578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004923343658447266
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.0001690387725830078
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.00042629241943359375
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0004982948303222656
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00042438507080078125
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00035381317138671875
----------------------check_connections_block total spend ----------------------------- 0.003350973129272461
generate_one_block  0.001539468765258789
generate_one_block  0.0016055107116699219
generate_one_block  0.0017726421356201172
generate_one_block  0.0014455318450927734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005941390991210938
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.00019073486328125
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0002765655517578125
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0012297630310058594
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  0.0003597736358642578
r_  generation:  0.001959085464477539
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0012874603271484375
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0012297630310058594
----------------------check_connections_block total spend ----------------------------- 0.009154081344604492
generate_one_block  0.002508401870727539
generate_one_block  0.0026674270629882812
generate_one_block  0.002464771270751953
generate_one_block  0.0023353099822998047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007507801055908203
gen group dst list time:  0.0001404285430908203
time for parepare:  0.00018858909606933594
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.00044918060302734375
mini_batch_src_global generation:  0.0001938343048095703
r_  generation:  0.0024309158325195312
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.0003027915954589844
mini_batch_src_global generation:  0.00029397010803222656
r_  generation:  0.0025250911712646484
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.002432584762573242
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0023071765899658203
----------------------check_connections_block total spend ----------------------------- 0.014922380447387695
generate_one_block  0.004124164581298828
generate_one_block  0.0035996437072753906
generate_one_block  0.003443002700805664
generate_one_block  0.0032618045806884766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01276540756225586  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

connection checking time:  0.02742743492126465
block generation total time  0.03076767921447754
average batch blocks generation time:  0.007691919803619385
block dataloader generation time/epoch 0.07709479331970215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012534141540527344  GigaBytes
Max Memory Allocated: 0.02416086196899414  GigaBytes

torch.Size([2120, 1433])
torch.Size([1529, 16])
torch.Size([705, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01317739486694336  GigaBytes
Max Memory Allocated: 0.02416086196899414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012544631958007812  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

torch.Size([2151, 1433])
torch.Size([1637, 16])
torch.Size([822, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013256072998046875  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012537002563476562  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

torch.Size([2167, 1433])
torch.Size([1561, 16])
torch.Size([734, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013193130493164062  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012528419494628906  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

torch.Size([2047, 1433])
torch.Size([1452, 16])
torch.Size([672, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013129234313964844  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002276301383972168 |0.0005707144737243652 |0.004353225231170654 |0.00011837482452392578 |0.0033194422721862793 |0.001878976821899414 |
----------------------------------------------------------pseudo_mini_loss sum 3.033757448196411
Total (block generation + training)time/epoch 0.12609577178955078
Training time/epoch 0.048719167709350586
Training time without block to device /epoch 0.046436309814453125
Training time without total dataloading part /epoch 0.03304314613342285
load block tensor time/epoch 0.009105205535888672
block to device time/epoch 0.002282857894897461
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18333
Number of first layer input nodes during this epoch:  8485
