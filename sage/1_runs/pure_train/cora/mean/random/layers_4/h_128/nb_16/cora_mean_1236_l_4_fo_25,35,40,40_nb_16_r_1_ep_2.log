main start at this time 1648431138.027416
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.0016245841979980469  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008487701416015625
random selection method range initialization spend 0.00018906593322753906
time for parepare:  5.91278076171875e-05
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.0024881362915039062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.58306884765625e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.487701416015625e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.559226989746094e-05
mini_batch_src_global generation:  1.2874603271484375e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
----------------------check_connections_block total spend ----------------------------- 0.005415678024291992
generate_one_block  0.0013079643249511719
generate_one_block  0.0011157989501953125
generate_one_block  0.0010085105895996094
generate_one_block  0.001058816909790039
generate_one_block  0.0010554790496826172
generate_one_block  0.0010058879852294922
generate_one_block  0.0010068416595458984
generate_one_block  0.0010600090026855469
generate_one_block  0.0010237693786621094
generate_one_block  0.0010547637939453125
generate_one_block  0.0010540485382080078
generate_one_block  0.0010488033294677734
generate_one_block  0.001007080078125
generate_one_block  0.0010039806365966797
generate_one_block  0.0010166168212890625
generate_one_block  0.0010044574737548828
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005900859832763672
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00018739700317382812
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00014972686767578125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001647472381591797
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00013375282287597656
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.822845458984375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00016832351684570312
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010180473327636719
----------------------check_connections_block total spend ----------------------------- 0.005385398864746094
generate_one_block  0.0011632442474365234
generate_one_block  0.0012285709381103516
generate_one_block  0.0011572837829589844
generate_one_block  0.0011851787567138672
generate_one_block  0.0012171268463134766
generate_one_block  0.0011239051818847656
generate_one_block  0.0012423992156982422
generate_one_block  0.0011975765228271484
generate_one_block  0.001201629638671875
generate_one_block  0.0011525154113769531
generate_one_block  0.0010898113250732422
generate_one_block  0.0011386871337890625
generate_one_block  0.0011248588562011719
generate_one_block  0.0010914802551269531
generate_one_block  0.001169443130493164
generate_one_block  0.0011556148529052734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006899833679199219
gen group dst list time:  0.0001418590545654297
time for parepare:  0.00021076202392578125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.00033855438232421875
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0005171298980712891
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00026416778564453125
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004723072052001953
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006079673767089844
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00033545494079589844
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005741119384765625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.002547740936279297
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0002346038818359375
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0005452632904052734
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004949569702148438
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.0003077983856201172
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00044083595275878906
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00030517578125
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.00046706199645996094
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0003437995910644531
----------------------check_connections_block total spend ----------------------------- 0.014842510223388672
generate_one_block  0.0015823841094970703
generate_one_block  0.0016219615936279297
generate_one_block  0.0012714862823486328
generate_one_block  0.0017805099487304688
generate_one_block  0.0016794204711914062
generate_one_block  0.0017027854919433594
generate_one_block  0.001621246337890625
generate_one_block  0.0014641284942626953
generate_one_block  0.0015718936920166016
generate_one_block  0.001461029052734375
generate_one_block  0.0013082027435302734
generate_one_block  0.0014526844024658203
generate_one_block  0.0013580322265625
generate_one_block  0.0012881755828857422
generate_one_block  0.0014934539794921875
generate_one_block  0.001314401626586914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011548995971679688
gen group dst list time:  0.0002613067626953125
time for parepare:  0.00022721290588378906
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0003814697265625
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0009708404541015625
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0013086795806884766
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0006921291351318359
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0010700225830078125
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0015354156494140625
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0009751319885253906
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0013322830200195312
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0011234283447265625
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0014450550079345703
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0011594295501708984
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0010042190551757812
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.001190185546875
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0009648799896240234
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0009000301361083984
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0010597705841064453
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0008940696716308594
----------------------check_connections_block total spend ----------------------------- 0.02826213836669922
generate_one_block  0.002156972885131836
generate_one_block  0.0032508373260498047
generate_one_block  0.0016942024230957031
generate_one_block  0.002228260040283203
generate_one_block  0.002643585205078125
generate_one_block  0.0020797252655029297
generate_one_block  0.0024366378784179688
generate_one_block  0.002274036407470703
generate_one_block  0.002549409866333008
generate_one_block  0.0023040771484375
generate_one_block  0.002307891845703125
generate_one_block  0.0023009777069091797
generate_one_block  0.0020990371704101562
generate_one_block  0.0019948482513427734
generate_one_block  0.0021648406982421875
generate_one_block  0.001970052719116211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.0016245841979980469  GigaBytes

connection checking time:  0.048490047454833984
block generation total time  0.07906651496887207
average batch blocks generation time:  0.004941657185554504
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009139537811279297  GigaBytes
Max Memory Allocated: 0.009139537811279297  GigaBytes

torch.Size([1401, 1433])
torch.Size([632, 128])
torch.Size([199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01064920425415039  GigaBytes
Max Memory Allocated: 0.010740280151367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011742591857910156  GigaBytes
Max Memory Allocated: 0.019171714782714844  GigaBytes

torch.Size([1582, 1433])
torch.Size([820, 128])
torch.Size([293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013774394989013672  GigaBytes
Max Memory Allocated: 0.019171714782714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008108139038085938  GigaBytes
Max Memory Allocated: 0.019171714782714844  GigaBytes

torch.Size([906, 1433])
torch.Size([379, 128])
torch.Size([111, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009041786193847656  GigaBytes
Max Memory Allocated: 0.019171714782714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01056528091430664  GigaBytes
Max Memory Allocated: 0.019171714782714844  GigaBytes

torch.Size([1363, 1433])
torch.Size([702, 128])
torch.Size([241, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012276172637939453  GigaBytes
Max Memory Allocated: 0.019171714782714844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012332439422607422  GigaBytes
Max Memory Allocated: 0.01955127716064453  GigaBytes

torch.Size([1691, 1433])
torch.Size([963, 128])
torch.Size([336, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014719963073730469  GigaBytes
Max Memory Allocated: 0.01955127716064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.009827136993408203  GigaBytes
Max Memory Allocated: 0.01955127716064453  GigaBytes

torch.Size([1226, 1433])
torch.Size([629, 128])
torch.Size([172, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011281490325927734  GigaBytes
Max Memory Allocated: 0.01955127716064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012324810028076172  GigaBytes
Max Memory Allocated: 0.01955127716064453  GigaBytes

torch.Size([1573, 1433])
torch.Size([852, 128])
torch.Size([355, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014519214630126953  GigaBytes
Max Memory Allocated: 0.01955127716064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010877609252929688  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1421, 1433])
torch.Size([691, 128])
torch.Size([258, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012627601623535156  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012326717376708984  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1646, 1433])
torch.Size([921, 128])
torch.Size([308, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014615058898925781  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010807991027832031  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1408, 1433])
torch.Size([721, 128])
torch.Size([237, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012579917907714844  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.0107879638671875  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1406, 1433])
torch.Size([599, 128])
torch.Size([167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012169361114501953  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011171340942382812  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1476, 1433])
torch.Size([738, 128])
torch.Size([226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012938976287841797  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010788917541503906  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1276, 1433])
torch.Size([620, 128])
torch.Size([199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012276649475097656  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1262, 1433])
torch.Size([559, 128])
torch.Size([157, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011326789855957031  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.010793685913085938  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1389, 1433])
torch.Size([688, 128])
torch.Size([262, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012567520141601562  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.009767532348632812  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

torch.Size([1215, 1433])
torch.Size([556, 128])
torch.Size([188, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011127471923828125  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005741864442825317 |0.02232491970062256 |0.05195121467113495 |0.00013722479343414307 |0.0028245747089385986 |0.0030291080474853516 |
----------------------------------------------------------pseudo_mini_loss sum 3.6338117122650146
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37791
Number of first layer input nodes during this epoch:  22241
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013089179992675781  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004968643188476562
random selection method range initialization spend 0.00013017654418945312
time for parepare:  7.033348083496094e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7418136596679688e-05
----------------------check_connections_block total spend ----------------------------- 0.0031020641326904297
generate_one_block  0.0011341571807861328
generate_one_block  0.0010373592376708984
generate_one_block  0.0010290145874023438
generate_one_block  0.0010569095611572266
generate_one_block  0.001028299331665039
generate_one_block  0.0010411739349365234
generate_one_block  0.0010364055633544922
generate_one_block  0.0010340213775634766
generate_one_block  0.0010433197021484375
generate_one_block  0.001031637191772461
generate_one_block  0.0011444091796875
generate_one_block  0.0010585784912109375
generate_one_block  0.0009438991546630859
generate_one_block  0.000993967056274414
generate_one_block  0.0009877681732177734
generate_one_block  0.0009629726409912109
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006101131439208984
gen group dst list time:  9.560585021972656e-05
time for parepare:  0.00016689300537109375
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002014636993408203
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00011301040649414062
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00010609626770019531
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00021719932556152344
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  9.465217590332031e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00010609626770019531
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001728534698486328
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018143653869628906
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.702278137207031e-05
----------------------check_connections_block total spend ----------------------------- 0.0059850215911865234
generate_one_block  0.0014965534210205078
generate_one_block  0.0013763904571533203
generate_one_block  0.001356363296508789
generate_one_block  0.001506805419921875
generate_one_block  0.0013427734375
generate_one_block  0.0012845993041992188
generate_one_block  0.001222372055053711
generate_one_block  0.001210927963256836
generate_one_block  0.0011229515075683594
generate_one_block  0.0010437965393066406
generate_one_block  0.0011522769927978516
generate_one_block  0.0011985301971435547
generate_one_block  0.0011529922485351562
generate_one_block  0.0011630058288574219
generate_one_block  0.001123666763305664
generate_one_block  0.001008749008178711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007040500640869141
gen group dst list time:  0.00023365020751953125
time for parepare:  0.00026988983154296875
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0007865428924560547
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0005552768707275391
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004382133483886719
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0008831024169921875
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0004489421844482422
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0007493495941162109
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0004382133483886719
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0006308555603027344
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004172325134277344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001437664031982422
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00044846534729003906
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00045800209045410156
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005419254302978516
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0004951953887939453
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00024056434631347656
----------------------check_connections_block total spend ----------------------------- 0.014969110488891602
generate_one_block  0.001873016357421875
generate_one_block  0.0015835762023925781
generate_one_block  0.0015785694122314453
generate_one_block  0.001779317855834961
generate_one_block  0.0013611316680908203
generate_one_block  0.0016579627990722656
generate_one_block  0.0013365745544433594
generate_one_block  0.0016856193542480469
generate_one_block  0.0013492107391357422
generate_one_block  0.0010843276977539062
generate_one_block  0.0014007091522216797
generate_one_block  0.0014157295227050781
generate_one_block  0.0014634132385253906
generate_one_block  0.0015687942504882812
generate_one_block  0.0014834403991699219
generate_one_block  0.0012979507446289062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007565021514892578
gen group dst list time:  0.0003726482391357422
time for parepare:  0.00022029876708984375
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.0003364086151123047
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0015959739685058594
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.00014901161193847656
r_  generation:  0.0012638568878173828
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.001035451889038086
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0016813278198242188
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0011911392211914062
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.0001437664031982422
r_  generation:  0.0015401840209960938
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0009703636169433594
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0014927387237548828
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0009524822235107422
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.00043702125549316406
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0010559558868408203
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0010726451873779297
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0011851787567138672
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.0011904239654541016
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.0013320446014404297
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0007228851318359375
----------------------check_connections_block total spend ----------------------------- 0.030003786087036133
generate_one_block  0.0031135082244873047
generate_one_block  0.0023763179779052734
generate_one_block  0.002074718475341797
generate_one_block  0.0027773380279541016
generate_one_block  0.0023412704467773438
generate_one_block  0.0025167465209960938
generate_one_block  0.001962900161743164
generate_one_block  0.0025331974029541016
generate_one_block  0.0019321441650390625
generate_one_block  0.0013790130615234375
generate_one_block  0.0020399093627929688
generate_one_block  0.0028078556060791016
generate_one_block  0.0022885799407958984
generate_one_block  0.0023050308227539062
generate_one_block  0.002382040023803711
generate_one_block  0.0017993450164794922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013089179992675781  GigaBytes
Max Memory Allocated: 0.01986074447631836  GigaBytes

connection checking time:  0.05095791816711426
block generation total time  0.08031201362609863
average batch blocks generation time:  0.0050195008516311646
block dataloader generation time/epoch 0.1721181869506836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01530313491821289  GigaBytes
Max Memory Allocated: 0.021733760833740234  GigaBytes

torch.Size([1641, 1433])
torch.Size([951, 128])
torch.Size([318, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.017645835876464844  GigaBytes
Max Memory Allocated: 0.021733760833740234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014254093170166016  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1447, 1433])
torch.Size([719, 128])
torch.Size([216, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015938282012939453  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013782978057861328  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1360, 1433])
torch.Size([575, 128])
torch.Size([195, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015195846557617188  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015468120574951172  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1671, 1433])
torch.Size([1030, 128])
torch.Size([360, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01803731918334961  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01409006118774414  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1417, 1433])
torch.Size([656, 128])
torch.Size([167, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015563488006591797  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014954090118408203  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1576, 1433])
torch.Size([932, 128])
torch.Size([321, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.017246246337890625  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012366294860839844  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1095, 1433])
torch.Size([536, 128])
torch.Size([176, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013674259185791016  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015460491180419922  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1671, 1433])
torch.Size([890, 128])
torch.Size([349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.017708301544189453  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012526512145996094  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1125, 1433])
torch.Size([516, 128])
torch.Size([219, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013933181762695312  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.009592056274414062  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([579, 1433])
torch.Size([225, 128])
torch.Size([62, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01015329360961914  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013181686401367188  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1247, 1433])
torch.Size([599, 128])
torch.Size([203, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014659881591796875  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01318359375  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1247, 1433])
torch.Size([601, 128])
torch.Size([209, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01467132568359375  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01429128646850586  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1454, 1433])
torch.Size([723, 128])
torch.Size([230, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01601409912109375  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014284610748291016  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1452, 1433])
torch.Size([718, 128])
torch.Size([274, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0161285400390625  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014805793762207031  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1550, 1433])
torch.Size([763, 128])
torch.Size([256, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016665935516357422  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.012001991271972656  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

torch.Size([1028, 1433])
torch.Size([440, 128])
torch.Size([107, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01299428939819336  GigaBytes
Max Memory Allocated: 0.022973060607910156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001960843801498413 |0.000609084963798523 |0.004558935761451721 |0.00010962784290313721 |0.002413645386695862 |0.0021724700927734375 |
----------------------------------------------------------pseudo_mini_loss sum 2.900899648666382
Total (block generation + training)time/epoch 0.34649205207824707
Training time/epoch 0.17409729957580566
Training time without block to device /epoch 0.1643519401550293
Training time without total dataloading part /epoch 0.11548781394958496
load block tensor time/epoch 0.03137350082397461
block to device time/epoch 0.009745359420776367
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  36858
Number of first layer input nodes during this epoch:  21560
