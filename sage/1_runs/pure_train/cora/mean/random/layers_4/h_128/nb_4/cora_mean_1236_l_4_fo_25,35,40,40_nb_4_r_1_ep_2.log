main start at this time 1648431119.3055189
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.0016245841979980469  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012946128845214844
random selection method range initialization spend 0.00016570091247558594
time for parepare:  6.127357482910156e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0013420581817626953
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.936622619628906e-05
----------------------check_connections_block total spend ----------------------------- 0.0025653839111328125
generate_one_block  0.001382589340209961
generate_one_block  0.0010755062103271484
generate_one_block  0.0010788440704345703
generate_one_block  0.0010700225830078125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047206878662109375
gen group dst list time:  3.7670135498046875e-05
time for parepare:  0.0001354217529296875
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00036644935607910156
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004277229309082031
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.00042057037353515625
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003666877746582031
----------------------check_connections_block total spend ----------------------------- 0.003054380416870117
generate_one_block  0.0013790130615234375
generate_one_block  0.0015208721160888672
generate_one_block  0.0014524459838867188
generate_one_block  0.0014309883117675781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005834102630615234
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.0001685619354248047
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.001058340072631836
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.0012698173522949219
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0012052059173583984
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.00115966796875
----------------------check_connections_block total spend ----------------------------- 0.007508039474487305
generate_one_block  0.0022668838500976562
generate_one_block  0.0025708675384521484
generate_one_block  0.002618551254272461
generate_one_block  0.002298116683959961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000736236572265625
gen group dst list time:  0.00013399124145507812
time for parepare:  0.0001862049102783203
local_output_nid generation:  9.846687316894531e-05
local_in_edges_tensor generation:  0.00039958953857421875
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0020368099212646484
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.002200603485107422
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002675056457519531
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.002298593521118164
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  0.0001876354217529297
r_  generation:  0.002263307571411133
----------------------check_connections_block total spend ----------------------------- 0.013569116592407227
generate_one_block  0.0033707618713378906
generate_one_block  0.00336456298828125
generate_one_block  0.00341796875
generate_one_block  0.0033597946166992188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.0016245841979980469  GigaBytes

connection checking time:  0.02413153648376465
block generation total time  0.029050827026367188
average batch blocks generation time:  0.007262706756591797
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.013431549072265625  GigaBytes
Max Memory Allocated: 0.013431549072265625  GigaBytes

torch.Size([2090, 1433])
torch.Size([1460, 128])
torch.Size([669, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017495155334472656  GigaBytes
Max Memory Allocated: 0.017568588256835938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.014552593231201172  GigaBytes
Max Memory Allocated: 0.026177406311035156  GigaBytes

torch.Size([2100, 1433])
torch.Size([1532, 128])
torch.Size([750, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01894855499267578  GigaBytes
Max Memory Allocated: 0.026177406311035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.015062332153320312  GigaBytes
Max Memory Allocated: 0.026177406311035156  GigaBytes

torch.Size([2095, 1433])
torch.Size([1566, 128])
torch.Size([756, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019568443298339844  GigaBytes
Max Memory Allocated: 0.026177406311035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014862537384033203  GigaBytes
Max Memory Allocated: 0.02649211883544922  GigaBytes

torch.Size([2159, 1433])
torch.Size([1517, 128])
torch.Size([686, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.019072532653808594  GigaBytes
Max Memory Allocated: 0.02649211883544922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008638322353363037 |0.0857475996017456 |0.19575577974319458 |0.00019049644470214844 |0.0042261481285095215 |0.0029096603393554688 |
----------------------------------------------------------pseudo_mini_loss sum 3.3813111782073975
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18118
Number of first layer input nodes during this epoch:  8444
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018309593200683594  GigaBytes
Max Memory Allocated: 0.02649211883544922  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005979537963867188
random selection method range initialization spend 0.00014781951904296875
time for parepare:  9.655952453613281e-05
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0002052783966064453
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  8.606910705566406e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.987022399902344e-05
----------------------check_connections_block total spend ----------------------------- 0.0014636516571044922
generate_one_block  0.001489877700805664
generate_one_block  0.0014030933380126953
generate_one_block  0.0013628005981445312
generate_one_block  0.0013885498046875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005817413330078125
gen group dst list time:  5.507469177246094e-05
time for parepare:  0.00021457672119140625
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005123615264892578
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0005664825439453125
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0003783702850341797
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004189014434814453
----------------------check_connections_block total spend ----------------------------- 0.0037758350372314453
generate_one_block  0.0016331672668457031
generate_one_block  0.0016977787017822266
generate_one_block  0.0018405914306640625
generate_one_block  0.0016138553619384766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005934238433837891
gen group dst list time:  9.369850158691406e-05
time for parepare:  0.00020885467529296875
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0012722015380859375
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00021505355834960938
r_  generation:  0.0014050006866455078
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.00103759765625
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0013005733489990234
----------------------check_connections_block total spend ----------------------------- 0.008297920227050781
generate_one_block  0.0025148391723632812
generate_one_block  0.0026369094848632812
generate_one_block  0.0021805763244628906
generate_one_block  0.00229644775390625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006878376007080078
gen group dst list time:  0.0001354217529296875
time for parepare:  0.00019240379333496094
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0003688335418701172
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.0023093223571777344
local_output_nid generation:  0.00011873245239257812
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.0002722740173339844
r_  generation:  0.0024597644805908203
local_output_nid generation:  9.989738464355469e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.0020265579223632812
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0024230480194091797
----------------------check_connections_block total spend ----------------------------- 0.014247894287109375
generate_one_block  0.003715991973876953
generate_one_block  0.0034019947052001953
generate_one_block  0.0029897689819335938
generate_one_block  0.0033731460571289062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018309593200683594  GigaBytes
Max Memory Allocated: 0.02649211883544922  GigaBytes

connection checking time:  0.0263216495513916
block generation total time  0.02989506721496582
average batch blocks generation time:  0.007473766803741455
block dataloader generation time/epoch 0.07775521278381348
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018296241760253906  GigaBytes
Max Memory Allocated: 0.02973175048828125  GigaBytes

torch.Size([2043, 1433])
torch.Size([1481, 128])
torch.Size([705, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.022528648376464844  GigaBytes
Max Memory Allocated: 0.02973175048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018111705780029297  GigaBytes
Max Memory Allocated: 0.029732704162597656  GigaBytes

torch.Size([2159, 1433])
torch.Size([1600, 128])
torch.Size([801, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02273845672607422  GigaBytes
Max Memory Allocated: 0.029732704162597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01682567596435547  GigaBytes
Max Memory Allocated: 0.029732704162597656  GigaBytes

torch.Size([1922, 1433])
torch.Size([1268, 128])
torch.Size([557, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02035045623779297  GigaBytes
Max Memory Allocated: 0.029732704162597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018123149871826172  GigaBytes
Max Memory Allocated: 0.029732704162597656  GigaBytes

torch.Size([2162, 1433])
torch.Size([1539, 128])
torch.Size([723, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022459030151367188  GigaBytes
Max Memory Allocated: 0.029732704162597656  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025186538696289062 |0.0008239150047302246 |0.005623579025268555 |0.00013124942779541016 |0.0041610002517700195 |0.0024678707122802734 |
----------------------------------------------------------pseudo_mini_loss sum 2.781862735748291
Total (block generation + training)time/epoch 0.1396956443786621
Training time/epoch 0.061350107192993164
Training time without block to device /epoch 0.058054447174072266
Training time without total dataloading part /epoch 0.04213118553161621
load block tensor time/epoch 0.010074615478515625
block to device time/epoch 0.0032956600189208984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17696
Number of first layer input nodes during this epoch:  8286
