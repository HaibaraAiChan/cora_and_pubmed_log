main start at this time 1648431072.0290937
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007557868957519531  GigaBytes
Max Memory Allocated: 0.0007557868957519531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011835098266601562
random selection method range initialization spend 0.0001964569091796875
time for parepare:  6.771087646484375e-05
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0026466846466064453
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00013828277587890625
----------------------check_connections_block total spend ----------------------------- 0.003567218780517578
generate_one_block  0.0017058849334716797
generate_one_block  0.001316070556640625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005228519439697266
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00014638900756835938
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0006730556488037109
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007762908935546875
----------------------check_connections_block total spend ----------------------------- 0.0026144981384277344
generate_one_block  0.0019409656524658203
generate_one_block  0.002042531967163086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005829334259033203
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.00018739700317382812
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0017991065979003906
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  0.0001838207244873047
r_  generation:  0.0019407272338867188
----------------------check_connections_block total spend ----------------------------- 0.005931377410888672
generate_one_block  0.0031211376190185547
generate_one_block  0.003233194351196289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006260871887207031
gen group dst list time:  9.1552734375e-05
time for parepare:  0.0001881122589111328
local_output_nid generation:  0.00012969970703125
local_in_edges_tensor generation:  0.00042057037353515625
mini_batch_src_global generation:  0.0001926422119140625
r_  generation:  0.002859830856323242
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.0003345012664794922
mini_batch_src_global generation:  0.0002722740173339844
r_  generation:  0.0028541088104248047
----------------------check_connections_block total spend ----------------------------- 0.008667707443237305
generate_one_block  0.0041544437408447266
generate_one_block  0.003960609436035156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007557868957519531  GigaBytes
Max Memory Allocated: 0.0007557868957519531  GigaBytes

connection checking time:  0.01721358299255371
block generation total time  0.018452882766723633
average batch blocks generation time:  0.009226441383361816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.013309955596923828  GigaBytes
Max Memory Allocated: 0.013309955596923828  GigaBytes

torch.Size([2329, 1433])
torch.Size([1910, 64])
torch.Size([1083, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.016374588012695312  GigaBytes
Max Memory Allocated: 0.016445159912109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01395273208618164  GigaBytes
Max Memory Allocated: 0.026260852813720703  GigaBytes

torch.Size([2307, 1433])
torch.Size([1911, 64])
torch.Size([1172, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017165660858154297  GigaBytes
Max Memory Allocated: 0.026260852813720703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014275074005126953 |0.17136991024017334 |0.3847992420196533 |0.00020766258239746094 |0.005781888961791992 |0.0028350353240966797 |
----------------------------------------------------------pseudo_mini_loss sum 3.9457643032073975
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11419
Number of first layer input nodes during this epoch:  4636
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015743255615234375  GigaBytes
Max Memory Allocated: 0.026260852813720703  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005974769592285156
random selection method range initialization spend 0.00015616416931152344
time for parepare:  9.703636169433594e-05
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001685619354248047
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001437664031982422
----------------------check_connections_block total spend ----------------------------- 0.001093149185180664
generate_one_block  0.0015475749969482422
generate_one_block  0.0014693737030029297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006067752838134766
gen group dst list time:  4.029273986816406e-05
time for parepare:  0.0002071857452392578
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0008971691131591797
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0008840560913085938
----------------------check_connections_block total spend ----------------------------- 0.0033349990844726562
generate_one_block  0.0023016929626464844
generate_one_block  0.0022711753845214844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007245540618896484
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.00026345252990722656
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.0022547245025634766
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation: Using backend: pytorch
 0.00029349327087402344
r_  generation:  0.002368927001953125
----------------------check_connections_block total spend ----------------------------- 0.007788658142089844
generate_one_block  0.003770589828491211
generate_one_block  0.003649473190307617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007250308990478516
gen group dst list time:  0.00011801719665527344
time for parepare:  0.00024127960205078125
local_output_nid generation:  0.00016570091247558594
local_in_edges_tensor generation:  0.0004756450653076172
mini_batch_src_global generation:  0.00025773048400878906
r_  generation:  0.0034749507904052734
local_output_nid generation:  0.0001876354217529297
local_in_edges_tensor generation:  0.00040984153747558594
mini_batch_src_global generation:  0.00036025047302246094
r_  generation:  0.0030133724212646484
----------------------check_connections_block total spend ----------------------------- 0.010211706161499023
generate_one_block  0.004103899002075195
generate_one_block  0.0038852691650390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015743255615234375  GigaBytes
Max Memory Allocated: 0.026260852813720703  GigaBytes

connection checking time:  0.021335363388061523
block generation total time  0.019982099533081055
average batch blocks generation time:  0.009991049766540527
block dataloader generation time/epoch 0.05836772918701172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015363693237304688  GigaBytes
Max Memory Allocated: 0.02756023406982422  GigaBytes

torch.Size([2291, 1433])
torch.Size([1869, 64])
torch.Size([1091, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.018432140350341797  GigaBytes
Max Memory Allocated: 0.02756023406982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01563739776611328  GigaBytes
Max Memory Allocated: 0.027742862701416016  GigaBytes

torch.Size([2341, 1433])
torch.Size([1948, 64])
torch.Size([1156, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01882648468017578  GigaBytes
Max Memory Allocated: 0.027742862701416016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003812074661254883 |0.0007697343826293945 |0.0052297115325927734 |0.00013637542724609375 |0.0028204917907714844 |0.001790761947631836 |
----------------------------------------------------------pseudo_mini_loss sum 2.7879908084869385
Total (block generation + training)time/epoch 0.08918166160583496
Training time/epoch 0.030120849609375
Training time without block to device /epoch 0.02858138084411621
Training time without total dataloading part /epoch 0.01816391944885254
load block tensor time/epoch 0.007624149322509766
block to device time/epoch 0.001539468765258789
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11394
Number of first layer input nodes during this epoch:  4632
