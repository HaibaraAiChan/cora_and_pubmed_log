main start at this time 1648431081.2454906
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007557868957519531  GigaBytes
Max Memory Allocated: 0.0007557868957519531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0017242431640625
random selection method range initialization spend 0.00023317337036132812
time for parepare:  6.246566772460938e-05
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0039789676666259766
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.14984130859375e-05
----------------------check_connections_block total spend ----------------------------- 0.005186319351196289
generate_one_block  0.001392364501953125
generate_one_block  0.0011112689971923828
generate_one_block  0.0011255741119384766
generate_one_block  0.0011260509490966797
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048470497131347656
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.0001590251922607422
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003437995910644531
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003540515899658203
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004975795745849609
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0002887248992919922
----------------------check_connections_block total spend ----------------------------- 0.002972841262817383
generate_one_block  0.0014383792877197266
generate_one_block  0.0014443397521972656
generate_one_block  0.0015981197357177734
generate_one_block  0.0013742446899414062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005724430084228516
gen group dst list time:  7.486343383789062e-05
time for parepare:  0.0001697540283203125
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0010204315185546875
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0010988712310791016
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0013616085052490234
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0009255409240722656
----------------------check_connections_block total spend ----------------------------- 0.007256984710693359
generate_one_block  0.0022313594818115234
generate_one_block  0.002456188201904297
generate_one_block  0.0025224685668945312
generate_one_block  0.0020530223846435547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007517337799072266
gen group dst list time:  0.0001251697540283203
time for parepare:  0.00017642974853515625
local_output_nid generation:  8.726119995117188e-05
local_in_edges_tensor generation:  0.00034427642822265625
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0019981861114501953
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.002225160598754883
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.0002760887145996094
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.002349376678466797
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0020182132720947266
----------------------check_connections_block total spend ----------------------------- 0.012997627258300781
generate_one_block  0.0032434463500976562
generate_one_block  0.0034050941467285156
generate_one_block  0.0034918785095214844
generate_one_block  0.0031745433807373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007557868957519531  GigaBytes
Max Memory Allocated: 0.0007557868957519531  GigaBytes

connection checking time:  0.023227453231811523
block generation total time  0.02843308448791504
average batch blocks generation time:  0.00710827112197876
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.012559890747070312  GigaBytes
Max Memory Allocated: 0.012559890747070312  GigaBytes

torch.Size([2091, 1433])
torch.Size([1410, 64])
torch.Size([637, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.01456451416015625  GigaBytes
Max Memory Allocated: 0.014597415924072266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013319969177246094  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

torch.Size([2173, 1433])
torch.Size([1545, 64])
torch.Size([682, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01551055908203125  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013332366943359375  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

torch.Size([2134, 1433])
torch.Size([1638, 64])
torch.Size([841, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01583242416381836  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013306617736816406  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

torch.Size([2053, 1433])
torch.Size([1351, 64])
torch.Size([590, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015202522277832031  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015021800994873047 |0.08653014898300171 |0.19628703594207764 |0.0001965165138244629 |0.004691362380981445 |0.005853176116943359 |
----------------------------------------------------------pseudo_mini_loss sum 3.5708303451538086
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17871
Number of first layer input nodes during this epoch:  8451
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014991283416748047  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007736682891845703
random selection method range initialization spend 0.00017595291137695312
time for parepare:  0.00010180473327636719
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.723403930664062e-05
----------------------check_connections_block total spend ----------------------------- 0.0014624595642089844
generate_one_block  0.0013709068298339844
generate_one_block  0.0012471675872802734
generate_one_block  0.0012745857238769531
generate_one_block  0.0012531280517578125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005738735198974609
gen group dst list time:  4.57763671875e-05
time for parepare:  0.00017642974853515625
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.000560760498046875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.00036525726318359375
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00040650367736816406
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00038170814514160156
----------------------check_connections_block total spend ----------------------------- 0.0034608840942382812
generate_one_block  0.001504659652709961
generate_one_block  0.0013089179992675781
generate_one_block  0.00168609619140625
generate_one_block  0.0014712810516357422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005590915679931641
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0011489391326904297
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0009489059448242188
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.001176595687866211
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.0012257099151611328
----------------------check_connections_block total spend ----------------------------- 0.00742793083190918
generate_one_block  0.002386331558227539
generate_one_block  0.0020809173583984375
generate_one_block  0.0023648738861083984
generate_one_block  0.0023643970489501953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007224082946777344
gen group dst list time:  0.0001289844512939453
time for parepare:  0.00018072128295898438
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.002101898193359375
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.0019538402557373047
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.0002453327178955078
r_  generation:  0.002185821533203125
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0021905899047851562
----------------------check_connections_block total spend ----------------------------- 0.013122320175170898
generate_one_block  0.003473997116088867
generate_one_block  0.003191709518432617
generate_one_block  0.0037963390350341797
generate_one_block  0.003437042236328125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014991283416748047  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

connection checking time:  0.02401113510131836
block generation total time  0.02906656265258789
average batch blocks generation time:  0.007266640663146973
block dataloader generation time/epoch 0.07659149169921875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014824867248535156  GigaBytes
Max Memory Allocated: 0.02644968032836914  GigaBytes

torch.Size([2083, 1433])
torch.Size([1519, 64])
torch.Size([729, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.017090320587158203  GigaBytes
Max Memory Allocated: 0.02644968032836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014811515808105469  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

torch.Size([2030, 1433])
torch.Size([1382, 64])
torch.Size([564, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01670217514038086  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014826774597167969  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

torch.Size([2163, 1433])
torch.Size([1544, 64])
torch.Size([734, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017079830169677734  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014827728271484375  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

torch.Size([2154, 1433])
torch.Size([1566, 64])
torch.Size([763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01711130142211914  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003618896007537842 |0.000709235668182373 |0.00506591796875 |0.00012511014938354492 |0.0031540989875793457 |0.0038633346557617188 |
----------------------------------------------------------pseudo_mini_loss sum 2.7437009811401367
Total (block generation + training)time/epoch 0.1369025707244873
Training time/epoch 0.0599520206451416
Training time without block to device /epoch 0.05711507797241211
Training time without total dataloading part /epoch 0.03724384307861328
load block tensor time/epoch 0.014475584030151367
block to device time/epoch 0.002836942672729492
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17960
Number of first layer input nodes during this epoch:  8430
