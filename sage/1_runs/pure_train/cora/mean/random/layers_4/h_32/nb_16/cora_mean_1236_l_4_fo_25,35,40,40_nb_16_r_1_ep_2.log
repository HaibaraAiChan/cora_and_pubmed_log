main start at this time 1648431062.1732113
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003666877746582031  GigaBytes
Max Memory Allocated: 0.0003666877746582031  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0014507770538330078
random selection method range initialization spend 0.0002281665802001953
time for parepare:  6.175041198730469e-05
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0039708614349365234
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.702278137207031e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8358230590820312e-05
----------------------check_connections_block total spend ----------------------------- 0.006863832473754883
generate_one_block  0.001298666000366211
generate_one_block  0.001085519790649414
generate_one_block  0.001016378402709961
generate_one_block  0.0010194778442382812
generate_one_block  0.0010287761688232422
generate_one_block  0.0010275840759277344
generate_one_block  0.0010104179382324219
generate_one_block  0.0010075569152832031
generate_one_block  0.0010290145874023438
generate_one_block  0.0010514259338378906
generate_one_block  0.0010445117950439453
generate_one_block  0.001024484634399414
generate_one_block  0.0010116100311279297
generate_one_block  0.0010211467742919922
generate_one_block  0.0010139942169189453
generate_one_block  0.0010173320770263672
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005941390991210938
gen group dst list time:  8.797645568847656e-05
time for parepare:  0.00013375282287597656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00013947486877441406
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.34600830078125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00018262863159179688
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001533031463623047
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011086463928222656
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00014328956604003906
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0001239776611328125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.343292236328125e-05
----------------------check_connections_block total spend ----------------------------- 0.005414485931396484
generate_one_block  0.0011324882507324219
generate_one_block  0.0011515617370605469
generate_one_block  0.0010898113250732422
generate_one_block  0.00115966796875
generate_one_block  0.001163482666015625
generate_one_block  0.0011410713195800781
generate_one_block  0.0011262893676757812
generate_one_block  0.0011115074157714844
generate_one_block  0.0011553764343261719
generate_one_block  0.0010366439819335938
generate_one_block  0.0011734962463378906
generate_one_block  0.0010828971862792969
generate_one_block  0.0010423660278320312
generate_one_block  0.0011248588562011719
generate_one_block  0.0010836124420166016
generate_one_block  0.0010600090026855469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000659942626953125
gen group dst list time:  0.00014853477478027344
time for parepare:  0.0002028942108154297
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0003495216369628906
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004904270172119141
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00029754638671875
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004475116729736328
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00047707557678222656
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005617141723632812
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00041103363037109375
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003566741943359375
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0006265640258789062
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00029778480529785156
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0005068778991699219
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003204345703125
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0005323886871337891
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004248619079589844
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002624988555908203
----------------------check_connections_block total spend ----------------------------- 0.012390613555908203
generate_one_block  0.001399993896484375
generate_one_block  0.0015552043914794922
generate_one_block  0.0013043880462646484
generate_one_block  0.0014519691467285156
generate_one_block  0.001499176025390625
generate_one_block  0.0018572807312011719
generate_one_block  0.0014073848724365234
generate_one_block  0.0013773441314697266
generate_one_block  0.0016775131225585938
generate_one_block  0.0012989044189453125
generate_one_block  0.0015017986297607422
generate_one_block  0.0013568401336669922
generate_one_block  0.0013201236724853516
generate_one_block  0.0015628337860107422
generate_one_block  0.0014684200286865234
generate_one_block  0.0012621879577636719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007312297821044922
gen group dst list time:  0.00026416778564453125
time for parepare:  0.00018286705017089844
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0010673999786376953
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.0001728534698486328
r_  generation:  0.001287221908569336
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0009005069732666016
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0010991096496582031
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0011873245239257812
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0014066696166992188
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0009846687316894531
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0011267662048339844
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.0013768672943115234
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0009007453918457031
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0011181831359863281
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0009303092956542969
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0009572505950927734
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.00128936767578125
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0010981559753417969
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0007979869842529297
----------------------check_connections_block total spend ----------------------------- 0.02818155288696289
generate_one_block  0.002809762954711914
generate_one_block  0.002645254135131836
generate_one_block  0.002077817916870117
generate_one_block  0.0022046566009521484
generate_one_block  0.0023736953735351562
generate_one_block  0.0026197433471679688
generate_one_block  0.002123117446899414
generate_one_block  0.0021898746490478516
generate_one_block  0.0025794506072998047
generate_one_block  0.001956939697265625
generate_one_block  0.002465963363647461
generate_one_block  0.0020716190338134766
generate_one_block  0.002075672149658203
generate_one_block  0.0032167434692382812
generate_one_block  0.002244710922241211
generate_one_block  0.0018894672393798828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003666877746582031  GigaBytes
Max Memory Allocated: 0.0003666877746582031  GigaBytes

connection checking time:  0.04598665237426758
block generation total time  0.07868099212646484
average batch blocks generation time:  0.004917562007904053
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007702827453613281  GigaBytes
Max Memory Allocated: 0.007702827453613281  GigaBytes

torch.Size([1367, 1433])
torch.Size([648, 32])
torch.Size([195, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008127689361572266  GigaBytes
Max Memory Allocated: 0.008130073547363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009257316589355469  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

torch.Size([1588, 1433])
torch.Size([841, 32])
torch.Size([278, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009812355041503906  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008060932159423828  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

torch.Size([1324, 1433])
torch.Size([559, 32])
torch.Size([169, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008428096771240234  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008102893829345703  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

torch.Size([1373, 1433])
torch.Size([677, 32])
torch.Size([253, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008575439453125  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009063243865966797  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

torch.Size([1552, 1433])
torch.Size([771, 32])
torch.Size([257, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009586811065673828  GigaBytes
Max Memory Allocated: 0.016506671905517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009593009948730469  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1650, 1433])
torch.Size([906, 32])
torch.Size([335, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010222911834716797  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.007443428039550781  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1250, 1433])
torch.Size([610, 32])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00787210464477539  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008344650268554688  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1419, 1433])
torch.Size([643, 32])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008769512176513672  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009723663330078125  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1674, 1433])
torch.Size([912, 32])
torch.Size([375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010370254516601562  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.006869792938232422  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1144, 1433])
torch.Size([531, 32])
torch.Size([149, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0072193145751953125  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008185863494873047  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1388, 1433])
torch.Size([713, 32])
torch.Size([279, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00869894027709961  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.006949424743652344  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1158, 1433])
torch.Size([570, 32])
torch.Size([176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.007335186004638672  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008174419403076172  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1299, 1433])
torch.Size([564, 32])
torch.Size([161, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00854635238647461  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009380817413330078  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1611, 1433])
torch.Size([843, 32])
torch.Size([306, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009959220886230469  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008454322814941406  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1439, 1433])
torch.Size([693, 32])
torch.Size([243, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008928775787353516  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0070171356201171875  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1172, 1433])
torch.Size([492, 32])
torch.Size([131, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00733184814453125  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0031480789184570312 |0.022824600338935852 |0.05336867272853851 |0.0001325458288192749 |0.00286024808883667 |0.002920866012573242 |
----------------------------------------------------------pseudo_mini_loss sum 3.260918617248535
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37905
Number of first layer input nodes during this epoch:  22408
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0078125  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00044035911560058594
random selection method range initialization spend 0.00011038780212402344
time for parepare:  8.153915405273438e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.726119995117188e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.33514404296875e-05
----------------------check_connections_block total spend ----------------------------- 0.002881765365600586
generate_one_block  0.0009806156158447266
generate_one_block  0.0010058879852294922
generate_one_block  0.0009624958038330078
generate_one_block  0.0009462833404541016
generate_one_block  0.0009744167327880859
generate_one_block  0.0010089874267578125
generate_one_block  0.0009555816650390625
generate_one_block  0.0009617805480957031
generate_one_block  0.0009920597076416016
generate_one_block  0.0009832382202148438
generate_one_block  0.0010137557983398438
generate_one_block  0.0009531974792480469
generate_one_block  0.0009958744049072266
generate_one_block  0.0009472370147705078
generate_one_block  0.0009505748748779297
generate_one_block  0.0009381771087646484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005826950073242188
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.0001430511474609375
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010991096496582031
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  8.630752563476562e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00014162063598632812
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001804828643798828
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017404556274414062
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00011992454528808594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010967254638671875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.555152893066406e-05
----------------------check_connections_block total spend ----------------------------- 0.005250453948974609
generate_one_block  0.0010819435119628906
generate_one_block  0.001051187515258789
generate_one_block  0.001070261001586914
generate_one_block  0.0010759830474853516
generate_one_block  0.0011162757873535156
generate_one_block  0.001220703125
generate_one_block  0.001148223876953125
generate_one_block  0.0011527538299560547
generate_one_block  0.00107574462890625
generate_one_block  0.0010788440704345703
generate_one_block  0.0010917186737060547
generate_one_block  0.0010728836059570312
generate_one_block  0.001102447509765625
generate_one_block  0.0010764598846435547
generate_one_block  0.0010836124420166016
generate_one_block  0.0009922981262207031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006182193756103516
gen group dst list time:  0.00018095970153808594
time for parepare:  0.00020813941955566406
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0004265308380126953
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0002582073211669922
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002930164337158203
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00046443939208984375
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005173683166503906
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005457401275634766
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006325244903564453
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00042057037353515625
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00039124488830566406
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00047278404235839844
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00041031837463378906
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005300045013427734
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.00046181678771972656
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0004909038543701172
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00019121170043945312
----------------------check_connections_block total spend ----------------------------- 0.01289510726928711
generate_one_block  0.0015225410461425781
generate_one_block  0.0012493133544921875
generate_one_block  0.0013518333435058594
generate_one_block  0.0014302730560302734
generate_one_block  0.0015614032745361328
generate_one_block  0.001584768295288086
generate_one_block  0.0013997554779052734
generate_one_block  0.001665353775024414
generate_one_block  0.0014531612396240234
generate_one_block  0.001383066177368164
generate_one_block  0.001506805419921875
generate_one_block  0.0013973712921142578
generate_one_block  0.0015263557434082031
generate_one_block  0.0014684200286865234
generate_one_block  0.0014982223510742188
generate_one_block  0.001201629638671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007081031799316406
gen group dst list time:  0.0003483295440673828
time for parepare:  0.000194549560546875
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0012023448944091797
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.0007967948913574219
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0007836818695068359
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0011241436004638672
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00015425682067871094
r_  generation:  0.0013861656188964844
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0013005733489990234
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00012159347534179688
r_  generation:  0.001093149185180664
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0014731884002685547
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.001199483871459961
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0008382797241210938
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0013422966003417969
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.00104522705078125
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0012590885162353516
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0011737346649169922
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0012142658233642578
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005395412445068359
----------------------check_connections_block total spend ----------------------------- 0.028531789779663086
generate_one_block  0.00249481201171875
generate_one_block  0.0018429756164550781
generate_one_block  0.0018546581268310547
generate_one_block  0.0021855831146240234
generate_one_block  0.002540111541748047
generate_one_block  0.0024268627166748047
generate_one_block  0.0022115707397460938
generate_one_block  0.0029671192169189453
generate_one_block  0.0023682117462158203
generate_one_block  0.0019192695617675781
generate_one_block  0.0025250911712646484
generate_one_block  0.0027887821197509766
generate_one_block  0.0023779869079589844
generate_one_block  0.0023424625396728516
generate_one_block  0.0023169517517089844
generate_one_block  0.0015692710876464844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0078125  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

connection checking time:  0.046677350997924805
block generation total time  0.0774233341217041
average batch blocks generation time:  0.004838958382606506
block dataloader generation time/epoch 0.16152167320251465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009966373443603516  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1586, 1433])
torch.Size([784, 32])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010479927062988281  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007617473602294922  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1149, 1433])
torch.Size([459, 32])
torch.Size([128, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007917404174804688  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007340908050537109  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1097, 1433])
torch.Size([498, 32])
torch.Size([153, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007676124572753906  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00865030288696289  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1340, 1433])
torch.Size([642, 32])
torch.Size([242, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00910043716430664  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010005950927734375  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

torch.Size([1592, 1433])
torch.Size([887, 32])
torch.Size([297, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01059722900390625  GigaBytes
Max Memory Allocated: 0.017825603485107422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009547233581542969  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1506, 1433])
torch.Size([818, 32])
torch.Size([296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010122299194335938  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00885772705078125  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1379, 1433])
torch.Size([680, 32])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009312629699707031  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010470867156982422  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1678, 1433])
torch.Size([957, 32])
torch.Size([332, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011122703552246094  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009009838104248047  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1407, 1433])
torch.Size([754, 32])
torch.Size([236, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009500980377197266  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.007517337799072266  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1129, 1433])
torch.Size([515, 32])
torch.Size([216, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00789785385131836  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010271072387695312  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1642, 1433])
torch.Size([858, 32])
torch.Size([267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010827064514160156  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008493900299072266  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1311, 1433])
torch.Size([661, 32])
torch.Size([212, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00893545150756836  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009099960327148438  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1423, 1433])
torch.Size([804, 32])
torch.Size([277, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009646892547607422  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009807109832763672  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1556, 1433])
torch.Size([766, 32])
torch.Size([249, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010312557220458984  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00937032699584961  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([1474, 1433])
torch.Size([781, 32])
torch.Size([256, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009890556335449219  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.005858898162841797  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

torch.Size([821, 1433])
torch.Size([321, 32])
torch.Size([100, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.006075382232666016  GigaBytes
Max Memory Allocated: 0.01799488067626953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012358874082565308 |0.0006428956985473633 |0.00465567409992218 |0.00012035667896270752 |0.002464085817337036 |0.002286672592163086 |
----------------------------------------------------------pseudo_mini_loss sum 3.1863625049591064
Total (block generation + training)time/epoch 0.3285789489746094
Training time/epoch 0.16679883003234863
Training time without block to device /epoch 0.15651249885559082
Training time without total dataloading part /epoch 0.11812853813171387
load block tensor time/epoch 0.019774198532104492
block to device time/epoch 0.010286331176757812
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37773
Number of first layer input nodes during this epoch:  22090
