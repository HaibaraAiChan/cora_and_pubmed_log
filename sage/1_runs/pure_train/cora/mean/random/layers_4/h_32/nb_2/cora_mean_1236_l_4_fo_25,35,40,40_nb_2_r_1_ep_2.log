main start at this time 1648431034.8423553
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003666877746582031  GigaBytes
Max Memory Allocated: 0.0003666877746582031  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013730525970458984
random selection method range initialization spend 0.00020384788513183594
time for parepare:  6.461143493652344e-05
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0034532546997070312
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00013256072998046875
----------------------check_connections_block total spend ----------------------------- 0.004368305206298828
generate_one_block  0.001775979995727539
generate_one_block  0.001287698745727539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005068778991699219
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.00013875961303710938
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.000644683837890625
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0007665157318115234
----------------------check_connections_block total spend ----------------------------- 0.0025708675384521484
generate_one_block  0.0018954277038574219
generate_one_block  0.0020139217376708984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005781650543212891
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.00018644332885742188
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0016562938690185547
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.00018548965454101562
r_  generation:  0.0019965171813964844
----------------------check_connections_block total spend ----------------------------- 0.005820512771606445
generate_one_block  0.0029387474060058594
generate_one_block  0.003256559371948242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006320476531982422
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.0001857280731201172
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00040793418884277344
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.002675294876098633
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.00034737586975097656
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.002892017364501953
----------------------check_connections_block total spend ----------------------------- 0.00858163833618164
generate_one_block  0.003926515579223633
generate_one_block  0.003985404968261719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003666877746582031  GigaBytes
Max Memory Allocated: 0.0003666877746582031  GigaBytes

connection checking time:  0.016973018646240234
block generation total time  0.018016576766967773
average batch blocks generation time:  0.009008288383483887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01251077651977539  GigaBytes
Max Memory Allocated: 0.01251077651977539  GigaBytes

torch.Size([2253, 1433])
torch.Size([1813, 32])
torch.Size([1044, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.01406097412109375  GigaBytes
Max Memory Allocated: 0.01409292221069336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013302326202392578  GigaBytes
Max Memory Allocated: 0.025200366973876953  GigaBytes

torch.Size([2330, 1433])
torch.Size([1987, 32])
torch.Size([1237, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015051841735839844  GigaBytes
Max Memory Allocated: 0.025200366973876953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014263749122619629 |0.16966843605041504 |0.3856508731842041 |0.0002071857452392578 |0.006078600883483887 |0.0027663707733154297 |
----------------------------------------------------------pseudo_mini_loss sum 3.6062111854553223
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11363
Number of first layer input nodes during this epoch:  4583
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014325141906738281  GigaBytes
Max Memory Allocated: 0.025200366973876953  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006005764007568359
random selection method range initialization spend 0.0001468658447265625
time for parepare:  9.560585021972656e-05
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00014448165893554688
----------------------check_connections_block total spend ----------------------------- 0.0010750293731689453
generate_one_block  0.0014886856079101562
generate_one_block  0.0014450550079345703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005908012390136719
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.00020766258239746094
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0008282661437988281
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.0008599758148193359
----------------------check_connections_block total spend ----------------------------- 0.0032308101654052734
generate_one_block  0.0022683143615722656
generate_one_block  0.0022411346435546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006918907165527344
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.0002541542053222656
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.00021958351135253906
r_  generation:  0.002231597900390625
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.0004825592041015625
mini_batch_src_global generation: Using backend: pytorch
 0.0002856254577636719
r_  generation:  0.0019249916076660156
----------------------check_connections_block total spend ----------------------------- 0.007472515106201172
generate_one_block  0.0037779808044433594
generate_one_block  0.003111124038696289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008015632629394531
gen group dst list time:  0.00010347366333007812
time for parepare:  0.00018167495727539062
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation:  0.0004150867462158203
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.002643585205078125
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00029850006103515625
r_  generation:  0.0026488304138183594
----------------------check_connections_block total spend ----------------------------- 0.008300304412841797
generate_one_block  0.004178285598754883
generate_one_block  0.003827810287475586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014325141906738281  GigaBytes
Max Memory Allocated: 0.025200366973876953  GigaBytes

connection checking time:  0.019003629684448242
block generation total time  0.01940464973449707
average batch blocks generation time:  0.009702324867248535
block dataloader generation time/epoch 0.06846928596496582
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013609886169433594  GigaBytes
Max Memory Allocated: 0.02592945098876953  GigaBytes

torch.Size([2254, 1433])
torch.Size([1831, 32])
torch.Size([1092, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015199661254882812  GigaBytes
Max Memory Allocated: 0.02592945098876953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013866901397705078  GigaBytes
Max Memory Allocated: 0.02592945098876953  GigaBytes

torch.Size([2302, 1433])
torch.Size([1867, 32])
torch.Size([1082, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01546621322631836  GigaBytes
Max Memory Allocated: 0.02592945098876953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029507875442504883 |0.0006754398345947266 |0.004723191261291504 |0.00013399124145507812 |0.002657651901245117 |0.002271413803100586 |
----------------------------------------------------------pseudo_mini_loss sum 2.6698546409606934
Total (block generation + training)time/epoch 0.09566879272460938
Training time/epoch 0.026979923248291016
Training time without block to device /epoch 0.025629043579101562
Training time without total dataloading part /epoch 0.017301082611083984
load block tensor time/epoch 0.0059015750885009766
block to device time/epoch 0.0013508796691894531
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11114
Number of first layer input nodes during this epoch:  4556
