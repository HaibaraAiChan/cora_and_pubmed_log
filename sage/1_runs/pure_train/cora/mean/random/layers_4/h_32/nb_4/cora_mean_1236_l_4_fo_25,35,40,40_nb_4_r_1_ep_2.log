main start at this time 1648431043.3361049
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003666877746582031  GigaBytes
Max Memory Allocated: 0.0003666877746582031  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0018017292022705078
random selection method range initialization spend 0.0003151893615722656
time for parepare:  0.00011658668518066406
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0030884742736816406
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  8.392333984375e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  9.131431579589844e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  8.96453857421875e-05
----------------------check_connections_block total spend ----------------------------- 0.004788398742675781
generate_one_block  0.0017313957214355469
generate_one_block  0.0014333724975585938
generate_one_block  0.0014193058013916016
generate_one_block  0.0014815330505371094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005626678466796875
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00012874603271484375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00030922889709472656
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00041413307189941406
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00042247772216796875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004105567932128906
----------------------check_connections_block total spend ----------------------------- 0.003043651580810547
generate_one_block  0.0014257431030273438
generate_one_block  0.0014770030975341797
generate_one_block  0.0015799999237060547
generate_one_block  0.0014362335205078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.00016546249389648438
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0010044574737548828
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0012025833129882812
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00012826919555664062
r_  generation:  0.001264810562133789
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.001184225082397461
----------------------check_connections_block total spend ----------------------------- 0.007576942443847656
generate_one_block  0.0022292137145996094
generate_one_block  0.002481222152709961
generate_one_block  0.0024042129516601562
generate_one_block  0.0023467540740966797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007238388061523438
gen group dst list time:  0.00012302398681640625
time for parepare:  0.00017714500427246094
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00038242340087890625
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.00194549560546875
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.0002529621124267578
r_  generation:  0.0022470951080322266
local_output_nid generation:  0.00011706352233886719
local_in_edges_tensor generation:  0.0002696514129638672
mini_batch_src_global generation:  0.0002079010009765625
r_  generation:  0.0022101402282714844
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.0002799034118652344
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.002118825912475586
----------------------check_connections_block total spend ----------------------------- 0.013190031051635742
generate_one_block  0.0032694339752197266
generate_one_block  0.004122495651245117
generate_one_block  0.0033996105194091797
generate_one_block  0.003313779830932617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003666877746582031  GigaBytes
Max Memory Allocated: 0.0003666877746582031  GigaBytes

connection checking time:  0.023810625076293945
block generation total time  0.029485702514648438
average batch blocks generation time:  0.007371425628662109
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010998725891113281  GigaBytes
Max Memory Allocated: 0.010998725891113281  GigaBytes

torch.Size([1976, 1433])
torch.Size([1389, 32])
torch.Size([607, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.012031078338623047  GigaBytes
Max Memory Allocated: 0.012044906616210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012546539306640625  GigaBytes
Max Memory Allocated: 0.022999286651611328  GigaBytes

torch.Size([2147, 1433])
torch.Size([1563, 32])
torch.Size([783, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013771533966064453  GigaBytes
Max Memory Allocated: 0.022999286651611328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012546539306640625  GigaBytes
Max Memory Allocated: 0.024169445037841797  GigaBytes

torch.Size([2168, 1433])
torch.Size([1559, 32])
torch.Size([773, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013766288757324219  GigaBytes
Max Memory Allocated: 0.024169445037841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012543678283691406  GigaBytes
Max Memory Allocated: 0.024169445037841797  GigaBytes

torch.Size([2058, 1433])
torch.Size([1534, 32])
torch.Size([742, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013728618621826172  GigaBytes
Max Memory Allocated: 0.024169445037841797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010272860527038574 |0.08730262517929077 |0.19210588932037354 |0.00015723705291748047 |0.0039403438568115234 |0.0024967193603515625 |
----------------------------------------------------------pseudo_mini_loss sum 3.263664960861206
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18028
Number of first layer input nodes during this epoch:  8349
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.024169445037841797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004448890686035156
random selection method range initialization spend 0.00013065338134765625
time for parepare:  6.461143493652344e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.340576171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0011870861053466797
generate_one_block  0.0011420249938964844
generate_one_block  0.0010976791381835938
generate_one_block  0.0011515617370605469
generate_one_block  0.0010845661163330078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004658699035644531
gen group dst list time:  3.695487976074219e-05
time for parepare:  0.0001499652862548828
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002872943878173828
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0004856586456298828
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004038810729980469
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00036597251892089844
----------------------check_connections_block total spend ----------------------------- 0.0030524730682373047
generate_one_block  0.0013697147369384766
generate_one_block  0.0016071796417236328
generate_one_block  0.0017142295837402344
generate_one_block  0.0014483928680419922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005295276641845703
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.00016736984252929688
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0009491443634033203
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0012426376342773438
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.001089334487915039
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.00115966796875
----------------------check_connections_block total spend ----------------------------- 0.007333993911743164
generate_one_block  0.0022308826446533203
generate_one_block  0.002651691436767578
generate_one_block  0.0024614334106445312
generate_one_block  0.0023593902587890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007295608520507812
gen group dst list time:  0.00012373924255371094
time for parepare:  0.00017833709716796875
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.001972198486328125
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0021162033081054688
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0002582073211669922
mini_batch_src_global generation:  0.0002543926239013672
r_  generation:  0.002157926559448242
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.0002663135528564453
mini_batch_src_global generation:  0.00019025802612304688
r_  generation:  0.0022890567779541016
----------------------check_connections_block total spend ----------------------------- 0.013453245162963867
generate_one_block  0.003668069839477539
generate_one_block  0.0033562183380126953
generate_one_block  0.0032863616943359375
generate_one_block  0.003370046615600586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01348257064819336  GigaBytes
Max Memory Allocated: 0.024169445037841797  GigaBytes

connection checking time:  0.023839712142944336
block generation total time  0.029523611068725586
average batch blocks generation time:  0.0073809027671813965
block dataloader generation time/epoch 0.07078695297241211
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013255119323730469  GigaBytes
Max Memory Allocated: 0.02489328384399414  GigaBytes

torch.Size([2091, 1433])
torch.Size([1396, 32])
torch.Size([588, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01426839828491211  GigaBytes
Max Memory Allocated: 0.02489328384399414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013270378112792969  GigaBytes
Max Memory Allocated: 0.024894237518310547  GigaBytes

torch.Size([2035, 1433])
torch.Size([1493, 32])
torch.Size([769, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014475345611572266  GigaBytes
Max Memory Allocated: 0.024894237518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013263702392578125  GigaBytes
Max Memory Allocated: 0.024894237518310547  GigaBytes

torch.Size([2080, 1433])
torch.Size([1454, 32])
torch.Size([673, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014378547668457031  GigaBytes
Max Memory Allocated: 0.024894237518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01326751708984375  GigaBytes
Max Memory Allocated: 0.024894237518310547  GigaBytes

torch.Size([2140, 1433])
torch.Size([1538, 32])
torch.Size([718, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014435768127441406  GigaBytes
Max Memory Allocated: 0.024894237518310547  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003239750862121582 |0.0005159974098205566 |0.003958404064178467 |0.00010728836059570312 |0.0032004714012145996 |0.0016734600067138672 |
----------------------------------------------------------pseudo_mini_loss sum 3.008927583694458
Total (block generation + training)time/epoch 0.12064814567565918
Training time/epoch 0.04960751533508301
Training time without block to device /epoch 0.04754352569580078
Training time without total dataloading part /epoch 0.030738115310668945
load block tensor time/epoch 0.012959003448486328
block to device time/epoch 0.0020639896392822266
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17694
Number of first layer input nodes during this epoch:  8346
