main start at this time 1648601327.0391858
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20962.77734375, 'VmSize': 20930.91015625, 'VmHWM': 3614.83203125, 'VmRSS': 3614.83203125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011556148529052734
global_2_local 9.679794311523438e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0001049041748046875
before graph partition 
		200, 167, 184, 179, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00023698806762695312
	Initialize BitList time :  1.6927719116210938e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 200, 167

	before terminate 1 the average redundancy rate is:  1.139751552795031
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.139751552795031,  1.2298136645962734,  1.049689440993789
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.139751552795031,  1.2422360248447204,  1.0372670807453417
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.139751552795031,  1.2298136645962734,  1.049689440993789
	walk terminate 1 spend time 4.286232233047485
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		169, 198, 184, 179, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005345344543457031
	Initialize BitList time :  3.981590270996094e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 198, 184

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.0683229813664596,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.1925465838509317,  1.1490683229813665
						 current side  0
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.0434782608695652,  1.2981366459627328
	walk terminate 1 spend time 4.542961120605469
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.186335403726708,  1.15527950310559
						 current side  0
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.0869565217391304,  1.2546583850931676
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.2298136645962734,  1.1118012422360248
	walk terminate 1 spend time 4.691923379898071
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		169, 179, 198, 179, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005781650543212891
	Initialize BitList time :  4.00543212890625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 198, 179

	before terminate 1 the average redundancy rate is:  1.170807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.1801242236024845,  1.1614906832298137
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.1925465838509317,  1.1366459627329193
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.1801242236024845,  1.1490683229813665
	walk terminate 1 spend time 4.5046985149383545
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.173913043478261,  1.15527950310559
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.2236024844720497,  1.1055900621118013
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.204968944099379,  1.1366459627329193
	walk terminate 1 spend time 4.718714952468872
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		169, 179, 183, 194, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 22.755190134048462
partition_len_list
[169, 179, 183, 194]
random_init_graph_partition selection method range initialization spend 22.7557430267334
time for parepare:  0.0001919269561767578
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0007627010345458984
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.013747930526733398
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00014328956604003906
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.298324584960938e-05
----------------------check_connections_block total spend ----------------------------- 0.016695261001586914
generate_one_block  0.012388944625854492
generate_one_block  0.0012810230255126953
generate_one_block  0.0011823177337646484
generate_one_block  0.0011973381042480469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011386871337890625
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.0007245540618896484
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0005035400390625
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0007333755493164062
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00032639503479003906
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0006210803985595703
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0006105899810791016
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0006728172302246094
----------------------check_connections_block total spend ----------------------------- 0.005626678466796875
generate_one_block  0.0020411014556884766
generate_one_block  0.0019321441650390625
generate_one_block  0.0018954277038574219
generate_one_block  0.001922607421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017163753509521484
gen group dst list time:  9.846687316894531e-05
time for parepare:  0.0004639625549316406
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.0009098052978515625
mini_batch_src_global generation:  0.000621795654296875
r_  generation:  0.0016102790832519531
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.0002772808074951172
r_  generation:  0.0016644001007080078
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0015919208526611328
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0016107559204101562
----------------------check_connections_block total spend ----------------------------- 0.012184858322143555
generate_one_block  0.003406047821044922
generate_one_block  0.0035338401794433594
generate_one_block  0.002380847930908203
generate_one_block  0.002492189407348633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20962.77734375, 'VmSize': 20784.984375, 'VmHWM': 3621.93359375, 'VmRSS': 3621.93359375}
connection checking time:  0.01781153678894043
block generation total time  0.019604206085205078
average batch blocks generation time:  0.0049010515213012695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.009940147399902344  GigaBytes
Max Memory Allocated: 0.009940147399902344  GigaBytes

{'VmPeak': 21009.57421875, 'VmSize': 21009.57421875, 'VmHWM': 3911.99609375, 'VmRSS': 3911.99609375}
torch.Size([1573, 1433])
torch.Size([818, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.011606216430664062  GigaBytes
Max Memory Allocated: 0.011896610260009766  GigaBytes

{'VmPeak': 21756.0625, 'VmSize': 21756.0625, 'VmHWM': 4612.6953125, 'VmRSS': 4612.6953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.011235237121582031  GigaBytes
Max Memory Allocated: 0.01959228515625  GigaBytes

{'VmPeak': 21764.546875, 'VmSize': 21764.546875, 'VmHWM': 4621.63671875, 'VmRSS': 4621.63671875}
torch.Size([1535, 1433])
torch.Size([764, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012834548950195312  GigaBytes
Max Memory Allocated: 0.01959228515625  GigaBytes

{'VmPeak': 21764.546875, 'VmSize': 21764.546875, 'VmHWM': 4621.63671875, 'VmRSS': 4621.63671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.011561870574951172  GigaBytes
Max Memory Allocated: 0.019714832305908203  GigaBytes

{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.29296875, 'VmRSS': 4622.29296875}
torch.Size([1596, 1433])
torch.Size([763, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.01316976547241211  GigaBytes
Max Memory Allocated: 0.019714832305908203  GigaBytes

{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.29296875, 'VmRSS': 4622.29296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.011669158935546875  GigaBytes
Max Memory Allocated: 0.02014780044555664  GigaBytes

{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.48046875, 'VmRSS': 4622.48046875}
torch.Size([1616, 1433])
torch.Size([788, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.01333761215209961  GigaBytes
Max Memory Allocated: 0.02014780044555664  GigaBytes

{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.48046875, 'VmRSS': 4622.48046875}
{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.875, 'VmRSS': 4622.875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008328676223754883 |0.09927183389663696 |0.1958693265914917 |0.00018781423568725586 |0.003926515579223633 |0.006161689758300781 |
----------------------------------------------------------pseudo_mini_loss sum 3.5240397453308105
{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.875, 'VmRSS': 4622.875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10178
Number of first layer input nodes during this epoch:  6320
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014761924743652344  GigaBytes
Max Memory Allocated: 0.02014780044555664  GigaBytes

{'VmPeak': 21828.87890625, 'VmSize': 21796.8828125, 'VmHWM': 4622.875, 'VmRSS': 4622.875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006709098815917969
global_2_local 0.00010418891906738281
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.034706115722656e-05
before graph partition 
		158, 194, 226, 152, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0003476142883300781
	Initialize BitList time :  2.002716064453125e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 158, 194

	before terminate 1 the average redundancy rate is:  1.093167701863354
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.15527950310559,  1.0186335403726707
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.031055900621118,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 5.287569999694824
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.0683229813664596,  1.0993788819875776
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.0124223602484472,  1.15527950310559
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 7
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.1614906832298137,  1.0124223602484472
	walk terminate 1 spend time 5.32873010635376
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		163, 187, 226, 152, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				32, 38, 35, 35, 


	preparing two sides time :  0.000537872314453125
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 187, 226

	before terminate 1 the average redundancy rate is:  1.2826086956521738
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2826086956521738,  1.1801242236024845,  1.3850931677018634
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.1677018633540373,  1.4037267080745341
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2888198757763973,  1.1987577639751552,  1.3788819875776397
	walk terminate 1 spend time 5.4021666049957275
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		163, 193, 222, 152, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				32, 39, 34, 35, 


	preparing two sides time :  0.0005283355712890625
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 222, 152

	before terminate 1 the average redundancy rate is:  1.1614906832298137
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.1987577639751552,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2173913043478262,  1.0993788819875776
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2173913043478262,  1.0993788819875776
	walk terminate 1 spend time 5.3547797203063965
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2173913043478262,  1.0993788819875776
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.236024844720497,  1.0807453416149069
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.0,  1.31055900621118
	walk terminate 1 spend time 5.409619331359863
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		163, 193, 161, 211, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 26.793455839157104
partition_len_list
[163, 193, 161, 211]
random_init_graph_partition selection method range initialization spend 26.794015884399414
time for parepare:  0.00016069412231445312
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0011260509490966797
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.0004909038543701172
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.00020599365234375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00013780593872070312
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0002512931823730469
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00014710426330566406
----------------------check_connections_block total spend ----------------------------- 0.004450559616088867
generate_one_block  0.020926237106323242
generate_one_block  0.0012903213500976562
generate_one_block  0.0011641979217529297
generate_one_block  0.0013279914855957031
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014951229095458984
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.0007481575012207031
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0006086826324462891
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0004417896270751953
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.0004994869232177734
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003910064697265625
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00048422813415527344
----------------------check_connections_block total spend ----------------------------- 0.0047223567962646484
generate_one_block  0.001990795135498047
generate_one_block  0.0016205310821533203
generate_one_block  0.0015273094177246094
generate_one_block  0.0017848014831542969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001520395278930664
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.0003058910369873047
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0012238025665283203
mini_batch_src_global generation:  0.0005254745483398438
r_  generation:  0.0013883113861083984
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0006232261657714844
mini_batch_src_global generation:  0.0003497600555419922
r_  generation:  0.0016129016876220703
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002968311309814453
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0011692047119140625
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0004203319549560547
mini_batch_src_global generation:  0.00013113021850585938
r_  generation:  0.0015850067138671875
----------------------check_connections_block total spend ----------------------------- 0.011735677719116211
generate_one_block  0.005365610122680664
generate_one_block  0.0027914047241210938
generate_one_block  0.002403736114501953
generate_one_block  0.0026352405548095703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014761924743652344  GigaBytes
Max Memory Allocated: 0.02014780044555664  GigaBytes

{'VmPeak': 21861.1484375, 'VmSize': 21860.8984375, 'VmHWM': 4624.31640625, 'VmRSS': 4624.2890625}
connection checking time:  0.01645803451538086
block generation total time  0.020119428634643555
average batch blocks generation time:  0.005029857158660889
block dataloader generation time/epoch 26.876241207122803
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014552593231201172  GigaBytes
Max Memory Allocated: 0.023140907287597656  GigaBytes

{'VmPeak': 21861.1484375, 'VmSize': 21860.8984375, 'VmHWM': 4625.27734375, 'VmRSS': 4625.27734375}
torch.Size([1491, 1433])
torch.Size([723, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.016054153442382812  GigaBytes
Max Memory Allocated: 0.023140907287597656  GigaBytes

{'VmPeak': 21861.1484375, 'VmSize': 21860.8984375, 'VmHWM': 4625.27734375, 'VmRSS': 4625.27734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014992713928222656  GigaBytes
Max Memory Allocated: 0.023467540740966797  GigaBytes

{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
torch.Size([1677, 1433])
torch.Size([847, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.016756057739257812  GigaBytes
Max Memory Allocated: 0.023467540740966797  GigaBytes

{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.013575077056884766  GigaBytes
Max Memory Allocated: 0.023467540740966797  GigaBytes

{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
torch.Size([1413, 1433])
torch.Size([684, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.015009880065917969  GigaBytes
Max Memory Allocated: 0.023467540740966797  GigaBytes

{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.01448822021484375  GigaBytes
Max Memory Allocated: 0.023467540740966797  GigaBytes

{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
torch.Size([1583, 1433])
torch.Size([811, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.01622915267944336  GigaBytes
Max Memory Allocated: 0.023467540740966797  GigaBytes

{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015281438827514648 |0.0008258819580078125 |0.006844162940979004 |0.00024646520614624023 |0.0028387904167175293 |0.002420186996459961 |
----------------------------------------------------------pseudo_mini_loss sum 1.4644672870635986
{'VmPeak': 21861.33984375, 'VmSize': 21861.33984375, 'VmHWM': 4625.54296875, 'VmRSS': 4625.54296875}
Total (block generation + training)time/epoch 26.991403579711914
Training time/epoch 0.1149294376373291
Training time without block to device /epoch 0.11162590980529785
Training time without total dataloading part /epoch 0.042137861251831055
load block tensor time/epoch 0.061125755310058594
block to device time/epoch 0.00330352783203125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9957
Number of first layer input nodes during this epoch:  6164
