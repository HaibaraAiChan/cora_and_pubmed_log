main start at this time 1648601308.7216086
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20834.9609375, 'VmSize': 20834.9609375, 'VmHWM': 3615.859375, 'VmRSS': 3615.859375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013332366943359375
global_2_local 9.655952453613281e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00022530555725097656
before graph partition 
		348, 345, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002789497375488281
	Initialize BitList time :  1.9311904907226562e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 348, 345

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
	walk terminate 1 spend time 4.531561374664307
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		345, 348, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.536736011505127
partition_len_list
[345, 348]
random_init_graph_partition selection method range initialization spend 4.537281274795532
time for parepare:  0.000156402587890625
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0007350444793701172
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.016672611236572266
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.00023174285888671875
----------------------check_connections_block total spend ----------------------------- 0.018970489501953125
generate_one_block  0.010137081146240234
generate_one_block  0.0013124942779541016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010530948638916016
gen group dst list time:  3.337860107421875e-05
time for parepare:  0.0006244182586669922
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0005314350128173828
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.0007066726684570312
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0007216930389404297
----------------------check_connections_block total spend ----------------------------- 0.004209995269775391
generate_one_block  0.0019729137420654297
generate_one_block  0.0019381046295166016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00160980224609375
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.00021314620971679688
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0008766651153564453
mini_batch_src_global generation:  0.0005269050598144531
r_  generation:  0.0018706321716308594
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.0003056526184082031
r_  generation:  0.0017390251159667969
----------------------check_connections_block total spend ----------------------------- 0.007266044616699219
generate_one_block  0.003635406494140625
generate_one_block  0.005459308624267578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20839.96484375, 'VmSize': 20689.01953125, 'VmHWM': 3622.98828125, 'VmRSS': 3622.98828125}
connection checking time:  0.01147603988647461
block generation total time  0.013005733489990234
average batch blocks generation time:  0.006502866744995117
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.012103080749511719  GigaBytes
Max Memory Allocated: 0.012103080749511719  GigaBytes

{'VmPeak': 20961.01953125, 'VmSize': 20961.01953125, 'VmHWM': 3927.96875, 'VmRSS': 3927.96875}
torch.Size([1974, 1433])
torch.Size([1207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2362060546875 GB
    Memory Allocated: 0.014756202697753906  GigaBytes
Max Memory Allocated: 0.014913082122802734  GigaBytes

{'VmPeak': 21783.984375, 'VmSize': 21751.98828125, 'VmHWM': 4608.39453125, 'VmRSS': 4608.39453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.013370990753173828  GigaBytes
Max Memory Allocated: 0.023849010467529297  GigaBytes

{'VmPeak': 21783.984375, 'VmSize': 21762.63671875, 'VmHWM': 4619.98046875, 'VmRSS': 4619.98046875}
torch.Size([1931, 1433])
torch.Size([1147, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.015931129455566406  GigaBytes
Max Memory Allocated: 0.023849010467529297  GigaBytes

{'VmPeak': 21783.984375, 'VmSize': 21762.63671875, 'VmHWM': 4619.98046875, 'VmRSS': 4619.98046875}
{'VmPeak': 21783.984375, 'VmSize': 21762.63671875, 'VmHWM': 4620.296875, 'VmRSS': 4620.296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010603547096252441 |0.1802082061767578 |0.4081000089645386 |0.0004477500915527344 |0.006524443626403809 |0.004496335983276367 |
----------------------------------------------------------pseudo_mini_loss sum 3.5863516330718994
{'VmPeak': 21783.984375, 'VmSize': 21762.63671875, 'VmHWM': 4620.296875, 'VmRSS': 4620.296875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6952
Number of first layer input nodes during this epoch:  3905
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.016506671905517578  GigaBytes
Max Memory Allocated: 0.023849010467529297  GigaBytes

{'VmPeak': 21783.984375, 'VmSize': 21762.63671875, 'VmHWM': 4620.296875, 'VmRSS': 4620.296875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006654262542724609
global_2_local 0.00010418891906738281
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.344650268554688e-05
before graph partition 
		341, 360, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0004100799560546875
	Initialize BitList time :  2.7418136596679688e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 341, 360

	before terminate 1 the average redundancy rate is:  1.0885093167701863
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
	walk terminate 1 spend time 5.411803722381592
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		341, 360, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 5.416292905807495
partition_len_list
[341, 360]
random_init_graph_partition selection method range initialization spend 5.416882514953613
time for parepare:  0.00014281272888183594
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.02087712287902832
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.0006520748138427734
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00036215782165527344
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.00033283233642578125
----------------------check_connections_block total spend ----------------------------- 0.02376270294189453
generate_one_block  0.02469325065612793
generate_one_block  0.0014789104461669922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002547025680541992
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.0005977153778076172
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0008363723754882812
mini_batch_src_global generation:  0.0003285408020019531
r_  generation:  0.0007517337799072266
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0003712177276611328
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0007476806640625
----------------------check_connections_block total spend ----------------------------- 0.004761695861816406
generate_one_block  0.0019202232360839844
generate_one_block  0.0018939971923828125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015399456024169922
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.00022101402282714844
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0015151500701904297
mini_batch_src_global generation:  0.0005881786346435547
r_  generation:  0.002146482467651367
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0007827281951904297
mini_batch_src_global generation:  0.0005033016204833984
r_  generation:  0.0019307136535644531
----------------------check_connections_block total spend ----------------------------- 0.009174585342407227
generate_one_block  0.0031402111053466797
generate_one_block  0.0036869049072265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.016506671905517578  GigaBytes
Max Memory Allocated: 0.023849010467529297  GigaBytes

{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4622.796875, 'VmRSS': 4622.796875}
connection checking time:  0.013936281204223633
block generation total time  0.010641336441040039
average batch blocks generation time:  0.0053206682205200195
block dataloader generation time/epoch 5.507763624191284
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.01635456085205078  GigaBytes
Max Memory Allocated: 0.02660226821899414  GigaBytes

{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4623.6953125, 'VmRSS': 4623.6953125}
torch.Size([1929, 1433])
torch.Size([1163, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.018927574157714844  GigaBytes
Max Memory Allocated: 0.02660226821899414  GigaBytes

{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4623.6953125, 'VmRSS': 4623.6953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.016318321228027344  GigaBytes
Max Memory Allocated: 0.02660226821899414  GigaBytes

{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4623.83203125, 'VmRSS': 4623.83203125}
torch.Size([1922, 1433])
torch.Size([1189, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.018970012664794922  GigaBytes
Max Memory Allocated: 0.02660226821899414  GigaBytes

{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4623.83203125, 'VmRSS': 4623.83203125}
{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4623.83203125, 'VmRSS': 4623.83203125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026080727577209473 |0.0008885860443115234 |0.0070345401763916016 |0.0003218650817871094 |0.005052924156188965 |0.0029227733612060547 |
----------------------------------------------------------pseudo_mini_loss sum 1.3538970947265625
{'VmPeak': 21890.65234375, 'VmSize': 21826.65234375, 'VmHWM': 4623.83203125, 'VmRSS': 4623.83203125}
Total (block generation + training)time/epoch 5.594775676727295
Training time/epoch 0.0860605239868164
Training time without block to device /epoch 0.08428335189819336
Training time without total dataloading part /epoch 0.027741432189941406
load block tensor time/epoch 0.052161455154418945
block to device time/epoch 0.0017771720886230469
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6904
Number of first layer input nodes during this epoch:  3851
