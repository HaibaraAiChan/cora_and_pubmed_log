main start at this time 1648600920.3585927
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20808.6015625, 'VmSize': 20802.96875, 'VmHWM': 3613.359375, 'VmRSS': 3613.359375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006260871887207031
global_2_local 7.605552673339844e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.512901306152344e-05
before graph partition 
		348, 345, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.00028443336486816406
	Initialize BitList time :  1.8835067749023438e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 348, 345

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
	walk terminate 1 spend time 4.463760614395142
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		345, 348, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.467945575714111
partition_len_list
[345, 348]
random_init_graph_partition selection method range initialization spend 4.46836519241333
time for parepare:  0.00015354156494140625
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.008912801742553711
mini_batch_src_global generation:  0.00018787384033203125
r_  generation:  0.01239323616027832
local_output_nid generation:  0.00017523765563964844
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0002071857452392578
----------------------check_connections_block total spend ----------------------------- 0.022952556610107422
generate_one_block  0.00992441177368164
generate_one_block  0.001285552978515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001998424530029297
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.0006308555603027344
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0010352134704589844
mini_batch_src_global generation:  0.00030517578125
r_  generation:  0.0008604526519775391
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0003986358642578125
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0008664131164550781
----------------------check_connections_block total spend ----------------------------- 0.005184650421142578
generate_one_block  0.0023131370544433594
generate_one_block  0.002263307571411133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001611948013305664
gen group dst list time:  7.200241088867188e-05
time for parepare:  0.00026416778564453125
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0015022754669189453
mini_batch_src_global generation:  0.0005452632904052734
r_  generation:  0.002565622329711914
local_output_nid generation:  0.0001418590545654297
local_in_edges_tensor generation:  0.00030732154846191406
mini_batch_src_global generation:  0.0003390312194824219
r_  generation:  0.002172708511352539
----------------------check_connections_block total spend ----------------------------- 0.009412527084350586
generate_one_block  0.0041468143463134766
generate_one_block  0.00457000732421875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20808.6015625, 'VmSize': 20656.9765625, 'VmHWM': 3620.25, 'VmRSS': 3620.25}
connection checking time:  0.014597177505493164
block generation total time  0.013293266296386719
average batch blocks generation time:  0.006646633148193359
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.011693477630615234  GigaBytes
Max Memory Allocated: 0.011693477630615234  GigaBytes

{'VmPeak': 20945.18359375, 'VmSize': 20945.18359375, 'VmHWM': 3909.38671875, 'VmRSS': 3909.38671875}
torch.Size([1898, 1433])
torch.Size([1130, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2362060546875 GB
    Memory Allocated: 0.01422262191772461  GigaBytes
Max Memory Allocated: 0.014379501342773438  GigaBytes

{'VmPeak': 21780.23046875, 'VmSize': 21748.234375, 'VmHWM': 4602.6875, 'VmRSS': 4602.6875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.012971878051757812  GigaBytes
Max Memory Allocated: 0.023047924041748047  GigaBytes

{'VmPeak': 21780.23046875, 'VmSize': 21758.484375, 'VmHWM': 4613.40234375, 'VmRSS': 4613.40234375}
torch.Size([1857, 1433])
torch.Size([1077, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.015419960021972656  GigaBytes
Max Memory Allocated: 0.023047924041748047  GigaBytes

{'VmPeak': 21780.23046875, 'VmSize': 21758.484375, 'VmHWM': 4613.40234375, 'VmRSS': 4613.40234375}
{'VmPeak': 21780.23046875, 'VmSize': 21758.484375, 'VmHWM': 4613.4921875, 'VmRSS': 4613.4921875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012884259223937988 |0.1838017702102661 |0.3888963460922241 |0.00022161006927490234 |0.005406498908996582 |0.0037064552307128906 |
----------------------------------------------------------pseudo_mini_loss sum 3.6326403617858887
{'VmPeak': 21780.23046875, 'VmSize': 21758.484375, 'VmHWM': 4613.9921875, 'VmRSS': 4613.9921875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6655
Number of first layer input nodes during this epoch:  3755
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.01609945297241211  GigaBytes
Max Memory Allocated: 0.023047924041748047  GigaBytes

{'VmPeak': 21780.23046875, 'VmSize': 21758.484375, 'VmHWM': 4613.9921875, 'VmRSS': 4613.9921875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006167888641357422
global_2_local 9.608268737792969e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.487701416015625e-05
before graph partition 
		341, 360, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0003783702850341797
	Initialize BitList time :  2.384185791015625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 341, 360

	before terminate 1 the average redundancy rate is:  1.0885093167701863
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
	walk terminate 1 spend time 5.392508029937744
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		341, 360, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 5.397035598754883
partition_len_list
[341, 360]
random_init_graph_partition selection method range initialization spend 5.397660732269287
time for parepare:  0.00015997886657714844
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0012128353118896484
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0006973743438720703
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.00041961669921875
----------------------check_connections_block total spend ----------------------------- 0.004116535186767578
generate_one_block  0.02762913703918457
generate_one_block  0.0013124942779541016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010848045349121094
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.0005309581756591797
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0004546642303466797
mini_batch_src_global generation:  0.00029754638671875
r_  generation:  0.0008885860443115234
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.0002970695495605469
r_  generation:  0.0008721351623535156
----------------------check_connections_block total spend ----------------------------- 0.0042552947998046875
generate_one_block  0.004911661148071289
generate_one_block  0.003166675567626953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009596347808837891
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.000217437744140625
local_output_nid generation:  0.0001049041748046875
local_in_edges_tensor generation:  0.0007290840148925781
mini_batch_src_global generation:  0.0005233287811279297
r_  generation:  0.0022420883178710938
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.00042247772216796875
r_  generation:  0.0022573471069335938
----------------------check_connections_block total spend ----------------------------- 0.00850057601928711
generate_one_block  0.013542652130126953
generate_one_block  0.00313568115234375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.01609945297241211  GigaBytes
Max Memory Allocated: 0.023047924041748047  GigaBytes

{'VmPeak': 21822.515625, 'VmSize': 21822.5, 'VmHWM': 4615.44140625, 'VmRSS': 4615.44140625}
connection checking time:  0.012755870819091797
block generation total time  0.024756669998168945
average batch blocks generation time:  0.012378334999084473
block dataloader generation time/epoch 5.482967376708984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.015919208526611328  GigaBytes
Max Memory Allocated: 0.025774478912353516  GigaBytes

{'VmPeak': 21832.60546875, 'VmSize': 21832.60546875, 'VmHWM': 4626.02734375, 'VmRSS': 4626.02734375}
torch.Size([1848, 1433])
torch.Size([1076, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.01835346221923828  GigaBytes
Max Memory Allocated: 0.025774478912353516  GigaBytes

{'VmPeak': 21832.60546875, 'VmSize': 21832.60546875, 'VmHWM': 4626.02734375, 'VmRSS': 4626.02734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.015931129455566406  GigaBytes
Max Memory Allocated: 0.025774478912353516  GigaBytes

{'VmPeak': 21832.60546875, 'VmSize': 21832.60546875, 'VmHWM': 4626.36328125, 'VmRSS': 4626.36328125}
torch.Size([1850, 1433])
torch.Size([1119, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.018470287322998047  GigaBytes
Max Memory Allocated: 0.025774478912353516  GigaBytes

{'VmPeak': 21832.60546875, 'VmSize': 21832.60546875, 'VmHWM': 4626.3671875, 'VmRSS': 4626.3671875}
{'VmPeak': 21832.60546875, 'VmSize': 21832.60546875, 'VmHWM': 4626.3671875, 'VmRSS': 4626.3671875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017085909843444824 |0.0008645057678222656 |0.007040739059448242 |0.0002770423889160156 |0.002390265464782715 |0.0023374557495117188 |
----------------------------------------------------------pseudo_mini_loss sum 1.3551441431045532
{'VmPeak': 21832.60546875, 'VmSize': 21832.60546875, 'VmHWM': 4626.3671875, 'VmRSS': 4626.3671875}
Total (block generation + training)time/epoch 5.545557737350464
Training time/epoch 0.06222724914550781
Training time without block to device /epoch 0.06049823760986328
Training time without total dataloading part /epoch 0.021753549575805664
load block tensor time/epoch 0.03417181968688965
block to device time/epoch 0.0017290115356445312
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6594
Number of first layer input nodes during this epoch:  3698
