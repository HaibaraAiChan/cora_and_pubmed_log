main start at this time 1648600617.2090027
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20817.421875, 'VmSize': 20802.70703125, 'VmHWM': 3614.08984375, 'VmRSS': 3614.08984375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001382589340209961
global_2_local 9.965896606445312e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.000232696533203125
before graph partition 
		75, 133, 91, 88, 97, 102, 103, 65, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00023055076599121094
	Initialize BitList time :  1.4543533325195312e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 75, 133

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.3664596273291925,  1.1925465838509317
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.3664596273291925,  1.1925465838509317
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 4.462050676345825
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 4.5105674266815186
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		83, 124, 91, 88, 97, 102, 103, 65, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				12, 24, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005843639373779297
	Initialize BitList time :  4.553794860839844e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 124, 91

	before terminate 1 the average redundancy rate is:  1.3354037267080745
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.5403726708074534,  1.1304347826086956
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.5403726708074534,  1.1304347826086956
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.5403726708074534,  1.1304347826086956
	walk terminate 1 spend time 4.616762161254883
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 124, 88, 97, 102, 103, 65, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				12, 18, 24, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0006058216094970703
	Initialize BitList time :  9.918212890625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 124, 88

	before terminate 1 the average redundancy rate is:  1.3167701863354038
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.5403726708074534,  1.093167701863354
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.5403726708074534,  1.093167701863354
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.5403726708074534,  1.093167701863354
	walk terminate 1 spend time 4.47924542427063
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 88, 124, 97, 102, 103, 65, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				12, 18, 18, 24, 18, 18, 18, 14, 


	preparing two sides time :  0.0005152225494384766
	Initialize BitList time :  4.029273986816406e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 97

	before terminate 1 the average redundancy rate is:  1.3726708074534162
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.5403726708074534,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.5403726708074534,  1.204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.5403726708074534,  1.204968944099379
	walk terminate 1 spend time 4.644931793212891
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 88, 97, 124, 102, 103, 65, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				12, 18, 18, 18, 24, 18, 18, 14, 


	preparing two sides time :  0.0005440711975097656
	Initialize BitList time :  8.392333984375e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 124, 102

	before terminate 1 the average redundancy rate is:  1.4037267080745341
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.3167701863354038,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.4782608695652173,  1.3167701863354038
						 current side  0
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.3664596273291925,  1.391304347826087
	walk terminate 1 spend time 4.670406341552734
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.515527950310559,  1.2298136645962734
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.3540372670807452,  1.3788819875776397
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.4285714285714286,  1.2919254658385093
	walk terminate 1 spend time 4.52379035949707
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		83, 91, 88, 97, 104, 115, 103, 65, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				12, 18, 18, 18, 19, 23, 18, 14, 


	preparing two sides time :  0.0004780292510986328
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 115, 103

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.4285714285714286,  1.279503105590062
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
	walk terminate 1 spend time 4.5201334953308105
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
	walk terminate 1 spend time 4.537073373794556
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		83, 91, 88, 97, 104, 85, 131, 65, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				12, 18, 18, 18, 19, 15, 26, 14, 


	preparing two sides time :  0.00047326087951660156
	Initialize BitList time :  3.7670135498046875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 131, 65

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.6273291925465838,  0.8074534161490683
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.6273291925465838,  0.8074534161490683
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.6273291925465838,  0.8074534161490683
	walk terminate 1 spend time 4.49985671043396
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 88, 97, 104, 85, 65, 131, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 45.49560785293579
partition_len_list
[83, 91, 88, 97, 104, 85, 65, 131]
random_init_graph_partition selection method range initialization spend 45.49630570411682
time for parepare:  0.000213623046875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0008840560913085938
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.015374898910522461
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.626678466796875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00029015541076660156
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.863739013671875e-05
----------------------check_connections_block total spend ----------------------------- 0.019630908966064453
generate_one_block  0.010272741317749023
generate_one_block  0.0011115074157714844
generate_one_block  0.001024007797241211
generate_one_block  0.0010330677032470703
generate_one_block  0.00102996826171875
generate_one_block  0.0010149478912353516
generate_one_block  0.0010027885437011719
generate_one_block  0.0010466575622558594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018236637115478516
gen group dst list time:  0.00012540817260742188
time for parepare:  0.0006375312805175781
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0005178451538085938
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002384185791015625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002837181091308594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0003120899200439453
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002830028533935547
----------------------check_connections_block total spend ----------------------------- 0.005293130874633789
generate_one_block  0.0012903213500976562
generate_one_block  0.0012612342834472656
generate_one_block  0.0013649463653564453
generate_one_block  0.0014028549194335938
generate_one_block  0.0013527870178222656
generate_one_block  0.0012903213500976562
generate_one_block  0.0012624263763427734
generate_one_block  0.0016055107116699219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014994144439697266
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.0006191730499267578
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0005030632019042969
mini_batch_src_global generation:  0.0003333091735839844
r_  generation:  0.000751495361328125
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00036835670471191406
mini_batch_src_global generation:  0.00016641616821289062
r_  generation:  0.0007021427154541016
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0008420944213867188
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0008401870727539062
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0008194446563720703
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005824565887451172
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0006237030029296875
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0008809566497802734
----------------------check_connections_block total spend ----------------------------- 0.012205839157104492
generate_one_block  0.0022063255310058594
generate_one_block  0.0020210742950439453
generate_one_block  0.002804994583129883
generate_one_block  0.0018961429595947266
generate_one_block  0.0019001960754394531
generate_one_block  0.0014965534210205078
generate_one_block  0.0017271041870117188
generate_one_block  0.0040209293365478516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20817.421875, 'VmSize': 20656.73046875, 'VmHWM': 3620.96484375, 'VmRSS': 3620.96484375}
connection checking time:  0.01749897003173828
block generation total time  0.028903722763061523
average batch blocks generation time:  0.0036129653453826904
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.007598876953125  GigaBytes
Max Memory Allocated: 0.007598876953125  GigaBytes

{'VmPeak': 21005.0234375, 'VmSize': 20977.43359375, 'VmHWM': 3911.140625, 'VmRSS': 3911.140625}
torch.Size([1138, 1433])
torch.Size([408, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008430957794189453  GigaBytes
Max Memory Allocated: 0.008746147155761719  GigaBytes

{'VmPeak': 21748.875, 'VmSize': 21748.875, 'VmHWM': 4604.8046875, 'VmRSS': 4604.8046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008481502532958984  GigaBytes
Max Memory Allocated: 0.014536380767822266  GigaBytes

{'VmPeak': 21754.5859375, 'VmSize': 21754.5859375, 'VmHWM': 4610.89453125, 'VmRSS': 4610.89453125}
torch.Size([1023, 1433])
torch.Size([384, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009289741516113281  GigaBytes
Max Memory Allocated: 0.014536380767822266  GigaBytes

{'VmPeak': 21754.5859375, 'VmSize': 21754.5859375, 'VmHWM': 4610.89453125, 'VmRSS': 4610.89453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009099483489990234  GigaBytes
Max Memory Allocated: 0.014536380767822266  GigaBytes

{'VmPeak': 21754.75, 'VmSize': 21754.75, 'VmHWM': 4612.57421875, 'VmRSS': 4612.57421875}
torch.Size([1053, 1433])
torch.Size([450, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.01000833511352539  GigaBytes
Max Memory Allocated: 0.014536380767822266  GigaBytes

{'VmPeak': 21754.75, 'VmSize': 21754.75, 'VmHWM': 4612.57421875, 'VmRSS': 4612.57421875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009596824645996094  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4613.5234375, 'VmRSS': 4613.5234375}
torch.Size([1231, 1433])
torch.Size([458, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.01053762435913086  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4613.5234375, 'VmRSS': 4613.5234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009099483489990234  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4613.5234375, 'VmRSS': 4613.5234375}
torch.Size([1059, 1433])
torch.Size([431, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010012149810791016  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4613.5234375, 'VmRSS': 4613.5234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007090568542480469  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4613.8125, 'VmRSS': 4613.8125}
torch.Size([763, 1433])
torch.Size([273, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007710456848144531  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4613.81640625, 'VmRSS': 4613.81640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009093761444091797  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.12890625, 'VmRSS': 4614.12890625}
torch.Size([986, 1433])
torch.Size([314, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009738922119140625  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.12890625, 'VmRSS': 4614.12890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.00922393798828125  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.12890625, 'VmRSS': 4614.12890625}
torch.Size([1161, 1433])
torch.Size([473, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010259628295898438  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.12890625, 'VmRSS': 4614.12890625}
{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.12890625, 'VmRSS': 4614.12890625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006140351295471191 |0.04664304852485657 |0.10046669840812683 |0.0001760423183441162 |0.004264503717422485 |0.0032498836517333984 |
----------------------------------------------------------pseudo_mini_loss sum 3.579834222793579
{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.56640625, 'VmRSS': 4614.56640625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12349
Number of first layer input nodes during this epoch:  8414
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012282848358154297  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21755.72265625, 'VmSize': 21755.72265625, 'VmHWM': 4614.56640625, 'VmRSS': 4614.56640625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005285739898681641
global_2_local 8.177757263183594e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.249282836914062e-05
before graph partition 
		83, 110, 101, 73, 133, 104, 89, 56, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00023031234741210938
	Initialize BitList time :  1.4781951904296875e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 83, 110

	before terminate 1 the average redundancy rate is:  1.1987577639751552
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.031055900621118,  1.3664596273291925
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.031055900621118,  1.3664596273291925
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.031055900621118,  1.3664596273291925
	walk terminate 1 spend time 5.3339667320251465
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 110, 101, 73, 133, 104, 89, 56, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004813671112060547
	Initialize BitList time :  3.886222839355469e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 110, 101

	before terminate 1 the average redundancy rate is:  1.31055900621118
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3664596273291925,  1.2546583850931676
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3664596273291925,  1.2546583850931676
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3664596273291925,  1.2546583850931676
	walk terminate 1 spend time 5.366535425186157
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 110, 73, 133, 104, 89, 56, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00038623809814453125
	Initialize BitList time :  8.368492126464844e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 110, 73

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.3664596273291925,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.3664596273291925,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.3664596273291925,  0.906832298136646
	walk terminate 1 spend time 5.260035037994385
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 110, 133, 104, 89, 56, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004870891571044922
	Initialize BitList time :  3.838539123535156e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 110, 133

	before terminate 1 the average redundancy rate is:  1.5093167701863353
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.3664596273291925,  1.6521739130434783
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.279503105590062,  1.7267080745341614
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.391304347826087,  1.6149068322981366
	walk terminate 1 spend time 5.448041677474976
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.391304347826087,  1.6149068322981366
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.2422360248447204,  1.763975155279503
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.2422360248447204,  1.763975155279503
	walk terminate 1 spend time 5.3679518699646
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83, 101, 73, 100, 142, 104, 89, 56, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 14, 22, 18, 18, 14, 


	preparing two sides time :  0.00044226646423339844
	Initialize BitList time :  3.218650817871094e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 142, 104

	before terminate 1 the average redundancy rate is:  1.5279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.763975155279503,  1.2919254658385093
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.763975155279503,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.763975155279503,  1.2919254658385093
	walk terminate 1 spend time 5.425992012023926
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 100, 104, 142, 89, 56, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 14, 18, 22, 18, 14, 


	preparing two sides time :  0.0004291534423828125
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 142, 89

	before terminate 1 the average redundancy rate is:  1.4347826086956523
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.763975155279503,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.763975155279503,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.763975155279503,  1.1055900621118013
	walk terminate 1 spend time 5.366810321807861
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 100, 104, 89, 142, 56, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 14, 18, 18, 22, 14, 


	preparing two sides time :  0.00046515464782714844
	Initialize BitList time :  7.367134094238281e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 142, 56

	before terminate 1 the average redundancy rate is:  1.2298136645962732
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.763975155279503,  0.6956521739130435
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.763975155279503,  0.6956521739130435
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.763975155279503,  0.6956521739130435
	walk terminate 1 spend time 5.397857666015625
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 100, 104, 89, 56, 142, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 42.99263119697571
partition_len_list
[83, 101, 73, 100, 104, 89, 56, 142]
random_init_graph_partition selection method range initialization spend 42.99315357208252
time for parepare:  0.0001811981201171875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.029190778732299805
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.00022935867309570312
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.650520324707031e-05
----------------------check_connections_block total spend ----------------------------- 0.03191089630126953
generate_one_block  0.014460563659667969
generate_one_block  0.00113677978515625
generate_one_block  0.0012047290802001953
generate_one_block  0.00106048583984375
generate_one_block  0.0010426044464111328
generate_one_block  0.0010528564453125
generate_one_block  0.0010311603546142578
generate_one_block  0.0010561943054199219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015633106231689453
gen group dst list time:  6.389617919921875e-05
time for parepare:  0.0006773471832275391
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.000293731689453125
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00024247169494628906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0003237724304199219
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002605915069580078
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00031495094299316406
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00024080276489257812
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00029349327087402344
----------------------check_connections_block total spend ----------------------------- 0.00516200065612793
generate_one_block  0.0013659000396728516
generate_one_block  0.001348257064819336
generate_one_block  0.0012273788452148438
generate_one_block  0.0013747215270996094
generate_one_block  0.001527547836303711
generate_one_block  0.0013608932495117188
generate_one_block  0.001255035400390625
generate_one_block  0.0016014575958251953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007066726684570312
gen group dst list time:  0.00010561943054199219
time for parepare:  0.00021791458129882812
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.0008492469787597656
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0008671283721923828
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0008656978607177734
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00048732757568359375
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0008196830749511719
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0009775161743164062
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0007925033569335938
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0004584789276123047
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0008425712585449219
----------------------check_connections_block total spend ----------------------------- 0.011193513870239258
generate_one_block  0.0076448917388916016
generate_one_block  0.0020139217376708984
generate_one_block  0.0015201568603515625
generate_one_block  0.001931905746459961
generate_one_block  0.0020847320556640625
generate_one_block  0.0019042491912841797
generate_one_block  0.0014820098876953125
generate_one_block  0.00199127197265625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012282848358154297  GigaBytes
Max Memory Allocated: 0.015646934509277344  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21819.98828125, 'VmHWM': 4615.23046875, 'VmRSS': 4615.1484375}
connection checking time:  0.016355514526367188
block generation total time  0.03163433074951172
average batch blocks generation time:  0.003954291343688965
block dataloader generation time/epoch 43.10957431793213
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.013278007507324219  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4618.52734375, 'VmRSS': 4618.52734375}
torch.Size([1234, 1433])
torch.Size([479, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.014223098754882812  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4618.52734375, 'VmRSS': 4618.52734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.011924266815185547  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4619.171875, 'VmRSS': 4619.171875}
torch.Size([1106, 1433])
torch.Size([447, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.012856006622314453  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4619.171875, 'VmRSS': 4619.171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.009703636169433594  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4619.171875, 'VmRSS': 4619.171875}
torch.Size([692, 1433])
torch.Size([269, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.010291576385498047  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4619.171875, 'VmRSS': 4619.171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.01196146011352539  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4619.2109375, 'VmRSS': 4619.2109375}
torch.Size([1113, 1433])
torch.Size([422, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.012852191925048828  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.1328125, 'VmHWM': 4619.2109375, 'VmRSS': 4619.2109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.012877941131591797  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.40625, 'VmHWM': 4619.484375, 'VmRSS': 4619.484375}
torch.Size([1284, 1433])
torch.Size([533, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.013953685760498047  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.48828125, 'VmRSS': 4619.48046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012012958526611328  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
torch.Size([1123, 1433])
torch.Size([433, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012897014617919922  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.009525299072265625  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
torch.Size([659, 1433])
torch.Size([231, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012224674224853516  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
torch.Size([1162, 1433])
torch.Size([470, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.013278961181640625  GigaBytes
Max Memory Allocated: 0.019449710845947266  GigaBytes

{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010592073202133179 |0.0007168948650360107 |0.0058841705322265625 |0.0002512335777282715 |0.0043219029903411865 |0.002276182174682617 |
----------------------------------------------------------pseudo_mini_loss sum 1.5965086221694946
{'VmPeak': 21883.73828125, 'VmSize': 21824.390625, 'VmHWM': 4619.6015625, 'VmRSS': 4619.6015625}
Total (block generation + training)time/epoch 43.299885511398315
Training time/epoch 0.19006729125976562
Training time without block to device /epoch 0.18433213233947754
Training time without total dataloading part /epoch 0.08593463897705078
load block tensor time/epoch 0.08473658561706543
block to device time/epoch 0.005735158920288086
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12405
Number of first layer input nodes during this epoch:  8373
