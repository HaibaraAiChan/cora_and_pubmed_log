main start at this time 1648601776.5171094
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20818.1171875, 'VmSize': 20802.94921875, 'VmHWM': 3615.1640625, 'VmRSS': 3615.1640625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011959075927734375
global_2_local 7.128715515136719e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.250640869140625e-05
before graph partition 
		75, 133, 91, 88, 97, 102, 103, 65, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020456314086914062
	Initialize BitList time :  1.2636184692382812e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 75, 133

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.3664596273291925,  1.1925465838509317
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.3664596273291925,  1.1925465838509317
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 4.282455682754517
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 4.245494842529297
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		83, 124, 91, 88, 97, 102, 103, 65, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				12, 24, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005068778991699219
	Initialize BitList time :  4.220008850097656e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 124, 91

	before terminate 1 the average redundancy rate is:  1.3354037267080745
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.5403726708074534,  1.1304347826086956
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.5403726708074534,  1.1304347826086956
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.5403726708074534,  1.1304347826086956
	walk terminate 1 spend time 4.628718137741089
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 124, 88, 97, 102, 103, 65, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				12, 18, 24, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0007166862487792969
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 124, 88

	before terminate 1 the average redundancy rate is:  1.3167701863354038
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.5403726708074534,  1.093167701863354
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.5403726708074534,  1.093167701863354
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.5403726708074534,  1.093167701863354
	walk terminate 1 spend time 4.2468581199646
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 88, 124, 97, 102, 103, 65, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				12, 18, 18, 24, 18, 18, 18, 14, 


	preparing two sides time :  0.0005357265472412109
	Initialize BitList time :  3.814697265625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 124, 97

	before terminate 1 the average redundancy rate is:  1.3726708074534162
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.5403726708074534,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.5403726708074534,  1.204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.5403726708074534,  1.204968944099379
	walk terminate 1 spend time 4.4650938510894775
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 88, 97, 124, 102, 103, 65, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				12, 18, 18, 18, 24, 18, 18, 14, 


	preparing two sides time :  0.0005137920379638672
	Initialize BitList time :  0.00013017654418945312
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 102

	before terminate 1 the average redundancy rate is:  1.4037267080745341
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.3167701863354038,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.4782608695652173,  1.3167701863354038
						 current side  0
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.3664596273291925,  1.391304347826087
	walk terminate 1 spend time 4.258212566375732
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3726708074534162,  1.515527950310559,  1.2298136645962734
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.3540372670807452,  1.3788819875776397
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.4285714285714286,  1.2919254658385093
	walk terminate 1 spend time 4.2300636768341064
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		83, 91, 88, 97, 104, 115, 103, 65, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				12, 18, 18, 18, 19, 23, 18, 14, 


	preparing two sides time :  0.0004773139953613281
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 115, 103

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.4285714285714286,  1.279503105590062
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
	walk terminate 1 spend time 4.60291314125061
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.6273291925465838,  1.0559006211180124
	walk terminate 1 spend time 4.188902139663696
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		83, 91, 88, 97, 104, 85, 131, 65, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				12, 18, 18, 18, 19, 15, 26, 14, 


	preparing two sides time :  0.0004773139953613281
	Initialize BitList time :  3.8623809814453125e-05
	getRedundancyCost: time   5.4836273193359375e-06

					length of partitions 131, 65

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.6273291925465838,  0.8074534161490683
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.6273291925465838,  0.8074534161490683
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.6273291925465838,  0.8074534161490683
	walk terminate 1 spend time 4.421478748321533
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 91, 88, 97, 104, 85, 65, 131, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 43.59762525558472
partition_len_list
[83, 91, 88, 97, 104, 85, 65, 131]
random_init_graph_partition selection method range initialization spend 43.59818148612976
time for parepare:  0.0002639293670654297
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0009992122650146484
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.013818025588989258
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  7.128715515136719e-05
----------------------check_connections_block total spend ----------------------------- 0.018352746963500977
generate_one_block  0.012007951736450195
generate_one_block  0.0012359619140625
generate_one_block  0.0011126995086669922
generate_one_block  0.001142740249633789
generate_one_block  0.0011310577392578125
generate_one_block  0.0011076927185058594
generate_one_block  0.0011076927185058594
generate_one_block  0.0011730194091796875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012481212615966797
gen group dst list time:  0.00014138221740722656
time for parepare:  0.0006024837493896484
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0004296302795410156
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003628730773925781
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003197193145751953
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00034737586975097656
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0003337860107421875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002665519714355469
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00018596649169921875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.00035119056701660156
----------------------check_connections_block total spend ----------------------------- 0.00563812255859375
generate_one_block  0.0013871192932128906
generate_one_block  0.0013210773468017578
generate_one_block  0.0014369487762451172
generate_one_block  0.0014410018920898438
generate_one_block  0.001447439193725586
generate_one_block  0.0012638568878173828
generate_one_block  0.0013098716735839844
generate_one_block  0.001680612564086914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017359256744384766
gen group dst list time:  0.00010752677917480469
time for parepare:  0.0006296634674072266
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0006155967712402344
mini_batch_src_global generation:  0.0003352165222167969
r_  generation:  0.0009562969207763672
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0008075237274169922
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0009746551513671875
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0009555816650390625
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0008955001831054688
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005731582641601562
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006871223449707031
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0009989738464355469
----------------------check_connections_block total spend ----------------------------- 0.013042688369750977
generate_one_block  0.0026726722717285156
generate_one_block  0.002117633819580078
generate_one_block  0.002246379852294922
generate_one_block  0.002314329147338867
generate_one_block  0.002146482467651367
generate_one_block  0.002711057662963867
generate_one_block  0.002127408981323242
generate_one_block  0.0037195682525634766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20818.1171875, 'VmSize': 20657.51171875, 'VmHWM': 3622.765625, 'VmRSS': 3622.765625}
connection checking time:  0.018680810928344727
block generation total time  0.03134346008300781
average batch blocks generation time:  0.0039179325103759766
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.00834035873413086  GigaBytes
Max Memory Allocated: 0.00834035873413086  GigaBytes

{'VmPeak': 21006.41015625, 'VmSize': 20977.93359375, 'VmHWM': 3913.3984375, 'VmRSS': 3913.3984375}
torch.Size([1276, 1433])
torch.Size([502, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0093231201171875  GigaBytes
Max Memory Allocated: 0.009691715240478516  GigaBytes

{'VmPeak': 21752.36328125, 'VmSize': 21752.36328125, 'VmHWM': 4610.3515625, 'VmRSS': 4610.3515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009045124053955078  GigaBytes
Max Memory Allocated: 0.01583385467529297  GigaBytes

{'VmPeak': 21758.55078125, 'VmSize': 21758.55078125, 'VmHWM': 4616.76953125, 'VmRSS': 4616.76953125}
torch.Size([1128, 1433])
torch.Size([420, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009912490844726562  GigaBytes
Max Memory Allocated: 0.01583385467529297  GigaBytes

{'VmPeak': 21758.55078125, 'VmSize': 21758.55078125, 'VmHWM': 4616.76953125, 'VmRSS': 4616.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00972604751586914  GigaBytes
Max Memory Allocated: 0.01583385467529297  GigaBytes

{'VmPeak': 21758.8046875, 'VmSize': 21758.8046875, 'VmHWM': 4617.4453125, 'VmRSS': 4617.4453125}
torch.Size([1174, 1433])
torch.Size([548, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010792255401611328  GigaBytes
Max Memory Allocated: 0.01583385467529297  GigaBytes

{'VmPeak': 21758.8046875, 'VmSize': 21758.8046875, 'VmHWM': 4617.4453125, 'VmRSS': 4617.4453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010144233703613281  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.34375, 'VmRSS': 4618.34375}
torch.Size([1333, 1433])
torch.Size([519, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.01118326187133789  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.34375, 'VmRSS': 4618.34375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009058475494384766  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.34375, 'VmRSS': 4618.34375}
torch.Size([1130, 1433])
torch.Size([459, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.34375, 'VmRSS': 4618.34375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007325172424316406  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
torch.Size([807, 1433])
torch.Size([273, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007945060729980469  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.0087432861328125  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
torch.Size([1072, 1433])
torch.Size([347, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009441375732421875  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.00980520248413086  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
torch.Size([1269, 1433])
torch.Size([542, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010953426361083984  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4618.62890625, 'VmRSS': 4618.62890625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010371595621109009 |0.04622951149940491 |0.10002803802490234 |0.0001347064971923828 |0.0032290518283843994 |0.003195047378540039 |
----------------------------------------------------------pseudo_mini_loss sum 3.5551187992095947
{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4619.00390625, 'VmRSS': 4619.00390625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13543
Number of first layer input nodes during this epoch:  9189
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012874603271484375  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21759.671875, 'VmSize': 21759.671875, 'VmHWM': 4619.00390625, 'VmRSS': 4619.00390625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005109310150146484
global_2_local 8.416175842285156e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.654594421386719e-05
before graph partition 
		83, 110, 101, 73, 133, 104, 89, 56, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00022745132446289062
	Initialize BitList time :  1.3113021850585938e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 83, 110

	before terminate 1 the average redundancy rate is:  1.1987577639751552
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.031055900621118,  1.3664596273291925
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.031055900621118,  1.3664596273291925
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.031055900621118,  1.3664596273291925
	walk terminate 1 spend time 5.23524284362793
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 110, 101, 73, 133, 104, 89, 56, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0017871856689453125
	Initialize BitList time :  0.00010251998901367188
	getRedundancyCost: time   6.389617919921875e-05

					length of partitions 110, 101

	before terminate 1 the average redundancy rate is:  1.31055900621118
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3664596273291925,  1.2546583850931676
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3664596273291925,  1.2546583850931676
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3664596273291925,  1.2546583850931676
	walk terminate 1 spend time 5.367342472076416
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 110, 73, 133, 104, 89, 56, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047087669372558594
	Initialize BitList time :  2.5987625122070312e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 110, 73

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.3664596273291925,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.3664596273291925,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.3664596273291925,  0.906832298136646
	walk terminate 1 spend time 5.260442018508911
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 110, 133, 104, 89, 56, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048804283142089844
	Initialize BitList time :  3.910064697265625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 110, 133

	before terminate 1 the average redundancy rate is:  1.5093167701863353
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.3664596273291925,  1.6521739130434783
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.279503105590062,  1.7267080745341614
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.391304347826087,  1.6149068322981366
	walk terminate 1 spend time 5.215990304946899
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.391304347826087,  1.6149068322981366
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.2422360248447204,  1.763975155279503
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.2422360248447204,  1.763975155279503
	walk terminate 1 spend time 5.336302757263184
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83, 101, 73, 100, 142, 104, 89, 56, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 14, 22, 18, 18, 14, 


	preparing two sides time :  0.0005114078521728516
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 142, 104

	before terminate 1 the average redundancy rate is:  1.5279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.763975155279503,  1.2919254658385093
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.763975155279503,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.763975155279503,  1.2919254658385093
	walk terminate 1 spend time 5.3030149936676025
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 100, 104, 142, 89, 56, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 14, 18, 22, 18, 14, 


	preparing two sides time :  0.0003349781036376953
	Initialize BitList time :  2.6941299438476562e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 142, 89

	before terminate 1 the average redundancy rate is:  1.4347826086956523
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.763975155279503,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.763975155279503,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.763975155279503,  1.1055900621118013
	walk terminate 1 spend time 5.27310585975647
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 100, 104, 89, 142, 56, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 14, 18, 18, 22, 14, 


	preparing two sides time :  0.00047278404235839844
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 142, 56

	before terminate 1 the average redundancy rate is:  1.2298136645962732
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.763975155279503,  0.6956521739130435
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.763975155279503,  0.6956521739130435
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.763975155279503,  0.6956521739130435
	walk terminate 1 spend time 5.392735958099365
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 101, 73, 100, 104, 89, 56, 142, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 42.41095328330994
partition_len_list
[83, 101, 73, 100, 104, 89, 56, 142]
random_init_graph_partition selection method range initialization spend 42.41162395477295
time for parepare:  0.00016117095947265625
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.04060792922973633
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.00030684471130371094
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.340576171875e-05
----------------------check_connections_block total spend ----------------------------- 0.04340791702270508
generate_one_block  0.024704694747924805
generate_one_block  0.0012013912200927734
generate_one_block  0.0012753009796142578
generate_one_block  0.0010669231414794922
generate_one_block  0.0010783672332763672
generate_one_block  0.0010647773742675781
generate_one_block  0.0010371208190917969
generate_one_block  0.001104116439819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016241073608398438
gen group dst list time:  6.103515625e-05
time for parepare:  0.0005972385406494141
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0007784366607666016
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0003364086151123047
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00026917457580566406
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0003440380096435547
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0003314018249511719
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  0.0005147457122802734
r_  generation:  0.00014710426330566406
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00032067298889160156
----------------------check_connections_block total spend ----------------------------- 0.007275819778442383
generate_one_block  0.0018379688262939453
generate_one_block  0.0013942718505859375
generate_one_block  0.0012485980987548828
generate_one_block  0.0014007091522216797
generate_one_block  0.0015301704406738281
generate_one_block  0.0014536380767822266
generate_one_block  0.0012145042419433594
generate_one_block  0.0016796588897705078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.014561653137207031
gen group dst list time:  0.0001800060272216797
time for parepare:  0.0006113052368164062
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.09453320503234863
mini_batch_src_global generation:  0.0004417896270751953
r_  generation:  0.0010983943939208984
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0006403923034667969
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.001035451889038086
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0005981922149658203
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00025653839111328125
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0009891986846923828
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00044989585876464844
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0012984275817871094
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0009965896606445312
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0005300045013427734
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0009903907775878906
----------------------check_connections_block total spend ----------------------------- 0.11026978492736816
generate_one_block  0.0037038326263427734
generate_one_block  0.0033249855041503906
generate_one_block  0.0024802684783935547
generate_one_block  0.0029523372650146484
generate_one_block  0.0032453536987304688
generate_one_block  0.0029566287994384766
generate_one_block  0.0021963119506835938
generate_one_block  0.0029981136322021484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012874603271484375  GigaBytes
Max Memory Allocated: 0.016813278198242188  GigaBytes

{'VmPeak': 21887.6875, 'VmSize': 21823.9375, 'VmHWM': 4620.140625, 'VmRSS': 4620.140625}
connection checking time:  0.11754560470581055
block generation total time  0.03561735153198242
average batch blocks generation time:  0.004452168941497803
block dataloader generation time/epoch 42.66994118690491
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.013338565826416016  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.6796875, 'VmRSS': 4620.67578125}
torch.Size([1370, 1433])
torch.Size([578, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.014442920684814453  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.6796875, 'VmRSS': 4620.67578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.012701988220214844  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.6796875, 'VmRSS': 4620.6796875}
torch.Size([1251, 1433])
torch.Size([507, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.013730525970458984  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.6796875, 'VmRSS': 4620.6796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.010212421417236328  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.76953125, 'VmRSS': 4620.76953125}
torch.Size([787, 1433])
torch.Size([305, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.01085805892944336  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.76953125, 'VmRSS': 4620.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.012761592864990234  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.76953125, 'VmRSS': 4620.76953125}
torch.Size([1262, 1433])
torch.Size([478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.013743877410888672  GigaBytes
Max Memory Allocated: 0.02008199691772461  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.125, 'VmHWM': 4620.76953125, 'VmRSS': 4620.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.013484954833984375  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
torch.Size([1397, 1433])
torch.Size([586, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.014646530151367188  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.012759685516357422  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
torch.Size([1229, 1433])
torch.Size([510, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.013767719268798828  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.009783744812011719  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
torch.Size([707, 1433])
torch.Size([239, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.010289192199707031  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.012959003448486328  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
torch.Size([1299, 1433])
torch.Size([520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.014094352722167969  GigaBytes
Max Memory Allocated: 0.020189285278320312  GigaBytes

{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004825562238693237 |0.0004488229751586914 |0.0035125315189361572 |0.00012886524200439453 |0.0033272206783294678 |0.0016036033630371094 |
----------------------------------------------------------pseudo_mini_loss sum 1.6120468378067017
{'VmPeak': 21888.13671875, 'VmSize': 21856.2734375, 'VmHWM': 4620.890625, 'VmRSS': 4620.890625}
Total (block generation + training)time/epoch 42.77971291542053
Training time/epoch 0.1095116138458252
Training time without block to device /epoch 0.10592103004455566
Training time without total dataloading part /epoch 0.057352542877197266
load block tensor time/epoch 0.0386044979095459
block to device time/epoch 0.0035905838012695312
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13773
Number of first layer input nodes during this epoch:  9302
