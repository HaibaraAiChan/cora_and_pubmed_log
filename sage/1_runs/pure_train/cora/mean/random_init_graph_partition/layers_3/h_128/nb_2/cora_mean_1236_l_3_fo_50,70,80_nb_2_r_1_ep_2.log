main start at this time 1648601701.2742188
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20819.265625, 'VmSize': 20802.96484375, 'VmHWM': 3613.45703125, 'VmRSS': 3613.45703125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010874271392822266
global_2_local 9.846687316894531e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00010538101196289062
before graph partition 
		348, 345, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002970695495605469
	Initialize BitList time :  2.002716064453125e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 348, 345

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0807453416149069,  1.0714285714285714
	walk terminate 1 spend time 4.43095588684082
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		345, 348, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.434932231903076
partition_len_list
[345, 348]
random_init_graph_partition selection method range initialization spend 4.435587167739868
time for parepare:  0.00013828277587890625
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0009517669677734375
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.014956474304199219
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.000255584716796875
----------------------check_connections_block total spend ----------------------------- 0.017580747604370117
generate_one_block  0.013616800308227539
generate_one_block  0.0012998580932617188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001071929931640625
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0005688667297363281
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0006453990936279297
mini_batch_src_global generation:  0.0003192424774169922
r_  generation:  0.0008902549743652344
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0003955364227294922
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0009133815765380859
----------------------check_connections_block total spend ----------------------------- 0.004818916320800781
generate_one_block  0.0023238658905029297
generate_one_block  0.002262592315673828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015225410461425781
gen group dst list time:  7.343292236328125e-05
time for parepare:  0.00025534629821777344
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.0010831356048583984
mini_batch_src_global generation:  0.0006232261657714844
r_  generation:  0.002527952194213867
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.00037360191345214844
r_  generation:  0.002365589141845703
----------------------check_connections_block total spend ----------------------------- 0.009353876113891602
generate_one_block  0.004674673080444336
generate_one_block  0.0034952163696289062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20819.265625, 'VmSize': 20656.7265625, 'VmHWM': 3620.1484375, 'VmRSS': 3620.125}
connection checking time:  0.014172792434692383
block generation total time  0.01275634765625
average batch blocks generation time:  0.006378173828125
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.012120246887207031  GigaBytes
Max Memory Allocated: 0.012120246887207031  GigaBytes

{'VmPeak': 20945.3359375, 'VmSize': 20945.3359375, 'VmHWM': 3910.1171875, 'VmRSS': 3910.1171875}
torch.Size([1977, 1433])
torch.Size([1201, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2362060546875 GB
    Memory Allocated: 0.014765262603759766  GigaBytes
Max Memory Allocated: 0.014922142028808594  GigaBytes

{'VmPeak': 21787.875, 'VmSize': 21755.86328125, 'VmHWM': 4610.55859375, 'VmRSS': 4610.55859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.01343679428100586  GigaBytes
Max Memory Allocated: 0.023929119110107422  GigaBytes

{'VmPeak': 21787.875, 'VmSize': 21766.5, 'VmHWM': 4622.00390625, 'VmRSS': 4622.00390625}
torch.Size([1943, 1433])
torch.Size([1152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.016006946563720703  GigaBytes
Max Memory Allocated: 0.023929119110107422  GigaBytes

{'VmPeak': 21787.875, 'VmSize': 21766.5, 'VmHWM': 4622.00390625, 'VmRSS': 4622.00390625}
{'VmPeak': 21787.875, 'VmSize': 21766.5, 'VmHWM': 4622.40234375, 'VmRSS': 4622.40234375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030476689338684082 |0.17918193340301514 |0.4108954668045044 |0.0002608299255371094 |0.005310535430908203 |0.005041837692260742 |
----------------------------------------------------------pseudo_mini_loss sum 3.6421732902526855
{'VmPeak': 21787.875, 'VmSize': 21766.5, 'VmHWM': 4622.40234375, 'VmRSS': 4622.40234375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6966
Number of first layer input nodes during this epoch:  3920
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.01657724380493164  GigaBytes
Max Memory Allocated: 0.023929119110107422  GigaBytes

{'VmPeak': 21787.875, 'VmSize': 21766.5, 'VmHWM': 4622.58984375, 'VmRSS': 4622.58984375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008997917175292969
global_2_local 0.00010442733764648438
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.202957153320312e-05
before graph partition 
		341, 360, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.000408172607421875
	Initialize BitList time :  2.6464462280273438e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 341, 360

	before terminate 1 the average redundancy rate is:  1.0885093167701863
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0885093167701863,  1.0590062111801242,  1.1180124223602483
	walk terminate 1 spend time 5.428090810775757
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		341, 360, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 5.43264102935791
partition_len_list
[341, 360]
random_init_graph_partition selection method range initialization spend 5.433260440826416
time for parepare:  0.00015783309936523438
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0012004375457763672
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0007169246673583984
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.00029659271240234375
----------------------check_connections_block total spend ----------------------------- 0.003747224807739258
generate_one_block  0.019731998443603516
generate_one_block  0.001378774642944336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023827552795410156
gen group dst list time:  3.5762786865234375e-05
time for parepare:  0.0006449222564697266
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0005323886871337891
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.0007452964782714844
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.0002949237823486328
r_  generation:  0.0008077621459960938
----------------------check_connections_block total spend ----------------------------- 0.004063844680786133
generate_one_block  0.002228975296020508
generate_one_block  0.008513927459716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001323699951171875
gen group dst list time:  6.127357482910156e-05
time for parepare:  0.00023603439331054688
local_output_nid generation:  7.748603820800781e-05
local_in_edges_tensor generation:  0.0013680458068847656
mini_batch_src_global generation:  0.0006313323974609375
r_  generation:  0.002190113067626953
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.0008554458618164062
mini_batch_src_global generation:  0.00038814544677734375
r_  generation:  0.0021429061889648438
----------------------check_connections_block total spend ----------------------------- 0.009421825408935547
generate_one_block  0.0032815933227539062
generate_one_block  0.0032672882080078125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.01657724380493164  GigaBytes
Max Memory Allocated: 0.023929119110107422  GigaBytes

{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4624.5546875, 'VmRSS': 4624.5546875}
connection checking time:  0.01348567008972168
block generation total time  0.017291784286499023
average batch blocks generation time:  0.008645892143249512
block dataloader generation time/epoch 5.508807420730591
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.016452789306640625  GigaBytes
Max Memory Allocated: 0.02676248550415039  GigaBytes

{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4625.53125, 'VmRSS': 4625.53125}
torch.Size([1947, 1433])
torch.Size([1164, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.01902914047241211  GigaBytes
Max Memory Allocated: 0.02676248550415039  GigaBytes

{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4625.53515625, 'VmRSS': 4625.53515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.016314983367919922  GigaBytes
Max Memory Allocated: 0.02676248550415039  GigaBytes

{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4625.63671875, 'VmRSS': 4625.63671875}
torch.Size([1921, 1433])
torch.Size([1192, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.01897287368774414  GigaBytes
Max Memory Allocated: 0.02676248550415039  GigaBytes

{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4625.63671875, 'VmRSS': 4625.63671875}
{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4625.63671875, 'VmRSS': 4625.63671875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04476523399353027 |0.0007575750350952148 |0.007361888885498047 |0.0003306865692138672 |0.005741000175476074 |0.0029947757720947266 |
----------------------------------------------------------pseudo_mini_loss sum 1.3980119228363037
{'VmPeak': 21894.515625, 'VmSize': 21830.515625, 'VmHWM': 4625.63671875, 'VmRSS': 4625.63671875}
Total (block generation + training)time/epoch 5.635594129562378
Training time/epoch 0.12643122673034668
Training time without block to device /epoch 0.12491607666015625
Training time without total dataloading part /epoch 0.029861927032470703
load block tensor time/epoch 0.08953046798706055
block to device time/epoch 0.0015151500701904297
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6925
Number of first layer input nodes during this epoch:  3868
