main start at this time 1648601719.5812895
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20802.71484375, 'VmSize': 20802.71484375, 'VmHWM': 3614.44921875, 'VmRSS': 3614.44921875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012288093566894531
global_2_local 8.463859558105469e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0002357959747314453
before graph partition 
		200, 167, 184, 179, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002605915069580078
	Initialize BitList time :  1.5735626220703125e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 200, 167

	before terminate 1 the average redundancy rate is:  1.139751552795031
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.139751552795031,  1.2298136645962734,  1.049689440993789
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.139751552795031,  1.2422360248447204,  1.0372670807453417
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.139751552795031,  1.2298136645962734,  1.049689440993789
	walk terminate 1 spend time 4.336617469787598
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		169, 198, 184, 179, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0003581047058105469
	Initialize BitList time :  2.9802322387695312e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 198, 184

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.0683229813664596,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.1925465838509317,  1.1490683229813665
						 current side  0
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.0434782608695652,  1.2981366459627328
	walk terminate 1 spend time 4.286005258560181
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.186335403726708,  1.15527950310559
						 current side  0
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.0869565217391304,  1.2546583850931676
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.2298136645962734,  1.1118012422360248
	walk terminate 1 spend time 4.388811826705933
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		169, 179, 198, 179, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0007219314575195312
	Initialize BitList time :  4.673004150390625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 198, 179

	before terminate 1 the average redundancy rate is:  1.170807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.1801242236024845,  1.1614906832298137
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.1925465838509317,  1.1366459627329193
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.1801242236024845,  1.1490683229813665
	walk terminate 1 spend time 4.3843090534210205
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.173913043478261,  1.15527950310559
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.2236024844720497,  1.1055900621118013
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.204968944099379,  1.1366459627329193
	walk terminate 1 spend time 4.431324243545532
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		169, 179, 183, 194, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 21.83809995651245
partition_len_list
[169, 179, 183, 194]
random_init_graph_partition selection method range initialization spend 21.838690996170044
time for parepare:  0.0002465248107910156
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0014119148254394531
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.015478372573852539
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.559226989746094e-05
----------------------check_connections_block total spend ----------------------------- 0.018915414810180664
generate_one_block  0.011998891830444336
generate_one_block  0.0012645721435546875
generate_one_block  0.0011789798736572266
generate_one_block  0.0011744499206542969
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019030570983886719
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.0007460117340087891
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0005414485931396484
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0006041526794433594
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005524158477783203
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0005428791046142578
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0005903244018554688
----------------------check_connections_block total spend ----------------------------- 0.005145072937011719
generate_one_block  0.0016937255859375
generate_one_block  0.0015933513641357422
generate_one_block  0.0015523433685302734
generate_one_block  0.001674652099609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014882087707519531
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.0004429817199707031
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.0010044574737548828
mini_batch_src_global generation:  0.0008766651153564453
r_  generation:  0.00167083740234375
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.001329183578491211
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.0019631385803222656
r_  generation:  0.0014100074768066406
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.0001804828643798828
r_  generation:  0.0013477802276611328
----------------------check_connections_block total spend ----------------------------- 0.013296365737915039
generate_one_block  0.004731178283691406
generate_one_block  0.004656314849853516
generate_one_block  0.003239870071411133
generate_one_block  0.003119945526123047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20808.64453125, 'VmSize': 20656.74609375, 'VmHWM': 3621.703125, 'VmRSS': 3621.703125}
connection checking time:  0.018441438674926758
block generation total time  0.022261381149291992
average batch blocks generation time:  0.005565345287322998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.0100860595703125  GigaBytes
Max Memory Allocated: 0.0100860595703125  GigaBytes

{'VmPeak': 21016.8359375, 'VmSize': 20984.83984375, 'VmHWM': 3919.265625, 'VmRSS': 3919.265625}
torch.Size([1600, 1433])
torch.Size([817, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.011752605438232422  GigaBytes
Max Memory Allocated: 0.01205587387084961  GigaBytes

{'VmPeak': 21748.09375, 'VmSize': 21748.09375, 'VmHWM': 4604.484375, 'VmRSS': 4604.484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.011396408081054688  GigaBytes
Max Memory Allocated: 0.019896507263183594  GigaBytes

{'VmPeak': 21756.67578125, 'VmSize': 21756.67578125, 'VmHWM': 4614.109375, 'VmRSS': 4614.109375}
torch.Size([1565, 1433])
torch.Size([761, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012992382049560547  GigaBytes
Max Memory Allocated: 0.019896507263183594  GigaBytes

{'VmPeak': 21756.67578125, 'VmSize': 21756.67578125, 'VmHWM': 4614.109375, 'VmRSS': 4614.109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.011744499206542969  GigaBytes
Max Memory Allocated: 0.020056724548339844  GigaBytes

{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4614.984375, 'VmRSS': 4614.984375}
torch.Size([1630, 1433])
torch.Size([752, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.013336181640625  GigaBytes
Max Memory Allocated: 0.020056724548339844  GigaBytes

{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4614.984375, 'VmRSS': 4614.984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.011708259582519531  GigaBytes
Max Memory Allocated: 0.020366668701171875  GigaBytes

{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4614.984375, 'VmRSS': 4614.984375}
torch.Size([1623, 1433])
torch.Size([784, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.013372421264648438  GigaBytes
Max Memory Allocated: 0.020366668701171875  GigaBytes

{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4614.984375, 'VmRSS': 4614.984375}
{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4615.296875, 'VmRSS': 4615.296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016823887825012207 |0.09254121780395508 |0.19564944505691528 |0.00017184019088745117 |0.004020571708679199 |0.0030460357666015625 |
----------------------------------------------------------pseudo_mini_loss sum 3.514739990234375
{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4615.296875, 'VmRSS': 4615.296875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10257
Number of first layer input nodes during this epoch:  6418
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014804840087890625  GigaBytes
Max Memory Allocated: 0.020366668701171875  GigaBytes

{'VmPeak': 21821.02734375, 'VmSize': 21789.03125, 'VmHWM': 4615.296875, 'VmRSS': 4615.296875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004734992980957031
global_2_local 8.058547973632812e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.462501525878906e-05
before graph partition 
		158, 194, 226, 152, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002257823944091797
	Initialize BitList time :  1.4543533325195312e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 158, 194

	before terminate 1 the average redundancy rate is:  1.093167701863354
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.15527950310559,  1.0186335403726707
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.031055900621118,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 5.103578329086304
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.0683229813664596,  1.0993788819875776
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.0124223602484472,  1.15527950310559
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 7
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.1614906832298137,  1.0124223602484472
	walk terminate 1 spend time 5.2591822147369385
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		163, 187, 226, 152, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				32, 38, 35, 35, 


	preparing two sides time :  0.0005481243133544922
	Initialize BitList time :  4.363059997558594e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 187, 226

	before terminate 1 the average redundancy rate is:  1.2826086956521738
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2826086956521738,  1.1801242236024845,  1.3850931677018634
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.1677018633540373,  1.4037267080745341
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2888198757763973,  1.1987577639751552,  1.3788819875776397
	walk terminate 1 spend time 5.373275995254517
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		163, 193, 222, 152, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				32, 39, 34, 35, 


	preparing two sides time :  0.0005190372467041016
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 222, 152

	before terminate 1 the average redundancy rate is:  1.1614906832298137
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.1987577639751552,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2173913043478262,  1.0993788819875776
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2173913043478262,  1.0993788819875776
	walk terminate 1 spend time 5.415719985961914
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2173913043478262,  1.0993788819875776
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.236024844720497,  1.0807453416149069
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.0,  1.31055900621118
	walk terminate 1 spend time 5.4408087730407715
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		163, 193, 161, 211, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 26.601422548294067
partition_len_list
[163, 193, 161, 211]
random_init_graph_partition selection method range initialization spend 26.60184335708618
time for parepare:  0.00012350082397460938
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0008664131164550781
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0003733634948730469
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00013875961303710938
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00017309188842773438
----------------------check_connections_block total spend ----------------------------- 0.0036499500274658203
generate_one_block  0.03398275375366211
generate_one_block  0.0013239383697509766
generate_one_block  0.001129150390625
generate_one_block  0.0015652179718017578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00194549560546875
gen group dst list time:  5.626678466796875e-05
time for parepare:  0.0004742145538330078
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0010175704956054688
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.0004448890686035156
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  0.00017642974853515625
r_  generation:  0.0004849433898925781
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0003933906555175781
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004918575286865234
----------------------check_connections_block total spend ----------------------------- 0.0049495697021484375
generate_one_block  0.004683494567871094
generate_one_block  0.0015795230865478516
generate_one_block  0.0014736652374267578
generate_one_block  0.0018303394317626953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011248588562011719
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.0002624988555908203
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0007402896881103516
mini_batch_src_global generation:  0.00018310546875
r_  generation:  0.0012454986572265625
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0002224445343017578
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.00146484375
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.001220703125
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0013918876647949219
----------------------check_connections_block total spend ----------------------------- 0.00914311408996582
generate_one_block  0.012512683868408203
generate_one_block  0.0030651092529296875
generate_one_block  0.0026895999908447266
generate_one_block  0.00264739990234375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014804840087890625  GigaBytes
Max Memory Allocated: 0.020366668701171875  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21853.296875, 'VmHWM': 4616.6640625, 'VmRSS': 4616.6640625}
connection checking time:  0.014092683792114258
block generation total time  0.030481815338134766
average batch blocks generation time:  0.007620453834533691
block dataloader generation time/epoch 26.70232367515564
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014735221862792969  GigaBytes
Max Memory Allocated: 0.02335977554321289  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21857.51171875, 'VmHWM': 4620.91015625, 'VmRSS': 4620.91015625}
torch.Size([1522, 1433])
torch.Size([725, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.016241073608398438  GigaBytes
Max Memory Allocated: 0.02335977554321289  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21857.51171875, 'VmHWM': 4620.91015625, 'VmRSS': 4620.91015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.015121936798095703  GigaBytes
Max Memory Allocated: 0.023777484893798828  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.00390625, 'VmRSS': 4622.00390625}
torch.Size([1701, 1433])
torch.Size([851, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.016892433166503906  GigaBytes
Max Memory Allocated: 0.023777484893798828  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.00390625, 'VmRSS': 4622.00390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.013757705688476562  GigaBytes
Max Memory Allocated: 0.023777484893798828  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.078125, 'VmRSS': 4622.078125}
torch.Size([1447, 1433])
torch.Size([685, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.015195369720458984  GigaBytes
Max Memory Allocated: 0.023777484893798828  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.078125, 'VmRSS': 4622.078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.014553070068359375  GigaBytes
Max Memory Allocated: 0.023777484893798828  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.27734375, 'VmRSS': 4622.27734375}
torch.Size([1595, 1433])
torch.Size([808, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2752685546875 GB
    Memory Allocated: 0.01629018783569336  GigaBytes
Max Memory Allocated: 0.023777484893798828  GigaBytes

{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.27734375, 'VmRSS': 4622.27734375}
{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.27734375, 'VmRSS': 4622.27734375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023303866386413574 |0.0006582140922546387 |0.005017220973968506 |0.00020259618759155273 |0.00392305850982666 |0.002220630645751953 |
----------------------------------------------------------pseudo_mini_loss sum 1.411912202835083
{'VmPeak': 21917.046875, 'VmSize': 21858.4921875, 'VmHWM': 4622.27734375, 'VmRSS': 4622.27734375}
Total (block generation + training)time/epoch 26.8447744846344
Training time/epoch 0.141737699508667
Training time without block to device /epoch 0.13910484313964844
Training time without total dataloading part /epoch 0.03879213333129883
load block tensor time/epoch 0.0932154655456543
block to device time/epoch 0.0026328563690185547
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10062
Number of first layer input nodes during this epoch:  6265
