main start at this time 1648599709.1353505
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20865.9140625, 'VmSize': 20865.9140625, 'VmHWM': 3613.53515625, 'VmRSS': 3613.53515625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014543533325195312
global_2_local 0.00012874603271484375
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00013875961303710938
before graph partition 
		361, 332, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0004868507385253906
	Initialize BitList time :  3.075599670410156e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 361, 332

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906831,  1.0900621118012421,  1.0590062111801242
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906831,  1.0900621118012421,  1.0590062111801242
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
	walk terminate 1 spend time 4.3837058544158936
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
	walk terminate 1 spend time 4.342338800430298
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		345, 347, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 8.730446815490723
partition_len_list
[345, 347]
random_init_graph_partition selection method range initialization spend 8.730895042419434
time for parepare:  9.131431579589844e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0010232925415039062
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.013541460037231445
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0001633167266845703
----------------------check_connections_block total spend ----------------------------- 0.015822649002075195
generate_one_block  0.024782419204711914
generate_one_block  0.0012862682342529297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014150142669677734
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.0007491111755371094
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0004181861877441406
mini_batch_src_global generation:  0.0003104209899902344
r_  generation:  0.0007085800170898438
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  0.00025081634521484375
r_  generation:  0.0007331371307373047
----------------------check_connections_block total spend ----------------------------- 0.004048347473144531
generate_one_block  0.0025014877319335938
generate_one_block  0.002411365509033203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006699562072753906
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.00017213821411132812
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0006740093231201172
mini_batch_src_global generation:  0.0005543231964111328
r_  generation:  0.0017595291137695312
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0018932819366455078
----------------------check_connections_block total spend ----------------------------- 0.007118701934814453
generate_one_block  0.008518457412719727
generate_one_block  0.003292560577392578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20871.6015625, 'VmSize': 20720.0625, 'VmHWM': 3620.71875, 'VmRSS': 3620.71875}
connection checking time:  0.011167049407958984
block generation total time  0.0167238712310791
average batch blocks generation time:  0.00836193561553955
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.010729312896728516  GigaBytes
Max Memory Allocated: 0.010729312896728516  GigaBytes

{'VmPeak': 20945.05078125, 'VmSize': 20945.05078125, 'VmHWM': 3910.49609375, 'VmRSS': 3910.49609375}
torch.Size([1863, 1433])
torch.Size([1124, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2342529296875 GB
    Memory Allocated: 0.012029647827148438  GigaBytes
Max Memory Allocated: 0.012104511260986328  GigaBytes

{'VmPeak': 21721.01953125, 'VmSize': 21721.00390625, 'VmHWM': 4608.31640625, 'VmRSS': 4608.31640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012107372283935547  GigaBytes
Max Memory Allocated: 0.021989822387695312  GigaBytes

{'VmPeak': 21795.8515625, 'VmSize': 21763.85546875, 'VmHWM': 4620.2890625, 'VmRSS': 4620.2890625}
torch.Size([1985, 1433])
torch.Size([1209, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.013480186462402344  GigaBytes
Max Memory Allocated: 0.021989822387695312  GigaBytes

{'VmPeak': 21795.8515625, 'VmSize': 21763.85546875, 'VmHWM': 4620.2890625, 'VmRSS': 4620.2890625}
{'VmPeak': 21795.8515625, 'VmSize': 21763.85546875, 'VmHWM': 4620.6796875, 'VmRSS': 4620.6796875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009565949440002441 |0.178267240524292 |0.42394328117370605 |0.0003770589828491211 |0.00465703010559082 |0.0031900405883789062 |
----------------------------------------------------------pseudo_mini_loss sum 3.599660634994507
{'VmPeak': 21795.8515625, 'VmSize': 21763.85546875, 'VmHWM': 4620.6796875, 'VmRSS': 4620.6796875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6873
Number of first layer input nodes during this epoch:  3848
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.013695716857910156  GigaBytes
Max Memory Allocated: 0.021989822387695312  GigaBytes

{'VmPeak': 21795.8515625, 'VmSize': 21763.85546875, 'VmHWM': 4620.9921875, 'VmRSS': 4620.9921875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005686283111572266
global_2_local 8.7738037109375e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.845329284667969e-05
before graph partition 
		346, 348, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0003390312194824219
	Initialize BitList time :  2.193450927734375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 346, 348

	before terminate 1 the average redundancy rate is:  1.0776397515527951
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.0745341614906831,  1.0807453416149069
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0559006211180124,  1.0962732919254659
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0714285714285714,  1.0807453416149069
	walk terminate 1 spend time 5.159534454345703
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0714285714285714,  1.0807453416149069
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0559006211180124,  1.093167701863354
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0745341614906831,  1.0776397515527951
	walk terminate 1 spend time 5.307538032531738
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		346, 347, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 10.471095323562622
partition_len_list
[346, 347]
random_init_graph_partition selection method range initialization spend 10.471556663513184
time for parepare:  0.00017786026000976562
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0009751319885253906
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0007655620574951172
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.00028514862060546875
----------------------check_connections_block total spend ----------------------------- 0.0037915706634521484
generate_one_block  0.026726245880126953
generate_one_block  0.0013134479522705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022683143615722656
gen group dst list time:  3.62396240234375e-05
time for parepare:  0.0006282329559326172
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0008904933929443359
mini_batch_src_global generation:  0.00030517578125
r_  generation:  0.0007107257843017578
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00038123130798339844
mini_batch_src_global generation:  0.0003139972686767578
r_  generation:  0.0007410049438476562
----------------------check_connections_block total spend ----------------------------- 0.0050182342529296875
generate_one_block  0.001962900161743164
generate_one_block  0.002320528030395508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014929771423339844
gen group dst list time:  6.103515625e-05
time for parepare:  0.0002243518829345703
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0009496212005615234
mini_batch_src_global generation:  0.00042724609375
r_  generation:  0.0021142959594726562
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.0007927417755126953
mini_batch_src_global generation:  0.0003399848937988281
r_  generation:  0.0019381046295166016
----------------------check_connections_block total spend ----------------------------- 0.007895946502685547
generate_one_block  0.0037806034088134766
generate_one_block  0.003702402114868164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.013695716857910156  GigaBytes
Max Memory Allocated: 0.021989822387695312  GigaBytes

{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.29296875, 'VmRSS': 4623.04296875}
connection checking time:  0.012914180755615234
block generation total time  0.011766433715820312
average batch blocks generation time:  0.005883216857910156
block dataloader generation time/epoch 10.542171001434326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.013041496276855469  GigaBytes
Max Memory Allocated: 0.023579120635986328  GigaBytes

{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.734375, 'VmRSS': 4623.734375}
torch.Size([1891, 1433])
torch.Size([1114, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.014331817626953125  GigaBytes
Max Memory Allocated: 0.023579120635986328  GigaBytes

{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.734375, 'VmRSS': 4623.734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.013299942016601562  GigaBytes
Max Memory Allocated: 0.023579120635986328  GigaBytes

{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.81640625, 'VmRSS': 4623.81640625}
torch.Size([1939, 1433])
torch.Size([1200, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2498779296875 GB
    Memory Allocated: 0.014661788940429688  GigaBytes
Max Memory Allocated: 0.023579120635986328  GigaBytes

{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.81640625, 'VmRSS': 4623.81640625}
{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.81640625, 'VmRSS': 4623.81640625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008868813514709473 |0.0007011890411376953 |0.006737470626831055 |0.0002288818359375 |0.003126978874206543 |0.002199411392211914 |
----------------------------------------------------------pseudo_mini_loss sum 2.0926198959350586
{'VmPeak': 21891.87109375, 'VmSize': 21827.87109375, 'VmHWM': 4623.81640625, 'VmRSS': 4623.81640625}
Total (block generation + training)time/epoch 10.5878586769104
Training time/epoch 0.04533982276916504
Training time without block to device /epoch 0.04393744468688965
Training time without total dataloading part /epoch 0.02238607406616211
load block tensor time/epoch 0.017737627029418945
block to device time/epoch 0.0014023780822753906
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6837
Number of first layer input nodes during this epoch:  3830
