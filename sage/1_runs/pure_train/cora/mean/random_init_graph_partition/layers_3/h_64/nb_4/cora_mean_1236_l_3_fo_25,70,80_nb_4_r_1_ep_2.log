main start at this time 1648599736.844093
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20814.1640625, 'VmSize': 20802.16796875, 'VmHWM': 3613.63671875, 'VmRSS': 3613.63671875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009064674377441406
global_2_local 9.870529174804688e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00010466575622558594
before graph partition 
		183, 199, 165, 184, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002865791320800781
	Initialize BitList time :  1.6927719116210938e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 183, 199

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.15527950310559,  1.2173913043478262
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.186335403726708,  1.1304347826086956,  1.2422360248447204
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.15527950310559,  1.2173913043478262
	walk terminate 1 spend time 4.335970163345337
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.1801242236024845,  1.1925465838509317
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.1428571428571428,  1.2298136645962734
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.31055900621118,  1.049689440993789
	walk terminate 1 spend time 4.254498720169067
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		169, 211, 165, 184, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				33, 37, 35, 35, 


	preparing two sides time :  0.0009522438049316406
	Initialize BitList time :  4.7206878662109375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 211, 165

	before terminate 1 the average redundancy rate is:  1.1677018633540373
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.2857142857142858,  1.049689440993789
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.2981366459627328,  1.0372670807453417
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.2732919254658386,  1.062111801242236
	walk terminate 1 spend time 4.255752325057983
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		169, 171, 205, 184, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				33, 36, 36, 35, 


	preparing two sides time :  0.0005342960357666016
	Initialize BitList time :  4.220008850097656e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 205, 184

	before terminate 1 the average redundancy rate is:  1.2080745341614907
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2080745341614907,  1.2608695652173914,  1.15527950310559
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.2857142857142858,  1.1180124223602483
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.2670807453416149,  1.1366459627329193
	walk terminate 1 spend time 4.3384175300598145
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.0372670807453417,  1.3354037267080745
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.1677018633540373,  1.2236024844720497
						 current side  0
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.0124223602484472,  1.3726708074534162
	walk terminate 1 spend time 4.470370531082153
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		169, 171, 163, 221, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 21.666768312454224
partition_len_list
[169, 171, 163, 221]
random_init_graph_partition selection method range initialization spend 21.667312145233154
time for parepare:  0.00020933151245117188
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.004719734191894531
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.013834953308105469
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00014019012451171875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.890296936035156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00015854835510253906
----------------------check_connections_block total spend ----------------------------- 0.020863056182861328
generate_one_block  0.011761903762817383
generate_one_block  0.0012021064758300781
generate_one_block  0.0010848045349121094
generate_one_block  0.0011186599731445312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011298656463623047
gen group dst list time:  5.340576171875e-05
time for parepare:  0.0006968975067138672
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0004565715789794922
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005114078521728516
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005331039428710938
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005841255187988281
----------------------check_connections_block total spend ----------------------------- 0.004787445068359375
generate_one_block  0.002451181411743164
generate_one_block  0.0019068717956542969
generate_one_block  0.00186920166015625
generate_one_block  0.002215147018432617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007326602935791016
gen group dst list time:  0.00010085105895996094
time for parepare:  0.0003120899200439453
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.0005953311920166016
mini_batch_src_global generation:  0.0004687309265136719
r_  generation:  0.0015857219696044922
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.00029778480529785156
r_  generation:  0.0016207695007324219
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.0002903938293457031
mini_batch_src_global generation:  0.00014138221740722656
r_  generation:  0.001321554183959961
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0017521381378173828
----------------------check_connections_block total spend ----------------------------- 0.011325836181640625
generate_one_block  0.0055081844329833984
generate_one_block  0.0023877620697021484
generate_one_block  0.0021638870239257812
generate_one_block  0.002473592758178711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20814.1640625, 'VmSize': 20656.30859375, 'VmHWM': 3620.75, 'VmRSS': 3620.75}
connection checking time:  0.01611328125
block generation total time  0.020975828170776367
average batch blocks generation time:  0.005243957042694092
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.009204387664794922  GigaBytes
Max Memory Allocated: 0.009204387664794922  GigaBytes

{'VmPeak': 21005.875, 'VmSize': 20977.484375, 'VmHWM': 3910.93359375, 'VmRSS': 3910.93359375}
torch.Size([1581, 1433])
torch.Size([776, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.01003265380859375  GigaBytes
Max Memory Allocated: 0.010172843933105469  GigaBytes

{'VmPeak': 21755.3125, 'VmSize': 21749.6875, 'VmHWM': 4605.21875, 'VmRSS': 4605.21875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010066032409667969  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21758.46875, 'VmSize': 21758.46875, 'VmHWM': 4615.546875, 'VmRSS': 4615.546875}
torch.Size([1607, 1433])
torch.Size([783, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.01090240478515625  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21758.46875, 'VmSize': 21758.46875, 'VmHWM': 4615.546875, 'VmRSS': 4615.546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008837223052978516  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21758.46875, 'VmSize': 21758.46875, 'VmHWM': 4615.96875, 'VmRSS': 4615.96875}
torch.Size([1378, 1433])
torch.Size([613, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009525299072265625  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21758.46875, 'VmSize': 21758.46875, 'VmHWM': 4615.96875, 'VmRSS': 4615.96875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010635852813720703  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21759.05078125, 'VmSize': 21759.05078125, 'VmHWM': 4616.7421875, 'VmRSS': 4616.7421875}
torch.Size([1713, 1433])
torch.Size([868, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.011592864990234375  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21759.05078125, 'VmSize': 21759.05078125, 'VmHWM': 4616.7421875, 'VmRSS': 4616.7421875}
{'VmPeak': 21759.05078125, 'VmSize': 21759.05078125, 'VmHWM': 4616.7734375, 'VmRSS': 4616.7734375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0068582892417907715 |0.09615671634674072 |0.19710153341293335 |0.00018662214279174805 |0.004728913307189941 |0.003531217575073242 |
----------------------------------------------------------pseudo_mini_loss sum 3.472830057144165
{'VmPeak': 21759.05078125, 'VmSize': 21759.05078125, 'VmHWM': 4617.3359375, 'VmRSS': 4617.3359375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10043
Number of first layer input nodes during this epoch:  6279
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012183189392089844  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21759.05078125, 'VmSize': 21759.05078125, 'VmHWM': 4617.3359375, 'VmRSS': 4617.3359375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008141994476318359
global_2_local 7.653236389160156e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00011229515075683594
before graph partition 
		156, 202, 180, 188, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00023245811462402344
	Initialize BitList time :  1.4781951904296875e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 156, 202

	before terminate 1 the average redundancy rate is:  1.1118012422360248
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.093167701863354,  1.124223602484472
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.0745341614906831,  1.1428571428571428
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.15527950310559,  1.062111801242236
	walk terminate 1 spend time 5.372534513473511
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.0,  1.2173913043478262
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.1180124223602483,  1.0993788819875776
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.0869565217391304,  1.1118012422360248
	walk terminate 1 spend time 5.431136131286621
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		175, 179, 180, 188, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				39, 31, 35, 35, 


	preparing two sides time :  0.0005424022674560547
	Initialize BitList time :  4.887580871582031e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 179, 180

	before terminate 1 the average redundancy rate is:  1.1149068322981366
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1149068322981366,  1.1304347826086956,  1.0993788819875776
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1149068322981366,  1.1118012422360248,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1118012422360248,  1.124223602484472,  1.0993788819875776
	walk terminate 1 spend time 5.19322657585144
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1118012422360248,  1.0124223602484472,  1.2111801242236024
						 current side  1
			 redundancy will reduce  0.009316770186335255
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1055900621118013,  1.1490683229813665,  1.062111801242236
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1024844720496896,  1.049689440993789,  1.15527950310559
	walk terminate 1 spend time 5.219313144683838
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		175, 169, 186, 188, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				39, 29, 37, 35, 


	preparing two sides time :  0.0005245208740234375
	Initialize BitList time :  5.269050598144531e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 186, 188

	before terminate 1 the average redundancy rate is:  1.1614906832298137
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1801242236024845,  1.1304347826086956
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.0248447204968945,  1.279503105590062
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.0372670807453417,  1.2670807453416149
	walk terminate 1 spend time 5.156921625137329
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1925465838509317,  1.1180124223602483
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.173913043478261,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.2484472049689441,  1.0807453416149069
	walk terminate 1 spend time 5.1792237758636475
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		175, 169, 174, 201, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 31.562349796295166
partition_len_list
[175, 169, 174, 201]
random_init_graph_partition selection method range initialization spend 31.562912702560425
time for parepare:  0.0001277923583984375
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0006487369537353516
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0004334449768066406
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00014138221740722656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00011396408081054688
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001361370086669922
----------------------check_connections_block total spend ----------------------------- 0.003468751907348633
generate_one_block  0.025581836700439453
generate_one_block  0.0012204647064208984
generate_one_block  0.0011301040649414062
generate_one_block  0.001295328140258789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017919540405273438
gen group dst list time:  5.459785461425781e-05
time for parepare:  0.0007455348968505859
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.0007269382476806641
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.00046825408935546875
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0006744861602783203
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006670951843261719
----------------------check_connections_block total spend ----------------------------- 0.005738258361816406
generate_one_block  0.0018894672393798828
generate_one_block  0.0017635822296142578
generate_one_block  0.0019161701202392578
generate_one_block  0.0019161701202392578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017070770263671875
gen group dst list time:  0.00010442733764648438
time for parepare:  0.0004258155822753906
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0008959770202636719
mini_batch_src_global generation:  0.0005435943603515625
r_  generation:  0.0015811920166015625
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0002472400665283203
r_  generation:  0.001352071762084961
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0018384456634521484
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.001605987548828125
----------------------check_connections_block total spend ----------------------------- 0.01192164421081543
generate_one_block  0.0036230087280273438
generate_one_block  0.0036928653717041016
generate_one_block  0.010077476501464844
generate_one_block  0.005795717239379883
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012183189392089844  GigaBytes
Max Memory Allocated: 0.01846456527709961  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21823.06640625, 'VmHWM': 4618.55078125, 'VmRSS': 4618.55078125}
connection checking time:  0.017659902572631836
block generation total time  0.030674457550048828
average batch blocks generation time:  0.007668614387512207
block dataloader generation time/epoch 31.661622047424316
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011364936828613281  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21826.59765625, 'VmHWM': 4621.609375, 'VmRSS': 4621.609375}
torch.Size([1581, 1433])
torch.Size([760, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.01218414306640625  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21826.59765625, 'VmHWM': 4621.609375, 'VmRSS': 4621.609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.010090827941894531  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21826.59765625, 'VmHWM': 4622.02734375, 'VmRSS': 4622.02734375}
torch.Size([1343, 1433])
torch.Size([608, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.010779857635498047  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21826.59765625, 'VmHWM': 4622.02734375, 'VmRSS': 4622.02734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.01206064224243164  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21827.30078125, 'VmHWM': 4622.74609375, 'VmRSS': 4622.74609375}
torch.Size([1710, 1433])
torch.Size([889, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.012986183166503906  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21827.30078125, 'VmHWM': 4622.74609375, 'VmRSS': 4622.74609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011024951934814453  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21827.30078125, 'VmHWM': 4622.75, 'VmRSS': 4622.75}
torch.Size([1517, 1433])
torch.Size([773, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011884212493896484  GigaBytes
Max Memory Allocated: 0.020470142364501953  GigaBytes

{'VmPeak': 21887.06640625, 'VmSize': 21827.30078125, 'VmHWM': 4622.75, 'VmRSS': 4622.75}
{'VmPeak': 21887.06640625, 'VmSize': 21827.30078125, 'VmHWM': 4622.75, 'VmRSS': 4622.75}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015814125537872314 |0.0009397268295288086 |0.00873798131942749 |0.00024169683456420898 |0.0032956600189208984 |0.0021407604217529297 |
----------------------------------------------------------pseudo_mini_loss sum 2.2856926918029785
{'VmPeak': 21887.06640625, 'VmSize': 21827.28515625, 'VmHWM': 4622.75, 'VmRSS': 4622.74609375}
Total (block generation + training)time/epoch 31.789185047149658
Training time/epoch 0.12717747688293457
Training time without block to device /epoch 0.12341856956481934
Training time without total dataloading part /epoch 0.05124211311340332
load block tensor time/epoch 0.06325650215148926
block to device time/epoch 0.0037589073181152344
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9900
Number of first layer input nodes during this epoch:  6151
