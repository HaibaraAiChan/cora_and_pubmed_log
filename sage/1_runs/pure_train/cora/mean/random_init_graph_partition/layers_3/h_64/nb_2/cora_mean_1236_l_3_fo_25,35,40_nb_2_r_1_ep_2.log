main start at this time 1648598909.4441562
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20820.1484375, 'VmSize': 20805.71875, 'VmHWM': 3617.703125, 'VmRSS': 3617.703125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013163089752197266
global_2_local 7.987022399902344e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.250640869140625e-05
before graph partition 
		361, 332, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002868175506591797
	Initialize BitList time :  2.1219253540039062e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 361, 332

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906831,  1.0900621118012421,  1.0590062111801242
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906831,  1.0900621118012421,  1.0590062111801242
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
	walk terminate 1 spend time 4.617396593093872
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0714285714285714,  1.0776397515527951
	walk terminate 1 spend time 4.780093669891357
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		345, 347, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 9.401756763458252
partition_len_list
[345, 347]
random_init_graph_partition selection method range initialization spend 9.40229082107544
time for parepare:  0.00014853477478027344
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0009615421295166016
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.015984296798706055
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.00027489662170410156
----------------------check_connections_block total spend ----------------------------- 0.018661975860595703
generate_one_block  0.021500587463378906
generate_one_block  0.0012693405151367188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021255016326904297
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.0006587505340576172
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0010943412780761719
mini_batch_src_global generation:  0.00027632713317871094
r_  generation:  0.0006740093231201172
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0007004737854003906
----------------------check_connections_block total spend ----------------------------- 0.004445552825927734
generate_one_block  0.0018086433410644531
generate_one_block  0.0028884410858154297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.003094196319580078
gen group dst list time:  5.5789947509765625e-05
time for parepare:  0.0004222393035888672
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.0015358924865722656
mini_batch_src_global generation:  0.0007605552673339844
r_  generation:  0.002611875534057617
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.001703023910522461
mini_batch_src_global generation:  0.0007004737854003906
r_  generation:  0.002107381820678711
----------------------check_connections_block total spend ----------------------------- 0.011242151260375977
generate_one_block  0.002968311309814453
generate_one_block  0.004057884216308594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20820.1484375, 'VmSize': 20655.6875, 'VmHWM': 3620.5546875, 'VmRSS': 3620.5546875}
connection checking time:  0.01568770408630371
block generation total time  0.01172327995300293
average batch blocks generation time:  0.005861639976501465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.010400772094726562  GigaBytes
Max Memory Allocated: 0.010400772094726562  GigaBytes

{'VmPeak': 21005.51953125, 'VmSize': 20977.30859375, 'VmHWM': 3911.2265625, 'VmRSS': 3911.2265625}
torch.Size([1802, 1433])
torch.Size([1052, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0116424560546875  GigaBytes
Max Memory Allocated: 0.01171731948852539  GigaBytes

{'VmPeak': 21766.61328125, 'VmSize': 21751.5234375, 'VmHWM': 4607.13671875, 'VmRSS': 4607.13671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011804580688476562  GigaBytes
Max Memory Allocated: 0.02136516571044922  GigaBytes

{'VmPeak': 21766.61328125, 'VmSize': 21762.0703125, 'VmHWM': 4618.97265625, 'VmRSS': 4618.97265625}
torch.Size([1929, 1433])
torch.Size([1126, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2557373046875 GB
    Memory Allocated: 0.0131072998046875  GigaBytes
Max Memory Allocated: 0.02136516571044922  GigaBytes

{'VmPeak': 21766.61328125, 'VmSize': 21762.0703125, 'VmHWM': 4618.97265625, 'VmRSS': 4618.97265625}
{'VmPeak': 21766.61328125, 'VmSize': 21762.0703125, 'VmHWM': 4619.3046875, 'VmRSS': 4619.3046875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011308431625366211 |0.18904948234558105 |0.3981163501739502 |0.00026738643646240234 |0.005286216735839844 |0.003210783004760742 |
----------------------------------------------------------pseudo_mini_loss sum 3.5941734313964844
{'VmPeak': 21766.61328125, 'VmSize': 21762.0703125, 'VmHWM': 4619.3046875, 'VmRSS': 4619.3046875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6601
Number of first layer input nodes during this epoch:  3731
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.013384342193603516  GigaBytes
Max Memory Allocated: 0.02136516571044922  GigaBytes

{'VmPeak': 21766.61328125, 'VmSize': 21762.0703125, 'VmHWM': 4619.4921875, 'VmRSS': 4619.4921875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046372413635253906
global_2_local 6.866455078125e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.462501525878906e-05
before graph partition 
		346, 348, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002574920654296875
	Initialize BitList time :  1.7881393432617188e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 346, 348

	before terminate 1 the average redundancy rate is:  1.0776397515527951
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.0745341614906831,  1.0807453416149069
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0559006211180124,  1.0962732919254659
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0714285714285714,  1.0807453416149069
	walk terminate 1 spend time 5.527085542678833
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0714285714285714,  1.0807453416149069
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0559006211180124,  1.093167701863354
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.0745341614906831,  1.0776397515527951
	walk terminate 1 spend time 5.651019096374512
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		346, 347, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 11.181740045547485
partition_len_list
[346, 347]
random_init_graph_partition selection method range initialization spend 11.1823091506958
time for parepare:  0.00017023086547851562
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0010972023010253906
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0007996559143066406
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002982616424560547
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0003790855407714844
----------------------check_connections_block total spend ----------------------------- 0.003873109817504883
generate_one_block  0.03323531150817871
generate_one_block  0.0013420581817626953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019613027572631836
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0006957054138183594
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.0010118484497070312
mini_batch_src_global generation:  0.0003781318664550781
r_  generation:  0.0011997222900390625
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00047278404235839844
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.0010988712310791016
----------------------check_connections_block total spend ----------------------------- 0.006457090377807617
generate_one_block  0.0023338794708251953
generate_one_block  0.002497434616088867
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015332698822021484
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.00038242340087890625
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.0008580684661865234
mini_batch_src_global generation:  0.0005919933319091797
r_  generation:  0.0024230480194091797
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0008268356323242188
mini_batch_src_global generation:  0.0005216598510742188
r_  generation:  0.0022978782653808594
----------------------check_connections_block total spend ----------------------------- 0.009552240371704102
generate_one_block  0.003634214401245117
generate_one_block  0.004485130310058594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.013384342193603516  GigaBytes
Max Memory Allocated: 0.02136516571044922  GigaBytes

{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4621.19921875, 'VmRSS': 4621.19921875}
connection checking time:  0.01600933074951172
block generation total time  0.012950658798217773
average batch blocks generation time:  0.006475329399108887
block dataloader generation time/epoch 11.282665252685547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.012847423553466797  GigaBytes
Max Memory Allocated: 0.02308797836303711  GigaBytes

{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4621.99609375, 'VmRSS': 4621.99609375}
torch.Size([1855, 1433])
torch.Size([1049, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.014086246490478516  GigaBytes
Max Memory Allocated: 0.02308797836303711  GigaBytes

{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4621.99609375, 'VmRSS': 4621.99609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.012976646423339844  GigaBytes
Max Memory Allocated: 0.02308797836303711  GigaBytes

{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4622.07421875, 'VmRSS': 4622.07421875}
torch.Size([1879, 1433])
torch.Size([1116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.014269828796386719  GigaBytes
Max Memory Allocated: 0.02308797836303711  GigaBytes

{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4622.07421875, 'VmRSS': 4622.07421875}
{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4622.07421875, 'VmRSS': 4622.07421875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03528237342834473 |0.0010269880294799805 |0.007130861282348633 |0.00042450428009033203 |0.005618572235107422 |0.0024077892303466797 |
----------------------------------------------------------pseudo_mini_loss sum 2.1152615547180176
{'VmPeak': 21890.0859375, 'VmSize': 21826.0859375, 'VmHWM': 4622.07421875, 'VmRSS': 4622.07421875}
Total (block generation + training)time/epoch 11.38878083229065
Training time/epoch 0.1057579517364502
Training time without block to device /epoch 0.10370397567749023
Training time without total dataloading part /epoch 0.028755664825439453
load block tensor time/epoch 0.07056474685668945
block to device time/epoch 0.002053976058959961
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6592
Number of first layer input nodes during this epoch:  3734
