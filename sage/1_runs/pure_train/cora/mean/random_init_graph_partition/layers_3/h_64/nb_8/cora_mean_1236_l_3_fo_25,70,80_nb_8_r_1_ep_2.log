main start at this time 1648599798.4978964
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20818.15625, 'VmSize': 20812.83203125, 'VmHWM': 3625.71875, 'VmRSS': 3625.71875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006287097930908203
global_2_local 7.700920104980469e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.989738464355469e-05
before graph partition 
		117, 74, 121, 103, 73, 83, 108, 72, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021314620971679688
	Initialize BitList time :  1.4066696166992188e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 117, 74

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.453416149068323,  0.9192546583850931
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.453416149068323,  0.9192546583850931
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.453416149068323,  0.9192546583850931
	walk terminate 1 spend time 4.130244016647339
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 121, 103, 73, 83, 108, 72, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005009174346923828
	Initialize BitList time :  3.0994415283203125e-05
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 117, 121

	before terminate 1 the average redundancy rate is:  1.4782608695652173
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.453416149068323,  1.5031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.453416149068323,  1.5031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.453416149068323,  1.5031055900621118
	walk terminate 1 spend time 4.20953369140625
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		74, 117, 121, 103, 73, 83, 108, 72, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004887580871582031
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 121, 103

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.5031055900621118,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.5031055900621118,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.5031055900621118,  1.279503105590062
	walk terminate 1 spend time 4.234225273132324
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 103, 121, 73, 83, 108, 72, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00084686279296875
	Initialize BitList time :  3.0517578125e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 121, 73

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3664596273291925,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3664596273291925,  1.0434782608695652
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.15527950310559,  1.2546583850931676
	walk terminate 1 spend time 4.3221595287323
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.15527950310559,  1.2546583850931676
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.031055900621118,  1.3788819875776397
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.031055900621118,  1.3788819875776397
	walk terminate 1 spend time 4.170785665512085
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		74, 117, 103, 83, 111, 83, 108, 72, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 11, 25, 18, 18, 14, 


	preparing two sides time :  0.00047659873962402344
	Initialize BitList time :  3.838539123535156e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 111, 83

	before terminate 1 the average redundancy rate is:  1.2049689440993787
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3788819875776397,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3788819875776397,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3788819875776397,  1.031055900621118
	walk terminate 1 spend time 4.165342092514038
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 103, 83, 83, 111, 108, 72, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 11, 18, 25, 18, 14, 


	preparing two sides time :  0.0004832744598388672
	Initialize BitList time :  3.4809112548828125e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 111, 108

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
	walk terminate 1 spend time 4.305362224578857
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
	walk terminate 1 spend time 4.221258640289307
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		74, 117, 103, 83, 83, 88, 129, 72, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 11, 18, 21, 22, 14, 


	preparing two sides time :  0.0004630088806152344
	Initialize BitList time :  3.933906555175781e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 129, 72

	before terminate 1 the average redundancy rate is:  1.2484472049689441
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6024844720496894,  0.8944099378881988
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6024844720496894,  0.8944099378881988
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6024844720496894,  0.8944099378881988
	walk terminate 1 spend time 4.271574258804321
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 103, 83, 83, 88, 72, 129, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 38.05717897415161
partition_len_list
[74, 117, 103, 83, 83, 88, 72, 129]
random_init_graph_partition selection method range initialization spend 38.05767583847046
time for parepare:  0.00014972686767578125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.04488801956176758
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.009252071380615234
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.410743713378906e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  7.009506225585938e-05
----------------------check_connections_block total spend ----------------------------- 0.0565798282623291
generate_one_block  0.009618759155273438
generate_one_block  0.0014405250549316406
generate_one_block  0.0011909008026123047
generate_one_block  0.0011265277862548828
generate_one_block  0.0011119842529296875
generate_one_block  0.0011980533599853516
generate_one_block  0.0011098384857177734
generate_one_block  0.0011610984802246094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020112991333007812
gen group dst list time:  0.00011992454528808594
time for parepare:  0.0006608963012695312
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00023698806762695312
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00030112266540527344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002846717834472656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00024437904357910156
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.000244140625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00024127960205078125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001957416534423828
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00030541419982910156
----------------------check_connections_block total spend ----------------------------- 0.0051119327545166016
generate_one_block  0.008428573608398438
generate_one_block  0.0029366016387939453
generate_one_block  0.0028924942016601562
generate_one_block  0.0027370452880859375
generate_one_block  0.0027916431427001953
generate_one_block  0.0028982162475585938
generate_one_block  0.0020253658294677734
generate_one_block  0.0019392967224121094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019584178924560547
gen group dst list time:  0.00016164779663085938
time for parepare:  0.0005197525024414062
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.07138180732727051
mini_batch_src_global generation:  0.0003628730773925781
r_  generation:  0.0008947849273681641
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.00042366981506347656
mini_batch_src_global generation:  0.000324249267578125
r_  generation:  0.0011959075927734375
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.0011055469512939453
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  0.00015974044799804688
r_  generation:  0.0009529590606689453
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0010716915130615234
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0010187625885009766
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0007884502410888672
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0010364055633544922
----------------------check_connections_block total spend ----------------------------- 0.08672714233398438
generate_one_block  0.002503633499145508
generate_one_block  0.0024619102478027344
generate_one_block  0.002224445343017578
generate_one_block  0.0022170543670654297
generate_one_block  0.0022287368774414062
generate_one_block  0.0021462440490722656
generate_one_block  0.0018754005432128906
generate_one_block  0.0022416114807128906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20818.15625, 'VmSize': 20660.6640625, 'VmHWM': 3626.66015625, 'VmRSS': 3626.65625}
connection checking time:  0.09183907508850098
block generation total time  0.04454827308654785
average batch blocks generation time:  0.0055685341358184814
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005982398986816406  GigaBytes
Max Memory Allocated: 0.005982398986816406  GigaBytes

{'VmPeak': 21006.16796875, 'VmSize': 20977.890625, 'VmHWM': 3914.48046875, 'VmRSS': 3914.48046875}
torch.Size([981, 1433])
torch.Size([390, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006390571594238281  GigaBytes
Max Memory Allocated: 0.0065155029296875  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21749.56640625, 'VmHWM': 4607.9453125, 'VmRSS': 4607.9453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008222103118896484  GigaBytes
Max Memory Allocated: 0.013430118560791016  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4615.33984375, 'VmRSS': 4615.33984375}
torch.Size([1264, 1433])
torch.Size([532, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008792877197265625  GigaBytes
Max Memory Allocated: 0.013430118560791016  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4615.33984375, 'VmRSS': 4615.33984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00790548324584961  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4615.83984375, 'VmRSS': 4615.83984375}
torch.Size([1205, 1433])
torch.Size([514, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008446216583251953  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4615.83984375, 'VmRSS': 4615.83984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0072193145751953125  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.0078125, 'VmRSS': 4616.0078125}
torch.Size([1077, 1433])
torch.Size([405, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00765228271484375  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.0078125, 'VmRSS': 4616.0078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008011341094970703  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.078125, 'VmRSS': 4616.078125}
torch.Size([1225, 1433])
torch.Size([479, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008503437042236328  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.078125, 'VmRSS': 4616.078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007572650909423828  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.29296875, 'VmRSS': 4616.29296875}
torch.Size([1143, 1433])
torch.Size([463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008056163787841797  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.29296875, 'VmRSS': 4616.29296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006473064422607422  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.5, 'VmRSS': 4616.5}
torch.Size([938, 1433])
torch.Size([377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006865978240966797  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21756.58203125, 'VmHWM': 4616.5, 'VmRSS': 4616.5}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009002685546875  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21757.37890625, 'VmHWM': 4617.05078125, 'VmRSS': 4617.05078125}
torch.Size([1410, 1433])
torch.Size([568, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009616374969482422  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21757.37890625, 'VmHWM': 4617.05078125, 'VmRSS': 4617.05078125}
{'VmPeak': 21767.6640625, 'VmSize': 21757.37890625, 'VmHWM': 4617.0546875, 'VmRSS': 4617.0546875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006167471408843994 |0.04438701272010803 |0.1004466712474823 |0.00015801191329956055 |0.00260317325592041 |0.002718687057495117 |
----------------------------------------------------------pseudo_mini_loss sum 3.3701109886169434
{'VmPeak': 21767.6640625, 'VmSize': 21757.37890625, 'VmHWM': 4617.4296875, 'VmRSS': 4617.4296875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13720
Number of first layer input nodes during this epoch:  9243
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010516643524169922  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21767.6640625, 'VmSize': 21757.37890625, 'VmHWM': 4617.4296875, 'VmRSS': 4617.4296875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048422813415527344
global_2_local 8.392333984375e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.987022399902344e-05
before graph partition 
		77, 86, 107, 103, 79, 116, 80, 99, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020956993103027344
	Initialize BitList time :  1.3113021850585938e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 77, 86

	before terminate 1 the average redundancy rate is:  1.0124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0124223602484472,  0.9565217391304348,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0124223602484472,  0.9565217391304348,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0124223602484472,  0.9565217391304348,  1.0683229813664596
	walk terminate 1 spend time 4.9791259765625
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		77, 86, 107, 103, 79, 116, 80, 99, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004940032958984375
	Initialize BitList time :  2.9087066650390625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 86, 107

	before terminate 1 the average redundancy rate is:  1.1987577639751552
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0683229813664596,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0683229813664596,  1.329192546583851
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0683229813664596,  1.329192546583851
	walk terminate 1 spend time 4.9851744174957275
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		77, 86, 107, 103, 79, 116, 80, 99, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047087669372558594
	Initialize BitList time :  3.0279159545898438e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 107, 103

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.329192546583851,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.329192546583851,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.329192546583851,  1.279503105590062
	walk terminate 1 spend time 5.387695789337158
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 107, 79, 116, 80, 99, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003421306610107422
	Initialize BitList time :  1.9311904907226562e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 107, 79

	before terminate 1 the average redundancy rate is:  1.15527950310559
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.329192546583851,  0.9813664596273292
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.329192546583851,  0.9813664596273292
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.329192546583851,  0.9813664596273292
	walk terminate 1 spend time 5.221056699752808
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 79, 107, 116, 80, 99, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005028247833251953
	Initialize BitList time :  3.218650817871094e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 107, 116

	before terminate 1 the average redundancy rate is:  1.3850931677018634
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.329192546583851,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.329192546583851,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.329192546583851,  1.4409937888198758
	walk terminate 1 spend time 5.222975015640259
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		77, 86, 103, 79, 107, 116, 80, 99, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004601478576660156
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 116, 80

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.4409937888198758,  0.9937888198757764
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.4409937888198758,  0.9937888198757764
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.4409937888198758,  0.9937888198757764
	walk terminate 1 spend time 5.092443466186523
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 79, 107, 80, 116, 99, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046944618225097656
	Initialize BitList time :  3.552436828613281e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 116, 99

	before terminate 1 the average redundancy rate is:  1.3354037267080745
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.4409937888198758,  1.2298136645962734
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.4409937888198758,  1.2298136645962734
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.4409937888198758,  1.2298136645962734
	walk terminate 1 spend time 5.1721885204315186
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 79, 107, 80, 99, 116, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 36.08601188659668
partition_len_list
[77, 86, 103, 79, 107, 80, 99, 116]
random_init_graph_partition selection method range initialization spend 36.08655118942261
time for parepare:  0.00020265579223632812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.00047516822814941406
r_  generation:  0.0005483627319335938
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0003056526184082031
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  5.9604644775390625e-05
----------------------check_connections_block total spend ----------------------------- 0.005652189254760742
generate_one_block  0.0257415771484375
generate_one_block  0.0011849403381347656
generate_one_block  0.0014874935150146484
generate_one_block  0.0010404586791992188
generate_one_block  0.0010499954223632812
generate_one_block  0.0010347366333007812
generate_one_block  0.0010461807250976562
generate_one_block  0.001041412353515625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021424293518066406
gen group dst list time:  0.00016236305236816406
time for parepare:  0.0010039806365966797
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.0005960464477539062
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0006215572357177734
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0005383491516113281
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0006239414215087891
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.00043487548828125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002682209014892578
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006861686706542969
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006380081176757812
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0006761550903320312
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006868839263916016
----------------------check_connections_block total spend ----------------------------- 0.011221647262573242
generate_one_block  0.0025787353515625
generate_one_block  0.0017740726470947266
generate_one_block  0.001794576644897461
generate_one_block  0.0017135143280029297
generate_one_block  0.001847982406616211
generate_one_block  0.0018379688262939453
generate_one_block  0.0015397071838378906
generate_one_block  0.0013489723205566406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008766651153564453
gen group dst list time:  0.00010848045349121094
time for parepare:  0.0005137920379638672
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0009891986846923828
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0007877349853515625
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0007636547088623047
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.0007035732269287109
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006206035614013672
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0007085800170898438
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0009229183197021484
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0009763240814208984
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.0003294944763183594
r_  generation:  0.0008974075317382812
----------------------check_connections_block total spend ----------------------------- 0.012453079223632812
generate_one_block  0.0053615570068359375
generate_one_block  0.008401155471801758
generate_one_block  0.0018057823181152344
generate_one_block  0.0016756057739257812
generate_one_block  0.0018091201782226562
generate_one_block  0.0020749568939208984
generate_one_block  0.0021364688873291016
generate_one_block  0.0019216537475585938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010516643524169922  GigaBytes
Max Memory Allocated: 0.014626026153564453  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21821.39453125, 'VmHWM': 4618.296875, 'VmRSS': 4618.20703125}
connection checking time:  0.023674726486206055
block generation total time  0.039621829986572266
average batch blocks generation time:  0.004952728748321533
block dataloader generation time/epoch 36.20596933364868
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008503913879394531  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21823.94140625, 'VmHWM': 4620.64453125, 'VmRSS': 4620.64453125}
torch.Size([1048, 1433])
torch.Size([440, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008956432342529297  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21823.94140625, 'VmHWM': 4620.64453125, 'VmRSS': 4620.64453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008961677551269531  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.41015625, 'VmHWM': 4621.20703125, 'VmRSS': 4621.20703125}
torch.Size([1134, 1433])
torch.Size([439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00942087173461914  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.41015625, 'VmHWM': 4621.20703125, 'VmRSS': 4621.20703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008064746856689453  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.41015625, 'VmHWM': 4621.234375, 'VmRSS': 4621.234375}
torch.Size([966, 1433])
torch.Size([381, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008496284484863281  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.41015625, 'VmHWM': 4621.234375, 'VmRSS': 4621.234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007335186004638672  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.41015625, 'VmHWM': 4621.3046875, 'VmRSS': 4621.3046875}
torch.Size([830, 1433])
torch.Size([349, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007713794708251953  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.39453125, 'VmHWM': 4621.30859375, 'VmRSS': 4621.30078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.0076847076416015625  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.39453125, 'VmHWM': 4621.30859375, 'VmRSS': 4621.30078125}
torch.Size([895, 1433])
torch.Size([394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008130073547363281  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21824.39453125, 'VmHWM': 4621.30859375, 'VmRSS': 4621.30078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009900569915771484  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4621.92578125, 'VmRSS': 4621.92578125}
torch.Size([1309, 1433])
torch.Size([563, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010455608367919922  GigaBytes
Max Memory Allocated: 0.016006946563720703  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4621.92578125, 'VmRSS': 4621.92578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009950637817382812  GigaBytes
Max Memory Allocated: 0.01690959930419922  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4622.375, 'VmRSS': 4622.375}
torch.Size([1318, 1433])
torch.Size([560, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010524749755859375  GigaBytes
Max Memory Allocated: 0.01690959930419922  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4622.3828125, 'VmRSS': 4622.3828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009022235870361328  GigaBytes
Max Memory Allocated: 0.01690959930419922  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4622.3828125, 'VmRSS': 4622.3828125}
torch.Size([1145, 1433])
torch.Size([488, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009551048278808594  GigaBytes
Max Memory Allocated: 0.01690959930419922  GigaBytes

{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4622.3828125, 'VmRSS': 4622.3828125}
{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4622.3828125, 'VmRSS': 4622.3828125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012320637702941895 |0.0005335807800292969 |0.004151284694671631 |0.00016248226165771484 |0.002490401268005371 |0.0016546249389648438 |
----------------------------------------------------------pseudo_mini_loss sum 2.1626906394958496
{'VmPeak': 21885.39453125, 'VmSize': 21825.3515625, 'VmHWM': 4622.3828125, 'VmRSS': 4622.3828125}
Total (block generation + training)time/epoch 36.37665390968323
Training time/epoch 0.17039871215820312
Training time without block to device /epoch 0.16613006591796875
Training time without total dataloading part /epoch 0.05608797073364258
load block tensor time/epoch 0.09856510162353516
block to device time/epoch 0.004268646240234375
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13006
Number of first layer input nodes during this epoch:  8645
