main start at this time 1648598999.422596
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20822.4453125, 'VmSize': 20810.71484375, 'VmHWM': 3621.66015625, 'VmRSS': 3621.66015625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011289119720458984
global_2_local 9.870529174804688e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00010371208190917969
before graph partition 
		117, 74, 121, 103, 73, 83, 108, 72, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021076202392578125
	Initialize BitList time :  1.3113021850585938e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 117, 74

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.453416149068323,  0.9192546583850931
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.453416149068323,  0.9192546583850931
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.453416149068323,  0.9192546583850931
	walk terminate 1 spend time 4.2113800048828125
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 121, 103, 73, 83, 108, 72, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005183219909667969
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 117, 121

	before terminate 1 the average redundancy rate is:  1.4782608695652173
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.453416149068323,  1.5031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.453416149068323,  1.5031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.453416149068323,  1.5031055900621118
	walk terminate 1 spend time 4.201359987258911
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		74, 117, 121, 103, 73, 83, 108, 72, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0006587505340576172
	Initialize BitList time :  3.933906555175781e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 121, 103

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.5031055900621118,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.5031055900621118,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.5031055900621118,  1.279503105590062
	walk terminate 1 spend time 4.116478681564331
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 103, 121, 73, 83, 108, 72, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004863739013671875
	Initialize BitList time :  3.8623809814453125e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 121, 73

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3664596273291925,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3664596273291925,  1.0434782608695652
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.15527950310559,  1.2546583850931676
	walk terminate 1 spend time 4.126541376113892
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.15527950310559,  1.2546583850931676
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.031055900621118,  1.3788819875776397
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.031055900621118,  1.3788819875776397
	walk terminate 1 spend time 4.460720062255859
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		74, 117, 103, 83, 111, 83, 108, 72, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 11, 25, 18, 18, 14, 


	preparing two sides time :  0.0017349720001220703
	Initialize BitList time :  4.887580871582031e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 111, 83

	before terminate 1 the average redundancy rate is:  1.2049689440993787
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3788819875776397,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3788819875776397,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.3788819875776397,  1.031055900621118
	walk terminate 1 spend time 4.173189163208008
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 103, 83, 83, 111, 108, 72, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 11, 18, 25, 18, 14, 


	preparing two sides time :  0.0008363723754882812
	Initialize BitList time :  5.0067901611328125e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 111, 108

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
	walk terminate 1 spend time 4.100064039230347
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.093167701863354,  1.6024844720496894
	walk terminate 1 spend time 4.081000089645386
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		74, 117, 103, 83, 83, 88, 129, 72, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 11, 18, 21, 22, 14, 


	preparing two sides time :  0.0004985332489013672
	Initialize BitList time :  3.7670135498046875e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 129, 72

	before terminate 1 the average redundancy rate is:  1.2484472049689441
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6024844720496894,  0.8944099378881988
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6024844720496894,  0.8944099378881988
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6024844720496894,  0.8944099378881988
	walk terminate 1 spend time 4.213355541229248
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		74, 117, 103, 83, 83, 88, 72, 129, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.71102237701416
partition_len_list
[74, 117, 103, 83, 83, 88, 72, 129]
random_init_graph_partition selection method range initialization spend 37.71155500411987
time for parepare:  0.000118255615234375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0008547306060791016
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.01161336898803711
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  6.318092346191406e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  7.271766662597656e-05
----------------------check_connections_block total spend ----------------------------- 0.014861822128295898
generate_one_block  0.015901565551757812
generate_one_block  0.0013403892517089844
generate_one_block  0.0010287761688232422
generate_one_block  0.0010411739349365234
generate_one_block  0.001020193099975586
generate_one_block  0.0010101795196533203
generate_one_block  0.0010428428649902344
generate_one_block  0.0010271072387695312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022640228271484375
gen group dst list time:  0.00011086463928222656
time for parepare:  0.0006811618804931641
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00040078163146972656
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0003063678741455078
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002791881561279297
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00021195411682128906
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00024390220642089844
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002765655517578125
----------------------check_connections_block total spend ----------------------------- 0.005257368087768555
generate_one_block  0.0012407302856445312
generate_one_block  0.0013225078582763672
generate_one_block  0.0014028549194335938
generate_one_block  0.0012335777282714844
generate_one_block  0.0075054168701171875
generate_one_block  0.0013370513916015625
generate_one_block  0.0012056827545166016
generate_one_block  0.0013301372528076172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006816387176513672
gen group dst list time:  9.894371032714844e-05
time for parepare:  0.0005202293395996094
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.00022864341735839844
r_  generation:  0.0006222724914550781
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  0.0002579689025878906
r_  generation:  0.0009038448333740234
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0008184909820556641
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006723403930664062
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0007288455963134766
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0007421970367431641
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005600452423095703
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0009169578552246094
----------------------check_connections_block total spend ----------------------------- 0.011235713958740234
generate_one_block  0.0017664432525634766
generate_one_block  0.003963470458984375
generate_one_block  0.0019142627716064453
generate_one_block  0.0018165111541748047
generate_one_block  0.0018341541290283203
generate_one_block  0.0018239021301269531
generate_one_block  0.001621246337890625
generate_one_block  0.002015829086303711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20822.4453125, 'VmSize': 20658.5625, 'VmHWM': 3622.8125, 'VmRSS': 3622.8125}
connection checking time:  0.01649308204650879
block generation total time  0.033333778381347656
average batch blocks generation time:  0.004166722297668457
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.0056324005126953125  GigaBytes
Max Memory Allocated: 0.0056324005126953125  GigaBytes

{'VmPeak': 21005.93359375, 'VmSize': 20977.83984375, 'VmHWM': 3911.2578125, 'VmRSS': 3911.2578125}
torch.Size([916, 1433])
torch.Size([340, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005998134613037109  GigaBytes
Max Memory Allocated: 0.00611114501953125  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21748.86328125, 'VmHWM': 4604.50390625, 'VmRSS': 4604.50390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007906436920166016  GigaBytes
Max Memory Allocated: 0.012768268585205078  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4612.23046875, 'VmRSS': 4612.23046875}
torch.Size([1205, 1433])
torch.Size([495, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00844717025756836  GigaBytes
Max Memory Allocated: 0.012768268585205078  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4612.23046875, 'VmRSS': 4612.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007363319396972656  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4613.30078125, 'VmRSS': 4613.30078125}
torch.Size([1104, 1433])
torch.Size([456, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007854938507080078  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4613.30078125, 'VmRSS': 4613.30078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006800174713134766  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4613.75, 'VmRSS': 4613.75}
torch.Size([999, 1433])
torch.Size([356, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007190704345703125  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4613.75, 'VmRSS': 4613.75}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007447719573974609  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4614.0625, 'VmRSS': 4614.0625}
torch.Size([1120, 1433])
torch.Size([403, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007878303527832031  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4614.0625, 'VmRSS': 4614.0625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007121086120605469  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4614.09375, 'VmRSS': 4614.09375}
torch.Size([1059, 1433])
torch.Size([407, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007558345794677734  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4614.09375, 'VmRSS': 4614.09375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00597381591796875  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4614.09375, 'VmRSS': 4614.09375}
torch.Size([845, 1433])
torch.Size([310, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006310939788818359  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21755.57421875, 'VmHWM': 4614.09375, 'VmRSS': 4614.09375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008413314819335938  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21756.09375, 'VmHWM': 4614.5390625, 'VmRSS': 4614.5390625}
torch.Size([1300, 1433])
torch.Size([507, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008977890014648438  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21756.09375, 'VmHWM': 4614.5390625, 'VmRSS': 4614.5390625}
{'VmPeak': 21770.38671875, 'VmSize': 21756.09375, 'VmHWM': 4614.8515625, 'VmRSS': 4614.8515625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012959420680999756 |0.04568803310394287 |0.10038900375366211 |0.0001347959041595459 |0.0031261146068573 |0.002282857894897461 |
----------------------------------------------------------pseudo_mini_loss sum 3.3764100074768066
{'VmPeak': 21770.38671875, 'VmSize': 21756.09375, 'VmHWM': 4614.8515625, 'VmRSS': 4614.8515625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12571
Number of first layer input nodes during this epoch:  8548
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009922027587890625  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21770.38671875, 'VmSize': 21756.09375, 'VmHWM': 4614.8515625, 'VmRSS': 4614.8515625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004458427429199219
global_2_local 7.128715515136719e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.152557373046875e-05
before graph partition 
		77, 86, 107, 103, 79, 116, 80, 99, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020003318786621094
	Initialize BitList time :  1.239776611328125e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 77, 86

	before terminate 1 the average redundancy rate is:  1.0124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0124223602484472,  0.9565217391304348,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0124223602484472,  0.9565217391304348,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0124223602484472,  0.9565217391304348,  1.0683229813664596
	walk terminate 1 spend time 4.891875982284546
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		77, 86, 107, 103, 79, 116, 80, 99, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004975795745849609
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 86, 107

	before terminate 1 the average redundancy rate is:  1.1987577639751552
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0683229813664596,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0683229813664596,  1.329192546583851
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0683229813664596,  1.329192546583851
	walk terminate 1 spend time 5.199327230453491
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		77, 86, 107, 103, 79, 116, 80, 99, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00040721893310546875
	Initialize BitList time :  3.24249267578125e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 107, 103

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.329192546583851,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.329192546583851,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.329192546583851,  1.279503105590062
	walk terminate 1 spend time 5.034585475921631
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 107, 79, 116, 80, 99, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046324729919433594
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 107, 79

	before terminate 1 the average redundancy rate is:  1.15527950310559
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.329192546583851,  0.9813664596273292
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.329192546583851,  0.9813664596273292
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.329192546583851,  0.9813664596273292
	walk terminate 1 spend time 4.946715593338013
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 79, 107, 116, 80, 99, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0010263919830322266
	Initialize BitList time :  5.9604644775390625e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 107, 116

	before terminate 1 the average redundancy rate is:  1.3850931677018634
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.329192546583851,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.329192546583851,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.329192546583851,  1.4409937888198758
	walk terminate 1 spend time 5.212379455566406
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		77, 86, 103, 79, 107, 116, 80, 99, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047206878662109375
	Initialize BitList time :  4.553794860839844e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 116, 80

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.4409937888198758,  0.9937888198757764
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.4409937888198758,  0.9937888198757764
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.4409937888198758,  0.9937888198757764
	walk terminate 1 spend time 5.112711668014526
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 79, 107, 80, 116, 99, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003724098205566406
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 99

	before terminate 1 the average redundancy rate is:  1.3354037267080745
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.4409937888198758,  1.2298136645962734
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.4409937888198758,  1.2298136645962734
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3354037267080745,  1.4409937888198758,  1.2298136645962734
	walk terminate 1 spend time 5.02077841758728
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		77, 86, 103, 79, 107, 80, 99, 116, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 35.444416999816895
partition_len_list
[77, 86, 103, 79, 107, 80, 99, 116]
random_init_graph_partition selection method range initialization spend 35.4451584815979
time for parepare:  0.00016641616821289062
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.00037479400634765625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  6.651878356933594e-05
----------------------check_connections_block total spend ----------------------------- 0.004408121109008789
generate_one_block  0.01809406280517578
generate_one_block  0.0011336803436279297
generate_one_block  0.0014014244079589844
generate_one_block  0.001041412353515625
generate_one_block  0.001074075698852539
generate_one_block  0.0010235309600830078
generate_one_block  0.0010111331939697266
generate_one_block  0.0010378360748291016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001828908920288086
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.0004355907440185547
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0007996559143066406
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.00022864341735839844
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001652240753173828
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0002377033233642578
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00021648406982421875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.00026488304138183594
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00023937225341796875
----------------------check_connections_block total spend ----------------------------- 0.005098819732666016
generate_one_block  0.0017495155334472656
generate_one_block  0.001252889633178711
generate_one_block  0.0012447834014892578
generate_one_block  0.0012145042419433594
generate_one_block  0.005997180938720703
generate_one_block  0.0012314319610595703
generate_one_block  0.001363515853881836
generate_one_block  0.0012829303741455078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007112026214599609
gen group dst list time:  9.751319885253906e-05
time for parepare:  0.0006699562072753906
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  0.0002753734588623047
r_  generation:  0.0006940364837646484
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0006680488586425781
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006284713745117188
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005133152008056641
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0006165504455566406
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0007679462432861328
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0008511543273925781
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0007004737854003906
----------------------check_connections_block total spend ----------------------------- 0.010419845581054688
generate_one_block  0.0018320083618164062
generate_one_block  0.001806497573852539
generate_one_block  0.0017161369323730469
generate_one_block  0.0016036033630371094
generate_one_block  0.0016973018646240234
generate_one_block  0.0019240379333496094
generate_one_block  0.0019104480743408203
generate_one_block  0.0017597675323486328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009922027587890625  GigaBytes
Max Memory Allocated: 0.013772010803222656  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21820.359375, 'VmHWM': 4615.3203125, 'VmRSS': 4615.3203125}
connection checking time:  0.015518665313720703
block generation total time  0.0295865535736084
average batch blocks generation time:  0.00369831919670105
block dataloader generation time/epoch 35.534568071365356
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008207321166992188  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21822.953125, 'VmHWM': 4617.45703125, 'VmRSS': 4617.45703125}
torch.Size([993, 1433])
torch.Size([396, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008623123168945312  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21822.953125, 'VmHWM': 4617.45703125, 'VmRSS': 4617.45703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00852823257446289  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.19921875, 'VmRSS': 4618.19921875}
torch.Size([1053, 1433])
torch.Size([394, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008951187133789062  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.203125, 'VmRSS': 4618.203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007769107818603516  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.4453125, 'VmRSS': 4618.4453125}
torch.Size([911, 1433])
torch.Size([351, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008175373077392578  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.4453125, 'VmRSS': 4618.4453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.0067768096923828125  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.56640625, 'VmRSS': 4618.56640625}
torch.Size([726, 1433])
torch.Size([291, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007107734680175781  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.56640625, 'VmRSS': 4618.56640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007342338562011719  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.56640625, 'VmRSS': 4618.56640625}
torch.Size([831, 1433])
torch.Size([355, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007756233215332031  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.27734375, 'VmHWM': 4618.56640625, 'VmRSS': 4618.56640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009240150451660156  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21824.0078125, 'VmHWM': 4619.06640625, 'VmRSS': 4619.06640625}
torch.Size([1186, 1433])
torch.Size([473, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009720802307128906  GigaBytes
Max Memory Allocated: 0.015125751495361328  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21824.0078125, 'VmHWM': 4619.06640625, 'VmRSS': 4619.06640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009280681610107422  GigaBytes
Max Memory Allocated: 0.015585899353027344  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21824.0078125, 'VmHWM': 4619.06640625, 'VmRSS': 4619.06640625}
torch.Size([1193, 1433])
torch.Size([497, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009803295135498047  GigaBytes
Max Memory Allocated: 0.015585899353027344  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21824.0078125, 'VmHWM': 4619.06640625, 'VmRSS': 4619.06640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008577346801757812  GigaBytes
Max Memory Allocated: 0.015585899353027344  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.9921875, 'VmHWM': 4619.06640625, 'VmRSS': 4619.0625}
torch.Size([1062, 1433])
torch.Size([427, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009057998657226562  GigaBytes
Max Memory Allocated: 0.015585899353027344  GigaBytes

{'VmPeak': 21884.109375, 'VmSize': 21823.9921875, 'VmHWM': 4619.06640625, 'VmRSS': 4619.0625}
{'VmPeak': 21884.109375, 'VmSize': 21823.9921875, 'VmHWM': 4619.0703125, 'VmRSS': 4619.0703125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010788917541503906 |0.0006398260593414307 |0.005039572715759277 |0.00020131468772888184 |0.002751678228378296 |0.0017671585083007812 |
----------------------------------------------------------pseudo_mini_loss sum 2.1780145168304443
{'VmPeak': 21884.109375, 'VmSize': 21823.9921875, 'VmHWM': 4619.0703125, 'VmRSS': 4619.0703125}
Total (block generation + training)time/epoch 35.707101583480835
Training time/epoch 0.17232155799865723
Training time without block to device /epoch 0.16720294952392578
Training time without total dataloading part /epoch 0.06570768356323242
load block tensor time/epoch 0.08631134033203125
block to device time/epoch 0.005118608474731445
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11886
Number of first layer input nodes during this epoch:  7955
