main start at this time 1648597016.2085774
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20817.45703125, 'VmSize': 20801.59765625, 'VmHWM': 3611.55859375, 'VmRSS': 3611.55859375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012683868408203125
global_2_local 7.224082946777344e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.202957153320312e-05
before graph partition 
		355, 341, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002605915069580078
	Initialize BitList time :  1.811981201171875e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 355, 341

	before terminate 1 the average redundancy rate is:  1.0807453416149069
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.1024844720496894,  1.0590062111801242
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.1024844720496894,  1.0590062111801242
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.1024844720496894,  1.0590062111801242
	walk terminate 1 spend time 4.042904853820801
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		341, 355, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.046609163284302
partition_len_list
[341, 355]
random_init_graph_partition selection method range initialization spend 4.047024488449097
time for parepare:  0.0001533031463623047
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0010020732879638672
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.013473272323608398
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.00022983551025390625
----------------------check_connections_block total spend ----------------------------- 0.016104459762573242
generate_one_block  0.014914512634277344
generate_one_block  0.0013394355773925781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009520053863525391
gen group dst list time:  3.3855438232421875e-05
time for parepare:  0.00039577484130859375
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.000354766845703125
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.0007181167602539062
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0007376670837402344
----------------------check_connections_block total spend ----------------------------- 0.003272533416748047
generate_one_block  0.003130197525024414
generate_one_block  0.0022232532501220703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006198883056640625
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.0002777576446533203
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.00044798851013183594
r_  generation:  0.0019850730895996094
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.0003178119659423828
r_  generation:  0.0018069744110107422
----------------------check_connections_block total spend ----------------------------- 0.00714564323425293
generate_one_block  0.008875846862792969
generate_one_block  0.0029900074005126953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20817.45703125, 'VmSize': 20656.64453125, 'VmHWM': 3619.48046875, 'VmRSS': 3619.48046875}
connection checking time:  0.010418176651000977
block generation total time  0.01721930503845215
average batch blocks generation time:  0.008609652519226074
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.010783195495605469  GigaBytes
Max Memory Allocated: 0.010783195495605469  GigaBytes

{'VmPeak': 20945.30078125, 'VmSize': 20945.30078125, 'VmHWM': 3910.04296875, 'VmRSS': 3910.04296875}
torch.Size([1974, 1433])
torch.Size([1219, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2322998046875 GB
    Memory Allocated: 0.011191844940185547  GigaBytes
Max Memory Allocated: 0.011204719543457031  GigaBytes

{'VmPeak': 21716.53515625, 'VmSize': 21716.51953125, 'VmHWM': 4603.8203125, 'VmRSS': 4603.8203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010594844818115234  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21790.96484375, 'VmSize': 21758.96875, 'VmHWM': 4614.22265625, 'VmRSS': 4614.22265625}
torch.Size([1906, 1433])
torch.Size([1098, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010976791381835938  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21790.96484375, 'VmSize': 21758.96875, 'VmHWM': 4614.22265625, 'VmRSS': 4614.22265625}
{'VmPeak': 21790.96484375, 'VmSize': 21758.96875, 'VmHWM': 4614.72265625, 'VmRSS': 4614.72265625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010196089744567871 |0.17738556861877441 |0.40498554706573486 |0.0004076957702636719 |0.0045958757400512695 |0.0028128623962402344 |
----------------------------------------------------------pseudo_mini_loss sum 3.2231621742248535
{'VmPeak': 21790.96484375, 'VmSize': 21758.96875, 'VmHWM': 4614.72265625, 'VmRSS': 4614.72265625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6893
Number of first layer input nodes during this epoch:  3880
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011086463928222656  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21790.96484375, 'VmSize': 21758.96875, 'VmHWM': 4614.72265625, 'VmRSS': 4614.72265625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005548000335693359
global_2_local 9.107589721679688e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.963180541992188e-05
before graph partition 
		356, 337, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.00033402442932128906
	Initialize BitList time :  2.2172927856445312e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 356, 337

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0776397515527951,  1.0714285714285714
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.093167701863354,  1.0559006211180124
						 current side  0
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906831,  1.0745341614906831,  1.0745341614906831
	walk terminate 1 spend time 4.989322185516357
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0559006211180124,  1.0900621118012421
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0838509316770186,  1.065217391304348
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0559006211180124,  1.0900621118012421
	walk terminate 1 spend time 5.12553071975708
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		340, 351, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 10.118708848953247
partition_len_list
[340, 351]
random_init_graph_partition selection method range initialization spend 10.119192123413086
time for parepare:  0.0001595020294189453
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0010159015655517578
mini_batch_src_global generation:  0.0002243518829345703
r_  generation:  0.0006330013275146484
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.0003483295440673828
----------------------check_connections_block total spend ----------------------------- 0.0037283897399902344
generate_one_block  0.027088642120361328
generate_one_block  0.0015952587127685547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012769699096679688
gen group dst list time:  9.107589721679688e-05
time for parepare:  0.00044417381286621094
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.000438690185546875
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.0007126331329345703
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.0002884864807128906
r_  generation:  0.0008101463317871094
----------------------check_connections_block total spend ----------------------------- 0.003779888153076172
generate_one_block  0.0036230087280273438
generate_one_block  0.0032019615173339844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006728172302246094
gen group dst list time:  6.0558319091796875e-05
time for parepare:  0.00018358230590820312
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0006411075592041016
mini_batch_src_global generation:  0.0004544258117675781
r_  generation:  0.0017998218536376953
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.0004329681396484375
r_  generation:  0.002015352249145508
----------------------check_connections_block total spend ----------------------------- 0.007305145263671875
generate_one_block  0.009148597717285156
generate_one_block  0.003179311752319336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011086463928222656  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21886.984375, 'VmSize': 21822.984375, 'VmHWM': 4616.46484375, 'VmRSS': 4616.46484375}
connection checking time:  0.011085033416748047
block generation total time  0.01915287971496582
average batch blocks generation time:  0.00957643985748291
block dataloader generation time/epoch 10.194233417510986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010597705841064453  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21886.984375, 'VmSize': 21826.94921875, 'VmHWM': 4620.80078125, 'VmRSS': 4620.80078125}
torch.Size([1841, 1433])
torch.Size([1060, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010965824127197266  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21886.984375, 'VmSize': 21826.94921875, 'VmHWM': 4620.80078125, 'VmRSS': 4620.80078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011256694793701172  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21886.984375, 'VmSize': 21827.61328125, 'VmHWM': 4621.71875, 'VmRSS': 4621.71875}
torch.Size([1963, 1433])
torch.Size([1206, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011662960052490234  GigaBytes
Max Memory Allocated: 0.02107381820678711  GigaBytes

{'VmPeak': 21886.984375, 'VmSize': 21827.61328125, 'VmHWM': 4621.71875, 'VmRSS': 4621.71875}
{'VmPeak': 21886.984375, 'VmSize': 21827.61328125, 'VmHWM': 4621.71875, 'VmRSS': 4621.71875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021267414093017578 |0.0008633136749267578 |0.007067084312438965 |0.0003389120101928711 |0.004278302192687988 |0.002729177474975586 |
----------------------------------------------------------pseudo_mini_loss sum 2.3774683475494385
{'VmPeak': 21886.984375, 'VmSize': 21827.61328125, 'VmHWM': 4621.71875, 'VmRSS': 4621.71875}
Total (block generation + training)time/epoch 10.26934266090393
Training time/epoch 0.07474136352539062
Training time without block to device /epoch 0.07301473617553711
Training time without total dataloading part /epoch 0.026097774505615234
load block tensor time/epoch 0.042534828186035156
block to device time/epoch 0.0017266273498535156
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6761
Number of first layer input nodes during this epoch:  3804
