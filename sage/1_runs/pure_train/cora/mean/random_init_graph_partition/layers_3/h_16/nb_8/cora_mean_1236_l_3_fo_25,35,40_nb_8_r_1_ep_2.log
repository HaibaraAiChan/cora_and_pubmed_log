main start at this time 1648595904.382861
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20822.2109375, 'VmSize': 20808.9375, 'VmHWM': 3620.59375, 'VmRSS': 3620.59375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011060237884521484
global_2_local 7.605552673339844e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00021791458129882812
before graph partition 
		79, 92, 98, 132, 83, 73, 127, 77, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021266937255859375
	Initialize BitList time :  1.4543533325195312e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 79, 92

	before terminate 1 the average redundancy rate is:  1.062111801242236
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
	walk terminate 1 spend time 4.0206897258758545
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 92, 98, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003237724304199219
	Initialize BitList time :  2.6226043701171875e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 92, 98

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 3.9916443824768066
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.059903621673584
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		79, 86, 103, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 15, 21, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004878044128417969
	Initialize BitList time :  3.8623809814453125e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 103, 132

	before terminate 1 the average redundancy rate is:  1.4596273291925466
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894235
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.453416149068323,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.1677018633540373,  1.6770186335403727
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.279503105590062,  1.565217391304348
	walk terminate 1 spend time 4.211043357849121
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.515527950310559,  1.3167701863354038
						 current side  0
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.3043478260869565,  1.4906832298136645
						 current side  1
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.5031055900621118,  1.2919254658385093
	walk terminate 1 spend time 4.288775205612183
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		79, 86, 104, 121, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 15, 16, 23, 18, 18, 18, 14, 


	preparing two sides time :  0.0005729198455810547
	Initialize BitList time :  4.172325134277344e-05
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 121, 83

	before terminate 1 the average redundancy rate is:  1.2670807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
	walk terminate 1 spend time 4.099691152572632
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 121, 73, 127, 77, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 15, 16, 18, 23, 18, 18, 14, 


	preparing two sides time :  0.0007047653198242188
	Initialize BitList time :  3.886222839355469e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 121, 73

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
	walk terminate 1 spend time 4.316190719604492
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.0004975795745849609
	Initialize BitList time :  3.910064697265625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 121, 127

	before terminate 1 the average redundancy rate is:  1.5403726708074534
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
	walk terminate 1 spend time 4.319116830825806
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.0005543231964111328
	Initialize BitList time :  3.981590270996094e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 127, 77

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
	walk terminate 1 spend time 4.191267490386963
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 77, 127, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.52508854866028
partition_len_list
[79, 86, 104, 83, 73, 121, 77, 127]
random_init_graph_partition selection method range initialization spend 37.52586245536804
time for parepare:  0.00048422813415527344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0009191036224365234
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.016686677932739258
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.00011587142944335938
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.000133514404296875
----------------------check_connections_block total spend ----------------------------- 0.021374940872192383
generate_one_block  0.020496606826782227
generate_one_block  0.0014171600341796875
generate_one_block  0.001092672348022461
generate_one_block  0.0011413097381591797
generate_one_block  0.0010700225830078125
generate_one_block  0.0010986328125
generate_one_block  0.0011057853698730469
generate_one_block  0.001127481460571289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001689910888671875
gen group dst list time:  0.00020456314086914062
time for parepare:  0.0014758110046386719
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.00031566619873046875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0002396106719970703
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00019860267639160156
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001983642578125
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00019550323486328125
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0003466606140136719
----------------------check_connections_block total spend ----------------------------- 0.0059223175048828125
generate_one_block  0.0018477439880371094
generate_one_block  0.0012516975402832031
generate_one_block  0.0012705326080322266
generate_one_block  0.001440286636352539
generate_one_block  0.0014750957489013672
generate_one_block  0.0019273757934570312
generate_one_block  0.001332998275756836
generate_one_block  0.002082347869873047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0035865306854248047
gen group dst list time:  0.00010347366333007812
time for parepare:  0.0010406970977783203
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0009403228759765625
mini_batch_src_global generation:  0.0007753372192382812
r_  generation:  0.0007174015045166016
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.0002574920654296875
r_  generation:  0.0005924701690673828
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0006721019744873047
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.000644683837890625
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  0.0002715587615966797
r_  generation:  0.0007357597351074219
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.0003674030303955078
r_  generation:  0.0008714199066162109
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0006322860717773438
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011093616485595703
----------------------check_connections_block total spend ----------------------------- 0.015183687210083008
generate_one_block  0.009081840515136719
generate_one_block  0.0022056102752685547
generate_one_block  0.00170135498046875
generate_one_block  0.0017728805541992188
generate_one_block  0.0017254352569580078
generate_one_block  0.0019440650939941406
generate_one_block  0.0015747547149658203
generate_one_block  0.002211332321166992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20822.2109375, 'VmSize': 20656.78515625, 'VmHWM': 3621.40625, 'VmRSS': 3621.40625}
connection checking time:  0.02110600471496582
block generation total time  0.03484535217285156
average batch blocks generation time:  0.004355669021606445
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005497455596923828  GigaBytes
Max Memory Allocated: 0.005497455596923828  GigaBytes

{'VmPeak': 21006.36328125, 'VmSize': 20977.828125, 'VmHWM': 3911.0234375, 'VmRSS': 3911.0234375}
torch.Size([992, 1433])
torch.Size([380, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005621910095214844  GigaBytes
Max Memory Allocated: 0.005644321441650391  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21752.8359375, 'VmHWM': 4608.2578125, 'VmRSS': 4608.2578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004813194274902344  GigaBytes
Max Memory Allocated: 0.010090351104736328  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21757.37890625, 'VmHWM': 4613.85546875, 'VmRSS': 4613.85546875}
torch.Size([831, 1433])
torch.Size([300, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00492095947265625  GigaBytes
Max Memory Allocated: 0.010090351104736328  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21757.37890625, 'VmHWM': 4613.85546875, 'VmRSS': 4613.85546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0056743621826171875  GigaBytes
Max Memory Allocated: 0.010090351104736328  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21758.09375, 'VmHWM': 4615.12890625, 'VmRSS': 4615.12890625}
torch.Size([962, 1433])
torch.Size([344, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005795955657958984  GigaBytes
Max Memory Allocated: 0.010090351104736328  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21758.09375, 'VmHWM': 4615.12890625, 'VmRSS': 4615.12890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005229473114013672  GigaBytes
Max Memory Allocated: 0.010506629943847656  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21758.09375, 'VmHWM': 4615.79296875, 'VmRSS': 4615.79296875}
torch.Size([909, 1433])
torch.Size([342, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005344867706298828  GigaBytes
Max Memory Allocated: 0.010506629943847656  GigaBytes

{'VmPeak': 21758.51953125, 'VmSize': 21758.09375, 'VmHWM': 4615.79296875, 'VmRSS': 4615.79296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006138801574707031  GigaBytes
Max Memory Allocated: 0.0109710693359375  GigaBytes

{'VmPeak': 21758.734375, 'VmSize': 21758.734375, 'VmHWM': 4616.91015625, 'VmRSS': 4616.91015625}
torch.Size([1079, 1433])
torch.Size([384, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006262302398681641  GigaBytes
Max Memory Allocated: 0.0109710693359375  GigaBytes

{'VmPeak': 21758.734375, 'VmSize': 21758.734375, 'VmHWM': 4616.91015625, 'VmRSS': 4616.91015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006741523742675781  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21759.34765625, 'VmSize': 21759.34765625, 'VmHWM': 4617.58203125, 'VmRSS': 4617.58203125}
torch.Size([1191, 1433])
torch.Size([481, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006903648376464844  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21759.34765625, 'VmSize': 21759.34765625, 'VmHWM': 4617.58203125, 'VmRSS': 4617.58203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005175590515136719  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21759.34765625, 'VmSize': 21759.34765625, 'VmHWM': 4617.63671875, 'VmRSS': 4617.63671875}
torch.Size([899, 1433])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005286216735839844  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21759.34765625, 'VmSize': 21759.34765625, 'VmHWM': 4617.63671875, 'VmRSS': 4617.63671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007706642150878906  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21760.32421875, 'VmSize': 21760.32421875, 'VmHWM': 4618.54296875, 'VmRSS': 4618.54296875}
torch.Size([1370, 1433])
torch.Size([634, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007907390594482422  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21760.32421875, 'VmSize': 21760.32421875, 'VmHWM': 4618.54296875, 'VmRSS': 4618.54296875}
{'VmPeak': 21760.32421875, 'VmSize': 21760.32421875, 'VmHWM': 4618.7421875, 'VmRSS': 4618.7421875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008664637804031372 |0.04643416404724121 |0.10306370258331299 |0.00016108155250549316 |0.0025274455547332764 |0.002590179443359375 |
----------------------------------------------------------pseudo_mini_loss sum 3.564021110534668
{'VmPeak': 21760.32421875, 'VmSize': 21760.32421875, 'VmHWM': 4619.1171875, 'VmRSS': 4619.1171875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12183
Number of first layer input nodes during this epoch:  8233
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008141040802001953  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21760.32421875, 'VmSize': 21760.32421875, 'VmHWM': 4619.1171875, 'VmRSS': 4619.1171875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048542022705078125
global_2_local 7.200241088867188e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.43865966796875e-05
before graph partition 
		99, 126, 76, 94, 84, 98, 119, 57, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020766258239746094
	Initialize BitList time :  1.239776611328125e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 99, 126

	before terminate 1 the average redundancy rate is:  1.3975155279503106
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
	walk terminate 1 spend time 5.297321319580078
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		99, 126, 76, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005724430084228516
	Initialize BitList time :  3.695487976074219e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 126, 76

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
	walk terminate 1 spend time 5.322960138320923
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 126, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005795955657958984
	Initialize BitList time :  4.315376281738281e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 126, 94

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
	walk terminate 1 spend time 5.371058225631714
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 126, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004646778106689453
	Initialize BitList time :  3.814697265625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 84

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
	walk terminate 1 spend time 5.406955003738403
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 126, 98, 119, 57, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004734992980957031
	Initialize BitList time :  3.695487976074219e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 126, 98

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
	walk terminate 1 spend time 5.394987106323242
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 126, 119, 57, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004999637603759766
	Initialize BitList time :  7.414817810058594e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 119

	before terminate 1 the average redundancy rate is:  1.5217391304347827
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.565217391304348,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
	walk terminate 1 spend time 5.439288854598999
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.1180124223602483,  1.9130434782608696
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 14
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.937888198757764,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.763975155279503,  1.204968944099379
	walk terminate 1 spend time 5.406918525695801
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		99, 76, 94, 84, 98, 97, 142, 57, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 8, 28, 14, 


	preparing two sides time :  0.0008554458618164062
	Initialize BitList time :  4.76837158203125e-05
	getRedundancyCost: time   5.7220458984375e-06

					length of partitions 142, 57

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.68944099378882,  0.782608695652174
	walk terminate 1 spend time 5.388530731201172
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 97, 63, 136, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 43.05647683143616
partition_len_list
[99, 76, 94, 84, 98, 97, 63, 136]
random_init_graph_partition selection method range initialization spend 43.057257652282715
time for parepare:  0.00018215179443359375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0018093585968017578
mini_batch_src_global generation:  0.0007998943328857422
r_  generation:  0.0006802082061767578
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  8.296966552734375e-05
----------------------check_connections_block total spend ----------------------------- 0.007985591888427734
generate_one_block  0.02643609046936035
generate_one_block  0.0011622905731201172
generate_one_block  0.0012476444244384766
generate_one_block  0.001068115234375
generate_one_block  0.0011591911315917969
generate_one_block  0.0011086463928222656
generate_one_block  0.0011212825775146484
generate_one_block  0.0011365413665771484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002866506576538086
gen group dst list time:  0.0001347064971923828
time for parepare:  0.0004961490631103516
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00047898292541503906
mini_batch_src_global generation:  0.00012755393981933594
r_  generation:  0.0003514289855957031
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.00022602081298828125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00024771690368652344
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00027441978454589844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0002677440643310547
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00016021728515625
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00036644935607910156
----------------------check_connections_block total spend ----------------------------- 0.0060880184173583984
generate_one_block  0.002279043197631836
generate_one_block  0.0015492439270019531
generate_one_block  0.001535654067993164
generate_one_block  0.0015881061553955078
generate_one_block  0.0015215873718261719
generate_one_block  0.0013570785522460938
generate_one_block  0.0012903213500976562
generate_one_block  0.0016071796417236328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018002986907958984
gen group dst list time:  0.0001323223114013672
time for parepare:  0.001140594482421875
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0005497932434082031
mini_batch_src_global generation:  0.0008549690246582031
r_  generation:  0.0010564327239990234
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.0003914833068847656
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0006742477416992188
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0007276535034179688
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0007219314575195312
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  0.00016689300537109375
r_  generation:  0.0009558200836181641
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.000873565673828125
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0005571842193603516
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0009965896606445312
----------------------check_connections_block total spend ----------------------------- 0.014847278594970703
generate_one_block  0.002599000930786133
generate_one_block  0.002492189407348633
generate_one_block  0.0018451213836669922
generate_one_block  0.0018362998962402344
generate_one_block  0.0020639896392822266
generate_one_block  0.002005338668823242
generate_one_block  0.0015463829040527344
generate_one_block  0.002402067184448242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008141040802001953  GigaBytes
Max Memory Allocated: 0.012476444244384766  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4619.9609375, 'VmRSS': 4619.9609375}
connection checking time:  0.0209352970123291
block generation total time  0.029518604278564453
average batch blocks generation time:  0.0036898255348205566
block dataloader generation time/epoch 43.169053077697754
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007063388824462891  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.05078125, 'VmRSS': 4620.05078125}
torch.Size([1185, 1433])
torch.Size([524, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007229328155517578  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.05078125, 'VmRSS': 4620.05078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005336761474609375  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
torch.Size([863, 1433])
torch.Size([324, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0054473876953125  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005658149719238281  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
torch.Size([923, 1433])
torch.Size([342, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005776405334472656  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00568389892578125  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
torch.Size([928, 1433])
torch.Size([333, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005797863006591797  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006838321685791016  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.58984375, 'VmHWM': 4620.19140625, 'VmRSS': 4620.19140625}
torch.Size([1143, 1433])
torch.Size([465, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0069904327392578125  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006174564361572266  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
torch.Size([1019, 1433])
torch.Size([380, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006306648254394531  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004830360412597656  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
torch.Size([769, 1433])
torch.Size([278, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004922389984130859  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007837772369384766  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
torch.Size([1329, 1433])
torch.Size([598, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00803232192993164  GigaBytes
Max Memory Allocated: 0.014349937438964844  GigaBytes

{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012535035610198975 |0.0006187856197357178 |0.005715876817703247 |0.00024145841598510742 |0.0032814741134643555 |0.001996278762817383 |
----------------------------------------------------------pseudo_mini_loss sum 2.430945634841919
{'VmPeak': 21888.33984375, 'VmSize': 21824.57421875, 'VmHWM': 4620.19140625, 'VmRSS': 4620.1875}
Total (block generation + training)time/epoch 43.363914251327515
Training time/epoch 0.19432973861694336
Training time without block to device /epoch 0.18937945365905762
Training time without total dataloading part /epoch 0.07590675354003906
load block tensor time/epoch 0.1002802848815918
block to device time/epoch 0.004950284957885742
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12150
Number of first layer input nodes during this epoch:  8159
