main start at this time 1648596237.8688734
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20804.65625, 'VmSize': 20802.03515625, 'VmHWM': 3612.84765625, 'VmRSS': 3612.84765625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012459754943847656
global_2_local 7.009506225585938e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.393692016601562e-05
before graph partition 
		164, 218, 144, 211, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002148151397705078
	Initialize BitList time :  1.5020370483398438e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 164, 218

	before terminate 1 the average redundancy rate is:  1.186335403726708
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.279503105590062,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
	walk terminate 1 spend time 3.855400800704956
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.279503105590062,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.2608695652173914,  1.1055900621118013
	walk terminate 1 spend time 4.310101509094238
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		178, 203, 144, 211, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				30, 40, 35, 35, 


	preparing two sides time :  0.0007317066192626953
	Initialize BitList time :  4.5299530029296875e-05
	getRedundancyCost: time   6.4373016357421875e-06

					length of partitions 203, 144

	before terminate 1 the average redundancy rate is:  1.0776397515527951
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.077639751552795,  1.2422360248447204,  0.9130434782608695
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2670807453416149,  0.8881987577639752
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2546583850931676,  0.9006211180124224
	walk terminate 1 spend time 4.28490138053894
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.236024844720497,  0.9254658385093167
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.2546583850931676,  0.906832298136646
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2173913043478262,  0.937888198757764
	walk terminate 1 spend time 4.08930230140686
				 improvement:  False
1
side is 0
	 walk step 1  partition 
		178, 151, 196, 211, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				30, 37, 38, 35, 


	preparing two sides time :  0.0005326271057128906
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 196, 211

	before terminate 1 the average redundancy rate is:  1.263975155279503
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.360248447204969,  1.15527950310559
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.2484472049689441,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.4099378881987579,  1.0869565217391304
	walk terminate 1 spend time 4.1043479442596436
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.186335403726708,  1.3167701863354038
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.2732919254658386,  1.2298136645962734
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.1118012422360248,  1.3975155279503106
	walk terminate 1 spend time 4.093362331390381
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		178, 151, 179, 225, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 24.747751474380493
partition_len_list
[178, 151, 179, 225]
random_init_graph_partition selection method range initialization spend 24.748223304748535
time for parepare:  0.00018644332885742188
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00808858871459961
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.014967203140258789
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.000415802001953125
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0001952648162841797
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  9.274482727050781e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00016117095947265625
----------------------check_connections_block total spend ----------------------------- 0.025936603546142578
generate_one_block  0.010467767715454102
generate_one_block  0.0013206005096435547
generate_one_block  0.0011849403381347656
generate_one_block  0.0012140274047851562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001252889633178711
gen group dst list time:  4.673004150390625e-05
time for parepare:  0.0006718635559082031
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0004973411560058594
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0004730224609375
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004038810729980469
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0005700588226318359
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0005385875701904297
----------------------check_connections_block total spend ----------------------------- 0.004859209060668945
generate_one_block  0.0015811920166015625
generate_one_block  0.0014505386352539062
generate_one_block  0.0015606880187988281
generate_one_block  0.0018279552459716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006504058837890625
gen group dst list time:  7.867813110351562e-05
time for parepare:  0.0004169940948486328
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00043845176696777344
mini_batch_src_global generation:  0.0004162788391113281
r_  generation:  0.0011138916015625
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.001024007797241211
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.00125885009765625
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0014951229095458984
----------------------check_connections_block total spend ----------------------------- 0.00934743881225586
generate_one_block  0.005850076675415039
generate_one_block  0.0022580623626708984
generate_one_block  0.0025932788848876953
generate_one_block  0.002768993377685547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20807.40625, 'VmSize': 20656.30078125, 'VmHWM': 3619.94921875, 'VmRSS': 3619.94921875}
connection checking time:  0.014206647872924805
block generation total time  0.019890785217285156
average batch blocks generation time:  0.004972696304321289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.007864952087402344  GigaBytes
Max Memory Allocated: 0.007864952087402344  GigaBytes

{'VmPeak': 21016.59765625, 'VmSize': 20984.6015625, 'VmHWM': 3916.9453125, 'VmRSS': 3916.9453125}
torch.Size([1433, 1433])
torch.Size([629, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00808095932006836  GigaBytes
Max Memory Allocated: 0.00809335708618164  GigaBytes

{'VmPeak': 21758.234375, 'VmSize': 21756.015625, 'VmHWM': 4611.390625, 'VmRSS': 4611.390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007372379302978516  GigaBytes
Max Memory Allocated: 0.014991283416748047  GigaBytes

{'VmPeak': 21758.234375, 'VmSize': 21756.015625, 'VmHWM': 4613.65234375, 'VmRSS': 4613.65234375}
torch.Size([1308, 1433])
torch.Size([590, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007568836212158203  GigaBytes
Max Memory Allocated: 0.014991283416748047  GigaBytes

{'VmPeak': 21758.234375, 'VmSize': 21756.015625, 'VmHWM': 4613.65234375, 'VmRSS': 4613.65234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008614540100097656  GigaBytes
Max Memory Allocated: 0.01555776596069336  GigaBytes

{'VmPeak': 21764.50390625, 'VmSize': 21764.50390625, 'VmHWM': 4620.05859375, 'VmRSS': 4620.05859375}
torch.Size([1539, 1433])
torch.Size([707, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008850574493408203  GigaBytes
Max Memory Allocated: 0.01555776596069336  GigaBytes

{'VmPeak': 21764.50390625, 'VmSize': 21764.50390625, 'VmHWM': 4620.05859375, 'VmRSS': 4620.05859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009299755096435547  GigaBytes
Max Memory Allocated: 0.01746845245361328  GigaBytes

{'VmPeak': 21773.61328125, 'VmSize': 21773.61328125, 'VmHWM': 4628.7734375, 'VmRSS': 4628.7734375}
torch.Size([1666, 1433])
torch.Size([892, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009593486785888672  GigaBytes
Max Memory Allocated: 0.01746845245361328  GigaBytes

{'VmPeak': 21773.61328125, 'VmSize': 21773.61328125, 'VmHWM': 4628.7734375, 'VmRSS': 4628.7734375}
{'VmPeak': 21773.61328125, 'VmSize': 21773.61328125, 'VmHWM': 4629.14453125, 'VmRSS': 4629.14453125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009568870067596436 |0.09345316886901855 |0.20084601640701294 |0.00020134449005126953 |0.003747105598449707 |0.002408742904663086 |
----------------------------------------------------------pseudo_mini_loss sum 3.1216745376586914
{'VmPeak': 21773.61328125, 'VmSize': 21773.61328125, 'VmHWM': 4629.14453125, 'VmRSS': 4629.14453125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9497
Number of first layer input nodes during this epoch:  5946
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009763717651367188  GigaBytes
Max Memory Allocated: 0.01746845245361328  GigaBytes

{'VmPeak': 21773.61328125, 'VmSize': 21773.61328125, 'VmHWM': 4629.14453125, 'VmRSS': 4629.14453125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005402565002441406
global_2_local 8.487701416015625e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.678436279296875e-05
before graph partition 
		217, 165, 156, 194, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00026679039001464844
	Initialize BitList time :  1.5974044799804688e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 217, 165

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.204968944099379,  1.1614906832298137
						 current side  1
			 redundancy will reduce  0.009316770186335699
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.3478260869565217,  1.0062111801242235
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.2298136645962734,  1.1180124223602483
	walk terminate 1 spend time 4.901137351989746
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.204968944099379,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.2236024844720497,  1.124223602484472
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.1987577639751552,  1.15527950310559
	walk terminate 1 spend time 5.022308111190796
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		186, 193, 156, 194, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				41, 29, 35, 35, 


	preparing two sides time :  0.0005354881286621094
	Initialize BitList time :  4.363059997558594e-05
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 193, 156

	before terminate 1 the average redundancy rate is:  1.0838509316770186
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.1801242236024845,  0.9875776397515528
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.1925465838509317,  0.9751552795031055
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0683229813664596,  1.1055900621118013
	walk terminate 1 spend time 4.968195676803589
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		186, 172, 178, 194, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				41, 28, 36, 35, 


	preparing two sides time :  0.0003209114074707031
	Initialize BitList time :  3.337860107421875e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 178, 194

	before terminate 1 the average redundancy rate is:  1.1552795031055902
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1428571428571428,  1.1677018633540373
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.124223602484472,  1.186335403726708
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1925465838509317,  1.1180124223602483
	walk terminate 1 spend time 5.082707405090332
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.062111801242236,  1.2546583850931676
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.2422360248447204,  1.0683229813664596
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.0372670807453417,  1.2484472049689441
	walk terminate 1 spend time 4.958400726318359
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		186, 172, 167, 201, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 24.941649198532104
partition_len_list
[186, 172, 167, 201]
random_init_graph_partition selection method range initialization spend 24.942277908325195
time for parepare:  0.00020503997802734375
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.03959178924560547
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0003693103790283203
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00012969970703125
----------------------check_connections_block total spend ----------------------------- 0.043207406997680664
generate_one_block  0.014995098114013672
generate_one_block  0.001177072525024414
generate_one_block  0.0010726451873779297
generate_one_block  0.0012831687927246094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015599727630615234
gen group dst list time:  4.4345855712890625e-05
time for parepare:  0.0005979537963867188
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.0006880760192871094
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.00045371055603027344
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00038623809814453125
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005724430084228516
----------------------check_connections_block total spend ----------------------------- 0.005405426025390625
generate_one_block  0.0025222301483154297
generate_one_block  0.0015096664428710938
generate_one_block  0.001486063003540039
generate_one_block  0.0016102790832519531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014739036560058594
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.00041294097900390625
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0012583732604980469
mini_batch_src_global generation:  0.0005359649658203125
r_  generation:  0.0014033317565917969
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.00027108192443847656
r_  generation:  0.0011897087097167969
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0012977123260498047
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0013954639434814453
----------------------check_connections_block total spend ----------------------------- 0.011672735214233398
generate_one_block  0.00807332992553711
generate_one_block  0.0036292076110839844
generate_one_block  0.0023996829986572266
generate_one_block  0.0025789737701416016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009763717651367188  GigaBytes
Max Memory Allocated: 0.01746845245361328  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4631.171875, 'VmRSS': 4631.171875}
connection checking time:  0.017078161239624023
block generation total time  0.023809432983398438
average batch blocks generation time:  0.005952358245849609
block dataloader generation time/epoch 25.058825731277466
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008997440338134766  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.58984375, 'VmRSS': 4632.58984375}
torch.Size([1545, 1433])
torch.Size([720, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009236812591552734  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.58984375, 'VmRSS': 4632.58984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008365631103515625  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.66796875, 'VmRSS': 4632.66796875}
torch.Size([1427, 1433])
torch.Size([667, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008587837219238281  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.66796875, 'VmRSS': 4632.66796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008996009826660156  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.671875, 'VmRSS': 4632.671875}
torch.Size([1444, 1433])
torch.Size([665, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00921773910522461  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.671875, 'VmRSS': 4632.671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008934974670410156  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.671875, 'VmRSS': 4632.671875}
torch.Size([1533, 1433])
torch.Size([718, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009179115295410156  GigaBytes
Max Memory Allocated: 0.017852783203125  GigaBytes

{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.671875, 'VmRSS': 4632.671875}
{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.671875, 'VmRSS': 4632.671875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024759352207183838 |0.0007951855659484863 |0.006052672863006592 |0.00021439790725708008 |0.002812981605529785 |0.0019145011901855469 |
----------------------------------------------------------pseudo_mini_loss sum 2.5080103874206543
{'VmPeak': 21901.62890625, 'VmSize': 21837.62890625, 'VmHWM': 4632.671875, 'VmRSS': 4632.671875}
Total (block generation + training)time/epoch 25.207210540771484
Training time/epoch 0.14816045761108398
Training time without block to device /epoch 0.14497971534729004
Training time without total dataloading part /epoch 0.038234710693359375
load block tensor time/epoch 0.09903740882873535
block to device time/epoch 0.0031807422637939453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9445
Number of first layer input nodes during this epoch:  5949
