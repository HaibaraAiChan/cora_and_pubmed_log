main start at this time 1648597095.8091328
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20813.65625, 'VmSize': 20801.6015625, 'VmHWM': 3612.609375, 'VmRSS': 3612.609375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007886886596679688
global_2_local 7.319450378417969e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0002868175506591797
before graph partition 
		79, 92, 98, 132, 83, 73, 127, 77, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020074844360351562
	Initialize BitList time :  1.4781951904296875e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 79, 92

	before terminate 1 the average redundancy rate is:  1.062111801242236
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
	walk terminate 1 spend time 3.8739070892333984
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 92, 98, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005161762237548828
	Initialize BitList time :  3.504753112792969e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 92, 98

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.138522624969482
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.064002990722656
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		79, 86, 103, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 15, 21, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003261566162109375
	Initialize BitList time :  2.7179718017578125e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 103, 132

	before terminate 1 the average redundancy rate is:  1.4596273291925466
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894235
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.453416149068323,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.1677018633540373,  1.6770186335403727
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.279503105590062,  1.565217391304348
	walk terminate 1 spend time 4.051027297973633
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.515527950310559,  1.3167701863354038
						 current side  0
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.3043478260869565,  1.4906832298136645
						 current side  1
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.5031055900621118,  1.2919254658385093
	walk terminate 1 spend time 4.016521453857422
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		79, 86, 104, 121, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 15, 16, 23, 18, 18, 18, 14, 


	preparing two sides time :  0.00030732154846191406
	Initialize BitList time :  2.574920654296875e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 121, 83

	before terminate 1 the average redundancy rate is:  1.2670807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
	walk terminate 1 spend time 4.004128694534302
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 121, 73, 127, 77, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 15, 16, 18, 23, 18, 18, 14, 


	preparing two sides time :  0.0006775856018066406
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 121, 73

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
	walk terminate 1 spend time 4.013353586196899
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.0004975795745849609
	Initialize BitList time :  3.8623809814453125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 121, 127

	before terminate 1 the average redundancy rate is:  1.5403726708074534
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
	walk terminate 1 spend time 4.108489990234375
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.0004916191101074219
	Initialize BitList time :  0.00011682510375976562
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 127, 77

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
	walk terminate 1 spend time 4.053778886795044
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 77, 127, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 36.355753898620605
partition_len_list
[79, 86, 104, 83, 73, 121, 77, 127]
random_init_graph_partition selection method range initialization spend 36.35650134086609
time for parepare:  0.00019598007202148438
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.036313533782958984
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.01400303840637207
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  6.67572021484375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.82012939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.053406715393066406
generate_one_block  0.008103132247924805
generate_one_block  0.001195669174194336
generate_one_block  0.0010688304901123047
generate_one_block  0.0010635852813720703
generate_one_block  0.0010569095611572266
generate_one_block  0.0010993480682373047
generate_one_block  0.0010533332824707031
generate_one_block  0.0010917186737060547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020360946655273438
gen group dst list time:  0.0001246929168701172
time for parepare:  0.0004024505615234375
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0003230571746826172
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002639293670654297
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00023174285888671875
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0005176067352294922
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0005977153778076172
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0003216266632080078
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0006120204925537109
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0007762908935546875
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0005347728729248047
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0010383129119873047
----------------------check_connections_block total spend ----------------------------- 0.010930299758911133
generate_one_block  0.005344390869140625
generate_one_block  0.0027189254760742188
generate_one_block  0.0026578903198242188
generate_one_block  0.002713918685913086
generate_one_block  0.0024318695068359375
generate_one_block  0.00452876091003418
generate_one_block  0.001737833023071289
generate_one_block  0.0020749568939208984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.013066768646240234
gen group dst list time:  0.00014090538024902344
time for parepare:  0.0004305839538574219
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0762033462524414
mini_batch_src_global generation:  0.00037598609924316406
r_  generation:  0.0009374618530273438
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.0007212162017822266
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0002605915069580078
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0007352828979492188
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0007905960083007812
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0009245872497558594
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0010094642639160156
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0007016658782958984
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0013074874877929688
----------------------check_connections_block total spend ----------------------------- 0.08980584144592285
generate_one_block  0.0027141571044921875
generate_one_block  0.0020940303802490234
generate_one_block  0.0021190643310546875
generate_one_block  0.0021359920501708984
generate_one_block  0.0021941661834716797
generate_one_block  0.00215911865234375
generate_one_block  0.0019559860229492188
generate_one_block  0.0027201175689697266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20813.65625, 'VmSize': 20656.6328125, 'VmHWM': 3620.69921875, 'VmRSS': 3620.671875}
connection checking time:  0.10073614120483398
block generation total time  0.042301177978515625
average batch blocks generation time:  0.005287647247314453
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.006093025207519531  GigaBytes
Max Memory Allocated: 0.006093025207519531  GigaBytes

{'VmPeak': 21033.625, 'VmSize': 21001.88671875, 'VmHWM': 3935.7734375, 'VmRSS': 3935.7734375}
torch.Size([1103, 1433])
torch.Size([431, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006230831146240234  GigaBytes
Max Memory Allocated: 0.006258964538574219  GigaBytes

{'VmPeak': 21757.30078125, 'VmSize': 21753.82421875, 'VmHWM': 4610.0234375, 'VmRSS': 4610.0234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005167484283447266  GigaBytes
Max Memory Allocated: 0.011035442352294922  GigaBytes

{'VmPeak': 21758.75, 'VmSize': 21758.75, 'VmHWM': 4615.2890625, 'VmRSS': 4615.2890625}
torch.Size([897, 1433])
torch.Size([325, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005281925201416016  GigaBytes
Max Memory Allocated: 0.011035442352294922  GigaBytes

{'VmPeak': 21758.75, 'VmSize': 21758.75, 'VmHWM': 4615.2890625, 'VmRSS': 4615.2890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006268024444580078  GigaBytes
Max Memory Allocated: 0.011035442352294922  GigaBytes

{'VmPeak': 21759.48828125, 'VmSize': 21759.48828125, 'VmHWM': 4616.65234375, 'VmRSS': 4616.65234375}
torch.Size([1032, 1433])
torch.Size([344, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006390571594238281  GigaBytes
Max Memory Allocated: 0.011035442352294922  GigaBytes

{'VmPeak': 21759.48828125, 'VmSize': 21759.48828125, 'VmHWM': 4616.65234375, 'VmRSS': 4616.65234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005671024322509766  GigaBytes
Max Memory Allocated: 0.01153707504272461  GigaBytes

{'VmPeak': 21759.48828125, 'VmSize': 21759.48828125, 'VmHWM': 4617.06640625, 'VmRSS': 4617.06640625}
torch.Size([991, 1433])
torch.Size([407, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005803585052490234  GigaBytes
Max Memory Allocated: 0.01153707504272461  GigaBytes

{'VmPeak': 21759.48828125, 'VmSize': 21759.48828125, 'VmHWM': 4617.06640625, 'VmRSS': 4617.06640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006827831268310547  GigaBytes
Max Memory Allocated: 0.012092113494873047  GigaBytes

{'VmPeak': 21760.4453125, 'VmSize': 21760.4453125, 'VmHWM': 4617.9765625, 'VmRSS': 4617.9765625}
torch.Size([1207, 1433])
torch.Size([469, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006974697113037109  GigaBytes
Max Memory Allocated: 0.012092113494873047  GigaBytes

{'VmPeak': 21760.4453125, 'VmSize': 21760.4453125, 'VmHWM': 4617.9765625, 'VmRSS': 4617.9765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007296085357666016  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21760.921875, 'VmSize': 21760.921875, 'VmHWM': 4618.88671875, 'VmRSS': 4618.88671875}
torch.Size([1294, 1433])
torch.Size([543, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007474422454833984  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21760.921875, 'VmSize': 21760.921875, 'VmHWM': 4618.88671875, 'VmRSS': 4618.88671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005466938018798828  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21760.921875, 'VmSize': 21760.921875, 'VmHWM': 4619.078125, 'VmRSS': 4619.078125}
torch.Size([953, 1433])
torch.Size([368, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0055866241455078125  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21760.921875, 'VmSize': 21760.921875, 'VmHWM': 4619.078125, 'VmRSS': 4619.078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00826120376586914  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21761.90234375, 'VmSize': 21761.90234375, 'VmHWM': 4620.078125, 'VmRSS': 4620.078125}
torch.Size([1473, 1433])
torch.Size([725, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008484840393066406  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21761.90234375, 'VmSize': 21761.90234375, 'VmHWM': 4620.078125, 'VmRSS': 4620.078125}
{'VmPeak': 21761.90234375, 'VmSize': 21761.90234375, 'VmHWM': 4620.39453125, 'VmRSS': 4620.39453125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008233964443206787 |0.04538729786872864 |0.09931528568267822 |0.00014159083366394043 |0.003192901611328125 |0.0019304752349853516 |
----------------------------------------------------------pseudo_mini_loss sum 3.5908730030059814
{'VmPeak': 21761.90234375, 'VmSize': 21761.90234375, 'VmHWM': 4620.39453125, 'VmRSS': 4620.39453125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13312
Number of first layer input nodes during this epoch:  8950
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00870656967163086  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21761.90234375, 'VmSize': 21761.90234375, 'VmHWM': 4620.64453125, 'VmRSS': 4620.64453125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005016326904296875
global_2_local 7.43865966796875e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.867813110351562e-05
before graph partition 
		99, 126, 76, 94, 84, 98, 119, 57, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020313262939453125
	Initialize BitList time :  1.1920928955078125e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 99, 126

	before terminate 1 the average redundancy rate is:  1.3975155279503106
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
	walk terminate 1 spend time 4.780298233032227
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		99, 126, 76, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0009255409240722656
	Initialize BitList time :  4.38690185546875e-05
	getRedundancyCost: time   5.245208740234375e-06

					length of partitions 126, 76

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
	walk terminate 1 spend time 4.991513013839722
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 126, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004725456237792969
	Initialize BitList time :  9.131431579589844e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 94

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
	walk terminate 1 spend time 4.930980682373047
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 126, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004725456237792969
	Initialize BitList time :  5.078315734863281e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 126, 84

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
	walk terminate 1 spend time 4.876167297363281
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 126, 98, 119, 57, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004711151123046875
	Initialize BitList time :  3.790855407714844e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 126, 98

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
	walk terminate 1 spend time 4.860275983810425
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 126, 119, 57, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004742145538330078
	Initialize BitList time :  0.00014281272888183594
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 119

	before terminate 1 the average redundancy rate is:  1.5217391304347827
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.565217391304348,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
	walk terminate 1 spend time 4.9266533851623535
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.1180124223602483,  1.9130434782608696
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 14
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.937888198757764,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.763975155279503,  1.204968944099379
	walk terminate 1 spend time 5.00423789024353
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		99, 76, 94, 84, 98, 97, 142, 57, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 8, 28, 14, 


	preparing two sides time :  0.000492095947265625
	Initialize BitList time :  4.315376281738281e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 142, 57

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.68944099378882,  0.782608695652174
	walk terminate 1 spend time 4.934465408325195
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 97, 63, 136, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 39.33102464675903
partition_len_list
[99, 76, 94, 84, 98, 97, 63, 136]
random_init_graph_partition selection method range initialization spend 39.33147406578064
time for parepare:  0.00015735626220703125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0007984638214111328
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.00042319297790527344
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00011301040649414062
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.699562072753906e-05
----------------------check_connections_block total spend ----------------------------- 0.00479578971862793
generate_one_block  0.018093109130859375
generate_one_block  0.0012946128845214844
generate_one_block  0.0013604164123535156
generate_one_block  0.0010967254638671875
generate_one_block  0.0011069774627685547
generate_one_block  0.0011234283447265625
generate_one_block  0.0010247230529785156
generate_one_block  0.0011324882507324219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017888545989990234
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.0005793571472167969
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00037026405334472656
mini_batch_src_global generation:  0.00012040138244628906
r_  generation:  0.0003590583801269531
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0002262592315673828
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002224445343017578
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002028942108154297
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.000278472900390625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002779960632324219
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00017571449279785156
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00037217140197753906
----------------------check_connections_block total spend ----------------------------- 0.0053577423095703125
generate_one_block  0.002111196517944336
generate_one_block  0.001276254653930664
generate_one_block  0.0012845993041992188
generate_one_block  0.0012960433959960938
generate_one_block  0.0015740394592285156
generate_one_block  0.0014102458953857422
generate_one_block  0.0013072490692138672
generate_one_block  0.0016605854034423828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015685558319091797
gen group dst list time:  0.00010991096496582031
time for parepare:  0.0005047321319580078
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.0011653900146484375
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0007233619689941406
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0007410049438476562
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0007216930389404297
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0009672641754150391
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0008230209350585938
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006158351898193359
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0012204647064208984
----------------------check_connections_block total spend ----------------------------- 0.01237630844116211
generate_one_block  0.011563777923583984
generate_one_block  0.0018301010131835938
generate_one_block  0.001850128173828125
generate_one_block  0.0018305778503417969
generate_one_block  0.002148866653442383
generate_one_block  0.001964569091796875
generate_one_block  0.0017461776733398438
generate_one_block  0.0025255680084228516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00870656967163086  GigaBytes
Max Memory Allocated: 0.013709545135498047  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.66015625, 'VmRSS': 4621.6171875}
connection checking time:  0.017734050750732422
block generation total time  0.03737998008728027
average batch blocks generation time:  0.004672497510910034
block dataloader generation time/epoch 39.43380117416382
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00792837142944336  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.83203125, 'VmRSS': 4621.83203125}
torch.Size([1346, 1433])
torch.Size([628, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008120059967041016  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.83203125, 'VmRSS': 4621.83203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005702495574951172  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.98046875}
torch.Size([931, 1433])
torch.Size([369, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005825042724609375  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.98046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006247997283935547  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.98046875}
torch.Size([1033, 1433])
torch.Size([369, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006375312805175781  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21826.16796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.98046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006396770477294922  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.91796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.9765625}
torch.Size([1061, 1433])
torch.Size([365, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006519794464111328  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.91796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.9765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0072956085205078125  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.91796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.9765625}
torch.Size([1228, 1433])
torch.Size([520, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007462024688720703  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.91796875, 'VmHWM': 4621.98046875, 'VmRSS': 4621.9765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006656646728515625  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
torch.Size([1109, 1433])
torch.Size([394, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006794929504394531  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005597591400146484  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
torch.Size([912, 1433])
torch.Size([347, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005707263946533203  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008403301239013672  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
torch.Size([1434, 1433])
torch.Size([674, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008619308471679688  GigaBytes
Max Memory Allocated: 0.015758991241455078  GigaBytes

{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008022844791412354 |0.0007457137107849121 |0.005590230226516724 |0.00030604004859924316 |0.002393573522567749 |0.0017151832580566406 |
----------------------------------------------------------pseudo_mini_loss sum 2.463425874710083
{'VmPeak': 21889.91796875, 'VmSize': 21825.90234375, 'VmHWM': 4621.98046875, 'VmRSS': 4621.97265625}
Total (block generation + training)time/epoch 39.58726382255554
Training time/epoch 0.15285396575927734
Training time without block to device /epoch 0.14688825607299805
Training time without total dataloading part /epoch 0.06803393363952637
load block tensor time/epoch 0.06418275833129883
block to device time/epoch 0.005965709686279297
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13467
Number of first layer input nodes during this epoch:  9054
