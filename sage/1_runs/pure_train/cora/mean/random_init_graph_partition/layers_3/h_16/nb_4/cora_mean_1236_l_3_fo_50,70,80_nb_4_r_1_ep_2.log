main start at this time 1648597038.5825455
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20858.70703125, 'VmSize': 20807.54296875, 'VmHWM': 3636.12890625, 'VmRSS': 3619.71875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013854503631591797
global_2_local 0.00011277198791503906
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0003552436828613281
before graph partition 
		164, 218, 144, 211, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002903938293457031
	Initialize BitList time :  1.6927719116210938e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 164, 218

	before terminate 1 the average redundancy rate is:  1.186335403726708
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.279503105590062,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
	walk terminate 1 spend time 3.944992780685425
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.279503105590062,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.2608695652173914,  1.1055900621118013
	walk terminate 1 spend time 4.035933971405029
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		178, 203, 144, 211, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				30, 40, 35, 35, 


	preparing two sides time :  0.0005586147308349609
	Initialize BitList time :  4.7206878662109375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 203, 144

	before terminate 1 the average redundancy rate is:  1.0776397515527951
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.077639751552795,  1.2422360248447204,  0.9130434782608695
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2670807453416149,  0.8881987577639752
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2546583850931676,  0.9006211180124224
	walk terminate 1 spend time 4.008957862854004
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.236024844720497,  0.9254658385093167
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.2546583850931676,  0.906832298136646
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2173913043478262,  0.937888198757764
	walk terminate 1 spend time 4.0889904499053955
				 improvement:  False
1
side is 0
	 walk step 1  partition 
		178, 151, 196, 211, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				30, 37, 38, 35, 


	preparing two sides time :  0.00054931640625
	Initialize BitList time :  4.3392181396484375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 196, 211

	before terminate 1 the average redundancy rate is:  1.263975155279503
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.360248447204969,  1.15527950310559
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.2484472049689441,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.4099378881987579,  1.0869565217391304
	walk terminate 1 spend time 4.038619041442871
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.186335403726708,  1.3167701863354038
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.2732919254658386,  1.2298136645962734
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.1118012422360248,  1.3975155279503106
	walk terminate 1 spend time 4.085747957229614
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		178, 151, 179, 225, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 24.215314626693726
partition_len_list
[178, 151, 179, 225]
random_init_graph_partition selection method range initialization spend 24.21630835533142
time for parepare:  0.00012493133544921875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0007648468017578125
mini_batch_src_global generation:  0.00011754035949707031
r_  generation:  0.026277542114257812
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  9.131431579589844e-05
----------------------check_connections_block total spend ----------------------------- 0.029183626174926758
generate_one_block  0.005964517593383789
generate_one_block  0.001314401626586914
generate_one_block  0.0011899471282958984
generate_one_block  0.0012416839599609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020182132720947266
gen group dst list time:  4.792213439941406e-05
time for parepare:  0.00047206878662109375
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00044798851013183594
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.000392913818359375
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0003859996795654297
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.000469207763671875
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0005559921264648438
----------------------check_connections_block total spend ----------------------------- 0.004248857498168945
generate_one_block  0.0025839805603027344
generate_one_block  0.0017499923706054688
generate_one_block  0.001856088638305664
generate_one_block  0.0021522045135498047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015952587127685547
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.00029659271240234375
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.0004451274871826172
r_  generation:  0.0013842582702636719
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.000568389892578125
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0013477802276611328
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00035071372985839844
mini_batch_src_global generation:  0.0002460479736328125
r_  generation:  0.0015215873718261719
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0003809928894042969
mini_batch_src_global generation:  0.00029850006103515625
r_  generation:  0.0017702579498291016
----------------------check_connections_block total spend ----------------------------- 0.012319803237915039
generate_one_block  0.0047397613525390625
generate_one_block  0.004220008850097656
generate_one_block  0.0059664249420166016
generate_one_block  0.007182121276855469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20858.70703125, 'VmSize': 20657.50390625, 'VmHWM': 3636.12890625, 'VmRSS': 3622.59375}
connection checking time:  0.016568660736083984
block generation total time  0.03045058250427246
average batch blocks generation time:  0.007612645626068115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.008188247680664062  GigaBytes
Max Memory Allocated: 0.008188247680664062  GigaBytes

{'VmPeak': 21005.34765625, 'VmSize': 20977.35546875, 'VmHWM': 3911.84375, 'VmRSS': 3911.84375}
torch.Size([1493, 1433])
torch.Size([664, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008414268493652344  GigaBytes
Max Memory Allocated: 0.008429527282714844  GigaBytes

{'VmPeak': 21756.7734375, 'VmSize': 21749.8515625, 'VmHWM': 4606.29296875, 'VmRSS': 4606.29296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008135318756103516  GigaBytes
Max Memory Allocated: 0.016069889068603516  GigaBytes

{'VmPeak': 21757.90234375, 'VmSize': 21757.90234375, 'VmHWM': 4615.8828125, 'VmRSS': 4615.8828125}
torch.Size([1450, 1433])
torch.Size([686, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008356094360351562  GigaBytes
Max Memory Allocated: 0.016069889068603516  GigaBytes

{'VmPeak': 21757.90234375, 'VmSize': 21757.90234375, 'VmHWM': 4615.8828125, 'VmRSS': 4615.8828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00914144515991211  GigaBytes
Max Memory Allocated: 0.016839027404785156  GigaBytes

{'VmPeak': 21758.92578125, 'VmSize': 21758.92578125, 'VmHWM': 4617.17578125, 'VmRSS': 4617.17578125}
torch.Size([1637, 1433])
torch.Size([775, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009394645690917969  GigaBytes
Max Memory Allocated: 0.016839027404785156  GigaBytes

{'VmPeak': 21758.92578125, 'VmSize': 21758.92578125, 'VmHWM': 4617.17578125, 'VmRSS': 4617.17578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009854316711425781  GigaBytes
Max Memory Allocated: 0.018541336059570312  GigaBytes

{'VmPeak': 21759.6484375, 'VmSize': 21759.6484375, 'VmHWM': 4618.3125, 'VmRSS': 4618.3125}
torch.Size([1769, 1433])
torch.Size([984, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.010170936584472656  GigaBytes
Max Memory Allocated: 0.018541336059570312  GigaBytes

{'VmPeak': 21759.6484375, 'VmSize': 21759.6484375, 'VmHWM': 4618.3125, 'VmRSS': 4618.3125}
{'VmPeak': 21759.6484375, 'VmSize': 21759.6484375, 'VmHWM': 4618.56640625, 'VmRSS': 4618.56640625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016234934329986572 |0.09311097860336304 |0.2010238766670227 |0.00022083520889282227 |0.004408299922943115 |0.002800464630126953 |
----------------------------------------------------------pseudo_mini_loss sum 3.1446785926818848
{'VmPeak': 21759.6484375, 'VmSize': 21759.6484375, 'VmHWM': 4618.75390625, 'VmRSS': 4618.75390625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10191
Number of first layer input nodes during this epoch:  6349
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.01032876968383789  GigaBytes
Max Memory Allocated: 0.018541336059570312  GigaBytes

{'VmPeak': 21759.6484375, 'VmSize': 21759.6484375, 'VmHWM': 4618.75390625, 'VmRSS': 4618.75390625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007891654968261719
global_2_local 9.179115295410156e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00010633468627929688
before graph partition 
		217, 165, 156, 194, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002987384796142578
	Initialize BitList time :  1.7642974853515625e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 217, 165

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.204968944099379,  1.1614906832298137
						 current side  1
			 redundancy will reduce  0.009316770186335699
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.3478260869565217,  1.0062111801242235
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.2298136645962734,  1.1180124223602483
	walk terminate 1 spend time 4.8324339389801025
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.204968944099379,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.2236024844720497,  1.124223602484472
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.1987577639751552,  1.15527950310559
	walk terminate 1 spend time 4.913326740264893
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		186, 193, 156, 194, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				41, 29, 35, 35, 


	preparing two sides time :  0.0005340576171875
	Initialize BitList time :  4.220008850097656e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 193, 156

	before terminate 1 the average redundancy rate is:  1.0838509316770186
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.1801242236024845,  0.9875776397515528
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.1925465838509317,  0.9751552795031055
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0683229813664596,  1.1055900621118013
	walk terminate 1 spend time 4.850450038909912
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		186, 172, 178, 194, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				41, 28, 36, 35, 


	preparing two sides time :  0.0005364418029785156
	Initialize BitList time :  0.00013518333435058594
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 178, 194

	before terminate 1 the average redundancy rate is:  1.1552795031055902
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1428571428571428,  1.1677018633540373
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.124223602484472,  1.186335403726708
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1925465838509317,  1.1180124223602483
	walk terminate 1 spend time 4.918027877807617
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.062111801242236,  1.2546583850931676
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.2422360248447204,  1.0683229813664596
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.0372670807453417,  1.2484472049689441
	walk terminate 1 spend time 4.9006030559539795
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		186, 172, 167, 201, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 24.42529296875
partition_len_list
[186, 172, 167, 201]
random_init_graph_partition selection method range initialization spend 24.425941944122314
time for parepare:  0.0001919269561767578
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0009589195251464844
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0004267692565917969
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00011444091796875
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00010633468627929688
----------------------check_connections_block total spend ----------------------------- 0.003810882568359375
generate_one_block  0.025734663009643555
generate_one_block  0.0012464523315429688
generate_one_block  0.0011713504791259766
generate_one_block  0.001371622085571289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001268148422241211
gen group dst list time:  4.8160552978515625e-05
time for parepare:  0.0006570816040039062
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.0006291866302490234
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.00054168701171875
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0005192756652832031
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005850791931152344
----------------------check_connections_block total spend ----------------------------- 0.0052814483642578125
generate_one_block  0.0017268657684326172
generate_one_block  0.0016632080078125
generate_one_block  0.0016281604766845703
generate_one_block  0.001688241958618164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001705169677734375
gen group dst list time:  8.654594421386719e-05
time for parepare:  0.00030040740966796875
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0008695125579833984
mini_batch_src_global generation:  0.00028896331787109375
r_  generation:  0.0016086101531982422
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.0005595684051513672
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.001497507095336914
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0015020370483398438
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.0016317367553710938
----------------------check_connections_block total spend ----------------------------- 0.011172056198120117
generate_one_block  0.002822399139404297
generate_one_block  0.0026390552520751953
generate_one_block  0.0026073455810546875
generate_one_block  0.002745389938354492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.01032876968383789  GigaBytes
Max Memory Allocated: 0.018541336059570312  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21823.9140625, 'VmHWM': 4619.59765625, 'VmRSS': 4619.5625}
connection checking time:  0.01645350456237793
block generation total time  0.017520666122436523
average batch blocks generation time:  0.004380166530609131
block dataloader generation time/epoch 24.507235527038574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009541511535644531  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4622.69140625, 'VmRSS': 4622.69140625}
torch.Size([1646, 1433])
torch.Size([812, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.00980520248413086  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4622.69140625, 'VmRSS': 4622.69140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008844852447509766  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.2890625, 'VmRSS': 4623.2890625}
torch.Size([1516, 1433])
torch.Size([731, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009083271026611328  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.2890625, 'VmRSS': 4623.2890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009539127349853516  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.3359375, 'VmRSS': 4623.3359375}
torch.Size([1520, 1433])
torch.Size([712, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009772777557373047  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.3359375, 'VmRSS': 4623.3359375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009516239166259766  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.4140625, 'VmRSS': 4623.4140625}
torch.Size([1641, 1433])
torch.Size([790, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009779930114746094  GigaBytes
Max Memory Allocated: 0.018941879272460938  GigaBytes

{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.4140625, 'VmRSS': 4623.4140625}
{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.4140625, 'VmRSS': 4623.4140625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0159989595413208 |0.0007694363594055176 |0.005363166332244873 |0.00022941827774047852 |0.003043532371520996 |0.0023970603942871094 |
----------------------------------------------------------pseudo_mini_loss sum 2.52309513092041
{'VmPeak': 21887.6640625, 'VmSize': 21827.37109375, 'VmHWM': 4623.4140625, 'VmRSS': 4623.4140625}
Total (block generation + training)time/epoch 24.619458436965942
Training time/epoch 0.1115875244140625
Training time without block to device /epoch 0.10850977897644043
Training time without total dataloading part /epoch 0.0369415283203125
load block tensor time/epoch 0.0639958381652832
block to device time/epoch 0.0030777454376220703
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10094
Number of first layer input nodes during this epoch:  6323
