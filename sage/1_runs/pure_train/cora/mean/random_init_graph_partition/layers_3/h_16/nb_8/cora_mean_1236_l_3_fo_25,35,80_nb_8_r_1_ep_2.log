main start at this time 1648596295.9990177
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20862.5078125, 'VmSize': 20801.67578125, 'VmHWM': 3654.8671875, 'VmRSS': 3611.68359375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014259815216064453
global_2_local 7.390975952148438e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00020647048950195312
before graph partition 
		79, 92, 98, 132, 83, 73, 127, 77, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021505355834960938
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 79, 92

	before terminate 1 the average redundancy rate is:  1.062111801242236
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
	walk terminate 1 spend time 4.050014972686768
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 92, 98, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005114078521728516
	Initialize BitList time :  3.838539123535156e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 92, 98

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.217180013656616
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.143401861190796
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		79, 86, 103, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 15, 21, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004849433898925781
	Initialize BitList time :  3.933906555175781e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 103, 132

	before terminate 1 the average redundancy rate is:  1.4596273291925466
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894235
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.453416149068323,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.1677018633540373,  1.6770186335403727
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.279503105590062,  1.565217391304348
	walk terminate 1 spend time 4.12015438079834
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.515527950310559,  1.3167701863354038
						 current side  0
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.3043478260869565,  1.4906832298136645
						 current side  1
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.5031055900621118,  1.2919254658385093
	walk terminate 1 spend time 3.952022075653076
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		79, 86, 104, 121, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 15, 16, 23, 18, 18, 18, 14, 


	preparing two sides time :  0.00047707557678222656
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 121, 83

	before terminate 1 the average redundancy rate is:  1.2670807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
	walk terminate 1 spend time 4.0443127155303955
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 121, 73, 127, 77, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 15, 16, 18, 23, 18, 18, 14, 


	preparing two sides time :  0.0007050037384033203
	Initialize BitList time :  6.628036499023438e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 121, 73

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
	walk terminate 1 spend time 4.187692165374756
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.0005097389221191406
	Initialize BitList time :  9.632110595703125e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 121, 127

	before terminate 1 the average redundancy rate is:  1.5403726708074534
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
	walk terminate 1 spend time 4.087028503417969
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.00048160552978515625
	Initialize BitList time :  4.00543212890625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 127, 77

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
	walk terminate 1 spend time 4.115038633346558
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 77, 127, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 36.943379163742065
partition_len_list
[79, 86, 104, 83, 73, 121, 77, 127]
random_init_graph_partition selection method range initialization spend 36.94386839866638
time for parepare:  0.00017571449279785156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0015363693237304688
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.014041900634765625
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001461505889892578
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.863739013671875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00010466575622558594
----------------------check_connections_block total spend ----------------------------- 0.018881559371948242
generate_one_block  0.011507749557495117
generate_one_block  0.001171112060546875
generate_one_block  0.0010635852813720703
generate_one_block  0.0010211467742919922
generate_one_block  0.0010237693786621094
generate_one_block  0.0010612010955810547
generate_one_block  0.001013040542602539
generate_one_block  0.001051187515258789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009930133819580078
gen group dst list time:  0.0001251697540283203
time for parepare:  0.0004153251647949219
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.000202178955078125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0001761913299560547
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00020623207092285156
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00018548965454101562
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00020051002502441406
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003273487091064453
----------------------check_connections_block total spend ----------------------------- 0.004398822784423828
generate_one_block  0.0021932125091552734
generate_one_block  0.001219034194946289
generate_one_block  0.0012519359588623047
generate_one_block  0.0011839866638183594
generate_one_block  0.0013508796691894531
generate_one_block  0.0045053958892822266
generate_one_block  0.0011510848999023438
generate_one_block  0.001329660415649414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007271766662597656
gen group dst list time:  9.584426879882812e-05
time for parepare:  0.0006005764007568359
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.0006351470947265625
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0005598068237304688
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0006337165832519531
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0005810260772705078
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0006542205810546875
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0008406639099121094
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0005593299865722656
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.000993490219116211
----------------------check_connections_block total spend ----------------------------- 0.010593891143798828
generate_one_block  0.001817464828491211
generate_one_block  0.001608133316040039
generate_one_block  0.002291440963745117
generate_one_block  0.0018551349639892578
generate_one_block  0.0019140243530273438
generate_one_block  0.0020945072174072266
generate_one_block  0.0016028881072998047
generate_one_block  0.0021424293518066406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20862.5078125, 'VmSize': 20656.19921875, 'VmHWM': 3654.8671875, 'VmRSS': 3619.10546875}
connection checking time:  0.014992713928222656
block generation total time  0.029511213302612305
average batch blocks generation time:  0.003688901662826538
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005412101745605469  GigaBytes
Max Memory Allocated: 0.005412101745605469  GigaBytes

{'VmPeak': 21005.37109375, 'VmSize': 20977.72265625, 'VmHWM': 3910.47265625, 'VmRSS': 3910.47265625}
torch.Size([976, 1433])
torch.Size([378, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005536556243896484  GigaBytes
Max Memory Allocated: 0.005558013916015625  GigaBytes

{'VmPeak': 21755.1015625, 'VmSize': 21750.1875, 'VmHWM': 4604.64453125, 'VmRSS': 4604.64453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004727840423583984  GigaBytes
Max Memory Allocated: 0.00991964340209961  GigaBytes

{'VmPeak': 21755.1015625, 'VmSize': 21754.64453125, 'VmHWM': 4610.0546875, 'VmRSS': 4610.0546875}
torch.Size([815, 1433])
torch.Size([301, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004835605621337891  GigaBytes
Max Memory Allocated: 0.00991964340209961  GigaBytes

{'VmPeak': 21755.1015625, 'VmSize': 21754.64453125, 'VmHWM': 4610.0546875, 'VmRSS': 4610.0546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005589008331298828  GigaBytes
Max Memory Allocated: 0.00991964340209961  GigaBytes

{'VmPeak': 21755.46875, 'VmSize': 21755.46875, 'VmHWM': 4611.203125, 'VmRSS': 4611.203125}
torch.Size([966, 1433])
torch.Size([344, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005710601806640625  GigaBytes
Max Memory Allocated: 0.00991964340209961  GigaBytes

{'VmPeak': 21755.46875, 'VmSize': 21755.46875, 'VmHWM': 4611.203125, 'VmRSS': 4611.203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005112171173095703  GigaBytes
Max Memory Allocated: 0.010303974151611328  GigaBytes

{'VmPeak': 21755.46875, 'VmSize': 21755.46875, 'VmHWM': 4611.41796875, 'VmRSS': 4611.41796875}
torch.Size([887, 1433])
torch.Size([347, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005228996276855469  GigaBytes
Max Memory Allocated: 0.010303974151611328  GigaBytes

{'VmPeak': 21755.46875, 'VmSize': 21755.46875, 'VmHWM': 4611.41796875, 'VmRSS': 4611.41796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0060214996337890625  GigaBytes
Max Memory Allocated: 0.010736465454101562  GigaBytes

{'VmPeak': 21755.96484375, 'VmSize': 21755.96484375, 'VmHWM': 4611.91015625, 'VmRSS': 4611.91015625}
torch.Size([1057, 1433])
torch.Size([388, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0061473846435546875  GigaBytes
Max Memory Allocated: 0.010736465454101562  GigaBytes

{'VmPeak': 21755.96484375, 'VmSize': 21755.96484375, 'VmHWM': 4611.91015625, 'VmRSS': 4611.91015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006747722625732422  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21756.703125, 'VmSize': 21756.703125, 'VmHWM': 4613.3125, 'VmRSS': 4613.3125}
torch.Size([1192, 1433])
torch.Size([485, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006910800933837891  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21756.703125, 'VmSize': 21756.703125, 'VmHWM': 4613.3125, 'VmRSS': 4613.3125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005074024200439453  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21756.703125, 'VmSize': 21756.703125, 'VmHWM': 4613.76953125, 'VmRSS': 4613.76953125}
torch.Size([880, 1433])
torch.Size([331, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005184650421142578  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21756.703125, 'VmSize': 21756.703125, 'VmHWM': 4613.76953125, 'VmRSS': 4613.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007609844207763672  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21757.578125, 'VmSize': 21757.578125, 'VmHWM': 4614.4609375, 'VmRSS': 4614.4609375}
torch.Size([1352, 1433])
torch.Size([638, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007809638977050781  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21757.578125, 'VmSize': 21757.578125, 'VmHWM': 4614.4609375, 'VmRSS': 4614.4609375}
{'VmPeak': 21757.578125, 'VmSize': 21757.578125, 'VmHWM': 4614.97265625, 'VmRSS': 4614.97265625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008322745561599731 |0.04788196086883545 |0.10063254833221436 |0.00015994906425476074 |0.0026020705699920654 |0.002107858657836914 |
----------------------------------------------------------pseudo_mini_loss sum 3.571540594100952
{'VmPeak': 21757.578125, 'VmSize': 21757.578125, 'VmHWM': 4614.97265625, 'VmRSS': 4614.97265625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12087
Number of first layer input nodes during this epoch:  8125
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008042335510253906  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21757.578125, 'VmSize': 21757.578125, 'VmHWM': 4614.97265625, 'VmRSS': 4614.97265625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004677772521972656
global_2_local 7.319450378417969e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.414817810058594e-05
before graph partition 
		99, 126, 76, 94, 84, 98, 119, 57, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021409988403320312
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 99, 126

	before terminate 1 the average redundancy rate is:  1.3975155279503106
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
	walk terminate 1 spend time 4.815690040588379
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		99, 126, 76, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048160552978515625
	Initialize BitList time :  4.38690185546875e-05
	getRedundancyCost: time   4.5299530029296875e-06

					length of partitions 126, 76

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
	walk terminate 1 spend time 5.1739137172698975
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 126, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003228187561035156
	Initialize BitList time :  6.461143493652344e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 126, 94

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
	walk terminate 1 spend time 5.051052570343018
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 126, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048470497131347656
	Initialize BitList time :  4.38690185546875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 84

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
	walk terminate 1 spend time 5.013897895812988
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 126, 98, 119, 57, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003120899200439453
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 126, 98

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
	walk terminate 1 spend time 5.028272390365601
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 126, 119, 57, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003018379211425781
	Initialize BitList time :  3.0040740966796875e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 126, 119

	before terminate 1 the average redundancy rate is:  1.5217391304347827
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.565217391304348,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
	walk terminate 1 spend time 4.968595504760742
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.1180124223602483,  1.9130434782608696
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 14
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.937888198757764,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.763975155279503,  1.204968944099379
	walk terminate 1 spend time 4.980321884155273
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		99, 76, 94, 84, 98, 97, 142, 57, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 8, 28, 14, 


	preparing two sides time :  0.0004820823669433594
	Initialize BitList time :  4.363059997558594e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 142, 57

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.68944099378882,  0.782608695652174
	walk terminate 1 spend time 4.970424175262451
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 97, 63, 136, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 40.024916648864746
partition_len_list
[99, 76, 94, 84, 98, 97, 63, 136]
random_init_graph_partition selection method range initialization spend 40.02546048164368
time for parepare:  0.00015497207641601562
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0008881092071533203
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.00043082237243652344
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00015497207641601562
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.745887756347656e-05
----------------------check_connections_block total spend ----------------------------- 0.004533529281616211
generate_one_block  0.028833627700805664
generate_one_block  0.0011446475982666016
generate_one_block  0.001338958740234375
generate_one_block  0.0009856224060058594
generate_one_block  0.0009906291961669922
generate_one_block  0.0009751319885253906
generate_one_block  0.000965118408203125
generate_one_block  0.0010437965393066406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018074512481689453
gen group dst list time:  9.083747863769531e-05
time for parepare:  0.0007355213165283203
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00032401084899902344
mini_batch_src_global generation:  0.0001518726348876953
r_  generation:  0.0003228187561035156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0001811981201171875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001926422119140625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00019502639770507812
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0002810955047607422
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014328956604003906
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0003452301025390625
----------------------check_connections_block total spend ----------------------------- 0.005392551422119141
generate_one_block  0.0013310909271240234
generate_one_block  0.0012013912200927734
generate_one_block  0.0012378692626953125
generate_one_block  0.0011832714080810547
generate_one_block  0.0013751983642578125
generate_one_block  0.0013737678527832031
generate_one_block  0.0012133121490478516
generate_one_block  0.001608133316040039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001634836196899414
gen group dst list time:  0.0001010894775390625
time for parepare:  0.0005002021789550781
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00070953369140625
mini_batch_src_global generation:  0.0003905296325683594
r_  generation:  0.0009245872497558594
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.000579833984375
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006244182586669922
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0007085800170898438
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0008041858673095703
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00017762184143066406
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0007176399230957031
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00046133995056152344
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0009789466857910156
----------------------check_connections_block total spend ----------------------------- 0.012102842330932617
generate_one_block  0.0020804405212402344
generate_one_block  0.0016529560089111328
generate_one_block  0.0034332275390625
generate_one_block  0.004058122634887695
generate_one_block  0.016095876693725586
generate_one_block  0.0018579959869384766
generate_one_block  0.0015254020690917969
generate_one_block  0.002190828323364258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008042335510253906  GigaBytes
Max Memory Allocated: 0.012364387512207031  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21821.59375, 'VmHWM': 4615.98828125, 'VmRSS': 4615.8671875}
connection checking time:  0.017495393753051758
block generation total time  0.04341888427734375
average batch blocks generation time:  0.005427360534667969
block dataloader generation time/epoch 40.14384603500366
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007073879241943359  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.70703125, 'VmHWM': 4618.171875, 'VmRSS': 4618.171875}
torch.Size([1187, 1433])
torch.Size([528, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007239818572998047  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.70703125, 'VmHWM': 4618.171875, 'VmRSS': 4618.171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005186557769775391  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.70703125, 'VmHWM': 4618.74609375, 'VmRSS': 4618.74609375}
torch.Size([835, 1433])
torch.Size([322, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005296230316162109  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.70703125, 'VmHWM': 4618.74609375, 'VmRSS': 4618.74609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005641937255859375  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.70703125, 'VmHWM': 4619.21484375, 'VmRSS': 4619.21484375}
torch.Size([920, 1433])
torch.Size([340, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00576019287109375  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.70703125, 'VmHWM': 4619.21484375, 'VmRSS': 4619.21484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0057373046875  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.21484375, 'VmRSS': 4619.20703125}
torch.Size([938, 1433])
torch.Size([335, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005851268768310547  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.21484375, 'VmRSS': 4619.20703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006688594818115234  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.21484375, 'VmRSS': 4619.20703125}
torch.Size([1115, 1433])
torch.Size([466, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006840705871582031  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.21484375, 'VmRSS': 4619.20703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006168842315673828  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.21484375, 'VmRSS': 4619.20703125}
torch.Size([1018, 1433])
torch.Size([382, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006300926208496094  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.21484375, 'VmRSS': 4619.20703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004889011383056641  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.28125, 'VmRSS': 4619.28125}
torch.Size([780, 1433])
torch.Size([279, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004981040954589844  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21824.69140625, 'VmHWM': 4619.28125, 'VmRSS': 4619.28125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007752418518066406  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21825.37890625, 'VmHWM': 4619.83203125, 'VmRSS': 4619.83203125}
torch.Size([1313, 1433])
torch.Size([594, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007946968078613281  GigaBytes
Max Memory Allocated: 0.014264583587646484  GigaBytes

{'VmPeak': 21885.59375, 'VmSize': 21825.37890625, 'VmHWM': 4619.83203125, 'VmRSS': 4619.83203125}
{'VmPeak': 21885.59375, 'VmSize': 21825.37890625, 'VmHWM': 4619.8359375, 'VmRSS': 4619.8359375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011211663484573364 |0.0006410777568817139 |0.0044991374015808105 |0.0001684129238128662 |0.0031086504459381104 |0.001882791519165039 |
----------------------------------------------------------pseudo_mini_loss sum 2.4337663650512695
{'VmPeak': 21885.59375, 'VmSize': 21825.37890625, 'VmHWM': 4619.8359375, 'VmRSS': 4619.8359375}
Total (block generation + training)time/epoch 40.315553188323975
Training time/epoch 0.17109942436218262
Training time without block to device /epoch 0.1659708023071289
Training time without total dataloading part /epoch 0.06409239768981934
load block tensor time/epoch 0.08969330787658691
block to device time/epoch 0.005128622055053711
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12099
Number of first layer input nodes during this epoch:  8106
