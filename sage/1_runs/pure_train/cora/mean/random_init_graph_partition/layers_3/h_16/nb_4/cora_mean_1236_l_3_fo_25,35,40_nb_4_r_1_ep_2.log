main start at this time 1648595844.0126874
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20811.64453125, 'VmSize': 20802.95703125, 'VmHWM': 3613.72265625, 'VmRSS': 3613.72265625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005919933319091797
global_2_local 7.104873657226562e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.226799011230469e-05
before graph partition 
		164, 218, 144, 211, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00023293495178222656
	Initialize BitList time :  1.4781951904296875e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 164, 218

	before terminate 1 the average redundancy rate is:  1.186335403726708
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.279503105590062,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
	walk terminate 1 spend time 4.1547770500183105
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.279503105590062,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.2981366459627328,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.2608695652173914,  1.1055900621118013
	walk terminate 1 spend time 4.2850542068481445
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		178, 203, 144, 211, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				30, 40, 35, 35, 


	preparing two sides time :  0.000705718994140625
	Initialize BitList time :  4.458427429199219e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 203, 144

	before terminate 1 the average redundancy rate is:  1.0776397515527951
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.077639751552795,  1.2422360248447204,  0.9130434782608695
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2670807453416149,  0.8881987577639752
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2546583850931676,  0.9006211180124224
	walk terminate 1 spend time 4.2654924392700195
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.236024844720497,  0.9254658385093167
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.2546583850931676,  0.906832298136646
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.2173913043478262,  0.937888198757764
	walk terminate 1 spend time 4.2608935832977295
				 improvement:  False
1
side is 0
	 walk step 1  partition 
		178, 151, 196, 211, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				30, 37, 38, 35, 


	preparing two sides time :  0.0005354881286621094
	Initialize BitList time :  4.792213439941406e-05
	getRedundancyCost: time   5.245208740234375e-06

					length of partitions 196, 211

	before terminate 1 the average redundancy rate is:  1.263975155279503
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.360248447204969,  1.15527950310559
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.2484472049689441,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.4099378881987579,  1.0869565217391304
	walk terminate 1 spend time 4.442832708358765
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.186335403726708,  1.3167701863354038
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.2732919254658386,  1.2298136645962734
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.1118012422360248,  1.3975155279503106
	walk terminate 1 spend time 4.334475755691528
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		178, 151, 179, 225, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 25.754094123840332
partition_len_list
[178, 151, 179, 225]
random_init_graph_partition selection method range initialization spend 25.75488829612732
time for parepare:  0.00017118453979492188
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00162506103515625
mini_batch_src_global generation:  0.0001418590545654297
r_  generation:  0.013482332229614258
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00012731552124023438
----------------------check_connections_block total spend ----------------------------- 0.017120838165283203
generate_one_block  0.011717081069946289
generate_one_block  0.001157522201538086
generate_one_block  0.0010657310485839844
generate_one_block  0.0011091232299804688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00316619873046875
gen group dst list time:  9.036064147949219e-05
time for parepare:  0.0010938644409179688
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0013773441314697266
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0009438991546630859
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0004303455352783203
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0007398128509521484
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0011839866638183594
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.00019502639770507812
r_  generation:  0.0010526180267333984
----------------------check_connections_block total spend ----------------------------- 0.009516000747680664
generate_one_block  0.002212047576904297
generate_one_block  0.002080202102661133
generate_one_block  0.002233266830444336
generate_one_block  0.002458810806274414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001756429672241211
gen group dst list time:  7.843971252441406e-05
time for parepare:  0.0002930164337158203
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.0007753372192382812
mini_batch_src_global generation:  0.000492095947265625
r_  generation:  0.0013082027435302734
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.0010228157043457031
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.00018072128295898438
r_  generation:  0.0012722015380859375
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.0013294219970703125
----------------------check_connections_block total spend ----------------------------- 0.010111808776855469
generate_one_block  0.0022749900817871094
generate_one_block  0.0023720264434814453
generate_one_block  0.0033500194549560547
generate_one_block  0.0025327205657958984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20811.64453125, 'VmSize': 20656.98828125, 'VmHWM': 3620.64453125, 'VmRSS': 3620.64453125}
connection checking time:  0.019627809524536133
block generation total time  0.019514083862304688
average batch blocks generation time:  0.004878520965576172
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.007784843444824219  GigaBytes
Max Memory Allocated: 0.007784843444824219  GigaBytes

{'VmPeak': 21021.609375, 'VmSize': 20989.61328125, 'VmHWM': 3922.01171875, 'VmRSS': 3922.01171875}
torch.Size([1418, 1433])
torch.Size([628, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008000850677490234  GigaBytes
Max Memory Allocated: 0.00801229476928711  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21748.734375, 'VmHWM': 4604.15234375, 'VmRSS': 4604.15234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007221698760986328  GigaBytes
Max Memory Allocated: 0.01476144790649414  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21755.7578125, 'VmHWM': 4612.44921875, 'VmRSS': 4612.44921875}
torch.Size([1280, 1433])
torch.Size([590, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007417201995849609  GigaBytes
Max Memory Allocated: 0.01476144790649414  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21755.7578125, 'VmHWM': 4612.44921875, 'VmRSS': 4612.44921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008534431457519531  GigaBytes
Max Memory Allocated: 0.015327930450439453  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21757.09375, 'VmHWM': 4614.55078125, 'VmRSS': 4614.55078125}
torch.Size([1524, 1433])
torch.Size([714, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008771896362304688  GigaBytes
Max Memory Allocated: 0.015327930450439453  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21757.09375, 'VmHWM': 4614.55078125, 'VmRSS': 4614.55078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009214401245117188  GigaBytes
Max Memory Allocated: 0.017302989959716797  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21757.78125, 'VmHWM': 4615.671875, 'VmRSS': 4615.671875}
torch.Size([1650, 1433])
torch.Size([894, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009508132934570312  GigaBytes
Max Memory Allocated: 0.017302989959716797  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21757.78125, 'VmHWM': 4615.671875, 'VmRSS': 4615.671875}
{'VmPeak': 21758.4921875, 'VmSize': 21757.78125, 'VmHWM': 4615.92578125, 'VmRSS': 4615.92578125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02319645881652832 |0.09650444984436035 |0.1984226107597351 |0.00017917156219482422 |0.0033687353134155273 |0.004162311553955078 |
----------------------------------------------------------pseudo_mini_loss sum 3.131897449493408
{'VmPeak': 21758.4921875, 'VmSize': 21757.78125, 'VmHWM': 4615.92578125, 'VmRSS': 4615.92578125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9431
Number of first layer input nodes during this epoch:  5872
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009677886962890625  GigaBytes
Max Memory Allocated: 0.017302989959716797  GigaBytes

{'VmPeak': 21758.4921875, 'VmSize': 21757.78125, 'VmHWM': 4616.11328125, 'VmRSS': 4616.11328125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009114742279052734
global_2_local 0.0001049041748046875
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0001068115234375
before graph partition 
		217, 165, 156, 194, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0003349781036376953
	Initialize BitList time :  2.0742416381835938e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 217, 165

	before terminate 1 the average redundancy rate is:  1.1863354037267082
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.204968944099379,  1.1614906832298137
						 current side  1
			 redundancy will reduce  0.009316770186335699
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.3478260869565217,  1.0062111801242235
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.2298136645962734,  1.1180124223602483
	walk terminate 1 spend time 5.064954042434692
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.204968944099379,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.2236024844720497,  1.124223602484472
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.1987577639751552,  1.15527950310559
	walk terminate 1 spend time 5.288759708404541
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		186, 193, 156, 194, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				41, 29, 35, 35, 


	preparing two sides time :  0.0005116462707519531
	Initialize BitList time :  4.2438507080078125e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 193, 156

	before terminate 1 the average redundancy rate is:  1.0838509316770186
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.1801242236024845,  0.9875776397515528
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.1925465838509317,  0.9751552795031055
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0683229813664596,  1.1055900621118013
	walk terminate 1 spend time 5.276745557785034
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		186, 172, 178, 194, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				41, 28, 36, 35, 


	preparing two sides time :  0.0005118846893310547
	Initialize BitList time :  5.14984130859375e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 178, 194

	before terminate 1 the average redundancy rate is:  1.1552795031055902
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1428571428571428,  1.1677018633540373
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.124223602484472,  1.186335403726708
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.1925465838509317,  1.1180124223602483
	walk terminate 1 spend time 5.253393650054932
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.062111801242236,  1.2546583850931676
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.2422360248447204,  1.0683229813664596
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.0372670807453417,  1.2484472049689441
	walk terminate 1 spend time 5.258115768432617
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		186, 172, 167, 201, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 26.150890827178955
partition_len_list
[186, 172, 167, 201]
random_init_graph_partition selection method range initialization spend 26.151416540145874
time for parepare:  0.00011897087097167969
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0006999969482421875
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0004956722259521484
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001347064971923828
----------------------check_connections_block total spend ----------------------------- 0.0032930374145507812
generate_one_block  0.031057119369506836
generate_one_block  0.001257181167602539
generate_one_block  0.0011138916015625
generate_one_block  0.0014252662658691406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019974708557128906
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.0008268356323242188
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0006234645843505859
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0003936290740966797
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.00043582916259765625
----------------------check_connections_block total spend ----------------------------- 0.004660844802856445
generate_one_block  0.018782615661621094
generate_one_block  0.0014624595642089844
generate_one_block  0.0014023780822753906
generate_one_block  0.0014693737030029297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008471012115478516
gen group dst list time:  7.557868957519531e-05
time for parepare:  0.0007436275482177734
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00045108795166015625
mini_batch_src_global generation:  0.0004425048828125
r_  generation:  0.0011909008026123047
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.0011379718780517578
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0011713504791259766
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.001230001449584961
----------------------check_connections_block total spend ----------------------------- 0.009172439575195312
generate_one_block  0.00404810905456543
generate_one_block  0.007323503494262695
generate_one_block  0.006937742233276367
generate_one_block  0.005892038345336914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009677886962890625  GigaBytes
Max Memory Allocated: 0.017302989959716797  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21821.796875, 'VmHWM': 4616.7109375, 'VmRSS': 4616.7109375}
connection checking time:  0.013833284378051758
block generation total time  0.047318220138549805
average batch blocks generation time:  0.011829555034637451
block dataloader generation time/epoch 26.271464109420776
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009050846099853516  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5859375, 'VmHWM': 4618.96484375, 'VmRSS': 4618.96484375}
torch.Size([1555, 1433])
torch.Size([722, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009291648864746094  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5859375, 'VmHWM': 4618.96484375, 'VmRSS': 4618.96484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00844573974609375  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5859375, 'VmHWM': 4619.48046875, 'VmRSS': 4619.48046875}
torch.Size([1442, 1433])
torch.Size([667, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008667945861816406  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5859375, 'VmHWM': 4619.48046875, 'VmRSS': 4619.48046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.009049415588378906  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5859375, 'VmHWM': 4619.5859375, 'VmRSS': 4619.5859375}
torch.Size([1424, 1433])
torch.Size([661, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00926971435546875  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5859375, 'VmHWM': 4619.5859375, 'VmRSS': 4619.5859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00895071029663086  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5703125, 'VmHWM': 4619.5859375, 'VmRSS': 4619.58203125}
torch.Size([1536, 1433])
torch.Size([710, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00919342041015625  GigaBytes
Max Memory Allocated: 0.01782083511352539  GigaBytes

{'VmPeak': 21885.796875, 'VmSize': 21824.5703125, 'VmHWM': 4619.5859375, 'VmRSS': 4619.58203125}
{'VmPeak': 21885.796875, 'VmSize': 21824.5703125, 'VmHWM': 4619.5859375, 'VmRSS': 4619.58203125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020227015018463135 |0.00067138671875 |0.005605220794677734 |0.0002072453498840332 |0.003083348274230957 |0.0017812252044677734 |
----------------------------------------------------------pseudo_mini_loss sum 2.51667857170105
{'VmPeak': 21885.796875, 'VmSize': 21824.5703125, 'VmHWM': 4619.5859375, 'VmRSS': 4619.58203125}
Total (block generation + training)time/epoch 26.40429711341858
Training time/epoch 0.1321423053741455
Training time without block to device /epoch 0.1294567584991455
Training time without total dataloading part /epoch 0.03736448287963867
load block tensor time/epoch 0.08090806007385254
block to device time/epoch 0.002685546875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9443
Number of first layer input nodes during this epoch:  5957
