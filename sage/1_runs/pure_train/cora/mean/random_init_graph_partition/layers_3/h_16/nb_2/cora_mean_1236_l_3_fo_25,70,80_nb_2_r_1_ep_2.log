main start at this time 1648596622.6422524
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20801.35546875, 'VmSize': 20801.35546875, 'VmHWM': 3612.0, 'VmRSS': 3612.0}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013725757598876953
global_2_local 7.534027099609375e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00021910667419433594
before graph partition 
		355, 341, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002841949462890625
	Initialize BitList time :  1.9788742065429688e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 355, 341

	before terminate 1 the average redundancy rate is:  1.0807453416149069
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.1024844720496894,  1.0590062111801242
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.1024844720496894,  1.0590062111801242
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  1.1024844720496894,  1.0590062111801242
	walk terminate 1 spend time 4.234532594680786
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		341, 355, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.238713979721069
partition_len_list
[341, 355]
random_init_graph_partition selection method range initialization spend 4.239141941070557
time for parepare:  0.00015592575073242188
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0012066364288330078
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.012148141860961914
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.00020575523376464844
----------------------check_connections_block total spend ----------------------------- 0.014786481857299805
generate_one_block  0.015912771224975586
generate_one_block  0.0013918876647949219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010271072387695312
gen group dst list time:  3.933906555175781e-05
time for parepare:  0.0003829002380371094
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0003371238708496094
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.0007364749908447266
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0007097721099853516
----------------------check_connections_block total spend ----------------------------- 0.0032584667205810547
generate_one_block  0.003052234649658203
generate_one_block  0.002148866653442383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006382465362548828
gen group dst list time:  6.127357482910156e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0006284713745117188
mini_batch_src_global generation:  0.00042724609375
r_  generation:  0.0018656253814697266
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.000362396240234375
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0018017292022705078
----------------------check_connections_block total spend ----------------------------- 0.006961345672607422
generate_one_block  0.007577180862426758
generate_one_block  0.0029723644256591797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20807.63671875, 'VmSize': 20656.05078125, 'VmHWM': 3619.6953125, 'VmRSS': 3619.6953125}
connection checking time:  0.010219812393188477
block generation total time  0.015750646591186523
average batch blocks generation time:  0.007875323295593262
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.010722637176513672  GigaBytes
Max Memory Allocated: 0.010722637176513672  GigaBytes

{'VmPeak': 20944.98828125, 'VmSize': 20944.98828125, 'VmHWM': 3909.4609375, 'VmRSS': 3909.4609375}
torch.Size([1963, 1433])
torch.Size([1214, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2322998046875 GB
    Memory Allocated: 0.011127471923828125  GigaBytes
Max Memory Allocated: 0.01114034652709961  GigaBytes

{'VmPeak': 21716.4921875, 'VmSize': 21716.4765625, 'VmHWM': 4603.2734375, 'VmRSS': 4603.2734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010417461395263672  GigaBytes
Max Memory Allocated: 0.02083873748779297  GigaBytes

{'VmPeak': 21790.7109375, 'VmSize': 21758.71484375, 'VmHWM': 4614.40234375, 'VmRSS': 4614.40234375}
torch.Size([1873, 1433])
torch.Size([1102, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010798454284667969  GigaBytes
Max Memory Allocated: 0.02083873748779297  GigaBytes

{'VmPeak': 21790.7109375, 'VmSize': 21758.71484375, 'VmHWM': 4614.40234375, 'VmRSS': 4614.40234375}
{'VmPeak': 21790.7109375, 'VmSize': 21758.71484375, 'VmHWM': 4614.79296875, 'VmRSS': 4614.79296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008340835571289062 |0.17879998683929443 |0.4041106700897217 |0.0002830028533935547 |0.005352020263671875 |0.0029087066650390625 |
----------------------------------------------------------pseudo_mini_loss sum 3.207707166671753
{'VmPeak': 21790.7109375, 'VmSize': 21758.71484375, 'VmHWM': 4614.79296875, 'VmRSS': 4614.79296875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6848
Number of first layer input nodes during this epoch:  3836
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010907173156738281  GigaBytes
Max Memory Allocated: 0.02083873748779297  GigaBytes

{'VmPeak': 21790.7109375, 'VmSize': 21758.71484375, 'VmHWM': 4615.16796875, 'VmRSS': 4615.16796875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006103515625
global_2_local 9.989738464355469e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.869171142578125e-05
before graph partition 
		356, 337, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0003724098205566406
	Initialize BitList time :  2.4557113647460938e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 356, 337

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0776397515527951,  1.0714285714285714
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.093167701863354,  1.0559006211180124
						 current side  0
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906831,  1.0745341614906831,  1.0745341614906831
	walk terminate 1 spend time 5.053109884262085
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0559006211180124,  1.0900621118012421
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0838509316770186,  1.065217391304348
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0559006211180124,  1.0900621118012421
	walk terminate 1 spend time 5.27099084854126
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		340, 351, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 10.328336477279663
partition_len_list
[340, 351]
random_init_graph_partition selection method range initialization spend 10.329004764556885
time for parepare:  0.0002079010009765625
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0012595653533935547
mini_batch_src_global generation:  0.00016498565673828125
r_  generation:  0.0012159347534179688
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  9.846687316894531e-05
r_  generation:  0.00028967857360839844
----------------------check_connections_block total spend ----------------------------- 0.005581378936767578
generate_one_block  0.027637958526611328
generate_one_block  0.001432180404663086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0016121864318847656
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.0006456375122070312
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0008280277252197266
mini_batch_src_global generation:  0.00029397010803222656
r_  generation:  0.0007812976837158203
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0007698535919189453
----------------------check_connections_block total spend ----------------------------- 0.004441499710083008
generate_one_block  0.0019779205322265625
generate_one_block  0.002379894256591797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006589889526367188
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.00020003318786621094
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0005779266357421875
mini_batch_src_global generation:  0.0003094673156738281
r_  generation:  0.0017216205596923828
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0019311904907226562
----------------------check_connections_block total spend ----------------------------- 0.006395101547241211
generate_one_block  0.011731386184692383
generate_one_block  0.0031707286834716797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010907173156738281  GigaBytes
Max Memory Allocated: 0.02083873748779297  GigaBytes

{'VmPeak': 21823.23046875, 'VmSize': 21822.73046875, 'VmHWM': 4616.43359375, 'VmRSS': 4616.18359375}
connection checking time:  0.010836601257324219
block generation total time  0.019259929656982422
average batch blocks generation time:  0.009629964828491211
block dataloader generation time/epoch 10.407079458236694
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010527610778808594  GigaBytes
Max Memory Allocated: 0.02083873748779297  GigaBytes

{'VmPeak': 21832.7265625, 'VmSize': 21832.7265625, 'VmHWM': 4626.46484375, 'VmRSS': 4626.46484375}
torch.Size([1828, 1433])
torch.Size([1057, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010894775390625  GigaBytes
Max Memory Allocated: 0.02083873748779297  GigaBytes

{'VmPeak': 21832.7265625, 'VmSize': 21832.7265625, 'VmHWM': 4626.46484375, 'VmRSS': 4626.46484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011297225952148438  GigaBytes
Max Memory Allocated: 0.020994186401367188  GigaBytes

{'VmPeak': 21833.5078125, 'VmSize': 21833.5078125, 'VmHWM': 4628.07421875, 'VmRSS': 4628.07421875}
torch.Size([1971, 1433])
torch.Size([1207, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011701583862304688  GigaBytes
Max Memory Allocated: 0.020994186401367188  GigaBytes

{'VmPeak': 21833.5078125, 'VmSize': 21833.5078125, 'VmHWM': 4628.07421875, 'VmRSS': 4628.07421875}
{'VmPeak': 21833.5078125, 'VmSize': 21833.5078125, 'VmHWM': 4628.07421875, 'VmRSS': 4628.07421875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02851581573486328 |0.001278996467590332 |0.007300376892089844 |0.00036466121673583984 |0.00527191162109375 |0.002137422561645508 |
----------------------------------------------------------pseudo_mini_loss sum 2.3872435092926025
{'VmPeak': 21833.5078125, 'VmSize': 21833.5078125, 'VmHWM': 4628.07421875, 'VmRSS': 4628.07421875}
Total (block generation + training)time/epoch 10.49960446357727
Training time/epoch 0.09176230430603027
Training time without block to device /epoch 0.08920431137084961
Training time without total dataloading part /epoch 0.028011322021484375
load block tensor time/epoch 0.05703163146972656
block to device time/epoch 0.002557992935180664
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6754
Number of first layer input nodes during this epoch:  3799
