main start at this time 1648596707.5308437
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20823.5625, 'VmSize': 20810.859375, 'VmHWM': 3622.1015625, 'VmRSS': 3622.1015625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009639263153076172
global_2_local 9.298324584960938e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0001010894775390625
before graph partition 
		79, 92, 98, 132, 83, 73, 127, 77, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002033710479736328
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 79, 92

	before terminate 1 the average redundancy rate is:  1.062111801242236
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  0.9813664596273292,  1.1428571428571428
	walk terminate 1 spend time 3.96337890625
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 92, 98, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005044937133789062
	Initialize BitList time :  3.62396240234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 92, 98

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.226361274719238
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
	walk terminate 1 spend time 4.282449245452881
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		79, 86, 103, 132, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 15, 21, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004849433898925781
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 103, 132

	before terminate 1 the average redundancy rate is:  1.4596273291925466
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894235
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.453416149068323,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.1677018633540373,  1.6770186335403727
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.279503105590062,  1.565217391304348
	walk terminate 1 spend time 4.020126819610596
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.515527950310559,  1.3167701863354038
						 current side  0
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.3043478260869565,  1.4906832298136645
						 current side  1
			 redundancy will reduce  0.06211180124223614
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503104,  1.5031055900621118,  1.2919254658385093
	walk terminate 1 spend time 4.178642511367798
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		79, 86, 104, 121, 83, 73, 127, 77, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 15, 16, 23, 18, 18, 18, 14, 


	preparing two sides time :  0.0004818439483642578
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 121, 83

	before terminate 1 the average redundancy rate is:  1.2670807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.5031055900621118,  1.031055900621118
	walk terminate 1 spend time 4.167471170425415
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 121, 73, 127, 77, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 15, 16, 18, 23, 18, 18, 14, 


	preparing two sides time :  0.0006809234619140625
	Initialize BitList time :  0.00012683868408203125
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 121, 73

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.5031055900621118,  0.906832298136646
	walk terminate 1 spend time 4.226497650146484
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.0004930496215820312
	Initialize BitList time :  3.814697265625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 121, 127

	before terminate 1 the average redundancy rate is:  1.5403726708074534
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5403726708074534,  1.5031055900621118,  1.5776397515527951
	walk terminate 1 spend time 4.1523754596710205
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 127, 77, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 15, 16, 18, 18, 23, 18, 14, 


	preparing two sides time :  0.00047469139099121094
	Initialize BitList time :  3.7670135498046875e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 127, 77

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.5776397515527951,  0.9565217391304348
	walk terminate 1 spend time 4.052669525146484
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		79, 86, 104, 83, 73, 121, 77, 127, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.29446458816528
partition_len_list
[79, 86, 104, 83, 73, 121, 77, 127]
random_init_graph_partition selection method range initialization spend 37.294933795928955
time for parepare:  0.00011539459228515625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0007476806640625
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.01134347915649414
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  0.00010013580322265625
----------------------check_connections_block total spend ----------------------------- 0.014487266540527344
generate_one_block  0.01277613639831543
generate_one_block  0.0013470649719238281
generate_one_block  0.0011293888092041016
generate_one_block  0.001115560531616211
generate_one_block  0.001081705093383789
generate_one_block  0.001127004623413086
generate_one_block  0.0011031627655029297
generate_one_block  0.0011281967163085938
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0022246837615966797
gen group dst list time:  0.00011730194091796875
time for parepare:  0.0004093647003173828
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002295970916748047
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00020837783813476562
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00022268295288085938
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002205371856689453
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00029778480529785156
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002071857452392578
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0004048347473144531
----------------------check_connections_block total spend ----------------------------- 0.004826068878173828
generate_one_block  0.002660512924194336
generate_one_block  0.0013079643249511719
generate_one_block  0.0013093948364257812
generate_one_block  0.0013203620910644531
generate_one_block  0.0013151168823242188
generate_one_block  0.0016245841979980469
generate_one_block  0.0012981891632080078
generate_one_block  0.007799386978149414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007238388061523438
gen group dst list time:  0.00010514259338378906
time for parepare:  0.0006344318389892578
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00039768218994140625
mini_batch_src_global generation:  0.0002925395965576172
r_  generation:  0.0007956027984619141
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0006320476531982422
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006680488586425781
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0006933212280273438
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0008769035339355469
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0009200572967529297
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0006396770477294922
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.001226186752319336
----------------------check_connections_block total spend ----------------------------- 0.012306690216064453
generate_one_block  0.002073049545288086
generate_one_block  0.0017604827880859375
generate_one_block  0.0017762184143066406
generate_one_block  0.0019161701202392578
generate_one_block  0.0020542144775390625
generate_one_block  0.0029897689819335938
generate_one_block  0.0018393993377685547
generate_one_block  0.0024912357330322266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20823.5625, 'VmSize': 20658.70703125, 'VmHWM': 3623.16796875, 'VmRSS': 3623.16796875}
connection checking time:  0.01713275909423828
block generation total time  0.03553605079650879
average batch blocks generation time:  0.004442006349563599
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.006001472473144531  GigaBytes
Max Memory Allocated: 0.006001472473144531  GigaBytes

{'VmPeak': 21006.35546875, 'VmSize': 20977.86328125, 'VmHWM': 3911.2890625, 'VmRSS': 3911.2890625}
torch.Size([1086, 1433])
torch.Size([428, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006138324737548828  GigaBytes
Max Memory Allocated: 0.006165504455566406  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21749.07421875, 'VmHWM': 4604.29296875, 'VmRSS': 4604.29296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.004915714263916016  GigaBytes
Max Memory Allocated: 0.010694026947021484  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21753.7890625, 'VmHWM': 4610.484375, 'VmRSS': 4610.484375}
torch.Size([850, 1433])
torch.Size([330, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005030632019042969  GigaBytes
Max Memory Allocated: 0.010694026947021484  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21753.7890625, 'VmHWM': 4610.484375, 'VmRSS': 4610.484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006176471710205078  GigaBytes
Max Memory Allocated: 0.010694026947021484  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21754.3984375, 'VmHWM': 4612.19921875, 'VmRSS': 4612.19921875}
torch.Size([961, 1433])
torch.Size([344, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006298065185546875  GigaBytes
Max Memory Allocated: 0.010694026947021484  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21754.3984375, 'VmHWM': 4612.19921875, 'VmRSS': 4612.19921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005467414855957031  GigaBytes
Max Memory Allocated: 0.011243820190429688  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21754.3984375, 'VmHWM': 4612.19921875, 'VmRSS': 4612.19921875}
torch.Size([953, 1433])
torch.Size([407, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005599021911621094  GigaBytes
Max Memory Allocated: 0.011243820190429688  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21754.3984375, 'VmHWM': 4612.19921875, 'VmRSS': 4612.19921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0067577362060546875  GigaBytes
Max Memory Allocated: 0.011820316314697266  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21755.671875, 'VmHWM': 4613.390625, 'VmRSS': 4613.390625}
torch.Size([1194, 1433])
torch.Size([474, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006905078887939453  GigaBytes
Max Memory Allocated: 0.011820316314697266  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21755.671875, 'VmHWM': 4613.390625, 'VmRSS': 4613.390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007176876068115234  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21756.09765625, 'VmHWM': 4614.4453125, 'VmRSS': 4614.4453125}
torch.Size([1272, 1433])
torch.Size([539, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007353305816650391  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21756.09765625, 'VmHWM': 4614.4453125, 'VmRSS': 4614.4453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005401611328125  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21756.09765625, 'VmHWM': 4614.5703125, 'VmRSS': 4614.5703125}
torch.Size([941, 1433])
torch.Size([364, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005520343780517578  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21756.09765625, 'VmHWM': 4614.578125, 'VmRSS': 4614.578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008168697357177734  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21757.1015625, 'VmHWM': 4615.296875, 'VmRSS': 4615.296875}
torch.Size([1456, 1433])
torch.Size([726, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008390426635742188  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21757.1015625, 'VmHWM': 4615.296875, 'VmRSS': 4615.296875}
{'VmPeak': 21759.16796875, 'VmSize': 21757.1015625, 'VmHWM': 4615.55078125, 'VmRSS': 4615.55078125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007511615753173828 |0.047347843647003174 |0.09982919692993164 |0.00014677643775939941 |0.0034721791744232178 |0.00220489501953125 |
----------------------------------------------------------pseudo_mini_loss sum 3.545564651489258
{'VmPeak': 21759.16796875, 'VmSize': 21757.1015625, 'VmHWM': 4615.55078125, 'VmRSS': 4615.55078125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13075
Number of first layer input nodes during this epoch:  8713
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21759.16796875, 'VmSize': 21757.1015625, 'VmHWM': 4615.55078125, 'VmRSS': 4615.55078125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005466938018798828
global_2_local 9.34600830078125e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.869171142578125e-05
before graph partition 
		99, 126, 76, 94, 84, 98, 119, 57, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00027942657470703125
	Initialize BitList time :  1.4066696166992188e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 99, 126

	before terminate 1 the average redundancy rate is:  1.3975155279503106
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  1.2298136645962734,  1.565217391304348
	walk terminate 1 spend time 4.91619873046875
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		99, 126, 76, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005483627319335938
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 76

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.565217391304348,  0.9440993788819876
	walk terminate 1 spend time 4.990875244140625
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 126, 94, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004901885986328125
	Initialize BitList time :  3.981590270996094e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 126, 94

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.565217391304348,  1.1677018633540373
	walk terminate 1 spend time 4.990875959396362
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 126, 84, 98, 119, 57, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047659873962402344
	Initialize BitList time :  4.4345855712890625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 84

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.565217391304348,  1.0434782608695652
	walk terminate 1 spend time 5.076509714126587
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 126, 98, 119, 57, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004904270172119141
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 126, 98

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.565217391304348,  1.2173913043478262
	walk terminate 1 spend time 5.0409252643585205
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 126, 119, 57, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004923343658447266
	Initialize BitList time :  3.7670135498046875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 126, 119

	before terminate 1 the average redundancy rate is:  1.5217391304347827
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.565217391304348,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.7391304347826086,  1.2919254658385093
	walk terminate 1 spend time 4.933687925338745
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.1180124223602483,  1.9130434782608696
						 current side  1
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 14
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.937888198757764,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.484472049689441,  1.763975155279503,  1.204968944099379
	walk terminate 1 spend time 4.935301780700684
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		99, 76, 94, 84, 98, 97, 142, 57, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 8, 28, 14, 


	preparing two sides time :  0.0004987716674804688
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 142, 57

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.7267080745341614,  0.7453416149068323
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.68944099378882,  0.782608695652174
	walk terminate 1 spend time 5.011119604110718
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		99, 76, 94, 84, 98, 97, 63, 136, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 39.921842098236084
partition_len_list
[99, 76, 94, 84, 98, 97, 63, 136]
random_init_graph_partition selection method range initialization spend 39.92248558998108
time for parepare:  0.00017523765563964844
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0008063316345214844
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0005207061767578125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00011920928955078125
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.005060672760009766
generate_one_block  0.019293546676635742
generate_one_block  0.0012700557708740234
generate_one_block  0.0014376640319824219
generate_one_block  0.0011594295501708984
generate_one_block  0.001165628433227539
generate_one_block  0.001135110855102539
generate_one_block  0.0011548995971679688
generate_one_block  0.0011856555938720703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001882791519165039
gen group dst list time:  6.413459777832031e-05
time for parepare:  0.0007989406585693359
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00036334991455078125
mini_batch_src_global generation:  0.00013375282287597656
r_  generation:  0.00040721893310546875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.000278472900390625
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00021958351135253906
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.000232696533203125
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0003173351287841797
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00031495094299316406
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00017976760864257812
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0004363059997558594
----------------------check_connections_block total spend ----------------------------- 0.0061223506927490234
generate_one_block  0.0015230178833007812
generate_one_block  0.0013430118560791016
generate_one_block  0.0013620853424072266
generate_one_block  0.0013260841369628906
generate_one_block  0.0014958381652832031
generate_one_block  0.0014591217041015625
generate_one_block  0.0014047622680664062
generate_one_block  0.001645803451538086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011816024780273438
gen group dst list time:  0.00011181831359863281
time for parepare:  0.0006895065307617188
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.0007479190826416016
mini_batch_src_global generation:  0.0003960132598876953
r_  generation:  0.0011014938354492188
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0003936290740966797
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0006961822509765625
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0007042884826660156
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006837844848632812
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00038623809814453125
r_  generation:  0.0009441375732421875
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.0024280548095703125
r_  generation:  0.0007843971252441406
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.0008108615875244141
r_  generation:  0.0013086795806884766
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.0006258487701416016
mini_batch_src_global generation:  0.00031876564025878906
r_  generation:  0.002521514892578125
----------------------check_connections_block total spend ----------------------------- 0.02064371109008789
generate_one_block  0.005474567413330078
generate_one_block  0.003336668014526367
generate_one_block  0.0030329227447509766
generate_one_block  0.0031762123107910156
generate_one_block  0.0033266544342041016
generate_one_block  0.002744436264038086
generate_one_block  0.0024704933166503906
generate_one_block  0.0051937103271484375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008610248565673828  GigaBytes
Max Memory Allocated: 0.013523101806640625  GigaBytes

{'VmPeak': 21821.3671875, 'VmSize': 21821.3671875, 'VmHWM': 4616.0859375, 'VmRSS': 4616.0859375}
connection checking time:  0.026766061782836914
block generation total time  0.04031538963317871
average batch blocks generation time:  0.005039423704147339
block dataloader generation time/epoch 40.03969645500183
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007868766784667969  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1953125, 'VmHWM': 4620.5234375, 'VmRSS': 4620.5234375}
torch.Size([1335, 1433])
torch.Size([624, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00805807113647461  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1953125, 'VmHWM': 4620.5234375, 'VmRSS': 4620.5234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005648136138916016  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1953125, 'VmHWM': 4620.89453125, 'VmRSS': 4620.89453125}
torch.Size([921, 1433])
torch.Size([372, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0057697296142578125  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1953125, 'VmHWM': 4620.89453125, 'VmRSS': 4620.89453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0059108734130859375  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1953125, 'VmHWM': 4621.3515625, 'VmRSS': 4621.3515625}
torch.Size([970, 1433])
torch.Size([370, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006037235260009766  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.35546875, 'VmRSS': 4621.34765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006139278411865234  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.46875, 'VmRSS': 4621.46875}
torch.Size([1013, 1433])
torch.Size([367, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006261348724365234  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.46875, 'VmRSS': 4621.46875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007289409637451172  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.46875, 'VmRSS': 4621.46875}
torch.Size([1227, 1433])
torch.Size([524, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007456302642822266  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.46875, 'VmRSS': 4621.46875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006255149841308594  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.56640625, 'VmRSS': 4621.56640625}
torch.Size([1034, 1433])
torch.Size([395, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006392478942871094  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.56640625, 'VmRSS': 4621.56640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005650043487548828  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.6171875, 'VmRSS': 4621.6171875}
torch.Size([922, 1433])
torch.Size([349, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005758762359619141  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.1953125, 'VmSize': 21826.1796875, 'VmHWM': 4621.6171875, 'VmRSS': 4621.6171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00824117660522461  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.5546875, 'VmSize': 21826.5546875, 'VmHWM': 4621.75, 'VmRSS': 4621.75}
torch.Size([1404, 1433])
torch.Size([668, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008453369140625  GigaBytes
Max Memory Allocated: 0.0156097412109375  GigaBytes

{'VmPeak': 21826.5546875, 'VmSize': 21826.5546875, 'VmHWM': 4621.75, 'VmRSS': 4621.75}
{'VmPeak': 21826.5546875, 'VmSize': 21826.5546875, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007031857967376709 |0.0006621181964874268 |0.0054083168506622314 |0.00018480420112609863 |0.002951681613922119 |0.003170013427734375 |
----------------------------------------------------------pseudo_mini_loss sum 2.4589438438415527
{'VmPeak': 21826.5546875, 'VmSize': 21826.5546875, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
Total (block generation + training)time/epoch 40.187321186065674
Training time/epoch 0.14737510681152344
Training time without block to device /epoch 0.14207816123962402
Training time without total dataloading part /epoch 0.07152843475341797
load block tensor time/epoch 0.05625486373901367
block to device time/epoch 0.005296945571899414
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13242
Number of first layer input nodes during this epoch:  8826
