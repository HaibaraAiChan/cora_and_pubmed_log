main start at this time 1648597847.492705
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20801.79296875, 'VmSize': 20801.79296875, 'VmHWM': 3612.6640625, 'VmRSS': 3612.6640625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00109100341796875
global_2_local 9.34600830078125e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.870529174804688e-05
before graph partition 
		122, 70, 94, 77, 90, 95, 115, 85, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002079010009765625
	Initialize BitList time :  1.2636184692382812e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 122, 70

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
	walk terminate 1 spend time 4.0628502368927
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 122, 94, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002868175506591797
	Initialize BitList time :  2.0742416381835938e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 122, 94

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
	walk terminate 1 spend time 4.1449408531188965
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 122, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004813671112060547
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 122, 77

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
	walk terminate 1 spend time 4.048828363418579
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 122, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048661231994628906
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 122, 90

	before terminate 1 the average redundancy rate is:  1.3167701863354035
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
	walk terminate 1 spend time 4.161744594573975
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 122, 95, 115, 85, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005064010620117188
	Initialize BitList time :  3.886222839355469e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 122, 95

	before terminate 1 the average redundancy rate is:  1.3478260869565217
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.515527950310559,  1.1801242236024845
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.133979797363281
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.092458963394165
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 132, 115, 85, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 15, 21, 18, 14, 


	preparing two sides time :  0.00044417381286621094
	Initialize BitList time :  3.910064697265625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 132, 115

	before terminate 1 the average redundancy rate is:  1.5341614906832297
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5341614906832297,  1.639751552795031,  1.4285714285714286
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.208814382553101
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.4906832298136645,  1.565217391304348
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.950310559006211,  1.1055900621118013
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.208968162536621
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 103, 143, 85, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 15, 19, 20, 14, 


	preparing two sides time :  0.0005125999450683594
	Initialize BitList time :  8.678436279296875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 143, 85

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
	walk terminate 1 spend time 4.203760147094727
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 84, 103, 85, 143, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.29067516326904
partition_len_list
[70, 94, 77, 90, 84, 103, 85, 143]
random_init_graph_partition selection method range initialization spend 37.29128551483154
time for parepare:  0.00017642974853515625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0011713504791259766
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.012091398239135742
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  5.888938903808594e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002758502960205078
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.153915405273438e-05
----------------------check_connections_block total spend ----------------------------- 0.016185760498046875
generate_one_block  0.01286172866821289
generate_one_block  0.0011010169982910156
generate_one_block  0.000997781753540039
generate_one_block  0.0009744167327880859
generate_one_block  0.0009932518005371094
generate_one_block  0.0010137557983398438
generate_one_block  0.0010483264923095703
generate_one_block  0.0010230541229248047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021228790283203125
gen group dst list time:  0.00012350082397460938
time for parepare:  0.0003249645233154297
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0005013942718505859
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00017523765563964844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002052783966064453
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00022220611572265625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00020313262939453125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002658367156982422
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002124309539794922
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002982616424560547
----------------------check_connections_block total spend ----------------------------- 0.0045528411865234375
generate_one_block  0.0022156238555908203
generate_one_block  0.0012743473052978516
generate_one_block  0.0012521743774414062
generate_one_block  0.0013501644134521484
generate_one_block  0.001302480697631836
generate_one_block  0.004849910736083984
generate_one_block  0.0012454986572265625
generate_one_block  0.001356363296508789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006248950958251953
gen group dst list time:  9.846687316894531e-05
time for parepare:  0.0005500316619873047
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00041675567626953125
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0006010532379150391
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0006847381591796875
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0007255077362060547
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0006802082061767578
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.000637054443359375
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.000873565673828125
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006597042083740234
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0008587837219238281
----------------------check_connections_block total spend ----------------------------- 0.010953903198242188
generate_one_block  0.003133058547973633
generate_one_block  0.0018734931945800781
generate_one_block  0.0018858909606933594
generate_one_block  0.0019490718841552734
generate_one_block  0.001756429672241211
generate_one_block  0.002050638198852539
generate_one_block  0.0018162727355957031
generate_one_block  0.002016782760620117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20807.359375, 'VmSize': 20656.2109375, 'VmHWM': 3620.15234375, 'VmRSS': 3620.15234375}
connection checking time:  0.015506744384765625
block generation total time  0.03132820129394531
average batch blocks generation time:  0.003916025161743164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.0051746368408203125  GigaBytes
Max Memory Allocated: 0.0051746368408203125  GigaBytes

{'VmPeak': 21010.390625, 'VmSize': 20978.39453125, 'VmHWM': 3910.96875, 'VmRSS': 3910.96875}
torch.Size([899, 1433])
torch.Size([337, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0053691864013671875  GigaBytes
Max Memory Allocated: 0.005419731140136719  GigaBytes

{'VmPeak': 21758.59765625, 'VmSize': 21753.26171875, 'VmHWM': 4608.83203125, 'VmRSS': 4608.83203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006003379821777344  GigaBytes
Max Memory Allocated: 0.010781288146972656  GigaBytes

{'VmPeak': 21758.6953125, 'VmSize': 21758.6953125, 'VmHWM': 4614.640625, 'VmRSS': 4614.640625}
torch.Size([987, 1433])
torch.Size([369, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0062255859375  GigaBytes
Max Memory Allocated: 0.010781288146972656  GigaBytes

{'VmPeak': 21758.6953125, 'VmSize': 21758.6953125, 'VmHWM': 4614.640625, 'VmRSS': 4614.640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006474018096923828  GigaBytes
Max Memory Allocated: 0.011720657348632812  GigaBytes

{'VmPeak': 21759.17578125, 'VmSize': 21759.17578125, 'VmHWM': 4616.87109375, 'VmRSS': 4616.87109375}
torch.Size([1075, 1433])
torch.Size([410, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006705284118652344  GigaBytes
Max Memory Allocated: 0.011720657348632812  GigaBytes

{'VmPeak': 21759.17578125, 'VmSize': 21759.17578125, 'VmHWM': 4616.87109375, 'VmRSS': 4616.87109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005783557891845703  GigaBytes
Max Memory Allocated: 0.011720657348632812  GigaBytes

{'VmPeak': 21759.17578125, 'VmSize': 21759.17578125, 'VmHWM': 4617.0625, 'VmRSS': 4617.0625}
torch.Size([946, 1433])
torch.Size([370, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006002902984619141  GigaBytes
Max Memory Allocated: 0.011720657348632812  GigaBytes

{'VmPeak': 21759.17578125, 'VmSize': 21759.17578125, 'VmHWM': 4617.0625, 'VmRSS': 4617.0625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0056171417236328125  GigaBytes
Max Memory Allocated: 0.011720657348632812  GigaBytes

{'VmPeak': 21759.17578125, 'VmSize': 21759.17578125, 'VmHWM': 4617.5234375, 'VmRSS': 4617.5234375}
torch.Size([915, 1433])
torch.Size([351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005823612213134766  GigaBytes
Max Memory Allocated: 0.011720657348632812  GigaBytes

{'VmPeak': 21759.17578125, 'VmSize': 21759.17578125, 'VmHWM': 4617.5234375, 'VmRSS': 4617.5234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007193565368652344  GigaBytes
Max Memory Allocated: 0.012052059173583984  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.03515625, 'VmRSS': 4618.03515625}
torch.Size([1209, 1433])
torch.Size([505, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007479190826416016  GigaBytes
Max Memory Allocated: 0.012052059173583984  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.03515625, 'VmRSS': 4618.03515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005741596221923828  GigaBytes
Max Memory Allocated: 0.012175559997558594  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.140625, 'VmRSS': 4618.140625}
torch.Size([938, 1433])
torch.Size([376, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005959987640380859  GigaBytes
Max Memory Allocated: 0.012175559997558594  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.20703125, 'VmRSS': 4618.20703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006970882415771484  GigaBytes
Max Memory Allocated: 0.012175559997558594  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.20703125, 'VmRSS': 4618.20703125}
torch.Size([1167, 1433])
torch.Size([472, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007265567779541016  GigaBytes
Max Memory Allocated: 0.012175559997558594  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.20703125, 'VmRSS': 4618.20703125}
{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.51953125, 'VmRSS': 4618.51953125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009053617715835571 |0.046081602573394775 |0.10130646824836731 |0.0001653432846069336 |0.0029234886169433594 |0.002351522445678711 |
----------------------------------------------------------pseudo_mini_loss sum 3.6825811862945557
{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.51953125, 'VmRSS': 4618.51953125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12072
Number of first layer input nodes during this epoch:  8136
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007746696472167969  GigaBytes
Max Memory Allocated: 0.012175559997558594  GigaBytes

{'VmPeak': 21759.90625, 'VmSize': 21759.90625, 'VmHWM': 4618.51953125, 'VmRSS': 4618.51953125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004715919494628906
global_2_local 7.510185241699219e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.700920104980469e-05
before graph partition 
		94, 124, 76, 84, 83, 114, 81, 97, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021123886108398438
	Initialize BitList time :  1.2874603271484375e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 94, 124

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
	walk terminate 1 spend time 4.827996253967285
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		94, 124, 76, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004687309265136719
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 76

	before terminate 1 the average redundancy rate is:  1.2422360248447206
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.2546583850931676,  1.204968944099379
	walk terminate 1 spend time 5.060169219970703
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1925465838509317,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.3043478260869565,  1.15527950310559
	walk terminate 1 spend time 5.049540042877197
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		94, 93, 105, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 22, 14, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004940032958984375
	Initialize BitList time :  0.00010132789611816406
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 105, 84

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
	walk terminate 1 spend time 4.9937584400177
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 105, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 22, 18, 14, 18, 18, 18, 14, 


	preparing two sides time :  0.0004069805145263672
	Initialize BitList time :  3.814697265625e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 105, 83

	before terminate 1 the average redundancy rate is:  1.1677018633540373
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
	walk terminate 1 spend time 4.9947991371154785
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 105, 114, 81, 97, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 22, 18, 18, 14, 18, 18, 14, 


	preparing two sides time :  0.00048160552978515625
	Initialize BitList time :  4.1961669921875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 105, 114

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.3043478260869565,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
	walk terminate 1 spend time 4.950878381729126
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
	walk terminate 1 spend time 4.9757585525512695
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		94, 93, 84, 83, 85, 132, 81, 97, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 22, 18, 18, 10, 22, 18, 14, 


	preparing two sides time :  0.0005528926849365234
	Initialize BitList time :  6.318092346191406e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 132, 81

	before terminate 1 the average redundancy rate is:  1.3229813664596273
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
	walk terminate 1 spend time 5.041709661483765
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 132, 97, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 22, 18, 18, 10, 18, 22, 14, 


	preparing two sides time :  0.00039458274841308594
	Initialize BitList time :  3.4809112548828125e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 132, 97

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
	walk terminate 1 spend time 4.872143268585205
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 97, 132, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 44.79301714897156
partition_len_list
[94, 93, 84, 83, 85, 81, 97, 132]
random_init_graph_partition selection method range initialization spend 44.79351091384888
time for parepare:  0.00020194053649902344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.028918981552124023
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0003249645233154297
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.724761962890625e-05
----------------------check_connections_block total spend ----------------------------- 0.032608985900878906
generate_one_block  0.015310525894165039
generate_one_block  0.001299142837524414
generate_one_block  0.00135040283203125
generate_one_block  0.0010764598846435547
generate_one_block  0.0010943412780761719
generate_one_block  0.0011391639709472656
generate_one_block  0.0010602474212646484
generate_one_block  0.0010941028594970703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017769336700439453
gen group dst list time:  0.00010538101196289062
time for parepare:  0.0004394054412841797
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.007745504379272461
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.00026535987854003906
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.00029397010803222656
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00023818016052246094
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00019168853759765625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001862049102783203
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.00032901763916015625
----------------------check_connections_block total spend ----------------------------- 0.01227879524230957
generate_one_block  0.0015535354614257812
generate_one_block  0.0013391971588134766
generate_one_block  0.0014150142669677734
generate_one_block  0.0014109611511230469
generate_one_block  0.0013267993927001953
generate_one_block  0.001310586929321289
generate_one_block  0.0016024112701416016
generate_one_block  0.013640880584716797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01299142837524414
gen group dst list time:  0.00010609626770019531
time for parepare:  0.0004382133483886719
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.1275920867919922
mini_batch_src_global generation:  0.0004189014434814453
r_  generation:  0.0010154247283935547
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0007998943328857422
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0009164810180664062
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0008366107940673828
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0007712841033935547
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.000720977783203125
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0009400844573974609
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0010988712310791016
----------------------check_connections_block total spend ----------------------------- 0.14053606986999512
generate_one_block  0.002882242202758789
generate_one_block  0.0022029876708984375
generate_one_block  0.002048492431640625
generate_one_block  0.0018687248229980469
generate_one_block  0.0018534660339355469
generate_one_block  0.0016629695892333984
generate_one_block  0.001889944076538086
generate_one_block  0.002003192901611328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007746696472167969  GigaBytes
Max Memory Allocated: 0.012175559997558594  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.81640625, 'VmRSS': 4619.81640625}
connection checking time:  0.1528148651123047
block generation total time  0.04001140594482422
average batch blocks generation time:  0.005001425743103027
block dataloader generation time/epoch 45.06877326965332
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007754325866699219  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.92578125, 'VmRSS': 4619.92578125}
torch.Size([1182, 1433])
torch.Size([459, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008013725280761719  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.92578125, 'VmRSS': 4619.92578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006346225738525391  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([919, 1433])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006561279296875  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007256984710693359  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([1089, 1433])
torch.Size([429, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0074977874755859375  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0065021514892578125  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([948, 1433])
torch.Size([392, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006726264953613281  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006425380706787109  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([934, 1433])
torch.Size([330, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006625175476074219  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006098747253417969  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([873, 1433])
torch.Size([315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006289482116699219  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007002353668212891  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([1041, 1433])
torch.Size([410, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0072460174560546875  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007748126983642578  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
torch.Size([1180, 1433])
torch.Size([499, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.013959884643554688  GigaBytes

{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0044422149658203125 |0.0005579590797424316 |0.004123687744140625 |0.00015217065811157227 |0.003402620553970337 |0.0020101070404052734 |
----------------------------------------------------------pseudo_mini_loss sum 2.607886552810669
{'VmPeak': 21887.921875, 'VmSize': 21824.15625, 'VmHWM': 4619.9296875, 'VmRSS': 4619.9296875}
Total (block generation + training)time/epoch 45.18502926826477
Training time/epoch 0.11600756645202637
Training time without block to device /epoch 0.11154389381408691
Training time without total dataloading part /epoch 0.06343793869018555
load block tensor time/epoch 0.0355377197265625
block to device time/epoch 0.004463672637939453
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12102
Number of first layer input nodes during this epoch:  8166
