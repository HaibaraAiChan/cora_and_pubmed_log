main start at this time 1648598160.1247692
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20816.2578125, 'VmSize': 20803.609375, 'VmHWM': 3614.84765625, 'VmRSS': 3614.84765625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014145374298095703
global_2_local 0.00012135505676269531
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0003075599670410156
before graph partition 
		187, 164, 178, 203, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00021767616271972656
	Initialize BitList time :  1.5020370483398438e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 187, 164

	before terminate 1 the average redundancy rate is:  1.0900621118012421
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.1118012422360248,  1.0683229813664596
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.1366459627329193,  1.0434782608695652
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.1118012422360248,  1.0683229813664596
	walk terminate 1 spend time 4.146701812744141
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		172, 179, 178, 203, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005497932434082031
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 179, 178

	before terminate 1 the average redundancy rate is:  1.108695652173913
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1118012422360248,  0.906832298136646,  1.3167701863354038
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0962732919254656,  1.0745341614906831,  1.1180124223602483
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0931677018633539,  1.0186335403726707,  1.1677018633540373
	walk terminate 1 spend time 4.511322021484375
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.2236024844720497,  0.9565217391304348
						 current side  0
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.0248447204968945,  1.1304347826086956
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.0869565217391304,  1.0807453416149069
	walk terminate 1 spend time 4.3045125007629395
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		172, 174, 175, 203, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 35, 34, 35, 


	preparing two sides time :  0.0005249977111816406
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 175, 203

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.124223602484472,  1.2236024844720497
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.062111801242236,  1.2857142857142858
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0807453416149069,  1.2670807453416149
	walk terminate 1 spend time 4.311316251754761
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		172, 174, 174, 204, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 17.28447985649109
partition_len_list
[172, 174, 174, 204]
random_init_graph_partition selection method range initialization spend 17.285091400146484
time for parepare:  0.0001633167266845703
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.026539325714111328
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.022764205932617188
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  9.918212890625e-05
----------------------check_connections_block total spend ----------------------------- 0.051434993743896484
generate_one_block  0.006363391876220703
generate_one_block  0.0013132095336914062
generate_one_block  0.0011398792266845703
generate_one_block  0.0011627674102783203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018055438995361328
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.0007233619689941406
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.001111745834350586
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0005781650543212891
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0005595684051513672
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003962516784667969
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0005195140838623047
----------------------check_connections_block total spend ----------------------------- 0.0054280757904052734
generate_one_block  0.0024509429931640625
generate_one_block  0.0015537738800048828
generate_one_block  0.0014989376068115234
generate_one_block  0.001756429672241211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0042722225189208984
gen group dst list time:  8.869171142578125e-05
time for parepare:  0.0004296302795410156
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0013217926025390625
mini_batch_src_global generation:  0.0005457401275634766
r_  generation:  0.0013928413391113281
local_output_nid generation:  6.389617919921875e-05
local_in_edges_tensor generation:  0.0006389617919921875
mini_batch_src_global generation:  0.0004127025604248047
r_  generation:  0.001486063003540039
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00011944770812988281
r_  generation:  0.0011591911315917969
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.0015811920166015625
----------------------check_connections_block total spend ----------------------------- 0.01173257827758789
generate_one_block  0.003090381622314453
generate_one_block  0.0029408931732177734
generate_one_block  0.002692699432373047
generate_one_block  0.0031566619873046875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20816.2578125, 'VmSize': 20655.88671875, 'VmHWM': 3620.15625, 'VmRSS': 3620.15625}
connection checking time:  0.017160654067993164
block generation total time  0.01914072036743164
average batch blocks generation time:  0.00478518009185791
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.008607864379882812  GigaBytes
Max Memory Allocated: 0.008607864379882812  GigaBytes

{'VmPeak': 21006.15234375, 'VmSize': 20977.76953125, 'VmHWM': 3911.24609375, 'VmRSS': 3911.24609375}
torch.Size([1538, 1433])
torch.Size([730, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009031295776367188  GigaBytes
Max Memory Allocated: 0.009087562561035156  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21749.0546875, 'VmHWM': 4604.4765625, 'VmRSS': 4604.4765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009340286254882812  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4614.48828125, 'VmRSS': 4614.48828125}
torch.Size([1608, 1433])
torch.Size([823, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009804248809814453  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4614.48828125, 'VmRSS': 4614.48828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008960723876953125  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.0546875, 'VmRSS': 4615.0546875}
torch.Size([1383, 1433])
torch.Size([652, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009351253509521484  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.0546875, 'VmRSS': 4615.0546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009319782257080078  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.41796875, 'VmRSS': 4615.41796875}
torch.Size([1604, 1433])
torch.Size([804, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009791374206542969  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.41796875, 'VmRSS': 4615.41796875}
{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.7734375, 'VmRSS': 4615.7734375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013215780258178711 |0.09253770112991333 |0.20300894975662231 |0.0002237558364868164 |0.003252089023590088 |0.0032737255096435547 |
----------------------------------------------------------pseudo_mini_loss sum 3.4917492866516113
{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.7734375, 'VmRSS': 4615.7734375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9866
Number of first layer input nodes during this epoch:  6133
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010129928588867188  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21769.609375, 'VmSize': 21757.90234375, 'VmHWM': 4615.9609375, 'VmRSS': 4615.9609375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005524158477783203
global_2_local 8.559226989746094e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.511543273925781e-05
before graph partition 
		210, 155, 183, 191, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00026488304138183594
	Initialize BitList time :  1.7642974853515625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 210, 155

	before terminate 1 the average redundancy rate is:  1.1335403726708075
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.1677018633540373,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.127329192546584,  1.204968944099379,  1.049689440993789
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1149068322981366,  1.049689440993789,  1.1801242236024845
	walk terminate 1 spend time 5.346081256866455
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.0683229813664596,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.0683229813664596,  1.1677018633540373
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.0993788819875776,  1.1366459627329193
	walk terminate 1 spend time 5.321109294891357
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		177, 183, 183, 191, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				27, 43, 35, 35, 


	preparing two sides time :  0.0005009174346923828
	Initialize BitList time :  4.9114227294921875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 183, 183

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.1118012422360248,  1.1614906832298137
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2484472049689441,  1.0
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 8
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.062111801242236,  1.1925465838509317
	walk terminate 1 spend time 5.427673101425171
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.15527950310559,  1.0807453416149069
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.1428571428571428,  1.093167701863354
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.204968944099379,  1.031055900621118
	walk terminate 1 spend time 5.2619805335998535
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		177, 166, 194, 191, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				27, 32, 46, 35, 


	preparing two sides time :  0.0005352497100830078
	Initialize BitList time :  4.267692565917969e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 194, 191

	before terminate 1 the average redundancy rate is:  1.1956521739130435
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.1801242236024845,  1.2111801242236024
						 current side  1
			 redundancy will reduce  0.02795031055900621
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 7
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.124223602484472,  1.2236024844720497
	walk terminate 1 spend time 5.201605796813965
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.2981366459627328,  1.0434782608695652
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.093167701863354,  1.2732919254658386
						 current side  1
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.2298136645962734,  1.124223602484472
	walk terminate 1 spend time 5.301879644393921
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		177, 166, 181, 198, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 31.870037317276
partition_len_list
[177, 166, 181, 198]
random_init_graph_partition selection method range initialization spend 31.870665073394775
time for parepare:  0.00037026405334472656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.002170562744140625
mini_batch_src_global generation:  0.00015115737915039062
r_  generation:  0.0005590915679931641
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.00013446807861328125
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0003421306610107422
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00014495849609375
----------------------check_connections_block total spend ----------------------------- 0.0067594051361083984
generate_one_block  0.03020191192626953
generate_one_block  0.001245260238647461
generate_one_block  0.0011332035064697266
generate_one_block  0.0014219284057617188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002016782760620117
gen group dst list time:  4.506111145019531e-05
time for parepare:  0.0006203651428222656
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0012459754943847656
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.0006172657012939453
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0004096031188964844
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0005056858062744141
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0005507469177246094
----------------------check_connections_block total spend ----------------------------- 0.005793094635009766
generate_one_block  0.0015482902526855469
generate_one_block  0.0014684200286865234
generate_one_block  0.0014722347259521484
generate_one_block  0.0015401840209960938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006480216979980469
gen group dst list time:  7.939338684082031e-05
time for parepare:  0.00041675567626953125
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0003986358642578125
mini_batch_src_global generation:  0.00046825408935546875
r_  generation:  0.0012922286987304688
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0011394023895263672
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0012135505676269531
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0013582706451416016
----------------------check_connections_block total spend ----------------------------- 0.009135007858276367
generate_one_block  0.008222103118896484
generate_one_block  0.008710622787475586
generate_one_block  0.0030775070190429688
generate_one_block  0.0026426315307617188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010129928588867188  GigaBytes
Max Memory Allocated: 0.017508506774902344  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21821.91796875, 'VmHWM': 4617.50390625, 'VmRSS': 4617.50390625}
connection checking time:  0.014928102493286133
block generation total time  0.02868199348449707
average batch blocks generation time:  0.007170498371124268
block dataloader generation time/epoch 31.97032880783081
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.010158061981201172  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4621.5, 'VmRSS': 4621.5}
torch.Size([1629, 1433])
torch.Size([785, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.010609626770019531  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4621.5, 'VmRSS': 4621.5}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008898735046386719  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4621.859375, 'VmRSS': 4621.859375}
torch.Size([1394, 1433])
torch.Size([656, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009285926818847656  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4621.859375, 'VmRSS': 4621.859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008960247039794922  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4622.05078125, 'VmRSS': 4622.05078125}
torch.Size([1405, 1433])
torch.Size([690, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009372711181640625  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4622.05078125, 'VmRSS': 4622.05078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.010068893432617188  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4622.125, 'VmRSS': 4622.125}
torch.Size([1612, 1433])
torch.Size([835, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.010550975799560547  GigaBytes
Max Memory Allocated: 0.01867961883544922  GigaBytes

{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4622.125, 'VmRSS': 4622.125}
{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4622.125, 'VmRSS': 4622.125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02222520112991333 |0.0007228851318359375 |0.005469381809234619 |0.00021564960479736328 |0.005774974822998047 |0.0020711421966552734 |
----------------------------------------------------------pseudo_mini_loss sum 2.4241855144500732
{'VmPeak': 21885.91796875, 'VmSize': 21826.69921875, 'VmHWM': 4622.125, 'VmRSS': 4622.125}
Total (block generation + training)time/epoch 32.118502140045166
Training time/epoch 0.1474437713623047
Training time without block to device /epoch 0.14455223083496094
Training time without total dataloading part /epoch 0.04791116714477539
load block tensor time/epoch 0.08890080451965332
block to device time/epoch 0.00289154052734375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9728
Number of first layer input nodes during this epoch:  6040
