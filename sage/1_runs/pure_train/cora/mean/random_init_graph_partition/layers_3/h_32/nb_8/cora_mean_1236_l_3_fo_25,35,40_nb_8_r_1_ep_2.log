main start at this time 1648597476.2776728
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20838.7265625, 'VmSize': 20838.7265625, 'VmHWM': 3618.1171875, 'VmRSS': 3618.1171875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012106895446777344
global_2_local 7.343292236328125e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00022721290588378906
before graph partition 
		122, 70, 94, 77, 90, 95, 115, 85, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020384788513183594
	Initialize BitList time :  1.33514404296875e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 122, 70

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
	walk terminate 1 spend time 4.260470628738403
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 122, 94, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002551078796386719
	Initialize BitList time :  1.9788742065429688e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 122, 94

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
	walk terminate 1 spend time 4.18153977394104
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 122, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005164146423339844
	Initialize BitList time :  3.0279159545898438e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 122, 77

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
	walk terminate 1 spend time 4.17829442024231
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 122, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005433559417724609
	Initialize BitList time :  3.504753112792969e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 122, 90

	before terminate 1 the average redundancy rate is:  1.3167701863354035
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
	walk terminate 1 spend time 4.294035911560059
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 122, 95, 115, 85, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0007390975952148438
	Initialize BitList time :  0.00010395050048828125
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 122, 95

	before terminate 1 the average redundancy rate is:  1.3478260869565217
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.515527950310559,  1.1801242236024845
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.1423609256744385
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.214705944061279
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 132, 115, 85, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 15, 21, 18, 14, 


	preparing two sides time :  0.0004868507385253906
	Initialize BitList time :  4.3392181396484375e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 132, 115

	before terminate 1 the average redundancy rate is:  1.5341614906832297
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5341614906832297,  1.639751552795031,  1.4285714285714286
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.187480449676514
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.4906832298136645,  1.565217391304348
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.950310559006211,  1.1055900621118013
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.185617923736572
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 103, 143, 85, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 15, 19, 20, 14, 


	preparing two sides time :  0.0005128383636474609
	Initialize BitList time :  7.82012939453125e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 143, 85

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
	walk terminate 1 spend time 4.196603298187256
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 84, 103, 85, 143, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.86685872077942
partition_len_list
[70, 94, 77, 90, 84, 103, 85, 143]
random_init_graph_partition selection method range initialization spend 37.86730241775513
time for parepare:  0.0001533031463623047
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0010991096496582031
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.015158891677856445
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  9.322166442871094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00010585784912109375
----------------------check_connections_block total spend ----------------------------- 0.019016742706298828
generate_one_block  0.011446237564086914
generate_one_block  0.0011115074157714844
generate_one_block  0.0009791851043701172
generate_one_block  0.0010023117065429688
generate_one_block  0.0009870529174804688
generate_one_block  0.001004934310913086
generate_one_block  0.0009920597076416016
generate_one_block  0.0010325908660888672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017724037170410156
gen group dst list time:  0.00013017654418945312
time for parepare:  0.0004036426544189453
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00022172927856445312
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00026726722717285156
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00024175643920898438
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002627372741699219
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00024390220642089844
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.00030994415283203125
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0002491474151611328
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00035381317138671875
----------------------check_connections_block total spend ----------------------------- 0.005162239074707031
generate_one_block  0.0025353431701660156
generate_one_block  0.0014984607696533203
generate_one_block  0.0014805793762207031
generate_one_block  0.0015327930450439453
generate_one_block  0.0016131401062011719
generate_one_block  0.0014739036560058594
generate_one_block  0.0013275146484375
generate_one_block  0.0015218257904052734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001489400863647461
gen group dst list time:  0.00012922286987304688
time for parepare:  0.0006766319274902344
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0011074542999267578
mini_batch_src_global generation:  0.00030994415283203125
r_  generation:  0.0009045600891113281
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.0004150867462158203
mini_batch_src_global generation:  0.00041484832763671875
r_  generation:  0.0008282661437988281
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0008947849273681641
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.0009407997131347656
r_  generation:  0.0008513927459716797
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0007874965667724609
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.0010828971862792969
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0008008480072021484
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0008800029754638672
----------------------check_connections_block total spend ----------------------------- 0.016254663467407227
generate_one_block  0.004361152648925781
generate_one_block  0.0018010139465332031
generate_one_block  0.0018780231475830078
generate_one_block  0.0017902851104736328
generate_one_block  0.0016829967498779297
generate_one_block  0.0019636154174804688
generate_one_block  0.0017426013946533203
generate_one_block  0.0019259452819824219
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20840.80078125, 'VmSize': 20688.6328125, 'VmHWM': 3621.26953125, 'VmRSS': 3621.26953125}
connection checking time:  0.021416902542114258
block generation total time  0.030129194259643555
average batch blocks generation time:  0.0037661492824554443
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005009174346923828  GigaBytes
Max Memory Allocated: 0.005009174346923828  GigaBytes

{'VmPeak': 21005.28515625, 'VmSize': 20977.45703125, 'VmHWM': 3912.37109375, 'VmRSS': 3912.37109375}
torch.Size([868, 1433])
torch.Size([339, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005203723907470703  GigaBytes
Max Memory Allocated: 0.005250453948974609  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21749.1171875, 'VmHWM': 4605.34375, 'VmRSS': 4605.34375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005998134613037109  GigaBytes
Max Memory Allocated: 0.010610580444335938  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21754.609375, 'VmHWM': 4612.02734375, 'VmRSS': 4612.02734375}
torch.Size([986, 1433])
torch.Size([367, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006218433380126953  GigaBytes
Max Memory Allocated: 0.010610580444335938  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21754.609375, 'VmHWM': 4612.02734375, 'VmRSS': 4612.02734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006452083587646484  GigaBytes
Max Memory Allocated: 0.01169443130493164  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.07421875, 'VmHWM': 4613.015625, 'VmRSS': 4613.015625}
torch.Size([1071, 1433])
torch.Size([410, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006682395935058594  GigaBytes
Max Memory Allocated: 0.01169443130493164  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.07421875, 'VmHWM': 4613.015625, 'VmRSS': 4613.015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005992889404296875  GigaBytes
Max Memory Allocated: 0.01169443130493164  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.07421875, 'VmHWM': 4613.8125, 'VmRSS': 4613.8125}
torch.Size([985, 1433])
torch.Size([374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006214618682861328  GigaBytes
Max Memory Allocated: 0.01169443130493164  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.07421875, 'VmHWM': 4613.8125, 'VmRSS': 4613.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005553245544433594  GigaBytes
Max Memory Allocated: 0.01169443130493164  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.07421875, 'VmHWM': 4614.015625, 'VmRSS': 4614.015625}
torch.Size([903, 1433])
torch.Size([358, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005763053894042969  GigaBytes
Max Memory Allocated: 0.01169443130493164  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.07421875, 'VmHWM': 4614.015625, 'VmRSS': 4614.015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007253170013427734  GigaBytes
Max Memory Allocated: 0.01204681396484375  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4614.77734375, 'VmRSS': 4614.77734375}
torch.Size([1220, 1433])
torch.Size([523, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007546901702880859  GigaBytes
Max Memory Allocated: 0.01204681396484375  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4614.77734375, 'VmRSS': 4614.77734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005912303924560547  GigaBytes
Max Memory Allocated: 0.012404918670654297  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4614.78125, 'VmRSS': 4614.78125}
torch.Size([970, 1433])
torch.Size([376, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006130695343017578  GigaBytes
Max Memory Allocated: 0.012404918670654297  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4614.78125, 'VmRSS': 4614.78125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006960391998291016  GigaBytes
Max Memory Allocated: 0.012404918670654297  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4614.8515625, 'VmRSS': 4614.8515625}
torch.Size([1165, 1433])
torch.Size([475, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007256507873535156  GigaBytes
Max Memory Allocated: 0.012404918670654297  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4614.8515625, 'VmRSS': 4614.8515625}
{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4615.1015625, 'VmRSS': 4615.1015625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01420748233795166 |0.044977784156799316 |0.09986674785614014 |0.00015348196029663086 |0.003455430269241333 |0.0028083324432373047 |
----------------------------------------------------------pseudo_mini_loss sum 3.7004897594451904
{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4615.1015625, 'VmRSS': 4615.1015625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12136
Number of first layer input nodes during this epoch:  8168
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0077362060546875  GigaBytes
Max Memory Allocated: 0.012404918670654297  GigaBytes

{'VmPeak': 21762.73828125, 'VmSize': 21755.88671875, 'VmHWM': 4615.2265625, 'VmRSS': 4615.2265625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005545616149902344
global_2_local 9.274482727050781e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.988380432128906e-05
before graph partition 
		94, 124, 76, 84, 83, 114, 81, 97, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002665519714355469
	Initialize BitList time :  1.4066696166992188e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 94, 124

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
	walk terminate 1 spend time 4.840918779373169
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		94, 124, 76, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002925395965576172
	Initialize BitList time :  2.7179718017578125e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 124, 76

	before terminate 1 the average redundancy rate is:  1.2422360248447206
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.2546583850931676,  1.204968944099379
	walk terminate 1 spend time 5.235107183456421
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1925465838509317,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.3043478260869565,  1.15527950310559
	walk terminate 1 spend time 4.919045686721802
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		94, 93, 105, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 22, 14, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004885196685791016
	Initialize BitList time :  0.0001804828643798828
	getRedundancyCost: time   9.059906005859375e-06

					length of partitions 105, 84

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
	walk terminate 1 spend time 4.921467542648315
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 105, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 22, 18, 14, 18, 18, 18, 14, 


	preparing two sides time :  0.0004265308380126953
	Initialize BitList time :  3.933906555175781e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 105, 83

	before terminate 1 the average redundancy rate is:  1.1677018633540373
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
	walk terminate 1 spend time 4.977091073989868
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 105, 114, 81, 97, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 22, 18, 18, 14, 18, 18, 14, 


	preparing two sides time :  0.0004684925079345703
	Initialize BitList time :  4.291534423828125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 105, 114

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.3043478260869565,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
	walk terminate 1 spend time 4.958893775939941
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
	walk terminate 1 spend time 4.921088933944702
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		94, 93, 84, 83, 85, 132, 81, 97, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 22, 18, 18, 10, 22, 18, 14, 


	preparing two sides time :  0.0004932880401611328
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 132, 81

	before terminate 1 the average redundancy rate is:  1.3229813664596273
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
	walk terminate 1 spend time 4.949614763259888
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 132, 97, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 22, 18, 18, 10, 18, 22, 14, 


	preparing two sides time :  0.0004661083221435547
	Initialize BitList time :  3.504753112792969e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 132, 97

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
	walk terminate 1 spend time 4.964712142944336
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 97, 132, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 44.71217346191406
partition_len_list
[94, 93, 84, 83, 85, 81, 97, 132]
random_init_graph_partition selection method range initialization spend 44.71282339096069
time for parepare:  0.00018310546875
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0008633136749267578
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.00038170814514160156
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.202957153320312e-05
----------------------check_connections_block total spend ----------------------------- 0.004765033721923828
generate_one_block  0.017960309982299805
generate_one_block  0.001207113265991211
generate_one_block  0.001310586929321289
generate_one_block  0.0010814666748046875
generate_one_block  0.0010862350463867188
generate_one_block  0.0010750293731689453
generate_one_block  0.0011854171752929688
generate_one_block  0.0010268688201904297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001956939697265625
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.0007121562957763672
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00029468536376953125
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002918243408203125
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001857280731201172
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002448558807373047
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.00034928321838378906
----------------------check_connections_block total spend ----------------------------- 0.0052258968353271484
generate_one_block  0.0013790130615234375
generate_one_block  0.0012969970703125
generate_one_block  0.0013153553009033203
generate_one_block  0.0012977123260498047
generate_one_block  0.0012943744659423828
generate_one_block  0.0012791156768798828
generate_one_block  0.0015251636505126953
generate_one_block  0.0015859603881835938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008265972137451172
gen group dst list time:  0.00010418891906738281
time for parepare:  0.0003788471221923828
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0007898807525634766
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0008022785186767578
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0006537437438964844
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0007417201995849609
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006935596466064453
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.000629425048828125
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0006053447723388672
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0008106231689453125
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0008866786956787109
----------------------check_connections_block total spend ----------------------------- 0.010893821716308594
generate_one_block  0.003619670867919922
generate_one_block  0.0019505023956298828
generate_one_block  0.001949310302734375
generate_one_block  0.0017518997192382812
generate_one_block  0.0016825199127197266
generate_one_block  0.0015869140625
generate_one_block  0.003293752670288086
generate_one_block  0.004148244857788086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0077362060546875  GigaBytes
Max Memory Allocated: 0.012404918670654297  GigaBytes

{'VmPeak': 21820.40234375, 'VmSize': 21820.28125, 'VmHWM': 4615.953125, 'VmRSS': 4615.953125}
connection checking time:  0.016119718551635742
block generation total time  0.030956506729125977
average batch blocks generation time:  0.003869563341140747
block dataloader generation time/epoch 44.80764698982239
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007668972015380859  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4619.60546875, 'VmRSS': 4619.60546875}
torch.Size([1166, 1433])
torch.Size([454, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00792694091796875  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4619.60546875, 'VmRSS': 4619.60546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00632476806640625  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.328125, 'VmRSS': 4620.328125}
torch.Size([915, 1433])
torch.Size([351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006537914276123047  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.328125, 'VmRSS': 4620.328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007107734680175781  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.421875, 'VmRSS': 4620.421875}
torch.Size([1061, 1433])
torch.Size([426, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00734710693359375  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.421875, 'VmRSS': 4620.421875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00652313232421875  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.44921875, 'VmRSS': 4620.44921875}
torch.Size([952, 1433])
torch.Size([397, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0067501068115234375  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.44921875, 'VmRSS': 4620.44921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006452083587646484  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.55078125, 'VmRSS': 4620.55078125}
torch.Size([939, 1433])
torch.Size([329, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006651878356933594  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.55078125, 'VmRSS': 4620.55078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006152153015136719  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.55078125, 'VmRSS': 4620.55078125}
torch.Size([883, 1433])
torch.Size([315, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006342887878417969  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.55078125, 'VmRSS': 4620.55078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007007598876953125  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.65625, 'VmHWM': 4620.5859375, 'VmRSS': 4620.5859375}
torch.Size([1042, 1433])
torch.Size([412, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007251262664794922  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.640625, 'VmHWM': 4620.58984375, 'VmRSS': 4620.58203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007769584655761719  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.640625, 'VmHWM': 4620.58984375, 'VmRSS': 4620.58203125}
torch.Size([1184, 1433])
torch.Size([499, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008069515228271484  GigaBytes
Max Memory Allocated: 0.01386404037475586  GigaBytes

{'VmPeak': 21824.65625, 'VmSize': 21824.640625, 'VmHWM': 4620.58984375, 'VmRSS': 4620.58203125}
{'VmPeak': 21824.65625, 'VmSize': 21824.640625, 'VmHWM': 4620.58984375, 'VmRSS': 4620.5859375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010791689157485962 |0.0006999969482421875 |0.005158036947250366 |0.0002104043960571289 |0.0024832487106323242 |0.0031976699829101562 |
----------------------------------------------------------pseudo_mini_loss sum 2.598262071609497
{'VmPeak': 21824.65625, 'VmSize': 21824.640625, 'VmHWM': 4620.58984375, 'VmRSS': 4620.5859375}
Total (block generation + training)time/epoch 44.98092722892761
Training time/epoch 0.17291855812072754
Training time without block to device /epoch 0.16731858253479004
Training time without total dataloading part /epoch 0.06601119041442871
load block tensor time/epoch 0.0863335132598877
block to device time/epoch 0.0055999755859375
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12074
Number of first layer input nodes during this epoch:  8142
