main start at this time 1648598603.2277963
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20807.75, 'VmSize': 20801.7890625, 'VmHWM': 3612.96484375, 'VmRSS': 3612.96484375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010876655578613281
global_2_local 7.224082946777344e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00021219253540039062
before graph partition 
		122, 70, 94, 77, 90, 95, 115, 85, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020623207092285156
	Initialize BitList time :  1.2874603271484375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 122, 70

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
	walk terminate 1 spend time 4.169114112854004
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 122, 94, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005254745483398438
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 94

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
	walk terminate 1 spend time 4.504194974899292
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 122, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048828125
	Initialize BitList time :  3.600120544433594e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 77

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
	walk terminate 1 spend time 4.360957145690918
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 122, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004913806915283203
	Initialize BitList time :  3.457069396972656e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 90

	before terminate 1 the average redundancy rate is:  1.3167701863354035
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
	walk terminate 1 spend time 4.183464765548706
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 122, 95, 115, 85, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004966259002685547
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 122, 95

	before terminate 1 the average redundancy rate is:  1.3478260869565217
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.515527950310559,  1.1801242236024845
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.242486000061035
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.248678207397461
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 132, 115, 85, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 15, 21, 18, 14, 


	preparing two sides time :  0.0005135536193847656
	Initialize BitList time :  4.2438507080078125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 132, 115

	before terminate 1 the average redundancy rate is:  1.5341614906832297
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5341614906832297,  1.639751552795031,  1.4285714285714286
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.162100791931152
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.4906832298136645,  1.565217391304348
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.950310559006211,  1.1055900621118013
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.2186620235443115
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 103, 143, 85, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 15, 19, 20, 14, 


	preparing two sides time :  0.0005025863647460938
	Initialize BitList time :  0.0001666545867919922
	getRedundancyCost: time   2.0265579223632812e-05

					length of partitions 143, 85

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
	walk terminate 1 spend time 4.454311370849609
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 84, 103, 85, 143, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 38.56998896598816
partition_len_list
[70, 94, 77, 90, 84, 103, 85, 143]
random_init_graph_partition selection method range initialization spend 38.57045125961304
time for parepare:  0.0001804828643798828
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0009622573852539062
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.014899730682373047
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  3.910064697265625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.125999450683594e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  8.368492126464844e-05
----------------------check_connections_block total spend ----------------------------- 0.018678903579711914
generate_one_block  0.011275053024291992
generate_one_block  0.0012319087982177734
generate_one_block  0.0011518001556396484
generate_one_block  0.0011212825775146484
generate_one_block  0.0011019706726074219
generate_one_block  0.001111745834350586
generate_one_block  0.0011317729949951172
generate_one_block  0.0011599063873291016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021049976348876953
gen group dst list time:  0.000118255615234375
time for parepare:  0.000377655029296875
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00019311904907226562
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002448558807373047
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00024056434631347656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00021409988403320312
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002961158752441406
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00023746490478515625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00031948089599609375
----------------------check_connections_block total spend ----------------------------- 0.004676103591918945
generate_one_block  0.0022580623626708984
generate_one_block  0.0013654232025146484
generate_one_block  0.0013952255249023438
generate_one_block  0.0013949871063232422
generate_one_block  0.0013713836669921875
generate_one_block  0.007637500762939453
generate_one_block  0.0012946128845214844
generate_one_block  0.0013773441314697266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007021427154541016
gen group dst list time:  0.00011944770812988281
time for parepare:  0.0005657672882080078
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00037360191345214844
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.0006978511810302734
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.0007898807525634766
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0008521080017089844
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0008127689361572266
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0007240772247314453
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0010383129119873047
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0008225440979003906
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0009827613830566406
----------------------check_connections_block total spend ----------------------------- 0.012393474578857422
generate_one_block  0.0018734931945800781
generate_one_block  0.0019538402557373047
generate_one_block  0.0020253658294677734
generate_one_block  0.0019731521606445312
generate_one_block  0.0023152828216552734
generate_one_block  0.002478361129760742
generate_one_block  0.0020933151245117188
generate_one_block  0.0024712085723876953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20808.8359375, 'VmSize': 20656.66796875, 'VmHWM': 3620.78125, 'VmRSS': 3620.78125}
connection checking time:  0.017069578170776367
block generation total time  0.0352785587310791
average batch blocks generation time:  0.004409819841384888
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005754947662353516  GigaBytes
Max Memory Allocated: 0.005754947662353516  GigaBytes

{'VmPeak': 21007.16015625, 'VmSize': 20977.9140625, 'VmHWM': 3911.515625, 'VmRSS': 3911.515625}
torch.Size([1007, 1433])
torch.Size([377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005968570709228516  GigaBytes
Max Memory Allocated: 0.006030082702636719  GigaBytes

{'VmPeak': 21757.87890625, 'VmSize': 21753.37109375, 'VmHWM': 4608.59375, 'VmRSS': 4608.59375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006706714630126953  GigaBytes
Max Memory Allocated: 0.012057304382324219  GigaBytes

{'VmPeak': 21759.5703125, 'VmSize': 21759.5703125, 'VmHWM': 4615.38671875, 'VmRSS': 4615.38671875}
torch.Size([1118, 1433])
torch.Size([415, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00695037841796875  GigaBytes
Max Memory Allocated: 0.012057304382324219  GigaBytes

{'VmPeak': 21759.5703125, 'VmSize': 21759.5703125, 'VmHWM': 4615.38671875, 'VmRSS': 4615.38671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007348060607910156  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.2265625, 'VmSize': 21760.2265625, 'VmHWM': 4617.59375, 'VmRSS': 4617.59375}
torch.Size([1238, 1433])
torch.Size([468, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007605075836181641  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.2265625, 'VmSize': 21760.2265625, 'VmHWM': 4617.59375, 'VmRSS': 4617.59375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006616115570068359  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.2265625, 'VmSize': 21760.2265625, 'VmHWM': 4617.7734375, 'VmRSS': 4617.7734375}
torch.Size([1101, 1433])
torch.Size([425, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006862640380859375  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.2265625, 'VmSize': 21760.2265625, 'VmHWM': 4617.7734375, 'VmRSS': 4617.7734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006088733673095703  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.2265625, 'VmSize': 21760.2265625, 'VmHWM': 4617.8984375, 'VmRSS': 4617.8984375}
torch.Size([1003, 1433])
torch.Size([394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0063152313232421875  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.2265625, 'VmSize': 21760.2265625, 'VmHWM': 4617.8984375, 'VmRSS': 4617.8984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007838726043701172  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.41015625, 'VmRSS': 4618.41015625}
torch.Size([1329, 1433])
torch.Size([598, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008165836334228516  GigaBytes
Max Memory Allocated: 0.0132904052734375  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.41015625, 'VmRSS': 4618.41015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0066432952880859375  GigaBytes
Max Memory Allocated: 0.013712882995605469  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.41015625, 'VmRSS': 4618.41015625}
torch.Size([1106, 1433])
torch.Size([464, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006901264190673828  GigaBytes
Max Memory Allocated: 0.013712882995605469  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.41015625, 'VmRSS': 4618.41015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007599353790283203  GigaBytes
Max Memory Allocated: 0.013712882995605469  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.4921875, 'VmRSS': 4618.4921875}
torch.Size([1284, 1433])
torch.Size([522, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007918834686279297  GigaBytes
Max Memory Allocated: 0.013712882995605469  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.4921875, 'VmRSS': 4618.4921875}
{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.6796875, 'VmRSS': 4618.6796875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008568346500396729 |0.047770947217941284 |0.09980970621109009 |0.00014606118202209473 |0.002781510353088379 |0.0024199485778808594 |
----------------------------------------------------------pseudo_mini_loss sum 3.714700698852539
{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.6796875, 'VmRSS': 4618.6796875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13595
Number of first layer input nodes during this epoch:  9186
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008384227752685547  GigaBytes
Max Memory Allocated: 0.013712882995605469  GigaBytes

{'VmPeak': 21760.72265625, 'VmSize': 21760.72265625, 'VmHWM': 4618.9296875, 'VmRSS': 4618.9296875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004627704620361328
global_2_local 7.2479248046875e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.534027099609375e-05
before graph partition 
		94, 124, 76, 84, 83, 114, 81, 97, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020956993103027344
	Initialize BitList time :  1.3113021850585938e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 94, 124

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
	walk terminate 1 spend time 5.077589988708496
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		94, 124, 76, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004818439483642578
	Initialize BitList time :  4.315376281738281e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 124, 76

	before terminate 1 the average redundancy rate is:  1.2422360248447206
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.2546583850931676,  1.204968944099379
	walk terminate 1 spend time 5.099053859710693
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1925465838509317,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.3043478260869565,  1.15527950310559
	walk terminate 1 spend time 5.141505718231201
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		94, 93, 105, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 22, 14, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004801750183105469
	Initialize BitList time :  4.553794860839844e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 105, 84

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
	walk terminate 1 spend time 4.93631649017334
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 105, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 22, 18, 14, 18, 18, 18, 14, 


	preparing two sides time :  0.0004885196685791016
	Initialize BitList time :  0.00012612342834472656
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 105, 83

	before terminate 1 the average redundancy rate is:  1.1677018633540373
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
	walk terminate 1 spend time 5.151836395263672
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 105, 114, 81, 97, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 22, 18, 18, 14, 18, 18, 14, 


	preparing two sides time :  0.0004298686981201172
	Initialize BitList time :  5.364418029785156e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 105, 114

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.3043478260869565,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
	walk terminate 1 spend time 4.988436222076416
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
	walk terminate 1 spend time 5.284590244293213
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		94, 93, 84, 83, 85, 132, 81, 97, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 22, 18, 18, 10, 22, 18, 14, 


	preparing two sides time :  0.0004951953887939453
	Initialize BitList time :  4.315376281738281e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 132, 81

	before terminate 1 the average redundancy rate is:  1.3229813664596273
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
	walk terminate 1 spend time 4.978533506393433
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 132, 97, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 22, 18, 18, 10, 18, 22, 14, 


	preparing two sides time :  0.0007748603820800781
	Initialize BitList time :  5.316734313964844e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 132, 97

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
	walk terminate 1 spend time 5.142446279525757
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 97, 132, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 45.82730293273926
partition_len_list
[94, 93, 84, 83, 85, 81, 97, 132]
random_init_graph_partition selection method range initialization spend 45.828006982803345
time for parepare:  0.0001595020294189453
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0016758441925048828
mini_batch_src_global generation:  0.00015926361083984375
r_  generation:  0.00045418739318847656
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  8.273124694824219e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0003046989440917969
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00013637542724609375
----------------------check_connections_block total spend ----------------------------- 0.0067021846771240234
generate_one_block  0.01915574073791504
generate_one_block  0.0012857913970947266
generate_one_block  0.0016086101531982422
generate_one_block  0.0010983943939208984
generate_one_block  0.0010406970977783203
generate_one_block  0.0010290145874023438
generate_one_block  0.0010814666748046875
generate_one_block  0.0011014938354492188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002250194549560547
gen group dst list time:  7.963180541992188e-05
time for parepare:  0.0005614757537841797
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00046706199645996094
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.00029921531677246094
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00028133392333984375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00025534629821777344
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00018596649169921875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00021529197692871094
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002455711364746094
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00037026405334472656
----------------------check_connections_block total spend ----------------------------- 0.005230426788330078
generate_one_block  0.00186920166015625
generate_one_block  0.0013642311096191406
generate_one_block  0.0014498233795166016
generate_one_block  0.0013773441314697266
generate_one_block  0.0013017654418945312
generate_one_block  0.0012669563293457031
generate_one_block  0.005346536636352539
generate_one_block  0.0014286041259765625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007202625274658203
gen group dst list time:  0.00010442733764648438
time for parepare:  0.0006992816925048828
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00040268898010253906
mini_batch_src_global generation:  0.0003223419189453125
r_  generation:  0.0009138584136962891
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0007290840148925781
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0008873939514160156
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0008246898651123047
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0006334781646728516
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006330013275146484
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0008597373962402344
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00029349327087402344
r_  generation:  0.0019969940185546875
----------------------check_connections_block total spend ----------------------------- 0.025974035263061523
generate_one_block  0.004538297653198242
generate_one_block  0.003654003143310547
generate_one_block  0.004384756088256836
generate_one_block  0.004440784454345703
generate_one_block  0.004195690155029297
generate_one_block  0.004105329513549805
generate_one_block  0.004647493362426758
generate_one_block  0.005369424819946289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008384227752685547  GigaBytes
Max Memory Allocated: 0.013712882995605469  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1484375, 'VmRSS': 4620.1484375}
connection checking time:  0.0312044620513916
block generation total time  0.05074024200439453
average batch blocks generation time:  0.006342530250549316
block dataloader generation time/epoch 45.961527585983276
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008237838745117188  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
torch.Size([1272, 1433])
torch.Size([527, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008527278900146484  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.006829738616943359  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
torch.Size([1009, 1433])
torch.Size([406, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.007068634033203125  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.00823974609375  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
torch.Size([1227, 1433])
torch.Size([529, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008526325225830078  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.007098197937011719  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
torch.Size([1059, 1433])
torch.Size([471, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.007357120513916016  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.006816864013671875  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.73828125, 'VmHWM': 4620.1953125, 'VmRSS': 4620.1953125}
torch.Size([1007, 1433])
torch.Size([334, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.007019996643066406  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.006623744964599609  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
torch.Size([971, 1433])
torch.Size([346, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.006828784942626953  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.007212162017822266  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
torch.Size([1080, 1433])
torch.Size([432, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.007465362548828125  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008392333984375  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
torch.Size([1300, 1433])
torch.Size([574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.008726119995117188  GigaBytes
Max Memory Allocated: 0.015065193176269531  GigaBytes

{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01086321473121643 |0.0005082786083221436 |0.00393068790435791 |0.00015351176261901855 |0.0027820169925689697 |0.001605987548828125 |
----------------------------------------------------------pseudo_mini_loss sum 2.6195619106292725
{'VmPeak': 21888.73828125, 'VmSize': 21824.72265625, 'VmHWM': 4620.19921875, 'VmRSS': 4620.19140625}
Total (block generation + training)time/epoch 46.12012267112732
Training time/epoch 0.15830707550048828
Training time without block to device /epoch 0.15424084663391113
Training time without total dataloading part /epoch 0.05653572082519531
load block tensor time/epoch 0.08690571784973145
block to device time/epoch 0.0040662288665771484
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13293
Number of first layer input nodes during this epoch:  8925
