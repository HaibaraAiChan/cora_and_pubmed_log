main start at this time 1648597790.7028332
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20808.7890625, 'VmSize': 20801.54296875, 'VmHWM': 3613.7578125, 'VmRSS': 3613.7578125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000957489013671875
global_2_local 0.0001373291015625
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00013685226440429688
before graph partition 
		187, 164, 178, 203, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00029349327087402344
	Initialize BitList time :  1.811981201171875e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 187, 164

	before terminate 1 the average redundancy rate is:  1.0900621118012421
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.1118012422360248,  1.0683229813664596
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.1366459627329193,  1.0434782608695652
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.1118012422360248,  1.0683229813664596
	walk terminate 1 spend time 4.305129051208496
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		172, 179, 178, 203, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005245208740234375
	Initialize BitList time :  4.029273986816406e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 179, 178

	before terminate 1 the average redundancy rate is:  1.108695652173913
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1118012422360248,  0.906832298136646,  1.3167701863354038
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0962732919254656,  1.0745341614906831,  1.1180124223602483
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0931677018633539,  1.0186335403726707,  1.1677018633540373
	walk terminate 1 spend time 4.3511574268341064
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0900621118012421,  1.2236024844720497,  0.9565217391304348
						 current side  0
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0776397515527951,  1.0248447204968945,  1.1304347826086956
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0838509316770186,  1.0869565217391304,  1.0807453416149069
	walk terminate 1 spend time 4.381195783615112
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		172, 174, 175, 203, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 35, 34, 35, 


	preparing two sides time :  0.0009403228759765625
	Initialize BitList time :  4.267692565917969e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 175, 203

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.124223602484472,  1.2236024844720497
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.062111801242236,  1.2857142857142858
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0807453416149069,  1.2670807453416149
	walk terminate 1 spend time 4.3569495677948
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		172, 174, 174, 204, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 17.40554714202881
partition_len_list
[172, 174, 174, 204]
random_init_graph_partition selection method range initialization spend 17.406383991241455
time for parepare:  0.00017333030700683594
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.03346824645996094
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.019133567810058594
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.083747863769531e-05
----------------------check_connections_block total spend ----------------------------- 0.05432701110839844
generate_one_block  0.00536656379699707
generate_one_block  0.0012025833129882812
generate_one_block  0.0010726451873779297
generate_one_block  0.0011043548583984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001333475112915039
gen group dst list time:  6.365776062011719e-05
time for parepare:  0.00048613548278808594
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0004572868347167969
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.00048470497131347656
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004544258117675781
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005359649658203125
----------------------check_connections_block total spend ----------------------------- 0.004315376281738281
generate_one_block  0.0035889148712158203
generate_one_block  0.0019106864929199219
generate_one_block  0.0018992424011230469
generate_one_block  0.005034923553466797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000637054443359375
gen group dst list time:  9.489059448242188e-05
time for parepare:  0.00039124488830566406
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0005209445953369141
mini_batch_src_global generation:  0.0007913112640380859
r_  generation:  0.0026128292083740234
local_output_nid generation:  0.00015282630920410156
local_in_edges_tensor generation:  0.0005214214324951172
mini_batch_src_global generation:  0.0012850761413574219
r_  generation:  0.002716064453125
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00043892860412597656
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.0023376941680908203
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0003352165222167969
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.002149820327758789
----------------------check_connections_block total spend ----------------------------- 0.018164634704589844
generate_one_block  0.004816293716430664
generate_one_block  0.003922700881958008
generate_one_block  0.0033004283905029297
generate_one_block  0.0038759708404541016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20808.7890625, 'VmSize': 20655.94921875, 'VmHWM': 3621.18359375, 'VmRSS': 3621.18359375}
connection checking time:  0.022480010986328125
block generation total time  0.02834916114807129
average batch blocks generation time:  0.007087290287017822
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.0081939697265625  GigaBytes
Max Memory Allocated: 0.0081939697265625  GigaBytes

{'VmPeak': 21004.78125, 'VmSize': 20977.234375, 'VmHWM': 3912.49609375, 'VmRSS': 3912.49609375}
torch.Size([1461, 1433])
torch.Size([660, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008586883544921875  GigaBytes
Max Memory Allocated: 0.008636951446533203  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21751.703125, 'VmHWM': 4609.4140625, 'VmRSS': 4609.4140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008737564086914062  GigaBytes
Max Memory Allocated: 0.01649951934814453  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21759.9375, 'VmHWM': 4617.84765625, 'VmRSS': 4617.84765625}
torch.Size([1496, 1433])
torch.Size([717, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0091552734375  GigaBytes
Max Memory Allocated: 0.01649951934814453  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21759.9375, 'VmHWM': 4617.84765625, 'VmRSS': 4617.84765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008546829223632812  GigaBytes
Max Memory Allocated: 0.01649951934814453  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21759.9375, 'VmHWM': 4618.0390625, 'VmRSS': 4618.0390625}
torch.Size([1315, 1433])
torch.Size([600, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008913516998291016  GigaBytes
Max Memory Allocated: 0.01649951934814453  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21759.9375, 'VmHWM': 4618.0390625, 'VmRSS': 4618.0390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008960247039794922  GigaBytes
Max Memory Allocated: 0.016718387603759766  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21760.16015625, 'VmHWM': 4618.7109375, 'VmRSS': 4618.7109375}
torch.Size([1537, 1433])
torch.Size([741, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00940561294555664  GigaBytes
Max Memory Allocated: 0.016718387603759766  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21760.16015625, 'VmHWM': 4618.7109375, 'VmRSS': 4618.7109375}
{'VmPeak': 21762.4921875, 'VmSize': 21760.16015625, 'VmHWM': 4619.01953125, 'VmRSS': 4619.01953125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009572982788085938 |0.09481734037399292 |0.19757115840911865 |0.00021064281463623047 |0.003353893756866455 |0.0024285316467285156 |
----------------------------------------------------------pseudo_mini_loss sum 3.5481629371643066
{'VmPeak': 21762.4921875, 'VmSize': 21760.16015625, 'VmHWM': 4619.01953125, 'VmRSS': 4619.01953125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9251
Number of first layer input nodes during this epoch:  5809
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009765625  GigaBytes
Max Memory Allocated: 0.016718387603759766  GigaBytes

{'VmPeak': 21762.4921875, 'VmSize': 21760.16015625, 'VmHWM': 4619.1484375, 'VmRSS': 4619.1484375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048542022705078125
global_2_local 7.724761962890625e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.605552673339844e-05
before graph partition 
		210, 155, 183, 191, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00023865699768066406
	Initialize BitList time :  1.52587890625e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 210, 155

	before terminate 1 the average redundancy rate is:  1.1335403726708075
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.1677018633540373,  1.0869565217391304
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.127329192546584,  1.204968944099379,  1.049689440993789
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1149068322981366,  1.049689440993789,  1.1801242236024845
	walk terminate 1 spend time 5.077535629272461
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.0683229813664596,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.0683229813664596,  1.1677018633540373
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.0993788819875776,  1.1366459627329193
	walk terminate 1 spend time 5.252987384796143
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		177, 183, 183, 191, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				27, 43, 35, 35, 


	preparing two sides time :  0.0005328655242919922
	Initialize BitList time :  4.363059997558594e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 183, 183

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.1118012422360248,  1.1614906832298137
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2484472049689441,  1.0
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 8
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.062111801242236,  1.1925465838509317
	walk terminate 1 spend time 5.041032791137695
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.15527950310559,  1.0807453416149069
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.1428571428571428,  1.093167701863354
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1180124223602483,  1.204968944099379,  1.031055900621118
	walk terminate 1 spend time 5.114824533462524
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		177, 166, 194, 191, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				27, 32, 46, 35, 


	preparing two sides time :  0.0005371570587158203
	Initialize BitList time :  3.0994415283203125e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 194, 191

	before terminate 1 the average redundancy rate is:  1.1956521739130435
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.1801242236024845,  1.2111801242236024
						 current side  1
			 redundancy will reduce  0.02795031055900621
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 7
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.124223602484472,  1.2236024844720497
	walk terminate 1 spend time 5.155466079711914
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.2981366459627328,  1.0434782608695652
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645965,  1.093167701863354,  1.2732919254658386
						 current side  1
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.2298136645962734,  1.124223602484472
	walk terminate 1 spend time 5.161051511764526
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		177, 166, 181, 198, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 30.81206774711609
partition_len_list
[177, 166, 181, 198]
random_init_graph_partition selection method range initialization spend 30.812798976898193
time for parepare:  0.00039267539978027344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0018990039825439453
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0005211830139160156
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00029969215393066406
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.00023102760314941406
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0002617835998535156
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002410411834716797
----------------------check_connections_block total spend ----------------------------- 0.0058138370513916016
generate_one_block  0.022614479064941406
generate_one_block  0.0014429092407226562
generate_one_block  0.0011649131774902344
generate_one_block  0.00135040283203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011310577392578125
gen group dst list time:  4.6253204345703125e-05
time for parepare:  0.0008983612060546875
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0005249977111816406
mini_batch_src_global generation:  0.0003273487091064453
r_  generation:  0.00044465065002441406
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  0.00031280517578125
r_  generation:  0.0003833770751953125
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004184246063232422
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004928112030029297
----------------------check_connections_block total spend ----------------------------- 0.005118131637573242
generate_one_block  0.0022902488708496094
generate_one_block  0.0016851425170898438
generate_one_block  0.001748800277709961
generate_one_block  0.001775979995727539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015361309051513672
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.0005457401275634766
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0016586780548095703
mini_batch_src_global generation:  0.0003502368927001953
r_  generation:  0.0014078617095947266
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0003509521484375
mini_batch_src_global generation:  0.00012922286987304688
r_  generation:  0.0010313987731933594
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0014090538024902344
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0003135204315185547
mini_batch_src_global generation:  0.0002143383026123047
r_  generation:  0.0014843940734863281
----------------------check_connections_block total spend ----------------------------- 0.011011600494384766
generate_one_block  0.0026428699493408203
generate_one_block  0.002286195755004883
generate_one_block  0.0025386810302734375
generate_one_block  0.0042726993560791016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009765625  GigaBytes
Max Memory Allocated: 0.016718387603759766  GigaBytes

{'VmPeak': 21824.42578125, 'VmSize': 21824.17578125, 'VmHWM': 4620.38671875, 'VmRSS': 4620.15234375}
connection checking time:  0.016129732131958008
block generation total time  0.019240617752075195
average batch blocks generation time:  0.004810154438018799
block dataloader generation time/epoch 30.89365553855896
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009829521179199219  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.58203125, 'VmRSS': 4622.58203125}
torch.Size([1568, 1433])
torch.Size([729, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.01025533676147461  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.58203125, 'VmRSS': 4622.58203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.00850057601928711  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.82421875, 'VmRSS': 4622.82421875}
torch.Size([1320, 1433])
torch.Size([584, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.00885629653930664  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.82421875, 'VmRSS': 4622.82421875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009828567504882812  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.8984375, 'VmRSS': 4622.8984375}
torch.Size([1391, 1433])
torch.Size([664, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.010228157043457031  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.8984375, 'VmRSS': 4622.8984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.009547233581542969  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.92578125, 'VmRSS': 4622.92578125}
torch.Size([1515, 1433])
torch.Size([735, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.00998544692993164  GigaBytes
Max Memory Allocated: 0.01799631118774414  GigaBytes

{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.92578125, 'VmRSS': 4622.92578125}
{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.92578125, 'VmRSS': 4622.92578125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018222928047180176 |0.0007625222206115723 |0.005999624729156494 |0.00021147727966308594 |0.00392758846282959 |0.00231170654296875 |
----------------------------------------------------------pseudo_mini_loss sum 2.4321913719177246
{'VmPeak': 21826.40234375, 'VmSize': 21826.40234375, 'VmHWM': 4622.92578125, 'VmRSS': 4622.92578125}
Total (block generation + training)time/epoch 31.021225929260254
Training time/epoch 0.12726283073425293
Training time without block to device /epoch 0.12421274185180664
Training time without total dataloading part /epoch 0.04286646842956543
load block tensor time/epoch 0.0728917121887207
block to device time/epoch 0.003050088882446289
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9228
Number of first layer input nodes during this epoch:  5794
