main start at this time 1648598217.8301394
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20801.7734375, 'VmSize': 20801.7734375, 'VmHWM': 3613.5078125, 'VmRSS': 3613.5078125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008759498596191406
global_2_local 7.390975952148438e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.369850158691406e-05
before graph partition 
		122, 70, 94, 77, 90, 95, 115, 85, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020813941955566406
	Initialize BitList time :  1.3113021850585938e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 122, 70

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.515527950310559,  0.8695652173913043
	walk terminate 1 spend time 3.9378697872161865
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 122, 94, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005090236663818359
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 94

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.515527950310559,  1.1677018633540373
	walk terminate 1 spend time 4.241443395614624
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 122, 77, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0007407665252685547
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 122, 77

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.515527950310559,  0.9565217391304348
	walk terminate 1 spend time 4.0100860595703125
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 122, 90, 95, 115, 85, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0006954669952392578
	Initialize BitList time :  0.00010061264038085938
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 90

	before terminate 1 the average redundancy rate is:  1.3167701863354035
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354035,  1.515527950310559,  1.1180124223602483
	walk terminate 1 spend time 4.491796255111694
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 122, 95, 115, 85, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046324729919433594
	Initialize BitList time :  2.6941299438476562e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 122, 95

	before terminate 1 the average redundancy rate is:  1.3478260869565217
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.515527950310559,  1.1801242236024845
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.177473306655884
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.639751552795031,  1.0434782608695652
	walk terminate 1 spend time 4.043827295303345
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 132, 115, 85, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 15, 21, 18, 14, 


	preparing two sides time :  0.0004088878631591797
	Initialize BitList time :  3.838539123535156e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 132, 115

	before terminate 1 the average redundancy rate is:  1.5341614906832297
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5341614906832297,  1.639751552795031,  1.4285714285714286
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.125109672546387
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.4906832298136645,  1.565217391304348
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.950310559006211,  1.1055900621118013
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.7763975155279503,  1.279503105590062
	walk terminate 1 spend time 4.220986366271973
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		70, 94, 77, 90, 84, 103, 143, 85, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 15, 19, 20, 14, 


	preparing two sides time :  0.0005173683166503906
	Initialize BitList time :  0.00011014938354492188
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 143, 85

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.7763975155279503,  1.0559006211180124
	walk terminate 1 spend time 4.274713516235352
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		70, 94, 77, 90, 84, 103, 85, 143, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.5471715927124
partition_len_list
[70, 94, 77, 90, 84, 103, 85, 143]
random_init_graph_partition selection method range initialization spend 37.54754400253296
time for parepare:  0.00011944770812988281
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.02355217933654785
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.009692907333374023
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  0.000102996826171875
----------------------check_connections_block total spend ----------------------------- 0.035704612731933594
generate_one_block  0.009630680084228516
generate_one_block  0.001150369644165039
generate_one_block  0.0010313987731933594
generate_one_block  0.001085519790649414
generate_one_block  0.0010423660278320312
generate_one_block  0.0010592937469482422
generate_one_block  0.001123189926147461
generate_one_block  0.0010941028594970703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021004676818847656
gen group dst list time:  0.0001227855682373047
time for parepare:  0.00035309791564941406
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0003085136413574219
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0002410411834716797
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00023865699768066406
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.000213623046875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00030231475830078125
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00023436546325683594
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00033354759216308594
----------------------check_connections_block total spend ----------------------------- 0.004682302474975586
generate_one_block  0.0020766258239746094
generate_one_block  0.0013158321380615234
generate_one_block  0.0014142990112304688
generate_one_block  0.0013751983642578125
generate_one_block  0.0013689994812011719
generate_one_block  0.0059773921966552734
generate_one_block  0.0013020038604736328
generate_one_block  0.001373291015625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007138252258300781
gen group dst list time:  0.00010561943054199219
time for parepare:  0.0006375312805175781
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0004470348358154297
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.0006530284881591797
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.0002124309539794922
r_  generation:  0.0007448196411132812
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0008196830749511719
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0007605552673339844
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006761550903320312
local_output_nid generation:  4.6253204345703125e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.0002722740173339844
r_  generation:  0.0009877681732177734
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0017576217651367188
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0004067420959472656
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.0020782947540283203
----------------------check_connections_block total spend ----------------------------- 0.016206741333007812
generate_one_block  0.004505634307861328
generate_one_block  0.004541635513305664
generate_one_block  0.0037474632263183594
generate_one_block  0.003194093704223633
generate_one_block  0.002940654754638672
generate_one_block  0.0030677318572998047
generate_one_block  0.0025391578674316406
generate_one_block  0.0028531551361083984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20807.88671875, 'VmSize': 20656.23046875, 'VmHWM': 3621.1171875, 'VmRSS': 3621.1171875}
connection checking time:  0.0208890438079834
block generation total time  0.04359316825866699
average batch blocks generation time:  0.005449146032333374
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005519390106201172  GigaBytes
Max Memory Allocated: 0.005519390106201172  GigaBytes

{'VmPeak': 21033.6015625, 'VmSize': 21001.86328125, 'VmHWM': 3936.328125, 'VmRSS': 3936.328125}
torch.Size([963, 1433])
torch.Size([379, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005732059478759766  GigaBytes
Max Memory Allocated: 0.005788326263427734  GigaBytes

{'VmPeak': 21755.8515625, 'VmSize': 21750.40234375, 'VmHWM': 4606.3515625, 'VmRSS': 4606.3515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006373882293701172  GigaBytes
Max Memory Allocated: 0.011491775512695312  GigaBytes

{'VmPeak': 21756.25390625, 'VmSize': 21756.25390625, 'VmHWM': 4613.06640625, 'VmRSS': 4613.06640625}
torch.Size([1056, 1433])
torch.Size([413, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006615638732910156  GigaBytes
Max Memory Allocated: 0.011491775512695312  GigaBytes

{'VmPeak': 21756.25390625, 'VmSize': 21756.25390625, 'VmHWM': 4613.06640625, 'VmRSS': 4613.06640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0071125030517578125  GigaBytes
Max Memory Allocated: 0.012724876403808594  GigaBytes

{'VmPeak': 21757.0078125, 'VmSize': 21757.0078125, 'VmHWM': 4614.5234375, 'VmRSS': 4614.5234375}
torch.Size([1194, 1433])
torch.Size([471, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0073699951171875  GigaBytes
Max Memory Allocated: 0.012724876403808594  GigaBytes

{'VmPeak': 21757.0078125, 'VmSize': 21757.0078125, 'VmHWM': 4614.5234375, 'VmRSS': 4614.5234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006369590759277344  GigaBytes
Max Memory Allocated: 0.012724876403808594  GigaBytes

{'VmPeak': 21757.0078125, 'VmSize': 21757.0078125, 'VmHWM': 4615.03515625, 'VmRSS': 4615.03515625}
torch.Size([1055, 1433])
torch.Size([424, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006613731384277344  GigaBytes
Max Memory Allocated: 0.012724876403808594  GigaBytes

{'VmPeak': 21757.0078125, 'VmSize': 21757.0078125, 'VmHWM': 4615.03515625, 'VmRSS': 4615.03515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005831718444824219  GigaBytes
Max Memory Allocated: 0.012724876403808594  GigaBytes

{'VmPeak': 21757.0078125, 'VmSize': 21757.0078125, 'VmHWM': 4615.6171875, 'VmRSS': 4615.6171875}
torch.Size([955, 1433])
torch.Size([393, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006057262420654297  GigaBytes
Max Memory Allocated: 0.012724876403808594  GigaBytes

{'VmPeak': 21757.0078125, 'VmSize': 21757.0078125, 'VmHWM': 4615.6171875, 'VmRSS': 4615.6171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0077152252197265625  GigaBytes
Max Memory Allocated: 0.012783527374267578  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.4140625, 'VmRSS': 4616.4140625}
torch.Size([1306, 1433])
torch.Size([597, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0080413818359375  GigaBytes
Max Memory Allocated: 0.012783527374267578  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.4140625, 'VmRSS': 4616.4140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006449699401855469  GigaBytes
Max Memory Allocated: 0.013397693634033203  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.48828125, 'VmRSS': 4616.48828125}
torch.Size([1070, 1433])
torch.Size([455, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006703853607177734  GigaBytes
Max Memory Allocated: 0.013397693634033203  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.48828125, 'VmRSS': 4616.48828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007256984710693359  GigaBytes
Max Memory Allocated: 0.013397693634033203  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.5703125, 'VmRSS': 4616.5703125}
torch.Size([1220, 1433])
torch.Size([518, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0075740814208984375  GigaBytes
Max Memory Allocated: 0.013397693634033203  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.5703125, 'VmRSS': 4616.5703125}
{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.8203125, 'VmRSS': 4616.8203125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01204797625541687 |0.04583701491355896 |0.09929588437080383 |0.00014421343803405762 |0.0037509500980377197 |0.0024518966674804688 |
----------------------------------------------------------pseudo_mini_loss sum 3.669508457183838
{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.8203125, 'VmRSS': 4616.8203125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13215
Number of first layer input nodes during this epoch:  8819
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008039474487304688  GigaBytes
Max Memory Allocated: 0.013397693634033203  GigaBytes

{'VmPeak': 21757.62109375, 'VmSize': 21757.62109375, 'VmHWM': 4616.8203125, 'VmRSS': 4616.8203125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004839897155761719
global_2_local 7.653236389160156e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  7.677078247070312e-05
before graph partition 
		94, 124, 76, 84, 83, 114, 81, 97, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002295970916748047
	Initialize BitList time :  1.33514404296875e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 94, 124

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.1677018633540373,  1.5403726708074534
	walk terminate 1 spend time 5.151068210601807
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		94, 124, 76, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046706199645996094
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 76

	before terminate 1 the average redundancy rate is:  1.2422360248447206
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.3788819875776397,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.2546583850931676,  1.204968944099379
	walk terminate 1 spend time 5.070494174957275
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1925465838509317,  1.2670807453416149
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.3043478260869565,  1.15527950310559
	walk terminate 1 spend time 4.8846211433410645
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		94, 93, 105, 84, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 22, 14, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00031113624572753906
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 105, 84

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.3043478260869565,  1.0434782608695652
	walk terminate 1 spend time 5.084065198898315
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 105, 83, 114, 81, 97, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 22, 18, 14, 18, 18, 18, 14, 


	preparing two sides time :  0.0004668235778808594
	Initialize BitList time :  4.458427429199219e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 105, 83

	before terminate 1 the average redundancy rate is:  1.1677018633540373
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.3043478260869565,  1.031055900621118
	walk terminate 1 spend time 5.09853982925415
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 105, 114, 81, 97, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 22, 18, 18, 14, 18, 18, 14, 


	preparing two sides time :  0.0009393692016601562
	Initialize BitList time :  5.221366882324219e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 105, 114

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.3043478260869565,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
	walk terminate 1 spend time 5.119192600250244
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.2546583850931676,  1.453416149068323
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3478260869565217,  1.0559006211180124,  1.639751552795031
	walk terminate 1 spend time 5.059445142745972
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		94, 93, 84, 83, 85, 132, 81, 97, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 22, 18, 18, 10, 22, 18, 14, 


	preparing two sides time :  0.00048065185546875
	Initialize BitList time :  4.38690185546875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 132, 81

	before terminate 1 the average redundancy rate is:  1.3229813664596273
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.639751552795031,  1.0062111801242235
	walk terminate 1 spend time 4.9863121509552
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 132, 97, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 22, 18, 18, 10, 18, 22, 14, 


	preparing two sides time :  0.00047278404235839844
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 132, 97

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4223602484472049,  1.639751552795031,  1.204968944099379
	walk terminate 1 spend time 4.957081079483032
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		94, 93, 84, 83, 85, 81, 97, 132, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 45.434728145599365
partition_len_list
[94, 93, 84, 83, 85, 81, 97, 132]
random_init_graph_partition selection method range initialization spend 45.435112714767456
time for parepare:  0.0001087188720703125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.001445770263671875
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.00033926963806152344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.367134094238281e-05
----------------------check_connections_block total spend ----------------------------- 0.0045392513275146484
generate_one_block  0.01705026626586914
generate_one_block  0.0012676715850830078
generate_one_block  0.0013730525970458984
generate_one_block  0.0010809898376464844
generate_one_block  0.0010945796966552734
generate_one_block  0.0011858940124511719
generate_one_block  0.000990152359008789
generate_one_block  0.0010223388671875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.003403186798095703
gen group dst list time:  0.00018787384033203125
time for parepare:  0.002810239791870117
local_output_nid generation:  0.00012683868408203125
local_in_edges_tensor generation:  0.0006604194641113281
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0007042884826660156
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.0005118846893310547
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0007185935974121094
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0006451606750488281
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002560615539550781
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.00042629241943359375
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0004162788391113281
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0006010532379150391
----------------------check_connections_block total spend ----------------------------- 0.012255191802978516
generate_one_block  0.001971721649169922
generate_one_block  0.0017859935760498047
generate_one_block  0.0018796920776367188
generate_one_block  0.0018677711486816406
generate_one_block  0.0012586116790771484
generate_one_block  0.0012276172637939453
generate_one_block  0.001425027847290039
generate_one_block  0.001493692398071289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011248588562011719
gen group dst list time:  0.00011992454528808594
time for parepare:  0.0005793571472167969
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0009331703186035156
mini_batch_src_global generation:  0.00036716461181640625
r_  generation:  0.0009665489196777344
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0003769397735595703
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0007436275482177734
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00038909912109375
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0009000301361083984
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0008141994476318359
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006396770477294922
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0006537437438964844
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.000270843505859375
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0008401870727539062
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.001004934310913086
----------------------check_connections_block total spend ----------------------------- 0.013680458068847656
generate_one_block  0.002165079116821289
generate_one_block  0.0019147396087646484
generate_one_block  0.002351999282836914
generate_one_block  0.0020613670349121094
generate_one_block  0.0016171932220458984
generate_one_block  0.0017342567443847656
generate_one_block  0.0026979446411132812
generate_one_block  0.0039272308349609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008039474487304688  GigaBytes
Max Memory Allocated: 0.013397693634033203  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21821.63671875, 'VmHWM': 4617.3828125, 'VmRSS': 4617.27734375}
connection checking time:  0.025935649871826172
block generation total time  0.03137993812561035
average batch blocks generation time:  0.003922492265701294
block dataloader generation time/epoch 45.53972554206848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00875234603881836  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.04296875, 'VmRSS': 4621.04296875}
torch.Size([1273, 1433])
torch.Size([522, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00903940200805664  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.04296875, 'VmRSS': 4621.04296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0067539215087890625  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.16796875, 'VmRSS': 4621.16796875}
torch.Size([995, 1433])
torch.Size([407, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006991863250732422  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.16796875, 'VmRSS': 4621.16796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00796651840209961  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.234375, 'VmRSS': 4621.234375}
torch.Size([1221, 1433])
torch.Size([529, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008252143859863281  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.234375, 'VmRSS': 4621.234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007178306579589844  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.2578125, 'VmRSS': 4621.2578125}
torch.Size([1074, 1433])
torch.Size([478, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007440090179443359  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.2578125, 'VmRSS': 4621.2578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006474494934082031  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.3515625, 'VmRSS': 4621.3515625}
torch.Size([943, 1433])
torch.Size([334, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006676673889160156  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.3515625, 'VmRSS': 4621.3515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0065746307373046875  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.421875, 'VmRSS': 4621.421875}
torch.Size([962, 1433])
torch.Size([346, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006778717041015625  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.62109375, 'VmHWM': 4621.421875, 'VmRSS': 4621.421875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0071258544921875  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.60546875, 'VmHWM': 4621.421875, 'VmRSS': 4621.41796875}
torch.Size([1064, 1433])
torch.Size([433, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007380008697509766  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.60546875, 'VmHWM': 4621.421875, 'VmRSS': 4621.41796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008252620697021484  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.60546875, 'VmHWM': 4621.421875, 'VmRSS': 4621.421875}
torch.Size([1274, 1433])
torch.Size([574, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008585453033447266  GigaBytes
Max Memory Allocated: 0.015239238739013672  GigaBytes

{'VmPeak': 21885.63671875, 'VmSize': 21825.60546875, 'VmHWM': 4621.421875, 'VmRSS': 4621.421875}
{'VmPeak': 21885.63671875, 'VmSize': 21825.60546875, 'VmHWM': 4621.42578125, 'VmRSS': 4621.42578125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012108385562896729 |0.0005955100059509277 |0.004318535327911377 |0.0001691579818725586 |0.0028483569622039795 |0.0019161701202392578 |
----------------------------------------------------------pseudo_mini_loss sum 2.6012606620788574
{'VmPeak': 21885.63671875, 'VmSize': 21825.60546875, 'VmHWM': 4621.42578125, 'VmRSS': 4621.42578125}
Total (block generation + training)time/epoch 45.71470594406128
Training time/epoch 0.17475509643554688
Training time without block to device /epoch 0.16999101638793945
Training time without total dataloading part /epoch 0.06060457229614258
load block tensor time/epoch 0.09686708450317383
block to device time/epoch 0.004764080047607422
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13178
Number of first layer input nodes during this epoch:  8806
