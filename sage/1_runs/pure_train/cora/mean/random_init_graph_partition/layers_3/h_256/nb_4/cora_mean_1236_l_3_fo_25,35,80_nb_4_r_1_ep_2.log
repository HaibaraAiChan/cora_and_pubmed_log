main start at this time 1648602472.773987
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20812.58203125, 'VmSize': 20804.5, 'VmHWM': 3615.671875, 'VmRSS': 3615.671875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018188953399658203
global_2_local 0.00012063980102539062
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00025653839111328125
before graph partition 
		150, 174, 211, 195, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00039458274841308594
	Initialize BitList time :  2.5272369384765625e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 150, 174

	before terminate 1 the average redundancy rate is:  1.0062111801242235
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0062111801242235,  0.9440993788819876,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0062111801242235,  0.9316770186335404,  1.0807453416149069
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0062111801242235,  0.9751552795031055,  1.0372670807453417
	walk terminate 1 spend time 4.334491491317749
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		157, 167, 211, 195, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0004253387451171875
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 167, 211

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0559006211180124,  1.2919254658385093
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0434782608695652,  1.3043478260869565
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.186335403726708,  1.1304347826086956
	walk terminate 1 spend time 4.514038562774658
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.049689440993789,  1.2546583850931676
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.1304347826086956,  1.173913043478261
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.1118012422360248,  1.1925465838509317
	walk terminate 1 spend time 4.571063756942749
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		157, 179, 192, 195, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 35, 34, 35, 


	preparing two sides time :  0.0005357265472412109
	Initialize BitList time :  4.6253204345703125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 192, 195

	before terminate 1 the average redundancy rate is:  1.201863354037267
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.009316770186335255
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.2919254658385093,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.1925465838509317,  1.1987577639751552
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.329192546583851,  1.031055900621118
	walk terminate 1 spend time 4.475626468658447
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1118012422360248,  1.2484472049689441
						 current side  1
			 redundancy will reduce  0.024844720496894235
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.1925465838509317,  1.1614906832298137
						 current side  0
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.0,  1.360248447204969
	walk terminate 1 spend time 4.554810523986816
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		157, 179, 161, 219, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 22.463371515274048
partition_len_list
[157, 179, 161, 219]
random_init_graph_partition selection method range initialization spend 22.463998556137085
time for parepare:  0.00017023086547851562
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0011010169982910156
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.017352819442749023
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.198883056640625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00012969970703125
----------------------check_connections_block total spend ----------------------------- 0.020392179489135742
generate_one_block  0.010159015655517578
generate_one_block  0.001211404800415039
generate_one_block  0.0010833740234375
generate_one_block  0.0011188983917236328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001255035400390625
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.0007088184356689453
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00045561790466308594
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.00035262107849121094
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00026035308837890625
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0005643367767333984
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00034809112548828125
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006003379821777344
----------------------check_connections_block total spend ----------------------------- 0.004613161087036133
generate_one_block  0.0014829635620117188
generate_one_block  0.0015072822570800781
generate_one_block  0.0014750957489013672
generate_one_block  0.0017588138580322266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001561880111694336
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.0004227161407470703
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0005929470062255859
mini_batch_src_global generation:  0.00040340423583984375
r_  generation:  0.00091552734375
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0005655288696289062
mini_batch_src_global generation:  0.00041484832763671875
r_  generation:  0.0015149116516113281
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00034332275390625
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0010313987731933594
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0013577938079833984
----------------------check_connections_block total spend ----------------------------- 0.010167837142944336
generate_one_block  0.002134084701538086
generate_one_block  0.0024726390838623047
generate_one_block  0.0066454410552978516
generate_one_block  0.006255388259887695
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20812.58203125, 'VmSize': 20656.40234375, 'VmHWM': 3620.6328125, 'VmRSS': 3620.58984375}
connection checking time:  0.014780998229980469
block generation total time  0.023731708526611328
average batch blocks generation time:  0.005932927131652832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.010221004486083984  GigaBytes
Max Memory Allocated: 0.010221004486083984  GigaBytes

{'VmPeak': 21004.94921875, 'VmSize': 20977.171875, 'VmHWM': 3911.71484375, 'VmRSS': 3911.71484375}
torch.Size([1301, 1433])
torch.Size([561, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.012641429901123047  GigaBytes
Max Memory Allocated: 0.01309347152709961  GigaBytes

{'VmPeak': 21760.60546875, 'VmSize': 21754.1171875, 'VmHWM': 4611.046875, 'VmRSS': 4611.046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.014584541320800781  GigaBytes
Max Memory Allocated: 0.021491527557373047  GigaBytes

{'VmPeak': 21762.44921875, 'VmSize': 21762.44921875, 'VmHWM': 4619.4296875, 'VmRSS': 4619.4296875}
torch.Size([1510, 1433])
torch.Size([741, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.017659664154052734  GigaBytes
Max Memory Allocated: 0.021491527557373047  GigaBytes

{'VmPeak': 21826.4453125, 'VmSize': 21794.44921875, 'VmHWM': 4619.4296875, 'VmRSS': 4619.4296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.01346445083618164  GigaBytes
Max Memory Allocated: 0.021491527557373047  GigaBytes

{'VmPeak': 21826.4453125, 'VmSize': 21794.44921875, 'VmHWM': 4619.9921875, 'VmRSS': 4619.9921875}
torch.Size([1292, 1433])
torch.Size([591, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.01599597930908203  GigaBytes
Max Memory Allocated: 0.021491527557373047  GigaBytes

{'VmPeak': 21826.4453125, 'VmSize': 21794.44921875, 'VmHWM': 4619.9921875, 'VmRSS': 4619.9921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.015499114990234375  GigaBytes
Max Memory Allocated: 0.022399425506591797  GigaBytes

{'VmPeak': 21826.4453125, 'VmSize': 21803.6328125, 'VmHWM': 4627.93359375, 'VmRSS': 4627.93359375}
torch.Size([1680, 1433])
torch.Size([833, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.019030094146728516  GigaBytes
Max Memory Allocated: 0.022399425506591797  GigaBytes

{'VmPeak': 21826.4453125, 'VmSize': 21803.6328125, 'VmHWM': 4628.14453125, 'VmRSS': 4628.14453125}
{'VmPeak': 21826.4453125, 'VmSize': 21803.6328125, 'VmHWM': 4628.58203125, 'VmRSS': 4628.58203125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012774288654327393 |0.0939401388168335 |0.19716119766235352 |0.00019532442092895508 |0.004550278186798096 |0.0023009777069091797 |
----------------------------------------------------------pseudo_mini_loss sum 4.092480182647705
{'VmPeak': 21826.4453125, 'VmSize': 21803.6328125, 'VmHWM': 4628.58203125, 'VmRSS': 4628.58203125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9225
Number of first layer input nodes during this epoch:  5783
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.022495746612548828  GigaBytes
Max Memory Allocated: 0.027962684631347656  GigaBytes

{'VmPeak': 21826.4453125, 'VmSize': 21803.6328125, 'VmHWM': 4628.58203125, 'VmRSS': 4628.58203125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005466938018798828
global_2_local 8.845329284667969e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.630752563476562e-05
before graph partition 
		189, 182, 176, 184, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00027561187744140625
	Initialize BitList time :  1.7881393432617188e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 189, 182

	before terminate 1 the average redundancy rate is:  1.1521739130434783
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.0993788819875776,  1.204968944099379
						 current side  1
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.2298136645962734,  1.0559006211180124
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1335403726708075,  1.0683229813664596,  1.1987577639751552
	walk terminate 1 spend time 5.3849897384643555
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1335403726708075,  1.2484472049689441,  1.0186335403726707
						 current side  0
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.124223602484472,  1.1304347826086956
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.2111801242236024,  1.0434782608695652
	walk terminate 1 spend time 5.363887071609497
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		168, 195, 176, 184, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				33, 37, 35, 35, 


	preparing two sides time :  0.0005338191986083984
	Initialize BitList time :  5.1021575927734375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 195, 176

	before terminate 1 the average redundancy rate is:  1.1521739130434783
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.0,  1.2981366459627328
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813665,  1.1614906832298137,  1.1366459627329193
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.0372670807453417,  1.2546583850931676
	walk terminate 1 spend time 5.3975536823272705
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.2670807453416149,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.0869565217391304,  1.204968944099379
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.236024844720497,  1.0559006211180124
	walk terminate 1 spend time 5.530458688735962
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		168, 170, 199, 184, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				33, 32, 40, 35, 


	preparing two sides time :  0.000820159912109375
	Initialize BitList time :  5.435943603515625e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 199, 184

	before terminate 1 the average redundancy rate is:  1.18944099378882
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.0062111801242235,  1.360248447204969
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.1987577639751552,  1.1490683229813665
						 current side  0
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.0869565217391304,  1.2484472049689441
	walk terminate 1 spend time 5.429099798202515
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 8
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.329192546583851,  1.0
						 current side  0
			 redundancy will reduce  0.02795031055900621
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.2173913043478262,  1.1055900621118013
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2298136645962734,  1.0869565217391304
	walk terminate 1 spend time 5.453904151916504
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		168, 170, 175, 198, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 32.57018065452576
partition_len_list
[168, 170, 175, 198]
random_init_graph_partition selection method range initialization spend 32.570858001708984
time for parepare:  0.00015926361083984375
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0015306472778320312
mini_batch_src_global generation:  0.00015282630920410156
r_  generation:  0.0005421638488769531
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00013875961303710938
----------------------check_connections_block total spend ----------------------------- 0.004374027252197266
generate_one_block  0.018115520477294922
generate_one_block  0.0012781620025634766
generate_one_block  0.0011646747589111328
generate_one_block  0.0014824867248535156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013642311096191406
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.0004277229309082031
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0003857612609863281
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  0.0001373291015625
r_  generation:  0.00036144256591796875
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00037407875061035156
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.00046133995056152344
----------------------check_connections_block total spend ----------------------------- 0.003916501998901367
generate_one_block  0.002010822296142578
generate_one_block  0.0015757083892822266
generate_one_block  0.0015902519226074219
generate_one_block  0.0017845630645751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014789104461669922
gen group dst list time:  7.510185241699219e-05
time for parepare:  0.0003066062927246094
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0010671615600585938
mini_batch_src_global generation:  0.000270843505859375
r_  generation:  0.0010335445404052734
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00048422813415527344
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0010325908660888672
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0012812614440917969
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0015211105346679688
----------------------check_connections_block total spend ----------------------------- 0.009984731674194336
generate_one_block  0.0022630691528320312
generate_one_block  0.002217531204223633
generate_one_block  0.0023937225341796875
generate_one_block  0.00264739990234375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.022495746612548828  GigaBytes
Max Memory Allocated: 0.027962684631347656  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.01171875, 'VmRSS': 4631.01171875}
connection checking time:  0.013901233673095703
block generation total time  0.016483068466186523
average batch blocks generation time:  0.004120767116546631
block dataloader generation time/epoch 32.641292572021484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.020353317260742188  GigaBytes
Max Memory Allocated: 0.029288291931152344  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.890625, 'VmRSS': 4631.890625}
torch.Size([1281, 1433])
torch.Size([606, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.022958755493164062  GigaBytes
Max Memory Allocated: 0.029288291931152344  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.890625, 'VmRSS': 4631.890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.020485877990722656  GigaBytes
Max Memory Allocated: 0.029288291931152344  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
torch.Size([1326, 1433])
torch.Size([604, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.02309274673461914  GigaBytes
Max Memory Allocated: 0.029288291931152344  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.021125316619873047  GigaBytes
Max Memory Allocated: 0.029288291931152344  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
torch.Size([1445, 1433])
torch.Size([659, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.023928165435791016  GigaBytes
Max Memory Allocated: 0.029288291931152344  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2908935546875 GB
    Memory Allocated: 0.021962642669677734  GigaBytes
Max Memory Allocated: 0.02963542938232422  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
torch.Size([1601, 1433])
torch.Size([787, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2908935546875 GB
    Memory Allocated: 0.025261878967285156  GigaBytes
Max Memory Allocated: 0.02963542938232422  GigaBytes

{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027583301067352295 |0.0008512139320373535 |0.006752073764801025 |0.00027883052825927734 |0.002747476100921631 |0.0026199817657470703 |
----------------------------------------------------------pseudo_mini_loss sum 1.0277917385101318
{'VmPeak': 21931.6484375, 'VmSize': 21867.8984375, 'VmHWM': 4631.9765625, 'VmRSS': 4631.9765625}
Total (block generation + training)time/epoch 32.80569314956665
Training time/epoch 0.16354155540466309
Training time without block to device /epoch 0.16013669967651367
Training time without total dataloading part /epoch 0.041733503341674805
load block tensor time/epoch 0.11033320426940918
block to device time/epoch 0.003404855728149414
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9020
Number of first layer input nodes during this epoch:  5653
