main start at this time 1648603196.602063
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20813.42578125, 'VmSize': 20808.08203125, 'VmHWM': 3619.3125, 'VmRSS': 3619.3125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013549327850341797
global_2_local 6.866455078125e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.869171142578125e-05
before graph partition 
		315, 381, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.00030231475830078125
	Initialize BitList time :  1.9788742065429688e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 315, 381

	before terminate 1 the average redundancy rate is:  1.0807453416149069
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  0.9782608695652174,  1.1832298136645962
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  0.9782608695652174,  1.1832298136645962
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  0.9782608695652174,  1.1832298136645962
	walk terminate 1 spend time 4.408961772918701
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		315, 381, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.4123923778533936
partition_len_list
[315, 381]
random_init_graph_partition selection method range initialization spend 4.412806749343872
time for parepare:  0.00013685226440429688
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.010623931884765625
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.016790390014648438
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0003752708435058594
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.00023484230041503906
----------------------check_connections_block total spend ----------------------------- 0.029162883758544922
generate_one_block  0.009508609771728516
generate_one_block  0.0013859272003173828
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023517608642578125
gen group dst list time:  3.4809112548828125e-05
time for parepare:  0.0007841587066650391
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0005638599395751953
mini_batch_src_global generation:  0.0003464221954345703
r_  generation:  0.0008456707000732422
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.0007929801940917969
----------------------check_connections_block total spend ----------------------------- 0.004851102828979492
generate_one_block  0.0018711090087890625
generate_one_block  0.002029895782470703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0018358230590820312
gen group dst list time:  6.937980651855469e-05
time for parepare:  0.0002162456512451172
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0013201236724853516
mini_batch_src_global generation:  0.0006022453308105469
r_  generation:  0.002001047134399414
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0010128021240234375
mini_batch_src_global generation:  0.0005595684051513672
r_  generation:  0.0021114349365234375
----------------------check_connections_block total spend ----------------------------- 0.009438514709472656
generate_one_block  0.0030226707458496094
generate_one_block  0.003907680511474609
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20813.42578125, 'VmSize': 20658.05078125, 'VmHWM': 3622.375, 'VmRSS': 3622.3671875}
connection checking time:  0.014289617538452148
block generation total time  0.010831356048583984
average batch blocks generation time:  0.005415678024291992
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.013381481170654297  GigaBytes
Max Memory Allocated: 0.013381481170654297  GigaBytes

{'VmPeak': 21004.83203125, 'VmSize': 20977.01171875, 'VmHWM': 3911.28515625, 'VmRSS': 3911.28515625}
torch.Size([1888, 1433])
torch.Size([1083, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.018880844116210938  GigaBytes
Max Memory Allocated: 0.019173622131347656  GigaBytes

{'VmPeak': 21755.5625, 'VmSize': 21755.546875, 'VmHWM': 4611.875, 'VmRSS': 4611.875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.01741504669189453  GigaBytes
Max Memory Allocated: 0.02742624282836914  GigaBytes

{'VmPeak': 21766.625, 'VmSize': 21766.625, 'VmHWM': 4623.31640625, 'VmRSS': 4623.31640625}
torch.Size([2012, 1433])
torch.Size([1253, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.02293109893798828  GigaBytes
Max Memory Allocated: 0.02742624282836914  GigaBytes

{'VmPeak': 21766.625, 'VmSize': 21766.625, 'VmHWM': 4623.31640625, 'VmRSS': 4623.31640625}
{'VmPeak': 21766.625, 'VmSize': 21766.625, 'VmHWM': 4623.7734375, 'VmRSS': 4623.7734375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014795303344726562 |0.18331444263458252 |0.40441668033599854 |0.0003751516342163086 |0.00635075569152832 |0.0021839141845703125 |
----------------------------------------------------------pseudo_mini_loss sum 4.318365573883057
{'VmPeak': 21766.625, 'VmSize': 21766.625, 'VmHWM': 4623.7734375, 'VmRSS': 4623.7734375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6932
Number of first layer input nodes during this epoch:  3900
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.02414989471435547  GigaBytes
Max Memory Allocated: 0.029616832733154297  GigaBytes

{'VmPeak': 21766.625, 'VmSize': 21766.625, 'VmHWM': 4624.1484375, 'VmRSS': 4624.1484375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000560760498046875
global_2_local 9.465217590332031e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.821487426757812e-05
before graph partition 
		352, 341, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.00034236907958984375
	Initialize BitList time :  2.1457672119140625e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 352, 341

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.093167701863354,  1.0590062111801242
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.1211180124223603,  1.0279503105590062
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0776397515527951,  1.0714285714285714
	walk terminate 1 spend time 5.452616453170776
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596275,  1.049689440993789,  1.0962732919254659
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596275,  1.093167701863354,  1.0527950310559007
						 current side  0
			 redundancy will reduce  0.007763975155279601
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0683229813664596,  1.0590062111801242,  1.0776397515527951
	walk terminate 1 spend time 5.470682859420776
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		341, 347, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 10.927372217178345
partition_len_list
[341, 347]
random_init_graph_partition selection method range initialization spend 10.927893877029419
time for parepare:  0.0001690387725830078
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.058825016021728516
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.00039458274841308594
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0001785755157470703
----------------------check_connections_block total spend ----------------------------- 0.060807228088378906
generate_one_block  0.014974832534790039
generate_one_block  0.0012140274047851562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0015785694122314453
gen group dst list time:  4.553794860839844e-05
time for parepare:  0.0005357265472412109
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.0006067752838134766
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.0007162094116210938
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0006995201110839844
----------------------check_connections_block total spend ----------------------------- 0.003834247589111328
generate_one_block  0.0022258758544921875
generate_one_block  0.009565114974975586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06708407402038574
gen group dst list time:  0.00023984909057617188
time for parepare:  0.000400543212890625
local_output_nid generation:  0.00018286705017089844
local_in_edges_tensor generation:  0.045083045959472656
mini_batch_src_global generation:  0.0005700588226318359
r_  generation:  0.002162456512451172
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0009565353393554688
mini_batch_src_global generation:  0.00036644935607910156
r_  generation:  0.0019817352294921875
----------------------check_connections_block total spend ----------------------------- 0.053114891052246094
generate_one_block  0.003824949264526367
generate_one_block  0.003644227981567383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.02414989471435547  GigaBytes
Max Memory Allocated: 0.029616832733154297  GigaBytes

{'VmPeak': 21894.640625, 'VmSize': 21830.625, 'VmHWM': 4626.21484375, 'VmRSS': 4625.95703125}
connection checking time:  0.05694913864135742
block generation total time  0.019260168075561523
average batch blocks generation time:  0.009630084037780762
block dataloader generation time/epoch 11.169007301330566
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.02334451675415039  GigaBytes
Max Memory Allocated: 0.03402423858642578  GigaBytes

{'VmPeak': 21894.640625, 'VmSize': 21862.625, 'VmHWM': 4626.76171875, 'VmRSS': 4626.76171875}
torch.Size([1892, 1433])
torch.Size([1123, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.02956867218017578  GigaBytes
Max Memory Allocated: 0.03402423858642578  GigaBytes

{'VmPeak': 21894.640625, 'VmSize': 21862.625, 'VmHWM': 4626.76171875, 'VmRSS': 4626.76171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.02359628677368164  GigaBytes
Max Memory Allocated: 0.03402423858642578  GigaBytes

{'VmPeak': 21894.640625, 'VmSize': 21862.625, 'VmHWM': 4626.765625, 'VmRSS': 4626.765625}
torch.Size([1939, 1433])
torch.Size([1164, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.029688358306884766  GigaBytes
Max Memory Allocated: 0.03402423858642578  GigaBytes

{'VmPeak': 21894.640625, 'VmSize': 21862.625, 'VmHWM': 4626.765625, 'VmRSS': 4626.765625}
{'VmPeak': 21894.640625, 'VmSize': 21862.625, 'VmHWM': 4626.765625, 'VmRSS': 4626.765625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005534648895263672 |0.0004838705062866211 |0.003995537757873535 |0.0001785755157470703 |0.003479480743408203 |0.0016057491302490234 |
----------------------------------------------------------pseudo_mini_loss sum 0.875048041343689
{'VmPeak': 21894.640625, 'VmSize': 21862.625, 'VmHWM': 4626.765625, 'VmRSS': 4626.765625}
Total (block generation + training)time/epoch 11.200968742370605
Training time/epoch 0.031752586364746094
Training time without block to device /epoch 0.03078484535217285
Training time without total dataloading part /epoch 0.01691293716430664
load block tensor time/epoch 0.011069297790527344
block to device time/epoch 0.0009677410125732422
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6806
Number of first layer input nodes during this epoch:  3831
