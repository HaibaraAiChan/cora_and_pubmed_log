main start at this time 1648602816.37384
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20810.7734375, 'VmSize': 20807.0546875, 'VmHWM': 3618.19921875, 'VmRSS': 3618.19921875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009951591491699219
global_2_local 9.584426879882812e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  9.560585021972656e-05
before graph partition 
		315, 381, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0003523826599121094
	Initialize BitList time :  2.193450927734375e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 315, 381

	before terminate 1 the average redundancy rate is:  1.0807453416149069
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  0.9782608695652174,  1.1832298136645962
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  0.9782608695652174,  1.1832298136645962
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0807453416149069,  0.9782608695652174,  1.1832298136645962
	walk terminate 1 spend time 4.853411436080933
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		315, 381, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 4.857486724853516
partition_len_list
[315, 381]
random_init_graph_partition selection method range initialization spend 4.857972621917725
time for parepare:  0.00016021728515625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0010628700256347656
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.014736175537109375
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.00023293495178222656
----------------------check_connections_block total spend ----------------------------- 0.017694950103759766
generate_one_block  0.014182329177856445
generate_one_block  0.0013914108276367188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014925003051757812
gen group dst list time:  8.988380432128906e-05
time for parepare:  0.0007288455963134766
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0006055831909179688
mini_batch_src_global generation:  0.00032067298889160156
r_  generation:  0.0009551048278808594
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.0010247230529785156
----------------------check_connections_block total spend ----------------------------- 0.005126476287841797
generate_one_block  0.0023636817932128906
generate_one_block  0.0027642250061035156
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001224517822265625
gen group dst list time:  0.00010323524475097656
time for parepare:  0.00021958351135253906
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.00115203857421875
mini_batch_src_global generation:  0.0005300045013427734
r_  generation:  0.0024361610412597656
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.0009138584136962891
mini_batch_src_global generation:  0.0006494522094726562
r_  generation:  0.002466440200805664
----------------------check_connections_block total spend ----------------------------- 0.010172605514526367
generate_one_block  0.0037009716033935547
generate_one_block  0.003689289093017578
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20810.7734375, 'VmSize': 20656.94921875, 'VmHWM': 3621.24609375, 'VmRSS': 3621.24609375}
connection checking time:  0.015299081802368164
block generation total time  0.012518167495727539
average batch blocks generation time:  0.0062590837478637695
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.013252735137939453  GigaBytes
Max Memory Allocated: 0.013252735137939453  GigaBytes

{'VmPeak': 21033.05078125, 'VmSize': 21001.3125, 'VmHWM': 3935.1328125, 'VmRSS': 3935.1328125}
torch.Size([1864, 1433])
torch.Size([1083, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.018901824951171875  GigaBytes
Max Memory Allocated: 0.019194602966308594  GigaBytes

{'VmPeak': 21756.8203125, 'VmSize': 21752.34765625, 'VmHWM': 4607.82421875, 'VmRSS': 4607.82421875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2576904296875 GB
    Memory Allocated: 0.017494678497314453  GigaBytes
Max Memory Allocated: 0.027379989624023438  GigaBytes

{'VmPeak': 21763.328125, 'VmSize': 21763.328125, 'VmHWM': 4620.06640625, 'VmRSS': 4620.06640625}
torch.Size([1999, 1433])
torch.Size([1251, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.02300262451171875  GigaBytes
Max Memory Allocated: 0.027379989624023438  GigaBytes

{'VmPeak': 21763.328125, 'VmSize': 21763.328125, 'VmHWM': 4620.06640625, 'VmRSS': 4620.06640625}
{'VmPeak': 21763.328125, 'VmSize': 21763.328125, 'VmHWM': 4620.16796875, 'VmRSS': 4620.16796875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018258213996887207 |0.19162118434906006 |0.41799962520599365 |0.0003681182861328125 |0.005331873893737793 |0.004324674606323242 |
----------------------------------------------------------pseudo_mini_loss sum 4.270647048950195
{'VmPeak': 21763.328125, 'VmSize': 21763.328125, 'VmHWM': 4620.54296875, 'VmRSS': 4620.54296875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6893
Number of first layer input nodes during this epoch:  3863
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.024202823638916016  GigaBytes
Max Memory Allocated: 0.029669761657714844  GigaBytes

{'VmPeak': 21763.328125, 'VmSize': 21763.328125, 'VmHWM': 4620.54296875, 'VmRSS': 4620.54296875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009860992431640625
global_2_local 0.00015926361083984375
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.00010824203491210938
before graph partition 
		352, 341, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0004088878631591797
	Initialize BitList time :  2.5510787963867188e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 352, 341

	before terminate 1 the average redundancy rate is:  1.0760869565217392
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0760869565217392,  1.093167701863354,  1.0590062111801242
						 current side  1
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.1211180124223603,  1.0279503105590062
						 current side  0
			 redundancy will reduce  0.0015527950310558758
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0745341614906834,  1.0776397515527951,  1.0714285714285714
	walk terminate 1 spend time 5.842154264450073
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596275,  1.049689440993789,  1.0962732919254659
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596275,  1.093167701863354,  1.0527950310559007
						 current side  0
			 redundancy will reduce  0.007763975155279601
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0683229813664596,  1.0590062111801242,  1.0776397515527951
	walk terminate 1 spend time 6.028779745101929
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		341, 347, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 11.875356912612915
partition_len_list
[341, 347]
random_init_graph_partition selection method range initialization spend 11.87606430053711
time for parepare:  0.0001628398895263672
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0029838085174560547
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0005843639373779297
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.00024366378784179688
----------------------check_connections_block total spend ----------------------------- 0.005667686462402344
generate_one_block  0.027550697326660156
generate_one_block  0.0013399124145507812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018873214721679688
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.00038886070251464844
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0003972053527832031
mini_batch_src_global generation:  0.00026988983154296875
r_  generation:  0.0007174015045166016
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.0007102489471435547
----------------------check_connections_block total spend ----------------------------- 0.0036034584045410156
generate_one_block  0.0030384063720703125
generate_one_block  0.0020895004272460938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015752315521240234
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.0003409385681152344
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0014736652374267578
mini_batch_src_global generation:  0.0005991458892822266
r_  generation:  0.0020847320556640625
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0007777214050292969
mini_batch_src_global generation:  0.0008544921875
r_  generation:  0.001840353012084961
----------------------check_connections_block total spend ----------------------------- 0.010277748107910156
generate_one_block  0.0030870437622070312
generate_one_block  0.003503561019897461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2615966796875 GB
    Memory Allocated: 0.024202823638916016  GigaBytes
Max Memory Allocated: 0.029669761657714844  GigaBytes

{'VmPeak': 21891.34375, 'VmSize': 21827.34375, 'VmHWM': 4621.87890625, 'VmRSS': 4621.87890625}
connection checking time:  0.013881206512451172
block generation total time  0.011718511581420898
average batch blocks generation time:  0.005859255790710449
block dataloader generation time/epoch 11.957560062408447
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.023487567901611328  GigaBytes
Max Memory Allocated: 0.03409910202026367  GigaBytes

{'VmPeak': 21891.34375, 'VmSize': 21859.34375, 'VmHWM': 4623.15625, 'VmRSS': 4623.15625}
torch.Size([1895, 1433])
torch.Size([1125, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.02969980239868164  GigaBytes
Max Memory Allocated: 0.03409910202026367  GigaBytes

{'VmPeak': 21891.34375, 'VmSize': 21859.34375, 'VmHWM': 4623.15625, 'VmRSS': 4623.15625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.023696422576904297  GigaBytes
Max Memory Allocated: 0.03409910202026367  GigaBytes

{'VmPeak': 21891.34375, 'VmSize': 21859.34375, 'VmHWM': 4623.15625, 'VmRSS': 4623.15625}
torch.Size([1934, 1433])
torch.Size([1164, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.02980947494506836  GigaBytes
Max Memory Allocated: 0.03409910202026367  GigaBytes

{'VmPeak': 21891.34375, 'VmSize': 21859.34375, 'VmHWM': 4623.15625, 'VmRSS': 4623.15625}
{'VmPeak': 21891.34375, 'VmSize': 21859.34375, 'VmHWM': 4623.15625, 'VmRSS': 4623.15625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022351622581481934 |0.000863194465637207 |0.011488080024719238 |0.00042998790740966797 |0.004009604454040527 |0.0025665760040283203 |
----------------------------------------------------------pseudo_mini_loss sum 0.8562948107719421
{'VmPeak': 21891.34375, 'VmSize': 21859.34375, 'VmHWM': 4623.15625, 'VmRSS': 4623.15625}
Total (block generation + training)time/epoch 12.044276714324951
Training time/epoch 0.08616900444030762
Training time without block to device /epoch 0.0844426155090332
Training time without total dataloading part /epoch 0.03442192077636719
load block tensor time/epoch 0.04470324516296387
block to device time/epoch 0.001726388931274414
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6806
Number of first layer input nodes during this epoch:  3829
