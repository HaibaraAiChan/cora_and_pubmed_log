main start at this time 1648602841.669622
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20815.359375, 'VmSize': 20804.4921875, 'VmHWM': 3616.953125, 'VmRSS': 3616.953125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007836818695068359
global_2_local 7.653236389160156e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  0.0003247261047363281
before graph partition 
		150, 174, 211, 195, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.000232696533203125
	Initialize BitList time :  1.7881393432617188e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 150, 174

	before terminate 1 the average redundancy rate is:  1.0062111801242235
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0062111801242235,  0.9440993788819876,  1.0683229813664596
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0062111801242235,  0.9316770186335404,  1.0807453416149069
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0062111801242235,  0.9751552795031055,  1.0372670807453417
	walk terminate 1 spend time 4.220921754837036
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		157, 167, 211, 195, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005474090576171875
	Initialize BitList time :  4.4345855712890625e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 167, 211

	before terminate 1 the average redundancy rate is:  1.1739130434782608
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0559006211180124,  1.2919254658385093
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0434782608695652,  1.3043478260869565
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1583850931677018,  1.186335403726708,  1.1304347826086956
	walk terminate 1 spend time 4.40616512298584
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.049689440993789,  1.2546583850931676
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.1304347826086956,  1.173913043478261
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.1118012422360248,  1.1925465838509317
	walk terminate 1 spend time 4.283580780029297
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		157, 179, 192, 195, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 35, 34, 35, 


	preparing two sides time :  0.0005688667297363281
	Initialize BitList time :  4.601478576660156e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 192, 195

	before terminate 1 the average redundancy rate is:  1.201863354037267
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.009316770186335255
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.2919254658385093,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.1925465838509317,  1.1987577639751552
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.329192546583851,  1.031055900621118
	walk terminate 1 spend time 4.276865005493164
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1118012422360248,  1.2484472049689441
						 current side  1
			 redundancy will reduce  0.024844720496894235
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.1925465838509317,  1.1614906832298137
						 current side  0
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.0,  1.360248447204969
	walk terminate 1 spend time 4.447757959365845
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		157, 179, 161, 219, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 21.65461540222168
partition_len_list
[157, 179, 161, 219]
random_init_graph_partition selection method range initialization spend 21.655033349990845
time for parepare:  0.00011897087097167969
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.01316690444946289
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.012723207473754883
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001380443572998047
----------------------check_connections_block total spend ----------------------------- 0.027640819549560547
generate_one_block  0.01096796989440918
generate_one_block  0.0012404918670654297
generate_one_block  0.001094818115234375
generate_one_block  0.001210927963256836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017278194427490234
gen group dst list time:  4.482269287109375e-05
time for parepare:  0.0006492137908935547
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0007212162017822266
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.00040411949157714844
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0005993843078613281
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004265308380126953
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0006220340728759766
----------------------check_connections_block total spend ----------------------------- 0.00500798225402832
generate_one_block  0.0015685558319091797
generate_one_block  0.0015900135040283203
generate_one_block  0.0014960765838623047
generate_one_block  0.0018815994262695312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014796257019042969
gen group dst list time:  9.417533874511719e-05
time for parepare:  0.0002586841583251953
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00098419189453125
mini_batch_src_global generation:  0.00042891502380371094
r_  generation:  0.001071929931640625
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0005629062652587891
mini_batch_src_global generation:  0.00035834312438964844
r_  generation:  0.0015957355499267578
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.001092672348022461
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  0.0005176067352294922
r_  generation:  0.0017862319946289062
----------------------check_connections_block total spend ----------------------------- 0.011312007904052734
generate_one_block  0.004032611846923828
generate_one_block  0.0030236244201660156
generate_one_block  0.002458333969116211
generate_one_block  0.0030891895294189453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20815.359375, 'VmSize': 20656.39453125, 'VmHWM': 3622.12109375, 'VmRSS': 3622.03515625}
connection checking time:  0.016319990158081055
block generation total time  0.019140005111694336
average batch blocks generation time:  0.004785001277923584
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.010681629180908203  GigaBytes
Max Memory Allocated: 0.010681629180908203  GigaBytes

{'VmPeak': 21005.265625, 'VmSize': 20977.28125, 'VmHWM': 3912.5703125, 'VmRSS': 3912.5703125}
torch.Size([1387, 1433])
torch.Size([638, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.01334238052368164  GigaBytes
Max Memory Allocated: 0.013858318328857422  GigaBytes

{'VmPeak': 21767.1796875, 'VmSize': 21751.0703125, 'VmHWM': 4608.51171875, 'VmRSS': 4608.51171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.015122413635253906  GigaBytes
Max Memory Allocated: 0.022484302520751953  GigaBytes

{'VmPeak': 21767.1796875, 'VmSize': 21759.87109375, 'VmHWM': 4617.63671875, 'VmRSS': 4617.63671875}
torch.Size([1610, 1433])
torch.Size([835, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.01849365234375  GigaBytes
Max Memory Allocated: 0.022484302520751953  GigaBytes

{'VmPeak': 21823.8671875, 'VmSize': 21791.87109375, 'VmHWM': 4617.63671875, 'VmRSS': 4617.63671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.013923168182373047  GigaBytes
Max Memory Allocated: 0.022484302520751953  GigaBytes

{'VmPeak': 21823.8671875, 'VmSize': 21791.87109375, 'VmHWM': 4618.140625, 'VmRSS': 4618.140625}
torch.Size([1297, 1433])
torch.Size([606, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.01650094985961914  GigaBytes
Max Memory Allocated: 0.022484302520751953  GigaBytes

{'VmPeak': 21823.8671875, 'VmSize': 21791.87109375, 'VmHWM': 4618.140625, 'VmRSS': 4618.140625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2713623046875 GB
    Memory Allocated: 0.015876293182373047  GigaBytes
Max Memory Allocated: 0.02323150634765625  GigaBytes

{'VmPeak': 21823.8671875, 'VmSize': 21801.4375, 'VmHWM': 4626.625, 'VmRSS': 4626.625}
torch.Size([1750, 1433])
torch.Size([926, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.019700050354003906  GigaBytes
Max Memory Allocated: 0.02323150634765625  GigaBytes

{'VmPeak': 21823.8671875, 'VmSize': 21801.4375, 'VmHWM': 4626.79296875, 'VmRSS': 4626.79296875}
{'VmPeak': 21823.8671875, 'VmSize': 21801.4375, 'VmHWM': 4626.79296875, 'VmRSS': 4626.79296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010213255882263184 |0.09606927633285522 |0.20297682285308838 |0.00020515918731689453 |0.00482255220413208 |0.002336263656616211 |
----------------------------------------------------------pseudo_mini_loss sum 4.093847274780273
{'VmPeak': 21823.8671875, 'VmSize': 21801.4375, 'VmHWM': 4627.16796875, 'VmRSS': 4627.16796875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9765
Number of first layer input nodes during this epoch:  6044
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.022469520568847656  GigaBytes
Max Memory Allocated: 0.028507709503173828  GigaBytes

{'VmPeak': 21823.8671875, 'VmSize': 21801.4375, 'VmHWM': 4627.16796875, 'VmRSS': 4627.16796875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005576610565185547
global_2_local 8.821487426757812e-05
---------------------------- variant graph partition start---------------------
random_init for graph_partition spend:  8.940696716308594e-05
before graph partition 
		189, 182, 176, 184, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002872943878173828
	Initialize BitList time :  1.71661376953125e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 189, 182

	before terminate 1 the average redundancy rate is:  1.1521739130434783
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.0993788819875776,  1.204968944099379
						 current side  1
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.2298136645962734,  1.0559006211180124
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1335403726708075,  1.0683229813664596,  1.1987577639751552
	walk terminate 1 spend time 5.156389951705933
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1335403726708075,  1.2484472049689441,  1.0186335403726707
						 current side  0
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.124223602484472,  1.1304347826086956
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1273291925465838,  1.2111801242236024,  1.0434782608695652
	walk terminate 1 spend time 5.356135845184326
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		168, 195, 176, 184, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				33, 37, 35, 35, 


	preparing two sides time :  0.0005285739898681641
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 195, 176

	before terminate 1 the average redundancy rate is:  1.1521739130434783
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.0,  1.2981366459627328
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813665,  1.1614906832298137,  1.1366459627329193
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.0372670807453417,  1.2546583850931676
	walk terminate 1 spend time 5.26327109336853
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.2670807453416149,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.0869565217391304,  1.204968944099379
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.236024844720497,  1.0559006211180124
	walk terminate 1 spend time 5.3219380378723145
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		168, 170, 199, 184, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				33, 32, 40, 35, 


	preparing two sides time :  0.0005369186401367188
	Initialize BitList time :  4.673004150390625e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 199, 184

	before terminate 1 the average redundancy rate is:  1.18944099378882
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.0062111801242235,  1.360248447204969
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.1987577639751552,  1.1490683229813665
						 current side  0
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.0869565217391304,  1.2484472049689441
	walk terminate 1 spend time 5.407717704772949
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 8
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.329192546583851,  1.0
						 current side  0
			 redundancy will reduce  0.02795031055900621
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.2173913043478262,  1.1055900621118013
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.158385093167702,  1.2298136645962734,  1.0869565217391304
	walk terminate 1 spend time 5.311241865158081
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		168, 170, 175, 198, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 31.826176166534424
partition_len_list
[168, 170, 175, 198]
random_init_graph_partition selection method range initialization spend 31.826629400253296
time for parepare:  0.00016641616821289062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0010709762573242188
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.0005853176116943359
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0001735687255859375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00028133392333984375
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0002942085266113281
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00020360946655273438
----------------------check_connections_block total spend ----------------------------- 0.0046193599700927734
generate_one_block  0.028545618057250977
generate_one_block  0.001216888427734375
generate_one_block  0.0011074542999267578
generate_one_block  0.0013353824615478516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017337799072265625
gen group dst list time:  5.555152893066406e-05
time for parepare:  0.0008118152618408203
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0005445480346679688
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.0005669593811035156
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0002980232238769531
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0006246566772460938
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0006833076477050781
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0006608963012695312
----------------------check_connections_block total spend ----------------------------- 0.006030559539794922
generate_one_block  0.0018453598022460938
generate_one_block  0.0017750263214111328
generate_one_block  0.0017962455749511719
generate_one_block  0.0018951892852783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001695394515991211
gen group dst list time:  0.00010251998901367188
time for parepare:  0.0004589557647705078
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0012056827545166016
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.0013701915740966797
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.0005085468292236328
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.00159454345703125
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.0004363059997558594
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.001676797866821289
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0020003318786621094
----------------------check_connections_block total spend ----------------------------- 0.012637853622436523
generate_one_block  0.0028166770935058594
generate_one_block  0.002370595932006836
generate_one_block  0.002604961395263672
generate_one_block  0.0037288665771484375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.022469520568847656  GigaBytes
Max Memory Allocated: 0.028507709503173828  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4629.515625, 'VmRSS': 4629.48828125}
connection checking time:  0.018668413162231445
block generation total time  0.018832921981811523
average batch blocks generation time:  0.004708230495452881
block dataloader generation time/epoch 31.91556167602539
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.020184040069580078  GigaBytes
Max Memory Allocated: 0.029489517211914062  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.48046875, 'VmRSS': 4630.48046875}
torch.Size([1346, 1433])
torch.Size([649, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.022926807403564453  GigaBytes
Max Memory Allocated: 0.029489517211914062  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.48046875, 'VmRSS': 4630.48046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.02080392837524414  GigaBytes
Max Memory Allocated: 0.029489517211914062  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
torch.Size([1462, 1433])
torch.Size([695, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.023697853088378906  GigaBytes
Max Memory Allocated: 0.029489517211914062  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.021040916442871094  GigaBytes
Max Memory Allocated: 0.029489517211914062  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
torch.Size([1506, 1433])
torch.Size([711, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.02400684356689453  GigaBytes
Max Memory Allocated: 0.029489517211914062  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.02208852767944336  GigaBytes
Max Memory Allocated: 0.030083179473876953  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
torch.Size([1701, 1433])
torch.Size([873, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.025658130645751953  GigaBytes
Max Memory Allocated: 0.030083179473876953  GigaBytes

{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02285236120223999 |0.0007112622261047363 |0.004913985729217529 |0.0002009868621826172 |0.007399320602416992 |0.0018625259399414062 |
----------------------------------------------------------pseudo_mini_loss sum 0.9453111886978149
{'VmPeak': 21929.453125, 'VmSize': 21865.703125, 'VmHWM': 4630.50390625, 'VmRSS': 4630.50390625}
Total (block generation + training)time/epoch 32.07032012939453
Training time/epoch 0.1533646583557129
Training time without block to device /epoch 0.15051960945129395
Training time without total dataloading part /epoch 0.05191969871520996
load block tensor time/epoch 0.09140944480895996
block to device time/epoch 0.0028450489044189453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9654
Number of first layer input nodes during this epoch:  6015
