main start at this time 1648432268.5552058
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0014414787292480469
range selection method range initialization spend 0.0001087188720703125
time for parepare:  6.556510925292969e-05
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.002232789993286133
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00012874603271484375
----------------------check_connections_block total spend ----------------------------- 0.0030558109283447266
generate_one_block  0.001402139663696289
generate_one_block  0.0011920928955078125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005095005035400391
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00014352798461914062
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0006949901580810547
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0006535053253173828
----------------------check_connections_block total spend ----------------------------- 0.002568483352661133
generate_one_block  0.0018815994262695312
generate_one_block  0.0018301010131835938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005900859832763672
gen group dst list time:  5.435943603515625e-05
time for parepare:  0.00017905235290527344
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.0017578601837158203
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0017597675323486328
----------------------check_connections_block total spend ----------------------------- 0.005616903305053711
generate_one_block  0.003037691116333008
generate_one_block  0.0030286312103271484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006265640258789062
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.00018310546875
local_output_nid generation:  0.00012302398681640625
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.002718210220336914
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0026895999908447266
----------------------check_connections_block total spend ----------------------------- 0.008284330368041992
generate_one_block  0.003992319107055664
generate_one_block  0.0041849613189697266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007417201995849609
gen group dst list time:  0.00010728836059570312
time for parepare:  0.00018644332885742188
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.0004417896270751953
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.003108501434326172
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0003604888916015625
mini_batch_src_global generation:  0.0002758502960205078
r_  generation:  0.0030930042266845703
----------------------check_connections_block total spend ----------------------------- 0.009349822998046875
generate_one_block  0.004470109939575195
generate_one_block  0.004125118255615234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

connection checking time:  0.02581954002380371
block generation total time  0.0265505313873291
average batch blocks generation time:  0.01327526569366455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014657974243164062  GigaBytes
Max Memory Allocated: 0.014657974243164062  GigaBytes

torch.Size([2429, 1433])
torch.Size([2313, 64])
torch.Size([1912, 64])
torch.Size([1127, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0201416015625  GigaBytes
Max Memory Allocated: 0.020218849182128906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015440940856933594  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

torch.Size([2434, 1433])
torch.Size([2295, 64])
torch.Size([1900, 64])
torch.Size([1115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.020864486694335938  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01612567901611328 |0.1713954210281372 |0.38641560077667236 |0.00022208690643310547 |0.008430957794189453 |0.00651240348815918 |
----------------------------------------------------------pseudo_mini_loss sum 3.4225356578826904
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16220
Number of first layer input nodes during this epoch:  4863
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017446517944335938  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006556510925292969
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  9.393692016601562e-05
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0001990795135498047
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00016546249389648438
----------------------check_connections_block total spend ----------------------------- 0.0012066364288330078
generate_one_block  0.0017216205596923828
generate_one_block  0.0013573169708251953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004858970642089844
gen group dst list time:  3.0040740966796875e-05
time for parepare:  0.00015687942504882812
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0007295608520507812
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  Using backend: pytorch
0.00015664100646972656
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0006155967712402344
----------------------check_connections_block total spend ----------------------------- 0.002593994140625
generate_one_block  0.0019271373748779297
generate_one_block  0.001725912094116211
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005977153778076172
gen group dst list time:  6.031990051269531e-05
time for parepare:  0.00018858909606933594
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.00031375885009765625
mini_batch_src_global generation:  0.00019288063049316406
r_  generation:  0.0018563270568847656
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.001501321792602539
----------------------check_connections_block total spend ----------------------------- 0.005421876907348633
generate_one_block  0.003076791763305664
generate_one_block  0.0028727054595947266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005915164947509766
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.00017380714416503906
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.00038313865661621094
mini_batch_src_global generation:  0.0001919269561767578
r_  generation:  0.002612590789794922
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.0025191307067871094
----------------------check_connections_block total spend ----------------------------- 0.00811910629272461
generate_one_block  0.0038945674896240234
generate_one_block  0.003984928131103516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007662773132324219
gen group dst list time:  0.00010251998901367188
time for parepare:  0.00018095970153808594
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.00041961669921875
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0029180049896240234
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.00031638145446777344
r_  generation:  0.0030260086059570312
----------------------check_connections_block total spend ----------------------------- 0.009141206741333008
generate_one_block  0.004138469696044922
generate_one_block  0.00413060188293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017446517944335938  GigaBytes
Max Memory Allocated: 0.02892017364501953  GigaBytes

connection checking time:  0.02527618408203125
block generation total time  0.025751113891601562
average batch blocks generation time:  0.012875556945800781
block dataloader generation time/epoch 0.07556724548339844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01701068878173828  GigaBytes
Max Memory Allocated: 0.030485153198242188  GigaBytes

torch.Size([2437, 1433])
torch.Size([2290, 64])
torch.Size([1928, 64])
torch.Size([1181, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.022563934326171875  GigaBytes
Max Memory Allocated: 0.030485153198242188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.016999244689941406  GigaBytes
Max Memory Allocated: 0.030486106872558594  GigaBytes

torch.Size([2464, 1433])
torch.Size([2305, 64])
torch.Size([1813, 64])
torch.Size([967, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.022165298461914062  GigaBytes
Max Memory Allocated: 0.030486106872558594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004235744476318359 |0.0010439157485961914 |0.007134437561035156 |0.00016057491302490234 |0.004506349563598633 |0.0037975311279296875 |
----------------------------------------------------------pseudo_mini_loss sum 3.5273690223693848
Total (block generation + training)time/epoch 0.11720013618469238
Training time/epoch 0.04120206832885742
Training time without block to device /epoch 0.03911423683166504
Training time without total dataloading part /epoch 0.02740025520324707
load block tensor time/epoch 0.008471488952636719
block to device time/epoch 0.002087831497192383
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16075
Number of first layer input nodes during this epoch:  4901
