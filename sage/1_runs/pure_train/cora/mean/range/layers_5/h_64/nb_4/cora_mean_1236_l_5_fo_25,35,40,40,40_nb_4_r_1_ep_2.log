main start at this time 1648432277.8807168
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012214183807373047
range selection method range initialization spend 9.989738464355469e-05
time for parepare:  5.7697296142578125e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0023856163024902344
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.602836608886719e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.937980651855469e-05
----------------------check_connections_block total spend ----------------------------- 0.0035467147827148438
generate_one_block  0.0014519691467285156
generate_one_block  0.0010864734649658203
generate_one_block  0.0011141300201416016
generate_one_block  0.0010769367218017578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004787445068359375
gen group dst list time:  3.600120544433594e-05
time for parepare:  0.0001285076141357422
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003910064697265625
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00032448768615722656
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.792213439941406e-05
r_  generation:  0.0003864765167236328
----------------------check_connections_block total spend ----------------------------- 0.002859830856323242
generate_one_block  0.001445770263671875
generate_one_block  0.0015025138854980469
generate_one_block  0.001373291015625
generate_one_block  0.0014073848724365234
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005433559417724609
gen group dst list time:  7.390975952148438e-05
time for parepare:  0.0001628398895263672
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00024700164794921875
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0010802745819091797
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0012166500091552734
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0010476112365722656
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.00011968612670898438
r_  generation:  0.0012814998626708984
----------------------check_connections_block total spend ----------------------------- 0.0074176788330078125
generate_one_block  0.0024309158325195312
generate_one_block  0.002402067184448242
generate_one_block  0.002217531204223633
generate_one_block  0.002427816390991211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007083415985107422
gen group dst list time:  0.00012350082397460938
time for parepare:  0.00016880035400390625
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.00015592575073242188
r_  generation:  0.0021882057189941406
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.0002689361572265625
r_  generation:  0.0022788047790527344
local_output_nid generation:  9.560585021972656e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0022134780883789062
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.00241851806640625
----------------------check_connections_block total spend ----------------------------- 0.013872623443603516
generate_one_block  0.003755331039428711
generate_one_block  0.003603696823120117
generate_one_block  0.003369569778442383
generate_one_block  0.003743886947631836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008296966552734375
gen group dst list time:  0.000209808349609375
time for parepare:  0.00019049644470214844
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0005052089691162109
mini_batch_src_global generation:  0.000286102294921875
r_  generation:  0.0029053688049316406
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.0002856254577636719
r_  generation:  0.0028960704803466797
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.0003211498260498047
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0028007030487060547
local_output_nid generation:  0.0001442432403564453
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.002880096435546875
----------------------check_connections_block total spend ----------------------------- 0.017546892166137695
generate_one_block  0.005109310150146484
generate_one_block  0.00427556037902832
generate_one_block  0.00405573844909668
generate_one_block  0.0041844844818115234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

connection checking time:  0.041697025299072266
block generation total time  0.04730486869812012
average batch blocks generation time:  0.01182621717453003
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.013520240783691406  GigaBytes
Max Memory Allocated: 0.013520240783691406  GigaBytes

torch.Size([2355, 1433])
torch.Size([2118, 64])
torch.Size([1472, 64])
torch.Size([660, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.017717838287353516  GigaBytes
Max Memory Allocated: 0.017758846282958984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01540994644165039  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

torch.Size([2385, 1433])
torch.Size([2163, 64])
torch.Size([1570, 64])
torch.Size([767, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.019838809967041016  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014239788055419922  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

torch.Size([2344, 1433])
torch.Size([2088, 64])
torch.Size([1435, 64])
torch.Size([641, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.018327713012695312  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015411853790283203  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

torch.Size([2399, 1433])
torch.Size([2177, 64])
torch.Size([1619, 64])
torch.Size([769, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.019924640655517578  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01022791862487793 |0.0858081579208374 |0.19483816623687744 |0.00019866228103637695 |0.005194902420043945 |0.003120899200439453 |
----------------------------------------------------------pseudo_mini_loss sum 3.821268081665039
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27684
Number of first layer input nodes during this epoch:  9483
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01735687255859375  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005974769592285156
range selection method range initialization spend 8.96453857421875e-05
time for parepare:  9.1552734375e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00010466575622558594
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.604194641113281e-05
----------------------check_connections_block total spend ----------------------------- 0.0014672279357910156
generate_one_block  0.0014061927795410156
generate_one_block  0.0013239383697509766
generate_one_block  0.0013260841369628906
generate_one_block  0.0013036727905273438
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005905628204345703
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00021409988403320312
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0005838871002197266
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0005395412445068359
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005044937133789062
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.00037932395935058594
----------------------check_connections_block total spend ----------------------------- 0.0039615631103515625
generate_one_block  0.0019359588623046875
generate_one_block  0.0018651485443115234
generate_one_block  0.0018792152404785156
generate_one_block  0.001659393310546875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006816387176513672
gen group dst list time:  0.00010752677917480469
time for parepare:  0.0002484321594238281
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00031065940856933594
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.0017216205596923828
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.0017631053924560547
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.001535654067993164
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0011734962463378906
----------------------check_connections_block total spend ----------------------------- 0.010200977325439453
generate_one_block  0.0032112598419189453
generate_one_block  0.0027246475219726562
generate_one_block  0.0022788047790527344
generate_one_block  0.002076864242553711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006952285766601562
gen group dst list time:  0.00018286705017089844
time for parepare:  0.00024247169494628906
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.00043845176696777344
mini_batch_src_global generation:  0.0002655982971191406
r_  generation:  0.0030667781829833984
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.00036716461181640625
mini_batch_src_global generation:  0.0003674030303955078
r_  generation:  0.003064393997192383
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.0002713203430175781
r_  generation:  0.0029366016387939453
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.002044677734375
----------------------check_connections_block total spend ----------------------------- 0.017185688018798828
generate_one_block  0.003711223602294922
generate_one_block  0.0035741329193115234
generate_one_block  0.003381967544555664
generate_one_block  0.0030367374420166016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007135868072509766
gen group dst list time:  0.00025582313537597656
time for parepare:  0.00024771690368652344
local_output_nid generation:  0.00020599365234375
local_in_edges_tensor generation:  0.0005207061767578125
mini_batch_src_global generation:  0.00026869773864746094
r_  generation:  0.003821134567260742
local_output_nid generation:  0.00021529197692871094
local_in_edges_tensor generation:  0.0004334449768066406
mini_batch_src_global generation:  0.0004012584686279297
r_  generation:  0.0037508010864257812
local_output_nid generation:  0.00022673606872558594
local_in_edges_tensor generation:  0.0004417896270751953
mini_batch_src_global generation:  0.0003342628479003906
r_  generation:  0.0034046173095703125
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.0003407001495361328
mini_batch_src_global generation: Using backend: pytorch
 0.0002498626708984375
r_  generation:  0.0028862953186035156
----------------------check_connections_block total spend ----------------------------- 0.021271228790283203
generate_one_block  0.00409388542175293
generate_one_block  0.00391077995300293
generate_one_block  0.0040090084075927734
generate_one_block  0.0037889480590820312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01735687255859375  GigaBytes
Max Memory Allocated: 0.02781820297241211  GigaBytes

connection checking time:  0.05261945724487305
block generation total time  0.04713797569274902
average batch blocks generation time:  0.011784493923187256
block dataloader generation time/epoch 0.16508007049560547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01697683334350586  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

torch.Size([2383, 1433])
torch.Size([2136, 64])
torch.Size([1598, 64])
torch.Size([800, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02149200439453125  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015650272369384766  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

torch.Size([2312, 1433])
torch.Size([2118, 64])
torch.Size([1608, 64])
torch.Size([803, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02013111114501953  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01697397232055664  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

torch.Size([2421, 1433])
torch.Size([2195, 64])
torch.Size([1533, 64])
torch.Size([693, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02132415771484375  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01573801040649414  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

torch.Size([2334, 1433])
torch.Size([1942, 64])
torch.Size([1252, 64])
torch.Size([528, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.019376277923583984  GigaBytes
Max Memory Allocated: 0.030483245849609375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0020580291748046875 |0.0008746981620788574 |0.006301760673522949 |0.0001361370086669922 |0.0030456185340881348 |0.0024585723876953125 |
----------------------------------------------------------pseudo_mini_loss sum 3.61201810836792
Total (block generation + training)time/epoch 0.2221236228942871
Training time/epoch 0.05683398246765137
Training time without block to device /epoch 0.05333518981933594
Training time without total dataloading part /epoch 0.04039263725280762
load block tensor time/epoch 0.00823211669921875
block to device time/epoch 0.0034987926483154297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27390
Number of first layer input nodes during this epoch:  9450
