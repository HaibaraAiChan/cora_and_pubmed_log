main start at this time 1648432287.4292686
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0016891956329345703
range selection method range initialization spend 0.00010657310485839844
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0035572052001953125
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.8848648071289062e-05
----------------------check_connections_block total spend ----------------------------- 0.005353450775146484
generate_one_block  0.0013730525970458984
generate_one_block  0.0010750293731689453
generate_one_block  0.0009860992431640625
generate_one_block  0.0009753704071044922
generate_one_block  0.0009596347808837891
generate_one_block  0.0009753704071044922
generate_one_block  0.0009860992431640625
generate_one_block  0.0009636878967285156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004782676696777344
gen group dst list time:  5.555152893066406e-05
time for parepare:  0.00013208389282226562
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001723766326904297
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001857280731201172
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0002105236053466797
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00028395652770996094
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00014352798461914062
----------------------check_connections_block total spend ----------------------------- 0.0037403106689453125
generate_one_block  0.0011525154113769531
generate_one_block  0.0012197494506835938
generate_one_block  0.0012631416320800781
generate_one_block  0.0011560916900634766
generate_one_block  0.0011417865753173828
generate_one_block  0.0011928081512451172
generate_one_block  0.0012917518615722656
generate_one_block  0.0011031627655029297
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006175041198730469
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.00017642974853515625
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0005521774291992188
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.000156402587890625
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0007038116455078125
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0008921623229980469
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006413459777832031
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0006549358367919922
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006728172302246094
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0009593963623046875
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.000522613525390625
----------------------check_connections_block total spend ----------------------------- 0.00961756706237793
generate_one_block  0.0015788078308105469
generate_one_block  0.0017948150634765625
generate_one_block  0.002007007598876953
generate_one_block  0.0017154216766357422
generate_one_block  0.0017325878143310547
generate_one_block  0.0017597675323486328
generate_one_block  0.002072572708129883
generate_one_block  0.001621246337890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007195472717285156
gen group dst list time:  0.0001773834228515625
time for parepare:  0.00017976760864257812
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0014073848724365234
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0016596317291259766
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0018794536590576172
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0015137195587158203
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.0016438961029052734
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0016391277313232422
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.0018780231475830078
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0013988018035888672
----------------------check_connections_block total spend ----------------------------- 0.020205020904541016
generate_one_block  0.0025839805603027344
generate_one_block  0.0028624534606933594
generate_one_block  0.0037431716918945312
generate_one_block  0.002692699432373047
generate_one_block  0.0028235912322998047
generate_one_block  0.002948284149169922
generate_one_block  0.0030508041381835938
generate_one_block  0.002557516098022461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007381439208984375
gen group dst list time:  0.0003273487091064453
time for parepare:  0.00018072128295898438
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.002323150634765625
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.0002715587615966797
r_  generation:  0.0024933815002441406
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.00031685829162597656
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.002660036087036133
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.0023157596588134766
local_output_nid generation:  0.000125885009765625
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.0024192333221435547
local_output_nid generation:  0.00012755393981933594
local_in_edges_tensor generation:  0.00029087066650390625
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0024476051330566406
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.00022220611572265625
r_  generation:  0.002620220184326172
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0002791881561279297
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.0023114681243896484
----------------------check_connections_block total spend ----------------------------- 0.02956366539001465
generate_one_block  0.0043332576751708984
generate_one_block  0.0037081241607666016
generate_one_block  0.0038917064666748047
generate_one_block  0.003524303436279297
generate_one_block  0.0040798187255859375
generate_one_block  0.0036156177520751953
generate_one_block  0.003780364990234375
generate_one_block  0.0035524368286132812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007886886596679688  GigaBytes
Max Memory Allocated: 0.0007886886596679688  GigaBytes

connection checking time:  0.0631265640258789
block generation total time  0.07755136489868164
average batch blocks generation time:  0.009693920612335205
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.01261758804321289  GigaBytes
Max Memory Allocated: 0.01261758804321289  GigaBytes

torch.Size([2183, 1433])
torch.Size([1698, 64])
torch.Size([878, 64])
torch.Size([323, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.015372276306152344  GigaBytes
Max Memory Allocated: 0.01538848876953125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013669967651367188  GigaBytes
Max Memory Allocated: 0.025261402130126953  GigaBytes

torch.Size([2242, 1433])
torch.Size([1864, 64])
torch.Size([1103, 64])
torch.Size([393, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01691722869873047  GigaBytes
Max Memory Allocated: 0.025261402130126953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014084815979003906  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

torch.Size([2317, 1433])
torch.Size([2026, 64])
torch.Size([1298, 64])
torch.Size([557, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017816543579101562  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013408660888671875  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

torch.Size([2187, 1433])
torch.Size([1712, 64])
torch.Size([993, 64])
torch.Size([365, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01633930206298828  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01347208023071289  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

torch.Size([2206, 1433])
torch.Size([1791, 64])
torch.Size([1067, 64])
torch.Size([368, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016552448272705078  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013440132141113281  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

torch.Size([2200, 1433])
torch.Size([1822, 64])
torch.Size([1065, 64])
torch.Size([401, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01659679412841797  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014132976531982422  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

torch.Size([2326, 1433])
torch.Size([1963, 64])
torch.Size([1318, 64])
torch.Size([587, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017900466918945312  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013401985168457031  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

torch.Size([2164, 1433])
torch.Size([1694, 64])
torch.Size([909, 64])
torch.Size([294, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016139507293701172  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007479310035705566 |0.04365646839141846 |0.10097160935401917 |0.00015032291412353516 |0.00420650839805603 |0.0029296875 |
----------------------------------------------------------pseudo_mini_loss sum 3.6808345317840576
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45068
Number of first layer input nodes during this epoch:  17825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015220165252685547  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005924701690673828
range selection method range initialization spend 9.870529174804688e-05
time for parepare:  9.083747863769531e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.9114227294921875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011658668518066406
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.504753112792969e-05
----------------------check_connections_block total spend ----------------------------- 0.0021440982818603516
generate_one_block  0.0013451576232910156
generate_one_block  0.0012660026550292969
generate_one_block  0.001260995864868164
generate_one_block  0.0012371540069580078
generate_one_block  0.0012502670288085938
generate_one_block  0.0012543201446533203
generate_one_block  0.0012328624725341797
generate_one_block  0.001241922378540039
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005803108215332031
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.00020956993103027344
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0004220008850097656
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00034809112548828125
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002510547637939453
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00026535987854003906
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00033473968505859375
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0002079010009765625
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00018930435180664062
----------------------check_connections_block total spend ----------------------------- 0.004914522171020508
generate_one_block  0.0017368793487548828
generate_one_block  0.0014793872833251953
generate_one_block  0.001745462417602539
generate_one_block  0.0014929771423339844
generate_one_block  0.0015194416046142578
generate_one_block  0.0014646053314208984
generate_one_block  0.0011203289031982422
generate_one_block  0.0010962486267089844
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006265640258789062
gen group dst list time:  0.000148773193359375
time for parepare:  0.000278472900390625
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.001283884048461914
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0008335113525390625
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.001188039779663086
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.0009546279907226562
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0009634494781494141
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0011341571807861328
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0007741451263427734
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0006470680236816406
----------------------check_connections_block total spend ----------------------------- 0.013292789459228516
generate_one_block  0.0024788379669189453
generate_one_block  0.0016601085662841797
generate_one_block  0.001991748809814453
generate_one_block  0.0017781257629394531
generate_one_block  0.0017821788787841797
generate_one_block  0.0019347667694091797
generate_one_block  0.0015964508056640625
generate_one_block  0.0016014575958251953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006859302520751953
gen group dst list time:  0.0002732276916503906
time for parepare:  0.0002543926239013672
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.0004031658172607422
mini_batch_src_global generation:  0.00034999847412109375
r_  generation:  0.002745389938354492
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0002753734588623047
mini_batch_src_global generation:  0.00021886825561523438
r_  generation:  0.001979351043701172
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0003120899200439453
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.002576589584350586
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.0022585391998291016
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.000244140625
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.0018162727355957031
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0020422935485839844
local_output_nid generation:  7.462501525878906e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.0014302730560302734
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0012807846069335938
----------------------check_connections_block total spend ----------------------------- 0.025084257125854492
generate_one_block  0.003345489501953125
generate_one_block  0.002755403518676758
generate_one_block  0.0030388832092285156
generate_one_block  0.0029556751251220703
generate_one_block  0.0027971267700195312
generate_one_block  0.0030121803283691406
generate_one_block  0.002567768096923828
generate_one_block  0.0024459362030029297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007278919219970703
gen group dst list time:  0.0004928112030029297
time for parepare:  0.00025916099548339844
local_output_nid generation:  0.00018644332885742188
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0003075599670410156
r_  generation:  0.003551006317138672
local_output_nid generation:  0.0001761913299560547
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.0003247261047363281
r_  generation:  0.003083467483520508
local_output_nid generation:  0.00020003318786621094
local_in_edges_tensor generation:  0.0004031658172607422
mini_batch_src_global generation:  0.0002961158752441406
r_  generation:  0.003281831741333008
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.0002467632293701172
r_  generation:  0.0028595924377441406
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002610445022583008
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.002619028091430664
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0022895336151123047
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  0.00019598007202148438
r_  generation:  0.002164125442504883
----------------------check_connections_block total spend ----------------------------- 0.03390145301818848
generate_one_block  0.004150390625
generate_one_block  0.0035560131072998047
generate_one_block  0.003710508346557617
generate_one_block  0.004053354263305664
generate_one_block  0.0037543773651123047
generate_one_block  0.003804922103881836
generate_one_block  0.0035011768341064453
generate_one_block  0.0033812522888183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015220165252685547  GigaBytes
Max Memory Allocated: 0.025911808013916016  GigaBytes

connection checking time:  0.07719302177429199
block generation total time  0.07930946350097656
average batch blocks generation time:  0.00991368293762207
block dataloader generation time/epoch 0.20116591453552246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015418529510498047  GigaBytes
Max Memory Allocated: 0.026991844177246094  GigaBytes

torch.Size([2273, 1433])
torch.Size([1973, 64])
torch.Size([1369, 64])
torch.Size([582, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019258499145507812  GigaBytes
Max Memory Allocated: 0.026991844177246094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014970779418945312  GigaBytes
Max Memory Allocated: 0.0269927978515625  GigaBytes

torch.Size([2162, 1433])
torch.Size([1658, 64])
torch.Size([936, 64])
torch.Size([343, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017775535583496094  GigaBytes
Max Memory Allocated: 0.0269927978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015027523040771484  GigaBytes
Max Memory Allocated: 0.0269927978515625  GigaBytes

torch.Size([2201, 1433])
torch.Size([1898, 64])
torch.Size([1265, 64])
torch.Size([517, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018589496612548828  GigaBytes
Max Memory Allocated: 0.0269927978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015221118927001953  GigaBytes
Max Memory Allocated: 0.0269927978515625  GigaBytes

torch.Size([2239, 1433])
torch.Size([1915, 64])
torch.Size([1153, 64])
torch.Size([412, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018541336059570312  GigaBytes
Max Memory Allocated: 0.0269927978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.015254497528076172  GigaBytes
Max Memory Allocated: 0.02708292007446289  GigaBytes

torch.Size([2246, 1433])
torch.Size([1823, 64])
torch.Size([1078, 64])
torch.Size([412, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01842498779296875  GigaBytes
Max Memory Allocated: 0.02708292007446289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01553487777709961  GigaBytes
Max Memory Allocated: 0.027387142181396484  GigaBytes

torch.Size([2296, 1433])
torch.Size([1969, 64])
torch.Size([1252, 64])
torch.Size([489, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019112110137939453  GigaBytes
Max Memory Allocated: 0.027387142181396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014967918395996094  GigaBytes
Max Memory Allocated: 0.027387142181396484  GigaBytes

torch.Size([2192, 1433])
torch.Size([1654, 64])
torch.Size([885, 64])Using backend: pytorch

torch.Size([311, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01767873764038086  GigaBytes
Max Memory Allocated: 0.027387142181396484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014568805694580078  GigaBytes
Max Memory Allocated: 0.027387142181396484  GigaBytes

torch.Size([2122, 1433])
torch.Size([1568, 64])
torch.Size([829, 64])
torch.Size([261, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017090797424316406  GigaBytes
Max Memory Allocated: 0.027387142181396484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036351680755615234 |0.001077413558959961 |0.0067376792430877686 |0.00012922286987304688 |0.005574524402618408 |0.0026612281799316406 |
----------------------------------------------------------pseudo_mini_loss sum 3.4082822799682617
Total (block generation + training)time/epoch 0.35355091094970703
Training time/epoch 0.151658296585083
Training time without block to device /epoch 0.14303898811340332
Training time without total dataloading part /epoch 0.10219264030456543
load block tensor time/epoch 0.029081344604492188
block to device time/epoch 0.008619308471679688
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45041
Number of first layer input nodes during this epoch:  17731
