main start at this time 1648432345.916002
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006570816040039062
range selection method range initialization spend 8.177757263183594e-05
time for parepare:  6.461143493652344e-05
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0011391639709472656
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00012183189392089844
----------------------check_connections_block total spend ----------------------------- 0.001957416534423828
generate_one_block  0.0013363361358642578
generate_one_block  0.0011801719665527344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004973411560058594
gen group dst list time:  3.0040740966796875e-05
time for parepare:  0.00014209747314453125
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0006747245788574219
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0006835460662841797
----------------------check_connections_block total spend ----------------------------- 0.0026235580444335938
generate_one_block  0.0018503665924072266
generate_one_block  0.004021406173706055
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011913776397705078
gen group dst list time:  5.602836608886719e-05
time for parepare:  0.00021076202392578125
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.0004878044128417969
mini_batch_src_global generation:  0.00016951560974121094
r_  generation:  0.0017631053924560547
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0017745494842529297
----------------------check_connections_block total spend ----------------------------- 0.005921125411987305
generate_one_block  0.0030786991119384766
generate_one_block  0.003073453903198242
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007262229919433594
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.00017905235290527344
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.00046181678771972656
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0027141571044921875
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.00035881996154785156
mini_batch_src_global generation:  0.00026535987854003906
r_  generation:  0.0027518272399902344
----------------------check_connections_block total spend ----------------------------- 0.008567571640014648
generate_one_block  0.00408172607421875
generate_one_block  0.00397491455078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007998943328857422
gen group dst list time:  0.00010728836059570312
time for parepare:  0.0002090930938720703
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.0005626678466796875
mini_batch_src_global generation:  0.00023889541625976562
r_  generation:  0.003154754638671875
local_output_nid generation:  0.00016164779663085938
local_in_edges_tensor generation:  0.0004048347473144531
mini_batch_src_global generation:  0.0002665519714355469
r_  generation:  0.003180265426635742
----------------------check_connections_block total spend ----------------------------- 0.009829998016357422
generate_one_block  0.00454401969909668
generate_one_block  0.004237651824951172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.02694225311279297
block generation total time  0.02886223793029785
average batch blocks generation time:  0.014431118965148926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.01754617691040039  GigaBytes
Max Memory Allocated: 0.01754617691040039  GigaBytes

torch.Size([2458, 1433])
torch.Size([2311, 256])
torch.Size([1893, 256])
torch.Size([1113, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.038668155670166016  GigaBytes
Max Memory Allocated: 0.03900003433227539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02259540557861328  GigaBytes
Max Memory Allocated: 0.040282249450683594  GigaBytes

torch.Size([2456, 1433])
torch.Size([2318, 256])
torch.Size([1935, 256])
torch.Size([1117, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.045183658599853516  GigaBytes
Max Memory Allocated: 0.0455021858215332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00922846794128418 |0.17082643508911133 |0.38411688804626465 |0.00019979476928710938 |0.006908774375915527 |0.006857156753540039 |
----------------------------------------------------------pseudo_mini_loss sum 3.7119860649108887
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16297
Number of first layer input nodes during this epoch:  4914
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03253793716430664  GigaBytes
Max Memory Allocated: 0.045955657958984375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006306171417236328
range selection method range initialization spend 8.606910705566406e-05
time for parepare:  9.131431579589844e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0001728534698486328
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001652240753173828
----------------------check_connections_block total spend ----------------------------- 0.0011539459228515625
generate_one_block  0.0016832351684570312
generate_one_block  0.0015377998352050781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006525516510009766
gen group dst list time:  4.029273986816406e-05
time for parepare:  0.0002014636993408203
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0007212162017822266
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00016188621520996094
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.000701904296875
----------------------check_connections_block total spend ----------------------------- 0.002879619598388672
generate_one_block  0.0019497871398925781
generate_one_block  0.0018610954284667969
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005795955657958984
gen group dst list time:  5.936622619628906e-05
time for parepare:  0.00019407272338867188
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.00033020973205566406
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.0019030570983886719
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00020051002502441406
r_  generation:  0.0017788410186767578
----------------------check_connections_block total spend ----------------------------- 0.005868673324584961
generate_one_block  0.0032052993774414062
generate_one_block  0.0030829906463623047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006334781646728516
gen group dst list time:  9.059906005859375e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.0004189014434814453
mini_batch_src_global generation:  0.0002231597900390625
r_  generation:  0.0028791427612304688
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003294944763183594
mini_batch_src_global generation:  0.0003077983856201172
r_  generation:  0.0027577877044677734
----------------------check_connections_block total spend ----------------------------- 0.00872039794921875
generate_one_block  0.004124164581298828
generate_one_block  0.003966331481933594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007414817810058594
gen group dst list time:  0.00011086463928222656
time for parepare:  0.00018787384033203125
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.0004849433898925781
mini_batch_src_global generation:  0.0002262592315673828
r_  generation:  0.00319671630859375
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.00034737586975097656
r_  generation:  0.003198862075805664
----------------------check_connections_block total spend ----------------------------- 0.00985860824584961
generate_one_block  0.004462003707885742
generate_one_block  0.00415492057800293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03253793716430664  GigaBytes
Max Memory Allocated: 0.045955657958984375  GigaBytes

connection checking time:  0.027327299118041992
block generation total time  0.02680659294128418
average batch blocks generation time:  0.01340329647064209
block dataloader generation time/epoch 0.07832884788513184
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032105445861816406  GigaBytes
Max Memory Allocated: 0.045955657958984375  GigaBytes

torch.Size([2456, 1433])
torch.Size([2310, 256])
torch.Size([1958, 256])
torch.Size([1177, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.054200172424316406  GigaBytes
Max Memory Allocated: 0.054535865783691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0320887565612793  GigaBytes
Max Memory Allocated: 0.05501556396484375  GigaBytes

torch.Size([2451, 1433])
torch.Size([2298, 256])
torch.Size([1843, 256])
torch.Size([1071, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.05366373062133789  GigaBytes
Max Memory Allocated: 0.05501556396484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00385439395904541 |0.0007221698760986328 |0.005923867225646973 |0.00013816356658935547 |0.005699276924133301 |0.002673625946044922 |
----------------------------------------------------------pseudo_mini_loss sum 2.821565866470337
Total (block generation + training)time/epoch 0.11673092842102051
Training time/epoch 0.03793907165527344
Training time without block to device /epoch 0.03649473190307617
Training time without total dataloading part /epoch 0.02619624137878418
load block tensor time/epoch 0.00770878791809082
block to device time/epoch 0.0014443397521972656
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16269
Number of first layer input nodes during this epoch:  4907
