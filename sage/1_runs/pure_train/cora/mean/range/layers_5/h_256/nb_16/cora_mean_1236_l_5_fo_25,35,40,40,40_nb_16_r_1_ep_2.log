main start at this time 1648432374.5623653
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010857582092285156
range selection method range initialization spend 8.225440979003906e-05
time for parepare:  6.079673767089844e-05
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.0012378692626953125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3113021850585938e-05
r_  generation:  1.8835067749023438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.678436279296875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.00420379638671875
generate_one_block  0.0012078285217285156
generate_one_block  0.0010409355163574219
generate_one_block  0.001005411148071289
generate_one_block  0.0010383129119873047
generate_one_block  0.0010628700256347656
generate_one_block  0.0010058879852294922
generate_one_block  0.0010077953338623047
generate_one_block  0.0010981559753417969
generate_one_block  0.0010075569152832031
generate_one_block  0.000993967056274414
generate_one_block  0.001031637191772461
generate_one_block  0.001043558120727539
generate_one_block  0.0009965896606445312
generate_one_block  0.0009968280792236328
generate_one_block  0.001035928726196289
generate_one_block  0.00098419189453125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005724430084228516
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.0001366138458251953
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011014938354492188
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010275840759277344
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.00014066696166992188
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.965896606445312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.654594421386719e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001437664031982422
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012540817260742188
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.392333984375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.869171142578125e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.459785461425781e-05
----------------------check_connections_block total spend ----------------------------- 0.005247354507446289
generate_one_block  0.001211404800415039
generate_one_block  0.0011086463928222656
generate_one_block  0.0011081695556640625
generate_one_block  0.0011789798736572266
generate_one_block  0.001199483871459961
generate_one_block  0.0011861324310302734
generate_one_block  0.0012333393096923828
generate_one_block  0.0011067390441894531
generate_one_block  0.0010840892791748047
generate_one_block  0.0011801719665527344
generate_one_block  0.0010960102081298828
generate_one_block  0.0011415481567382812
generate_one_block  0.0010874271392822266
generate_one_block  0.001138448715209961
generate_one_block  0.001275777816772461
generate_one_block  0.0010437965393066406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006961822509765625
gen group dst list time:  0.0001494884490966797
time for parepare:  0.000225067138671875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.000377655029296875
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.00028967857360839844
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00042057037353515625
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.000568389892578125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00046133995056152344
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0006170272827148438
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0003478527069091797
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003349781036376953
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.000614166259765625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0003006458282470703
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0005097389221191406
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00032830238342285156
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00030303001403808594
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0007035732269287109
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00016260147094726562
----------------------check_connections_block total spend ----------------------------- 0.012464523315429688
generate_one_block  0.0014190673828125
generate_one_block  0.0013511180877685547
generate_one_block  0.0014421939849853516
generate_one_block  0.0017020702362060547
generate_one_block  0.0016677379608154297
generate_one_block  0.0015101432800292969
generate_one_block  0.0018281936645507812
generate_one_block  0.0013875961303710938
generate_one_block  0.0013384819030761719
generate_one_block  0.001718282699584961
generate_one_block  0.0013480186462402344
generate_one_block  0.0016362667083740234
generate_one_block  0.0013916492462158203
generate_one_block  0.0013275146484375
generate_one_block  0.0017714500427246094
generate_one_block  0.001186370849609375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007729530334472656
gen group dst list time:  0.00030350685119628906
time for parepare:  0.00020003318786621094
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0003139972686767578
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0009546279907226562
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0008022785186767578
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0010571479797363281
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0009453296661376953
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0014486312866210938
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0011692047119140625
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0016331672668457031
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  0.0001201629638671875
r_  generation:  0.0010120868682861328
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.0009672641754150391
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0014920234680175781
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0008947849273681641
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00014209747314453125
r_  generation:  0.0013020038604736328
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00011920928955078125
r_  generation:  0.0010690689086914062
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0007572174072265625
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.00013208389282226562
r_  generation:  0.001455068588256836
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  8.225440979003906e-05
r_  generation:  0.0004830360412597656
----------------------check_connections_block total spend ----------------------------- 0.028105974197387695
generate_one_block  0.002093076705932617
generate_one_block  0.001954793930053711
generate_one_block  0.0023186206817626953
generate_one_block  0.002658367156982422
generate_one_block  0.0025489330291748047
generate_one_block  0.0022954940795898438
generate_one_block  0.0028634071350097656
generate_one_block  0.0023386478424072266
generate_one_block  0.0020172595977783203
generate_one_block  0.0027112960815429688
generate_one_block  0.0019321441650390625
generate_one_block  0.0024683475494384766
generate_one_block  0.002203702926635742
generate_one_block  0.0018153190612792969
generate_one_block  0.002607107162475586
generate_one_block  0.0014903545379638672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007688999176025391
gen group dst list time:  0.0006356239318847656
time for parepare:  0.0001819133758544922
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.0001354217529296875
r_  generation:  0.0019104480743408203
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0015785694122314453
local_output_nid generation:  0.00010395050048828125
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.00020956993103027344
r_  generation:  0.002093076705932617
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.000171661376953125
r_  generation:  0.001940011978149414
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.002233266830444336
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.0002644062042236328
mini_batch_src_global generation:  0.00019121170043945312
r_  generation:  0.00191497802734375
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.00029206275939941406
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.002468585968017578
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0020415782928466797
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0018661022186279297
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00021147727966308594
r_  generation:  0.0024597644805908203
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.00164031982421875
local_output_nid generation:  0.00011515617370605469
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.0001933574676513672
r_  generation:  0.0022025108337402344
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.0001895427703857422
r_  generation:  0.0020232200622558594
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0014688968658447266
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0022735595703125
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.0001304149627685547
r_  generation:  0.0010089874267578125
----------------------check_connections_block total spend ----------------------------- 0.04746747016906738
generate_one_block  0.0037949085235595703
generate_one_block  0.002779722213745117
generate_one_block  0.0032274723052978516
generate_one_block  0.0033321380615234375
generate_one_block  0.003487825393676758
generate_one_block  0.003939151763916016
generate_one_block  0.0036275386810302734
generate_one_block  0.0031490325927734375
generate_one_block  0.0030684471130371094
generate_one_block  0.0036649703979492188
generate_one_block  0.0028197765350341797
generate_one_block  0.003408193588256836
generate_one_block  0.0031838417053222656
generate_one_block  0.0026094913482666016
generate_one_block  0.0034596920013427734
generate_one_block  0.002126455307006836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.09328532218933105
block generation total time  0.1304018497467041
average batch blocks generation time:  0.008150115609169006
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.014140605926513672  GigaBytes
Max Memory Allocated: 0.014140605926513672  GigaBytes

torch.Size([1842, 1433])
torch.Size([1257, 256])
torch.Size([536, 256])
torch.Size([196, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.02167987823486328  GigaBytes
Max Memory Allocated: 0.021714210510253906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01785135269165039  GigaBytes
Max Memory Allocated: 0.027617454528808594  GigaBytes

torch.Size([1734, 1433])
torch.Size([1089, 256])
torch.Size([466, 256])
torch.Size([151, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024872779846191406  GigaBytes
Max Memory Allocated: 0.027617454528808594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01964569091796875  GigaBytes
Max Memory Allocated: 0.02881622314453125  GigaBytes

torch.Size([2039, 1433])
torch.Size([1421, 256])
torch.Size([630, 256])
torch.Size([212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027736186981201172  GigaBytes
Max Memory Allocated: 0.02881622314453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.019024372100830078  GigaBytes
Max Memory Allocated: 0.029974937438964844  GigaBytes

torch.Size([1951, 1433])
torch.Size([1299, 256])
torch.Size([578, 256])
torch.Size([210, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02653646469116211  GigaBytes
Max Memory Allocated: 0.029974937438964844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.02035236358642578  GigaBytes
Max Memory Allocated: 0.030661582946777344  GigaBytes

torch.Size([2129, 1433])
torch.Size([1587, 256])
torch.Size([878, 256])
torch.Size([288, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3045654296875 GB
    Memory Allocated: 0.030488967895507812  GigaBytes
Max Memory Allocated: 0.030661582946777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.018637657165527344  GigaBytes
Max Memory Allocated: 0.030689239501953125  GigaBytes

torch.Size([1877, 1433])
torch.Size([1374, 256])
torch.Size([726, 256])
torch.Size([254, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.027185916900634766  GigaBytes
Max Memory Allocated: 0.030689239501953125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.020454883575439453  GigaBytes
Max Memory Allocated: 0.030689239501953125  GigaBytes

torch.Size([2212, 1433])
torch.Size([1815, 256])
torch.Size([1037, 256])
torch.Size([343, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.033593177795410156  GigaBytes
Max Memory Allocated: 0.03368806838989258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.019644737243652344  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([2025, 1433])
torch.Size([1356, 256])
torch.Size([632, 256])
torch.Size([163, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.027365684509277344  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.019080162048339844  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([1962, 1433])
torch.Size([1319, 256])
torch.Size([529, 256])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.026234149932861328  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02050495147705078  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([2222, 1433])
torch.Size([1812, 256])
torch.Size([984, 256])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.032647132873535156  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.017824172973632812  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([1728, 1433])
torch.Size([1129, 256])
torch.Size([509, 256])
torch.Size([167, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.025867938995361328  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02035045623779297  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([2087, 1433])
torch.Size([1574, 256])
torch.Size([818, 256])
torch.Size([251, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.029912948608398438  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01964569091796875  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([1918, 1433])
torch.Size([1402, 256])
torch.Size([629, 256])
torch.Size([178, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.027518272399902344  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01740121841430664  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([1650, 1433])
torch.Size([1041, 256])
torch.Size([468, 256])
torch.Size([165, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02533245086669922  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.020087718963623047  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([2144, 1433])
torch.Size([1674, 256])
torch.Size([958, 256])
torch.Size([359, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03114461898803711  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.015103340148925781  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

torch.Size([1224, 1433])
torch.Size([662, 256])
torch.Size([287, 256])
torch.Size([87, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.018810272216796875  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004797935485839844 |0.022168263792991638 |0.05324205756187439 |0.0001153796911239624 |0.00469970703125 |0.0029897689819335938 |
----------------------------------------------------------pseudo_mini_loss sum 4.337715148925781
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  67531
Number of first layer input nodes during this epoch:  30744
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024047374725341797  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004773139953613281
range selection method range initialization spend 6.532669067382812e-05
time for parepare:  7.2479248046875e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.8358230590820312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.9788742065429688e-05
----------------------check_connections_block total spend ----------------------------- 0.0031197071075439453
generate_one_block  0.0010876655578613281
generate_one_block  0.001275777816772461
generate_one_block  0.001018524169921875
generate_one_block  0.0010075569152832031
generate_one_block  0.0010194778442382812
generate_one_block  0.0010309219360351562
generate_one_block  0.0010132789611816406
generate_one_block  0.0010249614715576172
generate_one_block  0.0010294914245605469
generate_one_block  0.0010221004486083984
generate_one_block  0.001018524169921875
generate_one_block  0.0009505748748779297
generate_one_block  0.000949859619140625
generate_one_block  0.0009479522705078125
generate_one_block  0.0009496212005615234
generate_one_block  0.0009920597076416016
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005319118499755859
gen group dst list time:  9.822845458984375e-05
time for parepare:  0.0001513957977294922
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00011944770812988281
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.796287536621094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00015044212341308594
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00014901161193847656
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012254714965820312
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00019741058349609375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00012874603271484375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.581710815429688e-05
----------------------check_connections_block total spend ----------------------------- 0.0054683685302734375
generate_one_block  0.0011844635009765625
generate_one_block  0.0011386871337890625
generate_one_block  0.001085519790649414
generate_one_block  0.0011599063873291016
generate_one_block  0.0011899471282958984
generate_one_block  0.0011837482452392578
generate_one_block  0.0011439323425292969
generate_one_block  0.0012378692626953125
generate_one_block  0.0012345314025878906
generate_one_block  0.0010650157928466797
generate_one_block  0.0011396408081054688
generate_one_block  0.0011136531829833984
generate_one_block  0.0009975433349609375
generate_one_block  0.0010223388671875
generate_one_block  0.0010867118835449219
generate_one_block  0.001051187515258789
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006647109985351562
gen group dst list time:  0.0001418590545654297
time for parepare:  0.0002129077911376953
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00047779083251953125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004317760467529297
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003001689910888672
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00047707557678222656
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0005559921264648438
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0005273818969726562
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00045108795166015625
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0006248950958251953
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0006275177001953125
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00041413307189941406
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006463527679443359
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003464221954345703
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002624988555908203
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004684925079345703
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002605915069580078
----------------------check_connections_block total spend ----------------------------- 0.013198137283325195
generate_one_block  0.0016124248504638672
generate_one_block  0.0015168190002441406
generate_one_block  0.0013515949249267578
generate_one_block  0.0014772415161132812
generate_one_block  0.0015594959259033203
generate_one_block  0.0015339851379394531
generate_one_block  0.0014319419860839844
generate_one_block  0.0022428035736083984
generate_one_block  0.0016331672668457031
generate_one_block  0.0014033317565917969
generate_one_block  0.0016438961029052734
generate_one_block  0.0013060569763183594
generate_one_block  0.0011827945709228516
generate_one_block  0.0012154579162597656
generate_one_block  0.0014498233795166016
generate_one_block  0.0012252330780029297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007126331329345703
gen group dst list time:  0.00036716461181640625
time for parepare:  0.0002067089080810547
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00032782554626464844
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.0012977123260498047
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.001238107681274414
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0009348392486572266
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0012087821960449219
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0014081001281738281
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0014348030090332031
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011413097381591797
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.001390218734741211
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0014424324035644531
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0010631084442138672
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.001375436782836914
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0001723766326904297
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0009481906890869141
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006413459777832031
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0007271766662597656
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0010590553283691406
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0007407665252685547
----------------------check_connections_block total spend ----------------------------- 0.028845787048339844
generate_one_block  0.002760648727416992
generate_one_block  0.0023250579833984375
generate_one_block  0.0019576549530029297
generate_one_block  0.002448558807373047
generate_one_block  0.002473115921020508
generate_one_block  0.0024938583374023438
generate_one_block  0.002185344696044922
generate_one_block  0.0024368762969970703
generate_one_block  0.0029153823852539062
generate_one_block  0.0022296905517578125
generate_one_block  0.002554178237915039
generate_one_block  0.0020444393157958984
generate_one_block  0.0017063617706298828
generate_one_block  0.001798868179321289
generate_one_block  0.002180337905883789
generate_one_block  0.0018019676208496094
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007498264312744141
gen group dst list time:  0.0006818771362304688
time for parepare:  0.00021839141845703125
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.0004394054412841797
mini_batch_src_global generation:  0.00016045570373535156
r_  generation:  0.002334117889404297
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.0002944469451904297
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0022115707397460938
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.000255584716796875
mini_batch_src_global generation:  0.00017881393432617188
r_  generation:  0.0019259452819824219
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.00027680397033691406
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.0021965503692626953
local_output_nid generation:  0.00011706352233886719
local_in_edges_tensor generation:  0.0002906322479248047
mini_batch_src_global generation:  0.0002040863037109375
r_  generation:  0.0023529529571533203
local_output_nid generation:  0.00011610984802246094
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.0023467540740966797
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.002035856246948242
local_output_nid generation:  0.00011324882507324219
local_in_edges_tensor generation:  0.0002713203430175781
mini_batch_src_global generation:  0.0001919269561767578
r_  generation:  0.0021893978118896484
local_output_nid generation:  0.00011348724365234375
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.002223968505859375
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.0002524852752685547
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0019497871398925781
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0022194385528564453
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0018346309661865234
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.001527547836303711
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0015599727630615234
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.00017261505126953125
r_  generation:  0.0019011497497558594
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.001580953598022461
----------------------check_connections_block total spend ----------------------------- 0.04926156997680664
generate_one_block  0.004323244094848633
generate_one_block  0.003340005874633789
generate_one_block  0.002950429916381836
generate_one_block  0.0032351016998291016
generate_one_block  0.003357410430908203
generate_one_block  0.0034422874450683594
generate_one_block  0.0030744075775146484
generate_one_block  0.0035400390625
generate_one_block  0.003547191619873047
generate_one_block  0.003248929977416992
generate_one_block  0.0035295486450195312
generate_one_block  0.003075838088989258
generate_one_block  0.002774953842163086
generate_one_block  0.0028400421142578125
generate_one_block  0.003170490264892578
generate_one_block  0.0027675628662109375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024047374725341797  GigaBytes
Max Memory Allocated: 0.034028053283691406  GigaBytes

connection checking time:  0.09677386283874512
block generation total time  0.13035058975219727
average batch blocks generation time:  0.008146911859512329
block dataloader generation time/epoch 0.271960973739624
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.028913497924804688  GigaBytes
Max Memory Allocated: 0.03535127639770508  GigaBytes

torch.Size([2114, 1433])
torch.Size([1549, 256])
torch.Size([742, 256])
torch.Size([259, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03873300552368164  GigaBytes
Max Memory Allocated: 0.038779258728027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029181957244873047  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([2040, 1433])
torch.Size([1471, 256])
torch.Size([705, 256])
torch.Size([215, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.0377659797668457  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027696609497070312  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([1920, 1433])
torch.Size([1220, 256])
torch.Size([513, 256])
torch.Size([139, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.034348487854003906  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029182910919189453  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([2066, 1433])
torch.Size([1438, 256])
torch.Size([708, 256])
torch.Size([250, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.037822723388671875  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02845478057861328  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([2057, 1433])
torch.Size([1584, 256])
torch.Size([832, 256])
torch.Size([317, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03931474685668945  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029193401336669922  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([2078, 1433])
torch.Size([1574, 256])
torch.Size([865, 256])
torch.Size([252, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.0390009880065918  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027676105499267578  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([1914, 1433])
torch.Size([1337, 256])
torch.Size([654, 256])
torch.Size([222, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03650093078613281  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02919626235961914  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

torch.Size([2148, 1433])
torch.Size([1592, 256])
torch.Size([838, 256])
torch.Size([327, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03927040100097656  GigaBytes
Max Memory Allocated: 0.04053640365600586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029011249542236328  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([2160, 1433])
torch.Size([1612, 256])
torch.Size([871, 256])
torch.Size([315, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03925180435180664  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02809906005859375  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([1993, 1433])
torch.Size([1404, 256])
torch.Size([671, 256])
torch.Size([212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03636455535888672  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.028803348541259766  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([2121, 1433])
torch.Size([1635, 256])
torch.Size([876, 256])
torch.Size([341, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03915548324584961  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02783966064453125  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([1946, 1433])
torch.Size([1298, 256])
torch.Size([576, 256])
torch.Size([164, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.035852909088134766  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02709817886352539  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([1796, 1433])
torch.Size([1012, 256])
torch.Size([388, 256])
torch.Size([103, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03243446350097656  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.026624202728271484  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([1721, 1433])
torch.Size([1084, 256])
torch.Size([429, 256])
torch.Size([139, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03251791000366211  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027914047241210938  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([1958, 1433])
torch.Size([1339, 256])
torch.Size([638, 256])
torch.Size([219, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.036409854888916016  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.027103900909423828  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

torch.Size([1737, 1433])
torch.Size([1067, 256])
torch.Size([422, 256])
torch.Size([111, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03341865539550781  GigaBytes
Max Memory Allocated: 0.04062175750732422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003068670630455017 |0.0007147341966629028 |0.005637109279632568 |0.00013244152069091797 |0.005096226930618286 |0.0020661354064941406 |
----------------------------------------------------------pseudo_mini_loss sum 2.7307565212249756
Total (block generation + training)time/epoch 0.524716854095459
Training time/epoch 0.25257182121276855
Training time without block to device /epoch 0.2411360740661621
Training time without total dataloading part /epoch 0.1759185791015625
load block tensor time/epoch 0.04909873008728027
block to device time/epoch 0.011435747146606445
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  69063
Number of first layer input nodes during this epoch:  31769
