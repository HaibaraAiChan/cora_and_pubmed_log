main start at this time 1648432364.8565454
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011696815490722656
range selection method range initialization spend 8.702278137207031e-05
time for parepare:  6.437301635742188e-05
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0012962818145751953
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.956390380859375e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.673004150390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0031218528747558594
generate_one_block  0.0012476444244384766
generate_one_block  0.0011670589447021484
generate_one_block  0.0011169910430908203
generate_one_block  0.001092672348022461
generate_one_block  0.0010933876037597656
generate_one_block  0.0010869503021240234
generate_one_block  0.0010783672332763672
generate_one_block  0.0011098384857177734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004858970642089844
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.000202178955078125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0002949237823486328
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00022792816162109375
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021529197692871094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00021910667419433594
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00017189979553222656
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002617835998535156
----------------------check_connections_block total spend ----------------------------- 0.003999471664428711
generate_one_block  0.0012867450714111328
generate_one_block  0.0012865066528320312
generate_one_block  0.0014085769653320312
generate_one_block  0.0013239383697509766
generate_one_block  0.0013260841369628906
generate_one_block  0.0013134479522705078
generate_one_block  0.0012564659118652344
generate_one_block  0.0013051033020019531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000682830810546875
gen group dst list time:  9.989738464355469e-05
time for parepare:  0.00018835067749023438
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  8.320808410644531e-05
r_  generation:  0.0005943775177001953
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0006670951843261719
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0009095668792724609
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.0008177757263183594
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0007860660552978516
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0007519721984863281
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006124973297119141
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0008220672607421875
----------------------check_connections_block total spend ----------------------------- 0.010369300842285156
generate_one_block  0.0017557144165039062
generate_one_block  0.0018687248229980469
generate_one_block  0.002023935317993164
generate_one_block  0.0019371509552001953
generate_one_block  0.0019063949584960938
generate_one_block  0.0018656253814697266
generate_one_block  0.001708984375
generate_one_block  0.001986980438232422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007600784301757812
gen group dst list time:  0.00018739700317382812
time for parepare:  0.00018715858459472656
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.00013303756713867188
r_  generation:  0.001308441162109375
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.0015943050384521484
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.00201416015625
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.001941680908203125
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.0018825531005859375
local_output_nid generation:  8.249282836914062e-05
local_in_edges_tensor generation:  0.00023317337036132812
mini_batch_src_global generation:  0.0001723766326904297
r_  generation:  0.001768350601196289
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0015864372253417969
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002391338348388672
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.0017383098602294922
----------------------check_connections_block total spend ----------------------------- 0.021674394607543945
generate_one_block  0.002586841583251953
generate_one_block  0.0027418136596679688
generate_one_block  0.0032491683959960938
generate_one_block  0.003179311752319336
generate_one_block  0.003083944320678711
generate_one_block  0.0030460357666015625
generate_one_block  0.0027849674224853516
generate_one_block  0.0029196739196777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007731914520263672
gen group dst list time:  0.0003821849822998047
time for parepare:  0.0002002716064453125
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0004363059997558594
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0022096633911132812
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.00028133392333984375
r_  generation:  0.0025513172149658203
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.0002608299255371094
r_  generation:  0.0027663707733154297
local_output_nid generation:  0.0001404285430908203
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.002855062484741211
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0028154850006103516
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.00024390220642089844
r_  generation:  0.002660989761352539
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.0003285408020019531
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.0027031898498535156
local_output_nid generation:  0.00013756752014160156
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  0.0002453327178955078
r_  generation:  0.0024454593658447266
----------------------check_connections_block total spend ----------------------------- 0.03190326690673828
generate_one_block  0.0040013790130615234
generate_one_block  0.0036077499389648438
generate_one_block  0.0037508010864257812
generate_one_block  0.003931760787963867
generate_one_block  0.004311084747314453
generate_one_block  0.004422187805175781
generate_one_block  0.003724813461303711
generate_one_block  0.003604888916015625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.0679464340209961
block generation total time  0.08050680160522461
average batch blocks generation time:  0.010063350200653076
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015080928802490234  GigaBytes
Max Memory Allocated: 0.015080928802490234  GigaBytes

torch.Size([2014, 1433])
torch.Size([1496, 256])
torch.Size([800, 256])
torch.Size([326, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02473735809326172  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02059030532836914  GigaBytes
Max Memory Allocated: 0.031225204467773438  GigaBytes

torch.Size([2241, 1433])
torch.Size([1761, 256])
torch.Size([998, 256])
torch.Size([378, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03296375274658203  GigaBytes
Max Memory Allocated: 0.033040523529052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.020755290985107422  GigaBytes
Max Memory Allocated: 0.03335285186767578  GigaBytes

torch.Size([2268, 1433])
torch.Size([1907, 256])
torch.Size([1266, 256])
torch.Size([512, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.035181522369384766  GigaBytes
Max Memory Allocated: 0.035307884216308594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02103137969970703  GigaBytes
Max Memory Allocated: 0.03561830520629883  GigaBytes

torch.Size([2320, 1433])
torch.Size([1979, 256])
torch.Size([1227, 256])
torch.Size([434, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.034975528717041016  GigaBytes
Max Memory Allocated: 0.03561830520629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02081918716430664  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

torch.Size([2281, 1433])
torch.Size([1949, 256])
torch.Size([1187, 256])
torch.Size([471, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.034693241119384766  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.0204315185546875  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

torch.Size([2210, 1433])
torch.Size([1806, 256])
torch.Size([1073, 256])
torch.Size([403, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03358888626098633  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.020783424377441406  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

torch.Size([2277, 1433])
torch.Size([1859, 256])
torch.Size([975, 256])
torch.Size([337, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.032312870025634766  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.020548343658447266  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

torch.Size([2231, 1433])
torch.Size([1833, 256])
torch.Size([1141, 256])
torch.Size([440, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.03455066680908203  GigaBytes
Max Memory Allocated: 0.035907745361328125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007805138826370239 |0.04378679394721985 |0.09917435050010681 |0.0001277625560760498 |0.004244476556777954 |0.0030028820037841797 |
----------------------------------------------------------pseudo_mini_loss sum 4.147828578948975
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45155
Number of first layer input nodes during this epoch:  17842
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029799938201904297  GigaBytes
Max Memory Allocated: 0.03605508804321289  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000484466552734375
range selection method range initialization spend 7.43865966796875e-05
time for parepare:  7.05718994140625e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.340576171875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.2901763916015625e-05
----------------------check_connections_block total spend ----------------------------- 0.0018739700317382812
generate_one_block  0.0011186599731445312
generate_one_block  0.0010733604431152344
generate_one_block  0.0010828971862792969
generate_one_block  0.0010786056518554688
generate_one_block  0.0010876655578613281
generate_one_block  0.0010771751403808594
generate_one_block  0.0010559558868408203
generate_one_block  0.0010585784912109375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005121231079101562
gen group dst list time:  6.151199340820312e-05
time for parepare:  0.0001659393310546875
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00023651123046875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002002716064453125
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.000274658203125
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0002868175506591797
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002613067626953125
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00014019012451171875
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00019025802612304688
----------------------check_connections_block total spend ----------------------------- 0.00418543815612793
generate_one_block  0.0013420581817626953
generate_one_block  0.0012743473052978516
generate_one_block  0.0014698505401611328
generate_one_block  0.0013821125030517578
generate_one_block  0.0013933181762695312
generate_one_block  0.0013644695281982422
generate_one_block  0.0011866092681884766
generate_one_block  0.0012145042419433594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006639957427978516
gen group dst list time:  0.00011420249938964844
time for parepare:  0.00020265579223632812
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0007672309875488281
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0007545948028564453
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0009284019470214844
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0008711814880371094
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.0009484291076660156
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0008642673492431641
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.00046753883361816406
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0006546974182128906
----------------------check_connections_block total spend ----------------------------- 0.010735273361206055
generate_one_block  0.0020093917846679688
generate_one_block  0.0019366741180419922
generate_one_block  0.0020651817321777344
generate_one_block  0.0018763542175292969
generate_one_block  0.0019481182098388672
generate_one_block  0.0019159317016601562
generate_one_block  0.0014269351959228516
generate_one_block  0.0017218589782714844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007197856903076172
gen group dst list time:  0.0002014636993408203
time for parepare:  0.00019931793212890625
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0018718242645263672
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0017905235290527344
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.002014636993408203
local_output_nid generation:  8.58306884765625e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.001787424087524414
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0019774436950683594
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.00025343894958496094
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.001882791519165039
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00021147727966308594
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0013189315795898438
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.0001533031463623047
r_  generation:  0.0014028549194335938
----------------------check_connections_block total spend ----------------------------- 0.021906614303588867
generate_one_block  0.003271341323852539
generate_one_block  0.0028481483459472656
generate_one_block  0.0029952526092529297
generate_one_block  0.0027871131896972656
generate_one_block  0.0030052661895751953
generate_one_block  0.002939462661743164
generate_one_block  0.002324342727661133
generate_one_block  0.0025146007537841797
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007343292236328125
gen group dst list time:  0.00037860870361328125
time for parepare:  0.00022172927856445312
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.0028150081634521484
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.0003254413604736328
mini_batch_src_global generation:  0.0002853870391845703
r_  generation:  0.0027265548706054688
local_output_nid generation:  0.0001423358917236328
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.000255584716796875
r_  generation:  0.002809762954711914
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0003218650817871094
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0027098655700683594
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.00033664703369140625
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0029020309448242188
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.0025577545166015625
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.0021715164184570312
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.002135038375854492
----------------------check_connections_block total spend ----------------------------- 0.03168082237243652
generate_one_block  0.004302501678466797
generate_one_block  0.0037233829498291016
generate_one_block  0.0037310123443603516
generate_one_block  0.003948211669921875
generate_one_block  0.0042667388916015625
generate_one_block  0.0038204193115234375
generate_one_block  0.003385782241821289
generate_one_block  0.003325223922729492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029799938201904297  GigaBytes
Max Memory Allocated: 0.03605508804321289  GigaBytes

connection checking time:  0.06850814819335938
block generation total time  0.07871651649475098
average batch blocks generation time:  0.009839564561843872
block dataloader generation time/epoch 0.17722511291503906
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.029673099517822266  GigaBytes
Max Memory Allocated: 0.0414576530456543  GigaBytes

torch.Size([2263, 1433])
torch.Size([1886, 256])
torch.Size([1114, 256])
torch.Size([421, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.04303741455078125  GigaBytes
Max Memory Allocated: 0.043123722076416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.029584884643554688  GigaBytes
Max Memory Allocated: 0.0438380241394043  GigaBytes

torch.Size([2247, 1433])
torch.Size([1809, 256])
torch.Size([1064, 256])
torch.Size([381, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.04259157180786133  GigaBytes
Max Memory Allocated: 0.0438380241394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.029510021209716797  GigaBytes
Max Memory Allocated: 0.0438380241394043  GigaBytes

torch.Size([2224, 1433])
torch.Size([1869, 256])
torch.Size([1236, 256])
torch.Size([504, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.04359579086303711  GigaBytes
Max Memory Allocated: 0.0438380241394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.02951955795288086  GigaBytes
Max Memory Allocated: 0.044096946716308594  GigaBytes

torch.Size([2234, 1433])
torch.Size([1797, 256])
torch.Size([1077, 256])
torch.Size([464, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.042662620544433594  GigaBytes
Max Memory Allocated: 0.044096946716308594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.029941082000732422  GigaBytes
Max Memory Allocated: 0.044096946716308594  GigaBytes

torch.Size([2311, 1433])
torch.Size([1935, 256])
torch.Size([1203, 256])
torch.Size([502, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.0437769889831543  GigaBytes
Max Memory Allocated: 0.044096946716308594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.029506206512451172  GigaBytes
Max Memory Allocated: 0.04424905776977539  GigaBytes

torch.Size([2207, 1433])
torch.Size([1856, 256])
torch.Size([1127, 256])
torch.Size([467, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.04296588897705078  GigaBytes
Max Memory Allocated: 0.04424905776977539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.0288848876953125  GigaBytes
Max Memory Allocated: 0.04424905776977539  GigaBytes

torch.Size([2121, 1433])
torch.Size([1553, 256])Using backend: pytorch

torch.Size([740, 256])
torch.Size([237, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.03936338424682617  GigaBytes
Max Memory Allocated: 0.04424905776977539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.02846384048461914  GigaBytes
Max Memory Allocated: 0.04424905776977539  GigaBytes

torch.Size([2040, 1433])
torch.Size([1545, 256])
torch.Size([834, 256])
torch.Size([316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.038372039794921875  GigaBytes
Max Memory Allocated: 0.04424905776977539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00208321213722229 |0.000754624605178833 |0.005594909191131592 |0.00011539459228515625 |0.002760380506515503 |0.0025703907012939453 |
----------------------------------------------------------pseudo_mini_loss sum 2.6187028884887695
Total (block generation + training)time/epoch 0.27869534492492676
Training time/epoch 0.10120153427124023
Training time without block to device /epoch 0.09516453742980957
Training time without total dataloading part /epoch 0.07033586502075195
load block tensor time/epoch 0.01666569709777832
block to device time/epoch 0.006036996841430664
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  44343
Number of first layer input nodes during this epoch:  17647
