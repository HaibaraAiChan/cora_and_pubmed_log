main start at this time 1648432355.238492
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013260841369628906
range selection method range initialization spend 0.0001227855682373047
time for parepare:  0.00011491775512695312
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00026869773864746094
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0021691322326660156
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011539459228515625
----------------------check_connections_block total spend ----------------------------- 0.004151105880737305
generate_one_block  0.002271890640258789
generate_one_block  0.0015287399291992188
generate_one_block  0.001470804214477539
generate_one_block  0.0013926029205322266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005910396575927734
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.00019478797912597656
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00042366981506347656
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0006043910980224609
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0004928112030029297
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005459785461425781
----------------------check_connections_block total spend ----------------------------- 0.003927469253540039
generate_one_block  0.001810312271118164
generate_one_block  0.001978635787963867
generate_one_block  0.0018668174743652344
generate_one_block  0.0019054412841796875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007114410400390625
gen group dst list time:  0.000102996826171875
time for parepare:  0.00023221969604492188
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.001260519027709961
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.00026917457580566406
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.0018129348754882812
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0016198158264160156
local_output_nid generation:  7.82012939453125e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0016016960144042969
----------------------check_connections_block total spend ----------------------------- 0.01015329360961914
generate_one_block  0.002923727035522461
generate_one_block  0.002914905548095703
generate_one_block  0.0023980140686035156
generate_one_block  0.002363920211791992
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007238388061523438
gen group dst list time:  0.00017690658569335938
time for parepare:  0.0002353191375732422
local_output_nid generation:  0.00012350082397460938
local_in_edges_tensor generation:  0.0004229545593261719
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.00274658203125
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.0003933906555175781
mini_batch_src_global generation:  0.00031304359436035156
r_  generation:  0.0032405853271484375
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.00035762786865234375
mini_batch_src_global generation:  0.00028324127197265625
r_  generation:  0.0031096935272216797
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.0003502368927001953
mini_batch_src_global generation:  0.00025534629821777344
r_  generation:  0.002440214157104492
----------------------check_connections_block total spend ----------------------------- 0.017599105834960938
generate_one_block  0.003332376480102539
generate_one_block  0.0035521984100341797
generate_one_block  0.0034923553466796875
generate_one_block  0.0035829544067382812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007870197296142578
gen group dst list time:  0.00024700164794921875
time for parepare:  0.00024580955505371094
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0005097389221191406
mini_batch_src_global generation:  0.0002532005310058594
r_  generation:  0.0037927627563476562
local_output_nid generation:  0.00020933151245117188
local_in_edges_tensor generation:  0.0004265308380126953
mini_batch_src_global generation:  0.0003848075866699219
r_  generation:  0.0039234161376953125
local_output_nid generation:  0.00021147727966308594
local_in_edges_tensor generation:  0.00042891502380371094
mini_batch_src_global generation:  0.0003266334533691406
r_  generation:  0.003290414810180664
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0003554821014404297
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.003134489059448242
----------------------check_connections_block total spend ----------------------------- 0.02137279510498047
generate_one_block  0.004269838333129883
generate_one_block  0.004060506820678711
generate_one_block  0.0038895606994628906
generate_one_block  0.0039370059967041016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0042285919189453125  GigaBytes
Max Memory Allocated: 0.0042285919189453125  GigaBytes

connection checking time:  0.053052663803100586
block generation total time  0.0482785701751709
average batch blocks generation time:  0.012069642543792725
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.016807079315185547  GigaBytes
Max Memory Allocated: 0.016807079315185547  GigaBytes

torch.Size([2329, 1433])
torch.Size([2037, 256])
torch.Size([1344, 256])
torch.Size([589, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03223562240600586  GigaBytes
Max Memory Allocated: 0.03237581253051758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02136993408203125  GigaBytes
Max Memory Allocated: 0.03363180160522461  GigaBytes

torch.Size([2388, 1433])
torch.Size([2171, 256])
torch.Size([1658, 256])
torch.Size([805, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.04026937484741211  GigaBytes
Max Memory Allocated: 0.040479183197021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.021119117736816406  GigaBytes
Max Memory Allocated: 0.04091072082519531  GigaBytes

torch.Size([2343, 1433])
torch.Size([2112, 256])
torch.Size([1596, 256])
torch.Size([726, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03857231140136719  GigaBytes
Max Memory Allocated: 0.04091072082519531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02140188217163086  GigaBytes
Max Memory Allocated: 0.04091072082519531  GigaBytes

torch.Size([2396, 1433])
torch.Size([2160, 256])
torch.Size([1541, 256])
torch.Size([705, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03934907913208008  GigaBytes
Max Memory Allocated: 0.04091072082519531  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006572902202606201 |0.0865774154663086 |0.194100022315979 |0.0001804828643798828 |0.006289482116699219 |0.0036385059356689453 |
----------------------------------------------------------pseudo_mini_loss sum 3.714717388153076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27635
Number of first layer input nodes during this epoch:  9456
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030472755432128906  GigaBytes
Max Memory Allocated: 0.04091072082519531  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005102157592773438
range selection method range initialization spend 6.651878356933594e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.274482727050781e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.5789947509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.0012547969818115234
generate_one_block  0.0011680126190185547
generate_one_block  0.0011322498321533203
generate_one_block  0.001134634017944336
generate_one_block  0.0010986328125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005059242248535156
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.0001723766326904297
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0003790855407714844
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005009174346923828
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0004589557647705078
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003571510314941406
----------------------check_connections_block total spend ----------------------------- 0.003359079360961914
generate_one_block  0.0015020370483398438
generate_one_block  0.0016334056854248047
generate_one_block  0.0016448497772216797
generate_one_block  0.0014607906341552734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005908012390136719
gen group dst list time:  8.58306884765625e-05
time for parepare:  0.00019812583923339844
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.0011897087097167969
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0014295578002929688
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0013055801391601562
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0011243820190429688
----------------------check_connections_block total spend ----------------------------- 0.008322715759277344
generate_one_block  0.002454042434692383
generate_one_block  0.002676248550415039
generate_one_block  0.002550840377807617
generate_one_block  0.002244710922241211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007436275482177734
gen group dst list time:  0.00014090538024902344
time for parepare:  0.00019693374633789062
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0003790855407714844
mini_batch_src_global generation:  0.00020623207092285156
r_  generation:  0.002418994903564453
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.0002994537353515625
mini_batch_src_global generation:  0.0002815723419189453
r_  generation:  0.0024182796478271484
local_output_nid generation:  0.00011587142944335938
local_in_edges_tensor generation:  0.0002932548522949219
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002420663833618164
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0022110939025878906
----------------------check_connections_block total spend ----------------------------- 0.014643192291259766
generate_one_block  0.003876924514770508
generate_one_block  0.003464937210083008
generate_one_block  0.003465414047241211
generate_one_block  0.00318145751953125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007500648498535156
gen group dst list time:  0.00019288063049316406
time for parepare:  0.00019812583923339844
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.00048661231994628906
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.003111600875854492
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.0003573894500732422
mini_batch_src_global generation:  0.0003256797790527344
r_  generation:  0.003061532974243164
local_output_nid generation:  0.00015878677368164062
local_in_edges_tensor generation:  0.0003628730773925781
mini_batch_src_global generation:  0.00026345252990722656
r_  generation:  0.003163576126098633
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation: Using backend: pytorch
 0.00025534629821777344
r_  generation:  0.003022909164428711
----------------------check_connections_block total spend ----------------------------- 0.018674612045288086
generate_one_block  0.004503488540649414
generate_one_block  0.0039517879486083984
generate_one_block  0.003985881805419922
generate_one_block  0.0038352012634277344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030472755432128906  GigaBytes
Max Memory Allocated: 0.04091072082519531  GigaBytes

connection checking time:  0.04499959945678711
block generation total time  0.0464320182800293
average batch blocks generation time:  0.011608004570007324
block dataloader generation time/epoch 0.11508870124816895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02995014190673828  GigaBytes
Max Memory Allocated: 0.042584896087646484  GigaBytes

torch.Size([2368, 1433])
torch.Size([2119, 256])
torch.Size([1474, 256])
torch.Size([656, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.04736042022705078  GigaBytes
Max Memory Allocated: 0.047507286071777344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.029750347137451172  GigaBytes
Max Memory Allocated: 0.047982215881347656  GigaBytes

torch.Size([2323, 1433])
torch.Size([2106, 256])
torch.Size([1550, 256])
torch.Size([790, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.04831695556640625  GigaBytes
Max Memory Allocated: 0.04851531982421875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.030106067657470703  GigaBytes
Max Memory Allocated: 0.048978328704833984  GigaBytes

torch.Size([2393, 1433])
torch.Size([2158, 256])
torch.Size([1518, 256])
torch.Size([735, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.048157691955566406  GigaBytes
Max Memory Allocated: 0.048978328704833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.029736042022705078  GigaBytes
Max Memory Allocated: 0.048978328704833984  GigaBytes

torch.Size([2325, 1433])
torch.Size([2021, 256])
torch.Size([1367, 256])
torch.Size([598, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.045534610748291016  GigaBytes
Max Memory Allocated: 0.048978328704833984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0024212002754211426 |0.0007554292678833008 |0.005592465400695801 |0.00011837482452392578 |0.00392460823059082 |0.0023550987243652344 |
----------------------------------------------------------pseudo_mini_loss sum 2.987900733947754
Total (block generation + training)time/epoch 0.17319273948669434
Training time/epoch 0.05781269073486328
Training time without block to device /epoch 0.05479097366333008
Training time without total dataloading part /epoch 0.04089689254760742
load block tensor time/epoch 0.00968480110168457
block to device time/epoch 0.003021717071533203
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27240
Number of first layer input nodes during this epoch:  9409
