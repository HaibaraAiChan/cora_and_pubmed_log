main start at this time 1648432316.6050806
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0017669200897216797
range selection method range initialization spend 0.0001468658447265625
time for parepare:  0.00011396408081054688
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00030875205993652344
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.002228975296020508
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001049041748046875
----------------------check_connections_block total spend ----------------------------- 0.004241228103637695
generate_one_block  0.002581357955932617
generate_one_block  0.0013713836669921875
generate_one_block  0.0013608932495117188
generate_one_block  0.001255035400390625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006053447723388672
gen group dst list time:  4.863739013671875e-05
time for parepare:  0.00017523765563964844
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005831718444824219
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004906654357910156
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00047278404235839844
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004353523254394531
----------------------check_connections_block total spend ----------------------------- 0.0037543773651123047
generate_one_block  0.0018193721771240234
generate_one_block  0.001567840576171875
generate_one_block  0.0015451908111572266
generate_one_block  0.0015025138854980469
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006344318389892578
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.001461029052734375
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.0012781620025634766
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.001325368881225586
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0012199878692626953
----------------------check_connections_block total spend ----------------------------- 0.008444070816040039
generate_one_block  0.0029146671295166016
generate_one_block  0.002733469009399414
generate_one_block  0.0023827552795410156
generate_one_block  0.0022144317626953125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007545948028564453
gen group dst list time:  0.00014066696166992188
time for parepare:  0.00019240379333496094
local_output_nid generation:  0.00011301040649414062
local_in_edges_tensor generation:  0.00042510032653808594
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.002530336380004883
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.0002989768981933594
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0023927688598632812
local_output_nid generation:  0.00011038780212402344
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.0024018287658691406
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.0024297237396240234
----------------------check_connections_block total spend ----------------------------- 0.014846086502075195
generate_one_block  0.0038611888885498047
generate_one_block  0.003420114517211914
generate_one_block  0.0033593177795410156
generate_one_block  0.003567934036254883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007803440093994141
gen group dst list time:  0.0001976490020751953
time for parepare:  0.00020360946655273438
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0005078315734863281
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.003122568130493164
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.0003600120544433594
mini_batch_src_global generation:  0.0003082752227783203
r_  generation:  0.0030875205993652344
local_output_nid generation:  0.00015544891357421875
local_in_edges_tensor generation:  0.0003631114959716797
mini_batch_src_global generation:  0.00026345252990722656
r_  generation:  0.003055572509765625
local_output_nid generation:  0.00016236305236816406
local_in_edges_tensor generation:  0.00036454200744628906
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.003176450729370117
----------------------check_connections_block total spend ----------------------------- 0.01872873306274414
generate_one_block  0.005175590515136719
generate_one_block  0.004040718078613281
generate_one_block  0.003993034362792969
generate_one_block  0.003991603851318359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

connection checking time:  0.04577326774597168
block generation total time  0.04808974266052246
average batch blocks generation time:  0.012022435665130615
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.015592098236083984  GigaBytes
Max Memory Allocated: 0.015592098236083984  GigaBytes

torch.Size([2379, 1433])
torch.Size([2157, 128])
torch.Size([1638, 128])
torch.Size([833, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02469348907470703  GigaBytes
Max Memory Allocated: 0.024789810180664062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01620006561279297  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

torch.Size([2350, 1433])
torch.Size([2109, 128])
torch.Size([1488, 128])
torch.Size([707, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.024491310119628906  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016120433807373047  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

torch.Size([2335, 1433])
torch.Size([2102, 128])
torch.Size([1506, 128])
torch.Size([730, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.02468252182006836  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016406536102294922  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

torch.Size([2389, 1433])
torch.Size([2167, 128])
torch.Size([1514, 128])
torch.Size([677, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.024733543395996094  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00962895154953003 |0.0857698917388916 |0.19530069828033447 |0.0001590251922607422 |0.004847884178161621 |0.003055572509765625 |
----------------------------------------------------------pseudo_mini_loss sum 3.7313380241394043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27820
Number of first layer input nodes during this epoch:  9453
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020254135131835938  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00048470497131347656
range selection method range initialization spend 6.532669067382812e-05
time for parepare:  6.937980651855469e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.988380432128906e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.273124694824219e-05
----------------------check_connections_block total spend ----------------------------- 0.001272439956665039
generate_one_block  0.0012664794921875
generate_one_block  0.0011737346649169922
generate_one_block  0.0011959075927734375
generate_one_block  0.0012078285217285156
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005083084106445312
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.00015854835510253906
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005049705505371094
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0003197193145751953
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005097389221191406
----------------------check_connections_block total spend ----------------------------- 0.0033750534057617188
generate_one_block  0.0017316341400146484
generate_one_block  0.0015103816986083984
generate_one_block  0.0016367435455322266
generate_one_block  0.0017244815826416016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005972385406494141
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.00019025802612304688
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00028252601623535156
mini_batch_src_global generation:  0.00016617774963378906
r_  generation:  0.0013735294342041016
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0011093616485595703
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00019884109497070312
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0012907981872558594
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.0001964569091796875
r_  generation:  0.0015015602111816406
----------------------check_connections_block total spend ----------------------------- 0.008577108383178711
generate_one_block  0.002735137939453125
generate_one_block  0.0023708343505859375
generate_one_block  0.002512693405151367
generate_one_block  0.002672910690307617
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007224082946777344
gen group dst list time:  0.0001392364501953125
time for parepare:  0.0001919269561767578
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.00038623809814453125
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.00246429443359375
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.0002524852752685547
r_  generation:  0.0022916793823242188
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0024013519287109375
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0025169849395751953
----------------------check_connections_block total spend ----------------------------- 0.014720916748046875
generate_one_block  0.003758668899536133
generate_one_block  0.003320932388305664
generate_one_block  0.0034608840942382812
generate_one_block  0.0035622119903564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007791519165039062
gen group dst list time:  0.0001938343048095703
time for parepare:  0.00019550323486328125
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0004649162292480469
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0030045509338378906
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation:  0.00030684471130371094
r_  generation:  0.0030090808868408203
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.0030596256256103516
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.0003421306610107422Using backend: pytorch

mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.0030498504638671875
----------------------check_connections_block total spend ----------------------------- 0.0181427001953125
generate_one_block  0.0045588016510009766
generate_one_block  0.004011869430541992
generate_one_block  0.003986358642578125
generate_one_block  0.003916025161743164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020254135131835938  GigaBytes
Max Memory Allocated: 0.029712200164794922  GigaBytes

connection checking time:  0.044815778732299805
block generation total time  0.0474705696105957
average batch blocks generation time:  0.011867642402648926
block dataloader generation time/epoch 0.11475110054016113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01958751678466797  GigaBytes
Max Memory Allocated: 0.032178401947021484  GigaBytes

torch.Size([2331, 1433])
torch.Size([2078, 128])
torch.Size([1544, 128])
torch.Size([778, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.028400897979736328  GigaBytes
Max Memory Allocated: 0.032178401947021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.019718170166015625  GigaBytes
Max Memory Allocated: 0.032178401947021484  GigaBytes

torch.Size([2358, 1433])
torch.Size([2076, 128])
torch.Size([1421, 128])
torch.Size([585, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027480125427246094  GigaBytes
Max Memory Allocated: 0.032178401947021484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.019759654998779297  GigaBytes
Max Memory Allocated: 0.03218984603881836  GigaBytes

torch.Size([2364, 1433])
torch.Size([2111, 128])
torch.Size([1526, 128])
torch.Size([717, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02827310562133789  GigaBytes
Max Memory Allocated: 0.03218984603881836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 0.03218984603881836  GigaBytes

torch.Size([2313, 1433])
torch.Size([2116, 128])
torch.Size([1667, 128])
torch.Size([858, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028569698333740234  GigaBytes
Max Memory Allocated: 0.03218984603881836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035299062728881836 |0.0007669329643249512 |0.0059427618980407715 |0.0001227259635925293 |0.004313528537750244 |0.002206087112426758 |
----------------------------------------------------------pseudo_mini_loss sum 3.035334348678589
Total (block generation + training)time/epoch 0.1806349754333496
Training time/epoch 0.06552934646606445
Training time without block to device /epoch 0.06246161460876465
Training time without total dataloading part /epoch 0.04372215270996094
load block tensor time/epoch 0.014119625091552734
block to device time/epoch 0.0030677318572998047
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27582
Number of first layer input nodes during this epoch:  9366
