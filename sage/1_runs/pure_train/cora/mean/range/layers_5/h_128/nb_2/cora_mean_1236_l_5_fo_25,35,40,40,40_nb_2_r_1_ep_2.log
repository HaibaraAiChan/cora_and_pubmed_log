main start at this time 1648432307.2737195
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0010998249053955078
range selection method range initialization spend 9.703636169433594e-05
time for parepare:  7.987022399902344e-05
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0028412342071533203
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00014209747314453125
----------------------check_connections_block total spend ----------------------------- 0.0038080215454101562
generate_one_block  0.0017113685607910156
generate_one_block  0.001432657241821289
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
gen group dst list time:  3.814697265625e-05
time for parepare:  0.0001742839813232422
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0002715587615966797
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0009300708770751953
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0003070831298828125
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.00080108642578125
----------------------check_connections_block total spend ----------------------------- 0.003252744674682617
generate_one_block  0.002382516860961914
generate_one_block  0.002155780792236328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006995201110839844
gen group dst list time:  7.152557373046875e-05
time for parepare:  0.00022482872009277344
local_output_nid generation:  0.00011134147644042969
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.002404928207397461
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.002176523208618164
----------------------check_connections_block total spend ----------------------------- 0.007227659225463867
generate_one_block  0.0039556026458740234
generate_one_block  0.003556966781616211
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007770061492919922
gen group dst list time:  0.00011539459228515625
time for parepare:  0.00023484230041503906
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.00048232078552246094
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.003643035888671875
local_output_nid generation:  0.0001823902130126953
local_in_edges_tensor generation:  0.0004000663757324219
mini_batch_src_global generation:  0.0003325939178466797
r_  generation:  0.003457784652709961
----------------------check_connections_block total spend ----------------------------- 0.010779619216918945
generate_one_block  0.00480341911315918
generate_one_block  0.003741741180419922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007789134979248047
gen group dst list time:  0.00014328956604003906
time for parepare:  0.0002474784851074219
local_output_nid generation:  0.00020813941955566406
local_in_edges_tensor generation:  0.0005366802215576172
mini_batch_src_global generation:  0.0002751350402832031
r_  generation:  0.004007577896118164
local_output_nid generation:  0.0002281665802001953
local_in_edges_tensor generation:  0.0004620552062988281
mini_batch_src_global generation:  0.0003559589385986328
r_  generation:  0.0038216114044189453
----------------------check_connections_block total spend ----------------------------- 0.01184535026550293
generate_one_block  0.004794597625732422
generate_one_block  0.004240274429321289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

connection checking time:  0.03310537338256836
block generation total time  0.02963089942932129
average batch blocks generation time:  0.014815449714660645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.015622138977050781  GigaBytes
Max Memory Allocated: 0.015622138977050781  GigaBytes

torch.Size([2452, 1433])
torch.Size([2312, 128])
torch.Size([1937, 128])
torch.Size([1207, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.026660442352294922  GigaBytes
Max Memory Allocated: 0.026832103729248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01671886444091797  GigaBytes
Max Memory Allocated: 0.03020000457763672  GigaBytes

torch.Size([2441, 1433])
torch.Size([2309, 128])
torch.Size([1881, 128])
torch.Size([1069, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.028113842010498047  GigaBytes
Max Memory Allocated: 0.03020000457763672  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00641787052154541 |0.17026448249816895 |0.38615548610687256 |0.00021791458129882812 |0.006871938705444336 |0.0033261775970458984 |
----------------------------------------------------------pseudo_mini_loss sum 3.823923110961914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16311
Number of first layer input nodes during this epoch:  4893
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02064228057861328  GigaBytes
Max Memory Allocated: 0.03020000457763672  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000545501708984375
range selection method range initialization spend 7.772445678710938e-05
time for parepare:  8.058547973632812e-05
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00015091896057128906
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015497207641601562
----------------------check_connections_block total spend ----------------------------- 0.0010209083557128906
generate_one_block  0.0015149116516113281
generate_one_block  0.0014798641204833984
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005602836608886719
gen group dst list time:  3.6716461181640625e-05
time for parepare:  0.00019693374633789062
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0008015632629394531
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00019359588623046875
mini_batch_src_global generation:  0.0001430511474609375
r_  generation:  0.0008819103240966797
----------------------check_connections_block total spend ----------------------------- 0.003314495086669922
generate_one_block  0.0022666454315185547
generate_one_block  0.0023221969604492188
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006704330444335938
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.00022554397583007812
local_output_nid generation:  9.870529174804688e-05
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.002195119857788086
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.0003046989440917969
mini_batch_src_global generation:  0.0002810955047607422
r_  generation:  0.002372264862060547
----------------------check_connections_block total spend ----------------------------- 0.0072557926177978516
generate_one_block  0.0037224292755126953
generate_one_block  0.003768444061279297
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007367134094238281
gen group dst list time:  0.00011777877807617188
time for parepare:  0.00023055076599121094
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.003476858139038086
local_output_nid generation:  0.00018405914306640625
local_in_edges_tensor generation:  0.0004029273986816406
mini_batch_src_global generation:  0.00036263465881347656
r_  generation:  0.003535747528076172
----------------------check_connections_block total spend ----------------------------- 0.010745525360107422
generate_one_block  0.0046045780181884766
generate_one_block  0.003847360610961914
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007476806640625
gen group dst list time:  0.00014400482177734375
time for parepare:  0.00023126602172851562
local_output_nid generation:  0.00020432472229003906
local_in_edges_tensor generation:  0.0005426406860351562
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0038814544677734375
local_output_nid generation:  0.00022792816162109375
local_in_edges_tensor generation:  0.00044798851013183594
mini_batch_src_global generation:  0.0004031658172607422
r_  generation:  0.003892183303833008
----------------------check_connections_block total spend ----------------------------- 0.011899232864379883
generate_one_block  0.004907369613647461
generate_one_block  0.004223823547363281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02064228057861328  GigaBytes
Max Memory Allocated: 0.03020000457763672  GigaBytes

connection checking time:  0.03321504592895508
block generation total time  0.0296628475189209
average batch blocks generation time:  0.01483142375946045
block dataloader generation time/epoch 0.08197546005249023
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02084636688232422  GigaBytes
Max Memory Allocated: 0.03368568420410156  GigaBytes

torch.Size([2459, 1433])
torch.Size([2314, 128])
torch.Size([1899, 128])
torch.Size([1071, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03145122528076172  GigaBytes
Max Memory Allocated: 0.03368568420410156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020287036895751953  GigaBytes
Max Memory Allocated: 0.03376150131225586  GigaBytes

torch.Size([2455, 1433])
torch.Size([2323, 128])
torch.Size([1962, 128])
torch.Size([1186, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.032071590423583984  GigaBytes
Max Memory Allocated: 0.03376150131225586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0039054155349731445 |0.0008482933044433594 |0.006940722465515137 |0.00014317035675048828 |0.009686589241027832 |0.0028455257415771484 |
----------------------------------------------------------pseudo_mini_loss sum 2.8833565711975098
Total (block generation + training)time/epoch 0.13100790977478027
Training time/epoch 0.048712968826293945
Training time without block to device /epoch 0.04701638221740723
Training time without total dataloading part /epoch 0.03638648986816406
load block tensor time/epoch 0.007810831069946289
block to device time/epoch 0.0016965866088867188
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16368
Number of first layer input nodes during this epoch:  4914
