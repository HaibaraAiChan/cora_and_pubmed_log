main start at this time 1648432335.8616152
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001058816909790039
range selection method range initialization spend 8.702278137207031e-05
time for parepare:  6.341934204101562e-05
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.0012831687927246094
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6927719116210938e-05
----------------------check_connections_block total spend ----------------------------- 0.004463911056518555
generate_one_block  0.0014798641204833984
generate_one_block  0.0011296272277832031
generate_one_block  0.0011131763458251953
generate_one_block  0.0010821819305419922
generate_one_block  0.0011098384857177734
generate_one_block  0.0011074542999267578
generate_one_block  0.0010726451873779297
generate_one_block  0.0011417865753173828
generate_one_block  0.0011005401611328125
generate_one_block  0.001087188720703125
generate_one_block  0.001070261001586914
generate_one_block  0.0011186599731445312
generate_one_block  0.0010759830474853516
generate_one_block  0.0010232925415039062
generate_one_block  0.001096963882446289
generate_one_block  0.0010111331939697266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006046295166015625
gen group dst list time:  9.012222290039062e-05
time for parepare:  0.00014495849609375
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001888275146484375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011277198791503906
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001628398895263672
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00013756752014160156
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.012222290039062e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00013446807861328125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.000125885009765625
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00017452239990234375
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00012946128845214844
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  9.894371032714844e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.869171142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.005517482757568359
generate_one_block  0.0013473033905029297
generate_one_block  0.0011990070343017578
generate_one_block  0.0012764930725097656
generate_one_block  0.0012619495391845703
generate_one_block  0.0011532306671142578
generate_one_block  0.0013148784637451172
generate_one_block  0.0012516975402832031
generate_one_block  0.0011861324310302734
generate_one_block  0.001157999038696289
generate_one_block  0.001207590103149414
generate_one_block  0.001081228256225586
generate_one_block  0.001168966293334961
generate_one_block  0.001100778579711914
generate_one_block  0.0011587142944335938
generate_one_block  0.0011780261993408203
generate_one_block  0.0011048316955566406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006868839263916016
gen group dst list time:  0.00015878677368164062
time for parepare:  0.0002143383026123047
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.000682830810546875
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.00045561790466308594
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0005528926849365234
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00045037269592285156
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.000293731689453125
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005526542663574219
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005068778991699219
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040268898010253906
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005042552947998047
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006468296051025391
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0002474784851074219
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0005156993865966797
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.00038242340087890625
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.000560760498046875
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003578662872314453
----------------------check_connections_block total spend ----------------------------- 0.01352071762084961
generate_one_block  0.001996755599975586
generate_one_block  0.0015735626220703125
generate_one_block  0.00171661376953125
generate_one_block  0.0017616748809814453
generate_one_block  0.0013561248779296875
generate_one_block  0.0016608238220214844
generate_one_block  0.0015254020690917969
generate_one_block  0.0014739036560058594
generate_one_block  0.001558065414428711
generate_one_block  0.001783132553100586
generate_one_block  0.0012104511260986328
generate_one_block  0.0016214847564697266
generate_one_block  0.0013053417205810547
generate_one_block  0.0013718605041503906
generate_one_block  0.0015528202056884766
generate_one_block  0.0013642311096191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007309913635253906
gen group dst list time:  0.0002720355987548828
time for parepare:  0.00018477439880371094
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.0003643035888671875
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0016641616821289062
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.0013124942779541016
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0013420581817626953
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0011119842529296875
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0008623600006103516
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0013747215270996094
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.000156402587890625
r_  generation:  0.0012950897216796875
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0010657310485839844
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0013599395751953125
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.0002288818359375
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0016372203826904297
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0007398128509521484
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0010807514190673828
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0009596347808837891
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  0.00011110305786132812
r_  generation:  0.0010271072387695312
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0013034343719482422
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0009465217590332031
----------------------check_connections_block total spend ----------------------------- 0.030379295349121094
generate_one_block  0.002871274948120117
generate_one_block  0.0023827552795410156
generate_one_block  0.0023834705352783203
generate_one_block  0.002186298370361328
generate_one_block  0.0019087791442871094
generate_one_block  0.0032770633697509766
generate_one_block  0.0023763179779052734
generate_one_block  0.002367734909057617
generate_one_block  0.0023870468139648438
generate_one_block  0.002730846405029297
generate_one_block  0.0017735958099365234
generate_one_block  0.0022258758544921875
generate_one_block  0.002077817916870117
generate_one_block  0.002183675765991211
generate_one_block  0.0024619102478027344
generate_one_block  0.002090930938720703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007781982421875
gen group dst list time:  0.0007159709930419922
time for parepare:  0.00018525123596191406
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0001926422119140625
r_  generation:  0.0025391578674316406
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.00032329559326171875
mini_batch_src_global generation:  0.0002486705780029297
r_  generation:  0.002273082733154297
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0021562576293945312
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.0002636909484863281
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0020303726196289062
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.001837015151977539
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.000301361083984375
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.002362489700317383
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.002151012420654297
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0018188953399658203
local_output_nid generation:  0.0001125335693359375
local_in_edges_tensor generation:  0.0002751350402832031
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.0021660327911376953
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0002899169921875
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0023317337036132812
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.0002200603485107422
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0014638900756835938
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0002624988555908203
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.0020232200622558594
local_output_nid generation:  9.965896606445312e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.001882791519165039
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00026297569274902344
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.00201416015625
local_output_nid generation:  0.00011730194091796875
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.00020194053649902344
r_  generation:  0.0022280216217041016
local_output_nid generation:  9.107589721679688e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0017521381378173828
----------------------check_connections_block total spend ----------------------------- 0.05037808418273926
generate_one_block  0.004515886306762695
generate_one_block  0.0034046173095703125
generate_one_block  0.0032172203063964844
generate_one_block  0.003376007080078125
generate_one_block  0.002981901168823242
generate_one_block  0.004347085952758789
generate_one_block  0.003386259078979492
generate_one_block  0.0030138492584228516
generate_one_block  0.0033750534057617188
generate_one_block  0.0036153793334960938
generate_one_block  0.0026617050170898438
generate_one_block  0.003255605697631836
generate_one_block  0.0030803680419921875
generate_one_block  0.0032639503479003906
generate_one_block  0.0034923553466796875
generate_one_block  0.0029935836791992188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017490386962890625  GigaBytes
Max Memory Allocated: 0.0017490386962890625  GigaBytes

connection checking time:  0.09979557991027832
block generation total time  0.13564729690551758
average batch blocks generation time:  0.008477956056594849
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01365804672241211  GigaBytes
Max Memory Allocated: 0.01365804672241211  GigaBytes

torch.Size([2208, 1433])
torch.Size([1764, 128])
torch.Size([1062, 128])
torch.Size([363, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.019562244415283203  GigaBytes
Max Memory Allocated: 0.019596099853515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015311241149902344  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2085, 1433])
torch.Size([1539, 128])
torch.Size([753, 128])
torch.Size([227, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01989889144897461  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014222145080566406  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1991, 1433])
torch.Size([1449, 128])
torch.Size([788, 128])
torch.Size([277, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01889324188232422  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1937, 1433])
torch.Size([1336, 128])
torch.Size([646, 128])
torch.Size([257, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.01803445816040039  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.013224124908447266  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1809, 1433])
torch.Size([1160, 128])
torch.Size([462, 128])
torch.Size([139, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.016419410705566406  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015317916870117188  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2123, 1433])
torch.Size([1618, 128])
torch.Size([826, 128])
torch.Size([293, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.020334720611572266  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014860153198242188  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2111, 1433])
torch.Size([1564, 128])
torch.Size([749, 128])
torch.Size([256, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.019545555114746094  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.013790607452392578  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1913, 1433])
torch.Size([1282, 128])
torch.Size([627, 128])
torch.Size([196, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.017644405364990234  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.014773845672607422  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2094, 1433])
torch.Size([1565, 128])
torch.Size([754, 128])
torch.Size([261, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.019470691680908203  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015330314636230469  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2172, 1433])
torch.Size([1718, 128])
torch.Size([1014, 128])
torch.Size([330, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.021014690399169922  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.012871742248535156  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1745, 1433])
torch.Size([989, 128])
torch.Size([439, 128])
torch.Size([105, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01567554473876953  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.0153045654296875  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2063, 1433])
torch.Size([1428, 128])
torch.Size([694, 128])
torch.Size([255, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.019645214080810547  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.014182090759277344  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1987, 1433])
torch.Size([1305, 128])
torch.Size([586, 128])
torch.Size([158, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01789379119873047  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015300750732421875  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2058, 1433])
torch.Size([1444, 128])
torch.Size([634, 128])
torch.Size([220, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.019452571868896484  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015077590942382812  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([2150, 1433])
torch.Size([1604, 128])
torch.Size([816, 128])
torch.Size([274, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.020020008087158203  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.013459205627441406  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

torch.Size([1852, 1433])
torch.Size([1228, 128])
torch.Size([578, 128])
torch.Size([184, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017047882080078125  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00396554172039032 |0.022040456533432007 |0.05323302745819092 |0.0001207888126373291 |0.004650920629501343 |0.002870321273803711 |
----------------------------------------------------------pseudo_mini_loss sum 4.321654319763184
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  71282
Number of first layer input nodes during this epoch:  32298
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01712656021118164  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000530242919921875
range selection method range initialization spend 7.390975952148438e-05
time for parepare:  7.867813110351562e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
----------------------check_connections_block total spend ----------------------------- 0.0032088756561279297
generate_one_block  0.0011107921600341797
generate_one_block  0.0012712478637695312
generate_one_block  0.0010213851928710938
generate_one_block  0.0010218620300292969
generate_one_block  0.0009891986846923828
generate_one_block  0.000990152359008789
generate_one_block  0.001028299331665039
generate_one_block  0.0010068416595458984
generate_one_block  0.0009894371032714844
generate_one_block  0.000982046127319336
generate_one_block  0.0009617805480957031
generate_one_block  0.0009696483612060547
generate_one_block  0.0009474754333496094
generate_one_block  0.0009636878967285156
generate_one_block  0.0010154247283935547
generate_one_block  0.0010030269622802734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005476474761962891
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.00015044212341308594
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010323524475097656
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00010156631469726562
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011229515075683594
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00012063980102539062
----------------------check_connections_block total spend ----------------------------- 0.005401611328125
generate_one_block  0.0012469291687011719
generate_one_block  0.0011701583862304688
generate_one_block  0.0011830329895019531
generate_one_block  0.0010845661163330078
generate_one_block  0.0010972023010253906
generate_one_block  0.0011222362518310547
generate_one_block  0.0011010169982910156
generate_one_block  0.0011126995086669922
generate_one_block  0.0010721683502197266
generate_one_block  0.0010859966278076172
generate_one_block  0.0010404586791992188
generate_one_block  0.0012776851654052734
generate_one_block  0.0011029243469238281
generate_one_block  0.0010654926300048828
generate_one_block  0.0010786056518554688
generate_one_block  0.0010786056518554688
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006682872772216797
gen group dst list time:  0.00014281272888183594
time for parepare:  0.000225067138671875
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0005953311920166016
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0005660057067871094
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0005469322204589844
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00022745132446289062
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00037384033203125
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0004489421844482422
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004451274871826172
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00047135353088378906
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0003635883331298828
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0008046627044677734
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  6.866455078125e-05
r_  generation:  0.0004851818084716797
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00043129920959472656
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004715919494628906
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0003952980041503906
----------------------check_connections_block total spend ----------------------------- 0.013306140899658203
generate_one_block  0.0017766952514648438
generate_one_block  0.0016887187957763672
generate_one_block  0.0015189647674560547
generate_one_block  0.001199960708618164
generate_one_block  0.0013744831085205078
generate_one_block  0.0014350414276123047
generate_one_block  0.001234292984008789
generate_one_block  0.0019421577453613281
generate_one_block  0.001234292984008789
generate_one_block  0.0014369487762451172
generate_one_block  0.0013494491577148438
generate_one_block  0.0018918514251708984
generate_one_block  0.0014908313751220703
generate_one_block  0.0014197826385498047
generate_one_block  0.0014591217041015625
generate_one_block  0.0013878345489501953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007307529449462891
gen group dst list time:  0.00030875205993652344
time for parepare:  0.000202178955078125
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.001550436019897461
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00017213821411132812
r_  generation:  0.0013587474822998047
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0012943744659423828
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0006406307220458984
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.0001888275146484375
mini_batch_src_global generation:  0.00010442733764648438
r_  generation:  0.0010886192321777344
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0010974407196044922
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0008451938629150391
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.001119375228881836
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0007359981536865234
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00011515617370605469
r_  generation:  0.0011913776397705078
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0009691715240478516
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0017633438110351562
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0011682510375976562
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.001024007797241211
local_output_nid generation:  5.8650970458984375e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0012133121490478516
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0009706020355224609
----------------------check_connections_block total spend ----------------------------- 0.02897477149963379
generate_one_block  0.002864360809326172
generate_one_block  0.002482891082763672
generate_one_block  0.002398252487182617
generate_one_block  0.0018527507781982422
generate_one_block  0.002231597900390625
generate_one_block  0.002151012420654297
generate_one_block  0.0018701553344726562
generate_one_block  0.0022172927856445312
generate_one_block  0.001764535903930664
generate_one_block  0.0022618770599365234
generate_one_block  0.002012968063354492
generate_one_block  0.002964496612548828
generate_one_block  0.0023527145385742188
generate_one_block  0.0021805763244628906
generate_one_block  0.0023813247680664062
generate_one_block  0.002096891403198242
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007550716400146484
gen group dst list time:  0.0006330013275146484
time for parepare:  0.00021266937255859375
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.00041866302490234375
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.002538919448852539
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00030493736267089844
mini_batch_src_global generation:  0.0002639293670654297
r_  generation:  0.0023741722106933594
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.00020360946655273438
r_  generation:  0.0023169517517089844
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0001571178436279297
r_  generation:  0.0015411376953125
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0020751953125
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.00026106834411621094
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.001989603042602539
local_output_nid generation:  9.393692016601562e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0017948150634765625
local_output_nid generation:  0.00010538101196289062
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.00017905235290527344
r_  generation:  0.001898050308227539
local_output_nid generation:  7.915496826171875e-05
local_in_edges_tensor generation:  0.00021600723266601562
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0015149116516113281
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.00017452239990234375
r_  generation:  0.0019774436950683594
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.00017118453979492188
r_  generation:  0.0017833709716796875
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0026252269744873047
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.001972675323486328
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.0001819133758544922
r_  generation:  0.0019533634185791016
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.0020329952239990234
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.0001780986785888672
r_  generation:  0.0018582344055175781
----------------------check_connections_block total spend ----------------------------- 0.04906606674194336
generate_one_block  0.004281759262084961
generate_one_block  0.0041201114654541016
generate_one_block  0.0033588409423828125
generate_one_block  0.002582073211669922
generate_one_block  0.003106355667114258
generate_one_block  0.0030295848846435547
generate_one_block  0.0028285980224609375
generate_one_block  0.0030889511108398438
generate_one_block  0.002709627151489258
generate_one_block  0.0032896995544433594
generate_one_block  0.0029854774475097656
generate_one_block  0.003776073455810547
generate_one_block  0.0032651424407958984
generate_one_block  0.003290891647338867
generate_one_block  0.0033283233642578125
generate_one_block  0.003159046173095703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01712656021118164  GigaBytes
Max Memory Allocated: 0.027000904083251953  GigaBytes

connection checking time:  0.09674859046936035
block generation total time  0.13004446029663086
average batch blocks generation time:  0.008127778768539429
block dataloader generation time/epoch 0.2725546360015869
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.018665313720703125  GigaBytes
Max Memory Allocated: 0.02844095230102539  GigaBytes

torch.Size([2168, 1433])
torch.Size([1646, 128])
torch.Size([939, 128])
torch.Size([317, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0240631103515625  GigaBytes
Max Memory Allocated: 0.02844095230102539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01880359649658203  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([2100, 1433])
torch.Size([1571, 128])
torch.Size([824, 128])
torch.Size([288, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0237579345703125  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01801300048828125  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([2048, 1433])
torch.Size([1539, 128])
torch.Size([758, 128])
torch.Size([278, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.022716045379638672  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.016129493713378906  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1703, 1433])
torch.Size([942, 128])
torch.Size([339, 128])
torch.Size([118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018668174743652344  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017459869384765625  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1947, 1433])
torch.Size([1345, 128])
torch.Size([644, 128])
torch.Size([192, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021431446075439453  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017022132873535156  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1865, 1433])
torch.Size([1289, 128])
torch.Size([623, 128])
torch.Size([233, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020946979522705078  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0168304443359375  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1832, 1433])
torch.Size([1141, 128])
torch.Size([485, 128])
torch.Size([126, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.020006179809570312  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017447471618652344  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1944, 1433])
torch.Size([1349, 128])
torch.Size([650, 128])
torch.Size([233, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02150249481201172  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01613616943359375  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1703, 1433])
torch.Size([1001, 128])
torch.Size([423, 128])
torch.Size([122, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01895427703857422  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01756763458251953  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1966, 1433])
torch.Size([1406, 128])
torch.Size([695, 128])
torch.Size([226, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02181863784790039  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017405033111572266  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1938, 1433])
torch.Size([1246, 128])
torch.Size([551, 128])
torch.Size([179, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.021001815795898438  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.019186973571777344  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([2262, 1433])
torch.Size([1907, 128])
torch.Size([1154, 128])
torch.Size([451, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.025726318359375  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.017621994018554688  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1976, 1433])
torch.Size([1430, 128])
torch.Size([753, 128])
torch.Size([263, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02210378646850586  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.017760753631591797  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([2003, 1433])
torch.Size([1382, 128])
torch.Size([659, 128])
torch.Size([204, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.021856307983398438  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.017678260803222656  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1986, 1433])
torch.Size([1471, 128])
torch.Size([747, 128])
torch.Size([237, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.022170543670654297  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.017442703247070312  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

torch.Size([1944, 1433])
torch.Size([1317, 128])
torch.Size([594, 128])
torch.Size([211, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.02130413055419922  GigaBytes
Max Memory Allocated: 0.030273914337158203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003156006336212158 |0.0007511228322982788 |0.005890801548957825 |0.00013794004917144775 |0.0052801817655563354 |0.0024771690368652344 |
----------------------------------------------------------pseudo_mini_loss sum 3.1456167697906494
Total (block generation + training)time/epoch 0.5355250835418701
Training time/epoch 0.262772798538208
Training time without block to device /epoch 0.25075483322143555
Training time without total dataloading part /epoch 0.18341994285583496
load block tensor time/epoch 0.05049610137939453
block to device time/epoch 0.012017965316772461
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.9073486328125e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  68646
Number of first layer input nodes during this epoch:  31385
