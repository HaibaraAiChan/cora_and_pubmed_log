main start at this time 1648432209.9364455
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0015377998352050781
range selection method range initialization spend 8.20159912109375e-05
time for parepare:  5.936622619628906e-05
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00019860267639160156
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.003086090087890625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  8.940696716308594e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.7179718017578125e-05
----------------------check_connections_block total spend ----------------------------- 0.0049266815185546875
generate_one_block  0.0014410018920898438
generate_one_block  0.001131296157836914
generate_one_block  0.001016378402709961
generate_one_block  0.001001596450805664
generate_one_block  0.0010273456573486328
generate_one_block  0.0010349750518798828
generate_one_block  0.0010230541229248047
generate_one_block  0.0010051727294921875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004775524139404297
gen group dst list time:  5.5789947509765625e-05
time for parepare:  0.00013947486877441406
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003046989440917969
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00015664100646972656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00018286705017089844
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0002696514129638672
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002422332763671875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002338886260986328
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0001628398895263672
----------------------check_connections_block total spend ----------------------------- 0.0038862228393554688
generate_one_block  0.0012364387512207031
generate_one_block  0.0013506412506103516
generate_one_block  0.0011622905731201172
generate_one_block  0.001253366470336914
generate_one_block  0.0013284683227539062
generate_one_block  0.0012867450714111328
generate_one_block  0.001277923583984375
generate_one_block  0.0011699199676513672
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006456375122070312
gen group dst list time:  9.72747802734375e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00010418891906738281
r_  generation:  0.0006923675537109375
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0009396076202392578
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0005369186401367188
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.000621795654296875
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0008790493011474609
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0008533000946044922
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0007622241973876953
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0005955696105957031
----------------------check_connections_block total spend ----------------------------- 0.010139703750610352
generate_one_block  0.0018661022186279297
generate_one_block  0.0021185874938964844
generate_one_block  0.0016252994537353516
generate_one_block  0.001720428466796875
generate_one_block  0.002038717269897461
generate_one_block  0.0020363330841064453
generate_one_block  0.0018818378448486328
generate_one_block  0.0017502307891845703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007576942443847656
gen group dst list time:  0.00018167495727539062
time for parepare:  0.00017881393432617188
local_output_nid generation:  7.152557373046875e-05
local_in_edges_tensor generation:  0.00035691261291503906
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0016894340515136719
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  0.0002167224884033203
r_  generation:  0.0019385814666748047
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.00014781951904296875
r_  generation:  0.0014407634735107422
local_output_nid generation:  6.580352783203125e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0013594627380371094
local_output_nid generation:  8.392333984375e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.001786947250366211
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.0002491474151611328
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0018665790557861328
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.001596689224243164
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.0001456737518310547
r_  generation:  0.0014328956604003906
----------------------check_connections_block total spend ----------------------------- 0.020456552505493164
generate_one_block  0.0030214786529541016
generate_one_block  0.003165721893310547
generate_one_block  0.0026459693908691406
generate_one_block  0.0025174617767333984
generate_one_block  0.0030739307403564453
generate_one_block  0.0032873153686523438
generate_one_block  0.0027933120727539062
generate_one_block  0.0026175975799560547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007619857788085938
gen group dst list time:  0.00035834312438964844
time for parepare:  0.00017762184143066406
local_output_nid generation:  0.00011658668518066406
local_in_edges_tensor generation:  0.0004417896270751953
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.002465486526489258
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0003180503845214844
mini_batch_src_global generation:  0.0002808570861816406
r_  generation:  0.002724885940551758
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0002865791320800781
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.002353191375732422
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.0002658367156982422
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0020651817321777344
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00031113624572753906
mini_batch_src_global generation:  0.000213623046875
r_  generation:  0.002534151077270508
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation:  0.000232696533203125
r_  generation:  0.0026094913482666016
local_output_nid generation:  0.00012421607971191406
local_in_edges_tensor generation:  0.0002956390380859375
mini_batch_src_global generation:  0.0002281665802001953
r_  generation:  0.0024726390838623047
local_output_nid generation:  0.00012254714965820312
local_in_edges_tensor generation:  0.00028634071350097656
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.002362966537475586
----------------------check_connections_block total spend ----------------------------- 0.029618263244628906
generate_one_block  0.0044956207275390625
generate_one_block  0.0038182735443115234
generate_one_block  0.0035753250122070312
generate_one_block  0.003282308578491211
generate_one_block  0.004317760467529297
generate_one_block  0.00459599494934082
generate_one_block  0.003695249557495117
generate_one_block  0.003594636917114258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

connection checking time:  0.06410074234008789
block generation total time  0.07960128784179688
average batch blocks generation time:  0.00995016098022461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.012156009674072266  GigaBytes
Max Memory Allocated: 0.012156009674072266  GigaBytes

torch.Size([2218, 1433])
torch.Size([1849, 16])
torch.Size([1118, 16])
torch.Size([408, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.013083457946777344  GigaBytes
Max Memory Allocated: 0.013086318969726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012646675109863281  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

torch.Size([2272, 1433])
torch.Size([1991, 16])
torch.Size([1340, 16])
torch.Size([576, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013739585876464844  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012197017669677734  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

torch.Size([2194, 1433])
torch.Size([1720, 16])
torch.Size([929, 16])
torch.Size([300, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01300811767578125  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010956287384033203  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

torch.Size([1963, 1433])
torch.Size([1508, 16])
torch.Size([873, 16])
torch.Size([368, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01171875  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012609481811523438  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

torch.Size([2267, 1433])
torch.Size([1905, 16])
torch.Size([1203, 16])
torch.Size([523, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013618946075439453  GigaBytes
Max Memory Allocated: 0.024342060089111328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01280975341796875  GigaBytes
Max Memory Allocated: 0.02477407455444336  GigaBytes

torch.Size([2304, 1433])
torch.Size([1988, 16])
torch.Size([1278, 16])
torch.Size([503, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013847827911376953  GigaBytes
Max Memory Allocated: 0.02477407455444336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012759208679199219  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2297, 1433])
torch.Size([1837, 16])
torch.Size([1069, 16])
torch.Size([462, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013689994812011719  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012250423431396484  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2204, 1433])
torch.Size([1729, 16])
torch.Size([932, 16])
torch.Size([343, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01307058334350586  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006027787923812866 |0.04303395748138428 |0.10104870796203613 |0.00014892220497131348 |0.0038479268550872803 |0.002997159957885742 |
----------------------------------------------------------pseudo_mini_loss sum 3.4090726375579834
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45229
Number of first layer input nodes during this epoch:  17719
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012873172760009766  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004467964172363281
range selection method range initialization spend 6.365776062011719e-05
time for parepare:  6.4849853515625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9802322387695312e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.981590270996094e-05
----------------------check_connections_block total spend ----------------------------- 0.0017502307891845703
generate_one_block  0.0010631084442138672
generate_one_block  0.001056671142578125
generate_one_block  0.0010004043579101562
generate_one_block  0.0010385513305664062
generate_one_block  0.0009906291961669922
generate_one_block  0.0009734630584716797
generate_one_block  0.0010406970977783203
generate_one_block  0.0010302066802978516
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004589557647705078
gen group dst list time:  5.412101745605469e-05
time for parepare:  0.00015473365783691406
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001647472381591797
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00021409988403320312
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000217437744140625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00028777122497558594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0002276897430419922
----------------------check_connections_block total spend ----------------------------- 0.0038330554962158203
generate_one_block  0.0011620521545410156
generate_one_block  0.0012662410736083984
generate_one_block  0.0013349056243896484
generate_one_block  0.0011544227600097656
generate_one_block  0.001247406005859375
generate_one_block  0.0011801719665527344
generate_one_block  0.0013036727905273438
generate_one_block  0.0012407302856445312
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006835460662841797
gen group dst list time:  9.72747802734375e-05
time for parepare:  0.00018978118896484375
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005333423614501953
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0007812976837158203
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0007143020629882812
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0006511211395263672
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  7.987022399902344e-05
r_  generation:  0.0006718635559082031
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006122589111328125
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0008769035339355469
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0007512569427490234
----------------------check_connections_block total spend ----------------------------- 0.009721517562866211
generate_one_block  0.0016562938690185547
generate_one_block  0.0018754005432128906
generate_one_block  0.0018281936645507812
generate_one_block  0.001744985580444336
generate_one_block  0.00176239013671875
generate_one_block  0.0016241073608398438
generate_one_block  0.001991748809814453
generate_one_block  0.0019397735595703125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007190704345703125
gen group dst list time:  0.00017833709716796875
time for parepare:  0.00018024444580078125
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0013322830200195312
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.0002334117889404297
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0017490386962890625
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00024080276489257812
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.001627206802368164
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0016112327575683594
local_output_nid generation:  7.2479248046875e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0015022754669189453
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0015048980712890625
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.001783132553100586
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0016074180603027344
----------------------check_connections_block total spend ----------------------------- 0.019823789596557617
generate_one_block  0.002537965774536133
generate_one_block  0.002897024154663086
generate_one_block  0.002854585647583008
generate_one_block  0.002749919891357422
generate_one_block  0.0026683807373046875
generate_one_block  0.0026743412017822266
generate_one_block  0.003307819366455078
generate_one_block  0.0028295516967773438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007548332214355469
gen group dst list time:  0.0003383159637451172
time for parepare:  0.00019621849060058594
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00041556358337402344
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0022406578063964844
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.0003161430358886719
mini_batch_src_global generation:  0.0002684593200683594
r_  generation:  0.002447843551635742
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003104209899902344
mini_batch_src_global generation:  0.00023245811462402344
r_  generation:  0.002439737319946289
local_output_nid generation:  0.00015425682067871094
local_in_edges_tensor generation:  0.00030684471130371094
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.0024056434631347656
local_output_nid generation:  0.00011682510375976562
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0022974014282226562
local_output_nid generation:  0.0001220703125
local_in_edges_tensor generation:  0.0002827644348144531
mini_batch_src_global generation:  0.00020813941955566406
r_  generation:  0.0023775100708007812
local_output_nid generation:  0.00012993812561035156
local_in_edges_tensor generation:  0.0002994537353515625
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0025107860565185547
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.0002181529998779297
r_  generation:  0.0023691654205322266
----------------------check_connections_block total spend ----------------------------- 0.02915644645690918
generate_one_block  0.0034856796264648438
generate_one_block  0.0036597251892089844
generate_one_block  0.003679513931274414
generate_one_block  0.003947734832763672
generate_one_block  0.0035021305084228516
generate_one_block  0.003602743148803711
generate_one_block  0.0041124820709228516
generate_one_block  0.003610372543334961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012873172760009766  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

connection checking time:  0.06253480911254883
block generation total time  0.07643246650695801
average batch blocks generation time:  0.009554058313369751
block dataloader generation time/epoch 0.16801071166992188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012196063995361328  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2127, 1433])
torch.Size([1603, 16])
torch.Size([840, 16])
torch.Size([302, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012952804565429688  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012816905975341797  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2239, 1433])
torch.Size([1801, 16])
torch.Size([1125, 16])
torch.Size([460, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01375436782836914  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012732982635498047  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2224, 1433])
torch.Size([1827, 16])
torch.Size([1101, 16])
torch.Size([437, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013660907745361328  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012769699096679688  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2232, 1433])
torch.Size([1792, 16])
torch.Size([1026, 16])
torch.Size([360, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013640403747558594  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012321949005126953  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2149, 1433])
torch.Size([1671, 16])
torch.Size([979, 16])
torch.Size([406, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013167858123779297  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012150287628173828  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2117, 1433])
torch.Size([1691, 16])
torch.Size([934, 16])
torch.Size([301, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012960433959960938  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012927055358886719  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2258, 1433])
torch.Size([1879, 16])
torch.Size([1221, 16])

torch.Size([511, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01393747329711914  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.012534618377685547  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

torch.Size([2187, 1433])
torch.Size([1749, 16])
torch.Size([1064, 16])
torch.Size([428, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01343536376953125  GigaBytes
Max Memory Allocated: 0.02493429183959961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002245694398880005 |0.0008248090744018555 |0.0059732794761657715 |0.00012105703353881836 |0.0033432841300964355 |0.0026388168334960938 |
----------------------------------------------------------pseudo_mini_loss sum 3.0706021785736084
Total (block generation + training)time/epoch 0.280163049697876
Training time/epoch 0.11190152168273926
Training time without block to device /epoch 0.10530304908752441
Training time without total dataloading part /epoch 0.0781397819519043
load block tensor time/epoch 0.01796555519104004
block to device time/epoch 0.006598472595214844
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  43788
Number of first layer input nodes during this epoch:  17533
