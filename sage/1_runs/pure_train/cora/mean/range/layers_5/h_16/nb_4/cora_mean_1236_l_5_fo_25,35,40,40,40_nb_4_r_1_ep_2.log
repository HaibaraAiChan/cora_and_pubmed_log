main start at this time 1648432200.5384963
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012958049774169922
range selection method range initialization spend 7.414817810058594e-05
time for parepare:  6.008148193359375e-05
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.002724885940551758
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.817413330078125e-05
----------------------check_connections_block total spend ----------------------------- 0.003840208053588867
generate_one_block  0.0013470649719238281
generate_one_block  0.0010807514190673828
generate_one_block  0.0011072158813476562
generate_one_block  0.0010480880737304688
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00048804283142089844
gen group dst list time:  4.9591064453125e-05
time for parepare:  0.00012922286987304688
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00037360191345214844
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003085136413574219
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00046706199645996094
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.000339508056640625
----------------------check_connections_block total spend ----------------------------- 0.00286865234375
generate_one_block  0.0014863014221191406
generate_one_block  0.0013058185577392578
generate_one_block  0.00154876708984375
generate_one_block  0.0013744831085205078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005359649658203125
gen group dst list time:  7.081031799316406e-05
time for parepare:  0.00016164779663085938
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00011014938354492188
r_  generation:  0.0011734962463378906
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.000942230224609375
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.00012636184692382812
r_  generation:  0.0013833045959472656
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0009999275207519531
----------------------check_connections_block total spend ----------------------------- 0.007268428802490234
generate_one_block  0.0024144649505615234
generate_one_block  0.0020711421966552734
generate_one_block  0.0025670528411865234
generate_one_block  0.0021104812622070312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000762939453125
gen group dst list time:  0.0001266002655029297
time for parepare:  0.000179290771484375
local_output_nid generation:  0.00010561943054199219
local_in_edges_tensor generation:  0.0004048347473144531
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0021445751190185547
local_output_nid generation:  9.655952453613281e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.00021386146545410156
r_  generation:  0.001973867416381836
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.0002732276916503906
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0023610591888427734
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002465248107910156
mini_batch_src_global generation:  0.0001819133758544922
r_  generation:  0.002033233642578125
----------------------check_connections_block total spend ----------------------------- 0.013026237487792969
generate_one_block  0.003363370895385742
generate_one_block  0.0031719207763671875
generate_one_block  0.0034923553466796875
generate_one_block  0.0032846927642822266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007309913635253906
gen group dst list time:  0.00017070770263671875
time for parepare:  0.0001735687255859375
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.0004734992980957031
mini_batch_src_global generation:  0.0001842975616455078
r_  generation:  0.0027747154235839844
local_output_nid generation:  0.00013375282287597656
local_in_edges_tensor generation:  0.0003120899200439453
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.002730131149291992
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.0002505779266357422
r_  generation:  0.0028998851776123047
local_output_nid generation:  0.0001361370086669922
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.00022912025451660156
r_  generation:  0.0027985572814941406
----------------------check_connections_block total spend ----------------------------- 0.016783952713012695
generate_one_block  0.004046201705932617
generate_one_block  0.004666805267333984
generate_one_block  0.0039386749267578125
generate_one_block  0.003880739212036133
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018787384033203125  GigaBytes
Max Memory Allocated: 0.00018787384033203125  GigaBytes

connection checking time:  0.0399472713470459
block generation total time  0.0447232723236084
average batch blocks generation time:  0.0111808180809021
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.012720108032226562  GigaBytes
Max Memory Allocated: 0.012720108032226562  GigaBytes

torch.Size([2318, 1433])
torch.Size([2059, 16])
torch.Size([1496, 16])
torch.Size([710, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.013926029205322266  GigaBytes
Max Memory Allocated: 0.013933181762695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012892723083496094  GigaBytes
Max Memory Allocated: 0.025121688842773438  GigaBytes

torch.Size([2318, 1433])
torch.Size([1999, 16])
torch.Size([1373, 16])
torch.Size([562, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013997554779052734  GigaBytes
Max Memory Allocated: 0.025121688842773438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0132293701171875  GigaBytes
Max Memory Allocated: 0.02543163299560547  GigaBytes

torch.Size([2376, 1433])
torch.Size([2168, 16])
torch.Size([1652, 16])
torch.Size([838, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014554500579833984  GigaBytes
Max Memory Allocated: 0.02543163299560547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013205528259277344  GigaBytes
Max Memory Allocated: 0.0257415771484375  GigaBytes

torch.Size([2376, 1433])
torch.Size([2069, 16])
torch.Size([1359, 16])
torch.Size([636, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01434469223022461  GigaBytes
Max Memory Allocated: 0.0257415771484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012411713600158691 |0.0855819582939148 |0.1946665644645691 |0.00017750263214111328 |0.0046117305755615234 |0.004425525665283203 |
----------------------------------------------------------pseudo_mini_loss sum 3.304004669189453
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27036
Number of first layer input nodes during this epoch:  9388
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01390981674194336  GigaBytes
Max Memory Allocated: 0.0257415771484375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00045800209045410156
range selection method range initialization spend 6.0558319091796875e-05
time for parepare:  6.413459777832031e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.699562072753906e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  6.079673767089844e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  8.654594421386719e-05
----------------------check_connections_block total spend ----------------------------- 0.0011374950408935547
generate_one_block  0.0011947154998779297
generate_one_block  0.0010280609130859375
generate_one_block  0.001028299331665039
generate_one_block  0.0011017322540283203
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004897117614746094
gen group dst list time:  3.6716461181640625e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003306865692138672
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003237724304199219
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003275871276855469
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005056858062744141
----------------------check_connections_block total spend ----------------------------- 0.002937793731689453
generate_one_block  0.0014240741729736328
generate_one_block  0.0013511180877685547
generate_one_block  0.001444101333618164
generate_one_block  0.0015375614166259766
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005490779876708984
gen group dst list time:  7.128715515136719e-05
time for parepare:  0.00016760826110839844
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0002529621124267578
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0011932849884033203
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0010068416595458984
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0010447502136230469
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.0001404285430908203
r_  generation:  0.0012860298156738281
----------------------check_connections_block total spend ----------------------------- 0.007489681243896484
generate_one_block  0.0022716522216796875
generate_one_block  0.002129793167114258
generate_one_block  0.0022020339965820312
generate_one_block  0.002433300018310547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007176399230957031
gen group dst list time:  0.0001227855682373047
time for parepare:  0.00017333030700683594
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0003597736358642578
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.002236604690551758
local_output_nid generation:  9.918212890625e-05
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.00023746490478515625
r_  generation:  0.0019876956939697266
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.002015829086303711
local_output_nid generation:  0.00010323524475097656
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.00222015380859375
----------------------check_connections_block total spend ----------------------------- 0.013147354125976562
generate_one_block  0.0037102699279785156
generate_one_block  0.0032510757446289062
generate_one_block  0.0032427310943603516
generate_one_block  0.0033864974975585938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007445812225341797
gen group dst list time:  0.00017571449279785156
time for parepare:  0.00018143653869628906
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00045299530029296875
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.002798795700073242
local_output_nid generation:  0.00014066696166992188
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.0002989768981933594
r_  generation:  0.002716064453125
local_output_nid generation:  0.0001366138458251953
local_in_edges_tensor generation:  0.0003161430358886719
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0026340484619140625
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.0003204345703125
mini_batch_src_global generation: Using backend: pytorch
 0.00023365020751953125
r_  generation:  0.0027577877044677734
----------------------check_connections_block total spend ----------------------------- 0.016634464263916016
generate_one_block  0.004429340362548828
generate_one_block  0.003998279571533203
generate_one_block  0.003811359405517578
generate_one_block  0.003911495208740234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01390981674194336  GigaBytes
Max Memory Allocated: 0.0257415771484375  GigaBytes

connection checking time:  0.040209293365478516
block generation total time  0.04453468322753906
average batch blocks generation time:  0.011133670806884766
block dataloader generation time/epoch 0.10835886001586914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013565540313720703  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

torch.Size([2374, 1433])
torch.Size([2142, 16])
torch.Size([1477, 16])
torch.Size([648, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01475667953491211  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013549327850341797  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

torch.Size([2372, 1433])
torch.Size([2081, 16])
torch.Size([1391, 16])
torch.Size([630, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014696598052978516  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013017654418945312  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

torch.Size([2273, 1433])
torch.Size([2009, 16])
torch.Size([1391, 16])
torch.Size([599, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014142990112304688  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.013464927673339844  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

torch.Size([2353, 1433])
torch.Size([2098, 16])
torch.Size([1520, 16])
torch.Size([805, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014732837677001953  GigaBytes
Max Memory Allocated: 0.02609395980834961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002504587173461914 |0.0009322166442871094 |0.005800783634185791 |0.00012558698654174805 |0.003369271755218506 |0.0024471282958984375 |
----------------------------------------------------------pseudo_mini_loss sum 3.0547356605529785
Total (block generation + training)time/epoch 0.16683030128479004
Training time/epoch 0.05820035934448242
Training time without block to device /epoch 0.054471492767333984
Training time without total dataloading part /epoch 0.03962969779968262
load block tensor time/epoch 0.010018348693847656
block to device time/epoch 0.0037288665771484375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  26882
Number of first layer input nodes during this epoch:  9372
