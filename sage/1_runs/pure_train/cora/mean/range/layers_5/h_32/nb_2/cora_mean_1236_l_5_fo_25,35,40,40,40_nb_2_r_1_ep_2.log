main start at this time 1648432229.9643548
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013339519500732422
range selection method range initialization spend 0.00010371208190917969
time for parepare:  6.413459777832031e-05
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0025844573974609375
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00012874603271484375
----------------------check_connections_block total spend ----------------------------- 0.003423452377319336
generate_one_block  0.001493215560913086
generate_one_block  0.001222372055053711
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004978179931640625
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00014257431030273438
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0007679462432861328
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0006272792816162109
----------------------check_connections_block total spend ----------------------------- 0.002640247344970703
generate_one_block  0.0020284652709960938
generate_one_block  0.001786947250366211
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005803108215332031
gen group dst list time:  5.6743621826171875e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0019271373748779297
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0016827583312988281
----------------------check_connections_block total spend ----------------------------- 0.0057370662689208984
generate_one_block  0.003276348114013672
generate_one_block  0.002984285354614258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006296634674072266
gen group dst list time:  8.869171142578125e-05
time for parepare:  0.00018644332885742188
local_output_nid generation:  0.00012493133544921875
local_in_edges_tensor generation:  0.0004074573516845703
mini_batch_src_global generation:  0.0001952648162841797
r_  generation:  0.0028142929077148438
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.00029397010803222656
r_  generation:  0.0027420520782470703
----------------------check_connections_block total spend ----------------------------- 0.008605003356933594
generate_one_block  0.004235506057739258
generate_one_block  0.003846883773803711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007746219635009766
gen group dst list time:  0.0001087188720703125
time for parepare:  0.00018787384033203125
local_output_nid generation:  0.0001499652862548828
local_in_edges_tensor generation:  0.0004899501800537109
mini_batch_src_global generation:  0.0002105236053466797
r_  generation:  0.003148794174194336
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00036978721618652344
mini_batch_src_global generation:  0.00034356117248535156
r_  generation:  0.0031890869140625
----------------------check_connections_block total spend ----------------------------- 0.009768247604370117
generate_one_block  0.004582405090332031
generate_one_block  0.0042340755462646484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

connection checking time:  0.026750564575195312
block generation total time  0.026974916458129883
average batch blocks generation time:  0.013487458229064941
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014248847961425781  GigaBytes
Max Memory Allocated: 0.014248847961425781  GigaBytes

torch.Size([2420, 1433])
torch.Size([2279, 32])
torch.Size([1935, 32])
torch.Size([1205, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.017176151275634766  GigaBytes
Max Memory Allocated: 0.01721477508544922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014611244201660156  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

torch.Size([2465, 1433])
torch.Size([2303, 32])
torch.Size([1851, 32])
torch.Size([1025, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017359256744384766  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008874297142028809 |0.1715918779373169 |0.3981527090072632 |0.00022268295288085938 |0.007422924041748047 |0.005486726760864258 |
----------------------------------------------------------pseudo_mini_loss sum 4.114886283874512
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16181
Number of first layer input nodes during this epoch:  4885
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015781402587890625  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0006079673767089844
range selection method range initialization spend 7.987022399902344e-05
time for parepare:  9.036064147949219e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00016760826110839844
----------------------check_connections_block total spend ----------------------------- 0.0011658668518066406
generate_one_block  0.0015850067138671875
generate_one_block  0.0014429092407226562
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005259513854980469
gen group dst list time:  3.123283386230469e-05
time for parepare:  0.0001666545867919922
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00022363662719726562
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0007259845733642578
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00016188621520996094
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0006573200225830078
----------------------check_connections_block total spend ----------------------------- 0.0027005672454833984
generate_one_block  0.0019533634185791016
generate_one_block  0.0018084049224853516
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005929470062255859
gen group dst list time:  5.91278076171875e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0017893314361572266
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.001821756362915039
----------------------check_connections_block total spend ----------------------------- 0.005866527557373047
generate_one_block  0.003116130828857422
generate_one_block  0.0031099319458007812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000629425048828125
gen group dst list time:  9.012222290039062e-05
time for parepare:  0.00021219253540039062
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.002740144729614258
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.0002880096435546875
r_  generation:  0.002794027328491211
----------------------check_connections_block total spend ----------------------------- 0.008559703826904297
generate_one_block  0.003973960876464844
generate_one_block  0.003851652145385742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007786750793457031
gen group dst list time:  0.00010776519775390625
time for parepare:  0.0001857280731201172
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0004374980926513672
mini_batch_src_global generation:  0.00025081634521484375
r_  generation:  0.0030908584594726562
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.00039577484130859375
mini_batch_src_global generation:  0.0003254413604736328
r_  generation:  0.003139495849609375
----------------------check_connections_block total spend ----------------------------- 0.009674072265625
generate_one_block  0.00432896614074707
generate_one_block  0.0044138431549072266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015781402587890625  GigaBytes
Max Memory Allocated: 0.02809619903564453  GigaBytes

connection checking time:  0.026800870895385742
block generation total time  0.02655625343322754
average batch blocks generation time:  0.01327812671661377
block dataloader generation time/epoch 0.07456135749816895
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01535797119140625  GigaBytes
Max Memory Allocated: 0.028837203979492188  GigaBytes

torch.Size([2418, 1433])
torch.Size([2285, 32])
torch.Size([1885, 32])
torch.Size([1137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018210887908935547  GigaBytes
Max Memory Allocated: 0.028837203979492188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01535797119140625  GigaBytes
Max Memory Allocated: 0.028838157653808594  GigaBytes

torch.Size([2447, 1433])
torch.Size([2314, 32])
torch.Size([1900, 32])
torch.Size([1100, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018185138702392578  GigaBytes
Max Memory Allocated: 0.028838157653808594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00395047664642334 |0.000691533088684082 |0.005548000335693359 |0.0001277923583984375 |0.005381345748901367 |0.0021317005157470703 |
----------------------------------------------------------pseudo_mini_loss sum 3.321981906890869
Total (block generation + training)time/epoch 0.11081790924072266
Training time/epoch 0.035909414291381836
Training time without block to device /epoch 0.03452634811401367
Training time without total dataloading part /epoch 0.0242459774017334
load block tensor time/epoch 0.00790095329284668
block to device time/epoch 0.001383066177368164
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16184
Number of first layer input nodes during this epoch:  4865
