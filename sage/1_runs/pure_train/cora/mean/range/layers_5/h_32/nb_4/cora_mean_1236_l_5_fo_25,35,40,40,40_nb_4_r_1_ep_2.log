main start at this time 1648432239.2501886
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001844644546508789
range selection method range initialization spend 0.00014448165893554688
time for parepare:  9.608268737792969e-05
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00405573844909668
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.005463123321533203
generate_one_block  0.0016160011291503906
generate_one_block  0.001211404800415039
generate_one_block  0.0012366771697998047
generate_one_block  0.0011548995971679688
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000514984130859375
gen group dst list time:  4.172325134277344e-05
time for parepare:  0.00014209747314453125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004680156707763672
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00042748451232910156
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0003190040588378906
----------------------check_connections_block total spend ----------------------------- 0.003087759017944336
generate_one_block  0.0015940666198730469
generate_one_block  0.001538991928100586
generate_one_block  0.0014450550079345703
generate_one_block  0.0014276504516601562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005526542663574219
gen group dst list time:  7.367134094238281e-05
time for parepare:  0.00016927719116210938
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0012974739074707031
local_output_nid generation:  6.0558319091796875e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.0013115406036376953
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.0011701583862304688
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0010066032409667969
----------------------check_connections_block total spend ----------------------------- 0.007789134979248047
generate_one_block  0.0026400089263916016
generate_one_block  0.0025398731231689453
generate_one_block  0.0023272037506103516
generate_one_block  0.0021543502807617188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007233619689941406
gen group dst list time:  0.00012683868408203125
time for parepare:  0.00018262863159179688
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0022819042205810547
local_output_nid generation:  0.00010800361633300781
local_in_edges_tensor generation:  0.0002818107604980469
mini_batch_src_global generation:  0.00028228759765625
r_  generation:  0.002366304397583008
local_output_nid generation:  0.00010657310485839844
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.0021619796752929688
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0002875328063964844
mini_batch_src_global generation:  0.0002048015594482422
r_  generation:  0.0020422935485839844
----------------------check_connections_block total spend ----------------------------- 0.01377415657043457
generate_one_block  0.003715038299560547
generate_one_block  0.0035123825073242188
generate_one_block  0.0033783912658691406
generate_one_block  0.003383159637451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00074005126953125
gen group dst list time:  0.00017762184143066406
time for parepare:  0.00017833709716796875
local_output_nid generation:  0.0001308917999267578
local_in_edges_tensor generation:  0.0004582405090332031
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.0028676986694335938
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.00037741661071777344
mini_batch_src_global generation:  0.00031685829162597656
r_  generation:  0.002804994583129883
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.00027751922607421875
r_  generation:  0.002836465835571289
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.0027379989624023438
----------------------check_connections_block total spend ----------------------------- 0.017424821853637695
generate_one_block  0.004839658737182617
generate_one_block  0.00395965576171875
generate_one_block  0.003979682922363281
generate_one_block  0.0038924217224121094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

connection checking time:  0.04207587242126465
block generation total time  0.04632759094238281
average batch blocks generation time:  0.011581897735595703
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.013115882873535156  GigaBytes
Max Memory Allocated: 0.013115882873535156  GigaBytes

torch.Size([2355, 1433])
torch.Size([2143, 32])
torch.Size([1611, 32])
torch.Size([791, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.015480995178222656  GigaBytes
Max Memory Allocated: 0.015501022338867188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013460636138916016  GigaBytes
Max Memory Allocated: 0.02586221694946289  GigaBytes

torch.Size([2349, 1433])
torch.Size([2168, 32])
torch.Size([1659, 32])
torch.Size([824, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01587677001953125  GigaBytes
Max Memory Allocated: 0.02586221694946289  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014582157135009766  GigaBytes
Max Memory Allocated: 0.0269622802734375  GigaBytes

torch.Size([2391, 1433])
torch.Size([2167, 32])
torch.Size([1528, 32])
torch.Size([706, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016846179962158203  GigaBytes
Max Memory Allocated: 0.0269622802734375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013487815856933594  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

torch.Size([2358, 1433])
torch.Size([2052, 32])
torch.Size([1400, 32])
torch.Size([586, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015558719635009766  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0080033540725708 |0.08647018671035767 |0.19697248935699463 |0.00016438961029052734 |0.004611849784851074 |0.0029714107513427734 |
----------------------------------------------------------pseudo_mini_loss sum 4.130603313446045
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  27824
Number of first layer input nodes during this epoch:  9453
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014571666717529297  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00047206878662109375
range selection method range initialization spend 6.246566772460938e-05
time for parepare:  6.4849853515625e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.173683166503906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.486343383789062e-05
----------------------check_connections_block total spend ----------------------------- 0.001194000244140625
generate_one_block  0.0011513233184814453
generate_one_block  0.0010638236999511719
generate_one_block  0.001058816909790039
generate_one_block  0.0010769367218017578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00048732757568359375
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.0001552104949951172
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0004591941833496094
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.00039958953857421875
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00032806396484375
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00041937828063964844
----------------------check_connections_block total spend ----------------------------- 0.0031495094299316406
generate_one_block  0.001547098159790039
generate_one_block  0.0014731884002685547
generate_one_block  0.0014424324035644531
generate_one_block  0.0014803409576416016
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005564689636230469
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00026726722717285156
mini_batch_src_global generation:  0.0001537799835205078
r_  generation:  0.0012814998626708984
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.0011599063873291016
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0010614395141601562
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.00013566017150878906
r_  generation:  0.0012936592102050781
----------------------check_connections_block total spend ----------------------------- 0.007831811904907227
generate_one_block  0.0024871826171875
generate_one_block  0.0023374557495117188
generate_one_block  0.0021805763244628906
generate_one_block  0.002392292022705078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008726119995117188
gen group dst list time:  0.00013446807861328125
time for parepare:  0.00019240379333496094
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.0008978843688964844
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.002307891845703125
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00027561187744140625
mini_batch_src_global generation:  0.00026988983154296875
r_  generation:  0.0021932125091552734
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation:  0.00027632713317871094
mini_batch_src_global generation:  0.0002224445343017578
r_  generation:  0.002226114273071289
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.00237274169921875
----------------------check_connections_block total spend ----------------------------- 0.014655113220214844
generate_one_block  0.0037012100219726562
generate_one_block  0.003329038619995117
generate_one_block  0.0033524036407470703
generate_one_block  0.003460407257080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007431507110595703
gen group dst list time:  0.0001862049102783203
time for parepare:  0.00019598007202148438
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.0004870891571044922
mini_batch_src_global generation:  0.00021266937255859375
r_  generation:  0.0029535293579101562
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.00034427642822265625
mini_batch_src_global generation:  0.0003223419189453125
r_  generation:  0.0028498172760009766
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.0003464221954345703
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.002942323684692383
local_output_nid generation:  0.00015115737915039062
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation: 0.0002760887145996094
r_  generation:  0.0029973983764648438
----------------------check_connections_block total spend ----------------------------- 0.017952442169189453
generate_one_block  0.004082679748535156
generate_one_block  0.003935575485229492
generate_one_block  0.00430607795715332
generate_one_block  0.004014492034912109
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014571666717529297  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

connection checking time:  0.043588876724243164
block generation total time  0.045522451400756836
average batch blocks generation time:  0.011380612850189209
block dataloader generation time/epoch 0.11046862602233887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01411294937133789  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

torch.Size([2334, 1433])
torch.Size([2095, 32])
torch.Size([1513, 32])
torch.Size([750, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016388893127441406  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01397848129272461  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

torch.Size([2310, 1433])
torch.Size([2069, 32])
torch.Size([1456, 32])
torch.Size([679, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01614856719970703  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014323234558105469  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

torch.Size([2375, 1433])
torch.Size([2135, 32])
torch.Size([1459, 32])
torch.Size([612, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01647329330444336  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014293193817138672  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

torch.Size([2367, 1433])
torch.Size([2166, 32])
torch.Size([1583, 32])
torch.Size([748, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01662158966064453  GigaBytes
Max Memory Allocated: 0.027010440826416016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036818385124206543 |0.0006887316703796387 |0.00525057315826416 |0.00010836124420166016 |0.0036408305168151855 |0.0021789073944091797 |
----------------------------------------------------------pseudo_mini_loss sum 3.569356918334961
Total (block generation + training)time/epoch 0.17039847373962402
Training time/epoch 0.05959272384643555
Training time without block to device /epoch 0.05683779716491699
Training time without total dataloading part /epoch 0.0381779670715332
load block tensor time/epoch 0.014727354049682617
block to device time/epoch 0.0027549266815185547
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  27388
Number of first layer input nodes during this epoch:  9386
