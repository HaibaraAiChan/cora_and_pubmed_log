main start at this time 1648432248.7083075
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001379251480102539
range selection method range initialization spend 0.00012230873107910156
time for parepare:  7.176399230957031e-05
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0021550655364990234
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.004144430160522461
generate_one_block  0.001394033432006836
generate_one_block  0.001251220703125
generate_one_block  0.0011501312255859375
generate_one_block  0.0011730194091796875
generate_one_block  0.0011591911315917969
generate_one_block  0.0011680126190185547
generate_one_block  0.0010805130004882812
generate_one_block  0.0009853839874267578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004932880401611328
gen group dst list time:  7.2479248046875e-05
time for parepare:  0.00016021728515625
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002951622009277344
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.000270843505859375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00034427642822265625
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002200603485107422
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00027489662170410156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00018858909606933594
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.000171661376953125
----------------------check_connections_block total spend ----------------------------- 0.004427433013916016
generate_one_block  0.0014965534210205078
generate_one_block  0.0014424324035644531
generate_one_block  0.0013582706451416016
generate_one_block  0.0015490055084228516
generate_one_block  0.0013570785522460938
generate_one_block  0.0012929439544677734
generate_one_block  0.00115966796875
generate_one_block  0.0011281967163085938
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006825923919677734
gen group dst list time:  0.00011992454528808594
time for parepare:  0.00021529197692871094
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0003566741943359375
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0009534358978271484
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0009331703186035156
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007092952728271484
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.00020813941955566406
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0012586116790771484
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0006947517395019531
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  0.00010204315185546875
r_  generation:  0.0009517669677734375
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0007379055023193359
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0006568431854248047
----------------------check_connections_block total spend ----------------------------- 0.011786937713623047
generate_one_block  0.002089262008666992
generate_one_block  0.0019571781158447266
generate_one_block  0.001680135726928711
generate_one_block  0.0021963119506835938
generate_one_block  0.0016362667083740234
generate_one_block  0.0018877983093261719
generate_one_block  0.0016956329345703125
generate_one_block  0.0016388893127441406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007503032684326172
gen group dst list time:  0.0002315044403076172
time for parepare:  0.0002200603485107422
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.00043320655822753906
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0019707679748535156
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.0021784305572509766
local_output_nid generation:  0.00010609626770019531
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0018839836120605469
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.00024127960205078125
r_  generation:  0.002404451370239258
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.001294851303100586
local_output_nid generation:  8.487701416015625e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0017483234405517578
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0015680789947509766
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0013208389282226562
----------------------check_connections_block total spend ----------------------------- 0.02245187759399414
generate_one_block  0.003015279769897461
generate_one_block  0.002973318099975586
generate_one_block  0.0027289390563964844
generate_one_block  0.0033638477325439453
generate_one_block  0.002460956573486328
generate_one_block  0.0031049251556396484
generate_one_block  0.003573179244995117
generate_one_block  0.002470731735229492
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007455348968505859
gen group dst list time:  0.00048422813415527344
time for parepare:  0.00022292137145996094
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0005140304565429688
mini_batch_src_global generation:  0.00026106834411621094
r_  generation:  0.002907276153564453
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.0003688335418701172
mini_batch_src_global generation:  0.00033020973205566406
r_  generation:  0.0031290054321289062
local_output_nid generation:  0.00017023086547851562
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.00026798248291015625
r_  generation:  0.0027289390563964844
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.0027108192443847656
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.002216815948486328
local_output_nid generation:  0.00012874603271484375
local_in_edges_tensor generation:  0.00029587745666503906
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.00247955322265625
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0002923011779785156
mini_batch_src_global generation:  0.00021719932556152344
r_  generation:  0.0024597644805908203
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0002651214599609375
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.002112150192260742
----------------------check_connections_block total spend ----------------------------- 0.03143787384033203
generate_one_block  0.0035991668701171875
generate_one_block  0.0037555694580078125
generate_one_block  0.00359344482421875
generate_one_block  0.003975391387939453
generate_one_block  0.003984689712524414
generate_one_block  0.003767251968383789
generate_one_block  0.004466056823730469
generate_one_block  0.0033316612243652344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00037670135498046875  GigaBytes
Max Memory Allocated: 0.00037670135498046875  GigaBytes

connection checking time:  0.07010412216186523
block generation total time  0.07973003387451172
average batch blocks generation time:  0.009966254234313965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.012222766876220703  GigaBytes
Max Memory Allocated: 0.012222766876220703  GigaBytes

torch.Size([2175, 1433])
torch.Size([1791, 32])
torch.Size([1097, 32])
torch.Size([493, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.013939857482910156  GigaBytes
Max Memory Allocated: 0.013949871063232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013028144836425781  GigaBytes
Max Memory Allocated: 0.02461385726928711  GigaBytes

torch.Size([2275, 1433])
torch.Size([1898, 32])
torch.Size([1185, 32])
torch.Size([443, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014813899993896484  GigaBytes
Max Memory Allocated: 0.02461385726928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012585639953613281  GigaBytes
Max Memory Allocated: 0.02461385726928711  GigaBytes

torch.Size([2131, 1433])
torch.Size([1740, 32])
torch.Size([1006, 32])
torch.Size([353, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014139175415039062  GigaBytes
Max Memory Allocated: 0.02461385726928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01321268081665039  GigaBytes
Max Memory Allocated: 0.024779319763183594  GigaBytes

torch.Size([2306, 1433])
torch.Size([2070, 32])
torch.Size([1435, 32])
torch.Size([619, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015316963195800781  GigaBytes
Max Memory Allocated: 0.024779319763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012574195861816406  GigaBytes
Max Memory Allocated: 0.024779319763183594  GigaBytes

torch.Size([2182, 1433])
torch.Size([1618, 32])
torch.Size([852, 32])
torch.Size([350, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013989448547363281  GigaBytes
Max Memory Allocated: 0.024779319763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01288461685180664  GigaBytes
Max Memory Allocated: 0.024779319763183594  GigaBytes

torch.Size([2249, 1433])
torch.Size([1850, 32])
torch.Size([1152, 32])
torch.Size([483, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0146484375  GigaBytes
Max Memory Allocated: 0.024779319763183594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012923240661621094  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

torch.Size([2258, 1433])
torch.Size([1824, 32])
torch.Size([1035, 32])
torch.Size([343, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014523506164550781  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012572288513183594  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

torch.Size([2047, 1433])
torch.Size([1529, 32])
torch.Size([826, 32])
torch.Size([307, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.013905525207519531  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007005065679550171 |0.04350018501281738 |0.1023746132850647 |0.00018647313117980957 |0.004089921712875366 |0.006290912628173828 |
----------------------------------------------------------pseudo_mini_loss sum 4.092316150665283
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  44675
Number of first layer input nodes during this epoch:  17623
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.013551712036132812  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0007677078247070312
range selection method range initialization spend 8.606910705566406e-05
time for parepare:  7.915496826171875e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  4.57763671875e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.104873657226562e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.0067901611328125e-05
----------------------check_connections_block total spend ----------------------------- 0.0020422935485839844
generate_one_block  0.001232147216796875
generate_one_block  0.0011925697326660156
generate_one_block  0.0011556148529052734
generate_one_block  0.0011327266693115234
generate_one_block  0.0011305809020996094
generate_one_block  0.00113677978515625
generate_one_block  0.0010085105895996094
generate_one_block  0.0010318756103515625
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004813671112060547
gen group dst list time:  5.53131103515625e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001614093780517578
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003223419189453125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00022983551025390625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00019860267639160156
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002186298370361328
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002307891845703125
----------------------check_connections_block total spend ----------------------------- 0.003902912139892578
generate_one_block  0.0011398792266845703
generate_one_block  0.0013866424560546875
generate_one_block  0.0013713836669921875
generate_one_block  0.0011889934539794922
generate_one_block  0.0011782646179199219
generate_one_block  0.0012221336364746094
generate_one_block  0.0011920928955078125
generate_one_block  0.0012187957763671875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006172657012939453
gen group dst list time:  0.0001163482666015625
time for parepare:  0.00020623207092285156
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.000499725341796875
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.000997304916381836
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.0007715225219726562
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007085800170898438
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0006220340728759766
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0007605552673339844
local_output_nid generation:  3.695487976074219e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007386207580566406
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0007386207580566406
----------------------check_connections_block total spend ----------------------------- 0.010013818740844727
generate_one_block  0.0016155242919921875
generate_one_block  0.0021545886993408203
generate_one_block  0.0018410682678222656
generate_one_block  0.0018086433410644531
generate_one_block  0.0016939640045166016
generate_one_block  0.0018143653869628906
generate_one_block  0.001809835433959961
generate_one_block  0.0019452571868896484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007193088531494141
gen group dst list time:  0.00018405914306640625
time for parepare:  0.00017571449279785156
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0012466907501220703
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0021164417266845703
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.0001838207244873047
r_  generation:  0.001714944839477539
local_output_nid generation:  7.867813110351562e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0016200542449951172
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.0016372203826904297
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002503395080566406
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.001725912094116211
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0016427040100097656
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0018489360809326172
----------------------check_connections_block total spend ----------------------------- 0.021018505096435547
generate_one_block  0.002580881118774414
generate_one_block  0.003184080123901367
generate_one_block  0.0029251575469970703
generate_one_block  0.002809286117553711
generate_one_block  0.002782583236694336
generate_one_block  0.0029358863830566406
generate_one_block  0.0027964115142822266
generate_one_block  0.003019094467163086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007452964782714844
gen group dst list time:  0.0002970695495605469
time for parepare:  0.000179290771484375
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.0004093647003173828
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.002239227294921875
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.0002701282501220703
r_  generation:  0.0027282238006591797
local_output_nid generation:  0.00013065338134765625
local_in_edges_tensor generation:  0.0003008842468261719
mini_batch_src_global generation:  0.00022101402282714844
r_  generation:  0.002644062042236328
local_output_nid generation:  0.0001304149627685547
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.002441883087158203
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00021529197692871094
r_  generation:  0.0025992393493652344
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.002549409866333008
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0024433135986328125
local_output_nid generation:  0.00014400482177734375
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0026111602783203125
----------------------check_connections_block total spend ----------------------------- 0.030382394790649414
generate_one_block  0.0036411285400390625
generate_one_block  0.004119396209716797
generate_one_block  0.0037529468536376953
generate_one_block  0.003845691680908203
generate_one_block  0.003708362579345703
generate_one_block  0.003749370574951172
generate_one_block  0.003618478775024414
generate_one_block  0.003794431686401367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.013551712036132812  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

connection checking time:  0.06531763076782227
block generation total time  0.07784461975097656
average batch blocks generation time:  0.00973057746887207
block dataloader generation time/epoch 0.17858123779296875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012674331665039062  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

torch.Size([2076, 1433])
torch.Size([1561, 32])
torch.Size([804, 32])
torch.Size([296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01400613784790039  GigaBytes
Max Memory Allocated: 0.024810791015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.014111042022705078  GigaBytes
Max Memory Allocated: 0.025045394897460938  GigaBytes

torch.Size([2336, 1433])
torch.Size([2009, 32])
torch.Size([1361, 32])
torch.Size([603, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.016151905059814453  GigaBytes
Max Memory Allocated: 0.025045394897460938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013644218444824219  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

torch.Size([2252, 1433])
torch.Size([1899, 32])
torch.Size([1165, 32])
torch.Size([420, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015402793884277344  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013330459594726562  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

torch.Size([2149, 1433])
torch.Size([1773, 32])
torch.Size([1057, 32])
torch.Size([428, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014965534210205078  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013560295104980469  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

torch.Size([2238, 1433])
torch.Size([1841, 32])
torch.Size([1029, 32])
torch.Size([381, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015184402465820312  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013717174530029297  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

torch.Size([2266, 1433])
torch.Size([1908, 32])
torch.Size([1157, 32])
torch.Size([417, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015467166900634766  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013470172882080078  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

torch.Size([2221, 1433])
torch.Size([1798, 32])
torch.Size([1046, 32])
torch.Size([439, 32])Using backend: pytorch

-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01512002944946289  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013775348663330078  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

torch.Size([2276, 1433])
torch.Size([1960, 32])
torch.Size([1221, 32])
torch.Size([426, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015593528747558594  GigaBytes
Max Memory Allocated: 0.025984764099121094  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003521829843521118 |0.0006815195083618164 |0.005483150482177734 |0.00010949373245239258 |0.005254238843917847 |0.002196073532104492 |
----------------------------------------------------------pseudo_mini_loss sum 3.5096635818481445
Total (block generation + training)time/epoch 0.30941200256347656
Training time/epoch 0.13056516647338867
Training time without block to device /epoch 0.12511301040649414
Training time without total dataloading part /epoch 0.08897113800048828
load block tensor time/epoch 0.028174638748168945
block to device time/epoch 0.005452156066894531
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  45564
Number of first layer input nodes during this epoch:  17814
