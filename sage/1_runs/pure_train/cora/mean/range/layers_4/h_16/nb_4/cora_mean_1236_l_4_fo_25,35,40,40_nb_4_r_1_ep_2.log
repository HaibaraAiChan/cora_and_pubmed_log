main start at this time 1648431195.4485776
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018358230590820312  GigaBytes
Max Memory Allocated: 0.00018358230590820312  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013437271118164062
range selection method range initialization spend 7.963180541992188e-05
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0013976097106933594
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.984306335449219e-05
----------------------check_connections_block total spend ----------------------------- 0.002581357955932617
generate_one_block  0.0014119148254394531
generate_one_block  0.0010976791381835938
generate_one_block  0.0010838508605957031
generate_one_block  0.0011050701141357422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047588348388671875
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.0001289844512939453
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0004334449768066406
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003533363342285156
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003428459167480469
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0004210472106933594
----------------------check_connections_block total spend ----------------------------- 0.0030083656311035156
generate_one_block  0.0014488697052001953
generate_one_block  0.0014226436614990234
generate_one_block  0.0013582706451416016
generate_one_block  0.001493215560913086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005719661712646484
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.0001614093780517578
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00026679039001464844
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0011358261108398438
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0010938644409179688
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.001154184341430664
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.00020742416381835938
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0013654232025146484
----------------------check_connections_block total spend ----------------------------- 0.007657051086425781
generate_one_block  0.002326488494873047
generate_one_block  0.0023069381713867188
generate_one_block  0.0022487640380859375
generate_one_block  0.0024247169494628906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007140636444091797
gen group dst list time:  0.00012373924255371094
time for parepare:  0.0002009868621826172
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.0003638267517089844
mini_batch_src_global generation:  0.0001666545867919922
r_  generation:  0.002094745635986328
local_output_nid generation:  9.441375732421875e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.0020606517791748047
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.000194549560546875
r_  generation:  0.002206563949584961
local_output_nid generation:  0.0001068115234375
local_in_edges_tensor generation:  0.00027298927307128906
mini_batch_src_global generation:  0.0001971721649169922
r_  generation:  0.002298593521118164
----------------------check_connections_block total spend ----------------------------- 0.01322627067565918
generate_one_block  0.003347158432006836
generate_one_block  0.003370523452758789
generate_one_block  0.003324270248413086
generate_one_block  0.003425121307373047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018358230590820312  GigaBytes
Max Memory Allocated: 0.00018358230590820312  GigaBytes

connection checking time:  0.023891687393188477
block generation total time  0.028496980667114258
average batch blocks generation time:  0.0071242451667785645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011995315551757812  GigaBytes
Max Memory Allocated: 0.011995315551757812  GigaBytes

torch.Size([2134, 1433])
torch.Size([1502, 16])
torch.Size([740, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.012641429901123047  GigaBytes
Max Memory Allocated: 0.012648582458496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01216888427734375  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

torch.Size([2087, 1433])
torch.Size([1424, 16])
torch.Size([641, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012763023376464844  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012174606323242188  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

torch.Size([2079, 1433])
torch.Size([1513, 16])
torch.Size([677, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012801170349121094  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012182235717773438  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

torch.Size([2135, 1433])
torch.Size([1606, 16])
torch.Size([784, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012869834899902344  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010217070579528809 |0.08553749322891235 |0.19483572244644165 |0.00018900632858276367 |0.004535079002380371 |0.003923892974853516 |
----------------------------------------------------------pseudo_mini_loss sum 3.282766580581665
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18056
Number of first layer input nodes during this epoch:  8435
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012766361236572266  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004825592041015625
range selection method range initialization spend 6.532669067382812e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.461143493652344e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.344650268554688e-05
----------------------check_connections_block total spend ----------------------------- 0.001220703125
generate_one_block  0.0011768341064453125
generate_one_block  0.0011093616485595703
generate_one_block  0.00109100341796875
generate_one_block  0.0011227130889892578
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005097389221191406
gen group dst list time:  4.0531158447265625e-05
time for parepare:  0.0001697540283203125
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001952648162841797
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004267692565917969
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003540515899658203
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00033473968505859375
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004401206970214844
----------------------check_connections_block total spend ----------------------------- 0.0031120777130126953
generate_one_block  0.001474142074584961
generate_one_block  0.0014786720275878906
generate_one_block  0.0016255378723144531
generate_one_block  0.0015621185302734375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005450248718261719
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.0001709461212158203
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0011146068572998047
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  0.0001609325408935547
r_  generation:  0.0011303424835205078
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00011873245239257812
r_  generation:  0.0010466575622558594
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  0.0001380443572998047
r_  generation:  0.001344919204711914
----------------------check_connections_block total spend ----------------------------- 0.007596492767333984
generate_one_block  0.0022687911987304688
generate_one_block  0.002390146255493164
generate_one_block  0.0021886825561523438
generate_one_block  0.002492189407348633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007431507110595703
gen group dst list time:  0.0001270771026611328
time for parepare:  0.00018024444580078125
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00037670135498046875
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.002065420150756836
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.00026702880859375
mini_batch_src_global generation:  0.0002586841583251953
r_  generation:  0.0020666122436523438
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.002064943313598633
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.0002818107604980469
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.0023093223571777344
----------------------check_connections_block total spend ----------------------------- 0.013274908065795898
generate_one_block  0.0034105777740478516
generate_one_block  0.0033006668090820312
generate_one_block  0.0033245086669921875
generate_one_block  0.003533601760864258
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012766361236572266  GigaBytes
Max Memory Allocated: 0.023803234100341797  GigaBytes

connection checking time:  0.023983478546142578
block generation total time  0.02904963493347168
average batch blocks generation time:  0.00726240873336792
block dataloader generation time/epoch 0.07282853126525879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012529373168945312  GigaBytes
Max Memory Allocated: 0.02416086196899414  GigaBytes

torch.Size([2075, 1433])
torch.Size([1429, 16])
torch.Size([686, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013141632080078125  GigaBytes
Max Memory Allocated: 0.02416086196899414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012532234191894531  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

torch.Size([2033, 1433])
torch.Size([1457, 16])
torch.Size([686, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013144493103027344  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012529373168945312  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

torch.Size([2134, 1433])
torch.Size([1465, 16])
torch.Size([657, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013134002685546875  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012543678283691406  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes

torch.Size([2175, 1433])
torch.Size([1662, 16])
torch.Size([810, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013256549835205078  GigaBytes
Max Memory Allocated: 0.024161815643310547  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033101439476013184 |0.0004965662956237793 |0.0040228962898254395 |0.00010508298873901367 |0.004257380962371826 |0.001699686050415039 |
----------------------------------------------------------pseudo_mini_loss sum 3.1034886837005615
Total (block generation + training)time/epoch 0.12733888626098633
Training time/epoch 0.054196834564208984
Training time without block to device /epoch 0.05221056938171387
Training time without total dataloading part /epoch 0.035241127014160156
load block tensor time/epoch 0.013240575790405273
block to device time/epoch 0.001986265182495117
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17993
Number of first layer input nodes during this epoch:  8417
