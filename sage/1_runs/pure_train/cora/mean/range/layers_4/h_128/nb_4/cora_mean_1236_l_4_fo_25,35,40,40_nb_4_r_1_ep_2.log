main start at this time 1648431308.67785
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.0016245841979980469  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013189315795898438
range selection method range initialization spend 0.00011873245239257812
time for parepare:  8.034706115722656e-05
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0027053356170654297
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  7.343292236328125e-05
----------------------check_connections_block total spend ----------------------------- 0.004170417785644531
generate_one_block  0.0019919872283935547
generate_one_block  0.0014922618865966797
generate_one_block  0.0013551712036132812
generate_one_block  0.0014111995697021484
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006089210510253906
gen group dst list time:  5.14984130859375e-05
time for parepare:  0.00019502639770507812
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0006148815155029297
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0004858970642089844
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003924369812011719
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004756450653076172
----------------------check_connections_block total spend ----------------------------- 0.0038366317749023438
generate_one_block  0.0020112991333007812
generate_one_block  0.001825571060180664
generate_one_block  0.0017285346984863281
generate_one_block  0.0018253326416015625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007059574127197266
gen group dst list time:  9.942054748535156e-05
time for parepare:  0.00024509429931640625
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.0001976490020751953
r_  generation:  0.0018551349639892578
local_output_nid generation:  6.890296936035156e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.001463174819946289
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.00022840499877929688
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0012178421020507812
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0014235973358154297
----------------------check_connections_block total spend ----------------------------- 0.00973200798034668
generate_one_block  0.003397226333618164
generate_one_block  0.002872943878173828
generate_one_block  0.002015829086303711
generate_one_block  0.0022220611572265625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007250308990478516
gen group dst list time:  0.00017213821411132812
time for parepare:  0.00023937225341796875
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.0031890869140625
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0003504753112792969
mini_batch_src_global generation:  0.00034332275390625
r_  generation:  0.002750873565673828
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00023937225341796875
r_  generation:  0.002444028854370117
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.002292633056640625
----------------------check_connections_block total spend ----------------------------- 0.016636371612548828
generate_one_block  0.003755331039428711
generate_one_block  0.0032901763916015625
generate_one_block  0.0030183792114257812
generate_one_block  0.003217935562133789
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0016245841979980469  GigaBytes
Max Memory Allocated: 0.0016245841979980469  GigaBytes

connection checking time:  0.03020501136779785
block generation total time  0.031180620193481445
average batch blocks generation time:  0.007795155048370361
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.013449668884277344  GigaBytes
Max Memory Allocated: 0.013449668884277344  GigaBytes

torch.Size([2169, 1433])
torch.Size([1715, 128])
torch.Size([879, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.018424034118652344  GigaBytes
Max Memory Allocated: 0.01851367950439453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.014295578002929688  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

torch.Size([2053, 1433])
torch.Size([1449, 128])
torch.Size([665, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.018407344818115234  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01380300521850586  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

torch.Size([1963, 1433])
torch.Size([1260, 128])
torch.Size([570, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01731252670288086  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.0143890380859375  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

torch.Size([2071, 1433])
torch.Size([1423, 128])
torch.Size([664, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01841259002685547  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005224645137786865 |0.08841276168823242 |0.19318687915802002 |0.00019431114196777344 |0.004278361797332764 |0.0033135414123535156 |
----------------------------------------------------------pseudo_mini_loss sum 4.113010406494141
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17608
Number of first layer input nodes during this epoch:  8256
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01782846450805664  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005075931549072266
range selection method range initialization spend 7.462501525878906e-05
time for parepare:  6.914138793945312e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.6743621826171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012390613555908203
generate_one_block  0.0011599063873291016
generate_one_block  0.0010762214660644531
generate_one_block  0.0010902881622314453
generate_one_block  0.0011026859283447266
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005221366882324219
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.00017023086547851562
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00039887428283691406
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  6.341934204101562e-05
r_  generation:  0.00037288665771484375
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0005116462707519531
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00041222572326660156
----------------------check_connections_block total spend ----------------------------- 0.0033349990844726562
generate_one_block  0.001485586166381836
generate_one_block  0.0014789104461669922
generate_one_block  0.0018684864044189453
generate_one_block  0.001489400863647461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006005764007568359
gen group dst list time:  8.511543273925781e-05
time for parepare:  0.00021147727966308594
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.0002770423889160156
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0011298656463623047
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0012509822845458984
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0013051033020019531
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.0012378692626953125
----------------------check_connections_block total spend ----------------------------- 0.008115291595458984
generate_one_block  0.002419710159301758
generate_one_block  0.002460479736328125
generate_one_block  0.0026102066040039062
generate_one_block  0.002494335174560547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008826255798339844
gen group dst list time:  0.00013518333435058594
time for parepare:  0.0001938343048095703
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.00042819976806640625
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0022835731506347656
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.0002913475036621094
r_  generation:  0.002283811569213867
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.002346515655517578
local_output_nid generation:  0.00010776519775390625
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0022182464599609375
----------------------check_connections_block total spend ----------------------------- 0.014288902282714844
generate_one_block  0.0037767887115478516
generate_one_block  0.0036613941192626953
generate_one_block  0.0035064220428466797
generate_one_block  0.0033025741577148438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01782846450805664  GigaBytes
Max Memory Allocated: 0.02592611312866211  GigaBytes

connection checking time:  0.025739192962646484
block generation total time  0.03055429458618164
average batch blocks generation time:  0.00763857364654541
block dataloader generation time/epoch 0.07516622543334961
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018294334411621094  GigaBytes
Max Memory Allocated: 0.029262065887451172  GigaBytes

torch.Size([2058, 1433])
torch.Size([1446, 128])
torch.Size([662, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022367000579833984  GigaBytes
Max Memory Allocated: 0.029262065887451172  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017745494842529297  GigaBytes
Max Memory Allocated: 0.029375076293945312  GigaBytes

torch.Size([2092, 1433])
torch.Size([1497, 128])
torch.Size([699, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021930694580078125  GigaBytes
Max Memory Allocated: 0.029375076293945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01830291748046875  GigaBytes
Max Memory Allocated: 0.029375076293945312  GigaBytes

torch.Size([2110, 1433])
torch.Size([1552, 128])
torch.Size([792, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022862911224365234  GigaBytes
Max Memory Allocated: 0.029375076293945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01759052276611328  GigaBytes
Max Memory Allocated: 0.029375076293945312  GigaBytes

torch.Size([2063, 1433])
torch.Size([1457, 128])
torch.Size([691, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.021707534790039062  GigaBytes
Max Memory Allocated: 0.029375076293945312  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002352774143218994 |0.0005552768707275391 |0.0042612552642822266 |0.00011605024337768555 |0.003306269645690918 |0.0018489360809326172 |
----------------------------------------------------------pseudo_mini_loss sum 2.7340848445892334
Total (block generation + training)time/epoch 0.12384414672851562
Training time/epoch 0.048343658447265625
Training time without block to device /epoch 0.04612255096435547
Training time without total dataloading part /epoch 0.03258323669433594
load block tensor time/epoch 0.009411096572875977
block to device time/epoch 0.0022211074829101562
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17851
Number of first layer input nodes during this epoch:  8323
