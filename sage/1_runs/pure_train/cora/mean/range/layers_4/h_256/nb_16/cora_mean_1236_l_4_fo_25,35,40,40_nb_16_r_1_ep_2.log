main start at this time 1648431365.7880957
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0015785694122314453
range selection method range initialization spend 0.00011372566223144531
time for parepare:  6.151199340820312e-05
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.004025697708129883
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.34600830078125e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9073486328125e-05
----------------------check_connections_block total spend ----------------------------- 0.007132530212402344
generate_one_block  0.0013747215270996094
generate_one_block  0.0011775493621826172
generate_one_block  0.0010793209075927734
generate_one_block  0.0010750293731689453
generate_one_block  0.00112152099609375
generate_one_block  0.001088857650756836
generate_one_block  0.0010714530944824219
generate_one_block  0.0011081695556640625
generate_one_block  0.0010738372802734375
generate_one_block  0.0010988712310791016
generate_one_block  0.001104593276977539
generate_one_block  0.0010769367218017578
generate_one_block  0.0010111331939697266
generate_one_block  0.0010161399841308594
generate_one_block  0.0010814666748046875
generate_one_block  0.0010170936584472656
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005953311920166016
gen group dst list time:  8.940696716308594e-05
time for parepare:  0.00014281272888183594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001876354217529297
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017642974853515625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00012421607971191406
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010395050048828125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001251697540283203
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  7.367134094238281e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001575946807861328
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010561943054199219
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00019860267639160156
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.005643606185913086
generate_one_block  0.0012924671173095703
generate_one_block  0.0012333393096923828
generate_one_block  0.0012369155883789062
generate_one_block  0.0011820793151855469
generate_one_block  0.0012121200561523438
generate_one_block  0.0012469291687011719
generate_one_block  0.001214742660522461
generate_one_block  0.001251220703125
generate_one_block  0.0011358261108398438
generate_one_block  0.0010976791381835938
generate_one_block  0.0011241436004638672
generate_one_block  0.0012640953063964844
generate_one_block  0.0011777877807617188
generate_one_block  0.0011870861053466797
generate_one_block  0.0011889934539794922
generate_one_block  0.0011165142059326172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007069110870361328
gen group dst list time:  0.00014519691467285156
time for parepare:  0.0002186298370361328
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.0005354881286621094
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0005087852478027344
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00041961669921875
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00037097930908203125
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0004825592041015625
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005283355712890625
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004150867462158203
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.000438690185546875
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00026297569274902344
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00022983551025390625
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.000385284423828125
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0007388591766357422
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0004699230194091797
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00048470497131347656
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0003726482391357422
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00027632713317871094
----------------------check_connections_block total spend ----------------------------- 0.012769937515258789
generate_one_block  0.0017404556274414062
generate_one_block  0.0016551017761230469
generate_one_block  0.00157928466796875
generate_one_block  0.0014576911926269531
generate_one_block  0.0015339851379394531
generate_one_block  0.0019335746765136719
generate_one_block  0.0014522075653076172
generate_one_block  0.0015795230865478516
generate_one_block  0.0012810230255126953
generate_one_block  0.0012462139129638672
generate_one_block  0.0014531612396240234
generate_one_block  0.0018329620361328125
generate_one_block  0.0015096664428710938
generate_one_block  0.0015184879302978516
generate_one_block  0.0014715194702148438
generate_one_block  0.0012996196746826172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007631778717041016
gen group dst list time:  0.0002582073211669922
time for parepare:  0.00019121170043945312
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0014197826385498047
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0012788772583007812
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.001177072525024414
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0010976791381835938
local_output_nid generation:  5.841255187988281e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0012373924255371094
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0013360977172851562
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.0009582042694091797
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0011382102966308594
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0007393360137939453
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0007035732269287109
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0011365413665771484
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0016856193542480469
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0011644363403320312
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0009958744049072266
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0008230209350585938
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.000762939453125
----------------------check_connections_block total spend ----------------------------- 0.028344154357910156
generate_one_block  0.002625703811645508
generate_one_block  0.0024847984313964844
generate_one_block  0.0021936893463134766
generate_one_block  0.0021712779998779297
generate_one_block  0.002250194549560547
generate_one_block  0.0024352073669433594
generate_one_block  0.001968860626220703
generate_one_block  0.0021877288818359375
generate_one_block  0.0018131732940673828
generate_one_block  0.0018055438995361328
generate_one_block  0.002518892288208008
generate_one_block  0.0029134750366210938
generate_one_block  0.0024042129516601562
generate_one_block  0.0021588802337646484
generate_one_block  0.001959562301635742
generate_one_block  0.0018687248229980469
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

connection checking time:  0.04675769805908203
block generation total time  0.07946634292602539
average batch blocks generation time:  0.004966646432876587
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012265682220458984  GigaBytes
Max Memory Allocated: 0.012265682220458984  GigaBytes

torch.Size([1588, 1433])
torch.Size([877, 256])
torch.Size([262, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0164642333984375  GigaBytes
Max Memory Allocated: 0.01654338836669922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015324592590332031  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1463, 1433])
torch.Size([764, 256])
torch.Size([267, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019050121307373047  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014969348907470703  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1398, 1433])
torch.Size([694, 256])
torch.Size([246, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018358707427978516  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015207290649414062  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1443, 1433])
torch.Size([629, 256])
torch.Size([186, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01814126968383789  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014978408813476562  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1399, 1433])
torch.Size([751, 256])
torch.Size([273, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018687725067138672  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015767574310302734  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1546, 1433])
torch.Size([820, 256])
torch.Size([266, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019614696502685547  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013924121856689453  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1203, 1433])
torch.Size([553, 256])
torch.Size([211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01672649383544922  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01506185531616211  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1415, 1433])
torch.Size([690, 256])
torch.Size([245, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018441200256347656  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.013113975524902344  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1053, 1433])
torch.Size([437, 256])
torch.Size([144, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015250205993652344  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.012642383575439453  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([965, 1433])
torch.Size([407, 256])
torch.Size([100, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014500141143798828  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015984535217285156  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

torch.Size([1437, 1433])
torch.Size([685, 256])
torch.Size([212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019173145294189453  GigaBytes
Max Memory Allocated: 0.02375507354736328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01746988296508789  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

torch.Size([1862, 1433])
torch.Size([1086, 256])
torch.Size([372, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.024182796478271484  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015987396240234375  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

torch.Size([1480, 1433])
torch.Size([733, 256])
torch.Size([246, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.019469261169433594  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013951301574707031  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

torch.Size([1207, 1433])
torch.Size([600, 256])
torch.Size([258, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.017104148864746094  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013238906860351562  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

torch.Size([1075, 1433])
torch.Size([496, 256])
torch.Size([188, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015768051147460938  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013218402862548828  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

torch.Size([1072, 1433])
torch.Size([454, 256])
torch.Size([140, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015345096588134766  GigaBytes
Max Memory Allocated: 0.02588510513305664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0042877644300460815 |0.022045105695724487 |0.05275343358516693 |0.00015406310558319092 |0.003856465220451355 |0.0029692649841308594 |
----------------------------------------------------------pseudo_mini_loss sum 3.4962894916534424
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  36659
Number of first layer input nodes during this epoch:  21606
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02089214324951172  GigaBytes
Max Memory Allocated: 0.026359081268310547  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005648136138916016
range selection method range initialization spend 8.20159912109375e-05
time for parepare:  8.296966552734375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.003238677978515625
generate_one_block  0.0011034011840820312
generate_one_block  0.001071929931640625
generate_one_block  0.0010457038879394531
generate_one_block  0.0010457038879394531
generate_one_block  0.0010654926300048828
generate_one_block  0.0010480880737304688
generate_one_block  0.0010728836059570312
generate_one_block  0.0010495185852050781
generate_one_block  0.0010492801666259766
generate_one_block  0.001079559326171875
generate_one_block  0.0010612010955810547
generate_one_block  0.0010724067687988281
generate_one_block  0.00095367431640625
generate_one_block  0.0009572505950927734
generate_one_block  0.0009553432464599609
generate_one_block  0.000957489013671875
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005671977996826172
gen group dst list time:  9.34600830078125e-05
time for parepare:  0.0001728534698486328
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  9.393692016601562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001308917999267578
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001327991485595703
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0002300739288330078
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001430511474609375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001735687255859375
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00011944770812988281
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.985664367675781e-05
----------------------check_connections_block total spend ----------------------------- 0.005770683288574219
generate_one_block  0.0011599063873291016
generate_one_block  0.0011930465698242188
generate_one_block  0.0011856555938720703
generate_one_block  0.0012049674987792969
generate_one_block  0.0011882781982421875
generate_one_block  0.00118255615234375
generate_one_block  0.0013964176177978516
generate_one_block  0.001201629638671875
generate_one_block  0.0011818408966064453
generate_one_block  0.0011954307556152344
generate_one_block  0.0011320114135742188
generate_one_block  0.001068115234375
generate_one_block  0.0010335445404052734
generate_one_block  0.0010962486267089844
generate_one_block  0.001068115234375
generate_one_block  0.0010123252868652344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006558895111083984
gen group dst list time:  0.00018906593322753906
time for parepare:  0.000232696533203125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003113746643066406
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  7.915496826171875e-05
r_  generation:  0.0005040168762207031
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.00048732757568359375
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0005016326904296875
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004925727844238281
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.00039768218994140625
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007872581481933594
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0004990100860595703
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.00048542022705078125
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0005829334259033203
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0005772113800048828
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00036144256591796875
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0005090236663818359
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004107952117919922
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0002732276916503906
----------------------check_connections_block total spend ----------------------------- 0.013702392578125
generate_one_block  0.0014200210571289062
generate_one_block  0.001642465591430664
generate_one_block  0.0016849040985107422
generate_one_block  0.0014519691467285156
generate_one_block  0.0013921260833740234
generate_one_block  0.0013880729675292969
generate_one_block  0.0018067359924316406
generate_one_block  0.0014662742614746094
generate_one_block  0.0014481544494628906
generate_one_block  0.001596689224243164
generate_one_block  0.0015461444854736328
generate_one_block  0.0013260841369628906
generate_one_block  0.0012466907501220703
generate_one_block  0.0014948844909667969
generate_one_block  0.0013854503631591797
generate_one_block  0.0012505054473876953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007023811340332031
gen group dst list time:  0.0003600120544433594
time for parepare:  0.0002033710479736328
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002551078796386719
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0007479190826416016
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0013010501861572266
local_output_nid generation:  6.842613220214844e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.00015306472778320312
r_  generation:  0.0014142990112304688
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00012612342834472656
r_  generation:  0.001226663589477539
local_output_nid generation:  5.459785461425781e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00011849403381347656
r_  generation:  0.0011267662048339844
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0010213851928710938
local_output_nid generation:  8.296966552734375e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00015473365783691406
r_  generation:  0.001750946044921875
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.00013756752014160156
r_  generation:  0.0013034343719482422
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001227855682373047
r_  generation:  0.0011284351348876953
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0015728473663330078
local_output_nid generation:  7.176399230957031e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0013284683227539062
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0009586811065673828
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00017547607421875
mini_batch_src_global generation:  9.72747802734375e-05
r_  generation:  0.0007979869842529297
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0010232925415039062
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.001013040542602539
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006263256072998047
----------------------check_connections_block total spend ----------------------------- 0.029465198516845703
generate_one_block  0.0019407272338867188
generate_one_block  0.002348661422729492
generate_one_block  0.0026388168334960938
generate_one_block  0.0022411346435546875
generate_one_block  0.002086639404296875
generate_one_block  0.0020401477813720703
generate_one_block  0.0027840137481689453
generate_one_block  0.0022966861724853516
generate_one_block  0.0021390914916992188
generate_one_block  0.002591371536254883
generate_one_block  0.0023488998413085938
generate_one_block  0.0027806758880615234
generate_one_block  0.0018856525421142578
generate_one_block  0.002158641815185547
generate_one_block  0.002162456512451172
generate_one_block  0.0016846656799316406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02089214324951172  GigaBytes
Max Memory Allocated: 0.026359081268310547  GigaBytes

connection checking time:  0.04893827438354492
block generation total time  0.07817554473876953
average batch blocks generation time:  0.004885971546173096
block dataloader generation time/epoch 0.16795110702514648
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.019902706146240234  GigaBytes
Max Memory Allocated: 0.026359081268310547  GigaBytes

torch.Size([900, 1433])
torch.Size([400, 256])
torch.Size([137, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.021884441375732422  GigaBytes
Max Memory Allocated: 0.026359081268310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.022910594940185547  GigaBytes
Max Memory Allocated: 0.02767181396484375  GigaBytes

torch.Size([1460, 1433])
torch.Size([726, 256])
torch.Size([253, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.026391983032226562  GigaBytes
Max Memory Allocated: 0.02767181396484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.023682117462158203  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

torch.Size([1604, 1433])
torch.Size([844, 256])
torch.Size([233, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027492523193359375  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02290964126586914  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

torch.Size([1383, 1433])
torch.Size([689, 256])
torch.Size([212, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.026178359985351562  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02222156524658203  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

torch.Size([1222, 1433])
torch.Size([631, 256])
torch.Size([193, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.025276660919189453  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.021651744842529297  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

torch.Size([1226, 1433])
torch.Size([608, 256])
torch.Size([211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.024631500244140625  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.024729251861572266  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

torch.Size([1797, 1433])
torch.Size([1070, 256])
torch.Size([403, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03042745590209961  GigaBytes
Max Memory Allocated: 0.03143024444580078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.022647857666015625  GigaBytes
Max Memory Allocated: 0.032198429107666016  GigaBytes

torch.Size([1411, 1433])
torch.Size([738, 256])
torch.Size([235, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.026157379150390625  GigaBytes
Max Memory Allocated: 0.032198429107666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.022223472595214844  GigaBytes
Max Memory Allocated: 0.032198429107666016  GigaBytes

torch.Size([1267, 1433])
torch.Size([640, 256])
torch.Size([246, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.025409698486328125  GigaBytes
Max Memory Allocated: 0.032198429107666016  GigaBytes
Using backend: pytorch

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.024498939514160156  GigaBytes
Max Memory Allocated: 0.032198429107666016  GigaBytes

torch.Size([1756, 1433])
torch.Size([927, 256])
torch.Size([325, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.028987884521484375  GigaBytes
Max Memory Allocated: 0.032198429107666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.022951602935791016  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

torch.Size([1467, 1433])
torch.Size([805, 256])
torch.Size([285, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02696371078491211  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.022217750549316406  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

torch.Size([1254, 1433])
torch.Size([561, 256])
torch.Size([175, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02490997314453125  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.021378040313720703  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

torch.Size([1176, 1433])
torch.Size([510, 256])
torch.Size([137, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.023693561553955078  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02222442626953125  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

torch.Size([1227, 1433])
torch.Size([662, 256])
torch.Size([252, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.025528907775878906  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.023048877716064453  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

torch.Size([1487, 1433])
torch.Size([644, 256])
torch.Size([206, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.026083946228027344  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02014636993408203  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

torch.Size([946, 1433])
torch.Size([352, 256])
torch.Size([118, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.02183675765991211  GigaBytes
Max Memory Allocated: 0.03227853775024414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012164115905761719 |0.0006453394889831543 |0.005023747682571411 |0.00012826919555664062 |0.0030309855937957764 |0.0022673606872558594 |
----------------------------------------------------------pseudo_mini_loss sum 2.596571445465088
Total (block generation + training)time/epoch 0.3495330810546875
Training time/epoch 0.18138432502746582
Training time without block to device /epoch 0.17105889320373535
Training time without total dataloading part /epoch 0.1331954002380371
load block tensor time/epoch 0.01946258544921875
block to device time/epoch 0.010325431823730469
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  36780
Number of first layer input nodes during this epoch:  21583
