main start at this time 1648431346.6697237
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0007479190826416016
range selection method range initialization spend 7.414817810058594e-05
time for parepare:  6.937980651855469e-05
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0023005008697509766
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0035102367401123047
generate_one_block  0.0013267993927001953
generate_one_block  0.0010747909545898438
generate_one_block  0.0010268688201904297
generate_one_block  0.0011188983917236328
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004971027374267578
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.0001571178436279297
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00043129920959472656
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00038909912109375
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00029778480529785156
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004143714904785156
----------------------check_connections_block total spend ----------------------------- 0.0030465126037597656
generate_one_block  0.0015463829040527344
generate_one_block  0.0014243125915527344
generate_one_block  0.001338958740234375
generate_one_block  0.0014719963073730469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005533695220947266
gen group dst list time:  8.058547973632812e-05
time for parepare:  0.00016951560974121094
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0002665519714355469
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0013494491577148438
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.0001468658447265625
r_  generation:  0.0012395381927490234
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  0.00011038780212402344
r_  generation:  0.0009775161743164062
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0012028217315673828
----------------------check_connections_block total spend ----------------------------- 0.007681608200073242
generate_one_block  0.0025606155395507812
generate_one_block  0.0024862289428710938
generate_one_block  0.002088785171508789
generate_one_block  0.0023550987243652344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007607936859130859
gen group dst list time:  0.00013256072998046875
time for parepare:  0.00017571449279785156
local_output_nid generation:  0.000102996826171875
local_in_edges_tensor generation:  0.00037288665771484375
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0023534297943115234
local_output_nid generation:  0.00010967254638671875
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0023403167724609375
local_output_nid generation:  9.512901306152344e-05
local_in_edges_tensor generation:  0.0002570152282714844
mini_batch_src_global generation:  0.00022363662719726562
r_  generation:  0.001971721649169922
local_output_nid generation:  0.00010991096496582031
local_in_edges_tensor generation:  0.00028133392333984375
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.0021178722381591797
----------------------check_connections_block total spend ----------------------------- 0.013631343841552734
generate_one_block  0.0035855770111083984
generate_one_block  0.003464221954345703
generate_one_block  0.003173351287841797
generate_one_block  0.0033376216888427734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0037360191345214844  GigaBytes
Max Memory Allocated: 0.0037360191345214844  GigaBytes

connection checking time:  0.024359464645385742
block generation total time  0.02883315086364746
average batch blocks generation time:  0.007208287715911865
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.015374183654785156  GigaBytes
Max Memory Allocated: 0.015374183654785156  GigaBytes

torch.Size([2161, 1433])
torch.Size([1655, 256])
torch.Size([808, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02533578872680664  GigaBytes
Max Memory Allocated: 0.025542736053466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019436359405517578  GigaBytes
Max Memory Allocated: 0.030875205993652344  GigaBytes

torch.Size([2184, 1433])
torch.Size([1637, 256])
torch.Size([776, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029242992401123047  GigaBytes
Max Memory Allocated: 0.030875205993652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.019295692443847656  GigaBytes
Max Memory Allocated: 0.030875205993652344  GigaBytes

torch.Size([2055, 1433])
torch.Size([1368, 256])
torch.Size([570, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02659130096435547  GigaBytes
Max Memory Allocated: 0.030875205993652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.018825054168701172  GigaBytes
Max Memory Allocated: 0.030875205993652344  GigaBytes

torch.Size([2070, 1433])
torch.Size([1521, 256])
torch.Size([752, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02834177017211914  GigaBytes
Max Memory Allocated: 0.030875205993652344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0043822526931762695 |0.08701902627944946 |0.19977009296417236 |0.00017791986465454102 |0.004492521286010742 |0.002619028091430664 |
----------------------------------------------------------pseudo_mini_loss sum 3.7704992294311523
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18300
Number of first layer input nodes during this epoch:  8470
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0274505615234375  GigaBytes
Max Memory Allocated: 0.03319835662841797  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005164146423339844
range selection method range initialization spend 6.771087646484375e-05
time for parepare:  6.532669067382812e-05
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.602836608886719e-05
----------------------check_connections_block total spend ----------------------------- 0.0012133121490478516
generate_one_block  0.001134634017944336
generate_one_block  0.0011637210845947266
generate_one_block  0.0011053085327148438
generate_one_block  0.001070261001586914
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004906654357910156
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.00016260147094726562
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00036597251892089844
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.0005130767822265625
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0004563331604003906
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003457069396972656
----------------------check_connections_block total spend ----------------------------- 0.0033075809478759766
generate_one_block  0.0014925003051757812
generate_one_block  0.0016336441040039062
generate_one_block  0.0018620491027832031
generate_one_block  0.0014464855194091797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005757808685302734
gen group dst list time:  8.392333984375e-05
time for parepare:  0.00018405914306640625
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0011496543884277344
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00021576881408691406
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.0014297962188720703
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0014090538024902344
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0011777877807617188
----------------------check_connections_block total spend ----------------------------- 0.008408546447753906
generate_one_block  0.002413511276245117
generate_one_block  0.0027680397033691406
generate_one_block  0.0026187896728515625
generate_one_block  0.0023374557495117188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007615089416503906
gen group dst list time:  0.00014710426330566406
time for parepare:  0.00019097328186035156
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.00023698806762695312
r_  generation:  0.002287626266479492
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.0002906322479248047
r_  generation:  0.002535104751586914
local_output_nid generation:  0.00012826919555664062
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00021648406982421875
r_  generation:  0.002489328384399414
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00028443336486816406
mini_batch_src_global generation:  0.00020456314086914062
r_  generation:  0.0022478103637695312
----------------------check_connections_block total spend ----------------------------- 0.014848709106445312
generate_one_block  0.0038537979125976562
generate_one_block  0.003496408462524414
generate_one_block  0.0034530162811279297
generate_one_block  0.003237009048461914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0274505615234375  GigaBytes
Max Memory Allocated: 0.03319835662841797  GigaBytes

connection checking time:  0.026564836502075195
block generation total time  0.030612707138061523
average batch blocks generation time:  0.007653176784515381
block dataloader generation time/epoch 0.07534146308898926
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027708053588867188  GigaBytes
Max Memory Allocated: 0.03867340087890625  GigaBytes

torch.Size([2076, 1433])
torch.Size([1444, 256])
torch.Size([596, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03534746170043945  GigaBytes
Max Memory Allocated: 0.03867340087890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.0279083251953125  GigaBytes
Max Memory Allocated: 0.039342403411865234  GigaBytes

torch.Size([2182, 1433])
torch.Size([1655, 256])
torch.Size([823, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.03748273849487305  GigaBytes
Max Memory Allocated: 0.039342403411865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02790355682373047  GigaBytes
Max Memory Allocated: 0.03952455520629883  GigaBytes

torch.Size([2173, 1433])
torch.Size([1619, 256])
torch.Size([808, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03712606430053711  GigaBytes
Max Memory Allocated: 0.03952455520629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.027222156524658203  GigaBytes
Max Memory Allocated: 0.03952455520629883  GigaBytes

torch.Size([2054, 1433])
torch.Size([1423, 256])
torch.Size([647, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03494691848754883  GigaBytes
Max Memory Allocated: 0.03952455520629883  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003217041492462158 |0.000578761100769043 |0.004509329795837402 |0.00012362003326416016 |0.0031145215034484863 |0.0018689632415771484 |
----------------------------------------------------------pseudo_mini_loss sum 1.9741876125335693
Total (block generation + training)time/epoch 0.12797784805297852
Training time/epoch 0.05234098434448242
Training time without block to device /epoch 0.05002593994140625
Training time without total dataloading part /epoch 0.032858848571777344
load block tensor time/epoch 0.012868165969848633
block to device time/epoch 0.002315044403076172
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  18239
Number of first layer input nodes during this epoch:  8485
