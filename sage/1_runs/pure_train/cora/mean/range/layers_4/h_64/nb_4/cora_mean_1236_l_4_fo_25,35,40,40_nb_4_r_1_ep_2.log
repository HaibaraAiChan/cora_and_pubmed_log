main start at this time 1648431270.6692386
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007557868957519531  GigaBytes
Max Memory Allocated: 0.0007557868957519531  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.001659393310546875
range selection method range initialization spend 0.00010967254638671875
time for parepare:  6.198883056640625e-05
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00018358230590820312
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.004004955291748047
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00010347366333007812
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.128715515136719e-05
----------------------check_connections_block total spend ----------------------------- 0.005205869674682617
generate_one_block  0.0014433860778808594
generate_one_block  0.0010960102081298828
generate_one_block  0.0010747909545898438
generate_one_block  0.0012271404266357422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004837512969970703
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00012922286987304688
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0003018379211425781
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00041556358337402344
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00036525726318359375
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00048065185546875
----------------------check_connections_block total spend ----------------------------- 0.0030274391174316406
generate_one_block  0.0014007091522216797
generate_one_block  0.0015156269073486328
generate_one_block  0.001495361328125
generate_one_block  0.001500844955444336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005466938018798828
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.00019502639770507812
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0009682178497314453
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0012753009796142578
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0011425018310546875
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0013325214385986328
----------------------check_connections_block total spend ----------------------------- 0.007689476013183594
generate_one_block  0.0021698474884033203
generate_one_block  0.002580881118774414
generate_one_block  0.0022666454315185547
generate_one_block  0.0025408267974853516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007376670837402344
gen group dst list time:  0.0001327991485595703
time for parepare:  0.00017905235290527344
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0003478527069091797
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.002020597457885742
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0023555755615234375
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0020945072174072266
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.002341747283935547
----------------------check_connections_block total spend ----------------------------- 0.013532876968383789
generate_one_block  0.0031921863555908203
generate_one_block  0.0040662288665771484
generate_one_block  0.0032532215118408203
generate_one_block  0.0035130977630615234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007557868957519531  GigaBytes
Max Memory Allocated: 0.0007557868957519531  GigaBytes

connection checking time:  0.024249792098999023
block generation total time  0.0294954776763916
average batch blocks generation time:  0.0073738694190979
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011491775512695312  GigaBytes
Max Memory Allocated: 0.011491775512695312  GigaBytes

torch.Size([1996, 1433])
torch.Size([1331, 64])
torch.Size([585, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.013375282287597656  GigaBytes
Max Memory Allocated: 0.013407707214355469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013329505920410156  GigaBytes
Max Memory Allocated: 0.023884296417236328  GigaBytes

torch.Size([2165, 1433])
torch.Size([1647, 64])
torch.Size([817, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015761375427246094  GigaBytes
Max Memory Allocated: 0.023884296417236328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013317108154296875  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

torch.Size([2026, 1433])
torch.Size([1443, 64])
torch.Size([686, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015416622161865234  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013333320617675781  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

torch.Size([2175, 1433])
torch.Size([1694, 64])
torch.Size([835, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015851974487304688  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007098853588104248 |0.08786869049072266 |0.19781315326690674 |0.0002065896987915039 |0.003850877285003662 |0.002619028091430664 |
----------------------------------------------------------pseudo_mini_loss sum 3.172752857208252
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  18141
Number of first layer input nodes during this epoch:  8362
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015076160430908203  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004649162292480469
range selection method range initialization spend 8.034706115722656e-05
time for parepare:  6.842613220214844e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  5.817413330078125e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.747245788574219e-05
----------------------check_connections_block total spend ----------------------------- 0.001230478286743164
generate_one_block  0.0011229515075683594
generate_one_block  0.001074075698852539
generate_one_block  0.0010864734649658203
generate_one_block  0.0010845661163330078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004863739013671875
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.00015234947204589844
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00033211708068847656
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00047278404235839844
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00035643577575683594
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00046706199645996094
----------------------check_connections_block total spend ----------------------------- 0.003181934356689453
generate_one_block  0.0014030933380126953
generate_one_block  0.001523733139038086
generate_one_block  0.0016589164733886719
generate_one_block  0.0015642642974853516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005788803100585938
gen group dst list time:  7.796287536621094e-05
time for parepare:  0.00018739700317382812
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002589225769042969
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.0010118484497070312
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00017070770263671875
r_  generation:  0.0011889934539794922
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0011088848114013672
local_output_nid generation:  6.29425048828125e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0013060569763183594
----------------------check_connections_block total spend ----------------------------- 0.007685184478759766
generate_one_block  0.0022597312927246094
generate_one_block  0.0025005340576171875
generate_one_block  0.0022826194763183594
generate_one_block  0.0023660659790039062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007398128509521484
gen group dst list time:  0.00013780593872070312
time for parepare:  0.00018310546875
local_output_nid generation:  9.5367431640625e-05
local_in_edges_tensor generation:  0.0003533363342285156
mini_batch_src_global generation:  0.00021004676818847656
r_  generation:  0.0020492076873779297
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.0002856254577636719
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.002297639846801758
local_output_nid generation:  0.00010418891906738281
local_in_edges_tensor generation:  0.00027441978454589844
mini_batch_src_global generation:  0.0002384185791015625
r_  generation:  0.0021305084228515625
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0002789497375488281
mini_batch_src_global generation:  0.00019669532775878906
r_  generation:  0.002231597900390625
----------------------check_connections_block total spend ----------------------------- 0.013601303100585938
generate_one_block  0.0034859180450439453
generate_one_block  0.003356456756591797
generate_one_block  0.0032520294189453125
generate_one_block  0.0033316612243652344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015076160430908203  GigaBytes
Max Memory Allocated: 0.024947643280029297  GigaBytes

connection checking time:  0.024468421936035156
block generation total time  0.028985023498535156
average batch blocks generation time:  0.007246255874633789
block dataloader generation time/epoch 0.07171010971069336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014813423156738281  GigaBytes
Max Memory Allocated: 0.02644968032836914  GigaBytes

torch.Size([2045, 1433])
torch.Size([1392, 64])
torch.Size([594, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016757488250732422  GigaBytes
Max Memory Allocated: 0.02644968032836914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014822959899902344  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

torch.Size([2142, 1433])
torch.Size([1528, 64])
torch.Size([701, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01704263687133789  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014818191528320312  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

torch.Size([2020, 1433])
torch.Size([1425, 64])
torch.Size([631, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01683187484741211  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014826774597167969  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes

torch.Size([2095, 1433])
torch.Size([1533, 64])
torch.Size([792, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.017145156860351562  GigaBytes
Max Memory Allocated: 0.026450634002685547  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0032778382301330566 |0.0005252361297607422 |0.0041525959968566895 |0.00011223554611206055 |0.0041332244873046875 |0.0018935203552246094 |
----------------------------------------------------------pseudo_mini_loss sum 2.9002621173858643
Total (block generation + training)time/epoch 0.12671804428100586
Training time/epoch 0.0546717643737793
Training time without block to device /epoch 0.05257081985473633
Training time without total dataloading part /epoch 0.03548574447631836
load block tensor time/epoch 0.013111352920532227
block to device time/epoch 0.0021009445190429688
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  17617
Number of first layer input nodes during this epoch:  8302
