main start at this time 1648433428.7427094
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013458728790283203
range selection method range initialization spend 0.0001277923583984375
time for parepare:  9.512901306152344e-05
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0018069744110107422
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.818771362304688e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.82012939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0033130645751953125
generate_one_block  0.0019292831420898438
generate_one_block  0.0019466876983642578
generate_one_block  0.0012013912200927734
generate_one_block  0.0011758804321289062
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005955696105957031
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.0001690387725830078
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0004324913024902344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.00042939186096191406
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003921985626220703
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00037097930908203125
----------------------check_connections_block total spend ----------------------------- 0.0031936168670654297
generate_one_block  0.0015544891357421875
generate_one_block  0.0016095638275146484
generate_one_block  0.0014553070068359375
generate_one_block  0.0015287399291992188
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006203651428222656
gen group dst list time:  7.152557373046875e-05
time for parepare:  0.0001647472381591797
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0011539459228515625
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.0012989044189453125
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0011610984802246094
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0010952949523925781
----------------------check_connections_block total spend ----------------------------- 0.0075702667236328125
generate_one_block  0.0024538040161132812
generate_one_block  0.0025458335876464844
generate_one_block  0.0023956298828125
generate_one_block  0.002304553985595703
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007836818695068359
gen group dst list time:  0.00013113021850585938
time for parepare:  0.00018787384033203125
local_output_nid generation:  0.00010156631469726562
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.00017976760864257812
r_  generation:  0.002186298370361328
local_output_nid generation:  0.00012612342834472656
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.00027060508728027344
r_  generation:  0.0021851062774658203
local_output_nid generation:  0.00010752677917480469
local_in_edges_tensor generation:  0.00027179718017578125
mini_batch_src_global generation:  0.0001990795135498047
r_  generation:  0.0022640228271484375
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.002106189727783203
----------------------check_connections_block total spend ----------------------------- 0.013689756393432617
generate_one_block  0.0036504268646240234
generate_one_block  0.0035130977630615234
generate_one_block  0.0036034584045410156
generate_one_block  0.0032341480255126953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007669925689697266
gen group dst list time:  0.0001761913299560547
time for parepare:  0.0001888275146484375
local_output_nid generation:  0.00013518333435058594
local_in_edges_tensor generation:  0.00045490264892578125
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.0028138160705566406
local_output_nid generation:  0.00014162063598632812
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.0002894401550292969
r_  generation:  0.002859830856323242
local_output_nid generation:  0.00014638900756835938
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0029494762420654297
local_output_nid generation:  0.00013709068298339844
local_in_edges_tensor generation:  0.0003132820129394531
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.00274658203125
----------------------check_connections_block total spend ----------------------------- 0.017149686813354492
generate_one_block  0.004101991653442383
generate_one_block  0.00396728515625
generate_one_block  0.004353523254394531
generate_one_block  0.003875732421875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007734298706054688
gen group dst list time:  0.00021028518676757812
time for parepare:  0.0001761913299560547
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.0005049705505371094
mini_batch_src_global generation:  0.00020742416381835938
r_  generation:  0.0030460357666015625
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.00034928321838378906
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.0030503273010253906
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.003123044967651367
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.00033855438232421875
mini_batch_src_global generation:  0.0002448558807373047
r_  generation:  0.0030395984649658203
----------------------check_connections_block total spend ----------------------------- 0.018433809280395508
generate_one_block  0.004240274429321289
generate_one_block  0.0042765140533447266
generate_one_block  0.004335165023803711
generate_one_block  0.004186391830444336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

connection checking time:  0.06003713607788086
block generation total time  0.0631859302520752
average batch blocks generation time:  0.0157964825630188
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015781402587890625  GigaBytes
Max Memory Allocated: 0.015781402587890625  GigaBytes

torch.Size([2469, 1433])
torch.Size([2398, 128])
torch.Size([2150, 128])
torch.Size([1536, 128])
torch.Size([728, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.029185771942138672  GigaBytes
Max Memory Allocated: 0.029277801513671875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.017099857330322266  GigaBytes
Max Memory Allocated: 0.030536651611328125  GigaBytes

torch.Size([2458, 1433])
torch.Size([2355, 128])
torch.Size([2119, 128])
torch.Size([1535, 128])
torch.Size([758, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.0312504768371582  GigaBytes
Max Memory Allocated: 0.03133058547973633  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017650604248046875  GigaBytes
Max Memory Allocated: 0.031629085540771484  GigaBytes

torch.Size([2484, 1433])
torch.Size([2407, 128])
torch.Size([2176, 128])
torch.Size([1555, 128])
torch.Size([704, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03105020523071289  GigaBytes
Max Memory Allocated: 0.031629085540771484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.016733169555664062  GigaBytes
Max Memory Allocated: 0.031629085540771484  GigaBytes

torch.Size([2392, 1433])
torch.Size([2287, 128])
torch.Size([1991, 128])
torch.Size([1403, 128])
torch.Size([631, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02909564971923828  GigaBytes
Max Memory Allocated: 0.031629085540771484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009310781955718994 |0.08643501996994019 |0.19658643007278442 |0.00016224384307861328 |0.0052828192710876465 |0.0036208629608154297 |
----------------------------------------------------------pseudo_mini_loss sum 3.680680751800537
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37275
Number of first layer input nodes during this epoch:  9803
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02096700668334961  GigaBytes
Max Memory Allocated: 0.031629085540771484  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00046443939208984375
range selection method range initialization spend 6.508827209472656e-05
time for parepare:  6.318092346191406e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.771087646484375e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  8.20159912109375e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.914138793945312e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.3882598876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.0011758804321289062
generate_one_block  0.0011107921600341797
generate_one_block  0.0010881423950195312
generate_one_block  0.00109100341796875
generate_one_block  0.0010628700256347656
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004742145538330078
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0001544952392578125
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.0004010200500488281
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.00041174888610839844
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.000438690185546875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.00034689903259277344
----------------------check_connections_block total spend ----------------------------- 0.003128528594970703
generate_one_block  0.0015294551849365234
generate_one_block  0.0015900135040283203
generate_one_block  0.001516580581665039
generate_one_block  0.0014095306396484375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005719661712646484
gen group dst list time:  7.653236389160156e-05
time for parepare:  0.00018143653869628906
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0002694129943847656
mini_batch_src_global generation:  0.00015664100646972656
r_  generation:  0.0012862682342529297
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.0001704692840576172
r_  generation:  0.0012509822845458984
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.001190185546875
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0011186599731445312
----------------------check_connections_block total spend ----------------------------- 0.00793766975402832
generate_one_block  0.002545595169067383
generate_one_block  0.002465486526489258
generate_one_block  0.0023298263549804688
generate_one_block  0.0021903514862060547
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007627010345458984
gen group dst list time:  0.00013756752014160156
time for parepare:  0.00018715858459472656
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.0003910064697265625
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.0023741722106933594
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.00028967857360839844
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.002338409423828125
local_output_nid generation:  0.00010824203491210938
local_in_edges_tensor generation: Using backend: pytorch
 0.0002810955047607422
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.002290964126586914
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.00027751922607421875
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.002237558364868164
----------------------check_connections_block total spend ----------------------------- 0.014324665069580078
generate_one_block  0.0036160945892333984
generate_one_block  0.003464221954345703
generate_one_block  0.0035538673400878906
generate_one_block  0.003338336944580078
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007722377777099609
gen group dst list time:  0.00018835067749023438
time for parepare:  0.00019121170043945312
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.00048613548278808594
mini_batch_src_global generation:  0.00025916099548339844
r_  generation:  0.0029523372650146484
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.00034546852111816406
mini_batch_src_global generation:  0.0003151893615722656
r_  generation:  0.0029745101928710938
local_output_nid generation:  0.00015234947204589844
local_in_edges_tensor generation:  0.0003437995910644531
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.0029697418212890625
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.00033783912658691406
mini_batch_src_global generation:  0.00024437904357910156
r_  generation:  0.002933502197265625
----------------------check_connections_block total spend ----------------------------- 0.01786947250366211
generate_one_block  0.004371166229248047
generate_one_block  0.004088640213012695
generate_one_block  0.004030942916870117
generate_one_block  0.00395512580871582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007612705230712891
gen group dst list time:  0.00021791458129882812
time for parepare:  0.00019598007202148438
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0004930496215820312
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0031709671020507812
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.0003681182861328125
mini_batch_src_global generation:  0.00029087066650390625
r_  generation:  0.0032045841217041016
local_output_nid generation:  0.0001659393310546875
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.0032341480255126953
local_output_nid generation:  0.00018072128295898438
local_in_edges_tensor generation:  0.00036144256591796875
mini_batch_src_global generation:  0.0002593994140625
r_  generation:  0.0031168460845947266
----------------------check_connections_block total spend ----------------------------- 0.01901841163635254
generate_one_block  0.004687309265136719
generate_one_block  0.004257678985595703
generate_one_block  0.0041882991790771484
generate_one_block  0.004129886627197266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02096700668334961  GigaBytes
Max Memory Allocated: 0.031629085540771484  GigaBytes

connection checking time:  0.06227874755859375
block generation total time  0.06325840950012207
average batch blocks generation time:  0.015814602375030518
block dataloader generation time/epoch 0.15009403228759766
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02138233184814453  GigaBytes
Max Memory Allocated: 0.03391599655151367  GigaBytes

torch.Size([2447, 1433])
torch.Size([2377, 128])
torch.Size([2142, 128])
torch.Size([1592, 128])
torch.Size([749, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03484392166137695  GigaBytes
Max Memory Allocated: 0.034924983978271484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.020784378051757812  GigaBytes
Max Memory Allocated: 0.03521013259887695  GigaBytes

torch.Size([2449, 1433])
torch.Size([2378, 128])
torch.Size([2144, 128])
torch.Size([1573, 128])
torch.Size([730, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03507184982299805  GigaBytes
Max Memory Allocated: 0.03521013259887695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02138042449951172  GigaBytes
Max Memory Allocated: 0.03538703918457031  GigaBytes

torch.Size([2458, 1433])
torch.Size([2366, 128])
torch.Size([2143, 128])
torch.Size([1491, 128])
torch.Size([698, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0345616340637207  GigaBytes
Max Memory Allocated: 0.03538703918457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02058696746826172  GigaBytes
Max Memory Allocated: 0.03538703918457031  GigaBytes

torch.Size([2414, 1433])
torch.Size([2329, 128])
torch.Size([2097, 128])
torch.Size([1455, 128])
torch.Size([634, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.033458709716796875  GigaBytes
Max Memory Allocated: 0.03538703918457031  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0037894248962402344 |0.0008397698402404785 |0.0068070292472839355 |0.0001156926155090332 |0.0057759881019592285 |0.0036194324493408203 |
----------------------------------------------------------pseudo_mini_loss sum 3.5639684200286865
Total (block generation + training)time/epoch 0.22760581970214844
Training time/epoch 0.07730221748352051
Training time without block to device /epoch 0.0739431381225586
Training time without total dataloading part /epoch 0.05441427230834961
load block tensor time/epoch 0.015157699584960938
block to device time/epoch 0.003359079360961914
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37398
Number of first layer input nodes during this epoch:  9768
