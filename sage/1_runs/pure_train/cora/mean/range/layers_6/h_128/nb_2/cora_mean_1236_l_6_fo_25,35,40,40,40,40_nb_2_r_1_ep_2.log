main start at this time 1648433419.399628
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011687278747558594
range selection method range initialization spend 8.106231689453125e-05
time for parepare:  6.508827209472656e-05
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0013511180877685547
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001251697540283203
----------------------check_connections_block total spend ----------------------------- 0.0021598339080810547
generate_one_block  0.001422882080078125
generate_one_block  0.0012695789337158203
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005080699920654297
gen group dst list time:  3.0517578125e-05
time for parepare:  0.00014162063598632812
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0007498264312744141
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  8.440017700195312e-05
r_  generation:  0.0006678104400634766
----------------------check_connections_block total spend ----------------------------- 0.0025746822357177734
generate_one_block  0.002004861831665039
generate_one_block  0.0018305778503417969
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006024837493896484
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.0001819133758544922
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0003216266632080078
mini_batch_src_global generation:  0.00018668174743652344
r_  generation:  0.0019147396087646484
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002422332763671875
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0017521381378173828
----------------------check_connections_block total spend ----------------------------- 0.005816221237182617
generate_one_block  0.003253936767578125
generate_one_block  0.0030264854431152344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006220340728759766
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.0001857280731201172
local_output_nid generation:  0.0001285076141357422
local_in_edges_tensor generation:  0.0004067420959472656
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.002864837646484375
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00032019615173339844
mini_batch_src_global generation:  0.0002665519714355469
r_  generation:  0.0027608871459960938
----------------------check_connections_block total spend ----------------------------- 0.008529186248779297
generate_one_block  0.004128456115722656
generate_one_block  0.003996849060058594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007526874542236328
gen group dst list time:  0.00010895729064941406
time for parepare:  0.0001914501190185547
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.0004780292510986328
mini_batch_src_global generation:  0.0002117156982421875
r_  generation:  0.003248453140258789
local_output_nid generation:  0.0001595020294189453
local_in_edges_tensor generation:  0.0003688335418701172
mini_batch_src_global generation:  0.0002772808074951172
r_  generation:  0.003209829330444336
----------------------check_connections_block total spend ----------------------------- 0.009681940078735352
generate_one_block  0.0044708251953125
generate_one_block  0.004598379135131836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006806850433349609
gen group dst list time:  0.00011944770812988281
time for parepare:  0.00018858909606933594
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.0004646778106689453
mini_batch_src_global generation:  0.00021958351135253906
r_  generation:  0.003330230712890625
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.0003840923309326172
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.0033283233642578125
----------------------check_connections_block total spend ----------------------------- 0.009990692138671875
generate_one_block  0.004542827606201172
generate_one_block  0.004405975341796875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

connection checking time:  0.036592721939086914
block generation total time  0.03625917434692383
average batch blocks generation time:  0.018129587173461914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.01582193374633789  GigaBytes
Max Memory Allocated: 0.01582193374633789  GigaBytes

torch.Size([2506, 1433])
torch.Size([2460, 128])
torch.Size([2335, 128])
torch.Size([1963, 128])
torch.Size([1215, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.03192710876464844  GigaBytes
Max Memory Allocated: 0.03209543228149414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017354965209960938  GigaBytes
Max Memory Allocated: 0.03249073028564453  GigaBytes

torch.Size([2500, 1433])
torch.Size([2442, 128])
torch.Size([2294, 128])
torch.Size([1864, 128])
torch.Size([1071, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.033190250396728516  GigaBytes
Max Memory Allocated: 0.033345699310302734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02000296115875244 |0.16951990127563477 |0.38488733768463135 |0.00018644332885742188 |0.007129311561584473 |0.0036678314208984375 |
----------------------------------------------------------pseudo_mini_loss sum 3.9405500888824463
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21357
Number of first layer input nodes during this epoch:  5006
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021689414978027344  GigaBytes
Max Memory Allocated: 0.03354597091674805  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006101131439208984
range selection method range initialization spend 8.916854858398438e-05
time for parepare:  9.655952453613281e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00016546249389648438
local_output_nid generation:  2.4318695068359375e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00015592575073242188
----------------------check_connections_block total spend ----------------------------- 0.0012178421020507812
generate_one_block  0.0014946460723876953
generate_one_block  0.0014371871948242188
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005843639373779297
gen group dst list time:  4.029273986816406e-05
time for parepare:  0.00022459030151367188
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.00086212158203125
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0001964569091796875
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.000843048095703125
----------------------check_connections_block total spend ----------------------------- 0.0032320022583007812
generate_one_block  0.0023889541625976562
generate_one_block  0.002211332321166992
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006787776947021484
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0002434253692626953
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0003571510314941406
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.0022428035736083984
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0002951622009277344
r_  generation:  0.0021431446075439453
----------------------check_connections_block total spend ----------------------------- 0.0071125030517578125
generate_one_block  0.0038123130798339844
generate_one_block  0.0035560131072998047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007364749908447266
gen group dst list time:  0.00011587142944335938
time for parepare:  0.0002384185791015625
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.00047206878662109375
mini_batch_src_global generation:  0.0002868175506591797
r_  generation:  0.0035314559936523438
local_output_nid generation:  0.00017714500427246094
local_in_edges_tensor generation:  0.0003924369812011719
mini_batch_src_global generation:  0.0003914833068847656
r_  generation:  0.003417491912841797
----------------------check_connections_block total spend ----------------------------- 0.010881423950195312
generate_one_block  0.0047490596771240234
generate_one_block  0.0036835670471191406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007243156433105469
gen group dst list time:  0.0001456737518310547
time for parepare:  0.0002503395080566406
local_output_nid generation:  0.00021076202392578125
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.0002923011779785156
r_  generation:  0.004076480865478516
local_output_nid generation:  0.0002224445343017578
local_in_edges_tensor generation:  0.0004489421844482422
mini_batch_src_global generation:  0.0004131793975830078
r_  generation:  0.003948211669921875
----------------------check_connections_block total spend ----------------------------- 0.012221336364746094
generate_one_block  0.00495600700378418
generate_one_block  0.00452733039855957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007092952728271484
gen group dst list time:  0.00015878677368164062
time for parepare:  0.00023984909057617188
local_output_nid generation:  0.00022363662719726562
local_in_edges_tensor generation:  0.0005445480346679688
mini_batch_src_global generation:  0.0002875328063964844
r_  generation:  0.004166603088378906
local_output_nid generation:  0.0002391338348388672
local_in_edges_tensor generation:  0.0004608631134033203
mini_batch_src_global generation:  0.0004248619079589844
r_  generation:  0.0041043758392333984
----------------------check_connections_block total spend ----------------------------- 0.012564897537231445
generate_one_block  0.00486302375793457
generate_one_block  0.004292488098144531
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021689414978027344  GigaBytes
Max Memory Allocated: 0.03354597091674805  GigaBytes

connection checking time:  0.046012163162231445
block generation total time  0.03904008865356445
average batch blocks generation time:  0.019520044326782227
block dataloader generation time/epoch 0.11379456520080566
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02141427993774414  GigaBytes
Max Memory Allocated: 0.03449440002441406  GigaBytes

torch.Size([2470, 1433])
torch.Size([2432, 128])
torch.Size([2307, 128])
torch.Size([1900, 128])
torch.Size([1110, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.03702354431152344  GigaBytes
Max Memory Allocated: 0.037184715270996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02092885971069336  GigaBytes
Max Memory Allocated: 0.03739356994628906  GigaBytes

torch.Size([2471, 1433])
torch.Size([2395, 128])
torch.Size([2256, 128])
torch.Size([1818, 128])
torch.Size([1030, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03670215606689453  GigaBytes
Max Memory Allocated: 0.03739356994628906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0035409927368164062 |0.0015066862106323242 |0.010012626647949219 |0.00013935565948486328 |0.003997325897216797 |0.0027675628662109375 |
----------------------------------------------------------pseudo_mini_loss sum 3.4286980628967285
Total (block generation + training)time/epoch 0.1592559814453125
Training time/epoch 0.044834136962890625
Training time without block to device /epoch 0.04182076454162598
Training time without total dataloading part /epoch 0.031066179275512695
load block tensor time/epoch 0.0070819854736328125
block to device time/epoch 0.0030133724212646484
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  20880
Number of first layer input nodes during this epoch:  4941
