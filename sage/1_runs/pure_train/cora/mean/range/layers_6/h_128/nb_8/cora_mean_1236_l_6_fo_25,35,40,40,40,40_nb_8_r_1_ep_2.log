main start at this time 1648433438.2468731
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0009281635284423828
range selection method range initialization spend 0.0001227855682373047
time for parepare:  8.130073547363281e-05
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0037393569946289062
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.14984130859375e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.38690185546875e-05
----------------------check_connections_block total spend ----------------------------- 0.006011247634887695
generate_one_block  0.0014531612396240234
generate_one_block  0.0013091564178466797
generate_one_block  0.001230478286743164
generate_one_block  0.0012056827545166016
generate_one_block  0.0012819766998291016
generate_one_block  0.0011737346649169922
generate_one_block  0.0010290145874023438
generate_one_block  0.0011172294616699219
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005757808685302734
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.00017642974853515625
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002701282501220703
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003418922424316406
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003039836883544922
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002808570861816406
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00029277801513671875
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002613067626953125
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00027179718017578125
----------------------check_connections_block total spend ----------------------------- 0.004845380783081055
generate_one_block  0.0015332698822021484
generate_one_block  0.0016295909881591797
generate_one_block  0.0015363693237304688
generate_one_block  0.0015654563903808594
generate_one_block  0.0015146732330322266
generate_one_block  0.0038013458251953125
generate_one_block  0.0012531280517578125
generate_one_block  0.001218557357788086
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0010516643524169922
gen group dst list time:  0.00013566017150878906
time for parepare:  0.0002624988555908203
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0008785724639892578
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.001184701919555664
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.001009225845336914
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.0010623931884765625
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0009887218475341797
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0010120868682861328
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0006477832794189453
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.000978231430053711
----------------------check_connections_block total spend ----------------------------- 0.01308441162109375
generate_one_block  0.002039670944213867
generate_one_block  0.0020585060119628906
generate_one_block  0.0018410682678222656
generate_one_block  0.0019168853759765625
generate_one_block  0.0018389225006103516
generate_one_block  0.0019478797912597656
generate_one_block  0.0015153884887695312
generate_one_block  0.0018396377563476562
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007803440093994141
gen group dst list time:  0.0002579689025878906
time for parepare:  0.00024580955505371094
local_output_nid generation:  0.00010204315185546875
local_in_edges_tensor generation:  0.0004298686981201172
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.0020110607147216797
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.0021555423736572266
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.00024890899658203125
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0018317699432373047
local_output_nid generation:  9.1552734375e-05
local_in_edges_tensor generation:  0.00026035308837890625
mini_batch_src_global generation:  0.0001838207244873047
r_  generation:  0.0020682811737060547
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002486705780029297
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0018846988677978516
local_output_nid generation:  9.322166442871094e-05
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0019636154174804688
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.000240325927734375
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.001486063003540039
local_output_nid generation:  8.559226989746094e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0018398761749267578
----------------------check_connections_block total spend ----------------------------- 0.02373361587524414
generate_one_block  0.003078460693359375
generate_one_block  0.0031054019927978516
generate_one_block  0.0032427310943603516
generate_one_block  0.0030677318572998047
generate_one_block  0.0032265186309814453
generate_one_block  0.002948760986328125
generate_one_block  0.0025539398193359375
generate_one_block  0.0028896331787109375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008225440979003906
gen group dst list time:  0.00036025047302246094
time for parepare:  0.0002071857452392578
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.002835988998413086
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.0003490447998046875
mini_batch_src_global generation:  0.0003273487091064453
r_  generation:  0.003008604049682617
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0003147125244140625
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.002686023712158203
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation:  0.00024628639221191406
r_  generation:  0.003008604049682617
local_output_nid generation:  0.0001456737518310547
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002840757369995117
local_output_nid generation:  0.00013566017150878906
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00023365020751953125
r_  generation:  0.0027899742126464844
local_output_nid generation:  0.0001289844512939453
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0023772716522216797
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  0.00021529197692871094
r_  generation:  0.002466440200805664
----------------------check_connections_block total spend ----------------------------- 0.03304553031921387
generate_one_block  0.004648923873901367
generate_one_block  0.003874540328979492
generate_one_block  0.0035839080810546875
generate_one_block  0.004398345947265625
generate_one_block  0.0037670135498046875
generate_one_block  0.0037581920623779297
generate_one_block  0.003564596176147461
generate_one_block  0.0037157535552978516
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007715225219726562
gen group dst list time:  0.0004780292510986328
time for parepare:  0.00022602081298828125
local_output_nid generation:  0.0001609325408935547
local_in_edges_tensor generation:  0.0005192756652832031
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.003236532211303711
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.00038552284240722656
mini_batch_src_global generation:  0.0003387928009033203
r_  generation:  0.0033173561096191406
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003643035888671875
mini_batch_src_global generation:  0.00026702880859375
r_  generation:  0.0031473636627197266
local_output_nid generation:  0.00016832351684570312
local_in_edges_tensor generation:  0.0003821849822998047
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.003324747085571289
local_output_nid generation:  0.0001709461212158203
local_in_edges_tensor generation:  0.00037932395935058594
mini_batch_src_global generation:  0.0002696514129638672
r_  generation:  0.0031545162200927734
local_output_nid generation:  0.0001544952392578125
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.00024819374084472656
r_  generation:  0.0028808116912841797
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.0003337860107421875
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.002803325653076172
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.00033783912658691406
mini_batch_src_global generation:  0.0002391338348388672
r_  generation:  0.002838134765625
----------------------check_connections_block total spend ----------------------------- 0.03680562973022461
generate_one_block  0.0049839019775390625
generate_one_block  0.004131793975830078
generate_one_block  0.004291534423828125
generate_one_block  0.004911899566650391
generate_one_block  0.0040853023529052734
generate_one_block  0.004024028778076172
generate_one_block  0.003950834274291992
generate_one_block  0.0040018558502197266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0018734931945800781  GigaBytes
Max Memory Allocated: 0.0018734931945800781  GigaBytes

connection checking time:  0.11151456832885742
block generation total time  0.11885595321655273
average batch blocks generation time:  0.014856994152069092
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.015741348266601562  GigaBytes
Max Memory Allocated: 0.015741348266601562  GigaBytes

torch.Size([2412, 1433])
torch.Size([2270, 128])
torch.Size([1858, 128])
torch.Size([1117, 128])
torch.Size([408, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.026645660400390625  GigaBytes
Max Memory Allocated: 0.026693344116210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017003536224365234  GigaBytes
Max Memory Allocated: 0.03046131134033203  GigaBytes

torch.Size([2444, 1433])
torch.Size([2341, 128])
torch.Size([2032, 128])
torch.Size([1317, 128])
torch.Size([546, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.029874801635742188  GigaBytes
Max Memory Allocated: 0.03046131134033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016517162322998047  GigaBytes
Max Memory Allocated: 0.03046131134033203  GigaBytes

torch.Size([2357, 1433])
torch.Size([2173, 128])
torch.Size([1763, 128])
torch.Size([1083, 128])
torch.Size([439, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02714395523071289  GigaBytes
Max Memory Allocated: 0.03046131134033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01709127426147461  GigaBytes
Max Memory Allocated: 0.03046131134033203  GigaBytes

torch.Size([2461, 1433])
torch.Size([2332, 128])
torch.Size([2023, 128])
torch.Size([1233, 128])
torch.Size([480, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02947092056274414  GigaBytes
Max Memory Allocated: 0.03046131134033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01761484146118164  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

torch.Size([2427, 1433])
torch.Size([2301, 128])
torch.Size([1893, 128])
torch.Size([1107, 128])
torch.Size([430, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.028645992279052734  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016711711883544922  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

torch.Size([2392, 1433])
torch.Size([2261, 128])
torch.Size([1912, 128])
torch.Size([1180, 128])
torch.Size([452, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027812480926513672  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016508102416992188  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

torch.Size([2358, 1433])
torch.Size([2171, 128])
torch.Size([1695, 128])
torch.Size([889, 128])
torch.Size([268, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.026189804077148438  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01664447784423828  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

torch.Size([2380, 1433])
torch.Size([2220, 128])
torch.Size([1821, 128])
torch.Size([1139, 128])
torch.Size([428, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.027390480041503906  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00856742262840271 |0.0436500608921051 |0.10237827897071838 |0.0001359879970550537 |0.004792243242263794 |0.0046787261962890625 |
----------------------------------------------------------pseudo_mini_loss sum 4.198990345001221
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  65574
Number of first layer input nodes during this epoch:  19231
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.020825862884521484  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00047016143798828125
range selection method range initialization spend 7.009506225585938e-05
time for parepare:  6.842613220214844e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00017452239990234375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.172325134277344e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.364418029785156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7894973754882812e-05
----------------------check_connections_block total spend ----------------------------- 0.0018460750579833984
generate_one_block  0.0011134147644042969
generate_one_block  0.0010344982147216797
generate_one_block  0.0010852813720703125
generate_one_block  0.0010266304016113281
generate_one_block  0.0010390281677246094
generate_one_block  0.0010426044464111328
generate_one_block  0.001035451889038086
generate_one_block  0.0009996891021728516
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004897117614746094
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0001590251922607422
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00023221969604492188
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00032806396484375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00019741058349609375
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00028586387634277344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0002117156982421875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00015473365783691406
----------------------check_connections_block total spend ----------------------------- 0.004029035568237305
generate_one_block  0.0014026165008544922
generate_one_block  0.0012862682342529297
generate_one_block  0.0013620853424072266
generate_one_block  0.001264810562133789
generate_one_block  0.0013327598571777344
generate_one_block  0.0011615753173828125
generate_one_block  0.001294851303100586
generate_one_block  0.001134634017944336
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006268024444580078
gen group dst list time:  0.00010132789611816406
time for parepare:  0.0001933574676513672
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00028777122497558594
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0008282661437988281
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  0.00010824203491210938
r_  generation:  0.0007791519165039062
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00011181831359863281
r_  generation:  0.001033782958984375
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0007367134094238281
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  9.250640869140625e-05
r_  generation:  0.0008358955383300781
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0005459785461425781
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0007686614990234375
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.772445678710938e-05
r_  generation:  0.0005903244018554688
----------------------check_connections_block total spend ----------------------------- 0.010464668273925781
generate_one_block  0.002016305923461914
generate_one_block  0.0019249916076660156
generate_one_block  0.0021026134490966797
generate_one_block  0.0017290115356445312
generate_one_block  0.0019063949584960938
generate_one_block  0.0016558170318603516
generate_one_block  0.0018334388732910156
generate_one_block  0.0016238689422607422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007331371307373047
gen group dst list time:  0.00019693374633789062
time for parepare:  0.0001850128173828125
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.0003662109375
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0019342899322509766
local_output_nid generation:  8.869171142578125e-05
local_in_edges_tensor generation:  0.0002493858337402344
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.0018990039825439453
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0021741390228271484
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00016808509826660156
r_  generation:  0.0016655921936035156
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00016880035400390625
r_  generation:  0.0018684864044189453
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.001497030258178711
local_output_nid generation:  8.7738037109375e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0017330646514892578
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00015354156494140625
r_  generation:  0.001528024673461914
----------------------check_connections_block total spend ----------------------------- 0.022017240524291992
generate_one_block  0.0032339096069335938
generate_one_block  0.003069162368774414
generate_one_block  0.0034945011138916016
generate_one_block  0.002881765365600586
generate_one_block  0.0029172897338867188
generate_one_block  0.0026030540466308594
generate_one_block  0.002968311309814453
generate_one_block  0.002726316452026367
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000766754150390625
gen group dst list time:  0.00035452842712402344
time for parepare:  0.00019431114196777344
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.000461578369140625
mini_batch_src_global generation:  0.0002510547637939453
r_  generation:  0.002724170684814453
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.0003113746643066406
r_  generation:  0.002721548080444336
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.0002434253692626953
r_  generation:  0.0028982162475585938
local_output_nid generation:  0.00013589859008789062
local_in_edges_tensor generation:  0.00030612945556640625
mini_batch_src_global generation:  0.00022935867309570312
r_  generation:  0.002596616744995117
local_output_nid generation:  0.00013947486877441406
local_in_edges_tensor generation:  0.00031566619873046875
mini_batch_src_global generation:  0.00022935867309570312
r_  generation:  0.002640962600708008
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.0002853870391845703
mini_batch_src_global generation:  0.00021028518676757812
r_  generation:  0.0023565292358398438
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.00023174285888671875
r_  generation:  0.002588033676147461
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.000286102294921875
mini_batch_src_global generation:  0.00021505355834960938
r_  generation:  0.002446413040161133
----------------------check_connections_block total spend ----------------------------- 0.031612396240234375
generate_one_block  0.004266500473022461
generate_one_block  0.004165172576904297
generate_one_block  0.003970146179199219
generate_one_block  0.003669261932373047
generate_one_block  0.0037353038787841797
generate_one_block  0.0035851001739501953
generate_one_block  0.004173994064331055
generate_one_block  0.0036382675170898438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007998943328857422
gen group dst list time:  0.0004570484161376953
time for parepare:  0.00018405914306640625
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.0004999637603759766
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.003070354461669922
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.0003590583801269531
mini_batch_src_global generation:  0.0003249645233154297
r_  generation:  0.0030744075775146484
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  0.0002799034118652344
r_  generation:  0.0031440258026123047
local_output_nid generation:  0.00016379356384277344
local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0030364990234375
local_output_nid generation:  0.00017070770263671875
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.003045320510864258
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.0028619766235351562
local_output_nid generation:  0.00015425682067871094Using backend: pytorch

local_in_edges_tensor generation:  0.000339508056640625
mini_batch_src_global generation:  0.00024271011352539062
r_  generation:  0.0028994083404541016
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002822399139404297
----------------------check_connections_block total spend ----------------------------- 0.035762786865234375
generate_one_block  0.004253864288330078
generate_one_block  0.004183769226074219
generate_one_block  0.004961967468261719
generate_one_block  0.004048585891723633
generate_one_block  0.004014492034912109
generate_one_block  0.0039446353912353516
generate_one_block  0.004392147064208984
generate_one_block  0.003976345062255859
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.020825862884521484  GigaBytes
Max Memory Allocated: 0.030551910400390625  GigaBytes

connection checking time:  0.10388612747192383
block generation total time  0.1139059066772461
average batch blocks generation time:  0.014238238334655762
block dataloader generation time/epoch 0.2535972595214844
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.02134847640991211  GigaBytes
Max Memory Allocated: 0.03385114669799805  GigaBytes

torch.Size([2418, 1433])
torch.Size([2276, 128])
torch.Size([1919, 128])
torch.Size([1203, 128])
torch.Size([460, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03262615203857422  GigaBytes
Max Memory Allocated: 0.03385114669799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02046823501586914  GigaBytes
Max Memory Allocated: 0.03393745422363281  GigaBytes

torch.Size([2396, 1433])
torch.Size([2284, 128])
torch.Size([1924, 128])
torch.Size([1183, 128])
torch.Size([435, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03165912628173828  GigaBytes
Max Memory Allocated: 0.03393745422363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02136850357055664  GigaBytes
Max Memory Allocated: 0.03393745422363281  GigaBytes

torch.Size([2433, 1433])
torch.Size([2348, 128])
torch.Size([2057, 128])
torch.Size([1408, 128])
torch.Size([579, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03379392623901367  GigaBytes
Max Memory Allocated: 0.03393745422363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020476341247558594  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

torch.Size([2400, 1433])
torch.Size([2233, 128])
torch.Size([1794, 128])
torch.Size([1030, 128])
torch.Size([395, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030870437622070312  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020353317260742188  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

torch.Size([2375, 1433])
torch.Size([2244, 128])
torch.Size([1875, 128])
torch.Size([1139, 128])
torch.Size([466, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.031443119049072266  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020164966583251953  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

torch.Size([2344, 1433])
torch.Size([2146, 128])
torch.Size([1715, 128])
torch.Size([906, 128])
torch.Size([282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029751300811767578  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020337581634521484  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

torch.Size([2372, 1433])
torch.Size([2247, 128])
torch.Size([1913, 128])
torch.Size([1136, 128])
torch.Size([410, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0313258171081543  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.020240306854248047  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

torch.Size([2357, 1433])
torch.Size([2177, 128])
torch.Size([1757, 128])
torch.Size([985, 128])
torch.Size([317, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.030173778533935547  GigaBytes
Max Memory Allocated: 0.034085750579833984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003376305103302002 |0.0010326802730560303 |0.007307827472686768 |0.00011032819747924805 |0.0057718753814697266 |0.002538442611694336 |
----------------------------------------------------------pseudo_mini_loss sum 3.3781237602233887
Total (block generation + training)time/epoch 0.40673184394836426
Training time/epoch 0.15284037590026855
Training time without block to device /epoch 0.1445789337158203
Training time without total dataloading part /epoch 0.10805869102478027
load block tensor time/epoch 0.027010440826416016
block to device time/epoch 0.008261442184448242
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  65094
Number of first layer input nodes during this epoch:  19095
