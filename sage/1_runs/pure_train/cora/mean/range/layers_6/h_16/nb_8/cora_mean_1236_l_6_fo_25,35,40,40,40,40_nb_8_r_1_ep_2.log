main start at this time 1648433320.2099073
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0010881423950195312
range selection method range initialization spend 8.392333984375e-05
time for parepare:  6.175041198730469e-05
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00018978118896484375
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0013148784637451172
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.2438507080078125e-05
----------------------check_connections_block total spend ----------------------------- 0.003255605697631836
generate_one_block  0.0013949871063232422
generate_one_block  0.0010402202606201172
generate_one_block  0.0010437965393066406
generate_one_block  0.0010454654693603516
generate_one_block  0.0010166168212890625
generate_one_block  0.0010213851928710938
generate_one_block  0.0010228157043457031
generate_one_block  0.001066446304321289
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004961490631103516
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00023055076599121094
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00017976760864257812
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00025153160095214844
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00030517578125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00017380714416503906
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00026106834411621094
----------------------check_connections_block total spend ----------------------------- 0.003966808319091797
generate_one_block  0.0012645721435546875
generate_one_block  0.0011970996856689453
generate_one_block  0.0012972354888916016
generate_one_block  0.001371145248413086
generate_one_block  0.0011854171752929688
generate_one_block  0.001209259033203125
generate_one_block  0.0013134479522705078
generate_one_block  0.0012793540954589844
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006871223449707031
gen group dst list time:  0.0001010894775390625
time for parepare:  0.00019669532775878906
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0006902217864990234
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0005698204040527344
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0009462833404541016
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00011587142944335938
r_  generation:  0.0010139942169189453
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0006625652313232422
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0006940364837646484
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0008299350738525391
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0008871555328369141
----------------------check_connections_block total spend ----------------------------- 0.010616540908813477
generate_one_block  0.0018150806427001953
generate_one_block  0.0016617774963378906
generate_one_block  0.0020198822021484375
generate_one_block  0.002092123031616211
generate_one_block  0.0016925334930419922
generate_one_block  0.00180816650390625
generate_one_block  0.001909017562866211
generate_one_block  0.0019440650939941406
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000720977783203125
gen group dst list time:  0.0001938343048095703
time for parepare:  0.0001838207244873047
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0016133785247802734
local_output_nid generation:  6.723403930664062e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0014295578002929688
local_output_nid generation:  0.00010371208190917969
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  0.0002052783966064453
r_  generation:  0.0021219253540039062
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00026416778564453125
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.002115964889526367
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00016760826110839844
r_  generation:  0.0017473697662353516
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  0.00016164779663085938
r_  generation:  0.0016984939575195312
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.00026345252990722656
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.0017342567443847656
local_output_nid generation:  9.942054748535156e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.0001819133758544922
r_  generation:  0.0019392967224121094
----------------------check_connections_block total spend ----------------------------- 0.02228999137878418
generate_one_block  0.0028188228607177734
generate_one_block  0.0025157928466796875
generate_one_block  0.0032494068145751953
generate_one_block  0.0032663345336914062
generate_one_block  0.003021240234375
generate_one_block  0.0027899742126464844
generate_one_block  0.0028235912322998047
generate_one_block  0.003043651580810547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007469654083251953
gen group dst list time:  0.0003349781036376953
time for parepare:  0.00018453598022460938
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.00045013427734375
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0025124549865722656
local_output_nid generation:  0.00012135505676269531
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.000270843505859375
r_  generation:  0.002438068389892578
local_output_nid generation:  0.000141143798828125
local_in_edges_tensor generation:  0.0003390312194824219
mini_batch_src_global generation:  0.0002446174621582031
r_  generation:  0.0028679370880126953
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.00024008750915527344
r_  generation:  0.0028650760650634766
local_output_nid generation:  0.00014209747314453125
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.002682924270629883
local_output_nid generation:  0.00013327598571777344
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002502918243408203
local_output_nid generation:  0.0001270771026611328
local_in_edges_tensor generation:  0.000308990478515625
mini_batch_src_global generation:  0.00021910667419433594
r_  generation:  0.0024733543395996094
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0026171207427978516
----------------------check_connections_block total spend ----------------------------- 0.031790733337402344
generate_one_block  0.0044155120849609375
generate_one_block  0.0035550594329833984
generate_one_block  0.003928661346435547
generate_one_block  0.005194664001464844
generate_one_block  0.003731250762939453
generate_one_block  0.003628969192504883
generate_one_block  0.003656148910522461
generate_one_block  0.003790616989135742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007598400115966797
gen group dst list time:  0.0004591941833496094
time for parepare:  0.0001926422119140625
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.0004856586456298828
mini_batch_src_global generation:  0.0002491474151611328
r_  generation:  0.0029702186584472656
local_output_nid generation:  0.00015687942504882812
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.0003075599670410156
r_  generation:  0.003043651580810547
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.0003666877746582031
mini_batch_src_global generation:  0.000270843505859375
r_  generation:  0.0031468868255615234
local_output_nid generation:  0.00016260147094726562
local_in_edges_tensor generation:  0.0003592967987060547
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.0031647682189941406
local_output_nid generation:  0.000164031982421875
local_in_edges_tensor generation:  0.0003528594970703125
mini_batch_src_global generation:  0.00025582313537597656
r_  generation:  0.002923727035522461
local_output_nid generation:  0.0001518726348876953
local_in_edges_tensor generation:  0.00032830238342285156
mini_batch_src_global generation:  0.00023794174194335938
r_  generation:  0.0028181076049804688
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003323554992675781
mini_batch_src_global generation:  0.0002415180206298828
r_  generation:  0.002851724624633789
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.00024819374084472656
r_  generation:  0.0029473304748535156
----------------------check_connections_block total spend ----------------------------- 0.03555750846862793
generate_one_block  0.0048601627349853516
generate_one_block  0.0040798187255859375
generate_one_block  0.004403114318847656
generate_one_block  0.0040950775146484375
generate_one_block  0.00405120849609375
generate_one_block  0.003981590270996094
generate_one_block  0.004110813140869141
generate_one_block  0.0049190521240234375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

connection checking time:  0.10422158241271973
block generation total time  0.1149907112121582
average batch blocks generation time:  0.014373838901519775
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.013052940368652344  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

torch.Size([2374, 1433])
torch.Size([2185, 16])
torch.Size([1745, 16])
torch.Size([1022, 16])
torch.Size([354, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.014536857604980469  GigaBytes
Max Memory Allocated: 0.014540672302246094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014229297637939453  GigaBytes
Max Memory Allocated: 0.026724815368652344  GigaBytes

torch.Size([2431, 1433])
torch.Size([2228, 16])
torch.Size([1668, 16])
torch.Size([880, 16])
torch.Size([317, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015637874603271484  GigaBytes
Max Memory Allocated: 0.026724815368652344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014267444610595703  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2441, 1433])
torch.Size([2333, 16])
torch.Size([2047, 16])
torch.Size([1394, 16])
torch.Size([534, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016028404235839844  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014271259307861328  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2435, 1433])
torch.Size([2332, 16])
torch.Size([2049, 16])
torch.Size([1384, 16])
torch.Size([564, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016052722930908203  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014243602752685547  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2431, 1433])
torch.Size([2266, 16])
torch.Size([1846, 16])
torch.Size([1020, 16])
torch.Size([350, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01576089859008789  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01316213607788086  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2359, 1433])
torch.Size([2196, 16])
torch.Size([1811, 16])
torch.Size([1031, 16])
torch.Size([383, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014667987823486328  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013265132904052734  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2377, 1433])
torch.Size([2234, 16])
torch.Size([1830, 16])
torch.Size([1086, 16])
torch.Size([429, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014816761016845703  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014259815216064453  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2423, 1433])
torch.Size([2316, 16])
torch.Size([1953, 16])
torch.Size([1275, 16])
torch.Size([515, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01595306396484375  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0056517720222473145 |0.04350617527961731 |0.10265770554542542 |0.00014474987983703613 |0.005112409591674805 |0.003458738327026367 |
----------------------------------------------------------pseudo_mini_loss sum 3.727867364883423
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  65606
Number of first layer input nodes during this epoch:  19271
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015105247497558594  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004885196685791016
range selection method range initialization spend 6.747245788574219e-05
time for parepare:  6.67572021484375e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.5299530029296875e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.846687316894531e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.719329833984375e-05
----------------------check_connections_block total spend ----------------------------- 0.001829385757446289
generate_one_block  0.0010838508605957031
generate_one_block  0.0010404586791992188
generate_one_block  0.0010325908660888672
generate_one_block  0.0010330677032470703
generate_one_block  0.001051187515258789
generate_one_block  0.001046895980834961
generate_one_block  0.0010559558868408203
generate_one_block  0.0010311603546142578
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005152225494384766
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.00016164779663085938
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00023245811462402344
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011801719665527344
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00017547607421875
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00018858909606933594
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002994537353515625
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.00026488304138183594
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00031685829162597656
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0001659393310546875
----------------------check_connections_block total spend ----------------------------- 0.004119396209716797
generate_one_block  0.0013937950134277344
generate_one_block  0.0012159347534179688
generate_one_block  0.0012383460998535156
generate_one_block  0.001256704330444336
generate_one_block  0.001363992691040039
generate_one_block  0.0013408660888671875
generate_one_block  0.001407623291015625
generate_one_block  0.0011394023895263672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006372928619384766
gen group dst list time:  0.00010991096496582031
time for parepare:  0.00019884109497070312
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0007419586181640625
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  9.131431579589844e-05
r_  generation:  0.0006315708160400391
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0006494522094726562
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0007386207580566406
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0009438991546630859
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  0.00011706352233886719
r_  generation:  0.0008797645568847656
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.00019669532775878906
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0011954307556152344
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0005331039428710938
----------------------check_connections_block total spend ----------------------------- 0.010809183120727539
generate_one_block  0.0020461082458496094
generate_one_block  0.0017855167388916016
generate_one_block  0.0016548633575439453
generate_one_block  0.0017940998077392578
generate_one_block  0.002023458480834961
generate_one_block  0.0020360946655273438
generate_one_block  0.0022568702697753906
generate_one_block  0.0015230178833007812
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007460117340087891
gen group dst list time:  0.00020432472229003906
time for parepare:  0.00019359588623046875
local_output_nid generation:  7.224082946777344e-05
local_in_edges_tensor generation:  0.0003561973571777344
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.001622915267944336
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00021576881408691406
r_  generation:  0.0016069412231445312
local_output_nid generation:  7.987022399902344e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  0.00017499923706054688
r_  generation:  0.001683950424194336
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00018978118896484375
r_  generation:  0.0018646717071533203
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0020627975463867188
local_output_nid generation:  9.226799011230469e-05
local_in_edges_tensor generation:  0.0002541542053222656
mini_batch_src_global generation:  0.00018405914306640625
r_  generation:  0.0019259452819824219
local_output_nid generation:  0.00011110305786132812
local_in_edges_tensor generation:  0.0002846717834472656
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0021445751190185547
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0012929439544677734
----------------------check_connections_block total spend ----------------------------- 0.022094249725341797
generate_one_block  0.002795696258544922
generate_one_block  0.0026786327362060547
generate_one_block  0.0027534961700439453
generate_one_block  0.0029261112213134766
generate_one_block  0.0031702518463134766
generate_one_block  0.003002643585205078
generate_one_block  0.0033698081970214844
generate_one_block  0.0024826526641845703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007777214050292969
gen group dst list time:  0.0003464221954345703
time for parepare:  0.0001919269561767578
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.00044035911560058594
mini_batch_src_global generation:  0.00021791458129882812
r_  generation:  0.002542257308959961
local_output_nid generation:  0.00013184547424316406
local_in_edges_tensor generation:  0.0003204345703125
mini_batch_src_global generation:  0.00029277801513671875
r_  generation:  0.002613544464111328
local_output_nid generation:  0.00013685226440429688
local_in_edges_tensor generation:  0.0003204345703125
mini_batch_src_global generation:  0.0002300739288330078
r_  generation:  0.002688169479370117
local_output_nid generation:  0.0001437664031982422
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.00024080276489257812
r_  generation:  0.0028259754180908203
local_output_nid generation:  0.0001468658447265625
local_in_edges_tensor generation:  0.00033020973205566406
mini_batch_src_global generation:  0.0002455711364746094
r_  generation:  0.002846956253051758
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.002596616744995117
local_output_nid generation:  0.0001430511474609375
local_in_edges_tensor generation:  0.0003190040588378906
mini_batch_src_global generation:  0.00023674964904785156
r_  generation:  0.0027472972869873047
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.00021338462829589844
r_  generation:  0.0023016929626464844
----------------------check_connections_block total spend ----------------------------- 0.03192591667175293
generate_one_block  0.004080533981323242
generate_one_block  0.0039598941802978516
generate_one_block  0.0036716461181640625
generate_one_block  0.0038313865661621094
generate_one_block  0.0041086673736572266
generate_one_block  0.0038559436798095703
generate_one_block  0.003895282745361328
generate_one_block  0.003534555435180664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007832050323486328
gen group dst list time:  0.0004589557647705078
time for parepare:  0.0001919269561767578
local_output_nid generation:  0.0001552104949951172
local_in_edges_tensor generation:  0.0004966259002685547
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.0030329227447509766
local_output_nid generation:  0.0001621246337890625
local_in_edges_tensor generation:  0.0003676414489746094
mini_batch_src_global generation:  0.0003147125244140625
r_  generation:  0.0030677318572998047
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.003100872039794922
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0003712177276611328
mini_batch_src_global generation:  0.0002677440643310547
r_  generation:  0.0032029151916503906
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.000370025634765625
mini_batch_src_global generation:  0.0003173351287841797
r_  generation:  0.003188610076904297
local_output_nid generation:  0.00016999244689941406
local_in_edges_tensor generation:  0.0003705024719238281
mini_batch_src_global generation:  0.00026488304138183594
r_  generation:  0.0031037330627441406
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation: Using backend: pytorch
 0.00034332275390625
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.002993345260620117
local_output_nid generation:  0.00015473365783691406
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.002840280532836914
----------------------check_connections_block total spend ----------------------------- 0.036631107330322266
generate_one_block  0.0049495697021484375
generate_one_block  0.0040628910064697266
generate_one_block  0.004055023193359375
generate_one_block  0.004113197326660156
generate_one_block  0.0040628910064697266
generate_one_block  0.0041081905364990234
generate_one_block  0.004503726959228516
generate_one_block  0.004142045974731445
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015105247497558594  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

connection checking time:  0.10557985305786133
block generation total time  0.11359143257141113
average batch blocks generation time:  0.014198929071426392
block dataloader generation time/epoch 0.25363612174987793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013515949249267578  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2357, 1433])
torch.Size([2174, 16])
torch.Size([1716, 16])
torch.Size([1008, 16])
torch.Size([415, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014989852905273438  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013568401336669922  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2367, 1433])
torch.Size([2192, 16])
torch.Size([1748, 16])
torch.Size([937, 16])
torch.Size([334, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015013694763183594  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014606952667236328  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

torch.Size([2385, 1433])
torch.Size([2205, 16])
torch.Size([1816, 16])
torch.Size([983, 16])
torch.Size([338, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01608896255493164  GigaBytes
Max Memory Allocated: 0.027723312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014621257781982422  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2432, 1433])
torch.Size([2300, 16])
torch.Size([1931, 16])
torch.Size([1141, 16])
torch.Size([390, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016222476959228516  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014632701873779297  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2423, 1433])
torch.Size([2279, 16])
torch.Size([1952, 16])
torch.Size([1298, 16])
torch.Size([490, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016323566436767578  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014625072479248047  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2451, 1433])
torch.Size([2307, 16])
torch.Size([1931, 16])
torch.Size([1184, 16])
torch.Size([474, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01627206802368164  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01464700698852539  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2414, 1433])
torch.Size([2331, 16])
torch.Size([2081, 16])
torch.Size([1488, 16])
torch.Size([656, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016487598419189453  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013477802276611328  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

torch.Size([2352, 1433])
torch.Size([2171, 16])
torch.Size([1658, 16])
torch.Size([815, 16])
torch.Size([284, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014837265014648438  GigaBytes
Max Memory Allocated: 0.028093338012695312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003893554210662842 |0.001069575548171997 |0.007403969764709473 |0.00011593103408813477 |0.005303561687469482 |0.0031719207763671875 |
----------------------------------------------------------pseudo_mini_loss sum 3.3856420516967773
Total (block generation + training)time/epoch 0.4099242687225342
Training time/epoch 0.15592026710510254
Training time without block to device /epoch 0.14736366271972656
Training time without total dataloading part /epoch 0.1057596206665039
load block tensor time/epoch 0.031148433685302734
block to device time/epoch 0.008556604385375977
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64964
Number of first layer input nodes during this epoch:  19181
