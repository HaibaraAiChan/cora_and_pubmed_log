main start at this time 1648433310.5762262
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011584758758544922
range selection method range initialization spend 0.00010633468627929688
time for parepare:  7.748603820800781e-05
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0002353191375732422
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0027008056640625
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  9.775161743164062e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  5.91278076171875e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.20159912109375e-05
----------------------check_connections_block total spend ----------------------------- 0.004198551177978516
generate_one_block  0.0017766952514648438
generate_one_block  0.0013704299926757812
generate_one_block  0.0012977123260498047
generate_one_block  0.0013234615325927734
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005970001220703125
gen group dst list time:  4.982948303222656e-05
time for parepare:  0.00017333030700683594
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00023031234741210938
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00045180320739746094
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0006082057952880859
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0003745555877685547
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005586147308349609
----------------------check_connections_block total spend ----------------------------- 0.0038483142852783203
generate_one_block  0.0017762184143066406
generate_one_block  0.0019714832305908203
generate_one_block  0.0016722679138183594
generate_one_block  0.0019693374633789062
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006811618804931641
gen group dst list time:  0.000102996826171875
time for parepare:  0.00022101402282714844
local_output_nid generation:  5.7220458984375e-05
local_in_edges_tensor generation:  0.0003101825714111328
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.0013704299926757812
local_output_nid generation:  8.678436279296875e-05
local_in_edges_tensor generation:  0.0002739429473876953
mini_batch_src_global generation:  0.00019812583923339844
r_  generation:  0.0019278526306152344
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0012545585632324219
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.00026226043701171875
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0017592906951904297
----------------------check_connections_block total spend ----------------------------- 0.010121345520019531
generate_one_block  0.002524137496948242
generate_one_block  0.002913236618041992
generate_one_block  0.0020575523376464844
generate_one_block  0.0025925636291503906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000698089599609375
gen group dst list time:  0.00013971328735351562
time for parepare:  0.00019049644470214844
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.0003745555877685547
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0022268295288085938
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.00032401084899902344
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0027184486389160156
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.0022420883178710938
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  0.000217437744140625
r_  generation:  0.0025153160095214844
----------------------check_connections_block total spend ----------------------------- 0.014681100845336914
generate_one_block  0.004391193389892578
generate_one_block  0.0036101341247558594
generate_one_block  0.003374814987182617
generate_one_block  0.0034334659576416016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007524490356445312
gen group dst list time:  0.000194549560546875
time for parepare:  0.00019741058349609375
local_output_nid generation:  0.00014257431030273438
local_in_edges_tensor generation:  0.0004532337188720703
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.003036975860595703
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.00037479400634765625
mini_batch_src_global generation:  0.0003254413604736328
r_  generation:  0.003189563751220703
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0002639293670654297
r_  generation:  0.003096342086791992
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.0002620220184326172
r_  generation:  0.003171205520629883
----------------------check_connections_block total spend ----------------------------- 0.018842220306396484
generate_one_block  0.004967212677001953
generate_one_block  0.004071712493896484
generate_one_block  0.003987312316894531
generate_one_block  0.00401759147644043
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007345676422119141
gen group dst list time:  0.00022602081298828125
time for parepare:  0.0002028942108154297
local_output_nid generation:  0.00016427040100097656
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0033507347106933594
local_output_nid generation:  0.00017333030700683594
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.0003559589385986328
r_  generation:  0.0033578872680664062
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.0003857612609863281
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.0033676624298095703
local_output_nid generation:  0.00017595291137695312
local_in_edges_tensor generation:  0.00038433074951171875
mini_batch_src_global generation:  0.00027561187744140625
r_  generation:  0.003347158432006836
----------------------check_connections_block total spend ----------------------------- 0.020094633102416992
generate_one_block  0.004396677017211914
generate_one_block  0.004465579986572266
generate_one_block  0.004957914352416992
generate_one_block  0.004155158996582031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

connection checking time:  0.06758761405944824
block generation total time  0.0673055648803711
average batch blocks generation time:  0.016826391220092773
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014086723327636719  GigaBytes
Max Memory Allocated: 0.014086723327636719  GigaBytes

torch.Size([2442, 1433])
torch.Size([2332, 16])
torch.Size([2035, 16])
torch.Size([1392, 16])
torch.Size([622, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.015894412994384766  GigaBytes
Max Memory Allocated: 0.01590108871459961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014300346374511719  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

torch.Size([2458, 1433])
torch.Size([2383, 16])
torch.Size([2197, 16])
torch.Size([1746, 16])
torch.Size([908, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016365528106689453  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014269828796386719  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

torch.Size([2470, 1433])
torch.Size([2368, 16])
torch.Size([2083, 16])
torch.Size([1353, 16])
torch.Size([581, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016064167022705078  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014290809631347656  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

torch.Size([2455, 1433])
torch.Size([2366, 16])
torch.Size([2141, 16])
torch.Size([1603, 16])
torch.Size([821, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016259193420410156  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004983007907867432 |0.08611428737640381 |0.1978510022163391 |0.00018328428268432617 |0.005075633525848389 |0.003448486328125 |
----------------------------------------------------------pseudo_mini_loss sum 3.8683571815490723
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37485
Number of first layer input nodes during this epoch:  9825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015204429626464844  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006170272827148438
range selection method range initialization spend 9.202957153320312e-05
time for parepare:  9.417533874511719e-05
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.130073547363281e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.678436279296875e-05
----------------------check_connections_block total spend ----------------------------- 0.0014767646789550781
generate_one_block  0.0013806819915771484
generate_one_block  0.001329183578491211
generate_one_block  0.00133514404296875
generate_one_block  0.0013232231140136719
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005917549133300781
gen group dst list time:  5.364418029785156e-05
time for parepare:  0.0002455711364746094
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.00044846534729003906
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.00042247772216796875
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006115436553955078
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0005507469177246094
----------------------check_connections_block total spend ----------------------------- 0.00404810905456543
generate_one_block  0.0017647743225097656
generate_one_block  0.0018157958984375
generate_one_block  0.0019259452819824219
generate_one_block  0.0018880367279052734
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006804466247558594
gen group dst list time:  0.00010919570922851562
time for parepare:  0.0002562999725341797
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0014035701751708984
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  0.00022363662719726562
r_  generation:  0.002855062484741211
local_output_nid generation:  0.00022149085998535156
local_in_edges_tensor generation:  0.0005292892456054688
mini_batch_src_global generation:  0.00032830238342285156
r_  generation:  0.003142118453979492
local_output_nid generation:  0.00016546249389648438
local_in_edges_tensor generation:  0.0004668235778808594
mini_batch_src_global generation:  0.0003101825714111328
r_  generation:  0.0029087066650390625
----------------------check_connections_block total spend ----------------------------- 0.01614689826965332
generate_one_block  0.004068136215209961
generate_one_block  0.003430604934692383
generate_one_block  0.003026247024536133
generate_one_block  0.0027306079864501953
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008318424224853516
gen group dst list time:  0.0001590251922607422
time for parepare:  0.00020360946655273438
local_output_nid generation:  0.00010275840759277344
local_in_edges_tensor generation:  0.00039505958557128906
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.002296924591064453
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0024056434631347656
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation: Using backend: pytorch
 0.0003101825714111328
mini_batch_src_global generation:  0.00023627281188964844
r_  generation:  0.002595663070678711
local_output_nid generation:  0.00012731552124023438
local_in_edges_tensor generation:  0.0003142356872558594
mini_batch_src_global generation:  0.00023555755615234375
r_  generation:  0.0025925636291503906
----------------------check_connections_block total spend ----------------------------- 0.015226602554321289
generate_one_block  0.004010438919067383
generate_one_block  0.0037484169006347656
generate_one_block  0.003909587860107422
generate_one_block  0.0035440921783447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008161067962646484
gen group dst list time:  0.00020003318786621094
time for parepare:  0.0001983642578125
local_output_nid generation:  0.0001461505889892578
local_in_edges_tensor generation:  0.0004837512969970703
mini_batch_src_global generation:  0.0002892017364501953
r_  generation:  0.003106355667114258
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.00037550926208496094
mini_batch_src_global generation:  0.00033855438232421875
r_  generation:  0.0031862258911132812
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.0002624988555908203
r_  generation:  0.0031862258911132812
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.00036597251892089844
mini_batch_src_global generation:  0.00026416778564453125
r_  generation:  0.003174304962158203
----------------------check_connections_block total spend ----------------------------- 0.019048213958740234
generate_one_block  0.004361152648925781
generate_one_block  0.004319667816162109
generate_one_block  0.004037141799926758
generate_one_block  0.00399017333984375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007596015930175781
gen group dst list time:  0.00023031234741210938
time for parepare:  0.0002071857452392578
local_output_nid generation:  0.00016808509826660156
local_in_edges_tensor generation:  0.0005164146423339844
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0033512115478515625
local_output_nid generation:  0.00017881393432617188
local_in_edges_tensor generation:  0.0003960132598876953
mini_batch_src_global generation:  0.0003178119659423828
r_  generation:  0.0033991336822509766
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.0003895759582519531
mini_batch_src_global generation:  0.00028395652770996094
r_  generation:  0.003391742706298828
local_output_nid generation:  0.00017571449279785156
local_in_edges_tensor generation:  0.0003859996795654297
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.0033435821533203125
----------------------check_connections_block total spend ----------------------------- 0.020075082778930664
generate_one_block  0.00438690185546875
generate_one_block  0.004207611083984375
generate_one_block  0.0043871402740478516
generate_one_block  0.004145145416259766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015204429626464844  GigaBytes
Max Memory Allocated: 0.02772378921508789  GigaBytes

connection checking time:  0.07454490661621094
block generation total time  0.06969761848449707
average batch blocks generation time:  0.017424404621124268
block dataloader generation time/epoch 0.17300105094909668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014645576477050781  GigaBytes
Max Memory Allocated: 0.02809286117553711  GigaBytes

torch.Size([2444, 1433])
torch.Size([2353, 16])
torch.Size([2094, 16])
torch.Size([1425, 16])
torch.Size([645, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01648712158203125  GigaBytes
Max Memory Allocated: 0.02809286117553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014650344848632812  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

torch.Size([2462, 1433])
torch.Size([2389, 16])
torch.Size([2156, 16])
torch.Size([1487, 16])
torch.Size([607, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016523361206054688  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014662742614746094  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

torch.Size([2462, 1433])
torch.Size([2381, 16])
torch.Size([2165, 16])
torch.Size([1616, 16])
torch.Size([761, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016637325286865234  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014664649963378906  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

torch.Size([2431, 1433])
torch.Size([2366, 16])
torch.Size([2160, 16])
torch.Size([1646, 16])
torch.Size([825, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016653060913085938  GigaBytes
Max Memory Allocated: 0.028093814849853516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0024704933166503906 |0.0009286403656005859 |0.006777763366699219 |0.00012570619583129883 |0.0043607354164123535 |0.0028967857360839844 |
----------------------------------------------------------pseudo_mini_loss sum 3.2137720584869385
Total (block generation + training)time/epoch 0.23943328857421875
Training time/epoch 0.06604313850402832
Training time without block to device /epoch 0.06232857704162598
Training time without total dataloading part /epoch 0.04795360565185547
load block tensor time/epoch 0.009881973266601562
block to device time/epoch 0.0037145614624023438
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37613
Number of first layer input nodes during this epoch:  9799
