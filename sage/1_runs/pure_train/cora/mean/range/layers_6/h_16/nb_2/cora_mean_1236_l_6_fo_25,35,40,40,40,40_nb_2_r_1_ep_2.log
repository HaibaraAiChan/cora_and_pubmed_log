main start at this time 1648433301.144836
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001291513442993164
range selection method range initialization spend 8.511543273925781e-05
time for parepare:  5.9604644775390625e-05
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.001310586929321289
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00011181831359863281
----------------------check_connections_block total spend ----------------------------- 0.0020935535430908203
generate_one_block  0.0013232231140136719
generate_one_block  0.0011858940124511719
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004942417144775391
gen group dst list time:  2.86102294921875e-05
time for parepare:  0.0001392364501953125
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006952285766601562
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0006108283996582031
----------------------check_connections_block total spend ----------------------------- 0.002398967742919922
generate_one_block  0.0019073486328125
generate_one_block  0.0016798973083496094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005869865417480469
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0003228187561035156
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0017511844635009766
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.0017447471618652344
----------------------check_connections_block total spend ----------------------------- 0.005566835403442383
generate_one_block  0.003009319305419922
generate_one_block  0.002874612808227539
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006210803985595703
gen group dst list time:  8.797645568847656e-05
time for parepare:  0.00018715858459472656
local_output_nid generation:  0.00012445449829101562
local_in_edges_tensor generation:  0.0004153251647949219
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0026667118072509766
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.0002684593200683594
r_  generation:  0.002624988555908203
----------------------check_connections_block total spend ----------------------------- 0.008108139038085938
generate_one_block  0.0039424896240234375
generate_one_block  0.003965854644775391
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007464885711669922
gen group dst list time:  0.00010347366333007812
time for parepare:  0.0001811981201171875
local_output_nid generation:  0.0001404285430908203
local_in_edges_tensor generation:  0.0004260540008544922
mini_batch_src_global generation:  0.00019931793212890625
r_  generation:  0.0030667781829833984
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003440380096435547
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.0030879974365234375
----------------------check_connections_block total spend ----------------------------- 0.009146928787231445
generate_one_block  0.004256725311279297
generate_one_block  0.004151344299316406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007495880126953125
gen group dst list time:  0.00011277198791503906
time for parepare:  0.00017452239990234375
local_output_nid generation:  0.00014925003051757812
local_in_edges_tensor generation:  0.0004398822784423828
mini_batch_src_global generation:  0.00020599365234375
r_  generation:  0.0031621456146240234
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  0.0002810955047607422
r_  generation:  0.003189563751220703
----------------------check_connections_block total spend ----------------------------- 0.009465217590332031
generate_one_block  0.004417896270751953
generate_one_block  0.00433039665222168
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00019216537475585938  GigaBytes
Max Memory Allocated: 0.00019216537475585938  GigaBytes

connection checking time:  0.03468608856201172
block generation total time  0.034535884857177734
average batch blocks generation time:  0.017267942428588867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014139652252197266  GigaBytes
Max Memory Allocated: 0.014139652252197266  GigaBytes

torch.Size([2503, 1433])
torch.Size([2455, 16])
torch.Size([2324, 16])
torch.Size([1957, 16])
torch.Size([1174, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.016449928283691406  GigaBytes
Max Memory Allocated: 0.01646566390991211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014320850372314453  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

torch.Size([2498, 1433])
torch.Size([2459, 16])
torch.Size([2343, 16])
torch.Size([1914, 16])
torch.Size([1113, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016582012176513672  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017679333686828613 |0.17152059078216553 |0.3875783681869507 |0.00018644332885742188 |0.006910443305969238 |0.0036656856536865234 |
----------------------------------------------------------pseudo_mini_loss sum 3.091935634613037
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21441
Number of first layer input nodes during this epoch:  5001
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015299320220947266  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006012916564941406
range selection method range initialization spend 9.584426879882812e-05
time for parepare:  0.00010085105895996094
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00013208389282226562
local_output_nid generation:  2.6941299438476562e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0005431175231933594
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0003769397735595703
----------------------check_connections_block total spend ----------------------------- 0.0022001266479492188
generate_one_block  0.002905130386352539
generate_one_block  0.002621889114379883
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001256704330444336
gen group dst list time:  6.842613220214844e-05
time for parepare:  0.0003199577331542969
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0004062652587890625
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.0013971328735351562
local_output_nid generation:  7.009506225585938e-05
local_in_edges_tensor generation:  0.0003495216369628906
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.0011622905731201172
----------------------check_connections_block total spend ----------------------------- 0.0047969818115234375
generate_one_block  0.0026748180389404297
generate_one_block  0.002796173095703125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0008504390716552734
gen group dst list time:  8.535385131835938e-05
time for parepare:  0.0002682209014892578
local_output_nid generation:  0.00010037422180175781
local_in_edges_tensor generation:  0.0004057884216308594
mini_batch_src_global generation:  0.0002295970916748047
r_  generation:  0.0017061233520507812
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  0.0002465248107910156
r_  generation:  0.0019500255584716797
----------------------check_connections_block total spend ----------------------------- 0.0062978267669677734
generate_one_block  0.0029020309448242188
generate_one_block  0.0031833648681640625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005977153778076172
gen group dst list time:  8.559226989746094e-05
time for parepare:  0.00018215179443359375
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.0003833770751953125
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.0025527477264404297
local_output_nid generation:  0.00012612342834472656
local_in_edges_tensor generation:  0.0003178119659423828
mini_batch_src_global generation:  0.0002980232238769531
r_  generation:  0.0026497840881347656
----------------------check_connections_block total spend ----------------------------- 0.008257627487182617
generate_one_block  0.004029035568237305
generate_one_block  0.003869771957397461
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007641315460205078
gen group dst list time:  0.00010442733764648438
time for parepare:  0.0001735687255859375
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.0004267692565917969
mini_batch_src_global generation:  0.00020551681518554688
r_  generation:  0.003002166748046875
local_output_nid generation:  0.00015544891357421875
local_in_edges_tensor generation:  0.0003514289855957031
mini_batch_src_global generation:  0.0003101825714111328
r_  generation:  0.0029802322387695312
----------------------check_connections_block total spend ----------------------------- 0.00912332534790039
generate_one_block  0.004174947738647461
generate_one_block  0.0045928955078125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007543563842773438
gen group dst list time:  0.00011205673217773438
time for parepare:  0.0001838207244873047
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.0004475116729736328
mini_batch_src_global generation:  0.0002002716064453125
r_  generation:  0.003064870834350586
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.00035119056701660156
mini_batch_src_global generation:  0.00026869773864746094
r_  generation:  0.0030677318572998047
----------------------check_connections_block total spend ----------------------------- 0.00921630859375
generate_one_block  0.0046346187591552734
generate_one_block  0.004231452941894531
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.015299320220947266  GigaBytes
Max Memory Allocated: 0.027725696563720703  GigaBytes

connection checking time:  0.03769207000732422
block generation total time  0.03708910942077637
average batch blocks generation time:  0.018544554710388184
block dataloader generation time/epoch 0.16477322578430176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014683246612548828  GigaBytes
Max Memory Allocated: 0.028094768524169922  GigaBytes

torch.Size([2506, 1433])
torch.Size([2455, 16])
torch.Size([2306, 16])
torch.Size([1830, 16])
torch.Size([994, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.016875267028808594  GigaBytes
Max Memory Allocated: 0.028094768524169922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014698505401611328  GigaBytes
Max Memory Allocated: 0.028095722198486328  GigaBytes

torch.Size([2481, 1433])
torch.Size([2433, 16])
torch.Size([2316, 16])
torch.Size([1955, 16])
torch.Size([1205, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.017011165618896484  GigaBytes
Max Memory Allocated: 0.028095722198486328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.004169344902038574 |0.0008054971694946289 |0.006013989448547363 |0.00012028217315673828 |0.005309343338012695 |0.0025300979614257812 |
----------------------------------------------------------pseudo_mini_loss sum 3.488962173461914
Total (block generation + training)time/epoch 0.2025902271270752
Training time/epoch 0.037567138671875
Training time without block to device /epoch 0.03595614433288574
Training time without total dataloading part /epoch 0.025417327880859375
load block tensor time/epoch 0.008338689804077148
block to device time/epoch 0.0016109943389892578
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21186
Number of first layer input nodes during this epoch:  4987
