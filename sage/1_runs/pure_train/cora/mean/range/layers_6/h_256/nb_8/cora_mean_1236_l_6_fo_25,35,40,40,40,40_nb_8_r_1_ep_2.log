main start at this time 1648433477.6285305
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0012590885162353516
range selection method range initialization spend 0.00010156631469726562
time for parepare:  9.512901306152344e-05
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00022482872009277344
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0018038749694824219
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.887580871582031e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.029273986816406e-05
----------------------check_connections_block total spend ----------------------------- 0.004338502883911133
generate_one_block  0.0015985965728759766
generate_one_block  0.0013768672943115234
generate_one_block  0.0013196468353271484
generate_one_block  0.0011138916015625
generate_one_block  0.0010802745819091797
generate_one_block  0.0010864734649658203
generate_one_block  0.001073598861694336
generate_one_block  0.0011105537414550781
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005743503570556641
gen group dst list time:  6.389617919921875e-05
time for parepare:  0.00016307830810546875
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003266334533691406
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.00025200843811035156
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00017118453979492188
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0003020763397216797
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00024175643920898438
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002636909484863281
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.0002353191375732422
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00012135505676269531
----------------------check_connections_block total spend ----------------------------- 0.004201412200927734
generate_one_block  0.0014491081237792969
generate_one_block  0.0013659000396728516
generate_one_block  0.001234292984008789
generate_one_block  0.0013747215270996094
generate_one_block  0.0013396739959716797
generate_one_block  0.0013422966003417969
generate_one_block  0.001375436782836914
generate_one_block  0.0011222362518310547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006999969482421875
gen group dst list time:  0.00010895729064941406
time for parepare:  0.00020623207092285156
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.00014638900756835938
r_  generation:  0.001055002212524414
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0008554458618164062
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006051063537597656
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0008909702301025391
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0008978843688964844
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  9.274482727050781e-05
r_  generation:  0.0007815361022949219
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0008385181427001953
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0003905296325683594
----------------------check_connections_block total spend ----------------------------- 0.010800361633300781
generate_one_block  0.0023040771484375
generate_one_block  0.0020601749420166016
generate_one_block  0.0015680789947509766
generate_one_block  0.0019752979278564453
generate_one_block  0.0019483566284179688
generate_one_block  0.0018811225891113281
generate_one_block  0.0018401145935058594
generate_one_block  0.0013699531555175781
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007674694061279297
gen group dst list time:  0.0001983642578125
time for parepare:  0.00020074844360351562
local_output_nid generation:  9.131431579589844e-05
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.0025484561920166016
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00028443336486816406
r_  generation:  0.0023221969604492188
local_output_nid generation:  0.0002808570861816406
local_in_edges_tensor generation:  0.0004246234893798828
mini_batch_src_global generation:  0.000347137451171875
r_  generation:  0.0018770694732666016
local_output_nid generation:  0.00014662742614746094
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.00023317337036132812
r_  generation:  0.0019702911376953125
local_output_nid generation:  0.0001323223114013672
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.00019860267639160156
r_  generation:  0.0019440650939941406
local_output_nid generation:  9.799003601074219e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0016024112701416016
local_output_nid generation:  0.00010466575622558594
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.001631021499633789
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.0001811981201171875
mini_batch_src_global generation:  0.00012230873107910156
r_  generation:  0.001056671142578125
----------------------check_connections_block total spend ----------------------------- 0.024000167846679688
generate_one_block  0.0039484500885009766
generate_one_block  0.0030570030212402344
generate_one_block  0.0025587081909179688
generate_one_block  0.0029098987579345703
generate_one_block  0.0033071041107177734
generate_one_block  0.002709627151489258
generate_one_block  0.0028352737426757812
generate_one_block  0.0021767616271972656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008335113525390625
gen group dst list time:  0.0003428459167480469
time for parepare:  0.00018858909606933594
local_output_nid generation:  0.00013446807861328125
local_in_edges_tensor generation:  0.0005047321319580078
mini_batch_src_global generation:  0.00027298927307128906
r_  generation:  0.0028314590454101562
local_output_nid generation:  0.00014138221740722656
local_in_edges_tensor generation:  0.0003387928009033203
mini_batch_src_global generation:  0.00030875205993652344
r_  generation:  0.0027871131896972656
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0025124549865722656
local_output_nid generation:  0.0001392364501953125
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.002735614776611328
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.0028526782989501953
local_output_nid generation:  0.00013208389282226562
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0025756359100341797
local_output_nid generation:  0.00013875961303710938
local_in_edges_tensor generation:  0.0003287792205810547
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.002516508102416992
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.0001914501190185547
r_  generation:  0.002003192901611328
----------------------check_connections_block total spend ----------------------------- 0.03142237663269043
generate_one_block  0.004255771636962891
generate_one_block  0.003826141357421875
generate_one_block  0.0035703182220458984
generate_one_block  0.004351377487182617
generate_one_block  0.004617214202880859
generate_one_block  0.003572225570678711
generate_one_block  0.003712177276611328
generate_one_block  0.0032033920288085938
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008156299591064453
gen group dst list time:  0.00040602684020996094
time for parepare:  0.00019884109497070312
local_output_nid generation:  0.0001556873321533203
local_in_edges_tensor generation:  0.0005021095275878906
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.0031425952911376953
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.00037288665771484375
mini_batch_src_global generation:  0.0003273487091064453
r_  generation:  0.0032014846801757812
local_output_nid generation:  0.00017523765563964844
local_in_edges_tensor generation:  0.00035643577575683594
mini_batch_src_global generation:  0.00026154518127441406
r_  generation:  0.003116130828857422
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.0031280517578125
local_output_nid generation:  0.00017118453979492188
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.00024771690368652344
r_  generation:  0.0030393600463867188
local_output_nid generation:  0.00015091896057128906
local_in_edges_tensor generation:  0.00032806396484375
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.002810955047607422
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.00033783912658691406
mini_batch_src_global generation:  0.00024580955505371094
r_  generation:  0.0030105113983154297
local_output_nid generation:  0.00014591217041015625
local_in_edges_tensor generation:  0.0003108978271484375
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.002649545669555664
----------------------check_connections_block total spend ----------------------------- 0.03581953048706055
generate_one_block  0.005058765411376953
generate_one_block  0.004126071929931641
generate_one_block  0.004328727722167969
generate_one_block  0.004095554351806641
generate_one_block  0.004152059555053711
generate_one_block  0.004000663757324219
generate_one_block  0.004119873046875
generate_one_block  0.00402069091796875
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

connection checking time:  0.10624384880065918
block generation total time  0.11406469345092773
average batch blocks generation time:  0.014258086681365967
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.01769399642944336  GigaBytes
Max Memory Allocated: 0.01769399642944336  GigaBytes

torch.Size([2390, 1433])
torch.Size([2253, 256])
torch.Size([1963, 256])
torch.Size([1324, 256])
torch.Size([563, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0413517951965332  GigaBytes
Max Memory Allocated: 0.041471004486083984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02263784408569336  GigaBytes
Max Memory Allocated: 0.042733192443847656  GigaBytes

torch.Size([2436, 1433])
torch.Size([2271, 256])
torch.Size([1906, 256])
torch.Size([1154, 256])
torch.Size([485, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.04583120346069336  GigaBytes
Max Memory Allocated: 0.045917510986328125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.022437095642089844  GigaBytes
Max Memory Allocated: 0.04638528823852539  GigaBytes

torch.Size([2403, 1433])
torch.Size([2211, 256])
torch.Size([1680, 256])
torch.Size([876, 256])
torch.Size([323, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.04184865951538086  GigaBytes
Max Memory Allocated: 0.04638528823852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.022498130798339844  GigaBytes
Max Memory Allocated: 0.04638528823852539  GigaBytes

torch.Size([2410, 1433])
torch.Size([2256, 256])
torch.Size([1849, 256])
torch.Size([1139, 256])
torch.Size([460, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.044727325439453125  GigaBytes
Max Memory Allocated: 0.04638528823852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02256917953491211  GigaBytes
Max Memory Allocated: 0.04638528823852539  GigaBytes

torch.Size([2422, 1433])
torch.Size([2303, 256])
torch.Size([1963, 256])
torch.Size([1247, 256])
torch.Size([474, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04597330093383789  GigaBytes
Max Memory Allocated: 0.04638528823852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02237987518310547  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

torch.Size([2351, 1433])
torch.Size([2182, 256])
torch.Size([1723, 256])
torch.Size([1004, 256])
torch.Size([423, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04275655746459961  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.022482872009277344  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

torch.Size([2408, 1433])
torch.Size([2264, 256])
torch.Size([1842, 256])
torch.Size([1074, 256])
torch.Size([441, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04400777816772461  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.022342681884765625  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

torch.Size([2309, 1433])
torch.Size([2002, 256])
torch.Size([1400, 256])
torch.Size([637, 256])
torch.Size([190, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03827810287475586  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005297333002090454 |0.04374542832374573 |0.10274067521095276 |0.00013807415962219238 |0.005690246820449829 |0.0037064552307128906 |
----------------------------------------------------------pseudo_mini_loss sum 3.3996331691741943
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  63760
Number of first layer input nodes during this epoch:  19129
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.032106876373291016  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005571842193603516
range selection method range initialization spend 7.843971252441406e-05
time for parepare:  7.796287536621094e-05
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.4332275390625e-05
----------------------check_connections_block total spend ----------------------------- 0.001817464828491211
generate_one_block  0.0011119842529296875
generate_one_block  0.0010590553283691406
generate_one_block  0.001024484634399414
generate_one_block  0.0010194778442382812
generate_one_block  0.0010349750518798828
generate_one_block  0.0010504722595214844
generate_one_block  0.00102996826171875
generate_one_block  0.0010259151458740234
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004932880401611328
gen group dst list time:  5.793571472167969e-05
time for parepare:  0.00016045570373535156
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0002658367156982422
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00018358230590820312
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00019478797912597656
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.00021696090698242188
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00030422210693359375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00022149085998535156
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00021505355834960938
----------------------check_connections_block total spend ----------------------------- 0.004083156585693359
generate_one_block  0.001422882080078125
generate_one_block  0.0012793540954589844
generate_one_block  0.0012385845184326172
generate_one_block  0.0012133121490478516
generate_one_block  0.0012640953063964844
generate_one_block  0.0013720989227294922
generate_one_block  0.0012259483337402344
generate_one_block  0.0012047290802001953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006542205810546875
gen group dst list time:  0.00010347366333007812
time for parepare:  0.00019812583923339844
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0008728504180908203
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0008053779602050781
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  9.441375732421875e-05
r_  generation:  0.0006182193756103516
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0006470680236816406
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0007767677307128906
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0001742839813232422
mini_batch_src_global generation:  0.00010609626770019531
r_  generation:  0.0009207725524902344
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0007078647613525391
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.00069427490234375
----------------------check_connections_block total spend ----------------------------- 0.010431528091430664
generate_one_block  0.0020704269409179688
generate_one_block  0.0019626617431640625
generate_one_block  0.0016274452209472656
generate_one_block  0.001644134521484375
generate_one_block  0.0018908977508544922
generate_one_block  0.0020596981048583984
generate_one_block  0.0017342567443847656
generate_one_block  0.0016896724700927734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007264614105224609
gen group dst list time:  0.00020456314086914062
time for parepare:  0.00019550323486328125
local_output_nid generation:  8.082389831542969e-05
local_in_edges_tensor generation:  0.0003733634948730469
mini_batch_src_global generation:  0.00019884109497070312
r_  generation:  0.0019214153289794922
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.0018095970153808594
local_output_nid generation:  7.581710815429688e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0016026496887207031
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.0017104148864746094
local_output_nid generation:  8.940696716308594e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00017523765563964844
r_  generation:  0.0018620491027832031
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0019359588623046875
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0018317699432373047
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  0.00015878677368164062
r_  generation:  0.001543283462524414
----------------------check_connections_block total spend ----------------------------- 0.0219571590423584
generate_one_block  0.0030870437622070312
generate_one_block  0.002833843231201172
generate_one_block  0.002630472183227539
generate_one_block  0.002771139144897461
generate_one_block  0.002902984619140625
generate_one_block  0.0031752586364746094
generate_one_block  0.0028862953186035156
generate_one_block  0.00262451171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007393360137939453
gen group dst list time:  0.0003399848937988281
time for parepare:  0.00020122528076171875
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0004775524139404297
mini_batch_src_global generation:  0.00026035308837890625
r_  generation:  0.0028028488159179688
local_output_nid generation:  0.0001399517059326172
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.0027365684509277344
local_output_nid generation:  0.00012946128845214844
local_in_edges_tensor generation:  0.00030231475830078125
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0025022029876708984
local_output_nid generation:  0.00016045570373535156
local_in_edges_tensor generation:  0.00038313865661621094
mini_batch_src_global generation:  0.00029087066650390625
r_  generation:  0.0033617019653320312
local_output_nid generation:  0.00019979476928710938
local_in_edges_tensor generation:  0.0003886222839355469
mini_batch_src_global generation:  0.0003046989440917969
r_  generation:  0.002991914749145508
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  0.00022149085998535156
r_  generation:  0.0025038719177246094
local_output_nid generation:  0.0001354217529296875
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.002569437026977539
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  0.00020933151245117188
r_  generation:  0.002283811569213867
----------------------check_connections_block total spend ----------------------------- 0.032979726791381836
generate_one_block  0.003916025161743164
generate_one_block  0.0039789676666259766
generate_one_block  0.0035047531127929688
generate_one_block  0.0036716461181640625
generate_one_block  0.003742218017578125
generate_one_block  0.003658771514892578
generate_one_block  0.0040705204010009766
generate_one_block  0.003507375717163086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007688999176025391
gen group dst list time:  0.0005779266357421875
time for parepare:  0.00023555755615234375
local_output_nid generation:  0.00021719932556152344
local_in_edges_tensor generation:  0.0005915164947509766
mini_batch_src_global generation:  0.0003304481506347656
r_  generation:  0.0038595199584960938
local_output_nid generation:  0.00023293495178222656
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0003936290740966797
r_  generation:  0.0038199424743652344
local_output_nid generation:  0.0002186298370361328
local_in_edges_tensor generation:  0.0004253387451171875
mini_batch_src_global generation:  0.00033736228942871094
r_  generation:  0.003092050552368164
local_output_nid generation:  0.00016880035400390625
local_in_edges_tensor generation:  0.0003604888916015625
mini_batch_src_global generation:  0.00025725364685058594
r_  generation:  0.003167390823364258
local_output_nid generation:  0.000171661376953125
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.0002636909484863281
r_  generation:  0.0031108856201171875
local_output_nid generation:  0.000156402587890625
local_in_edges_tensor generation:  0.0003361701965332031
mini_batch_src_global generation:  0.00024056434631347656
r_  generation:  0.002828359603881836
local_output_nid generation:  0.00015997886657714844Using backend: pytorch

local_in_edges_tensor generation:  0.0003466606140136719
mini_batch_src_global generation:  0.0002493858337402344
r_  generation:  0.002938985824584961
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.00031876564025878906
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.002713441848754883
----------------------check_connections_block total spend ----------------------------- 0.03855013847351074
generate_one_block  0.004259586334228516
generate_one_block  0.004058837890625
generate_one_block  0.0043027400970458984
generate_one_block  0.004116535186767578
generate_one_block  0.004152059555053711
generate_one_block  0.003976106643676758
generate_one_block  0.0044062137603759766
generate_one_block  0.0038635730743408203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.032106876373291016  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

connection checking time:  0.108001708984375
block generation total time  0.11099767684936523
average batch blocks generation time:  0.013874709606170654
block dataloader generation time/epoch 0.25436949729919434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03199338912963867  GigaBytes
Max Memory Allocated: 0.04652261734008789  GigaBytes

torch.Size([2424, 1433])
torch.Size([2282, 256])
torch.Size([1916, 256])
torch.Size([1182, 256])
torch.Size([488, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.05552387237548828  GigaBytes
Max Memory Allocated: 0.05561208724975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03190946578979492  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2409, 1433])
torch.Size([2256, 256])
torch.Size([1867, 256])
torch.Size([1093, 256])
torch.Size([415, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.05353260040283203  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03178691864013672  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2334, 1433])
torch.Size([2130, 256])
torch.Size([1678, 256])
torch.Size([944, 256])
torch.Size([327, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.05141639709472656  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03195524215698242  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2419, 1433])
torch.Size([2265, 256])
torch.Size([1829, 256])
torch.Size([1005, 256])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.052965641021728516  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.032050132751464844  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2435, 1433])
torch.Size([2303, 256])
torch.Size([1902, 256])
torch.Size([1151, 256])
torch.Size([444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05505847930908203  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03181266784667969  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2366, 1433])
torch.Size([2213, 256])
torch.Size([1850, 256])
torch.Size([1199, 256])
torch.Size([491, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.054813385009765625  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03193521499633789  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2414, 1433])
torch.Size([2286, 256])
torch.Size([1889, 256])
torch.Size([1125, 256])
torch.Size([345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05470848083496094  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03178882598876953  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

torch.Size([2319, 1433])
torch.Size([2084, 256])
torch.Size([1650, 256])
torch.Size([916, 256])
torch.Size([366, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05145072937011719  GigaBytes
Max Memory Allocated: 0.0560760498046875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0036601722240448 |0.0009344518184661865 |0.0071846842765808105 |0.00012123584747314453 |0.005023539066314697 |0.0029420852661132812 |
----------------------------------------------------------pseudo_mini_loss sum 3.1032259464263916
Total (block generation + training)time/epoch 0.4034454822540283
Training time/epoch 0.14871716499328613
Training time without block to device /epoch 0.14124155044555664
Training time without total dataloading part /epoch 0.1015777587890625
load block tensor time/epoch 0.0292813777923584
block to device time/epoch 0.007475614547729492
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64118
Number of first layer input nodes during this epoch:  19120
