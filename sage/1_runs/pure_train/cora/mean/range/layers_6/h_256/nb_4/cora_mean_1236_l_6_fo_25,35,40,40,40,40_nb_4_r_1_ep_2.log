main start at this time 1648433468.1205847
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.001516103744506836
range selection method range initialization spend 7.772445678710938e-05
time for parepare:  5.984306335449219e-05
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0024709701538085938
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.628036499023438e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.0036911964416503906
generate_one_block  0.0014805793762207031
generate_one_block  0.0010445117950439453
generate_one_block  0.00103759765625
generate_one_block  0.0010175704956054688
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005009174346923828
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0001418590545654297
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00048351287841796875
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00040030479431152344
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.00038814544677734375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.0003032684326171875
----------------------check_connections_block total spend ----------------------------- 0.003030061721801758
generate_one_block  0.0015130043029785156
generate_one_block  0.001421213150024414
generate_one_block  0.0014259815216064453
generate_one_block  0.0013620853424072266
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005652904510498047
gen group dst list time:  7.700920104980469e-05
time for parepare:  0.00016832351684570312
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0002834796905517578
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0013625621795654297
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.001252889633178711
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.00115203857421875
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.0010128021240234375
----------------------check_connections_block total spend ----------------------------- 0.007729291915893555
generate_one_block  0.0025887489318847656
generate_one_block  0.0024390220642089844
generate_one_block  0.0023093223571777344
generate_one_block  0.0021500587463378906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007426738739013672
gen group dst list time:  0.000133514404296875
time for parepare:  0.00018310546875
local_output_nid generation:  0.00010514259338378906
local_in_edges_tensor generation:  0.0004246234893798828
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.002445220947265625
local_output_nid generation:  0.00010704994201660156
local_in_edges_tensor generation:  0.0002830028533935547
mini_batch_src_global generation:  0.0002429485321044922
r_  generation:  0.0023005008697509766
local_output_nid generation:  0.00010180473327636719
local_in_edges_tensor generation:  0.0002684593200683594
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.0021562576293945312
local_output_nid generation:  9.775161743164062e-05
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  0.00018906593322753906
r_  generation:  0.002063274383544922
----------------------check_connections_block total spend ----------------------------- 0.013694047927856445
generate_one_block  0.003576040267944336
generate_one_block  0.00351715087890625
generate_one_block  0.003522634506225586
generate_one_block  0.003293752670288086
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007960796356201172
gen group dst list time:  0.0001842975616455078
time for parepare:  0.00017762184143066406
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.00046324729919433594
mini_batch_src_global generation:  0.0002086162567138672
r_  generation:  0.0028634071350097656
local_output_nid generation:  0.00014352798461914062
local_in_edges_tensor generation:  0.00034236907958984375
mini_batch_src_global generation:  0.00034618377685546875
r_  generation:  0.0029230117797851562
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.00034308433532714844
mini_batch_src_global generation:  0.00023818016052246094
r_  generation:  0.0028259754180908203
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.0002372264862060547
r_  generation:  0.0028619766235351562
----------------------check_connections_block total spend ----------------------------- 0.017426490783691406
generate_one_block  0.004202842712402344
generate_one_block  0.0040781497955322266
generate_one_block  0.003914356231689453
generate_one_block  0.003954887390136719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007524490356445312
gen group dst list time:  0.00021409988403320312
time for parepare:  0.00018358230590820312
local_output_nid generation:  0.000148773193359375
local_in_edges_tensor generation:  0.0004811286926269531
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.0030181407928466797
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.00035119056701660156
mini_batch_src_global generation:  0.0003147125244140625
r_  generation:  0.0030608177185058594
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.0002644062042236328
r_  generation:  0.0030088424682617188
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00034356117248535156
mini_batch_src_global generation:  0.0002503395080566406
r_  generation:  0.002998828887939453
----------------------check_connections_block total spend ----------------------------- 0.01820826530456543
generate_one_block  0.004495143890380859
generate_one_block  0.004317283630371094
generate_one_block  0.00411677360534668
generate_one_block  0.004126071929931641
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0389404296875 GB
    Memory Allocated: 0.004721164703369141  GigaBytes
Max Memory Allocated: 0.004721164703369141  GigaBytes

connection checking time:  0.060088157653808594
block generation total time  0.06232452392578125
average batch blocks generation time:  0.015581130981445312
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.018031597137451172  GigaBytes
Max Memory Allocated: 0.018031597137451172  GigaBytes

torch.Size([2447, 1433])
torch.Size([2378, 256])
torch.Size([2201, 256])
torch.Size([1697, 256])
torch.Size([870, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3123779296875 GB
    Memory Allocated: 0.04655742645263672  GigaBytes
Max Memory Allocated: 0.04675579071044922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.023787975311279297  GigaBytes
Max Memory Allocated: 0.04787111282348633  GigaBytes

torch.Size([2475, 1433])
torch.Size([2412, 256])
torch.Size([2200, 256])
torch.Size([1629, 256])
torch.Size([764, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.051835060119628906  GigaBytes
Max Memory Allocated: 0.052010536193847656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.023627758026123047  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

torch.Size([2426, 1433])
torch.Size([2330, 256])
torch.Size([2097, 256])
torch.Size([1527, 256])
torch.Size([725, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04965686798095703  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.02356863021850586  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

torch.Size([2437, 1433])
torch.Size([2355, 256])
torch.Size([2102, 256])
torch.Size([1424, 256])
torch.Size([601, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.04885244369506836  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006482541561126709 |0.0859498381614685 |0.20045113563537598 |0.00017577409744262695 |0.006085515022277832 |0.004154682159423828 |
----------------------------------------------------------pseudo_mini_loss sum 3.886104106903076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37829
Number of first layer input nodes during this epoch:  9785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03365325927734375  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00044798851013183594
range selection method range initialization spend 5.888938903808594e-05
time for parepare:  6.318092346191406e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  5.459785461425781e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  6.222724914550781e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  7.271766662597656e-05
----------------------check_connections_block total spend ----------------------------- 0.0011153221130371094
generate_one_block  0.0010831356048583984
generate_one_block  0.0010519027709960938
generate_one_block  0.0010311603546142578
generate_one_block  0.0010247230529785156
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004639625549316406
gen group dst list time:  3.695487976074219e-05
time for parepare:  0.00015115737915039062
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00040411949157714844
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0002970695495605469
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0003914833068847656
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00042247772216796875
----------------------check_connections_block total spend ----------------------------- 0.0029935836791992188
generate_one_block  0.0014553070068359375
generate_one_block  0.0013475418090820312
generate_one_block  0.0014188289642333984
generate_one_block  0.0014445781707763672
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005359649658203125
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.00017881393432617188
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0002574920654296875
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.0012505054473876953
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0008985996246337891
local_output_nid generation:  5.936622619628906e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0012784004211425781
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0001850128173828125
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.001252889633178711
----------------------check_connections_block total spend ----------------------------- 0.0076236724853515625
generate_one_block  0.002432107925415039
generate_one_block  0.0020029544830322266
generate_one_block  0.002441883087158203
generate_one_block  0.002325773239135742
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007352828979492188
gen group dst list time:  0.00013256072998046875
time for parepare:  0.00017309188842773438
local_output_nid generation:  0.0001010894775390625
local_in_edges_tensor generation:  0.00041031837463378906
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0023088455200195312
local_output_nid generation:  9.202957153320312e-05
local_in_edges_tensor generation:  0.00025200843811035156
mini_batch_src_global generation:  0.00020313262939453125
r_  generation:  0.001931905746459961
local_output_nid generation:  0.00011181831359863281
local_in_edges_tensor generation: Using backend: pytorch
 0.00028014183044433594
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0023479461669921875
local_output_nid generation:  0.00010728836059570312
local_in_edges_tensor generation:  0.00027108192443847656
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.0022792816162109375
----------------------check_connections_block total spend ----------------------------- 0.013673067092895508
generate_one_block  0.0035703182220458984
generate_one_block  0.0031499862670898438
generate_one_block  0.003694772720336914
generate_one_block  0.0037157535552978516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000762939453125
gen group dst list time:  0.00018548965454101562
time for parepare:  0.00018262863159179688
local_output_nid generation:  0.00014090538024902344
local_in_edges_tensor generation:  0.0004992485046386719
mini_batch_src_global generation:  0.00025963783264160156
r_  generation:  0.002925872802734375
local_output_nid generation:  0.00013256072998046875
local_in_edges_tensor generation:  0.000316619873046875
mini_batch_src_global generation:  0.00028061866760253906
r_  generation:  0.002643585205078125
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.00033164024353027344
mini_batch_src_global generation:  0.00024509429931640625
r_  generation:  0.002908468246459961
local_output_nid generation:  0.00014519691467285156
local_in_edges_tensor generation:  0.00032711029052734375
mini_batch_src_global generation:  0.00023651123046875
r_  generation:  0.0028731822967529297
----------------------check_connections_block total spend ----------------------------- 0.01721024513244629
generate_one_block  0.004125833511352539
generate_one_block  0.003937721252441406
generate_one_block  0.003989219665527344
generate_one_block  0.004021167755126953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007500648498535156
gen group dst list time:  0.00021219253540039062
time for parepare:  0.0001766681671142578
local_output_nid generation:  0.000152587890625
local_in_edges_tensor generation:  0.0004782676696777344
mini_batch_src_global generation:  0.00021767616271972656
r_  generation:  0.00310516357421875
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.000339508056640625
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.002937793731689453
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0003476142883300781
mini_batch_src_global generation:  0.00025153160095214844
r_  generation:  0.0030448436737060547
local_output_nid generation:  0.0001583099365234375
local_in_edges_tensor generation:  0.00034308433532714844
mini_batch_src_global generation:  0.0002510547637939453
r_  generation:  0.0030167102813720703
----------------------check_connections_block total spend ----------------------------- 0.018106937408447266
generate_one_block  0.004731655120849609
generate_one_block  0.004206180572509766
generate_one_block  0.0041828155517578125
generate_one_block  0.0041425228118896484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.03365325927734375  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

connection checking time:  0.059607505798339844
block generation total time  0.06233692169189453
average batch blocks generation time:  0.015584230422973633
block dataloader generation time/epoch 0.14643263816833496
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3201904296875 GB
    Memory Allocated: 0.0334467887878418  GigaBytes
Max Memory Allocated: 0.05254173278808594  GigaBytes

torch.Size([2491, 1433])
torch.Size([2431, 256])
torch.Size([2237, 256])
torch.Size([1644, 256])
torch.Size([767, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.06133079528808594  GigaBytes
Max Memory Allocated: 0.061507225036621094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03312873840332031  GigaBytes
Max Memory Allocated: 0.06203937530517578  GigaBytes

torch.Size([2433, 1433])
torch.Size([2309, 256])
torch.Size([1993, 256])
torch.Size([1324, 256])
torch.Size([549, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.05720186233520508  GigaBytes
Max Memory Allocated: 0.06203937530517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03338289260864258  GigaBytes
Max Memory Allocated: 0.06203937530517578  GigaBytes

torch.Size([2479, 1433])
torch.Size([2414, 256])
torch.Size([2195, 256])
torch.Size([1661, 256])
torch.Size([808, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.06156301498413086  GigaBytes
Max Memory Allocated: 0.06203937530517578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.03381681442260742  GigaBytes
Max Memory Allocated: 0.06238222122192383  GigaBytes

torch.Size([2459, 1433])
torch.Size([2387, 256])
torch.Size([2189, 256])
torch.Size([1572, 256])
torch.Size([714, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06154441833496094  GigaBytes
Max Memory Allocated: 0.06238222122192383  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003997325897216797 |0.0008538365364074707 |0.006502091884613037 |0.00010710954666137695 |0.004378259181976318 |0.002865314483642578 |
----------------------------------------------------------pseudo_mini_loss sum 3.4278595447540283
Total (block generation + training)time/epoch 0.21695876121520996
Training time/epoch 0.07030820846557617
Training time without block to device /epoch 0.06689286231994629
Training time without total dataloading part /epoch 0.04681515693664551
load block tensor time/epoch 0.015989303588867188
block to device time/epoch 0.003415346145629883
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37793
Number of first layer input nodes during this epoch:  9862
