main start at this time 1648433379.94275
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0013275146484375
range selection method range initialization spend 0.00010585784912109375
time for parepare:  6.29425048828125e-05
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0036263465881347656
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00011968612670898438
----------------------check_connections_block total spend ----------------------------- 0.004422664642333984
generate_one_block  0.0014388561248779297
generate_one_block  0.0011544227600097656
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005068778991699219
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.00013589859008789062
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.0006554126739501953
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  7.82012939453125e-05
r_  generation:  0.0006213188171386719
----------------------check_connections_block total spend ----------------------------- 0.0023255348205566406
generate_one_block  0.001775979995727539
generate_one_block  0.0016999244689941406
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005314350128173828
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.00017118453979492188
local_output_nid generation:  6.818771362304688e-05
local_in_edges_tensor generation:  0.0002894401550292969
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0017178058624267578
local_output_nid generation:  6.937980651855469e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.001628875732421875
----------------------check_connections_block total spend ----------------------------- 0.005311489105224609
generate_one_block  0.002905130386352539
generate_one_block  0.0028586387634277344
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005710124969482422
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.00016927719116210938
local_output_nid generation:  0.00011229515075683594
local_in_edges_tensor generation:  0.00037360191345214844
mini_batch_src_global generation:  0.00021219253540039062
r_  generation:  0.0026063919067382812
local_output_nid generation:  0.00011849403381347656
local_in_edges_tensor generation:  0.00029397010803222656
mini_batch_src_global generation:  0.00024318695068359375
r_  generation:  0.0025811195373535156
----------------------check_connections_block total spend ----------------------------- 0.007941007614135742
generate_one_block  0.0038919448852539062
generate_one_block  0.003950595855712891
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007388591766357422
gen group dst list time:  0.00010561943054199219
time for parepare:  0.0001823902130126953
local_output_nid generation:  0.00014543533325195312
local_in_edges_tensor generation:  0.0004696846008300781
mini_batch_src_global generation:  0.00021576881408691406
r_  generation:  0.0031239986419677734
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.0003483295440673828
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.0031342506408691406
----------------------check_connections_block total spend ----------------------------- 0.00932765007019043
generate_one_block  0.004301309585571289
generate_one_block  0.004263877868652344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006251335144042969
gen group dst list time:  0.00011491775512695312
time for parepare:  0.00019407272338867188
local_output_nid generation:  0.00014853477478027344
local_in_edges_tensor generation:  0.0004897117614746094
mini_batch_src_global generation:  0.00021576881408691406
r_  generation:  0.0032241344451904297
local_output_nid generation:  0.00016355514526367188
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0002841949462890625
r_  generation:  0.0030879974365234375
----------------------check_connections_block total spend ----------------------------- 0.009556055068969727
generate_one_block  0.005040884017944336
generate_one_block  0.0041370391845703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

connection checking time:  0.03446173667907715
block generation total time  0.03482532501220703
average batch blocks generation time:  0.017412662506103516
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.01476144790649414  GigaBytes
Max Memory Allocated: 0.01476144790649414  GigaBytes

torch.Size([2494, 1433])
torch.Size([2440, 64])
torch.Size([2291, 64])
torch.Size([1889, 64])
torch.Size([1119, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.02272653579711914  GigaBytes
Max Memory Allocated: 0.02280426025390625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.015574932098388672  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

torch.Size([2465, 1433])
torch.Size([2408, 64])
torch.Size([2256, 64])
torch.Size([1873, 64])
torch.Size([1062, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.023374557495117188  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015534043312072754 |0.1695481538772583 |0.3847438097000122 |0.00021922588348388672 |0.008046746253967285 |0.0035605430603027344 |
----------------------------------------------------------pseudo_mini_loss sum 3.573060989379883
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  20990
Number of first layer input nodes during this epoch:  4959
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01780080795288086  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005896091461181641
range selection method range initialization spend 9.1552734375e-05
time for parepare:  9.751319885253906e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  2.4318695068359375e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.0001761913299560547
----------------------check_connections_block total spend ----------------------------- 0.0012242794036865234
generate_one_block  0.0014808177947998047
generate_one_block  0.001453399658203125
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005815029144287109
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.0002124309539794922
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0002415180206298828
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0008466243743896484
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.0009210109710693359
----------------------check_connections_block total spend ----------------------------- 0.0032727718353271484
generate_one_block  0.0023610591888427734
generate_one_block  0.0022749900817871094
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000675201416015625
gen group dst list time:  8.106231689453125e-05
time for parepare:  0.000240325927734375
local_output_nid generation:  0.00010347366333007812
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.00023102760314941406
r_  generation:  0.0019366741180419922
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.001903533935546875
----------------------check_connections_block total spend ----------------------------- 0.006334066390991211
generate_one_block  0.003226757049560547
generate_one_block  0.0032057762145996094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006330013275146484
gen group dst list time:  9.393692016601562e-05
time for parepare:  0.00019216537475585938
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.00040531158447265625
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.0029630661010742188
local_output_nid generation:  0.00013780593872070312
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.000324249267578125
r_  generation:  0.0028600692749023438
----------------------check_connections_block total spend ----------------------------- 0.00909733772277832
generate_one_block  0.004270076751708984
generate_one_block  0.00390625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007002353668212891
gen group dst list time:  0.0001163482666015625
time for parepare:  0.0002067089080810547
local_output_nid generation:  0.00016021728515625
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.003408670425415039
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.00037097930908203125
mini_batch_src_global generation:  0.00033783912658691406
r_  generation:  0.0032682418823242188
----------------------check_connections_block total spend ----------------------------- 0.010112285614013672
generate_one_block  0.004625558853149414
generate_one_block  0.004758119583129883
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007975101470947266
gen group dst list time:  0.0001239776611328125
time for parepare:  0.00019669532775878906
local_output_nid generation:  0.00016617774963378906
local_in_edges_tensor generation:  0.0005004405975341797
mini_batch_src_global generation:  0.00023031234741210938
r_  generation:  0.0034694671630859375
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.00034618377685546875
r_  generation:  0.003389120101928711
----------------------check_connections_block total spend ----------------------------- 0.010442972183227539
generate_one_block  0.004708766937255859
generate_one_block  0.00416874885559082
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01780080795288086  GigaBytes
Max Memory Allocated: 0.028984546661376953  GigaBytes

connection checking time:  0.03925943374633789
block generation total time  0.037506103515625
average batch blocks generation time:  0.0187530517578125
block dataloader generation time/epoch 0.11132216453552246
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017212390899658203  GigaBytes
Max Memory Allocated: 0.030612468719482422  GigaBytes

torch.Size([2503, 1433])
torch.Size([2462, 64])
torch.Size([2351, 64])
torch.Size([1943, 64])
torch.Size([1139, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.02531576156616211  GigaBytes
Max Memory Allocated: 0.030612468719482422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.017207622528076172  GigaBytes
Max Memory Allocated: 0.030613422393798828  GigaBytes

torch.Size([2485, 1433])
torch.Size([2410, 64])
torch.Size([2267, 64])
torch.Size([1886, 64])
torch.Size([1123, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.025122642517089844  GigaBytes
Max Memory Allocated: 0.030613422393798828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002288341522216797 |0.0009812116622924805 |0.007246255874633789 |0.00014674663543701172 |0.00405120849609375 |0.0027925968170166016 |
----------------------------------------------------------pseudo_mini_loss sum 3.4257445335388184
Total (block generation + training)time/epoch 0.14682722091674805
Training time/epoch 0.03531026840209961
Training time without block to device /epoch 0.03334784507751465
Training time without total dataloading part /epoch 0.025681018829345703
load block tensor time/epoch 0.004576683044433594
block to device time/epoch 0.001962423324584961
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21263
Number of first layer input nodes during this epoch:  4988
