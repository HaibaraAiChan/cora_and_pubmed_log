main start at this time 1648433389.257493
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0014657974243164062
range selection method range initialization spend 0.0001304149627685547
time for parepare:  8.177757263183594e-05
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.003987312316894531
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00011348724365234375
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.700920104980469e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.05718994140625e-05
----------------------check_connections_block total spend ----------------------------- 0.0055119991302490234
generate_one_block  0.0020978450775146484
generate_one_block  0.00150299072265625
generate_one_block  0.001378774642944336
generate_one_block  0.001316070556640625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005872249603271484
gen group dst list time:  5.221366882324219e-05
time for parepare:  0.00018215179443359375
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005354881286621094
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004622936248779297
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005443096160888672
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0004532337188720703
----------------------check_connections_block total spend ----------------------------- 0.0038459300994873047
generate_one_block  0.0018570423126220703
generate_one_block  0.0017764568328857422
generate_one_block  0.0018525123596191406
generate_one_block  0.0018277168273925781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006949901580810547
gen group dst list time:  0.00010609626770019531
time for parepare:  0.0002269744873046875
local_output_nid generation:  6.794929504394531e-05
local_in_edges_tensor generation:  0.00031828880310058594
mini_batch_src_global generation:  0.00017333030700683594
r_  generation:  0.00160980224609375
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.0002484321594238281
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0015134811401367188
local_output_nid generation:  8.440017700195312e-05
local_in_edges_tensor generation:  0.0002639293670654297
mini_batch_src_global generation:  0.00017595291137695312
r_  generation:  0.0016565322875976562
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00024056434631347656
mini_batch_src_global generation:  0.000164031982421875
r_  generation:  0.0014150142669677734
----------------------check_connections_block total spend ----------------------------- 0.010043621063232422
generate_one_block  0.003107786178588867
generate_one_block  0.0026280879974365234
generate_one_block  0.0023908615112304688
generate_one_block  0.0022444725036621094
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007197856903076172
gen group dst list time:  0.0001838207244873047
time for parepare:  0.00024366378784179688
local_output_nid generation:  0.00014448165893554688
local_in_edges_tensor generation:  0.00046539306640625
mini_batch_src_global generation:  0.0002396106719970703
r_  generation:  0.0030477046966552734
local_output_nid generation:  0.00015211105346679688
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.00031447410583496094
r_  generation:  0.003019571304321289
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.00036406517028808594
mini_batch_src_global generation:  0.0002982616424560547
r_  generation:  0.0026056766510009766
local_output_nid generation:  0.00010895729064941406
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.0023467540740966797
----------------------check_connections_block total spend ----------------------------- 0.017010211944580078
generate_one_block  0.003655672073364258
generate_one_block  0.0034492015838623047
generate_one_block  0.0036008358001708984
generate_one_block  0.0033164024353027344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007424354553222656
gen group dst list time:  0.00019693374633789062
time for parepare:  0.00020360946655273438
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.00021076202392578125
r_  generation:  0.0031926631927490234
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.0003707408905029297
mini_batch_src_global generation:  0.00033020973205566406
r_  generation:  0.003189563751220703
local_output_nid generation:  0.00015783309936523438
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0002765655517578125
r_  generation:  0.0031638145446777344
local_output_nid generation:  0.00016450881958007812
local_in_edges_tensor generation:  0.00035762786865234375
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.003116607666015625
----------------------check_connections_block total spend ----------------------------- 0.019075870513916016
generate_one_block  0.004769086837768555
generate_one_block  0.0040264129638671875
generate_one_block  0.003976106643676758
generate_one_block  0.003948688507080078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007243156433105469
gen group dst list time:  0.00022673606872558594
time for parepare:  0.000194549560546875
local_output_nid generation:  0.0001647472381591797
local_in_edges_tensor generation:  0.0004923343658447266
mini_batch_src_global generation:  0.00022411346435546875
r_  generation:  0.0033981800079345703
local_output_nid generation:  0.00017380714416503906
local_in_edges_tensor generation:  0.00038695335388183594
mini_batch_src_global generation:  0.0003483295440673828
r_  generation:  0.0034027099609375
local_output_nid generation:  0.0001723766326904297
local_in_edges_tensor generation:  0.0003809928894042969
mini_batch_src_global generation:  0.00027370452880859375
r_  generation:  0.0033540725708007812
local_output_nid generation:  0.0001723766326904297
local_in_edges_tensor generation:  0.00038051605224609375
mini_batch_src_global generation:  0.0002741813659667969
r_  generation:  0.003351926803588867
----------------------check_connections_block total spend ----------------------------- 0.020254850387573242
generate_one_block  0.004619598388671875
generate_one_block  0.0045185089111328125
generate_one_block  0.004212379455566406
generate_one_block  0.004256725311279297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008215904235839844  GigaBytes
Max Memory Allocated: 0.0008215904235839844  GigaBytes

connection checking time:  0.07023048400878906
block generation total time  0.06603455543518066
average batch blocks generation time:  0.016508638858795166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014731407165527344  GigaBytes
Max Memory Allocated: 0.014731407165527344  GigaBytes

torch.Size([2468, 1433])
torch.Size([2385, 64])
torch.Size([2176, 64])
torch.Size([1592, 64])
torch.Size([753, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.02168416976928711  GigaBytes
Max Memory Allocated: 0.02173137664794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015545845031738281  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

torch.Size([2481, 1433])
torch.Size([2405, 64])
torch.Size([2169, 64])
torch.Size([1563, 64])
torch.Size([664, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.02232837677001953  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015546798706054688  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

torch.Size([2441, 1433])
torch.Size([2344, 64])
torch.Size([2157, 64])
torch.Size([1585, 64])
torch.Size([755, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.022415637969970703  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.015536308288574219  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

torch.Size([2435, 1433])
torch.Size([2349, 64])
torch.Size([2092, 64])
torch.Size([1454, 64])
torch.Size([657, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.022066116333007812  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005068838596343994 |0.08525633811950684 |0.1977992057800293 |0.00016874074935913086 |0.004338860511779785 |0.0036525726318359375 |
----------------------------------------------------------pseudo_mini_loss sum 3.3346734046936035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37657
Number of first layer input nodes during this epoch:  9825
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01768016815185547  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0004961490631103516
range selection method range initialization spend 6.532669067382812e-05
time for parepare:  7.605552673339844e-05
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00017595291137695312
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  8.058547973632812e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  6.4849853515625e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.96453857421875e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.914138793945312e-05
----------------------check_connections_block total spend ----------------------------- 0.001270294189453125
generate_one_block  0.0011625289916992188
generate_one_block  0.0011076927185058594
generate_one_block  0.0011234283447265625
generate_one_block  0.0011119842529296875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005054473876953125
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.00018668174743652344
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0003917217254638672
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0004246234893798828
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0004813671112060547
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004038810729980469
----------------------check_connections_block total spend ----------------------------- 0.003403902053833008
generate_one_block  0.0015065670013427734
generate_one_block  0.0016391277313232422
generate_one_block  0.00160980224609375
generate_one_block  0.0015251636505126953
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005743503570556641
gen group dst list time:  8.749961853027344e-05
time for parepare:  0.0001952648162841797
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0002586841583251953
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.0011985301971435547
local_output_nid generation:  6.031990051269531e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.0002067089080810547
r_  generation:  0.0014133453369140625
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.0001862049102783203
r_  generation:  0.001424551010131836
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0011942386627197266
----------------------check_connections_block total spend ----------------------------- 0.008574724197387695
generate_one_block  0.0024704933166503906
generate_one_block  0.0026674270629882812
generate_one_block  0.002621889114379883
generate_one_block  0.002177000045776367
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006849765777587891
gen group dst list time:  0.0001480579376220703
time for parepare:  0.00019669532775878906
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.0003726482391357422
mini_batch_src_global generation:  0.0002357959747314453
r_  generation:  0.002408742904663086
local_output_nid generation:  0.00011944770812988281
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  0.0002694129943847656
r_  generation:  0.002592802047729492
local_output_nid generation:  0.00012183189392089844
local_in_edges_tensor generation: Using backend: pytorch
 0.0003032684326171875
mini_batch_src_global generation:  0.00022673606872558594
r_  generation:  0.0025603771209716797
local_output_nid generation:  0.00011205673217773438
local_in_edges_tensor generation:  0.0002810955047607422
mini_batch_src_global generation:  0.0002067089080810547
r_  generation:  0.0022382736206054688
----------------------check_connections_block total spend ----------------------------- 0.015027523040771484
generate_one_block  0.003777027130126953
generate_one_block  0.0035393238067626953
generate_one_block  0.0036334991455078125
generate_one_block  0.003228425979614258
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007848739624023438
gen group dst list time:  0.00020551681518554688
time for parepare:  0.00019407272338867188
local_output_nid generation:  0.00014829635620117188
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.00026798248291015625
r_  generation:  0.0031058788299560547
local_output_nid generation:  0.0001628398895263672
local_in_edges_tensor generation:  0.0003688335418701172
mini_batch_src_global generation:  0.0003528594970703125
r_  generation:  0.0032656192779541016
local_output_nid generation:  0.00016069412231445312
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.003173351287841797
local_output_nid generation:  0.00015497207641601562
local_in_edges_tensor generation:  0.0003483295440673828
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.0029993057250976562
----------------------check_connections_block total spend ----------------------------- 0.018876075744628906
generate_one_block  0.004450082778930664
generate_one_block  0.004183769226074219
generate_one_block  0.004021644592285156
generate_one_block  0.0038483142852783203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007450580596923828
gen group dst list time:  0.00023126602172851562
time for parepare:  0.0002002716064453125
local_output_nid generation:  0.00016689300537109375
local_in_edges_tensor generation:  0.0004863739013671875
mini_batch_src_global generation:  0.000240325927734375
r_  generation:  0.003422975540161133
local_output_nid generation:  0.00017714500427246094
local_in_edges_tensor generation:  0.00038886070251464844
mini_batch_src_global generation:  0.0003101825714111328
r_  generation:  0.0034110546112060547
local_output_nid generation:  0.0001850128173828125
local_in_edges_tensor generation:  0.00038552284240722656
mini_batch_src_global generation:  0.0002772808074951172
r_  generation:  0.0033948421478271484
local_output_nid generation:  0.0001723766326904297
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.0002720355987548828
r_  generation:  0.003307819366455078
----------------------check_connections_block total spend ----------------------------- 0.020136594772338867
generate_one_block  0.004456520080566406
generate_one_block  0.004369497299194336
generate_one_block  0.004166126251220703
generate_one_block  0.004056692123413086
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01768016815185547  GigaBytes
Max Memory Allocated: 0.02898263931274414  GigaBytes

connection checking time:  0.06601881980895996
block generation total time  0.06394839286804199
average batch blocks generation time:  0.015987098217010498
block dataloader generation time/epoch 0.15482449531555176
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.017167091369628906  GigaBytes
Max Memory Allocated: 0.03061056137084961  GigaBytes

torch.Size([2462, 1433])
torch.Size([2379, 64])
torch.Size([2089, 64])
torch.Size([1483, 64])
torch.Size([633, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.023746967315673828  GigaBytes
Max Memory Allocated: 0.03061056137084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017179489135742188  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

torch.Size([2452, 1433])
torch.Size([2401, 64])
torch.Size([2211, 64])
torch.Size([1637, 64])
torch.Size([758, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.024189472198486328  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01717853546142578  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

torch.Size([2458, 1433])
torch.Size([2372, 64])
torch.Size([2148, 64])
torch.Size([1604, 64])
torch.Size([788, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.024121761322021484  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.017160415649414062  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

torch.Size([2395, 1433])
torch.Size([2279, 64])
torch.Size([2008, 64])
torch.Size([1384, 64])
torch.Size([648, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.02348184585571289  GigaBytes
Max Memory Allocated: 0.030611515045166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002266526222229004 |0.0009140372276306152 |0.006687462329864502 |0.0001226663589477539 |0.003390014171600342 |0.0027647018432617188 |
----------------------------------------------------------pseudo_mini_loss sum 3.422919511795044
Total (block generation + training)time/epoch 0.21566224098205566
Training time/epoch 0.06055188179016113
Training time without block to device /epoch 0.05689573287963867
Training time without total dataloading part /epoch 0.04356527328491211
load block tensor time/epoch 0.009066104888916016
block to device time/epoch 0.003656148910522461
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37320
Number of first layer input nodes during this epoch:  9767
