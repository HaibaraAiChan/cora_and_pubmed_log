main start at this time 1648433359.3926203
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0007867813110351562
range selection method range initialization spend 0.00010633468627929688
time for parepare:  6.175041198730469e-05
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.001865386962890625
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  4.029273986816406e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.5762786865234375e-05
----------------------check_connections_block total spend ----------------------------- 0.0037407875061035156
generate_one_block  0.0012078285217285156
generate_one_block  0.001018524169921875
generate_one_block  0.001020669937133789
generate_one_block  0.001008749008178711
generate_one_block  0.0010170936584472656
generate_one_block  0.0010182857513427734
generate_one_block  0.0010476112365722656
generate_one_block  0.0010623931884765625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004906654357910156
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0001373291015625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002543926239013672
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002422332763671875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012373924255371094
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002288818359375
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00020074844360351562
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00021576881408691406
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002503395080566406
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001926422119140625
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0002086162567138672
----------------------check_connections_block total spend ----------------------------- 0.003911256790161133
generate_one_block  0.0012981891632080078
generate_one_block  0.0012843608856201172
generate_one_block  0.0012507438659667969
generate_one_block  0.0012249946594238281
generate_one_block  0.0012433528900146484
generate_one_block  0.001276254653930664
generate_one_block  0.0012736320495605469
generate_one_block  0.0012137889862060547
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006830692291259766
gen group dst list time:  0.00010466575622558594
time for parepare:  0.00019288063049316406
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00023245811462402344
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0007672309875488281
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00010013580322265625
r_  generation:  0.0009219646453857422
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.000774383544921875
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0007040500640869141
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0008087158203125
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0007445812225341797
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006120204925537109
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  7.677078247070312e-05
r_  generation:  0.0006856918334960938
----------------------check_connections_block total spend ----------------------------- 0.010185003280639648
generate_one_block  0.001991748809814453
generate_one_block  0.0021245479583740234
generate_one_block  0.001861572265625
generate_one_block  0.0017981529235839844
generate_one_block  0.0018954277038574219
generate_one_block  0.001905679702758789
generate_one_block  0.0016634464263916016
generate_one_block  0.0017628669738769531
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007157325744628906
gen group dst list time:  0.00019240379333496094
time for parepare:  0.00017952919006347656
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0003540515899658203
mini_batch_src_global generation:  0.000179290771484375
r_  generation:  0.0018014907836914062
local_output_nid generation:  9.036064147949219e-05
local_in_edges_tensor generation:  0.0002543926239013672
mini_batch_src_global generation:  0.00022983551025390625
r_  generation:  0.0020062923431396484
local_output_nid generation:  8.916854858398438e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0017015933990478516
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0017423629760742188
local_output_nid generation:  8.368492126464844e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.0001690387725830078
r_  generation:  0.0018029212951660156
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  0.00015401840209960938
r_  generation:  0.001531839370727539
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.0001423358917236328
r_  generation:  0.00371551513671875
local_output_nid generation:  8.058547973632812e-05
local_in_edges_tensor generation:  0.000324249267578125
mini_batch_src_global generation:  0.00018596649169921875
r_  generation:  0.0015861988067626953
----------------------check_connections_block total spend ----------------------------- 0.02345728874206543
generate_one_block  0.0030906200408935547
generate_one_block  0.0032181739807128906
generate_one_block  0.0029158592224121094
generate_one_block  0.0029418468475341797
generate_one_block  0.0031576156616210938
generate_one_block  0.002694368362426758
generate_one_block  0.0026063919067382812
generate_one_block  0.0035724639892578125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0008296966552734375
gen group dst list time:  0.00033473968505859375
time for parepare:  0.0001842975616455078
local_output_nid generation:  0.0001246929168701172
local_in_edges_tensor generation:  0.00044727325439453125
mini_batch_src_global generation:  0.0002410411834716797
r_  generation:  0.002680063247680664
local_output_nid generation:  0.00015163421630859375
local_in_edges_tensor generation:  0.000331878662109375
mini_batch_src_global generation:  0.0003037452697753906
r_  generation:  0.002826690673828125
local_output_nid generation:  0.00013113021850585938
local_in_edges_tensor generation:  0.0003113746643066406
mini_batch_src_global generation:  0.0002315044403076172
r_  generation:  0.0026574134826660156
local_output_nid generation:  0.00013494491577148438
local_in_edges_tensor generation:  0.00031185150146484375
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.0026667118072509766
local_output_nid generation:  0.00012922286987304688
local_in_edges_tensor generation:  0.00030350685119628906
mini_batch_src_global generation:  0.00022649765014648438
r_  generation:  0.002605915069580078
local_output_nid generation:  0.00011968612670898438
local_in_edges_tensor generation:  0.00028896331787109375
mini_batch_src_global generation:  0.000213623046875
r_  generation:  0.002292156219482422
local_output_nid generation:  0.00011754035949707031
local_in_edges_tensor generation:  0.00031447410583496094
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0023152828216552734
local_output_nid generation:  0.00012803077697753906
local_in_edges_tensor generation:  0.0002925395965576172
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0024900436401367188
----------------------check_connections_block total spend ----------------------------- 0.031061410903930664
generate_one_block  0.003896951675415039
generate_one_block  0.003854990005493164
generate_one_block  0.0037751197814941406
generate_one_block  0.004300117492675781
generate_one_block  0.004415750503540039
generate_one_block  0.0035212039947509766
generate_one_block  0.00350189208984375
generate_one_block  0.003674745559692383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007822513580322266
gen group dst list time:  0.00045871734619140625
time for parepare:  0.00018906593322753906
local_output_nid generation:  0.0001506805419921875
local_in_edges_tensor generation:  0.00048542022705078125
mini_batch_src_global generation:  0.0002627372741699219
r_  generation:  0.003021717071533203
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.00036263465881347656
mini_batch_src_global generation:  0.0003151893615722656
r_  generation:  0.0031006336212158203
local_output_nid generation:  0.00015997886657714844
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.0030744075775146484
local_output_nid generation:  0.00016164779663085938
local_in_edges_tensor generation:  0.0003485679626464844
mini_batch_src_global generation:  0.0002536773681640625
r_  generation:  0.003000020980834961
local_output_nid generation:  0.0001533031463623047
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.00024962425231933594
r_  generation:  0.002839326858520508
local_output_nid generation:  0.00015020370483398438
local_in_edges_tensor generation:  0.0003314018249511719
mini_batch_src_global generation:  0.0002391338348388672
r_  generation:  0.0028121471405029297
local_output_nid generation:  0.0001513957977294922
local_in_edges_tensor generation:  0.00032973289489746094
mini_batch_src_global generation:  0.000240325927734375
r_  generation:  0.002818584442138672
local_output_nid generation:  0.0001614093780517578
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.00024700164794921875
r_  generation:  0.0029120445251464844
----------------------check_connections_block total spend ----------------------------- 0.035144805908203125
generate_one_block  0.004952192306518555
generate_one_block  0.004098415374755859
generate_one_block  0.004328012466430664
generate_one_block  0.004045963287353516
generate_one_block  0.004002094268798828
generate_one_block  0.0039746761322021484
generate_one_block  0.004109859466552734
generate_one_block  0.004184722900390625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

connection checking time:  0.103759765625
block generation total time  0.11390280723571777
average batch blocks generation time:  0.014237850904464722
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014256477355957031  GigaBytes
Max Memory Allocated: 0.014256477355957031  GigaBytes

torch.Size([2389, 1433])
torch.Size([2231, 32])
torch.Size([1849, 32])
torch.Size([1141, 32])
torch.Size([432, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.017166614532470703  GigaBytes
Max Memory Allocated: 0.017177581787109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.014652729034423828  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2419, 1433])
torch.Size([2305, 32])
torch.Size([2009, 32])
torch.Size([1289, 32])
torch.Size([521, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01780223846435547  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014635562896728516  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2428, 1433])
torch.Size([2265, 32])
torch.Size([1840, 32])
torch.Size([1052, 32])
torch.Size([432, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017489910125732422  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.014633655548095703  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2406, 1433])
torch.Size([2243, 32])
torch.Size([1857, 32])
torch.Size([1092, 32])
torch.Size([394, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017491817474365234  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013650894165039062  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2376, 1433])
torch.Size([2208, 32])
torch.Size([1793, 32])
torch.Size([1130, 32])
torch.Size([448, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01650714874267578  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.013485908508300781  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2348, 1433])
torch.Size([2166, 32])
torch.Size([1644, 32])
torch.Size([975, 32])
torch.Size([415, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016149520874023438  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01360321044921875  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2371, 1433])
torch.Size([2178, 32])
torch.Size([1650, 32])
torch.Size([868, 32])
torch.Size([319, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01615619659423828  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01463174819946289  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

torch.Size([2438, 1433])
torch.Size([2257, 32])
torch.Size([1833, 32])
torch.Size([1022, 32])
torch.Size([381, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.017436981201171875  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006748229265213013 |0.04396405816078186 |0.10376223921775818 |0.00017532706260681152 |0.004899114370346069 |0.0074615478515625 |
----------------------------------------------------------pseudo_mini_loss sum 3.5711817741394043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64159
Number of first layer input nodes during this epoch:  19175
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015826702117919922  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.00051116943359375
range selection method range initialization spend 7.414817810058594e-05
time for parepare:  7.891654968261719e-05
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  5.054473876953125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.53131103515625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.1961669921875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.0531158447265625e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  2.9802322387695312e-05
----------------------check_connections_block total spend ----------------------------- 0.001954793930053711
generate_one_block  0.0011548995971679688
generate_one_block  0.0011188983917236328
generate_one_block  0.0011289119720458984
generate_one_block  0.001107931137084961
generate_one_block  0.001009225845336914
generate_one_block  0.0010044574737548828
generate_one_block  0.0010776519775390625
generate_one_block  0.0009775161743164062
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.00046944618225097656
gen group dst list time:  5.4836273193359375e-05
time for parepare:  0.00016117095947265625
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.000171661376953125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.0002636909484863281
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0003037452697753906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00027108192443847656
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002148151397705078
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0002334117889404297
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0002372264862060547
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001430511474609375
----------------------check_connections_block total spend ----------------------------- 0.004033327102661133
generate_one_block  0.0012731552124023438
generate_one_block  0.0013318061828613281
generate_one_block  0.0012383460998535156
generate_one_block  0.0012896060943603516
generate_one_block  0.0012385845184326172
generate_one_block  0.0012454986572265625
generate_one_block  0.0012733936309814453
generate_one_block  0.0011525154113769531
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006861686706542969
gen group dst list time:  0.00010609626770019531
time for parepare:  0.00019073486328125
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00024199485778808594
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0005586147308349609
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0009219646453857422
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00010228157043457031
r_  generation:  0.0007495880126953125
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  9.989738464355469e-05
r_  generation:  0.0009055137634277344
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00016927719116210938
mini_batch_src_global generation:  9.560585021972656e-05
r_  generation:  0.0007219314575195312
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0008013248443603516
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007543563842773438
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0005712509155273438
----------------------check_connections_block total spend ----------------------------- 0.010303020477294922
generate_one_block  0.0016448497772216797
generate_one_block  0.0020570755004882812
generate_one_block  0.0018398761749267578
generate_one_block  0.001963376998901367
generate_one_block  0.001760244369506836
generate_one_block  0.002053976058959961
generate_one_block  0.001874685287475586
generate_one_block  0.0015933513641357422
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007405281066894531
gen group dst list time:  0.00019168853759765625
time for parepare:  0.00018262863159179688
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0003647804260253906
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0014829635620117188
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.000247955322265625
mini_batch_src_global generation:  0.00024247169494628906
r_  generation:  0.0019550323486328125
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0016033649444580078
local_output_nid generation:  8.749961853027344e-05
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.0018618106842041016
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0015366077423095703
local_output_nid generation:  8.845329284667969e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.0018715858459472656
local_output_nid generation:  8.511543273925781e-05
local_in_edges_tensor generation:  0.00023126602172851562
mini_batch_src_global generation:  0.00016355514526367188
r_  generation:  0.001706838607788086
local_output_nid generation:  7.200241088867188e-05
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.001413106918334961
----------------------check_connections_block total spend ----------------------------- 0.02079033851623535
generate_one_block  0.002770662307739258
generate_one_block  0.0030727386474609375
generate_one_block  0.002801656723022461
generate_one_block  0.0030319690704345703
generate_one_block  0.002727508544921875
generate_one_block  0.003206014633178711
generate_one_block  0.0028896331787109375
generate_one_block  0.002582073211669922
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007758140563964844
gen group dst list time:  0.0003325939178466797
time for parepare:  0.00017714500427246094
local_output_nid generation:  0.00011467933654785156
local_in_edges_tensor generation:  0.00042557716369628906
mini_batch_src_global generation:  0.00022459030151367188
r_  generation:  0.002413034439086914
local_output_nid generation:  0.0001385211944580078
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.0003142356872558594
r_  generation:  0.0026404857635498047
local_output_nid generation:  0.00013113021850585938
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  0.00023603439331054688
r_  generation:  0.0024628639221191406
local_output_nid generation:  0.00014019012451171875
local_in_edges_tensor generation:  0.0003247261047363281
mini_batch_src_global generation:  0.0002353191375732422
r_  generation:  0.00260162353515625
local_output_nid generation:  0.00013637542724609375
local_in_edges_tensor generation:  0.0003077983856201172
mini_batch_src_global generation:  0.0002319812774658203
r_  generation:  0.002460956573486328
local_output_nid generation:  0.00013303756713867188
local_in_edges_tensor generation:  0.0003063678741455078
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.002518892288208008
local_output_nid generation:  0.00013709068298339844
local_in_edges_tensor generation:  0.00029921531677246094
mini_batch_src_global generation:  0.00023293495178222656
r_  generation:  0.0025222301483154297
local_output_nid generation:  0.0001227855682373047
local_in_edges_tensor generation:  0.0002796649932861328
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.002335786819458008
----------------------check_connections_block total spend ----------------------------- 0.030475139617919922
generate_one_block  0.0036530494689941406
generate_one_block  0.004122495651245117
generate_one_block  0.004038333892822266
generate_one_block  0.0038688182830810547
generate_one_block  0.0036890506744384766
generate_one_block  0.003712892532348633
generate_one_block  0.003731250762939453
generate_one_block  0.0035533905029296875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007770061492919922
gen group dst list time:  0.00047135353088378906
time for parepare:  0.00018835067749023438
local_output_nid generation:  0.0001494884490966797
local_in_edges_tensor generation:  0.0004830360412597656
mini_batch_src_global generation:  0.00025391578674316406
r_  generation:  0.0029664039611816406
local_output_nid generation:  0.00016307830810546875
local_in_edges_tensor generation:  0.0003712177276611328
mini_batch_src_global generation:  0.0003211498260498047
r_  generation:  0.003015279769897461
local_output_nid generation:  0.00015664100646972656
local_in_edges_tensor generation:  0.0003330707550048828
mini_batch_src_global generation:  0.00025200843811035156
r_  generation:  0.002942323684692383
local_output_nid generation:  0.00015974044799804688
local_in_edges_tensor generation:  0.00034117698669433594
mini_batch_src_global generation:  0.00024580955505371094
r_  generation:  0.0030934810638427734
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.0003559589385986328
mini_batch_src_global generation:  0.0002598762512207031
r_  generation:  0.003017425537109375
local_output_nid generation:  0.00015807151794433594
local_in_edges_tensor generation:  0.00033283233642578125
mini_batch_src_global generation:  0.000244140625
r_  generation:  0.0029256343841552734
local_output_nid generation:  0.0001609325408935547
local_in_edges_tensor generation: Using backend: pytorch
 0.0003380775451660156
mini_batch_src_global generation:  0.00024890899658203125
r_  generation:  0.0029697418212890625
local_output_nid generation:  0.00015354156494140625
local_in_edges_tensor generation:  0.00033020973205566406
mini_batch_src_global generation:  0.00025343894958496094
r_  generation:  0.0028333663940429688
----------------------check_connections_block total spend ----------------------------- 0.03542971611022949
generate_one_block  0.00450897216796875
generate_one_block  0.004191875457763672
generate_one_block  0.0040357112884521484
generate_one_block  0.004128694534301758
generate_one_block  0.004092216491699219
generate_one_block  0.0040340423583984375
generate_one_block  0.004477262496948242
generate_one_block  0.0040242671966552734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015826702117919922  GigaBytes
Max Memory Allocated: 0.028112411499023438  GigaBytes

connection checking time:  0.10103154182434082
block generation total time  0.11177492141723633
average batch blocks generation time:  0.013971865177154541
block dataloader generation time/epoch 0.25137782096862793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01538228988647461  GigaBytes
Max Memory Allocated: 0.028870582580566406  GigaBytes

torch.Size([2395, 1433])
torch.Size([2188, 32])
torch.Size([1733, 32])
torch.Size([947, 32])
torch.Size([296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01801586151123047  GigaBytes
Max Memory Allocated: 0.028870582580566406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015410900115966797  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2389, 1433])
torch.Size([2286, 32])
torch.Size([1942, 32])
torch.Size([1287, 32])
torch.Size([560, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018540382385253906  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015392780303955078  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2400, 1433])
torch.Size([2216, 32])
torch.Size([1778, 32])
torch.Size([1037, 32])
torch.Size([436, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018200397491455078  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015406131744384766  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2437, 1433])
torch.Size([2305, 32])
torch.Size([1924, 32])
torch.Size([1219, 32])
torch.Size([511, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018465518951416016  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01538991928100586  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2434, 1433])
torch.Size([2283, 32])
torch.Size([1792, 32])
torch.Size([1018, 32])
torch.Size([413, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018199443817138672  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0143585205078125  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2366, 1433])
torch.Size([2226, 32])
torch.Size([1864, 32])
torch.Size([1196, 32])
torch.Size([491, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01732921600341797  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01539754867553711  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2441, 1433])
torch.Size([2306, 32])
torch.Size([1865, 32])
torch.Size([1138, 32])
torch.Size([447, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01834869384765625  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.0142669677734375  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

torch.Size([2353, 1433])
torch.Size([2173, 32])
torch.Size([1680, 32])
torch.Size([888, 32])
torch.Size([292, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016812801361083984  GigaBytes
Max Memory Allocated: 0.028871536254882812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00396236777305603 |0.0010256469249725342 |0.007356554269790649 |0.00011432170867919922 |0.005365848541259766 |0.0033266544342041016 |
----------------------------------------------------------pseudo_mini_loss sum 3.188149929046631
Total (block generation + training)time/epoch 0.40779972076416016
Training time/epoch 0.15613985061645508
Training time without block to device /epoch 0.1479346752166748
Training time without total dataloading part /epoch 0.10602045059204102
load block tensor time/epoch 0.03169894218444824
block to device time/epoch 0.008205175399780273
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64712
Number of first layer input nodes during this epoch:  19215
