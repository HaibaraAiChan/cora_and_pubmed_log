main start at this time 1648433340.507652
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006175041198730469
range selection method range initialization spend 8.225440979003906e-05
time for parepare:  6.008148193359375e-05
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0011525154113769531
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001246929168701172
----------------------check_connections_block total spend ----------------------------- 0.0019407272338867188
generate_one_block  0.0013089179992675781
generate_one_block  0.001224517822265625
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0004901885986328125
gen group dst list time:  2.9087066650390625e-05
time for parepare:  0.00015473365783691406
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0006794929504394531
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0006356239318847656
----------------------check_connections_block total spend ----------------------------- 0.0023975372314453125
generate_one_block  0.0017778873443603516
generate_one_block  0.0017666816711425781
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005385875701904297
gen group dst list time:  5.555152893066406e-05
time for parepare:  0.0001709461212158203
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0003006458282470703
mini_batch_src_global generation:  0.00016832351684570312
r_  generation:  0.0018067359924316406
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.0002231597900390625
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0016334056854248047
----------------------check_connections_block total spend ----------------------------- 0.005409955978393555
generate_one_block  0.003019094467163086
generate_one_block  0.0029234886169433594
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005843639373779297
gen group dst list time:  9.870529174804688e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  0.00012540817260742188
local_in_edges_tensor generation:  0.0004067420959472656
mini_batch_src_global generation:  0.000209808349609375
r_  generation:  0.002743244171142578
local_output_nid generation:  0.00012159347534179688
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.0002818107604980469
r_  generation:  0.0025281906127929688
----------------------check_connections_block total spend ----------------------------- 0.008129358291625977
generate_one_block  0.003931283950805664
generate_one_block  0.003912210464477539
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007617473602294922
gen group dst list time:  0.00010251998901367188
time for parepare:  0.0001819133758544922
local_output_nid generation:  0.00014328956604003906
local_in_edges_tensor generation:  0.0005090236663818359
mini_batch_src_global generation:  0.00020122528076171875
r_  generation:  0.0030121803283691406
local_output_nid generation:  0.00014901161193847656
local_in_edges_tensor generation:  0.00033593177795410156
mini_batch_src_global generation:  0.0002562999725341797
r_  generation:  0.0030303001403808594
----------------------check_connections_block total spend ----------------------------- 0.009099483489990234
generate_one_block  0.0042574405670166016
generate_one_block  0.004222869873046875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006496906280517578
gen group dst list time:  0.00011134147644042969
time for parepare:  0.00017523765563964844
local_output_nid generation:  0.00015044212341308594
local_in_edges_tensor generation:  0.0004596710205078125
mini_batch_src_global generation:  0.00020432472229003906
r_  generation:  0.0030584335327148438
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0003521442413330078
mini_batch_src_global generation:  0.0002741813659667969
r_  generation:  0.0031042098999023438
----------------------check_connections_block total spend ----------------------------- 0.009296417236328125
generate_one_block  0.005179405212402344
generate_one_block  0.0042209625244140625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

connection checking time:  0.0343327522277832
block generation total time  0.03521132469177246
average batch blocks generation time:  0.01760566234588623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014333248138427734  GigaBytes
Max Memory Allocated: 0.014333248138427734  GigaBytes

torch.Size([2498, 1433])
torch.Size([2456, 32])
torch.Size([2360, 32])
torch.Size([1981, 32])
torch.Size([1165, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.018604278564453125  GigaBytes
Max Memory Allocated: 0.01863861083984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01470804214477539  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

torch.Size([2505, 1433])
torch.Size([2451, 32])
torch.Size([2288, 32])
torch.Size([1851, 32])
torch.Size([1080, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018813610076904297  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006305813789367676 |0.1694812774658203 |0.3865751028060913 |0.0001995563507080078 |0.007407784461975098 |0.003751993179321289 |
----------------------------------------------------------pseudo_mini_loss sum 3.3521876335144043
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  21326
Number of first layer input nodes during this epoch:  5003
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016070842742919922  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0006012916564941406
range selection method range initialization spend 9.34600830078125e-05
time for parepare:  9.918212890625e-05
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.0001690387725830078
local_output_nid generation:  2.574920654296875e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00015497207641601562
----------------------check_connections_block total spend ----------------------------- 0.0012145042419433594
generate_one_block  0.001504659652709961
generate_one_block  0.001455545425415039
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.000591278076171875
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.00021004676818847656
local_output_nid generation:  3.457069396972656e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.00012564659118652344
r_  generation:  0.0008647441864013672
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.00014734268188476562
r_  generation:  0.0008304119110107422
----------------------check_connections_block total spend ----------------------------- 0.003214120864868164
generate_one_block  0.002403736114501953
generate_one_block  0.0022041797637939453
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006797313690185547
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.0002472400665283203
local_output_nid generation:  0.00010061264038085938
local_in_edges_tensor generation:  0.00035762786865234375
mini_batch_src_global generation:  0.0002930164337158203
r_  generation:  0.002325773239135742
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.00029659271240234375
mini_batch_src_global generation:  0.0003299713134765625
r_  generation:  0.002251863479614258
----------------------check_connections_block total spend ----------------------------- 0.007447004318237305
generate_one_block  0.0038394927978515625
generate_one_block  0.0036492347717285156
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007016658782958984
gen group dst list time:  0.0001201629638671875
time for parepare:  0.00023818016052246094
local_output_nid generation:  0.00016927719116210938
local_in_edges_tensor generation:  0.0004487037658691406
mini_batch_src_global generation:  0.0002548694610595703
r_  generation:  0.002896547317504883
local_output_nid generation:  0.0001380443572998047
local_in_edges_tensor generation:  0.00033974647521972656
mini_batch_src_global generation:  0.0003292560577392578
r_  generation:  0.002910137176513672
----------------------check_connections_block total spend ----------------------------- 0.009288549423217773
generate_one_block  0.004208564758300781
generate_one_block  0.003964900970458984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007185935974121094
gen group dst list time:  0.00011491775512695312
time for parepare:  0.0001995563507080078
local_output_nid generation:  0.0001571178436279297
local_in_edges_tensor generation:  0.00044536590576171875
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.00331878662109375
local_output_nid generation:  0.0001697540283203125
local_in_edges_tensor generation:  0.0003800392150878906
mini_batch_src_global generation:  0.0003485679626464844
r_  generation:  0.0033180713653564453
----------------------check_connections_block total spend ----------------------------- 0.010074138641357422
generate_one_block  0.004568815231323242
generate_one_block  0.004797220230102539
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007722377777099609
gen group dst list time:  0.00012350082397460938
time for parepare:  0.0001983642578125
local_output_nid generation:  0.0001685619354248047
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.0002295970916748047
r_  generation:  0.0034313201904296875
local_output_nid generation:  0.0001766681671142578
local_in_edges_tensor generation:  0.0003955364227294922
mini_batch_src_global generation:  0.00034809112548828125
r_  generation:  0.003404378890991211
----------------------check_connections_block total spend ----------------------------- 0.010369062423706055
generate_one_block  0.004675388336181641
generate_one_block  0.0045011043548583984
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.016070842742919922  GigaBytes
Max Memory Allocated: 0.028114795684814453  GigaBytes

connection checking time:  0.04039287567138672
block generation total time  0.03881263732910156
average batch blocks generation time:  0.01940631866455078
block dataloader generation time/epoch 0.10195422172546387
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015468120574951172  GigaBytes
Max Memory Allocated: 0.028872966766357422  GigaBytes

torch.Size([2475, 1433])
torch.Size([2431, 32])
torch.Size([2290, 32])
torch.Size([1894, 32])
torch.Size([1102, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.019603252410888672  GigaBytes
Max Memory Allocated: 0.028872966766357422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.015467166900634766  GigaBytes
Max Memory Allocated: 0.028873920440673828  GigaBytes

torch.Size([2481, 1433])
torch.Size([2440, 32])
torch.Size([2309, 32])
torch.Size([1898, 32])
torch.Size([1085, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2772216796875 GB
    Memory Allocated: 0.019611358642578125  GigaBytes
Max Memory Allocated: 0.028873920440673828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009832143783569336 |0.0015301704406738281 |0.007938146591186523 |0.00014591217041015625 |0.007071852684020996 |0.006051540374755859 |
----------------------------------------------------------pseudo_mini_loss sum 3.1079514026641846
Total (block generation + training)time/epoch 0.1653151512145996
Training time/epoch 0.06273841857910156
Training time without block to device /epoch 0.059678077697753906
Training time without total dataloading part /epoch 0.03636336326599121
load block tensor time/epoch 0.019664287567138672
block to device time/epoch 0.0030603408813476562
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  21095
Number of first layer input nodes during this epoch:  4956
