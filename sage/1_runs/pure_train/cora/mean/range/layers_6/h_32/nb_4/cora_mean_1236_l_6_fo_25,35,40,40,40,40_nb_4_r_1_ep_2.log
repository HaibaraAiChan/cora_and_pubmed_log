main start at this time 1648433349.8269083
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0011203289031982422
range selection method range initialization spend 0.00011610984802246094
time for parepare:  6.651878356933594e-05
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0026404857635498047
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.747245788574219e-05
----------------------check_connections_block total spend ----------------------------- 0.003889322280883789
generate_one_block  0.001432180404663086
generate_one_block  0.0011167526245117188
generate_one_block  0.0011167526245117188
generate_one_block  0.001110076904296875
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005106925964355469
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.00014162063598632812
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004525184631347656
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003921985626220703
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004608631134033203
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004048347473144531
----------------------check_connections_block total spend ----------------------------- 0.0032570362091064453
generate_one_block  0.0015938282012939453
generate_one_block  0.0014986991882324219
generate_one_block  0.001584768295288086
generate_one_block  0.0015716552734375
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005838871002197266
gen group dst list time:  8.20159912109375e-05
time for parepare:  0.00018334388732910156
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.001386404037475586
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00013899803161621094
r_  generation:  0.0012335777282714844
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0013701915740966797
local_output_nid generation:  5.316734313964844e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  0.00012993812561035156
r_  generation:  0.001216888427734375
----------------------check_connections_block total spend ----------------------------- 0.008358955383300781
generate_one_block  0.0026748180389404297
generate_one_block  0.002474546432495117
generate_one_block  0.0025129318237304688
generate_one_block  0.002231597900390625
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007202625274658203
gen group dst list time:  0.00014328956604003906
time for parepare:  0.00019216537475585938
local_output_nid generation:  0.00011086463928222656
local_in_edges_tensor generation:  0.00043702125549316406
mini_batch_src_global generation:  0.00018477439880371094
r_  generation:  0.0025315284729003906
local_output_nid generation:  0.00011372566223144531
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.0023956298828125
local_output_nid generation:  0.00011777877807617188
local_in_edges_tensor generation:  0.00030159950256347656
mini_batch_src_global generation:  0.0002288818359375
r_  generation:  0.002505064010620117
local_output_nid generation:  0.00011014938354492188
local_in_edges_tensor generation:  0.0002887248992919922
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0023632049560546875
----------------------check_connections_block total spend ----------------------------- 0.014893054962158203
generate_one_block  0.003942012786865234
generate_one_block  0.003372669219970703
generate_one_block  0.0035851001739501953
generate_one_block  0.003316164016723633
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007512569427490234
gen group dst list time:  0.0002028942108154297
time for parepare:  0.00019669532775878906
local_output_nid generation:  0.0001480579376220703
local_in_edges_tensor generation:  0.00045180320739746094
mini_batch_src_global generation:  0.0002129077911376953
r_  generation:  0.0031478404998779297
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.0003619194030761719
mini_batch_src_global generation:  0.0003323554992675781
r_  generation:  0.0031337738037109375
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.00035858154296875
mini_batch_src_global generation:  0.00026917457580566406
r_  generation:  0.003164529800415039
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0002613067626953125
r_  generation:  0.0030837059020996094
----------------------check_connections_block total spend ----------------------------- 0.018848896026611328
generate_one_block  0.004904747009277344
generate_one_block  0.003996133804321289
generate_one_block  0.003977298736572266
generate_one_block  0.003929615020751953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007545948028564453
gen group dst list time:  0.00024318695068359375
time for parepare:  0.0001976490020751953
local_output_nid generation:  0.0001666545867919922
local_in_edges_tensor generation:  0.0005409717559814453
mini_batch_src_global generation:  0.00022840499877929688
r_  generation:  0.003388643264770508
local_output_nid generation:  0.0001735687255859375
local_in_edges_tensor generation:  0.00038814544677734375
mini_batch_src_global generation:  0.0003533363342285156
r_  generation:  0.0033507347106933594
local_output_nid generation:  0.0001747608184814453
local_in_edges_tensor generation:  0.00038123130798339844
mini_batch_src_global generation:  0.0002751350402832031
r_  generation:  0.0033926963806152344
local_output_nid generation:  0.00017309188842773438
local_in_edges_tensor generation:  0.00037932395935058594
mini_batch_src_global generation:  0.00028324127197265625
r_  generation:  0.003330230712890625
----------------------check_connections_block total spend ----------------------------- 0.020251035690307617
generate_one_block  0.004469156265258789
generate_one_block  0.005089521408081055
generate_one_block  0.004153728485107422
generate_one_block  0.004124641418457031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003867149353027344  GigaBytes
Max Memory Allocated: 0.0003867149353027344  GigaBytes

connection checking time:  0.06560897827148438
block generation total time  0.06500363349914551
average batch blocks generation time:  0.016250908374786377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.014299392700195312  GigaBytes
Max Memory Allocated: 0.014299392700195312  GigaBytes

torch.Size([2434, 1433])
torch.Size([2369, 32])
torch.Size([2151, 32])
torch.Size([1610, 32])
torch.Size([795, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2596435546875 GB
    Memory Allocated: 0.017934322357177734  GigaBytes
Max Memory Allocated: 0.01795339584350586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01467132568359375  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([2467, 1433])
torch.Size([2378, 32])
torch.Size([2148, 32])
torch.Size([1488, 32])
torch.Size([679, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018158912658691406  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014679908752441406  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([2456, 1433])
torch.Size([2380, 32])
torch.Size([2155, 32])
torch.Size([1597, 32])
torch.Size([762, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018290042877197266  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.014669418334960938  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

torch.Size([2470, 1433])
torch.Size([2351, 32])
torch.Size([2111, 32])
torch.Size([1469, 32])
torch.Size([668, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018115520477294922  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005002021789550781 |0.0864914059638977 |0.1993328332901001 |0.0001830458641052246 |0.007290661334991455 |0.004968881607055664 |
----------------------------------------------------------pseudo_mini_loss sum 4.231589317321777
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  37674
Number of first layer input nodes during this epoch:  9827
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015949249267578125  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

The real block id is  5
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
range selection method range initialization spend 7.772445678710938e-05
time for parepare:  8.249282836914062e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  8.177757263183594e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011610984802246094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.271766662597656e-05
----------------------check_connections_block total spend ----------------------------- 0.0013604164123535156
generate_one_block  0.0012323856353759766
generate_one_block  0.0011742115020751953
generate_one_block  0.0010974407196044922
generate_one_block  0.0011031627655029297
The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0005011558532714844
gen group dst list time:  4.1961669921875e-05
time for parepare:  0.00018906593322753906
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.00042510032653808594
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0005002021789550781
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0004115104675292969
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0003833770751953125
----------------------check_connections_block total spend ----------------------------- 0.0033974647521972656
generate_one_block  0.0015301704406738281
generate_one_block  0.0016829967498779297
generate_one_block  0.0015118122100830078
generate_one_block  0.0014758110046386719
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0006387233734130859
gen group dst list time:  8.940696716308594e-05
time for parepare:  0.0002052783966064453
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00028014183044433594
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0013308525085449219
local_output_nid generation:  6.461143493652344e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0014247894287109375
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.0001900196075439453
r_  generation:  0.0013458728790283203
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.0001499652862548828
r_  generation:  0.0011429786682128906
----------------------check_connections_block total spend ----------------------------- 0.008585214614868164
generate_one_block  0.0025930404663085938
generate_one_block  0.002615690231323242
generate_one_block  0.002460956573486328
generate_one_block  0.0021169185638427734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007004737854003906
gen group dst list time:  0.0001456737518310547
time for parepare:  0.0001895427703857422
local_output_nid generation:  0.000110626220703125
local_in_edges_tensor generation:  0.00037789344787597656
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.0024733543395996094
local_output_nid generation:  0.00011444091796875
local_in_edges_tensor generation:  0.0002951622009277344
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0024747848510742188
local_output_nid generation:  0.00012564659118652344
local_in_edges_tensor generation: Using backend: pytorch
 0.00029754638671875
mini_batch_src_global generation:  0.0002200603485107422
r_  generation:  0.0025212764739990234
local_output_nid generation:  0.00010919570922851562
local_in_edges_tensor generation:  0.0002892017364501953
mini_batch_src_global generation:  0.0002071857452392578
r_  generation:  0.0022826194763183594
----------------------check_connections_block total spend ----------------------------- 0.014951705932617188
generate_one_block  0.003679513931274414
generate_one_block  0.0034341812133789062
generate_one_block  0.003595590591430664
generate_one_block  0.0032563209533691406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007853507995605469
gen group dst list time:  0.00020122528076171875
time for parepare:  0.00020837783813476562
local_output_nid generation:  0.00014734268188476562
local_in_edges_tensor generation:  0.0004630088806152344
mini_batch_src_global generation:  0.0002789497375488281
r_  generation:  0.0031120777130126953
local_output_nid generation:  0.00015616416931152344
local_in_edges_tensor generation:  0.0003609657287597656
mini_batch_src_global generation:  0.00032830238342285156
r_  generation:  0.0031740665435791016
local_output_nid generation:  0.0001590251922607422
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  0.0002589225769042969
r_  generation:  0.0031592845916748047
local_output_nid generation:  0.00015854835510253906
local_in_edges_tensor generation:  0.00034880638122558594
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.0030913352966308594
----------------------check_connections_block total spend ----------------------------- 0.018784523010253906
generate_one_block  0.004456043243408203
generate_one_block  0.003999471664428711
generate_one_block  0.003981590270996094
generate_one_block  0.003901958465576172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007507801055908203
gen group dst list time:  0.000240325927734375
time for parepare:  0.00019598007202148438
local_output_nid generation:  0.00016498565673828125
local_in_edges_tensor generation:  0.0004875659942626953
mini_batch_src_global generation:  0.0002205371856689453
r_  generation:  0.003333568572998047
local_output_nid generation:  0.0001728534698486328
local_in_edges_tensor generation:  0.0003838539123535156
mini_batch_src_global generation:  0.0003104209899902344
r_  generation:  0.0033774375915527344
local_output_nid generation:  0.00017499923706054688
local_in_edges_tensor generation:  0.00037932395935058594
mini_batch_src_global generation:  0.000274658203125
r_  generation:  0.003365039825439453
local_output_nid generation:  0.0001780986785888672
local_in_edges_tensor generation:  0.0003771781921386719
mini_batch_src_global generation:  0.0002703666687011719
r_  generation:  0.0033330917358398438
----------------------check_connections_block total spend ----------------------------- 0.01988506317138672
generate_one_block  0.004226207733154297
generate_one_block  0.004473447799682617
generate_one_block  0.0041429996490478516
generate_one_block  0.004110813140869141
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.015949249267578125  GigaBytes
Max Memory Allocated: 0.02811288833618164  GigaBytes

connection checking time:  0.06560397148132324
block generation total time  0.06324553489685059
average batch blocks generation time:  0.015811383724212646
block dataloader generation time/epoch 0.1551828384399414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.01543426513671875  GigaBytes
Max Memory Allocated: 0.02887105941772461  GigaBytes

torch.Size([2436, 1433])
torch.Size([2340, 32])
torch.Size([2120, 32])
torch.Size([1571, 32])
torch.Size([728, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.018963336944580078  GigaBytes
Max Memory Allocated: 0.02887105941772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015438079833984375  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

torch.Size([2466, 1433])
torch.Size([2381, 32])
torch.Size([2145, 32])
torch.Size([1564, 32])
torch.Size([777, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.019043922424316406  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01543426513671875  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

torch.Size([2462, 1433])
torch.Size([2378, 32])
torch.Size([2143, 32])
torch.Size([1582, 32])
torch.Size([752, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.01901721954345703  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.015423774719238281  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

torch.Size([2454, 1433])
torch.Size([2359, 32])
torch.Size([2084, 32])
torch.Size([1426, 32])
torch.Size([620, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2752685546875 GB
    Memory Allocated: 0.018803119659423828  GigaBytes
Max Memory Allocated: 0.028872013092041016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0044381022453308105 |0.0015656352043151855 |0.009878575801849365 |0.0001577138900756836 |0.006425917148590088 |0.0059051513671875 |
----------------------------------------------------------pseudo_mini_loss sum 3.5836095809936523
Total (block generation + training)time/epoch 0.259019136428833
Training time/epoch 0.10304737091064453
Training time without block to device /epoch 0.09678483009338379
Training time without total dataloading part /epoch 0.07175397872924805
load block tensor time/epoch 0.017752408981323242
block to device time/epoch 0.006262540817260742
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  37518
Number of first layer input nodes during this epoch:  9818
