main start at this time 1648428379.1627724
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012595653533935547
range selection method range initialization spend 0.0001239776611328125
time for parepare:  7.843971252441406e-05
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.003031492233276367
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00016808509826660156
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001456737518310547
----------------------check_connections_block total spend ----------------------------- 0.004016399383544922
generate_one_block  0.002275228500366211
generate_one_block  0.0015137195587158203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000591278076171875
gen group dst list time:  3.814697265625e-05
time for parepare:  0.00019979476928710938
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.0008916854858398438
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0008387565612792969
----------------------check_connections_block total spend ----------------------------- 0.0031523704528808594
generate_one_block  0.002404451370239258
generate_one_block  0.0022890567779541016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006811618804931641
gen group dst list time:  7.343292236328125e-05
time for parepare:  0.000232696533203125
local_output_nid generation:  0.00010228157043457031
local_in_edges_tensor generation:  0.00037169456481933594
mini_batch_src_global generation:  0.0001983642578125
r_  generation:  0.002292156219482422
local_output_nid generation:  0.00011539459228515625
local_in_edges_tensor generation:  0.00030112266540527344
mini_batch_src_global generation:  0.0002219676971435547
r_  generation:  0.0021610260009765625
----------------------check_connections_block total spend ----------------------------- 0.007083892822265625
generate_one_block  0.004168033599853516
generate_one_block  0.0035479068756103516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.010236263275146484
block generation total time  0.012409448623657227
average batch blocks generation time:  0.006204724311828613
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.010977745056152344  GigaBytes
Max Memory Allocated: 0.010977745056152344  GigaBytes

torch.Size([1909, 1433])
torch.Size([1161, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.01232147216796875  GigaBytes
Max Memory Allocated: 0.012398719787597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011681079864501953  GigaBytes
Max Memory Allocated: 0.02181386947631836  GigaBytes

torch.Size([1906, 1433])
torch.Size([1121, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012966632843017578  GigaBytes
Max Memory Allocated: 0.02181386947631836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013441681861877441 |0.17401254177093506 |0.3841773271560669 |0.000202178955078125 |0.0045125484466552734 |0.0043451786041259766 |
----------------------------------------------------------pseudo_mini_loss sum 3.3419809341430664
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6788
Number of first layer input nodes during this epoch:  3815
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013257980346679688  GigaBytes
Max Memory Allocated: 0.02181386947631836  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009355545043945312
range selection method range initialization spend 0.00011873245239257812
time for parepare:  0.0001499652862548828
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.0003306865692138672
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0003039836883544922
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00017833709716796875
----------------------check_connections_block total spend ----------------------------- 0.001659393310546875
generate_one_block  0.0018045902252197266
generate_one_block  0.0017497539520263672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007083415985107422
gen group dst list time:  4.458427429199219e-05
time for parepare:  0.00022554397583007812
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0010726451873779297
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0009822845458984375
----------------------check_connections_block total spend ----------------------------- 0.003693103790283203
generate_one_block  0.0024242401123046875
generate_one_block  0.001988649368286133
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006000995635986328
gen group dst list time:  6.079673767089844e-05
time for parepare:  0.0002067089080810547
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0003333091735839844
mini_batch_src_global generation:  0.00019216537475585938
r_  generation:  0.0018575191497802734
local_output_nid generation:  9.703636169433594e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.00022554397583007812
r_  generation:  0.0017735958099365234
----------------------check_connections_block total spend ----------------------------- 0.005883693695068359
generate_one_block  0.0032148361206054688
generate_one_block  0.003066539764404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013257980346679688  GigaBytes
Max Memory Allocated: 0.02181386947631836  GigaBytes

connection checking time:  0.009576797485351562
block generation total time  0.010694265365600586
average batch blocks generation time:  0.005347132682800293
block dataloader generation time/epoch 0.0387115478515625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013449668884277344  GigaBytes
Max Memory Allocated: 0.023562908172607422  GigaBytes
Using backend: pytorch

torch.Size([1967, 1433])
torch.Size([1170, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01479959487915039  GigaBytes
Max Memory Allocated: 0.023562908172607422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0130615234375  GigaBytes
Max Memory Allocated: 0.023562908172607422  GigaBytes

torch.Size([1895, 1433])
torch.Size([1123, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014343738555908203  GigaBytes
Max Memory Allocated: 0.023562908172607422  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028351545333862305 |0.0004061460494995117 |0.0031430721282958984 |0.00012409687042236328 |0.0019040107727050781 |0.0013539791107177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.9858143329620361
Total (block generation + training)time/epoch 0.05942821502685547
Training time/epoch 0.02012777328491211
Training time without block to device /epoch 0.019315481185913086
Training time without total dataloading part /epoch 0.011696338653564453
load block tensor time/epoch 0.005670309066772461
block to device time/epoch 0.0008122920989990234
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6845
Number of first layer input nodes during this epoch:  3862
