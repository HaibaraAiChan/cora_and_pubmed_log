main start at this time 1648428426.087475
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0018305778503417969
range selection method range initialization spend 0.0001480579376220703
time for parepare:  0.0001423358917236328
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.002250194549560547
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00011849403381347656
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.702278137207031e-05
----------------------check_connections_block total spend ----------------------------- 0.004091739654541016
generate_one_block  0.0017027854919433594
generate_one_block  0.0015330314636230469
generate_one_block  0.0014965534210205078
generate_one_block  0.0015044212341308594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006656646728515625
gen group dst list time:  5.0067901611328125e-05
time for parepare:  0.0001995563507080078
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005533695220947266
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005538463592529297
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004298686981201172
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0005588531494140625
----------------------check_connections_block total spend ----------------------------- 0.004056692123413086
generate_one_block  0.00189208984375
generate_one_block  0.0018455982208251953
generate_one_block  0.0016984939575195312
generate_one_block  0.0018603801727294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006878376007080078
gen group dst list time:  0.00010967254638671875
time for parepare:  0.0002181529998779297
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00032258033752441406
mini_batch_src_global generation:  0.00017023086547851562
r_  generation:  0.0017597675323486328
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.001617431640625
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  0.00013780593872070312
r_  generation:  0.0012505054473876953
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  0.00017142295837402344
r_  generation:  0.0017719268798828125
----------------------check_connections_block total spend ----------------------------- 0.010235786437988281
generate_one_block  0.0032618045806884766
generate_one_block  0.0026106834411621094
generate_one_block  0.002031087875366211
generate_one_block  0.0025787353515625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.014292478561401367
block generation total time  0.017778873443603516
average batch blocks generation time:  0.004444718360900879
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009497642517089844  GigaBytes
Max Memory Allocated: 0.009497642517089844  GigaBytes

torch.Size([1635, 1433])
torch.Size([831, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.01038217544555664  GigaBytes
Max Memory Allocated: 0.010522842407226562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00998687744140625  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

torch.Size([1592, 1433])
torch.Size([732, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010813713073730469  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00882863998413086  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

torch.Size([1377, 1433])
torch.Size([599, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009494781494140625  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010625362396240234  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

torch.Size([1711, 1433])
torch.Size([829, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011523723602294922  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005093991756439209 |0.08983361721038818 |0.19477391242980957 |0.00017720460891723633 |0.0037969350814819336 |0.0025606155395507812 |
----------------------------------------------------------pseudo_mini_loss sum 3.4229183197021484
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10034
Number of first layer input nodes during this epoch:  6315
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012172222137451172  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005791187286376953
range selection method range initialization spend 7.62939453125e-05
time for parepare:  7.510185241699219e-05
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001270771026611328
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  8.630752563476562e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.914138793945312e-05
----------------------check_connections_block total spend ----------------------------- 0.0015196800231933594
generate_one_block  0.0013895034790039062
generate_one_block  0.0013251304626464844
generate_one_block  0.0013117790222167969
generate_one_block  0.001073598861694336
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005018711090087891
gen group dst list time:  3.719329833984375e-05
time for parepare:  0.0001785755157470703
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00039267539978027344
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0004208087921142578
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0003883838653564453
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.000331878662109375
----------------------check_connections_block total spend ----------------------------- 0.0030601024627685547
generate_one_block  0.0015320777893066406
generate_one_block  0.0015130043029785156
generate_one_block  0.00145721435546875
generate_one_block  0.0013492107391357422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005490779876708984
gen group dst list time:  8.153915405273438e-05
time for parepare:  0.00017142295837402344
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0002562999725341797
mini_batch_src_global generation:  0.00011372566223144531
r_  generation:  0.0010993480682373047
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00015544891357421875
r_  generation:  0.0013854503631591797
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.00014448165893554688
r_  generation:  0.001241922378540039
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0011098384857177734
----------------------check_connections_block total spend ----------------------------- 0.007781982421875
generate_one_block  0.002275228500366211
generate_one_block  0.0025310516357421875
generate_one_block  0.002379179000854492
generate_one_block  0.002548694610595703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012172222137451172  GigaBytes
Max Memory Allocated: 0.018672943115234375  GigaBytes

connection checking time:  0.010842084884643555
block generation total time  0.015585660934448242
average batch blocks generation time:  0.0038964152336120605
block dataloader generation time/epoch 0.04312467575073242
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011016845703125  GigaBytes
Max Memory Allocated: 0.02011251449584961  GigaBytes

torch.Size([1516, 1433])
torch.Size([643, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011751174926757812  GigaBytes
Max Memory Allocated: 0.02011251449584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011836528778076172  GigaBytes
Max Memory Allocated: 0.02011251449584961  GigaBytes

torch.Size([1668, 1433])
torch.Size([856, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012751579284667969  GigaBytes
Max Memory Allocated: 0.02011251449584961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011410236358642578  GigaBytes
Max Memory Allocated: 0.020273208618164062  GigaBytes

torch.Size([1589, 1433])
torch.Size([786, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01226043701171875  GigaBytes
Max Memory Allocated: 0.020273208618164062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011411666870117188  GigaBytes
Max Memory Allocated: 0.020273208618164062  GigaBytes

torch.Size([1590, 1433])
torch.Size([674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012150287628173828  GigaBytes
Max Memory Allocated: 0.020273208618164062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025715231895446777 |0.0003655552864074707 |0.0028850436210632324 |9.673833847045898e-05 |0.003186941146850586 |0.0012087821960449219 |
----------------------------------------------------------pseudo_mini_loss sum 1.8329342603683472
Total (block generation + training)time/epoch 0.08453178405761719
Training time/epoch 0.041162967681884766
Training time without block to device /epoch 0.03970074653625488
Training time without total dataloading part /epoch 0.02588367462158203
load block tensor time/epoch 0.010286092758178711
block to device time/epoch 0.0014622211456298828
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10040
Number of first layer input nodes during this epoch:  6363
