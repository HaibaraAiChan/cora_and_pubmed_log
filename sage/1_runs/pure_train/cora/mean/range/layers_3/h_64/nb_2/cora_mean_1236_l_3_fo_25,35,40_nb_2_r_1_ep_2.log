main start at this time 1648428305.2539213
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012710094451904297
range selection method range initialization spend 8.368492126464844e-05
time for parepare:  6.175041198730469e-05
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0012860298156738281
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00011992454528808594
----------------------check_connections_block total spend ----------------------------- 0.002096414566040039
generate_one_block  0.0014069080352783203
generate_one_block  0.0011763572692871094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004949569702148438
gen group dst list time:  3.0994415283203125e-05
time for parepare:  0.000141143798828125
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00022029876708984375
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.0006804466247558594
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0006363391876220703
----------------------check_connections_block total spend ----------------------------- 0.0024280548095703125
generate_one_block  0.001867055892944336
generate_one_block  0.0017783641815185547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005626678466796875
gen group dst list time:  5.459785461425781e-05
time for parepare:  0.00018477439880371094
local_output_nid generation:  7.05718994140625e-05
local_in_edges_tensor generation:  0.0003154277801513672
mini_batch_src_global generation:  0.00013709068298339844
r_  generation:  0.001718759536743164
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00023818016052246094
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0015950202941894531
----------------------check_connections_block total spend ----------------------------- 0.005323171615600586
generate_one_block  0.0035152435302734375
generate_one_block  0.0028557777404785156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.0077512264251708984
block generation total time  0.010016441345214844
average batch blocks generation time:  0.005008220672607422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.01064920425415039  GigaBytes
Max Memory Allocated: 0.01064920425415039  GigaBytes

torch.Size([1848, 1433])
torch.Size([1093, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.011936187744140625  GigaBytes
Max Memory Allocated: 0.012013435363769531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011303424835205078  GigaBytes
Max Memory Allocated: 0.021114349365234375  GigaBytes

torch.Size([1836, 1433])
torch.Size([1037, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.01251983642578125  GigaBytes
Max Memory Allocated: 0.021114349365234375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016258835792541504 |0.17001569271087646 |0.38223493099212646 |0.00019085407257080078 |0.006137967109680176 |0.00458216667175293 |
----------------------------------------------------------pseudo_mini_loss sum 3.3427085876464844
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6505
Number of first layer input nodes during this epoch:  3684
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012872695922851562  GigaBytes
Max Memory Allocated: 0.021114349365234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009646415710449219
range selection method range initialization spend 0.0001227855682373047
time for parepare:  0.0001285076141357422
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00020575523376464844
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00017571449279785156
----------------------check_connections_block total spend ----------------------------- 0.0012977123260498047
generate_one_block  0.0017642974853515625
generate_one_block  0.0016694068908691406
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006957054138183594
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.0002257823944091797
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0010280609130859375
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00022077560424804688
mini_batch_src_global generation:  0.00011348724365234375
r_  generation:  0.0009362697601318359
----------------------check_connections_block total spend ----------------------------- 0.0035593509674072266
generate_one_block  0.002192974090576172
generate_one_block  0.0019314289093017578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005834102630615234
gen group dst list time:  5.817413330078125e-05
time for parepare:  0.00018596649169921875
local_output_nid generation:  7.367134094238281e-05
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0017881393432617188
local_output_nid generation:  7.557868957519531e-05
local_in_edges_tensor generation:  0.00024008750915527344
mini_batch_src_global generation:  0.00018262863159179688
r_  generation:  0.0016753673553466797
----------------------check_connections_block total spend ----------------------------- 0.005502462387084961
generate_one_block  0.00313568115234375
generate_one_block  0.0027840137481689453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012872695922851562  GigaBytes
Max Memory Allocated: 0.021114349365234375  GigaBytes

connection checking time:  0.009061813354492188
block generation total time  0.010044097900390625
average batch blocks generation time:  0.0050220489501953125
block dataloader generation time/epoch 0.03739166259765625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013147830963134766  GigaBytes
Max Memory Allocated: 0.022890090942382812  GigaBytes
Using backend: pytorch

torch.Size([1911, 1433])
torch.Size([1115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014451980590820312  GigaBytes
Max Memory Allocated: 0.022890090942382812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012828826904296875  GigaBytes
Max Memory Allocated: 0.022976398468017578  GigaBytes

torch.Size([1852, 1433])
torch.Size([1056, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014055252075195312  GigaBytes
Max Memory Allocated: 0.022976398468017578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029064416885375977 |0.000396728515625 |0.003040313720703125 |0.0001252889633178711 |0.0020923614501953125 |0.0012845993041992188 |
----------------------------------------------------------pseudo_mini_loss sum 1.9728063344955444
Total (block generation + training)time/epoch 0.05801701545715332
Training time/epoch 0.020392417907714844
Training time without block to device /epoch 0.019598960876464844
Training time without total dataloading part /epoch 0.011800527572631836
load block tensor time/epoch 0.005812883377075195
block to device time/epoch 0.00079345703125
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6624
Number of first layer input nodes during this epoch:  3763
