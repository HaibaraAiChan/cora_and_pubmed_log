main start at this time 1648428388.5506625
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013146400451660156
range selection method range initialization spend 0.00010991096496582031
time for parepare:  6.747245788574219e-05
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.002628803253173828
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  8.845329284667969e-05
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  6.29425048828125e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.532669067382812e-05
----------------------check_connections_block total spend ----------------------------- 0.003904581069946289
generate_one_block  0.0014662742614746094
generate_one_block  0.001232147216796875
generate_one_block  0.0012004375457763672
generate_one_block  0.0011951923370361328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005161762237548828
gen group dst list time:  4.267692565917969e-05
time for parepare:  0.0001537799835205078
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00046944618225097656
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014734268188476562
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00046539306640625
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003514289855957031
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0002243518829345703
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0004642009735107422
----------------------check_connections_block total spend ----------------------------- 0.003445148468017578
generate_one_block  0.0017130374908447266
generate_one_block  0.0016665458679199219
generate_one_block  0.0015294551849365234
generate_one_block  0.0018312931060791016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005800724029541016
gen group dst list time:  8.273124694824219e-05
time for parepare:  0.0001804828643798828
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0014238357543945312
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.001306295394897461
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  0.00011229515075683594
r_  generation:  0.0010020732879638672
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0014095306396484375
----------------------check_connections_block total spend ----------------------------- 0.008289337158203125
generate_one_block  0.0027201175689697266
generate_one_block  0.0025823116302490234
generate_one_block  0.0021402835845947266
generate_one_block  0.002562284469604492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.011734485626220703
block generation total time  0.016745328903198242
average batch blocks generation time:  0.0041863322257995605
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009331226348876953  GigaBytes
Max Memory Allocated: 0.009331226348876953  GigaBytes

torch.Size([1604, 1433])
torch.Size([830, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.010213375091552734  GigaBytes
Max Memory Allocated: 0.010346412658691406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00964975357055664  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

torch.Size([1529, 1433])
torch.Size([733, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010477066040039062  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008646488189697266  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

torch.Size([1343, 1433])
torch.Size([599, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009311676025390625  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010463237762451172  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

torch.Size([1681, 1433])
torch.Size([831, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011361122131347656  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011137604713439941 |0.08664709329605103 |0.19499242305755615 |0.00020307302474975586 |0.00485992431640625 |0.0038728713989257812 |
----------------------------------------------------------pseudo_mini_loss sum 3.4285483360290527
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9878
Number of first layer input nodes during this epoch:  6157
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012006282806396484  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005714893341064453
range selection method range initialization spend 7.557868957519531e-05
time for parepare:  7.987022399902344e-05
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001068115234375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013566017150878906
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.796287536621094e-05
----------------------check_connections_block total spend ----------------------------- 0.0016002655029296875
generate_one_block  0.0014035701751708984
generate_one_block  0.0013437271118164062
generate_one_block  0.0013263225555419922
generate_one_block  0.0013058185577392578
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006082057952880859
gen group dst list time:  4.076957702636719e-05
time for parepare:  0.00015425682067871094
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00039267539978027344
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.0004165172576904297
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004010200500488281
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003314018249511719
----------------------check_connections_block total spend ----------------------------- 0.003063201904296875
generate_one_block  0.001544952392578125
generate_one_block  0.0014827251434326172
generate_one_block  0.0014486312866210938
generate_one_block  0.0013949871063232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005309581756591797
gen group dst list time:  8.606910705566406e-05
time for parepare:  0.0001766681671142578
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.0002601146697998047
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0010845661163330078
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00021123886108398438
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0012934207916259766
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0012164115905761719
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0010678768157958984
----------------------check_connections_block total spend ----------------------------- 0.007564544677734375
generate_one_block  0.0022554397583007812
generate_one_block  0.0025136470794677734
generate_one_block  0.002427816390991211
generate_one_block  0.002522706985473633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012006282806396484  GigaBytes
Max Memory Allocated: 0.018171310424804688  GigaBytes

connection checking time:  0.01062774658203125
block generation total time  0.015590906143188477
average batch blocks generation time:  0.003897726535797119
block dataloader generation time/epoch 0.04533720016479492
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010652542114257812  GigaBytes
Max Memory Allocated: 0.019588947296142578  GigaBytes

torch.Size([1448, 1433])
torch.Size([643, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011385917663574219  GigaBytes
Max Memory Allocated: 0.019588947296142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011680126190185547  GigaBytes
Max Memory Allocated: 0.019588947296142578  GigaBytes

torch.Size([1639, 1433])
torch.Size([853, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012591838836669922  GigaBytes
Max Memory Allocated: 0.019588947296142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011286258697509766  GigaBytes
Max Memory Allocated: 0.019995689392089844  GigaBytes

torch.Size([1566, 1433])
torch.Size([784, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012133598327636719  GigaBytes
Max Memory Allocated: 0.019995689392089844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011090278625488281  GigaBytes
Max Memory Allocated: 0.019995689392089844  GigaBytes

torch.Size([1530, 1433])
torch.Size([674, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011827945709228516  GigaBytes
Max Memory Allocated: 0.019995689392089844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001577615737915039 |0.0004881620407104492 |0.0034900307655334473 |0.00012046098709106445 |0.0018115639686584473 |0.0016412734985351562 |
----------------------------------------------------------pseudo_mini_loss sum 1.7782245874404907
Total (block generation + training)time/epoch 0.08196401596069336
Training time/epoch 0.0362856388092041
Training time without block to device /epoch 0.034332990646362305
Training time without total dataloading part /epoch 0.023329496383666992
load block tensor time/epoch 0.006310462951660156
block to device time/epoch 0.0019526481628417969
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9855
Number of first layer input nodes during this epoch:  6183
