main start at this time 1648428350.6999772
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008080005645751953
range selection method range initialization spend 0.000110626220703125
time for parepare:  6.4849853515625e-05
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0023376941680908203
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  6.29425048828125e-05
----------------------check_connections_block total spend ----------------------------- 0.0035893917083740234
generate_one_block  0.001524209976196289
generate_one_block  0.001178741455078125
generate_one_block  0.0011410713195800781
generate_one_block  0.001161336898803711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004975795745849609
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00014281272888183594
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00042510032653808594
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004374980926513672
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003192424774169922
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004253387451171875
----------------------check_connections_block total spend ----------------------------- 0.0031766891479492188
generate_one_block  0.0015997886657714844
generate_one_block  0.0015931129455566406
generate_one_block  0.001440286636352539
generate_one_block  0.0015723705291748047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.00017547607421875
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.0002903938293457031
mini_batch_src_global generation:  0.00011324882507324219
r_  generation:  0.0012621879577636719
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00014853477478027344
r_  generation:  0.0012166500091552734
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0008635520935058594
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0012671947479248047
----------------------check_connections_block total spend ----------------------------- 0.007523775100708008
generate_one_block  0.002583742141723633
generate_one_block  0.003027200698852539
generate_one_block  0.001985311508178711
generate_one_block  0.0026884078979492188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.010700464248657227
block generation total time  0.01649022102355957
average batch blocks generation time:  0.004122555255889893
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008868217468261719  GigaBytes
Max Memory Allocated: 0.008868217468261719  GigaBytes

torch.Size([1518, 1433])
torch.Size([747, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009682178497314453  GigaBytes
Max Memory Allocated: 0.009800434112548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009422779083251953  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

torch.Size([1487, 1433])
torch.Size([695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010217666625976562  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007916450500488281  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

torch.Size([1207, 1433])
torch.Size([528, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00852203369140625  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009915828704833984  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

torch.Size([1579, 1433])
torch.Size([759, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010754108428955078  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00964277982711792 |0.08625823259353638 |0.19420325756072998 |0.00020271539688110352 |0.005103468894958496 |0.003938913345336914 |
----------------------------------------------------------pseudo_mini_loss sum 3.4013991355895996
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9248
Number of first layer input nodes during this epoch:  5791
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01145172119140625  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009911060333251953
range selection method range initialization spend 8.058547973632812e-05
time for parepare:  8.320808410644531e-05
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00011277198791503906
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001494884490966797
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.82012939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.0016558170318603516
generate_one_block  0.0014536380767822266
generate_one_block  0.001363515853881836
generate_one_block  0.001352071762084961
generate_one_block  0.0013399124145507812
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004820823669433594
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0001475811004638672
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  6.508827209472656e-05
r_  generation:  0.00038552284240722656
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004334449768066406
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003838539123535156
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0003325939178466797
----------------------check_connections_block total spend ----------------------------- 0.003047943115234375
generate_one_block  0.0015385150909423828
generate_one_block  0.001481771469116211
generate_one_block  0.0014414787292480469
generate_one_block  0.0013935565948486328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000553131103515625
gen group dst list time:  7.462501525878906e-05
time for parepare:  0.00017976760864257812
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0010528564453125
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.0012614727020263672
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  0.00012254714965820312
r_  generation:  0.0011403560638427734
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00018548965454101562
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0010595321655273438
----------------------check_connections_block total spend ----------------------------- 0.007334232330322266
generate_one_block  0.002401590347290039
generate_one_block  0.0025031566619873047
generate_one_block  0.0023550987243652344
generate_one_block  0.002445697784423828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01145172119140625  GigaBytes
Max Memory Allocated: 0.01748800277709961  GigaBytes

connection checking time:  0.01038217544555664
block generation total time  0.01556086540222168
average batch blocks generation time:  0.00389021635055542
block dataloader generation time/epoch 0.04620051383972168
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010389328002929688  GigaBytes
Max Memory Allocated: 0.018783092498779297  GigaBytes

torch.Size([1399, 1433])
torch.Size([605, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011090278625488281  GigaBytes
Max Memory Allocated: 0.018783092498779297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01141977310180664  GigaBytes
Max Memory Allocated: 0.018847942352294922  GigaBytes

torch.Size([1591, 1433])
torch.Size([767, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012259960174560547  GigaBytes
Max Memory Allocated: 0.018847942352294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010786056518554688  GigaBytes
Max Memory Allocated: 0.01924276351928711  GigaBytes

torch.Size([1473, 1433])
torch.Size([697, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011562347412109375  GigaBytes
Max Memory Allocated: 0.01924276351928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01071929931640625  GigaBytes
Max Memory Allocated: 0.01924276351928711  GigaBytes

torch.Size([1461, 1433])
torch.Size([617, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011409759521484375  GigaBytes
Max Memory Allocated: 0.01924276351928711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002441704273223877 |0.0003834366798400879 |0.003061532974243164 |0.00010532140731811523 |0.003251194953918457 |0.0013043880462646484 |
----------------------------------------------------------pseudo_mini_loss sum 1.8240435123443604
Total (block generation + training)time/epoch 0.08856916427612305
Training time/epoch 0.042037248611450195
Training time without block to device /epoch 0.040503501892089844
Training time without total dataloading part /epoch 0.026976585388183594
load block tensor time/epoch 0.009766817092895508
block to device time/epoch 0.0015337467193603516
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9328
Number of first layer input nodes during this epoch:  5924
