main start at this time 1648428369.4664433
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008327960968017578
range selection method range initialization spend 0.00010204315185546875
time for parepare:  7.724761962890625e-05
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.001638174057006836
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.218650817871094e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.790855407714844e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.71661376953125e-05
----------------------check_connections_block total spend ----------------------------- 0.005288839340209961
generate_one_block  0.0015025138854980469
generate_one_block  0.0013470649719238281
generate_one_block  0.001394033432006836
generate_one_block  0.0013153553009033203
generate_one_block  0.001321554183959961
generate_one_block  0.0013148784637451172
generate_one_block  0.001142740249633789
generate_one_block  0.001157999038696289
generate_one_block  0.0011286735534667969
generate_one_block  0.0011336803436279297
generate_one_block  0.001173257827758789
generate_one_block  0.0010721683502197266
generate_one_block  0.0010173320770263672
generate_one_block  0.001033782958984375
generate_one_block  0.001024484634399414
generate_one_block  0.0011250972747802734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000606536865234375
gen group dst list time:  0.00012373924255371094
time for parepare:  0.0001990795135498047
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00018906593322753906
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001544952392578125
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.00017333030700683594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00026035308837890625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010442733764648438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00010418891906738281
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00016236305236816406
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00026154518127441406
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  4.696846008300781e-05
----------------------check_connections_block total spend ----------------------------- 0.006635904312133789
generate_one_block  0.0015299320220947266
generate_one_block  0.0015277862548828125
generate_one_block  0.0014574527740478516
generate_one_block  0.0014667510986328125
generate_one_block  0.0014061927795410156
generate_one_block  0.001285552978515625
generate_one_block  0.0011622905731201172
generate_one_block  0.0012230873107910156
generate_one_block  0.0011839866638183594
generate_one_block  0.0010879039764404297
generate_one_block  0.0010890960693359375
generate_one_block  0.0011105537414550781
generate_one_block  0.0011658668518066406
generate_one_block  0.0012700557708740234
generate_one_block  0.001255035400390625
generate_one_block  0.001024007797241211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007092952728271484
gen group dst list time:  0.00018835067749023438
time for parepare:  0.00027298927307128906
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005214214324951172
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00017404556274414062
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0006201267242431641
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0005712509155273438
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005056858062744141
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0002841949462890625
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0006022453308105469
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0006666183471679688
local_output_nid generation:  3.8623809814453125e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  9.489059448242188e-05
r_  generation:  0.0008597373962402344
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0005288124084472656
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003058910369873047
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003345012664794922
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005772113800048828
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00010037422180175781
r_  generation:  0.0009438991546630859
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0004899501800537109
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00012826919555664062
----------------------check_connections_block total spend ----------------------------- 0.015520811080932617
generate_one_block  0.0016362667083740234
generate_one_block  0.0016903877258300781
generate_one_block  0.0013844966888427734
generate_one_block  0.0015082359313964844
generate_one_block  0.0021500587463378906
generate_one_block  0.0014581680297851562
generate_one_block  0.001779794692993164
generate_one_block  0.001703500747680664
generate_one_block  0.0014121532440185547
generate_one_block  0.0011763572692871094
generate_one_block  0.0011982917785644531
generate_one_block  0.0012438297271728516
generate_one_block  0.0014591217041015625
generate_one_block  0.001804351806640625
generate_one_block  0.001453399658203125
generate_one_block  0.0010483264923095703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.022156715393066406
block generation total time  0.04435229301452637
average batch blocks generation time:  0.002772018313407898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.003859996795654297  GigaBytes
Max Memory Allocated: 0.003859996795654297  GigaBytes

torch.Size([585, 1433])
torch.Size([210, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0040836334228515625  GigaBytes
Max Memory Allocated: 0.004161357879638672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005064487457275391  GigaBytes
Max Memory Allocated: 0.008172035217285156  GigaBytes

torch.Size([675, 1433])
torch.Size([260, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005350589752197266  GigaBytes
Max Memory Allocated: 0.008172035217285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004580497741699219  GigaBytes
Max Memory Allocated: 0.008172035217285156  GigaBytes

torch.Size([569, 1433])
torch.Size([177, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004794120788574219  GigaBytes
Max Memory Allocated: 0.008172035217285156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005591392517089844  GigaBytes
Max Memory Allocated: 0.008700847625732422  GigaBytes

torch.Size([774, 1433])
torch.Size([269, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005854606628417969  GigaBytes
Max Memory Allocated: 0.008700847625732422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004602909088134766  GigaBytes
Max Memory Allocated: 0.008722305297851562  GigaBytes

torch.Size([589, 1433])
torch.Size([207, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004826545715332031  GigaBytes
Max Memory Allocated: 0.008722305297851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005320072174072266  GigaBytes
Max Memory Allocated: 0.008722305297851562  GigaBytes

torch.Size([723, 1433])
torch.Size([239, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005574226379394531  GigaBytes
Max Memory Allocated: 0.008722305297851562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006062984466552734  GigaBytes
Max Memory Allocated: 0.009907245635986328  GigaBytes

torch.Size([862, 1433])
torch.Size([258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0063457489013671875  GigaBytes
Max Memory Allocated: 0.009907245635986328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006789207458496094  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

torch.Size([997, 1433])
torch.Size([361, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007182598114013672  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005291461944580078  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

torch.Size([718, 1433])
torch.Size([230, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005537986755371094  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0033659934997558594  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

torch.Size([346, 1433])
torch.Size([134, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003524303436279297  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037703514099121094  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

torch.Size([434, 1433])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003917217254638672  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004022121429443359  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

torch.Size([481, 1433])
torch.Size([159, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004200458526611328  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005452632904052734  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

torch.Size([748, 1433])
torch.Size([270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005732059478759766  GigaBytes
Max Memory Allocated: 0.011369705200195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00768280029296875  GigaBytes
Max Memory Allocated: 0.011652946472167969  GigaBytes

torch.Size([1164, 1433])
torch.Size([423, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008118629455566406  GigaBytes
Max Memory Allocated: 0.011652946472167969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005897998809814453  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([750, 1433])
torch.Size([243, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0061626434326171875  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002399921417236328  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([178, 1433])
torch.Size([43, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.002460479736328125  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003987565636634827 |0.021883487701416016 |0.050474196672439575 |0.00011795759201049805 |0.003288552165031433 |0.0023283958435058594 |
----------------------------------------------------------pseudo_mini_loss sum 3.4522552490234375
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14958
Number of first layer input nodes during this epoch:  10593
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003852367401123047  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004658699035644531
range selection method range initialization spend 6.365776062011719e-05
time for parepare:  6.532669067382812e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.6450881958007812e-05
----------------------check_connections_block total spend ----------------------------- 0.0030591487884521484
generate_one_block  0.0010521411895751953
generate_one_block  0.0010211467742919922
generate_one_block  0.0010366439819335938
generate_one_block  0.0010156631469726562
generate_one_block  0.0010247230529785156
generate_one_block  0.0010256767272949219
generate_one_block  0.0011925697326660156
generate_one_block  0.0010154247283935547
generate_one_block  0.0010225772857666016
generate_one_block  0.0010104179382324219
generate_one_block  0.0009629726409912109
generate_one_block  0.0009477138519287109
generate_one_block  0.0009438991546630859
generate_one_block  0.0009520053863525391
generate_one_block  0.0009522438049316406
generate_one_block  0.0009372234344482422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006272792816162109
gen group dst list time:  9.298324584960938e-05
time for parepare:  0.0001442432403564453
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.00013494491577148438
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00016260147094726562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.0001220703125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001723766326904297
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00015878677368164062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00013017654418945312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  9.846687316894531e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.200241088867188e-05
----------------------check_connections_block total spend ----------------------------- 0.00537419319152832
generate_one_block  0.0011799335479736328
generate_one_block  0.0011973381042480469
generate_one_block  0.0012729167938232422
generate_one_block  0.0011415481567382812
generate_one_block  0.0011565685272216797
generate_one_block  0.001230478286743164
generate_one_block  0.0011262893676757812
generate_one_block  0.0011105537414550781
generate_one_block  0.001165628433227539
generate_one_block  0.0010426044464111328
generate_one_block  0.0010802745819091797
generate_one_block  0.0010859966278076172
generate_one_block  0.0010578632354736328
generate_one_block  0.0010294914245605469
generate_one_block  0.0010378360748291016
generate_one_block  0.0010707378387451172
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006854534149169922
gen group dst list time:  0.00014281272888183594
time for parepare:  0.0002357959747314453
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.0004973411560058594
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0001571178436279297
mini_batch_src_global generation:  9.179115295410156e-05
r_  generation:  0.0005953311920166016
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014781951904296875
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005207061767578125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003952980041503906
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004248619079589844
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0005412101745605469
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.00044155120849609375
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0003535747528076172
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004951953887939453
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00036263465881347656
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004258155822753906
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0004811286926269531
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014400482177734375
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00040268898010253906
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0003032684326171875
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00031876564025878906
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002484321594238281
----------------------check_connections_block total spend ----------------------------- 0.012762069702148438
generate_one_block  0.0016252994537353516
generate_one_block  0.0017096996307373047
generate_one_block  0.0015749931335449219
generate_one_block  0.0014116764068603516
generate_one_block  0.001425027847290039
generate_one_block  0.0015473365783691406
generate_one_block  0.0014197826385498047
generate_one_block  0.0013358592987060547
generate_one_block  0.0014963150024414062
generate_one_block  0.0013501644134521484
generate_one_block  0.0014164447784423828
generate_one_block  0.0015697479248046875
generate_one_block  0.0013918876647949219
generate_one_block  0.0012650489807128906
generate_one_block  0.0012969970703125
generate_one_block  0.0012137889862060547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003852367401123047  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

connection checking time:  0.018136262893676758
block generation total time  0.041036128997802734
average batch blocks generation time:  0.002564758062362671
block dataloader generation time/epoch 0.09198379516601562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007004737854003906  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([769, 1433])
torch.Size([255, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007271289825439453  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007511138916015625  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([863, 1433])
torch.Size([306, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007825851440429688  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007007598876953125  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([742, 1433])
torch.Size([244, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007289409637451172  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005940437316894531  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([570, 1433])
torch.Size([191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006154537200927734  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0070037841796875  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([679, 1433])
torch.Size([230, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007256507873535156  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007061004638671875  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([779, 1433])
torch.Size([308, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007391452789306641  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007004737854003906  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([684, 1433])
torch.Size([201, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007228851318359375  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0059223175048828125  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([567, 1433])
torch.Size([200, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006132602691650391  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007006645202636719  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([769, 1433])
torch.Size([270, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007310390472412109  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00601959228515625  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([585, 1433])
torch.Size([191, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006222724914550781  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0070037841796875  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes
Using backend: pytorch

torch.Size([670, 1433])
torch.Size([237, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007266998291015625  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006577491760253906  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([689, 1433])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006836414337158203  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007002830505371094  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([671, 1433])
torch.Size([219, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0072307586669921875  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005329132080078125  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([456, 1433])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0055027008056640625  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0060024261474609375  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([582, 1433])
torch.Size([144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006183624267578125  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0052318572998046875  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

torch.Size([438, 1433])
torch.Size([122, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005364894866943359  GigaBytes
Max Memory Allocated: 0.012098312377929688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0011526495218276978 |0.0004626959562301636 |0.0036546289920806885 |0.00011737644672393799 |0.0030931085348129272 |0.0015244483947753906 |
----------------------------------------------------------pseudo_mini_loss sum 1.9307681322097778
Total (block generation + training)time/epoch 0.2464456558227539
Training time/epoch 0.15417146682739258
Training time without block to device /epoch 0.14676833152770996
Training time without total dataloading part /epoch 0.11136627197265625
load block tensor time/epoch 0.018442392349243164
block to device time/epoch 0.007403135299682617
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  14799
Number of first layer input nodes during this epoch:  10513
