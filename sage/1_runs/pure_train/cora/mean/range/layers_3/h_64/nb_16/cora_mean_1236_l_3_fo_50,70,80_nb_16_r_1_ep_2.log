main start at this time 1648428444.599179
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008730888366699219
range selection method range initialization spend 0.00010824203491210938
time for parepare:  7.390975952148438e-05
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0002193450927734375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0022804737091064453
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.005542278289794922
generate_one_block  0.0014688968658447266
generate_one_block  0.0011382102966308594
generate_one_block  0.001173257827758789
generate_one_block  0.0011124610900878906
generate_one_block  0.001112222671508789
generate_one_block  0.0011210441589355469
generate_one_block  0.0011210441589355469
generate_one_block  0.0011298656463623047
generate_one_block  0.0036258697509765625
generate_one_block  0.001149892807006836
generate_one_block  0.001108407974243164
generate_one_block  0.0010161399841308594
generate_one_block  0.0010290145874023438
generate_one_block  0.0010371208190917969
generate_one_block  0.0010213851928710938
generate_one_block  0.001119375228881836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007641315460205078
gen group dst list time:  9.655952453613281e-05
time for parepare:  0.00016236305236816406
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00013875961303710938
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001366138458251953
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.0001316070556640625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00016164779663085938
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00015115737915039062
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.989738464355469e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00015163421630859375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00024890899658203125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0001518726348876953
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.1484832763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.005919694900512695
generate_one_block  0.0013251304626464844
generate_one_block  0.0012996196746826172
generate_one_block  0.0012409687042236328
generate_one_block  0.0012807846069335938
generate_one_block  0.001247406005859375
generate_one_block  0.0012683868408203125
generate_one_block  0.0013010501861572266
generate_one_block  0.0013184547424316406
generate_one_block  0.0012438297271728516
generate_one_block  0.0010592937469482422
generate_one_block  0.001009225845336914
generate_one_block  0.0010547637939453125
generate_one_block  0.0011055469512939453
generate_one_block  0.0012161731719970703
generate_one_block  0.0010881423950195312
generate_one_block  0.001035451889038086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007085800170898438
gen group dst list time:  0.0001647472381591797
time for parepare:  0.00022411346435546875
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.0002315044403076172
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00048351287841796875
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0005939006805419922
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0003924369812011719
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0006194114685058594
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.00048542022705078125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005750656127929688
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0006740093231201172
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0007991790771484375
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005769729614257812
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.00029349327087402344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.00027632713317871094
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  4.9114227294921875e-05
r_  generation:  0.00040602684020996094
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0006132125854492188
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.00010085105895996094
r_  generation:  0.000949859619140625
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0005576610565185547
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.0001316070556640625
----------------------check_connections_block total spend ----------------------------- 0.015146493911743164
generate_one_block  0.0015950202941894531
generate_one_block  0.001682281494140625
generate_one_block  0.0013763904571533203
generate_one_block  0.0015897750854492188
generate_one_block  0.0014281272888183594
generate_one_block  0.0015234947204589844
generate_one_block  0.001949310302734375
generate_one_block  0.0018908977508544922
generate_one_block  0.0015480518341064453
generate_one_block  0.001233816146850586
generate_one_block  0.0012199878692626953
generate_one_block  0.001600027084350586
generate_one_block  0.0015892982482910156
generate_one_block  0.001960277557373047
generate_one_block  0.0015184879302978516
generate_one_block  0.001062154769897461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.02106618881225586
block generation total time  0.04386162757873535
average batch blocks generation time:  0.0027413517236709595
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004043102264404297  GigaBytes
Max Memory Allocated: 0.004043102264404297  GigaBytes

torch.Size([619, 1433])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004279136657714844  GigaBytes
Max Memory Allocated: 0.004364490509033203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005269527435302734  GigaBytes
Max Memory Allocated: 0.008556365966796875  GigaBytes

torch.Size([713, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0055789947509765625  GigaBytes
Max Memory Allocated: 0.008556365966796875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004826068878173828  GigaBytes
Max Memory Allocated: 0.008620738983154297  GigaBytes

torch.Size([631, 1433])
torch.Size([182, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005042552947998047  GigaBytes
Max Memory Allocated: 0.008620738983154297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006358623504638672  GigaBytes
Max Memory Allocated: 0.009709835052490234  GigaBytes

torch.Size([917, 1433])
torch.Size([341, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0066814422607421875  GigaBytes
Max Memory Allocated: 0.009709835052490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0048503875732421875  GigaBytes
Max Memory Allocated: 0.009731292724609375  GigaBytes

torch.Size([635, 1433])
torch.Size([227, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005091667175292969  GigaBytes
Max Memory Allocated: 0.009731292724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006357669830322266  GigaBytes
Max Memory Allocated: 0.009731292724609375  GigaBytes

torch.Size([820, 1433])
torch.Size([258, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006628990173339844  GigaBytes
Max Memory Allocated: 0.009731292724609375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006777763366699219  GigaBytes
Max Memory Allocated: 0.011652946472167969  GigaBytes

torch.Size([995, 1433])
torch.Size([315, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007110118865966797  GigaBytes
Max Memory Allocated: 0.011652946472167969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007368564605712891  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

torch.Size([1105, 1433])
torch.Size([390, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007787227630615234  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006096839904785156  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

torch.Size([868, 1433])
torch.Size([297, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006402015686035156  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036478042602539062  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

torch.Size([411, 1433])
torch.Size([163, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003830432891845703  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004144191741943359  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

torch.Size([504, 1433])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004291057586669922  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004944324493408203  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

torch.Size([653, 1433])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005176067352294922  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006134033203125  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

torch.Size([875, 1433])
torch.Size([333, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006466865539550781  GigaBytes
Max Memory Allocated: 0.012656211853027344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008473396301269531  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([1311, 1433])
torch.Size([501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008975505828857422  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005812168121337891  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([815, 1433])
torch.Size([276, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006104469299316406  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0025763511657714844  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([211, 1433])
torch.Size([43, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0026369094848632812  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005566194653511047 |0.022257640957832336 |0.04999475181102753 |0.00011265277862548828 |0.003074824810028076 |0.0021867752075195312 |
----------------------------------------------------------pseudo_mini_loss sum 3.4476513862609863
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  17024
Number of first layer input nodes during this epoch:  12083
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004028797149658203  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046253204345703125
range selection method range initialization spend 6.866455078125e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  4.9591064453125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0030684471130371094
generate_one_block  0.001062154769897461
generate_one_block  0.001032114028930664
generate_one_block  0.0010254383087158203
generate_one_block  0.0009930133819580078
generate_one_block  0.0010018348693847656
generate_one_block  0.0010275840759277344
generate_one_block  0.0011591911315917969
generate_one_block  0.0009920597076416016
generate_one_block  0.0010344982147216797
generate_one_block  0.0010051727294921875
generate_one_block  0.0009596347808837891
generate_one_block  0.0009455680847167969
generate_one_block  0.0009586811065673828
generate_one_block  0.0009508132934570312
generate_one_block  0.0009529590606689453
generate_one_block  0.0009524822235107422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005600452423095703
gen group dst list time:  9.584426879882812e-05
time for parepare:  0.0001804828643798828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0001819133758544922
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00016617774963378906
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001270771026611328
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001621246337890625
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00010800361633300781
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00013327598571777344
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.940696716308594e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  9.560585021972656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.867813110351562e-05
----------------------check_connections_block total spend ----------------------------- 0.005547523498535156
generate_one_block  0.0011665821075439453
generate_one_block  0.0012102127075195312
generate_one_block  0.0012483596801757812
generate_one_block  0.0011239051818847656
generate_one_block  0.00115966796875
generate_one_block  0.0012097358703613281
generate_one_block  0.0011188983917236328
generate_one_block  0.0011162757873535156
generate_one_block  0.0011260509490966797
generate_one_block  0.0010569095611572266
generate_one_block  0.0010981559753417969
generate_one_block  0.0011053085327148438
generate_one_block  0.0010864734649658203
generate_one_block  0.0010333061218261719
generate_one_block  0.0010471343994140625
generate_one_block  0.0010738372802734375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006899833679199219
gen group dst list time:  0.0001964569091796875
time for parepare:  0.0002200603485107422
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0002567768096923828
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0005638599395751953
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0006854534149169922
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005624294281005859
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00042939186096191406
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0005006790161132812
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0006382465362548828
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.0004971027374267578
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004296302795410156
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.0005490779876708984
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004131793975830078
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004799365997314453
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005662441253662109
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005118846893310547
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.125999450683594e-05
r_  generation:  0.0003261566162109375
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.76837158203125e-05
r_  generation:  0.0003364086151123047
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00031304359436035156
----------------------check_connections_block total spend ----------------------------- 0.014151334762573242
generate_one_block  0.001680135726928711
generate_one_block  0.0017702579498291016
generate_one_block  0.0015556812286376953
generate_one_block  0.0014524459838867188
generate_one_block  0.0015552043914794922
generate_one_block  0.00185394287109375
generate_one_block  0.0014917850494384766
generate_one_block  0.0013942718505859375
generate_one_block  0.0015382766723632812
generate_one_block  0.001409769058227539
generate_one_block  0.0014412403106689453
generate_one_block  0.0016825199127197266
generate_one_block  0.0015225410461425781
generate_one_block  0.0012788772583007812
generate_one_block  0.0013184547424316406
generate_one_block  0.0013163089752197266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004028797149658203  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

connection checking time:  0.0196988582611084
block generation total time  0.04224252700805664
average batch blocks generation time:  0.00264015793800354
block dataloader generation time/epoch 0.0957341194152832
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007563591003417969  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([873, 1433])
torch.Size([294, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00786447525024414  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008385658264160156  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([971, 1433])
torch.Size([357, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008744239807128906  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007307529449462891  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([825, 1433])
torch.Size([261, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007605075836181641  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006118297576904297  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([603, 1433])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006350040435791016  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007061004638671875  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([779, 1433])
torch.Size([263, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007344722747802734  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00798797607421875  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([952, 1433])
torch.Size([370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008370399475097656  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006926536560058594  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([754, 1433])
torch.Size([231, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007175445556640625  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006474971771240234  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([670, 1433])
torch.Size([242, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006721019744873047  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007493019104003906  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([860, 1433])
torch.Size([302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007822513580322266  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006581783294677734  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([690, 1433])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006810188293457031  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006829261779785156  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes
Using backend: pytorch

torch.Size([736, 1433])
torch.Size([267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007118701934814453  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007147312164306641  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([795, 1433])
torch.Size([304, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007451057434082031  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007406711578369141  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([844, 1433])
torch.Size([287, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007691860198974609  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005687713623046875  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([523, 1433])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005868434906005859  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006275653839111328  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([633, 1433])
torch.Size([144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006457805633544922  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006023883819580078  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

torch.Size([586, 1433])
torch.Size([156, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006186008453369141  GigaBytes
Max Memory Allocated: 0.013115406036376953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001300707459449768 |0.00044752657413482666 |0.0035354644060134888 |0.00011111795902252197 |0.0030563771724700928 |0.0014488697052001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.9930695295333862
Total (block generation + training)time/epoch 0.24914216995239258
Training time/epoch 0.15304279327392578
Training time without block to device /epoch 0.14588236808776855
Training time without total dataloading part /epoch 0.10869622230529785
load block tensor time/epoch 0.02081131935119629
block to device time/epoch 0.0071604251861572266
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16931
Number of first layer input nodes during this epoch:  12094
