main start at this time 1648428407.2195766
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002174854278564453
range selection method range initialization spend 0.00017189979553222656
time for parepare:  0.0001385211944580078
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0003516674041748047
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.003296375274658203
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00018095970153808594
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.935264587402344e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.62396240234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.7206878662109375e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  2.1696090698242188e-05
----------------------check_connections_block total spend ----------------------------- 0.007993698120117188
generate_one_block  0.001861572265625
generate_one_block  0.0014088153839111328
generate_one_block  0.0010802745819091797
generate_one_block  0.0010068416595458984
generate_one_block  0.0010046958923339844
generate_one_block  0.0010106563568115234
generate_one_block  0.0010151863098144531
generate_one_block  0.0010259151458740234
generate_one_block  0.0010027885437011719
generate_one_block  0.001008749008178711
generate_one_block  0.0010356903076171875
generate_one_block  0.0009579658508300781
generate_one_block  0.0009624958038330078
generate_one_block  0.0009829998016357422
generate_one_block  0.0009598731994628906
generate_one_block  0.0009479522705078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006024837493896484
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0001361370086669922
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011920928955078125
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00012373924255371094
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010228157043457031
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00014448165893554688
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001983642578125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00013446807861328125
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001361370086669922
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00023436546325683594
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.029273986816406e-05
----------------------check_connections_block total spend ----------------------------- 0.005547523498535156
generate_one_block  0.0011515617370605469
generate_one_block  0.0011415481567382812
generate_one_block  0.0011332035064697266
generate_one_block  0.0011229515075683594
generate_one_block  0.0010821819305419922
generate_one_block  0.0011491775512695312
generate_one_block  0.0014007091522216797
generate_one_block  0.0011892318725585938
generate_one_block  0.0011954307556152344
generate_one_block  0.0011076927185058594
generate_one_block  0.0010449886322021484
generate_one_block  0.0011019706726074219
generate_one_block  0.0011553764343261719
generate_one_block  0.0012204647064208984
generate_one_block  0.0011091232299804688
generate_one_block  0.0009641647338867188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007078647613525391
gen group dst list time:  0.00015878677368164062
time for parepare:  0.0002143383026123047
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00025534629821777344
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0004031658172607422
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00054168701171875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0003476142883300781
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005121231079101562
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00040531158447265625
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00047659873962402344
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0006127357482910156
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0006945133209228516
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.00047516822814941406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0002472400665283203
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002276897430419922
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0003712177276611328
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0005559921264648438
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007927417755126953
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.00048089027404785156
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00010895729064941406
----------------------check_connections_block total spend ----------------------------- 0.013406038284301758
generate_one_block  0.001516103744506836
generate_one_block  0.00151824951171875
generate_one_block  0.0013422966003417969
generate_one_block  0.0015721321105957031
generate_one_block  0.0014193058013916016
generate_one_block  0.0015006065368652344
generate_one_block  0.0018939971923828125
generate_one_block  0.0017735958099365234
generate_one_block  0.0015337467193603516
generate_one_block  0.0012385845184326172
generate_one_block  0.0012052059173583984
generate_one_block  0.0013844966888427734
generate_one_block  0.0015828609466552734
generate_one_block  0.0019309520721435547
generate_one_block  0.0015244483947753906
generate_one_block  0.0010595321655273438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.018953561782836914
block generation total time  0.042265892028808594
average batch blocks generation time:  0.002641618251800537
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0039033889770507812  GigaBytes
Max Memory Allocated: 0.0039033889770507812  GigaBytes

torch.Size([593, 1433])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0041370391845703125  GigaBytes
Max Memory Allocated: 0.004216194152832031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005161762237548828  GigaBytes
Max Memory Allocated: 0.008310794830322266  GigaBytes

torch.Size([693, 1433])
torch.Size([286, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005468845367431641  GigaBytes
Max Memory Allocated: 0.008310794830322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004622936248779297  GigaBytes
Max Memory Allocated: 0.008310794830322266  GigaBytes

torch.Size([572, 1433])
torch.Size([182, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004839420318603516  GigaBytes
Max Memory Allocated: 0.008310794830322266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006225109100341797  GigaBytes
Max Memory Allocated: 0.009373188018798828  GigaBytes

torch.Size([892, 1433])
torch.Size([342, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0065479278564453125  GigaBytes
Max Memory Allocated: 0.009373188018798828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004683494567871094  GigaBytes
Max Memory Allocated: 0.009431838989257812  GigaBytes

torch.Size([604, 1433])
torch.Size([226, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004922389984130859  GigaBytes
Max Memory Allocated: 0.009431838989257812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005411624908447266  GigaBytes
Max Memory Allocated: 0.009431838989257812  GigaBytes

torch.Size([740, 1433])
torch.Size([257, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0056819915771484375  GigaBytes
Max Memory Allocated: 0.009431838989257812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006466388702392578  GigaBytes
Max Memory Allocated: 0.010398387908935547  GigaBytes

torch.Size([937, 1433])
torch.Size([316, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006796836853027344  GigaBytes
Max Memory Allocated: 0.010398387908935547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007051944732666016  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

torch.Size([1046, 1433])
torch.Size([390, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007468700408935547  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006454944610595703  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

torch.Size([824, 1433])
torch.Size([297, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006758213043212891  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0036263465881347656  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

torch.Size([407, 1433])
torch.Size([163, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0038089752197265625  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0037755966186523438  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

torch.Size([435, 1433])
torch.Size([116, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003922462463378906  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004921913146972656  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

torch.Size([649, 1433])
torch.Size([223, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005152702331542969  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006058692932128906  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

torch.Size([861, 1433])
torch.Size([333, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006390571594238281  GigaBytes
Max Memory Allocated: 0.012032032012939453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00844717025756836  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([1270, 1433])
torch.Size([500, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008945941925048828  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005742549896240234  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([802, 1433])
torch.Size([276, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00603485107421875  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0024318695068359375  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([184, 1433])
torch.Size([43, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0024924278259277344  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002713039517402649 |0.022178903222084045 |0.05169418454170227 |0.00015220046043395996 |0.002478763461112976 |0.0026738643646240234 |
----------------------------------------------------------pseudo_mini_loss sum 3.4385766983032227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16447
Number of first layer input nodes during this epoch:  11509
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0038843154907226562  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005333423614501953
range selection method range initialization spend 7.390975952148438e-05
time for parepare:  7.724761962890625e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.6716461181640625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9550323486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.0742416381835938e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.821487426757812e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.797645568847656e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.869171142578125e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.749961853027344e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  8.630752563476562e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0031456947326660156
generate_one_block  0.0010063648223876953
generate_one_block  0.001028299331665039
generate_one_block  0.0009920597076416016
generate_one_block  0.0009634494781494141
generate_one_block  0.0009992122650146484
generate_one_block  0.0010175704956054688
generate_one_block  0.0011210441589355469
generate_one_block  0.000957489013671875
generate_one_block  0.0010266304016113281
generate_one_block  0.000978708267211914
generate_one_block  0.0009706020355224609
generate_one_block  0.0009541511535644531
generate_one_block  0.0009558200836181641
generate_one_block  0.0009562969207763672
generate_one_block  0.0009593963623046875
generate_one_block  0.0009572505950927734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005931854248046875
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.0001366138458251953
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016951560974121094
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00015687942504882812
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012087821960449219
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00011110305786132812
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001552104949951172
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010204315185546875
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00012755393981933594
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011754035949707031
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.462501525878906e-05
----------------------check_connections_block total spend ----------------------------- 0.0052149295806884766
generate_one_block  0.0011262893676757812
generate_one_block  0.0012061595916748047
generate_one_block  0.0012187957763671875
generate_one_block  0.0010883808135986328
generate_one_block  0.0011625289916992188
generate_one_block  0.0011925697326660156
generate_one_block  0.0010967254638671875
generate_one_block  0.0011172294616699219
generate_one_block  0.0011744499206542969
generate_one_block  0.0010683536529541016
generate_one_block  0.0011088848114013672
generate_one_block  0.0011129379272460938
generate_one_block  0.001092672348022461
generate_one_block  0.0010395050048828125
generate_one_block  0.0010590553283691406
generate_one_block  0.0010869503021240234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006628036499023438
gen group dst list time:  0.00017023086547851562
time for parepare:  0.0002512931823730469
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00023794174194335938
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0005671977996826172
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0006458759307861328
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005247592926025391
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001373291015625
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004112720489501953
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004661083221435547
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.00060272216796875
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00046634674072265625
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.00038933753967285156
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005161762237548828
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.0004267692565917969
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004775524139404297
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005426406860351562
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00048065185546875
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.00029468536376953125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00031495094299316406
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00028824806213378906
----------------------check_connections_block total spend ----------------------------- 0.013688087463378906
generate_one_block  0.0016911029815673828
generate_one_block  0.001789093017578125
generate_one_block  0.0015747547149658203
generate_one_block  0.0014088153839111328
generate_one_block  0.0015747547149658203
generate_one_block  0.0016522407531738281
generate_one_block  0.001474142074584961
generate_one_block  0.0014536380767822266
generate_one_block  0.0015926361083984375
generate_one_block  0.0014278888702392578
generate_one_block  0.0014564990997314453
generate_one_block  0.002024412155151367
generate_one_block  0.0015096664428710938
generate_one_block  0.0012748241424560547
generate_one_block  0.0013010501861572266
generate_one_block  0.0012860298156738281
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0038843154907226562  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

connection checking time:  0.018903017044067383
block generation total time  0.042443037033081055
average batch blocks generation time:  0.002652689814567566
block dataloader generation time/epoch 0.09532880783081055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([848, 1433])
torch.Size([295, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0077304840087890625  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00816965103149414  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([923, 1433])
torch.Size([359, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008527755737304688  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006911277770996094  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([751, 1433])
torch.Size([261, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0072078704833984375  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005957126617431641  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([573, 1433])
torch.Size([212, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006187915802001953  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0068302154541015625  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([736, 1433])
torch.Size([264, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007112979888916016  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007693767547607422  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([897, 1433])
torch.Size([370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008075237274169922  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006621360778808594  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([697, 1433])
torch.Size([229, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006867885589599609  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006223201751708984  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([623, 1433])
torch.Size([242, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006468296051025391  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0072689056396484375  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([818, 1433])
torch.Size([302, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007598400115966797  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006394863128662109  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([655, 1433])
torch.Size([222, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006623268127441406  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006748199462890625  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes
Using backend: pytorch

torch.Size([721, 1433])
torch.Size([267, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007036685943603516  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006954193115234375  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([759, 1433])
torch.Size([306, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007258892059326172  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0071868896484375  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([803, 1433])
torch.Size([284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007468223571777344  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005435466766357422  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([476, 1433])
torch.Size([164, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005615234375  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005965232849121094  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([575, 1433])
torch.Size([144, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006146430969238281  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005665302276611328  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

torch.Size([519, 1433])
torch.Size([155, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005826473236083984  GigaBytes
Max Memory Allocated: 0.013016700744628906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012349188327789307 |0.00040990114212036133 |0.0033092498779296875 |0.00010855495929718018 |0.0030846893787384033 |0.0021843910217285156 |
----------------------------------------------------------pseudo_mini_loss sum 1.9919766187667847
Total (block generation + training)time/epoch 0.2437286376953125
Training time/epoch 0.14800071716308594
Training time without block to device /epoch 0.14144229888916016
Training time without total dataloading part /epoch 0.10622429847717285
load block tensor time/epoch 0.01975870132446289
block to device time/epoch 0.006558418273925781
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16211
Number of first layer input nodes during this epoch:  11374
