main start at this time 1648428313.4065378
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008473396301269531
range selection method range initialization spend 0.00010800361633300781
time for parepare:  6.29425048828125e-05
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0024156570434570312
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.008148193359375e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.175041198730469e-05
----------------------check_connections_block total spend ----------------------------- 0.003612041473388672
generate_one_block  0.0012784004211425781
generate_one_block  0.0011165142059326172
generate_one_block  0.0010776519775390625
generate_one_block  0.0010867118835449219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004928112030029297
gen group dst list time:  3.7670135498046875e-05
time for parepare:  0.000148773193359375
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0004153251647949219
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004260540008544922
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  4.673004150390625e-05
r_  generation:  0.0003113746643066406
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004112720489501953
----------------------check_connections_block total spend ----------------------------- 0.0031347274780273438
generate_one_block  0.0015406608581542969
generate_one_block  0.0015137195587158203
generate_one_block  0.0013685226440429688
generate_one_block  0.0015058517456054688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005872249603271484
gen group dst list time:  7.605552673339844e-05
time for parepare:  0.00017595291137695312
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.00027823448181152344
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0012521743774414062
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.0011830329895019531
local_output_nid generation:  4.1961669921875e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0008485317230224609
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00020074844360351562
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0012443065643310547
----------------------check_connections_block total spend ----------------------------- 0.007447242736816406
generate_one_block  0.0024797916412353516
generate_one_block  0.0024073123931884766
generate_one_block  0.0020072460174560547
generate_one_block  0.0025272369384765625
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.01058197021484375
block generation total time  0.015350341796875
average batch blocks generation time:  0.00383758544921875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008825302124023438  GigaBytes
Max Memory Allocated: 0.008825302124023438  GigaBytes

torch.Size([1510, 1433])
torch.Size([747, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009639263153076172  GigaBytes
Max Memory Allocated: 0.009755611419677734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009412288665771484  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

torch.Size([1485, 1433])
torch.Size([695, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010207176208496094  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00794839859008789  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

torch.Size([1213, 1433])
torch.Size([530, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008555889129638672  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009905338287353516  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

torch.Size([1577, 1433])
torch.Size([763, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010746955871582031  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00589364767074585 |0.0869101881980896 |0.19373422861099243 |0.00017642974853515625 |0.0031246542930603027 |0.0024347305297851562 |
----------------------------------------------------------pseudo_mini_loss sum 3.4161250591278076
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9248
Number of first layer input nodes during this epoch:  5785
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011441230773925781  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005717277526855469
range selection method range initialization spend 9.012222290039062e-05
time for parepare:  8.96453857421875e-05
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001327991485595703
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.249282836914062e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.05718994140625e-05
----------------------check_connections_block total spend ----------------------------- 0.0015630722045898438
generate_one_block  0.0013763904571533203
generate_one_block  0.0013132095336914062
generate_one_block  0.001306295394897461
generate_one_block  0.0013043880462646484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005774497985839844
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00020933151245117188
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  7.557868957519531e-05
r_  generation:  0.0004932880401611328
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0005354881286621094
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005059242248535156
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00042319297790527344
----------------------check_connections_block total spend ----------------------------- 0.0038487911224365234
generate_one_block  0.0018870830535888672
generate_one_block  0.0018475055694580078
generate_one_block  0.0017745494842529297
generate_one_block  0.0016129016876220703
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005688667297363281
gen group dst list time:  9.1552734375e-05
time for parepare:  0.00020813941955566406
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0011179447174072266
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0013384819030761719
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  0.0001366138458251953
r_  generation:  0.001207113265991211
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  0.00011301040649414062
r_  generation:  0.0011050701141357422
----------------------check_connections_block total spend ----------------------------- 0.007754802703857422
generate_one_block  0.0023839473724365234
generate_one_block  0.0026099681854248047
generate_one_block  0.0024247169494628906
generate_one_block  0.0024461746215820312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011441230773925781  GigaBytes
Max Memory Allocated: 0.01743459701538086  GigaBytes

connection checking time:  0.011603593826293945
block generation total time  0.016986846923828125
average batch blocks generation time:  0.004246711730957031
block dataloader generation time/epoch 0.04548954963684082
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010421276092529297  GigaBytes
Max Memory Allocated: 0.018804550170898438  GigaBytes

torch.Size([1405, 1433])
torch.Size([607, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.0111236572265625  GigaBytes
Max Memory Allocated: 0.018804550170898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011334419250488281  GigaBytes
Max Memory Allocated: 0.018804550170898438  GigaBytes

torch.Size([1575, 1433])
torch.Size([769, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012177467346191406  GigaBytes
Max Memory Allocated: 0.018804550170898438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010802268981933594  GigaBytes
Max Memory Allocated: 0.019173622131347656  GigaBytes

torch.Size([1476, 1433])
torch.Size([704, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01158285140991211  GigaBytes
Max Memory Allocated: 0.019173622131347656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01075124740600586  GigaBytes
Max Memory Allocated: 0.019173622131347656  GigaBytes

torch.Size([1467, 1433])
torch.Size([613, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011438369750976562  GigaBytes
Max Memory Allocated: 0.019173622131347656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0014724135398864746 |0.00041556358337402344 |0.0031825900077819824 |0.00011485815048217773 |0.0016278624534606934 |0.0014026165008544922 |
----------------------------------------------------------pseudo_mini_loss sum 1.8350670337677002
Total (block generation + training)time/epoch 0.07837629318237305
Training time/epoch 0.032712697982788086
Training time without block to device /epoch 0.031050443649291992
Training time without total dataloading part /epoch 0.021103858947753906
load block tensor time/epoch 0.0058896541595458984
block to device time/epoch 0.0016622543334960938
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9334
Number of first layer input nodes during this epoch:  5923
