main start at this time 1648428416.772943
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001318216323852539
range selection method range initialization spend 0.00011658668518066406
time for parepare:  6.651878356933594e-05
local_output_nid generation:  3.838539123535156e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0026018619537353516
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001246929168701172
----------------------check_connections_block total spend ----------------------------- 0.0034492015838623047
generate_one_block  0.0015840530395507812
generate_one_block  0.0012881755828857422
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005266666412353516
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.00015354156494140625
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  7.581710815429688e-05
r_  generation:  0.0007486343383789062
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0007123947143554688
----------------------check_connections_block total spend ----------------------------- 0.002662181854248047
generate_one_block  0.0020470619201660156
generate_one_block  0.001954793930053711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006277561187744141
gen group dst list time:  6.008148193359375e-05
time for parepare:  0.00018787384033203125
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.0003349781036376953
mini_batch_src_global generation:  0.00016307830810546875
r_  generation:  0.0019404888153076172
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0001888275146484375
r_  generation:  0.0018453598022460938
----------------------check_connections_block total spend ----------------------------- 0.006009101867675781
generate_one_block  0.003438234329223633
generate_one_block  0.0031642913818359375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

connection checking time:  0.008671283721923828
block generation total time  0.010604381561279297
average batch blocks generation time:  0.0053021907806396484
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.01106405258178711  GigaBytes
Max Memory Allocated: 0.01106405258178711  GigaBytes

torch.Size([1925, 1433])
torch.Size([1158, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2557373046875 GB
    Memory Allocated: 0.0124053955078125  GigaBytes
Max Memory Allocated: 0.012482643127441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011804580688476562  GigaBytes
Max Memory Allocated: 0.022021770477294922  GigaBytes

torch.Size([1929, 1433])
torch.Size([1115, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.013086318969726562  GigaBytes
Max Memory Allocated: 0.022021770477294922  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026229262351989746 |0.17489993572235107 |0.381911039352417 |0.0002033710479736328 |0.004969358444213867 |0.004258632659912109 |
----------------------------------------------------------pseudo_mini_loss sum 3.3217477798461914
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6818
Number of first layer input nodes during this epoch:  3854
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013383865356445312  GigaBytes
Max Memory Allocated: 0.022021770477294922  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009474754333496094
range selection method range initialization spend 0.00012302398681640625
time for parepare:  0.00013685226440429688
local_output_nid generation:  4.553794860839844e-05
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.00020575523376464844
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00017571449279785156
----------------------check_connections_block total spend ----------------------------- 0.0013213157653808594
generate_one_block  0.001692056655883789
generate_one_block  0.0016324520111083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006916522979736328
gen group dst list time:  4.1484832763671875e-05
time for parepare:  0.0002162456512451172
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0002903938293457031
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0010726451873779297
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00012683868408203125
r_  generation:  0.0009758472442626953
----------------------check_connections_block total spend ----------------------------- 0.003687620162963867
generate_one_block  0.002237081527709961
generate_one_block  0.0019199848175048828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005879402160644531
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.0001881122589111328
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.00032448768615722656
mini_batch_src_global generation:  0.00017833709716796875
r_  generation:  0.0019443035125732422
local_output_nid generation:  8.416175842285156e-05
local_in_edges_tensor generation:  0.0002522468566894531
mini_batch_src_global generation:  0.00022268295288085938
r_  generation:  0.0018219947814941406
----------------------check_connections_block total spend ----------------------------- 0.00597834587097168
generate_one_block  0.003252744674682617
generate_one_block  0.003082752227783203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013383865356445312  GigaBytes
Max Memory Allocated: 0.022021770477294922  GigaBytes

connection checking time:  0.009665966033935547
block generation total time  0.010492563247680664
average batch blocks generation time:  0.005246281623840332
block dataloader generation time/epoch 0.03808951377868652
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013515472412109375  GigaBytes
Max Memory Allocated: 0.023749351501464844  GigaBytes
Using backend: pytorch

torch.Size([1979, 1433])
torch.Size([1171, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014868736267089844  GigaBytes
Max Memory Allocated: 0.023749351501464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013196468353271484  GigaBytes
Max Memory Allocated: 0.023749351501464844  GigaBytes

torch.Size([1920, 1433])
torch.Size([1121, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01447916030883789  GigaBytes
Max Memory Allocated: 0.023749351501464844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002858281135559082 |0.0004099607467651367 |0.0030847787857055664 |0.00010800361633300781 |0.002636551856994629 |0.0012924671173095703 |
----------------------------------------------------------pseudo_mini_loss sum 2.0020129680633545
Total (block generation + training)time/epoch 0.060038089752197266
Training time/epoch 0.021481037139892578
Training time without block to device /epoch 0.020661115646362305
Training time without total dataloading part /epoch 0.012951135635375977
load block tensor time/epoch 0.005716562271118164
block to device time/epoch 0.0008199214935302734
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6881
Number of first layer input nodes during this epoch:  3899
