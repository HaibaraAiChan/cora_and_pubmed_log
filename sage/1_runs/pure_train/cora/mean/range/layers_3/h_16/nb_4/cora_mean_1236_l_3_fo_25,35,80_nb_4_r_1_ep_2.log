main start at this time 1648428052.0033717
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000993967056274414
range selection method range initialization spend 0.00010919570922851562
time for parepare:  6.580352783203125e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.002291440963745117
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.890296936035156e-05
----------------------check_connections_block total spend ----------------------------- 0.0035562515258789062
generate_one_block  0.001444101333618164
generate_one_block  0.0012280941009521484
generate_one_block  0.0012102127075195312
generate_one_block  0.0012004375457763672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005140304565429688
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.0001430511474609375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0003337860107421875
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00043582916259765625
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004711151123046875
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00022554397583007812
mini_batch_src_global generation:  5.7220458984375e-05
r_  generation:  0.0004210472106933594
----------------------check_connections_block total spend ----------------------------- 0.0032830238342285156
generate_one_block  0.0015411376953125
generate_one_block  0.0016415119171142578
generate_one_block  0.0017027854919433594
generate_one_block  0.0016207695007324219
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000591278076171875
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.00018167495727539062
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  9.083747863769531e-05
r_  generation:  0.0009634494781494141
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.0001709461212158203
r_  generation:  0.0012679100036621094
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0013878345489501953
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0012145042419433594
----------------------check_connections_block total spend ----------------------------- 0.007862567901611328
generate_one_block  0.002309560775756836
generate_one_block  0.0026106834411621094
generate_one_block  0.0026836395263671875
generate_one_block  0.002406597137451172
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.011145591735839844
block generation total time  0.016516685485839844
average batch blocks generation time:  0.004129171371459961
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006958961486816406  GigaBytes
Max Memory Allocated: 0.006958961486816406  GigaBytes

torch.Size([1264, 1433])
torch.Size([560, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007151126861572266  GigaBytes
Max Memory Allocated: 0.007161140441894531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008421897888183594  GigaBytes
Max Memory Allocated: 0.015130043029785156  GigaBytes

torch.Size([1503, 1433])
torch.Size([736, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008664608001708984  GigaBytes
Max Memory Allocated: 0.015130043029785156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008932113647460938  GigaBytes
Max Memory Allocated: 0.016913414001464844  GigaBytes

torch.Size([1598, 1433])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009196758270263672  GigaBytes
Max Memory Allocated: 0.016913414001464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00845193862915039  GigaBytes
Max Memory Allocated: 0.016945362091064453  GigaBytes

torch.Size([1509, 1433])
torch.Size([695, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008683204650878906  GigaBytes
Max Memory Allocated: 0.016945362091064453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023419559001922607 |0.08626008033752441 |0.19290661811828613 |0.00017946958541870117 |0.003267347812652588 |0.002716064453125 |
----------------------------------------------------------pseudo_mini_loss sum 3.2251884937286377
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9401
Number of first layer input nodes during this epoch:  5874
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00889444351196289  GigaBytes
Max Memory Allocated: 0.016945362091064453  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004792213439941406
range selection method range initialization spend 6.461143493652344e-05
time for parepare:  6.580352783203125e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00010848045349121094
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.033348083496094e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.91278076171875e-05
----------------------check_connections_block total spend ----------------------------- 0.0012979507446289062
generate_one_block  0.0011663436889648438
generate_one_block  0.0010929107666015625
generate_one_block  0.0010976791381835938
generate_one_block  0.0010638236999511719
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047779083251953125
gen group dst list time:  4.124641418457031e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005216598510742188
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0003020763397216797
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00040459632873535156
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003762245178222656
----------------------check_connections_block total spend ----------------------------- 0.003107309341430664
generate_one_block  0.0016932487487792969
generate_one_block  0.0013532638549804688
generate_one_block  0.0014731884002685547
generate_one_block  0.0014886856079101562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005500316619873047
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.0001800060272216797
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0002765655517578125
mini_batch_src_global generation:  0.00011563301086425781
r_  generation:  0.0013217926025390625
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.000904083251953125
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  0.00011682510375976562
r_  generation:  0.001089334487915039
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0012507438659667969
----------------------check_connections_block total spend ----------------------------- 0.007424116134643555
generate_one_block  0.0027539730072021484
generate_one_block  0.0020771026611328125
generate_one_block  0.0022585391998291016
generate_one_block  0.0025527477264404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00889444351196289  GigaBytes
Max Memory Allocated: 0.016945362091064453  GigaBytes

connection checking time:  0.010531425476074219
block generation total time  0.01565074920654297
average batch blocks generation time:  0.003912687301635742
block dataloader generation time/epoch 0.07770395278930664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009285926818847656  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1576, 1433])
torch.Size([835, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009562969207763672  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.007615566253662109  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1288, 1433])
torch.Size([506, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0077915191650390625  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008067131042480469  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1371, 1433])
torch.Size([658, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00829315185546875  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008591175079345703  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

torch.Size([1469, 1433])
torch.Size([723, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008826732635498047  GigaBytes
Max Memory Allocated: 0.01729726791381836  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023798346519470215 |0.0003859996795654297 |0.003029346466064453 |0.00010436773300170898 |0.0031662583351135254 |0.0012857913970947266 |
----------------------------------------------------------pseudo_mini_loss sum 2.6214795112609863
Total (block generation + training)time/epoch 0.11937856674194336
Training time/epoch 0.041314125061035156
Training time without block to device /epoch 0.03977012634277344
Training time without total dataloading part /epoch 0.026485681533813477
load block tensor time/epoch 0.009519338607788086
block to device time/epoch 0.0015439987182617188
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9153
Number of first layer input nodes during this epoch:  5704
