main start at this time 1648428127.2796655
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013725757598876953
range selection method range initialization spend 8.130073547363281e-05
time for parepare:  6.127357482910156e-05
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0011985301971435547
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.127357482910156e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.103515625e-05
----------------------check_connections_block total spend ----------------------------- 0.0023529529571533203
generate_one_block  0.0012400150299072266
generate_one_block  0.0010693073272705078
generate_one_block  0.0010595321655273438
generate_one_block  0.0010497570037841797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004863739013671875
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.00014019012451171875
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003254413604736328
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.0004189014434814453
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004591941833496094
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004074573516845703
----------------------check_connections_block total spend ----------------------------- 0.0031571388244628906
generate_one_block  0.001398324966430664
generate_one_block  0.001489400863647461
generate_one_block  0.0015544891357421875
generate_one_block  0.001455545425415039
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005841255187988281
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.00017380714416503906
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0010380744934082031
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.001264810562133789
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00021028518676757812
mini_batch_src_global generation:  0.00014591217041015625
r_  generation:  0.0014028549194335938
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00019407272338867188
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0012104511260986328
----------------------check_connections_block total spend ----------------------------- 0.007951021194458008
generate_one_block  0.002206563949584961
generate_one_block  0.002460479736328125
generate_one_block  0.002692699432373047
generate_one_block  0.002515554428100586
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.011108160018920898
block generation total time  0.01577305793762207
average batch blocks generation time:  0.003943264484405518
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007720947265625  GigaBytes
Max Memory Allocated: 0.007720947265625  GigaBytes

torch.Size([1406, 1433])
torch.Size([643, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007935047149658203  GigaBytes
Max Memory Allocated: 0.007952213287353516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00901937484741211  GigaBytes
Max Memory Allocated: 0.01648092269897461  GigaBytes

torch.Size([1614, 1433])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00928354263305664  GigaBytes
Max Memory Allocated: 0.01648092269897461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009616374969482422  GigaBytes
Max Memory Allocated: 0.01818370819091797  GigaBytes

torch.Size([1725, 1433])
torch.Size([901, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009905815124511719  GigaBytes
Max Memory Allocated: 0.01818370819091797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00911855697631836  GigaBytes
Max Memory Allocated: 0.01828479766845703  GigaBytes

torch.Size([1633, 1433])
torch.Size([755, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009366989135742188  GigaBytes
Max Memory Allocated: 0.01828479766845703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013553440570831299 |0.08597177267074585 |0.1938425898551941 |0.00015985965728759766 |0.0030811429023742676 |0.002185344696044922 |
----------------------------------------------------------pseudo_mini_loss sum 3.270144462585449
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10213
Number of first layer input nodes during this epoch:  6378
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009571075439453125  GigaBytes
Max Memory Allocated: 0.01828479766845703  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005993843078613281
range selection method range initialization spend 9.393692016601562e-05
time for parepare:  9.298324584960938e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  9.870529174804688e-05
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001342296600341797
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.202957153320312e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.224082946777344e-05
----------------------check_connections_block total spend ----------------------------- 0.0015926361083984375
generate_one_block  0.0015552043914794922
generate_one_block  0.001417398452758789
generate_one_block  0.001434326171875
generate_one_block  0.0014004707336425781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005865097045898438
gen group dst list time:  5.173683166503906e-05
time for parepare:  0.00022792816162109375
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0006468296051025391
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0003924369812011719
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005395412445068359
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  6.4849853515625e-05
r_  generation:  0.0005049705505371094
----------------------check_connections_block total spend ----------------------------- 0.004038095474243164
generate_one_block  0.002218008041381836
generate_one_block  0.001756906509399414
generate_one_block  0.001950979232788086
generate_one_block  0.0018892288208007812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006945133209228516
gen group dst list time:  0.0001220703125
time for parepare:  0.0002498626708984375
local_output_nid generation:  8.320808410644531e-05
local_in_edges_tensor generation:  0.0003299713134765625
mini_batch_src_global generation:  0.00020694732666015625
r_  generation:  0.0018684864044189453
local_output_nid generation:  7.104873657226562e-05
local_in_edges_tensor generation:  0.00023984909057617188
mini_batch_src_global generation:  0.00019550323486328125
r_  generation:  0.0013041496276855469
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.00017404556274414062
r_  generation:  0.0015406608581542969
local_output_nid generation:  9.894371032714844e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00020003318786621094
r_  generation:  0.0017218589782714844
----------------------check_connections_block total spend ----------------------------- 0.010447502136230469
generate_one_block  0.0034334659576416016
generate_one_block  0.0022678375244140625
generate_one_block  0.0022835731506347656
generate_one_block  0.002777576446533203
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009571075439453125  GigaBytes
Max Memory Allocated: 0.01828479766845703  GigaBytes

connection checking time:  0.014485597610473633
block generation total time  0.01857757568359375
average batch blocks generation time:  0.0046443939208984375
block dataloader generation time/epoch 0.0520021915435791
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009968280792236328  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

torch.Size([1671, 1433])
torch.Size([914, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010266304016113281  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008365631103515625  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

torch.Size([1428, 1433])
torch.Size([571, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008557796478271484  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008513927459716797  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

torch.Size([1454, 1433])
torch.Size([698, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008751392364501953  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009060382843017578  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

torch.Size([1556, 1433])
torch.Size([796, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00931549072265625  GigaBytes
Max Memory Allocated: 0.018636703491210938  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020227372646331787 |0.0005540847778320312 |0.0036097168922424316 |0.00012302398681640625 |0.0032843351364135742 |0.0028226375579833984 |
----------------------------------------------------------pseudo_mini_loss sum 2.598965644836426
Total (block generation + training)time/epoch 0.1720573902130127
Training time/epoch 0.11942577362060547
Training time without block to device /epoch 0.11720943450927734
Training time without total dataloading part /epoch 0.030890941619873047
load block tensor time/epoch 0.08090949058532715
block to device time/epoch 0.002216339111328125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9815
Number of first layer input nodes during this epoch:  6109
