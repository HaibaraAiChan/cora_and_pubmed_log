main start at this time 1648428108.4365473
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001314401626586914
range selection method range initialization spend 0.00010609626770019531
time for parepare:  6.318092346191406e-05
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.002410888671875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  3.0517578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.131431579589844e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.409385681152344e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.036064147949219e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2649765014648438e-05
----------------------check_connections_block total spend ----------------------------- 0.005468606948852539
generate_one_block  0.0014319419860839844
generate_one_block  0.001058816909790039
generate_one_block  0.0011098384857177734
generate_one_block  0.001043558120727539
generate_one_block  0.0010526180267333984
generate_one_block  0.0010445117950439453
generate_one_block  0.0010547637939453125
generate_one_block  0.001043081283569336
generate_one_block  0.0010404586791992188
generate_one_block  0.0010423660278320312
generate_one_block  0.0010704994201660156
generate_one_block  0.0010623931884765625
generate_one_block  0.0010383129119873047
generate_one_block  0.0010521411895751953
generate_one_block  0.0009975433349609375
generate_one_block  0.0009572505950927734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005927085876464844
gen group dst list time:  9.202957153320312e-05
time for parepare:  0.00014710426330566406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00018477439880371094
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00012683868408203125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.0001354217529296875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00010180473327636719
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002472400665283203
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001246929168701172
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014400482177734375
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001442432403564453
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00016427040100097656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0002396106719970703
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  9.1552734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00012183189392089844
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011444091796875
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  9.274482727050781e-05
----------------------check_connections_block total spend ----------------------------- 0.0056912899017333984
generate_one_block  0.0011439323425292969
generate_one_block  0.0011394023895263672
generate_one_block  0.0011477470397949219
generate_one_block  0.0011451244354248047
generate_one_block  0.0010921955108642578
generate_one_block  0.0011239051818847656
generate_one_block  0.0013020038604736328
generate_one_block  0.00112152099609375
generate_one_block  0.0011572837829589844
generate_one_block  0.0011563301086425781
generate_one_block  0.001123189926147461
generate_one_block  0.0011870861053466797
generate_one_block  0.0012989044189453125
generate_one_block  0.0010619163513183594
generate_one_block  0.001085519790649414
generate_one_block  0.001039266586303711
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006780624389648438
gen group dst list time:  0.00015735626220703125
time for parepare:  0.000217437744140625
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00023889541625976562
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.00048542022705078125
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.0003745555877685547
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  5.555152893066406e-05
r_  generation:  0.0004413127899169922
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00017070770263671875
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0008602142333984375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0004467964172363281
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005629062652587891
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0005671977996826172
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006070137023925781
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005846023559570312
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.0008270740509033203
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  5.53131103515625e-05
r_  generation:  0.00030517578125
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0004851818084716797
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0002684593200683594
----------------------check_connections_block total spend ----------------------------- 0.014283180236816406
generate_one_block  0.0012950897216796875
generate_one_block  0.0015833377838134766
generate_one_block  0.0015125274658203125
generate_one_block  0.0014927387237548828
generate_one_block  0.0013659000396728516
generate_one_block  0.0014562606811523438
generate_one_block  0.0021932125091552734
generate_one_block  0.001482248306274414
generate_one_block  0.0016181468963623047
generate_one_block  0.0015611648559570312
generate_one_block  0.0016489028930664062
generate_one_block  0.0015506744384765625
generate_one_block  0.0018873214721679688
generate_one_block  0.001276254653930664
generate_one_block  0.0015048980712890625
generate_one_block  0.0012364387512207031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.019974470138549805
block generation total time  0.04299044609069824
average batch blocks generation time:  0.00268690288066864
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0022268295288085938  GigaBytes
Max Memory Allocated: 0.0022268295288085938  GigaBytes

torch.Size([382, 1433])
torch.Size([131, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022783279418945312  GigaBytes
Max Memory Allocated: 0.002280712127685547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004510402679443359  GigaBytes
Max Memory Allocated: 0.006535053253173828  GigaBytes

torch.Size([775, 1433])
torch.Size([237, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0045909881591796875  GigaBytes
Max Memory Allocated: 0.006535053253173828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0035047531127929688  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

torch.Size([587, 1433])
torch.Size([228, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0035839080810546875  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003948688507080078  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

torch.Size([670, 1433])
torch.Size([251, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004031181335449219  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003177165985107422  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

torch.Size([526, 1433])
torch.Size([178, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0032410621643066406  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004139900207519531  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

torch.Size([706, 1433])
torch.Size([234, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004218578338623047  GigaBytes
Max Memory Allocated: 0.00762939453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0067691802978515625  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

torch.Size([1131, 1433])
torch.Size([500, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006920337677001953  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004033088684082031  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

torch.Size([686, 1433])
torch.Size([209, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004108905792236328  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005041599273681641  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

torch.Size([874, 1433])
torch.Size([299, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005138397216796875  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0041599273681640625  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

torch.Size([709, 1433])
torch.Size([317, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004260540008544922  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0051975250244140625  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

torch.Size([903, 1433])
torch.Size([323, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005298137664794922  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00487518310546875  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

torch.Size([843, 1433])
torch.Size([284, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004973888397216797  GigaBytes
Max Memory Allocated: 0.01051187515258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006147861480712891  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

torch.Size([1080, 1433])
torch.Size([454, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006288051605224609  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003020763397216797  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

torch.Size([497, 1433])
torch.Size([145, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003078460693359375  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004195213317871094  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

torch.Size([716, 1433])
torch.Size([247, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004275321960449219  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00262451171875  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

torch.Size([423, 1433])
torch.Size([119, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0026721954345703125  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0025632083415985107 |0.02203667163848877 |0.05131365358829498 |0.00012864172458648682 |0.002686142921447754 |0.0018928050994873047 |
----------------------------------------------------------pseudo_mini_loss sum 3.226196050643921
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16429
Number of first layer input nodes during this epoch:  11508
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00299835205078125  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
range selection method range initialization spend 6.29425048828125e-05
time for parepare:  6.151199340820312e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.1948089599609375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.9577484130859375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.24249267578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.250640869140625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.083747863769531e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.621246337890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0030205249786376953
generate_one_block  0.0010342597961425781
generate_one_block  0.0010294914245605469
generate_one_block  0.0010080337524414062
generate_one_block  0.0010135173797607422
generate_one_block  0.0009870529174804688
generate_one_block  0.0009942054748535156
generate_one_block  0.001154184341430664
generate_one_block  0.0010347366333007812
generate_one_block  0.0010051727294921875
generate_one_block  0.0010044574737548828
generate_one_block  0.0009584426879882812
generate_one_block  0.0009570121765136719
generate_one_block  0.0009489059448242188
generate_one_block  0.0009989738464355469
generate_one_block  0.0009562969207763672
generate_one_block  0.0009438991546630859
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005905628204345703
gen group dst list time:  9.036064147949219e-05
time for parepare:  0.00014519691467285156
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.0002434253692626953
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.0001506805419921875
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.00014519691467285156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.462501525878906e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0001373291015625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00011181831359863281
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00012350082397460938
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00018525123596191406
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.0001266002655029297
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.00010538101196289062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011038780212402344
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  9.775161743164062e-05
----------------------check_connections_block total spend ----------------------------- 0.00549626350402832
generate_one_block  0.001153707504272461
generate_one_block  0.0012710094451904297
generate_one_block  0.001230478286743164
generate_one_block  0.0011608600616455078
generate_one_block  0.0010526180267333984
generate_one_block  0.0011036396026611328
generate_one_block  0.0011527538299560547
generate_one_block  0.0011029243469238281
generate_one_block  0.0011348724365234375
generate_one_block  0.0011501312255859375
generate_one_block  0.001085519790649414
generate_one_block  0.0010662078857421875
generate_one_block  0.001055002212524414
generate_one_block  0.0011632442474365234
generate_one_block  0.001058340072631836
generate_one_block  0.0011098384857177734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006933212280273438
gen group dst list time:  0.0001583099365234375
time for parepare:  0.00021982192993164062
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0002510547637939453
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.00041365623474121094
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0001709461212158203
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0007710456848144531
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0005331039428710938
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.0004508495330810547
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.0001220703125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00018835067749023438
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00039458274841308594
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0005304813385009766
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0003905296325683594
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004990100860595703
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0005426406860351562
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0004220008850097656
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0003829002380371094
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0003769397735595703
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00015354156494140625
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0007238388061523438
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003864765167236328
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00013637542724609375
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.00040030479431152344
----------------------check_connections_block total spend ----------------------------- 0.013492345809936523
generate_one_block  0.0014922618865966797
generate_one_block  0.0019261837005615234
generate_one_block  0.0015404224395751953
generate_one_block  0.0014438629150390625
generate_one_block  0.0011439323425292969
generate_one_block  0.0014166831970214844
generate_one_block  0.0015416145324707031
generate_one_block  0.0013973712921142578
generate_one_block  0.001505136489868164
generate_one_block  0.0015327930450439453
generate_one_block  0.0013957023620605469
generate_one_block  0.0014736652374267578
generate_one_block  0.001373291015625
generate_one_block  0.0017635822296142578
generate_one_block  0.0013837814331054688
generate_one_block  0.0014014244079589844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00299835205078125  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

connection checking time:  0.018988609313964844
block generation total time  0.04178285598754883
average batch blocks generation time:  0.0026114284992218018
block dataloader generation time/epoch 0.093414306640625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0045452117919921875  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

torch.Size([633, 1433])
torch.Size([246, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0046253204345703125  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006612300872802734  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

torch.Size([1101, 1433])
torch.Size([446, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006755352020263672  GigaBytes
Max Memory Allocated: 0.010623931884765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005088329315185547  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([817, 1433])
torch.Size([281, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005181789398193359  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0036568641662597656  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([549, 1433])
torch.Size([228, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003737926483154297  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022497177124023438  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([287, 1433])
torch.Size([89, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0022907257080078125  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004337310791015625  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([677, 1433])
torch.Size([219, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0044097900390625  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004906654357910156  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([783, 1433])
torch.Size([273, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004996776580810547  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004337310791015625  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([668, 1433])
torch.Size([194, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004407405853271484  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004494667053222656  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([706, 1433])
torch.Size([270, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004580497741699219  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004535198211669922  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([713, 1433])
torch.Size([257, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004630565643310547  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0038309097290039062  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes
Using backend: pytorch

torch.Size([582, 1433])
torch.Size([216, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0039048194885253906  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003963470458984375  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([607, 1433])
torch.Size([183, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0040340423583984375  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0038299560546875  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([562, 1433])
torch.Size([199, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003898143768310547  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006006717681884766  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([988, 1433])
torch.Size([393, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006128787994384766  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003910064697265625  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([597, 1433])
torch.Size([187, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003978252410888672  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004103183746337891  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

torch.Size([633, 1433])
torch.Size([231, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004174232482910156  GigaBytes
Max Memory Allocated: 0.010950565338134766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001154094934463501 |0.00038649141788482666 |0.003083929419517517 |0.00010176002979278564 |0.003070339560508728 |0.0015482902526855469 |
----------------------------------------------------------pseudo_mini_loss sum 2.4123380184173584
Total (block generation + training)time/epoch 0.23459720611572266
Training time/epoch 0.14083337783813477
Training time without block to device /epoch 0.13464951515197754
Training time without total dataloading part /epoch 0.10164475440979004
load block tensor time/epoch 0.018465518951416016
block to device time/epoch 0.0061838626861572266
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  15579
Number of first layer input nodes during this epoch:  10903
