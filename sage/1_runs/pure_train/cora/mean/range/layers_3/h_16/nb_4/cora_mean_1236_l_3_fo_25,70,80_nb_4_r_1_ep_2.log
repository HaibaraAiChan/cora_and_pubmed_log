main start at this time 1648428089.7856247
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015339851379394531
range selection method range initialization spend 0.00011038780212402344
time for parepare:  6.556510925292969e-05
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0024597644805908203
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  8.869171142578125e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.580352783203125e-05
----------------------check_connections_block total spend ----------------------------- 0.0037331581115722656
generate_one_block  0.0015211105346679688
generate_one_block  0.00115966796875
generate_one_block  0.0011661052703857422
generate_one_block  0.0011463165283203125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005068778991699219
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0001544952392578125
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0004477500915527344
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00048542022705078125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00042247772216796875
----------------------check_connections_block total spend ----------------------------- 0.003347158432006836
generate_one_block  0.0014834403991699219
generate_one_block  0.0016083717346191406
generate_one_block  0.0016591548919677734
generate_one_block  0.0015735626220703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005586147308349609
gen group dst list time:  8.177757263183594e-05
time for parepare:  0.000171661376953125
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0002608299255371094
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.001016855239868164
local_output_nid generation:  5.6743621826171875e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.0013034343719482422
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  0.00015044212341308594
r_  generation:  0.001413106918334961
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001983642578125
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.0012369155883789062
----------------------check_connections_block total spend ----------------------------- 0.008035898208618164
generate_one_block  0.002490997314453125
generate_one_block  0.0025229454040527344
generate_one_block  0.0025665760040283203
generate_one_block  0.0024132728576660156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.011383056640625
block generation total time  0.016318321228027344
average batch blocks generation time:  0.004079580307006836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007485389709472656  GigaBytes
Max Memory Allocated: 0.007485389709472656  GigaBytes

torch.Size([1362, 1433])
torch.Size([639, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007695674896240234  GigaBytes
Max Memory Allocated: 0.007710933685302734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008883953094482422  GigaBytes
Max Memory Allocated: 0.016112804412841797  GigaBytes

torch.Size([1589, 1433])
torch.Size([815, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00914621353149414  GigaBytes
Max Memory Allocated: 0.016112804412841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0094757080078125  GigaBytes
Max Memory Allocated: 0.017911434173583984  GigaBytes

torch.Size([1699, 1433])
torch.Size([902, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009763240814208984  GigaBytes
Max Memory Allocated: 0.017911434173583984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008801937103271484  GigaBytes
Max Memory Allocated: 0.017911434173583984  GigaBytes

torch.Size([1574, 1433])
torch.Size([753, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.0090484619140625  GigaBytes
Max Memory Allocated: 0.017911434173583984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014542222023010254 |0.08601951599121094 |0.19377845525741577 |0.00017851591110229492 |0.004347801208496094 |0.004122734069824219 |
----------------------------------------------------------pseudo_mini_loss sum 3.2634291648864746
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10054
Number of first layer input nodes during this epoch:  6224
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009250640869140625  GigaBytes
Max Memory Allocated: 0.017911434173583984  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009570121765136719
range selection method range initialization spend 0.0001220703125
time for parepare:  0.00014066696166992188
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.0003235340118408203
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0001842975616455078
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00023245811462402344
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00015211105346679688
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  9.012222290039062e-05
----------------------check_connections_block total spend ----------------------------- 0.0022420883178710938
generate_one_block  0.0016016960144042969
generate_one_block  0.001499176025390625
generate_one_block  0.001528024673461914
generate_one_block  0.001497507095336914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006868839263916016
gen group dst list time:  5.7220458984375e-05
time for parepare:  0.0002193450927734375
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007781982421875
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0003235340118408203
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004432201385498047
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004162788391113281
----------------------check_connections_block total spend ----------------------------- 0.0037751197814941406
generate_one_block  0.001766204833984375
generate_one_block  0.0013885498046875
generate_one_block  0.0015368461608886719
generate_one_block  0.0015246868133544922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005981922149658203
gen group dst list time:  8.344650268554688e-05
time for parepare:  0.00018668174743652344
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  0.0001399517059326172
r_  generation:  0.0014331340789794922
local_output_nid generation:  4.601478576660156e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  0.00013065338134765625
r_  generation:  0.0009639263153076172
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0011653900146484375
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  0.0001316070556640625
r_  generation:  0.0013031959533691406
----------------------check_connections_block total spend ----------------------------- 0.007893800735473633
generate_one_block  0.002721071243286133
generate_one_block  0.002158641815185547
generate_one_block  0.002325773239135742
generate_one_block  0.002767801284790039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009250640869140625  GigaBytes
Max Memory Allocated: 0.017911434173583984  GigaBytes

connection checking time:  0.011668920516967773
block generation total time  0.0161895751953125
average batch blocks generation time:  0.004047393798828125
block dataloader generation time/epoch 0.05135798454284668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009827613830566406  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

torch.Size([1643, 1433])
torch.Size([912, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010122299194335938  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008071422576904297  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

torch.Size([1373, 1433])
torch.Size([570, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00826263427734375  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008282661437988281  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

torch.Size([1411, 1433])
torch.Size([699, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008518218994140625  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009006023406982422  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

torch.Size([1546, 1433])
torch.Size([794, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009260177612304688  GigaBytes
Max Memory Allocated: 0.018183231353759766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0022675395011901855 |0.00039565563201904297 |0.0031227469444274902 |0.00010764598846435547 |0.0020832419395446777 |0.0012979507446289062 |
----------------------------------------------------------pseudo_mini_loss sum 2.6189980506896973
Total (block generation + training)time/epoch 0.08875226974487305
Training time/epoch 0.037030935287475586
Training time without block to device /epoch 0.035448312759399414
Training time without total dataloading part /epoch 0.022552490234375
load block tensor time/epoch 0.009070158004760742
block to device time/epoch 0.0015826225280761719
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9675
Number of first layer input nodes during this epoch:  5973
