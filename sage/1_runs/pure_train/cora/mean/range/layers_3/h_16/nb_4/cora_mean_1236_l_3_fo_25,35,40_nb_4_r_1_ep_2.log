main start at this time 1648428015.716313
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013947486877441406
range selection method range initialization spend 0.00011372566223144531
time for parepare:  6.4849853515625e-05
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0026230812072753906
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.723403930664062e-05
----------------------check_connections_block total spend ----------------------------- 0.003914833068847656
generate_one_block  0.0015363693237304688
generate_one_block  0.0011301040649414062
generate_one_block  0.0011053085327148438
generate_one_block  0.0011065006256103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005071163177490234
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.00014591217041015625
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00019502639770507812
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.000331878662109375
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.0004284381866455078
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00046563148498535156
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00021982192993164062
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00041866302490234375
----------------------check_connections_block total spend ----------------------------- 0.0032491683959960938
generate_one_block  0.001417398452758789
generate_one_block  0.0015213489532470703
generate_one_block  0.0015826225280761719
generate_one_block  0.0014963150024414062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005958080291748047
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.00018024444580078125
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0009303092956542969
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  0.00017547607421875
r_  generation:  0.0012238025665283203
local_output_nid generation:  5.984306335449219e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0013494491577148438
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  0.00012874603271484375
r_  generation:  0.0011751651763916016
----------------------check_connections_block total spend ----------------------------- 0.007721424102783203
generate_one_block  0.00217437744140625
generate_one_block  0.002449512481689453
generate_one_block  0.002561330795288086
generate_one_block  0.0023708343505859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

connection checking time:  0.010970592498779297
block generation total time  0.015573740005493164
average batch blocks generation time:  0.003893435001373291
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.006980419158935547  GigaBytes
Max Memory Allocated: 0.006980419158935547  GigaBytes

torch.Size([1268, 1433])
torch.Size([562, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.007174015045166016  GigaBytes
Max Memory Allocated: 0.007184505462646484  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008346080780029297  GigaBytes
Max Memory Allocated: 0.015076637268066406  GigaBytes

torch.Size([1489, 1433])
torch.Size([731, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008587837219238281  GigaBytes
Max Memory Allocated: 0.015076637268066406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008937358856201172  GigaBytes
Max Memory Allocated: 0.016843795776367188  GigaBytes

torch.Size([1599, 1433])
torch.Size([805, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009200572967529297  GigaBytes
Max Memory Allocated: 0.016843795776367188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00845193862915039  GigaBytes
Max Memory Allocated: 0.016950607299804688  GigaBytes

torch.Size([1509, 1433])
torch.Size([689, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008683204650878906  GigaBytes
Max Memory Allocated: 0.016950607299804688  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01004117727279663 |0.08621394634246826 |0.19581162929534912 |0.00017088651657104492 |0.0030584335327148438 |0.0021753311157226562 |
----------------------------------------------------------pseudo_mini_loss sum 3.2342591285705566
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9373
Number of first layer input nodes during this epoch:  5865
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00889444351196289  GigaBytes
Max Memory Allocated: 0.016950607299804688  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005881786346435547
range selection method range initialization spend 8.702278137207031e-05
time for parepare:  8.797645568847656e-05
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  9.703636169433594e-05
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013136863708496094
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.939338684082031e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.104873657226562e-05
----------------------check_connections_block total spend ----------------------------- 0.0015614032745361328
generate_one_block  0.0013942718505859375
generate_one_block  0.0013146400451660156
generate_one_block  0.001313924789428711
generate_one_block  0.001310586929321289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006349086761474609
gen group dst list time:  5.269050598144531e-05
time for parepare:  0.0002181529998779297
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0006124973297119141
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  7.176399230957031e-05
r_  generation:  0.0003714561462402344
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0005068778991699219
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00016689300537109375
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.00048470497131347656
----------------------check_connections_block total spend ----------------------------- 0.0040090084075927734
generate_one_block  0.0021123886108398438
generate_one_block  0.0016307830810546875
generate_one_block  0.0018029212951660156
generate_one_block  0.0017673969268798828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007085800170898438
gen group dst list time:  0.00010919570922851562
time for parepare:  0.0002446174621582031
local_output_nid generation:  7.653236389160156e-05
local_in_edges_tensor generation:  0.0003266334533691406
mini_batch_src_global generation:  0.00018358230590820312
r_  generation:  0.0016946792602539062
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.001104116439819336
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.00023698806762695312
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0014300346374511719
local_output_nid generation:  8.273124694824219e-05
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0015361309051513672
----------------------check_connections_block total spend ----------------------------- 0.00945591926574707
generate_one_block  0.003194570541381836
generate_one_block  0.0023458003997802734
generate_one_block  0.002168893814086914
generate_one_block  0.002620697021484375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00889444351196289  GigaBytes
Max Memory Allocated: 0.016950607299804688  GigaBytes

connection checking time:  0.013464927673339844
block generation total time  0.017643451690673828
average batch blocks generation time:  0.004410862922668457
block dataloader generation time/epoch 0.04850959777832031
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00929117202758789  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

torch.Size([1579, 1433])
torch.Size([833, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009568214416503906  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.007518768310546875  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

torch.Size([1270, 1433])
torch.Size([507, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.007693767547607422  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00807809829711914  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

torch.Size([1373, 1433])
torch.Size([660, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008304119110107422  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008784294128417969  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

torch.Size([1505, 1433])
torch.Size([728, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009020805358886719  GigaBytes
Max Memory Allocated: 0.017302513122558594  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012049973011016846 |0.0005291104316711426 |0.0035562515258789062 |0.00012171268463134766 |0.0021236538887023926 |0.001573801040649414 |
----------------------------------------------------------pseudo_mini_loss sum 2.618846893310547
Total (block generation + training)time/epoch 0.1294262409210205
Training time/epoch 0.08025169372558594
Training time without block to device /epoch 0.07813525199890137
Training time without total dataloading part /epoch 0.0247802734375
load block tensor time/epoch 0.04819989204406738
block to device time/epoch 0.0021164417266845703
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9182
Number of first layer input nodes during this epoch:  5727
