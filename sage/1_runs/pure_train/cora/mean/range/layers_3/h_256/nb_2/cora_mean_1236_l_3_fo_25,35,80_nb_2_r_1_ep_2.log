main start at this time 1648428640.4477847
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010879039764404297
range selection method range initialization spend 7.939338684082031e-05
time for parepare:  6.079673767089844e-05
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0013883113861083984
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.0001270771026611328
----------------------check_connections_block total spend ----------------------------- 0.0022478103637695312
generate_one_block  0.0016014575958251953
generate_one_block  0.001241922378540039
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005328655242919922
gen group dst list time:  3.0279159545898438e-05
time for parepare:  0.00014638900756835938
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00022864341735839844
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0007002353668212891
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0006830692291259766
----------------------check_connections_block total spend ----------------------------- 0.0025243759155273438
generate_one_block  0.0019757747650146484
generate_one_block  0.0018842220306396484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006029605865478516
gen group dst list time:  5.745887756347656e-05
time for parepare:  0.00019741058349609375
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.00033092498779296875
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.001756906509399414
local_output_nid generation:  8.153915405273438e-05
local_in_edges_tensor generation:  0.00024628639221191406
mini_batch_src_global generation:  0.00017786026000976562
r_  generation:  0.0018165111541748047
----------------------check_connections_block total spend ----------------------------- 0.0057070255279541016
generate_one_block  0.003191709518432617
generate_one_block  0.0031304359436035156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.008231401443481445
block generation total time  0.01018214225769043
average batch blocks generation time:  0.005091071128845215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013362884521484375  GigaBytes
Max Memory Allocated: 0.013362884521484375  GigaBytes

torch.Size([1884, 1433])
torch.Size([1126, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.019029617309570312  GigaBytes
Max Memory Allocated: 0.019362449645996094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.01685333251953125  GigaBytes
Max Memory Allocated: 0.026851654052734375  GigaBytes

torch.Size([1919, 1433])
torch.Size([1134, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.021864891052246094  GigaBytes
Max Memory Allocated: 0.026851654052734375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013289451599121094 |0.16897857189178467 |0.3831902742385864 |0.00019979476928710938 |0.0052607059478759766 |0.001918792724609375 |
----------------------------------------------------------pseudo_mini_loss sum 4.191553115844727
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6770
Number of first layer input nodes during this epoch:  3803
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.023714542388916016  GigaBytes
Max Memory Allocated: 0.029181480407714844  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004489421844482422
range selection method range initialization spend 5.841255187988281e-05
time for parepare:  6.246566772460938e-05
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001633167266845703
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010776519775390625
----------------------check_connections_block total spend ----------------------------- 0.0008070468902587891
generate_one_block  0.0012772083282470703
generate_one_block  0.0012078285217285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00046515464782714844
gen group dst list time:  2.8133392333984375e-05
time for parepare:  0.00013709068298339844
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006825923919677734
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006392002105712891
----------------------check_connections_block total spend ----------------------------- 0.0023851394653320312
generate_one_block  0.00189971923828125
generate_one_block  0.0018777847290039062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005614757537841797
gen group dst list time:  5.459785461425781e-05
time for parepare:  0.0001685619354248047
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.0002913475036621094
mini_batch_src_global generation:  0.00014495849609375
r_  generation:  0.0016605854034423828
local_output_nid generation:  9.72747802734375e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.00017714500427246094
r_  generation:  0.0015892982482910156
----------------------check_connections_block total spend ----------------------------- 0.005198478698730469
generate_one_block  0.0029931068420410156
generate_one_block  0.002791166305541992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.023714542388916016  GigaBytes
Max Memory Allocated: 0.029181480407714844  GigaBytes

connection checking time:  0.0075836181640625
block generation total time  0.009561777114868164
average batch blocks generation time:  0.004780888557434082
block dataloader generation time/epoch 0.0417323112487793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.023464679718017578  GigaBytes
Max Memory Allocated: 0.033648014068603516  GigaBytes
Using backend: pytorch

torch.Size([1898, 1433])
torch.Size([1138, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.029834270477294922  GigaBytes
Max Memory Allocated: 0.033648014068603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023092269897460938  GigaBytes
Max Memory Allocated: 0.033648014068603516  GigaBytes

torch.Size([1827, 1433])
torch.Size([1061, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028487205505371094  GigaBytes
Max Memory Allocated: 0.033648014068603516  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002937912940979004 |0.00039374828338623047 |0.0033156871795654297 |0.000102996826171875 |0.0026625394821166992 |0.001287221908569336 |
----------------------------------------------------------pseudo_mini_loss sum 0.8553796410560608
Total (block generation + training)time/epoch 0.06405210494995117
Training time/epoch 0.021988391876220703
Training time without block to device /epoch 0.021200895309448242
Training time without total dataloading part /epoch 0.013449668884277344
load block tensor time/epoch 0.005875825881958008
block to device time/epoch 0.0007874965667724609
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6624
Number of first layer input nodes during this epoch:  3725
