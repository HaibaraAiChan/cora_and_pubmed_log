main start at this time 1648428687.045964
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001337289810180664
range selection method range initialization spend 8.177757263183594e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0002090930938720703
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.002785205841064453
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  6.151199340820312e-05
----------------------check_connections_block total spend ----------------------------- 0.004073619842529297
generate_one_block  0.0016112327575683594
generate_one_block  0.0011832714080810547
generate_one_block  0.0011763572692871094
generate_one_block  0.0011665821075439453
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005114078521728516
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.00014901161193847656
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.00044608116149902344
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00042819976806640625
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.0004830360412597656
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004279613494873047
----------------------check_connections_block total spend ----------------------------- 0.0034410953521728516
generate_one_block  0.0016314983367919922
generate_one_block  0.001613616943359375
generate_one_block  0.001642465591430664
generate_one_block  0.0016148090362548828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000598907470703125
gen group dst list time:  8.511543273925781e-05
time for parepare:  0.00017976760864257812
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.0002703666687011719
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.001222848892211914
local_output_nid generation:  6.747245788574219e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0013225078582763672
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0013463497161865234
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.000133514404296875
r_  generation:  0.0013837814331054688
----------------------check_connections_block total spend ----------------------------- 0.008501291275024414
generate_one_block  0.0025482177734375
generate_one_block  0.00263214111328125
generate_one_block  0.002620697021484375
generate_one_block  0.0025644302368164062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.011942386627197266
block generation total time  0.016867876052856445
average batch blocks generation time:  0.004216969013214111
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011255264282226562  GigaBytes
Max Memory Allocated: 0.011255264282226562  GigaBytes

torch.Size([1493, 1433])
torch.Size([730, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.014351367950439453  GigaBytes
Max Memory Allocated: 0.014801979064941406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014817237854003906  GigaBytes
Max Memory Allocated: 0.02274608612060547  GigaBytes

torch.Size([1553, 1433])
torch.Size([800, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018074512481689453  GigaBytes
Max Memory Allocated: 0.02274608612060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015197277069091797  GigaBytes
Max Memory Allocated: 0.023445606231689453  GigaBytes

torch.Size([1624, 1433])
torch.Size([815, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018587589263916016  GigaBytes
Max Memory Allocated: 0.023445606231689453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.015062808990478516  GigaBytes
Max Memory Allocated: 0.023691177368164062  GigaBytes

torch.Size([1599, 1433])
torch.Size([807, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.018330097198486328  GigaBytes
Max Memory Allocated: 0.023691177368164062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011015594005584717 |0.08554238080978394 |0.19347894191741943 |0.00016242265701293945 |0.004757702350616455 |0.002092123031616211 |
----------------------------------------------------------pseudo_mini_loss sum 4.040946006774902
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10165
Number of first layer input nodes during this epoch:  6269
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022266864776611328  GigaBytes
Max Memory Allocated: 0.027733802795410156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004756450653076172
range selection method range initialization spend 6.461143493652344e-05
time for parepare:  6.556510925292969e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  8.58306884765625e-05
local_output_nid generation:  1.049041748046875e-05
Using backend: pytorch
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.793571472167969e-05
----------------------check_connections_block total spend ----------------------------- 0.0013854503631591797
generate_one_block  0.0011794567108154297
generate_one_block  0.0011029243469238281
generate_one_block  0.0010862350463867188
generate_one_block  0.0010907649993896484
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005099773406982422
gen group dst list time:  4.2438507080078125e-05
time for parepare:  0.0001614093780517578
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004980564117431641
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00043487548828125
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.00039076805114746094
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  6.723403930664062e-05
r_  generation:  0.0004124641418457031
----------------------check_connections_block total spend ----------------------------- 0.0033388137817382812
generate_one_block  0.0017082691192626953
generate_one_block  0.0015337467193603516
generate_one_block  0.0014805793762207031
generate_one_block  0.0015101432800292969
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005998611450195312
gen group dst list time:  9.012222290039062e-05
time for parepare:  0.0001895427703857422
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.0002923011779785156
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.001352548599243164
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  0.00016999244689941406
r_  generation:  0.001241445541381836
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00012969970703125
r_  generation:  0.0011751651763916016
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00020647048950195312
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.001268148422241211
----------------------check_connections_block total spend ----------------------------- 0.008199453353881836
generate_one_block  0.002648591995239258
generate_one_block  0.0024759769439697266
generate_one_block  0.0023670196533203125
generate_one_block  0.0026731491088867188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022266864776611328  GigaBytes
Max Memory Allocated: 0.027733802795410156  GigaBytes

connection checking time:  0.011538267135620117
block generation total time  0.016397476196289062
average batch blocks generation time:  0.004099369049072266
block dataloader generation time/epoch 0.043291568756103516
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022212505340576172  GigaBytes
Max Memory Allocated: 0.030704498291015625  GigaBytes

torch.Size([1607, 1433])
torch.Size([810, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.025653839111328125  GigaBytes
Max Memory Allocated: 0.030704498291015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022165298461914062  GigaBytes
Max Memory Allocated: 0.03070545196533203  GigaBytes

torch.Size([1499, 1433])
torch.Size([741, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.025252342224121094  GigaBytes
Max Memory Allocated: 0.03070545196533203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02159738540649414  GigaBytes
Max Memory Allocated: 0.03070545196533203  GigaBytes

torch.Size([1477, 1433])
torch.Size([684, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02442455291748047  GigaBytes
Max Memory Allocated: 0.03070545196533203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021808624267578125  GigaBytes
Max Memory Allocated: 0.03070545196533203  GigaBytes

torch.Size([1532, 1433])
torch.Size([759, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024924278259277344  GigaBytes
Max Memory Allocated: 0.03070545196533203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001607358455657959 |0.0004939436912536621 |0.00352323055267334 |0.00011879205703735352 |0.0018144845962524414 |0.0016589164733886719 |
----------------------------------------------------------pseudo_mini_loss sum 1.0940210819244385
Total (block generation + training)time/epoch 0.08024811744689941
Training time/epoch 0.03667402267456055
Training time without block to device /epoch 0.0346982479095459
Training time without total dataloading part /epoch 0.02348494529724121
load block tensor time/epoch 0.006429433822631836
block to device time/epoch 0.0019757747650146484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9843
Number of first layer input nodes during this epoch:  6115
