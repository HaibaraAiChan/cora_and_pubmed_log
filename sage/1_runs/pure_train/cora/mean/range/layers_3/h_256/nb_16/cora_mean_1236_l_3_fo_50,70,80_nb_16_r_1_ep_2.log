main start at this time 1648428742.850871
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010671615600585938
range selection method range initialization spend 0.0001068115234375
time for parepare:  6.651878356933594e-05
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0024077892303466797
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010824203491210938
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001010894775390625
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4080276489257812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1457672119140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0056078433990478516
generate_one_block  0.0014777183532714844
generate_one_block  0.0011718273162841797
generate_one_block  0.001192331314086914
generate_one_block  0.0011372566223144531
generate_one_block  0.0011470317840576172
generate_one_block  0.0011341571807861328
generate_one_block  0.0011303424835205078
generate_one_block  0.0011379718780517578
generate_one_block  0.001123189926147461
generate_one_block  0.0011241436004638672
generate_one_block  0.0011966228485107422
generate_one_block  0.0011391639709472656
generate_one_block  0.0011627674102783203
generate_one_block  0.001033782958984375
generate_one_block  0.0011301040649414062
generate_one_block  0.0010154247283935547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005838871002197266
gen group dst list time:  9.512901306152344e-05
time for parepare:  0.00015783309936523438
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00010085105895996094
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00018286705017089844
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00014090538024902344
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00015997886657714844
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00017762184143066406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.00010848045349121094
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.0001456737518310547
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00014710426330566406
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002579689025878906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.000156402587890625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001552104949951172
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00014925003051757812
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.249282836914062e-05
----------------------check_connections_block total spend ----------------------------- 0.005970001220703125
generate_one_block  0.00128173828125
generate_one_block  0.0013251304626464844
generate_one_block  0.0012922286987304688
generate_one_block  0.0013091564178466797
generate_one_block  0.0013492107391357422
generate_one_block  0.0012297630310058594
generate_one_block  0.0012602806091308594
generate_one_block  0.0013048648834228516
generate_one_block  0.0012125968933105469
generate_one_block  0.0011150836944580078
generate_one_block  0.0012979507446289062
generate_one_block  0.0011789798736572266
generate_one_block  0.001173257827758789
generate_one_block  0.0011196136474609375
generate_one_block  0.0011773109436035156
generate_one_block  0.0010917186737060547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006814002990722656
gen group dst list time:  0.00016307830810546875
time for parepare:  0.0002295970916748047
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0002918243408203125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0006005764007568359
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.0001583099365234375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0005753040313720703
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0006022453308105469
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0006914138793945312
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0003819465637207031
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0004115104675292969
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005803108215332031
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  7.43865966796875e-05
r_  generation:  0.0005943775177001953
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  5.984306335449219e-05
r_  generation:  0.0004055500030517578
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017189979553222656
mini_batch_src_global generation:  8.511543273925781e-05
r_  generation:  0.0008683204650878906
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005340576171875
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005743503570556641
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003249645233154297
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.000637054443359375
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013947486877441406
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0003223419189453125
----------------------check_connections_block total spend ----------------------------- 0.015113592147827148
generate_one_block  0.0014853477478027344
generate_one_block  0.0017707347869873047
generate_one_block  0.0016210079193115234
generate_one_block  0.0016319751739501953
generate_one_block  0.0017545223236083984
generate_one_block  0.0014088153839111328
generate_one_block  0.0016808509826660156
generate_one_block  0.0016279220581054688
generate_one_block  0.001650094985961914
generate_one_block  0.0014655590057373047
generate_one_block  0.0019025802612304688
generate_one_block  0.0015308856964111328
generate_one_block  0.0015838146209716797
generate_one_block  0.0013556480407714844
generate_one_block  0.0016770362854003906
generate_one_block  0.0014061927795410156
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.021083593368530273
block generation total time  0.045271873474121094
average batch blocks generation time:  0.0028294920921325684
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005789279937744141  GigaBytes
Max Memory Allocated: 0.005789279937744141  GigaBytes

torch.Size([475, 1433])
torch.Size([133, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006398200988769531  GigaBytes
Max Memory Allocated: 0.006631374359130859  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010965347290039062  GigaBytes
Max Memory Allocated: 0.013483524322509766  GigaBytes

torch.Size([836, 1433])
torch.Size([268, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.01209878921508789  GigaBytes
Max Memory Allocated: 0.013483524322509766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011192798614501953  GigaBytes
Max Memory Allocated: 0.0156402587890625  GigaBytes

torch.Size([879, 1433])
torch.Size([309, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.012334346771240234  GigaBytes
Max Memory Allocated: 0.0156402587890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011179924011230469  GigaBytes
Max Memory Allocated: 0.0158538818359375  GigaBytes

torch.Size([876, 1433])
torch.Size([265, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.012248516082763672  GigaBytes
Max Memory Allocated: 0.0158538818359375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.011853218078613281  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([1002, 1433])
torch.Size([391, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01329803466796875  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009853363037109375  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([629, 1433])
torch.Size([173, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01059579849243164  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.00946044921875  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([555, 1433])
torch.Size([214, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010323524475097656  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010586261749267578  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([765, 1433])
torch.Size([291, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011690139770507812  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011365413665771484  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([911, 1433])
torch.Size([301, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01251220703125  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01026010513305664  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([705, 1433])
torch.Size([183, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011014461517333984  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012356281280517578  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([1095, 1433])
torch.Size([450, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.014140605926513672  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01029062271118164  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([710, 1433])
torch.Size([260, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011348724365234375  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.010259628295898438  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([704, 1433])
torch.Size([265, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011346817016601562  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009114742279052734  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([491, 1433])
torch.Size([181, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009843826293945312  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011652469635009766  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([857, 1433])
torch.Size([336, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012876033782958984  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009179115295410156  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

torch.Size([503, 1433])
torch.Size([171, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.009796142578125  GigaBytes
Max Memory Allocated: 0.016510486602783203  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005356952548027039 |0.02194276452064514 |0.05082283914089203 |0.00012114644050598145 |0.0025975704193115234 |0.001924276351928711 |
----------------------------------------------------------pseudo_mini_loss sum 4.03882360458374
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16953
Number of first layer input nodes during this epoch:  11993
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015680313110351562  GigaBytes
Max Memory Allocated: 0.02179098129272461  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004794597625732422
range selection method range initialization spend 6.604194641113281e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.00543212890625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.489059448242188e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.5735626220703125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0030825138092041016
generate_one_block  0.0011639595031738281
generate_one_block  0.0010712146759033203
generate_one_block  0.001055002212524414
generate_one_block  0.00106048583984375
generate_one_block  0.0010673999786376953
generate_one_block  0.0010533332824707031
generate_one_block  0.0012402534484863281
generate_one_block  0.0010535717010498047
generate_one_block  0.0010519027709960938
generate_one_block  0.001070261001586914
generate_one_block  0.0009946823120117188
generate_one_block  0.0009729862213134766
generate_one_block  0.000982046127319336
generate_one_block  0.0009975433349609375
generate_one_block  0.0009801387786865234
generate_one_block  0.0009765625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006048679351806641
gen group dst list time:  9.179115295410156e-05
time for parepare:  0.00014328956604003906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00020647048950195312
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00017952919006347656
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00011873245239257812
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.0001423358917236328
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00018024444580078125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00014543533325195312
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001537799835205078
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.489059448242188e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  0.00015044212341308594
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001347064971923828
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.0001232624053955078
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.000186920166015625
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.985664367675781e-05
----------------------check_connections_block total spend ----------------------------- 0.005640506744384766
generate_one_block  0.0012950897216796875
generate_one_block  0.0012505054473876953
generate_one_block  0.0012536048889160156
generate_one_block  0.0012178421020507812
generate_one_block  0.0012600421905517578
generate_one_block  0.0012357234954833984
generate_one_block  0.0012280941009521484
generate_one_block  0.0011391639709472656
generate_one_block  0.0011565685272216797
generate_one_block  0.0012180805206298828
generate_one_block  0.0011982917785644531
generate_one_block  0.0011336803436279297
generate_one_block  0.001107931137084961
generate_one_block  0.0011494159698486328
generate_one_block  0.001077413558959961
generate_one_block  0.0010666847229003906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007040500640869141
gen group dst list time:  0.00017023086547851562
time for parepare:  0.00022482872009277344
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0002911090850830078
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0007185935974121094
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0006706714630126953
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004360675811767578
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0006108283996582031
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006232261657714844
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  6.651878356933594e-05
r_  generation:  0.0005364418029785156
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005807876586914062
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00032711029052734375
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.0003082752227783203
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005717277526855469
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0005345344543457031
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.00030112266540527344
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.0004687309265136719
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  7.033348083496094e-05
r_  generation:  0.0006225109100341797
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.00044798851013183594
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.0002808570861816406
----------------------check_connections_block total spend ----------------------------- 0.014549970626831055
generate_one_block  0.0019092559814453125
generate_one_block  0.0017893314361572266
generate_one_block  0.0014164447784423828
generate_one_block  0.001627206802368164
generate_one_block  0.0016484260559082031
generate_one_block  0.0015323162078857422
generate_one_block  0.0015566349029541016
generate_one_block  0.0013034343719482422
generate_one_block  0.0012707710266113281
generate_one_block  0.0015556812286376953
generate_one_block  0.0014941692352294922
generate_one_block  0.0014040470123291016
generate_one_block  0.0014569759368896484
generate_one_block  0.0016124248504638672
generate_one_block  0.0014255046844482422
generate_one_block  0.0012099742889404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015680313110351562  GigaBytes
Max Memory Allocated: 0.02179098129272461  GigaBytes

connection checking time:  0.02019047737121582
block generation total time  0.04320073127746582
average batch blocks generation time:  0.0027000457048416138
block dataloader generation time/epoch 0.09754300117492676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018551349639892578  GigaBytes
Max Memory Allocated: 0.02179098129272461  GigaBytes

torch.Size([1043, 1433])
torch.Size([374, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.020026206970214844  GigaBytes
Max Memory Allocated: 0.02179098129272461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01817035675048828  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([972, 1433])
torch.Size([336, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01950836181640625  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01607656478881836  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([581, 1433])
torch.Size([213, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016941070556640625  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017747879028320312  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([893, 1433])
torch.Size([311, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018922805786132812  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017724037170410156  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([842, 1433])
torch.Size([310, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.019001007080078125  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01714801788330078  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([781, 1433])
torch.Size([316, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018315792083740234  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01772308349609375  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([809, 1433])
torch.Size([298, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018892765045166016  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015678882598876953  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([507, 1433])
torch.Size([178, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016375064849853516  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015656471252441406  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([479, 1433])
torch.Size([143, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016275882720947266  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01772308349609375  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([770, 1433])
torch.Size([296, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018878459930419922  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01676797866821289  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes
Using backend: pytorch

torch.Size([710, 1433])
torch.Size([252, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01776409149169922  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01590728759765625  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([550, 1433])
torch.Size([159, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01651144027709961  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016942501068115234  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([743, 1433])
torch.Size([255, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017925739288330078  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.017724990844726562  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([845, 1433])
torch.Size([305, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01900768280029297  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016626358032226562  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([684, 1433])
torch.Size([238, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01752328872680664  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.015655517578125  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

torch.Size([425, 1433])
torch.Size([120, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.016140460968017578  GigaBytes
Max Memory Allocated: 0.023718833923339844  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012583136558532715 |0.000460699200630188 |0.0036047697067260742 |0.00011850893497467041 |0.0029690712690353394 |0.0017857551574707031 |
----------------------------------------------------------pseudo_mini_loss sum 1.2674678564071655
Total (block generation + training)time/epoch 0.25132155418395996
Training time/epoch 0.15343642234802246
Training time without block to device /epoch 0.14606523513793945
Training time without total dataloading part /epoch 0.10886335372924805
load block tensor time/epoch 0.020133018493652344
block to device time/epoch 0.007371187210083008
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16497
Number of first layer input nodes during this epoch:  11634
