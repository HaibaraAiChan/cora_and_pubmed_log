main start at this time 1648428724.5437796
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006091594696044922
range selection method range initialization spend 8.368492126464844e-05
time for parepare:  7.176399230957031e-05
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0011224746704101562
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  6.413459777832031e-05
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.222724914550781e-05
----------------------check_connections_block total spend ----------------------------- 0.0023193359375
generate_one_block  0.0013060569763183594
generate_one_block  0.0011522769927978516
generate_one_block  0.0011470317840576172
generate_one_block  0.001130819320678711
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005064010620117188
gen group dst list time:  4.220008850097656e-05
time for parepare:  0.000148773193359375
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.0004298686981201172
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.91278076171875e-05
r_  generation:  0.0004165172576904297
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004596710205078125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.00041747093200683594
----------------------check_connections_block total spend ----------------------------- 0.003368377685546875
generate_one_block  0.0015990734100341797
generate_one_block  0.0015766620635986328
generate_one_block  0.0016124248504638672
generate_one_block  0.0015697479248046875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006003379821777344
gen group dst list time:  8.0108642578125e-05
time for parepare:  0.0001842975616455078
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00027489662170410156
mini_batch_src_global generation:  0.0001266002655029297
r_  generation:  0.0012476444244384766
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.0001544952392578125
r_  generation:  0.001336812973022461
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.00014328956604003906
r_  generation:  0.0013918876647949219
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0013396739959716797
----------------------check_connections_block total spend ----------------------------- 0.008578777313232422
generate_one_block  0.002620220184326172
generate_one_block  0.0026814937591552734
generate_one_block  0.0025701522827148438
generate_one_block  0.0026459693908691406
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.011947154998779297
block generation total time  0.016875743865966797
average batch blocks generation time:  0.004218935966491699
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.011614799499511719  GigaBytes
Max Memory Allocated: 0.011614799499511719  GigaBytes

torch.Size([1560, 1433])
torch.Size([732, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.014719009399414062  GigaBytes
Max Memory Allocated: 0.015233039855957031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014956951141357422  GigaBytes
Max Memory Allocated: 0.023242473602294922  GigaBytes

torch.Size([1579, 1433])
torch.Size([804, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018227577209472656  GigaBytes
Max Memory Allocated: 0.023242473602294922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.015326976776123047  GigaBytes
Max Memory Allocated: 0.023712158203125  GigaBytes

torch.Size([1648, 1433])
torch.Size([812, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.018709659576416016  GigaBytes
Max Memory Allocated: 0.023712158203125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01515960693359375  GigaBytes
Max Memory Allocated: 0.023914813995361328  GigaBytes

torch.Size([1617, 1433])
torch.Size([812, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.01844310760498047  GigaBytes
Max Memory Allocated: 0.023914813995361328  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017780721187591553 |0.08760970830917358 |0.19152116775512695 |0.00014197826385498047 |0.004014432430267334 |0.0017709732055664062 |
----------------------------------------------------------pseudo_mini_loss sum 4.039811134338379
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10308
Number of first layer input nodes during this epoch:  6404
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02200794219970703  GigaBytes
Max Memory Allocated: 0.02747488021850586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004630088806152344
range selection method range initialization spend 6.0558319091796875e-05
time for parepare:  6.341934204101562e-05
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00010633468627929688
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  7.271766662597656e-05
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.435943603515625e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.745887756347656e-05
----------------------check_connections_block total spend ----------------------------- 0.0012395381927490234
generate_one_block  0.0011844635009765625
generate_one_block  0.0010638236999511719
generate_one_block  0.0010571479797363281
generate_one_block  0.0010480880737304688
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048470497131347656
gen group dst list time:  3.9577484130859375e-05
time for parepare:  0.00015544891357421875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.00048160552978515625
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  7.724761962890625e-05
r_  generation:  0.0004181861877441406
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  5.7697296142578125e-05
r_  generation:  0.00037360191345214844
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003981590270996094
----------------------check_connections_block total spend ----------------------------- 0.0032155513763427734
generate_one_block  0.0016503334045410156
generate_one_block  0.0014879703521728516
generate_one_block  0.0014264583587646484
generate_one_block  0.0014929771423339844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005967617034912109
gen group dst list time:  8.249282836914062e-05
time for parepare:  0.00018477439880371094
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002808570861816406
mini_batch_src_global generation:  0.00012540817260742188
r_  generation:  0.0013852119445800781
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.00021004676818847656
mini_batch_src_global generation:  0.00018143653869628906
r_  generation:  0.0012521743774414062
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.00012373924255371094
r_  generation:  0.0011761188507080078
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.00019931793212890625
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.001262664794921875
----------------------check_connections_block total spend ----------------------------- 0.008251190185546875
generate_one_block  0.0026586055755615234
generate_one_block  0.0025281906127929688
generate_one_block  0.0022878646850585938
generate_one_block  0.002635478973388672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02200794219970703  GigaBytes
Max Memory Allocated: 0.02747488021850586  GigaBytes

connection checking time:  0.011466741561889648
block generation total time  0.016167879104614258
average batch blocks generation time:  0.0040419697761535645
block dataloader generation time/epoch 0.04264974594116211
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02212381362915039  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

torch.Size([1657, 1433])
torch.Size([812, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.025573253631591797  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021601200103759766  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

torch.Size([1535, 1433])
torch.Size([739, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02468395233154297  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02125692367553711  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

torch.Size([1496, 1433])
torch.Size([675, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024057388305664062  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021601200103759766  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

torch.Size([1541, 1433])
torch.Size([757, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02471160888671875  GigaBytes
Max Memory Allocated: 0.03070974349975586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0024040937423706055 |0.0003833770751953125 |0.003003358840942383 |0.0001023411750793457 |0.0033100247383117676 |0.0012826919555664062 |
----------------------------------------------------------pseudo_mini_loss sum 1.0519216060638428
Total (block generation + training)time/epoch 0.08468055725097656
Training time/epoch 0.041779518127441406
Training time without block to device /epoch 0.040246009826660156
Training time without total dataloading part /epoch 0.02694559097290039
load block tensor time/epoch 0.009616374969482422
block to device time/epoch 0.00153350830078125
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9946
Number of first layer input nodes during this epoch:  6229
