main start at this time 1648428677.7566855
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012428760528564453
range selection method range initialization spend 7.748603820800781e-05
time for parepare:  6.389617919921875e-05
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0013689994812011719
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001220703125
----------------------check_connections_block total spend ----------------------------- 0.0022225379943847656
generate_one_block  0.001617431640625
generate_one_block  0.0012810230255126953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005097389221191406
gen group dst list time:  3.075599670410156e-05
time for parepare:  0.0001456737518310547
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0007216930389404297
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.0007197856903076172
----------------------check_connections_block total spend ----------------------------- 0.0026144981384277344
generate_one_block  0.002000093460083008
generate_one_block  0.0019481182098388672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005962848663330078
gen group dst list time:  5.7220458984375e-05
time for parepare:  0.00017547607421875
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.00032591819763183594
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0018231868743896484
local_output_nid generation:  8.535385131835938e-05
local_in_edges_tensor generation:  0.00025725364685058594
mini_batch_src_global generation:  0.00018286705017089844
r_  generation:  0.0018310546875
----------------------check_connections_block total spend ----------------------------- 0.005808591842651367
generate_one_block  0.0032494068145751953
generate_one_block  0.0031805038452148438
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.008423089981079102
block generation total time  0.010378122329711914
average batch blocks generation time:  0.005189061164855957
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013664722442626953  GigaBytes
Max Memory Allocated: 0.013664722442626953  GigaBytes

torch.Size([1940, 1433])
torch.Size([1203, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.018928050994873047  GigaBytes
Max Memory Allocated: 0.019260883331298828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01711893081665039  GigaBytes
Max Memory Allocated: 0.027413368225097656  GigaBytes

torch.Size([1980, 1433])
torch.Size([1211, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.022373199462890625  GigaBytes
Max Memory Allocated: 0.027413368225097656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.014943838119506836 |0.1711585521697998 |0.3842439651489258 |0.00018894672393798828 |0.005372524261474609 |0.0035805702209472656 |
----------------------------------------------------------pseudo_mini_loss sum 3.774043083190918
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7041
Number of first layer input nodes during this epoch:  3920
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023742198944091797  GigaBytes
Max Memory Allocated: 0.029970645904541016  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007071495056152344
range selection method range initialization spend 9.226799011230469e-05
time for parepare:  0.0001049041748046875
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00022077560424804688
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00015354156494140625
----------------------check_connections_block total spend ----------------------------- 0.0012793540954589844
generate_one_block  0.0013804435729980469
generate_one_block  0.0012459754943847656
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005300045013427734
gen group dst list time:  3.147125244140625e-05
time for parepare:  0.00016689300537109375
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0002276897430419922
mini_batch_src_global generation:  8.916854858398438e-05
r_  generation:  0.0008261203765869141
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0007071495056152344
----------------------check_connections_block total spend ----------------------------- 0.0027854442596435547
generate_one_block  0.0021255016326904297
generate_one_block  0.0021162033081054688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005564689636230469
gen group dst list time:  6.103515625e-05
time for parepare:  0.0001862049102783203
local_output_nid generation:  7.700920104980469e-05
local_in_edges_tensor generation:  0.0003151893615722656
mini_batch_src_global generation:  0.0001621246337890625
r_  generation:  0.0018754005432128906
local_output_nid generation:  7.796287536621094e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.00018525123596191406
r_  generation:  0.0017120838165283203
----------------------check_connections_block total spend ----------------------------- 0.005661964416503906
generate_one_block  0.0031332969665527344
generate_one_block  0.002949237823486328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023742198944091797  GigaBytes
Max Memory Allocated: 0.029970645904541016  GigaBytes

connection checking time:  0.008447408676147461
block generation total time  0.010324239730834961
average batch blocks generation time:  0.0051621198654174805
block dataloader generation time/epoch 0.03856515884399414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.023523330688476562  GigaBytes
Max Memory Allocated: 0.03402853012084961  GigaBytes
Using backend: pytorch

torch.Size([1966, 1433])
torch.Size([1213, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03033304214477539  GigaBytes
Max Memory Allocated: 0.03402853012084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02359151840209961  GigaBytes
Max Memory Allocated: 0.034029483795166016  GigaBytes

torch.Size([1880, 1433])
torch.Size([1113, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03022909164428711  GigaBytes
Max Memory Allocated: 0.034029483795166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029456615447998047 |0.00040733814239501953 |0.003274202346801758 |0.00010919570922851562 |0.002006053924560547 |0.0017247200012207031 |
----------------------------------------------------------pseudo_mini_loss sum 0.8111252784729004
Total (block generation + training)time/epoch 0.06007981300354004
Training time/epoch 0.021275758743286133
Training time without block to device /epoch 0.020461082458496094
Training time without total dataloading part /epoch 0.012503623962402344
load block tensor time/epoch 0.005891323089599609
block to device time/epoch 0.0008146762847900391
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6872
Number of first layer input nodes during this epoch:  3846
