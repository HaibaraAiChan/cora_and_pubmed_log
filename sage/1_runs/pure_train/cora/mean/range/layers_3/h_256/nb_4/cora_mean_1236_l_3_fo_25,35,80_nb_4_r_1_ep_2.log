main start at this time 1648428649.7407126
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016591548919677734
range selection method range initialization spend 8.893013000488281e-05
time for parepare:  6.0558319091796875e-05
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0036051273345947266
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  5.936622619628906e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  6.508827209472656e-05
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.7697296142578125e-05
----------------------check_connections_block total spend ----------------------------- 0.004749298095703125
generate_one_block  0.0013539791107177734
generate_one_block  0.0010983943939208984
generate_one_block  0.0010869503021240234
generate_one_block  0.0010647773742675781
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004837512969970703
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.0001385211944580078
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00039124488830566406
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.00037288665771484375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00040602684020996094
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003669261932373047
----------------------check_connections_block total spend ----------------------------- 0.0030853748321533203
generate_one_block  0.00147247314453125
generate_one_block  0.0014646053314208984
generate_one_block  0.0014755725860595703
generate_one_block  0.0014564990997314453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000568389892578125
gen group dst list time:  6.961822509765625e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0010454654693603516
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.00019431114196777344
mini_batch_src_global generation:  0.0001323223114013672
r_  generation:  0.0012328624725341797
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.001142740249633789
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.00011539459228515625
r_  generation:  0.001194000244140625
----------------------check_connections_block total spend ----------------------------- 0.0073947906494140625
generate_one_block  0.0022683143615722656
generate_one_block  0.0023572444915771484
generate_one_block  0.0023651123046875
generate_one_block  0.002423524856567383
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.010480165481567383
block generation total time  0.015283346176147461
average batch blocks generation time:  0.0038208365440368652
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010910987854003906  GigaBytes
Max Memory Allocated: 0.010910987854003906  GigaBytes

torch.Size([1429, 1433])
torch.Size([668, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.013812065124511719  GigaBytes
Max Memory Allocated: 0.014217376708984375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014494895935058594  GigaBytes
Max Memory Allocated: 0.02208423614501953  GigaBytes

torch.Size([1493, 1433])
torch.Size([731, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.017535686492919922  GigaBytes
Max Memory Allocated: 0.02208423614501953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.014729976654052734  GigaBytes
Max Memory Allocated: 0.02266073226928711  GigaBytes

torch.Size([1537, 1433])
torch.Size([727, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01784372329711914  GigaBytes
Max Memory Allocated: 0.02266073226928711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.014621257781982422  GigaBytes
Max Memory Allocated: 0.02278900146484375  GigaBytes

torch.Size([1517, 1433])
torch.Size([728, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.017638683319091797  GigaBytes
Max Memory Allocated: 0.02278900146484375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009487390518188477 |0.08589369058609009 |0.19443726539611816 |0.00018656253814697266 |0.003636300563812256 |0.002658367156982422 |
----------------------------------------------------------pseudo_mini_loss sum 4.031829357147217
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9574
Number of first layer input nodes during this epoch:  5976
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.022161483764648438  GigaBytes
Max Memory Allocated: 0.02842426300048828  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005328655242919922
range selection method range initialization spend 7.200241088867188e-05
time for parepare:  7.724761962890625e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  9.799003601074219e-05
local_output_nid generation:  1.2636184692382812e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.487701416015625e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.0015578269958496094
generate_one_block  0.0013430118560791016
generate_one_block  0.0012392997741699219
generate_one_block  0.0012180805206298828
generate_one_block  0.0011899471282958984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047278404235839844
gen group dst list time:  3.8623809814453125e-05
time for parepare:  0.0001513957977294922
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00019788742065429688
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.00043272972106933594
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00012683868408203125
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.00039958953857421875
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003490447998046875
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00038361549377441406
----------------------check_connections_block total spend ----------------------------- 0.0030517578125
generate_one_block  0.0016143321990966797
generate_one_block  0.0014352798461914062
generate_one_block  0.0014235973358154297
generate_one_block  0.0014128684997558594
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005617141723632812
gen group dst list time:  7.414817810058594e-05
time for parepare:  0.00017309188842773438
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0002722740173339844
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0012378692626953125
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.0001842975616455078
mini_batch_src_global generation:  0.00014281272888183594
r_  generation:  0.0010504722595214844
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0010755062103271484
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0010738372802734375
----------------------check_connections_block total spend ----------------------------- 0.0072367191314697266
generate_one_block  0.002624034881591797
generate_one_block  0.002177715301513672
generate_one_block  0.0022203922271728516
generate_one_block  0.0025968551635742188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.022161483764648438  GigaBytes
Max Memory Allocated: 0.02842426300048828  GigaBytes

connection checking time:  0.010288476943969727
block generation total time  0.015505075454711914
average batch blocks generation time:  0.0038762688636779785
block dataloader generation time/epoch 0.042946815490722656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.022101402282714844  GigaBytes
Max Memory Allocated: 0.030158519744873047  GigaBytes

torch.Size([1522, 1433])
torch.Size([750, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.025352954864501953  GigaBytes
Max Memory Allocated: 0.030158519744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022070884704589844  GigaBytes
Max Memory Allocated: 0.030159473419189453  GigaBytes

torch.Size([1406, 1433])
torch.Size([670, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02493572235107422  GigaBytes
Max Memory Allocated: 0.030159473419189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021417617797851562  GigaBytes
Max Memory Allocated: 0.030159473419189453  GigaBytes

torch.Size([1395, 1433])
torch.Size([632, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024080753326416016  GigaBytes
Max Memory Allocated: 0.030159473419189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.022070884704589844  GigaBytes
Max Memory Allocated: 0.030159473419189453  GigaBytes

torch.Size([1449, 1433])
torch.Size([695, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024985313415527344  GigaBytes
Max Memory Allocated: 0.030159473419189453  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002262294292449951 |0.0003771781921386719 |0.0030466318130493164 |9.840726852416992e-05 |0.0023350119590759277 |0.0012612342834472656 |
----------------------------------------------------------pseudo_mini_loss sum 1.0211669206619263
Total (block generation + training)time/epoch 0.08064627647399902
Training time/epoch 0.0373692512512207
Training time without block to device /epoch 0.035860538482666016
Training time without total dataloading part /epoch 0.023181438446044922
load block tensor time/epoch 0.009049177169799805
block to device time/epoch 0.0015087127685546875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9253
Number of first layer input nodes during this epoch:  5772
