main start at this time 1648428612.192359
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001739501953125
range selection method range initialization spend 0.0001468658447265625
time for parepare:  0.00013709068298339844
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.0003750324249267578
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.004014015197753906
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00013446807861328125
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  4.291534423828125e-05
r_  generation:  0.00015401840209960938
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0001361370086669922
----------------------check_connections_block total spend ----------------------------- 0.006558895111083984
generate_one_block  0.002656221389770508
generate_one_block  0.001528024673461914
generate_one_block  0.0015189647674560547
generate_one_block  0.001493692398071289
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007472038269042969
gen group dst list time:  5.650520324707031e-05
time for parepare:  0.0002079010009765625
local_output_nid generation:  2.3365020751953125e-05
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  6.67572021484375e-05
r_  generation:  0.000598907470703125
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  7.62939453125e-05
r_  generation:  0.0005908012390136719
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  7.534027099609375e-05
r_  generation:  0.0006518363952636719
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00023889541625976562
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0004000663757324219
----------------------check_connections_block total spend ----------------------------- 0.004349231719970703
generate_one_block  0.0015132427215576172
generate_one_block  0.0015010833740234375
generate_one_block  0.0015163421630859375
generate_one_block  0.0014781951904296875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005941390991210938
gen group dst list time:  7.510185241699219e-05
time for parepare:  0.0001735687255859375
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00026798248291015625
mini_batch_src_global generation:  0.00010251998901367188
r_  generation:  0.001132965087890625
local_output_nid generation:  6.556510925292969e-05
local_in_edges_tensor generation:  0.0001957416534423828
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.001199483871459961
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  0.000125885009765625
r_  generation:  0.0011439323425292969
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0011568069458007812
----------------------check_connections_block total spend ----------------------------- 0.007560014724731445
generate_one_block  0.002254486083984375
generate_one_block  0.002412080764770508
generate_one_block  0.002329587936401367
generate_one_block  0.002367734909057617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

connection checking time:  0.011909246444702148
block generation total time  0.015372753143310547
average batch blocks generation time:  0.0038431882858276367
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.010889530181884766  GigaBytes
Max Memory Allocated: 0.010889530181884766  GigaBytes

torch.Size([1425, 1433])
torch.Size([663, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.013775348663330078  GigaBytes
Max Memory Allocated: 0.014177799224853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01447916030883789  GigaBytes
Max Memory Allocated: 0.022047042846679688  GigaBytes

torch.Size([1490, 1433])
torch.Size([738, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01754140853881836  GigaBytes
Max Memory Allocated: 0.022047042846679688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.014719009399414062  GigaBytes
Max Memory Allocated: 0.022634029388427734  GigaBytes

torch.Size([1535, 1433])
torch.Size([735, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01785755157470703  GigaBytes
Max Memory Allocated: 0.022634029388427734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.014556884765625  GigaBytes
Max Memory Allocated: 0.022713661193847656  GigaBytes

torch.Size([1505, 1433])
torch.Size([729, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.017577648162841797  GigaBytes
Max Memory Allocated: 0.022713661193847656  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0048944950103759766 |0.08604878187179565 |0.19362092018127441 |0.00019556283950805664 |0.004077732563018799 |0.002203226089477539 |
----------------------------------------------------------pseudo_mini_loss sum 4.053680419921875
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9564
Number of first layer input nodes during this epoch:  5955
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021123886108398438  GigaBytes
Max Memory Allocated: 0.02736520767211914  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005855560302734375
range selection method range initialization spend 8.7738037109375e-05
time for parepare:  9.202957153320312e-05
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.0001304149627685547
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.914138793945312e-05
----------------------check_connections_block total spend ----------------------------- 0.001560211181640625
generate_one_block  0.0014281272888183594
generate_one_block  0.0013413429260253906
generate_one_block  0.001314401626586914
generate_one_block  0.0013170242309570312
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005979537963867188
gen group dst list time:  5.1975250244140625e-05
time for parepare:  0.00021338462829589844
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002269744873046875
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0005860328674316406
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0004904270172119141
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.00044655799865722656
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0004582405090332031
----------------------check_connections_block total spend ----------------------------- 0.003928661346435547
generate_one_block  0.0020198822021484375
generate_one_block  0.0018184185028076172
generate_one_block  0.0017480850219726562
generate_one_block  0.0017898082733154297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007109642028808594
gen group dst list time:  0.00010991096496582031
time for parepare:  0.0002498626708984375
local_output_nid generation:  6.771087646484375e-05
local_in_edges_tensor generation:  0.0003116130828857422
mini_batch_src_global generation:  0.00015687942504882812
r_  generation:  0.0015950202941894531
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  0.00019359588623046875
r_  generation:  0.0014772415161132812
local_output_nid generation:  7.390975952148438e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.001180887222290039
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.001203775405883789
----------------------check_connections_block total spend ----------------------------- 0.009070396423339844
generate_one_block  0.0026471614837646484
generate_one_block  0.002435445785522461
generate_one_block  0.002284526824951172
generate_one_block  0.002571582794189453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021123886108398438  GigaBytes
Max Memory Allocated: 0.02736520767211914  GigaBytes

connection checking time:  0.01299905776977539
block generation total time  0.017314910888671875
average batch blocks generation time:  0.004328727722167969
block dataloader generation time/epoch 0.04776930809020996
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02109050750732422  GigaBytes
Max Memory Allocated: 0.029083251953125  GigaBytes

torch.Size([1515, 1433])
torch.Size([742, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.024317264556884766  GigaBytes
Max Memory Allocated: 0.029083251953125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02103424072265625  GigaBytes
Max Memory Allocated: 0.029084205627441406  GigaBytes

torch.Size([1412, 1433])
torch.Size([677, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.023921966552734375  GigaBytes
Max Memory Allocated: 0.029084205627441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.020578861236572266  GigaBytes
Max Memory Allocated: 0.029084205627441406  GigaBytes

torch.Size([1420, 1433])
torch.Size([640, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.02326822280883789  GigaBytes
Max Memory Allocated: 0.029084205627441406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.021033287048339844  GigaBytes
Max Memory Allocated: 0.029084205627441406  GigaBytes

torch.Size([1440, 1433])
torch.Size([680, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.023900985717773438  GigaBytes
Max Memory Allocated: 0.029084205627441406  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001166701316833496 |0.0004337430000305176 |0.0033031105995178223 |0.00012123584747314453 |0.0017205476760864258 |0.0014357566833496094 |
----------------------------------------------------------pseudo_mini_loss sum 1.0796785354614258
Total (block generation + training)time/epoch 0.08052754402160645
Training time/epoch 0.03258252143859863
Training time without block to device /epoch 0.030847549438476562
Training time without total dataloading part /epoch 0.02201533317565918
load block tensor time/epoch 0.004666805267333984
block to device time/epoch 0.0017349720001220703
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9260
Number of first layer input nodes during this epoch:  5787
