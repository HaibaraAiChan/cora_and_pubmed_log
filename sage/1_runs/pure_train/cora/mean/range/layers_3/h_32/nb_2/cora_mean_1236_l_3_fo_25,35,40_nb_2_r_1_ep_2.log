main start at this time 1648428155.6279972
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010993480682373047
range selection method range initialization spend 8.320808410644531e-05
time for parepare:  6.580352783203125e-05
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.00022912025451660156
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.0014145374298095703
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00013375282287597656
----------------------check_connections_block total spend ----------------------------- 0.0023317337036132812
generate_one_block  0.0016255378723144531
generate_one_block  0.0012426376342773438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005083084106445312
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.0001418590545654297
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00022172927856445312
mini_batch_src_global generation:  6.532669067382812e-05
r_  generation:  0.0006918907165527344
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0007214546203613281
----------------------check_connections_block total spend ----------------------------- 0.0025365352630615234
generate_one_block  0.0019276142120361328
generate_one_block  0.0018994808197021484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005867481231689453
gen group dst list time:  5.8650970458984375e-05
time for parepare:  0.00018286705017089844
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.0003170967102050781
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0017714500427246094
local_output_nid generation:  8.177757263183594e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0018379688262939453
----------------------check_connections_block total spend ----------------------------- 0.005724430084228516
generate_one_block  0.0036668777465820312
generate_one_block  0.003165006637573242
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.008260965347290039
block generation total time  0.010658979415893555
average batch blocks generation time:  0.005329489707946777
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.0105438232421875  GigaBytes
Max Memory Allocated: 0.0105438232421875  GigaBytes

torch.Size([1897, 1433])
torch.Size([1103, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2537841796875 GB
    Memory Allocated: 0.01122140884399414  GigaBytes
Max Memory Allocated: 0.011254310607910156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010906696319580078  GigaBytes
Max Memory Allocated: 0.02097463607788086  GigaBytes

torch.Size([1898, 1433])
torch.Size([1132, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011602401733398438  GigaBytes
Max Memory Allocated: 0.02097463607788086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008071422576904297 |0.17091715335845947 |0.38147902488708496 |0.00022590160369873047 |0.004503846168518066 |0.0038232803344726562 |
----------------------------------------------------------pseudo_mini_loss sum 3.5897068977355957
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6722
Number of first layer input nodes during this epoch:  3795
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011753082275390625  GigaBytes
Max Memory Allocated: 0.02097463607788086  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006570816040039062
range selection method range initialization spend 8.606910705566406e-05
time for parepare:  9.655952453613281e-05
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00023603439331054688
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001780986785888672
----------------------check_connections_block total spend ----------------------------- 0.0012128353118896484
generate_one_block  0.0017125606536865234
generate_one_block  0.0016434192657470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006875991821289062
gen group dst list time:  4.410743713378906e-05
time for parepare:  0.00021076202392578125
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00028228759765625
mini_batch_src_global generation:  9.965896606445312e-05
r_  generation:  0.0010254383087158203
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0008120536804199219
----------------------check_connections_block total spend ----------------------------- 0.0033903121948242188
generate_one_block  0.0018873214721679688
generate_one_block  0.0019364356994628906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005586147308349609
gen group dst list time:  5.698204040527344e-05
time for parepare:  0.0001800060272216797
local_output_nid generation:  7.319450378417969e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.0001823902130126953
r_  generation:  0.0017418861389160156
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0016901493072509766
----------------------check_connections_block total spend ----------------------------- 0.005458354949951172
generate_one_block  0.0030171871185302734
generate_one_block  0.0031435489654541016
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011753082275390625  GigaBytes
Max Memory Allocated: 0.02097463607788086  GigaBytes

connection checking time:  0.00884866714477539
block generation total time  0.009984493255615234
average batch blocks generation time:  0.004992246627807617
block dataloader generation time/epoch 0.03577470779418945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011591911315917969  GigaBytes
Max Memory Allocated: 0.021665096282958984  GigaBytes
Using backend: pytorch

torch.Size([1894, 1433])
torch.Size([1138, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012286663055419922  GigaBytes
Max Memory Allocated: 0.021665096282958984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011286735534667969  GigaBytes
Max Memory Allocated: 0.021665096282958984  GigaBytes

torch.Size([1837, 1433])
torch.Size([1058, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011952877044677734  GigaBytes
Max Memory Allocated: 0.021665096282958984  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0028634071350097656 |0.00041091442108154297 |0.0031949281692504883 |0.00012814998626708984 |0.0020110607147216797 |0.0013918876647949219 |
----------------------------------------------------------pseudo_mini_loss sum 2.629270076751709
Total (block generation + training)time/epoch 0.056673526763916016
Training time/epoch 0.020631790161132812
Training time without block to device /epoch 0.019809961318969727
Training time without total dataloading part /epoch 0.012060165405273438
load block tensor time/epoch 0.005726814270019531
block to device time/epoch 0.0008218288421630859
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6629
Number of first layer input nodes during this epoch:  3731
