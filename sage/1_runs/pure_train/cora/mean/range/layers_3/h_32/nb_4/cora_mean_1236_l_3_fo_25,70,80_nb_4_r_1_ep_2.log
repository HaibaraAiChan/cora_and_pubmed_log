main start at this time 1648428239.3130686
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008368492126464844
range selection method range initialization spend 0.00010633468627929688
time for parepare:  6.389617919921875e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.6702880859375e-05
r_  generation:  0.001737833023071289
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  5.507469177246094e-05
----------------------check_connections_block total spend ----------------------------- 0.0029265880584716797
generate_one_block  0.0032536983489990234
generate_one_block  0.0011594295501708984
generate_one_block  0.0011246204376220703
generate_one_block  0.0010619163513183594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009102821350097656
gen group dst list time:  3.886222839355469e-05
time for parepare:  0.0001583099365234375
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  5.0067901611328125e-05
r_  generation:  0.0004336833953857422
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.00044608116149902344
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  6.031990051269531e-05
r_  generation:  0.0004837512969970703
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00021386146545410156
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003657341003417969
----------------------check_connections_block total spend ----------------------------- 0.003379344940185547
generate_one_block  0.0015578269958496094
generate_one_block  0.0015347003936767578
generate_one_block  0.0015828609466552734
generate_one_block  0.0014500617980957031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005917549133300781
gen group dst list time:  7.987022399902344e-05
time for parepare:  0.0001780986785888672
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00029158592224121094
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0013170242309570312
local_output_nid generation:  6.318092346191406e-05
local_in_edges_tensor generation:  0.00021958351135253906
mini_batch_src_global generation:  0.0001575946807861328
r_  generation:  0.0013113021850585938
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  0.00013971328735351562
r_  generation:  0.001435995101928711
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0011050701141357422
----------------------check_connections_block total spend ----------------------------- 0.008356809616088867
generate_one_block  0.0026166439056396484
generate_one_block  0.0025053024291992188
generate_one_block  0.002596139907836914
generate_one_block  0.002248048782348633
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.011736154556274414
block generation total time  0.016091585159301758
average batch blocks generation time:  0.0040228962898254395
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009047508239746094  GigaBytes
Max Memory Allocated: 0.009047508239746094  GigaBytes

torch.Size([1620, 1433])
torch.Size([776, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00949716567993164  GigaBytes
Max Memory Allocated: 0.009555339813232422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00916290283203125  GigaBytes
Max Memory Allocated: 0.017769813537597656  GigaBytes

torch.Size([1575, 1433])
torch.Size([810, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009621143341064453  GigaBytes
Max Memory Allocated: 0.017769813537597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.00969696044921875  GigaBytes
Max Memory Allocated: 0.018057823181152344  GigaBytes

torch.Size([1674, 1433])
torch.Size([877, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.010201454162597656  GigaBytes
Max Memory Allocated: 0.018057823181152344  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008563518524169922  GigaBytes
Max Memory Allocated: 0.018057823181152344  GigaBytes

torch.Size([1464, 1433])
torch.Size([653, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008951663970947266  GigaBytes
Max Memory Allocated: 0.018057823181152344  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0072824954986572266 |0.08705753087997437 |0.19345051050186157 |0.00019562244415283203 |0.0044983625411987305 |0.0025491714477539062 |
----------------------------------------------------------pseudo_mini_loss sum 3.4145257472991943
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10178
Number of first layer input nodes during this epoch:  6333
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00935506820678711  GigaBytes
Max Memory Allocated: 0.018057823181152344  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005917549133300781
range selection method range initialization spend 9.226799011230469e-05
time for parepare:  8.726119995117188e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002105236053466797
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  9.584426879882812e-05
local_output_nid generation:  1.5020370483398438e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  7.510185241699219e-05
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  7.843971252441406e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.723403930664062e-05
----------------------check_connections_block total spend ----------------------------- 0.0015652179718017578
generate_one_block  0.0015282630920410156
generate_one_block  0.0014078617095947266
generate_one_block  0.0014119148254394531
generate_one_block  0.0013952255249023438
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006084442138671875
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.0002162456512451172
local_output_nid generation:  2.2411346435546875e-05
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0006711483001708984
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0004222393035888672
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.0005850791931152344
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.00046062469482421875
----------------------check_connections_block total spend ----------------------------- 0.004113912582397461
generate_one_block  0.0022284984588623047
generate_one_block  0.0017960071563720703
generate_one_block  0.0019986629486083984
generate_one_block  0.00185394287109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007290840148925781
gen group dst list time:  0.00011801719665527344
time for parepare:  0.000247955322265625
local_output_nid generation:  9.012222290039062e-05
local_in_edges_tensor generation:  0.0003380775451660156
mini_batch_src_global generation:  0.0001685619354248047
r_  generation:  0.001859903335571289
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0002307891845703125
mini_batch_src_global generation:  0.0001773834228515625
r_  generation:  0.0012793540954589844
local_output_nid generation:  9.632110595703125e-05
local_in_edges_tensor generation:  0.000263214111328125
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.001752614974975586
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0014061927795410156
----------------------check_connections_block total spend ----------------------------- 0.01018381118774414
generate_one_block  0.0034666061401367188
generate_one_block  0.0023691654205322266
generate_one_block  0.002551555633544922
generate_one_block  0.00258636474609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.00935506820678711  GigaBytes
Max Memory Allocated: 0.018057823181152344  GigaBytes

connection checking time:  0.014297723770141602
block generation total time  0.01885080337524414
average batch blocks generation time:  0.004712700843811035
block dataloader generation time/epoch 0.0520932674407959
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010639667510986328  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

torch.Size([1718, 1433])
torch.Size([941, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.011172771453857422  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008563995361328125  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

torch.Size([1332, 1433])
torch.Size([590, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008915424346923828  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010637760162353516  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

torch.Size([1659, 1433])
torch.Size([871, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.01113748550415039  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009266853332519531  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

torch.Size([1463, 1433])
torch.Size([633, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.009649276733398438  GigaBytes
Max Memory Allocated: 0.01840686798095703  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009818673133850098 |0.000525057315826416 |0.003508925437927246 |0.00011789798736572266 |0.0033533573150634766 |0.0016143321990966797 |
----------------------------------------------------------pseudo_mini_loss sum 2.149120807647705
Total (block generation + training)time/epoch 0.12893962860107422
Training time/epoch 0.07606244087219238
Training time without block to device /epoch 0.07396221160888672
Training time without total dataloading part /epoch 0.02953505516052246
load block tensor time/epoch 0.03927469253540039
block to device time/epoch 0.002100229263305664
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9943
Number of first layer input nodes during this epoch:  6172
