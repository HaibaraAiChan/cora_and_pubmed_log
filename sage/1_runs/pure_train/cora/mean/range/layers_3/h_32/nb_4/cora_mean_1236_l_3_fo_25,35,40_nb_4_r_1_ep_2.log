main start at this time 1648428164.7782922
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011873245239257812
range selection method range initialization spend 8.0108642578125e-05
time for parepare:  6.127357482910156e-05
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0012049674987792969
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  6.794929504394531e-05
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  5.1975250244140625e-05
----------------------check_connections_block total spend ----------------------------- 0.0023806095123291016
generate_one_block  0.0013248920440673828
generate_one_block  0.0011277198791503906
generate_one_block  0.0011141300201416016
generate_one_block  0.0011191368103027344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005037784576416016
gen group dst list time:  3.910064697265625e-05
time for parepare:  0.00014257431030273438
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00019216537475585938
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0003743171691894531
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00042724609375
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003509521484375
----------------------check_connections_block total spend ----------------------------- 0.0030345916748046875
generate_one_block  0.0015361309051513672
generate_one_block  0.001461029052734375
generate_one_block  0.001961231231689453
generate_one_block  0.0013508796691894531
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005497932434082031
gen group dst list time:  7.319450378417969e-05
time for parepare:  0.00016498565673828125
local_output_nid generation:  4.38690185546875e-05
local_in_edges_tensor generation:  0.00028705596923828125
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.001142740249633789
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  0.00013828277587890625
r_  generation:  0.0010960102081298828
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00019550323486328125
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0012807846069335938
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.0001800060272216797
mini_batch_src_global generation:  0.00010967254638671875
r_  generation:  0.0009472370147705078
----------------------check_connections_block total spend ----------------------------- 0.007268428802490234
generate_one_block  0.002377033233642578
generate_one_block  0.0022423267364501953
generate_one_block  0.002465963363647461
generate_one_block  0.0021805763244628906
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.010303020477294922
block generation total time  0.015575170516967773
average batch blocks generation time:  0.0038937926292419434
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.008628368377685547  GigaBytes
Max Memory Allocated: 0.008628368377685547  GigaBytes

torch.Size([1542, 1433])
torch.Size([700, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009044647216796875  GigaBytes
Max Memory Allocated: 0.009096145629882812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.008598804473876953  GigaBytes
Max Memory Allocated: 0.016793251037597656  GigaBytes

torch.Size([1470, 1433])
torch.Size([716, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.009015083312988281  GigaBytes
Max Memory Allocated: 0.016793251037597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009185314178466797  GigaBytes
Max Memory Allocated: 0.01699066162109375  GigaBytes

torch.Size([1579, 1433])
torch.Size([781, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.009647846221923828  GigaBytes
Max Memory Allocated: 0.01699066162109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008145332336425781  GigaBytes
Max Memory Allocated: 0.01699066162109375  GigaBytes

torch.Size([1386, 1433])
torch.Size([607, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.008512020111083984  GigaBytes
Max Memory Allocated: 0.01699066162109375  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00860816240310669 |0.0854266881942749 |0.19339513778686523 |0.0001696944236755371 |0.0031167268753051758 |0.002513408660888672 |
----------------------------------------------------------pseudo_mini_loss sum 3.4037630558013916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9510
Number of first layer input nodes during this epoch:  5977
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008931636810302734  GigaBytes
Max Memory Allocated: 0.01699066162109375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005943775177001953
range selection method range initialization spend 8.678436279296875e-05
time for parepare:  8.988380432128906e-05
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00013446807861328125
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  7.772445678710938e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014281272888183594
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  8.153915405273438e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00013256072998046875
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  6.651878356933594e-05
----------------------check_connections_block total spend ----------------------------- 0.0015745162963867188
generate_one_block  0.001508474349975586
generate_one_block  0.0014355182647705078
generate_one_block  0.0014481544494628906
generate_one_block  0.0014081001281738281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006024837493896484
gen group dst list time:  5.316734313964844e-05
time for parepare:  0.00021457672119140625
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0006189346313476562
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.00039124488830566406
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005450248718261719
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.00043654441833496094
----------------------check_connections_block total spend ----------------------------- 0.003909111022949219
generate_one_block  0.0021736621856689453
generate_one_block  0.0017590522766113281
generate_one_block  0.0019528865814208984
generate_one_block  0.001813650131225586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007100105285644531
gen group dst list time:  0.00010776519775390625
time for parepare:  0.00023484230041503906
local_output_nid generation:  7.62939453125e-05
local_in_edges_tensor generation:  0.0003304481506347656
mini_batch_src_global generation:  0.00016570091247558594
r_  generation:  0.0017368793487548828
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  0.00019693374633789062
r_  generation:  0.0011782646179199219
local_output_nid generation:  8.225440979003906e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.0001659393310546875
r_  generation:  0.0016205310821533203
local_output_nid generation:  6.437301635742188e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.0001556873321533203
r_  generation:  0.0013194084167480469
----------------------check_connections_block total spend ----------------------------- 0.00959014892578125
generate_one_block  0.003376007080078125
generate_one_block  0.002582073211669922
generate_one_block  0.0025131702423095703
generate_one_block  0.002443075180053711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.008931636810302734  GigaBytes
Max Memory Allocated: 0.01699066162109375  GigaBytes

connection checking time:  0.013499259948730469
block generation total time  0.018613576889038086
average batch blocks generation time:  0.0046533942222595215
block dataloader generation time/epoch 0.050718069076538086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.010273933410644531  GigaBytes
Max Memory Allocated: 0.017627716064453125  GigaBytes

torch.Size([1650, 1433])
torch.Size([860, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010770797729492188  GigaBytes
Max Memory Allocated: 0.017627716064453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008197784423828125  GigaBytes
Max Memory Allocated: 0.017627716064453125  GigaBytes

torch.Size([1264, 1433])
torch.Size([537, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.008526325225830078  GigaBytes
Max Memory Allocated: 0.017627716064453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.010271072387695312  GigaBytes
Max Memory Allocated: 0.017627716064453125  GigaBytes

torch.Size([1557, 1433])
torch.Size([772, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.01072835922241211  GigaBytes
Max Memory Allocated: 0.017627716064453125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.009002685546875  GigaBytes
Max Memory Allocated: 0.017778396606445312  GigaBytes

torch.Size([1414, 1433])
torch.Size([585, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.009363651275634766  GigaBytes
Max Memory Allocated: 0.017778396606445312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0034891366958618164 |0.0007085800170898438 |0.004410743713378906 |0.00013077259063720703 |0.003322422504425049 |0.0016224384307861328 |
----------------------------------------------------------pseudo_mini_loss sum 2.1344192028045654
Total (block generation + training)time/epoch 0.10709381103515625
Training time/epoch 0.05583024024963379
Training time without block to device /epoch 0.052995920181274414
Training time without total dataloading part /epoch 0.03307819366455078
load block tensor time/epoch 0.013956546783447266
block to device time/epoch 0.002834320068359375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9375
Number of first layer input nodes during this epoch:  5885
