main start at this time 1648428257.8114724
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011777877807617188
range selection method range initialization spend 0.00011038780212402344
time for parepare:  6.604194641113281e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0021114349365234375
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.9087066650390625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.8133392333984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  1.7642974853515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.288818359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.147125244140625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.6226043701171875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.765655517578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  1.6689300537109375e-05
----------------------check_connections_block total spend ----------------------------- 0.0052492618560791016
generate_one_block  0.0013630390167236328
generate_one_block  0.0011377334594726562
generate_one_block  0.0011818408966064453
generate_one_block  0.0011241436004638672
generate_one_block  0.0011284351348876953
generate_one_block  0.0011272430419921875
generate_one_block  0.0011069774627685547
generate_one_block  0.0011143684387207031
generate_one_block  0.0011157989501953125
generate_one_block  0.0011317729949951172
generate_one_block  0.0011761188507080078
generate_one_block  0.001117706298828125
generate_one_block  0.0011334419250488281
generate_one_block  0.0010237693786621094
generate_one_block  0.0010111331939697266
generate_one_block  0.0009961128234863281
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005750656127929688
gen group dst list time:  9.512901306152344e-05
time for parepare:  0.00014662742614746094
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00012445449829101562
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.0001595020294189453
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00013566017150878906
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011134147644042969
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00018835067749023438
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  0.0001308917999267578
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00021409988403320312
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00020503997802734375
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0001304149627685547
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00012111663818359375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011897087097167969
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00012636184692382812
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  8.463859558105469e-05
----------------------check_connections_block total spend ----------------------------- 0.005949735641479492
generate_one_block  0.0012941360473632812
generate_one_block  0.0012912750244140625
generate_one_block  0.0012471675872802734
generate_one_block  0.0012958049774169922
generate_one_block  0.0013005733489990234
generate_one_block  0.0014834403991699219
generate_one_block  0.0011706352233886719
generate_one_block  0.0011439323425292969
generate_one_block  0.0011785030364990234
generate_one_block  0.0011603832244873047
generate_one_block  0.0011708736419677734
generate_one_block  0.0010704994201660156
generate_one_block  0.0010678768157958984
generate_one_block  0.0010514259338378906
generate_one_block  0.0010671615600585938
generate_one_block  0.0010180473327636719
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006437301635742188
gen group dst list time:  0.00016880035400390625
time for parepare:  0.0002281665802001953
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0004405975341796875
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0005130767822265625
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.0004718303680419922
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006270408630371094
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015974044799804688
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0006299018859863281
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0002741813659667969
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006997585296630859
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  6.365776062011719e-05
r_  generation:  0.0004277229309082031
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  5.9604644775390625e-05
r_  generation:  0.0005130767822265625
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00015687942504882812
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0006844997406005859
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0007536411285400391
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  6.937980651855469e-05
r_  generation:  0.00047707557678222656
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004253387451171875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0003762245178222656
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.245208740234375e-05
r_  generation:  0.0004062652587890625
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0003223419189453125
----------------------check_connections_block total spend ----------------------------- 0.014751434326171875
generate_one_block  0.0015382766723632812
generate_one_block  0.0016160011291503906
generate_one_block  0.0015769004821777344
generate_one_block  0.0016396045684814453
generate_one_block  0.0016126632690429688
generate_one_block  0.0016977787017822266
generate_one_block  0.0016257762908935547
generate_one_block  0.0013284683227539062
generate_one_block  0.0014832019805908203
generate_one_block  0.001649618148803711
generate_one_block  0.0017800331115722656
generate_one_block  0.0014355182647705078
generate_one_block  0.0013821125030517578
generate_one_block  0.0013382434844970703
generate_one_block  0.0013511180877685547
generate_one_block  0.001317739486694336
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

connection checking time:  0.020701169967651367
block generation total time  0.04338479042053223
average batch blocks generation time:  0.002711549401283264
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0038619041442871094  GigaBytes
Max Memory Allocated: 0.0038619041442871094  GigaBytes

torch.Size([654, 1433])
torch.Size([204, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003981590270996094  GigaBytes
Max Memory Allocated: 0.004024505615234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004278659820556641  GigaBytes
Max Memory Allocated: 0.007754325866699219  GigaBytes

torch.Size([665, 1433])
torch.Size([256, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004427433013916016  GigaBytes
Max Memory Allocated: 0.007754325866699219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004640102386474609  GigaBytes
Max Memory Allocated: 0.008176326751708984  GigaBytes

torch.Size([733, 1433])
torch.Size([232, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004779338836669922  GigaBytes
Max Memory Allocated: 0.008176326751708984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005888462066650391  GigaBytes
Max Memory Allocated: 0.009783267974853516  GigaBytes

torch.Size([966, 1433])
torch.Size([345, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006078243255615234  GigaBytes
Max Memory Allocated: 0.009783267974853516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005733966827392578  GigaBytes
Max Memory Allocated: 0.010872364044189453  GigaBytes

torch.Size([937, 1433])
torch.Size([351, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005923271179199219  GigaBytes
Max Memory Allocated: 0.010872364044189453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005906581878662109  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

torch.Size([969, 1433])
torch.Size([371, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006109714508056641  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0036940574645996094  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

torch.Size([556, 1433])
torch.Size([213, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0038199424743652344  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003787517547607422  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

torch.Size([574, 1433])
torch.Size([199, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003898143768310547  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004678249359130859  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

torch.Size([740, 1433])
torch.Size([276, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004832267761230469  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005431175231933594  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

torch.Size([880, 1433])
torch.Size([342, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.005633354187011719  GigaBytes
Max Memory Allocated: 0.01088857650756836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.006463527679443359  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([1073, 1433])
torch.Size([390, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0066814422607421875  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004511833190917969  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([709, 1433])
torch.Size([256, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004650592803955078  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004019737243652344  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([617, 1433])
torch.Size([229, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004149913787841797  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003863811492919922  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([588, 1433])
torch.Size([176, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.003977298736572266  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004050731658935547  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([623, 1433])
torch.Size([195, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.004172325134277344  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.00366973876953125  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([552, 1433])
torch.Size([171, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2615966796875 GB
    Memory Allocated: 0.0037636756896972656  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0071636587381362915 |0.022065863013267517 |0.05084650218486786 |0.00011940300464630127 |0.003030240535736084 |0.0024368762969970703 |
----------------------------------------------------------pseudo_mini_loss sum 3.669556140899658
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16810
Number of first layer input nodes during this epoch:  11836
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004403591156005859  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004932880401611328
range selection method range initialization spend 6.67572021484375e-05
time for parepare:  6.532669067382812e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  2.8371810913085938e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.202957153320312e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9073486328125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.059906005859375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.7179718017578125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.361701965332031e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.298324584960938e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5974044799804688e-05
----------------------check_connections_block total spend ----------------------------- 0.0030219554901123047
generate_one_block  0.0010347366333007812
generate_one_block  0.0009887218475341797
generate_one_block  0.0009975433349609375
generate_one_block  0.0009951591491699219
generate_one_block  0.0009815692901611328
generate_one_block  0.0009801387786865234
generate_one_block  0.0011615753173828125
generate_one_block  0.0009784698486328125
generate_one_block  0.0009965896606445312
generate_one_block  0.0009801387786865234
generate_one_block  0.00096893310546875
generate_one_block  0.0009438991546630859
generate_one_block  0.0009877681732177734
generate_one_block  0.0009534358978271484
generate_one_block  0.0009903907775878906
generate_one_block  0.0009706020355224609
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006256103515625
gen group dst list time:  9.608268737792969e-05
time for parepare:  0.0001926422119140625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00019359588623046875
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00018286705017089844
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00014495849609375
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.0002040863037109375
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00015306472778320312
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001201629638671875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.107589721679688e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010275840759277344
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.000102996826171875
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.0001747608184814453
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.00015783309936523438
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00011205673217773438
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00011801719665527344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00014472007751464844
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  0.00010657310485839844
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  7.2479248046875e-05
----------------------check_connections_block total spend ----------------------------- 0.005756378173828125
generate_one_block  0.001251220703125
generate_one_block  0.0011413097381591797
generate_one_block  0.0013175010681152344
generate_one_block  0.0011878013610839844
generate_one_block  0.001104593276977539
generate_one_block  0.0010924339294433594
generate_one_block  0.0011227130889892578
generate_one_block  0.00109100341796875
generate_one_block  0.0011463165283203125
generate_one_block  0.0011875629425048828
generate_one_block  0.0011394023895263672
generate_one_block  0.0010581016540527344
generate_one_block  0.0011181831359863281
generate_one_block  0.0011315345764160156
generate_one_block  0.0010476112365722656
generate_one_block  0.001094818115234375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006749629974365234
gen group dst list time:  0.00018906593322753906
time for parepare:  0.00022172927856445312
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  7.867813110351562e-05
r_  generation:  0.0005698204040527344
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0004911422729492188
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  7.200241088867188e-05
r_  generation:  0.0005924701690673828
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  7.319450378417969e-05
r_  generation:  0.0005588531494140625
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0003871917724609375
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.000392913818359375
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0003955364227294922
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005841255187988281
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0005578994750976562
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0005576610565185547
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00013709068298339844
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00042939186096191406
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0003750324249267578
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014328956604003906
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.0005636215209960938
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0003769397735595703
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0002334117889404297
----------------------check_connections_block total spend ----------------------------- 0.013489723205566406
generate_one_block  0.001680612564086914
generate_one_block  0.0015587806701660156
generate_one_block  0.0018601417541503906
generate_one_block  0.0015857219696044922
generate_one_block  0.0013668537139892578
generate_one_block  0.0012221336364746094
generate_one_block  0.0013916492462158203
generate_one_block  0.0013895034790039062
generate_one_block  0.0015947818756103516
generate_one_block  0.0015971660614013672
generate_one_block  0.0015590190887451172
generate_one_block  0.0015251636505126953
generate_one_block  0.0013647079467773438
generate_one_block  0.0015819072723388672
generate_one_block  0.0013649463653564453
generate_one_block  0.0012104511260986328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004403591156005859  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

connection checking time:  0.01924610137939453
block generation total time  0.04208564758300781
average batch blocks generation time:  0.0026303529739379883
block dataloader generation time/epoch 0.09436464309692383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005718708038330078  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([802, 1433])
torch.Size([364, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005911827087402344  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00510406494140625  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([687, 1433])
torch.Size([267, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005258083343505859  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005887031555175781  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([833, 1433])
torch.Size([322, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0060749053955078125  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006125450134277344  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([878, 1433])
torch.Size([327, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006304740905761719  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0042247772216796875  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([523, 1433])
torch.Size([204, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004344940185546875  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003531932830810547  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([394, 1433])
torch.Size([137, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003623485565185547  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005250453948974609  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([715, 1433])
torch.Size([200, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005372047424316406  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005014896392822266  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([671, 1433])
torch.Size([221, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0051364898681640625  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006178855895996094  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([888, 1433])
torch.Size([342, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006368160247802734  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006333827972412109  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([917, 1433])
torch.Size([363, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006518840789794922  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006041049957275391  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([862, 1433])Using backend: pytorch

torch.Size([303, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006229877471923828  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004904270172119141  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([650, 1433])
torch.Size([225, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005033969879150391  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004320621490478516  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([541, 1433])
torch.Size([193, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0044422149658203125  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006023883819580078  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([859, 1433])
torch.Size([313, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.006196022033691406  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.004929065704345703  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([655, 1433])
torch.Size([191, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005044460296630859  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.003468036651611328  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

torch.Size([382, 1433])
torch.Size([124, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0035424232482910156  GigaBytes
Max Memory Allocated: 0.011138916015625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0012325793504714966 |0.0004601478576660156 |0.0036192089319229126 |0.0001185685396194458 |0.0030662864446640015 |0.0016338825225830078 |
----------------------------------------------------------pseudo_mini_loss sum 2.7190091609954834
Total (block generation + training)time/epoch 0.24939894676208496
Training time/epoch 0.15472102165222168
Training time without block to device /epoch 0.14735865592956543
Training time without total dataloading part /epoch 0.11049890518188477
load block tensor time/epoch 0.019721269607543945
block to device time/epoch 0.00736236572265625
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16120
Number of first layer input nodes during this epoch:  11257
