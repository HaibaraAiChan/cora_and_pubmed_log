main start at this time 1648428593.3238087
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000751495361328125
range selection method range initialization spend 0.00010323524475097656
time for parepare:  5.91278076171875e-05
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  0.0022516250610351562
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.1552734375e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.0265579223632812e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.96453857421875e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.893013000488281e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  8.988380432128906e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  8.916854858398438e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.528594970703125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.845329284667969e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  8.7738037109375e-05
mini_batch_src_global generation:  1.33514404296875e-05
r_  generation:  1.8596649169921875e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  8.654594421386719e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  2.002716064453125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.47955322265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.322166442871094e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.2411346435546875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.107589721679688e-05
mini_batch_src_global generation:  1.3828277587890625e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.005179882049560547
generate_one_block  0.0012254714965820312
generate_one_block  0.0009961128234863281
generate_one_block  0.0010089874267578125
generate_one_block  0.0009946823120117188
generate_one_block  0.0010063648223876953
generate_one_block  0.0009634494781494141
generate_one_block  0.0009601116180419922
generate_one_block  0.0010044574737548828
generate_one_block  0.001016378402709961
generate_one_block  0.0009615421295166016
generate_one_block  0.0009961128234863281
generate_one_block  0.0010232925415039062
generate_one_block  0.0009932518005371094
generate_one_block  0.0009682178497314453
generate_one_block  0.0009741783142089844
generate_one_block  0.0009582042694091797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005946159362792969
gen group dst list time:  8.463859558105469e-05
time for parepare:  0.0001430511474609375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.00012135505676269531
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.000152587890625
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010156631469726562
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  9.512901306152344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010085105895996094
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  0.00010037422180175781
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  9.894371032714844e-05
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00011277198791503906
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  0.0001289844512939453
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0002224445343017578
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010037422180175781
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  7.963180541992188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  9.965896606445312e-05
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.000102996826171875
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00014257431030273438
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00013065338134765625
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  5.507469177246094e-05
----------------------check_connections_block total spend ----------------------------- 0.005398988723754883
generate_one_block  0.001210927963256836
generate_one_block  0.001173257827758789
generate_one_block  0.001102447509765625
generate_one_block  0.0011341571807861328
generate_one_block  0.0011146068572998047
generate_one_block  0.0010678768157958984
generate_one_block  0.0011272430419921875
generate_one_block  0.0011830329895019531
generate_one_block  0.0012326240539550781
generate_one_block  0.0011394023895263672
generate_one_block  0.001039266586303711
generate_one_block  0.0010800361633300781
generate_one_block  0.0011129379272460938
generate_one_block  0.0011200904846191406
generate_one_block  0.001111745834350586
generate_one_block  0.0010058879852294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007109642028808594
gen group dst list time:  0.00015878677368164062
time for parepare:  0.00021791458129882812
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0004642009735107422
local_output_nid generation:  2.956390380859375e-05
local_in_edges_tensor generation:  0.00015878677368164062
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0006620883941650391
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013113021850585938
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.0003185272216796875
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00013208389282226562
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00042748451232910156
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  6.103515625e-05
r_  generation:  0.0005223751068115234
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0007293224334716797
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006964206695556641
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00015020370483398438
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0005476474761962891
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0003085136413574219
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0004165172576904297
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.8650970458984375e-05
r_  generation:  0.00048041343688964844
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0005059242248535156
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.0004832744598388672
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00017333030700683594
----------------------check_connections_block total spend ----------------------------- 0.013896465301513672
generate_one_block  0.001497507095336914
generate_one_block  0.0018262863159179688
generate_one_block  0.001321554183959961
generate_one_block  0.0014595985412597656
generate_one_block  0.0014331340789794922
generate_one_block  0.0014345645904541016
generate_one_block  0.0018377304077148438
generate_one_block  0.0021791458129882812
generate_one_block  0.0017323493957519531
generate_one_block  0.0015904903411865234
generate_one_block  0.0013408660888671875
generate_one_block  0.0014231204986572266
generate_one_block  0.001504659652709961
generate_one_block  0.0015077590942382812
generate_one_block  0.0014920234680175781
generate_one_block  0.0011587142944335938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.019295454025268555
block generation total time  0.042695045471191406
average batch blocks generation time:  0.002668440341949463
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005407810211181641  GigaBytes
Max Memory Allocated: 0.005407810211181641  GigaBytes

torch.Size([729, 1433])
torch.Size([245, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0059070587158203125  GigaBytes
Max Memory Allocated: 0.006119251251220703  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008600234985351562  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

torch.Size([1045, 1433])
torch.Size([402, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009328842163085938  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005871295928955078  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

torch.Size([536, 1433])
torch.Size([174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0062351226806640625  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007151126861572266  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

torch.Size([775, 1433])
torch.Size([224, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007597923278808594  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006585121154785156  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

torch.Size([669, 1433])
torch.Size([221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007045745849609375  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0065212249755859375  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

torch.Size([657, 1433])
torch.Size([216, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006961822509765625  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007896900177001953  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

torch.Size([914, 1433])
torch.Size([298, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00849771499633789  GigaBytes
Max Memory Allocated: 0.012470722198486328  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009014129638671875  GigaBytes
Max Memory Allocated: 0.013869285583496094  GigaBytes

torch.Size([1122, 1433])
torch.Size([430, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009821414947509766  GigaBytes
Max Memory Allocated: 0.013869285583496094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008339405059814453  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([996, 1433])
torch.Size([345, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009095191955566406  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007251739501953125  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([793, 1433])
torch.Size([295, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007834911346435547  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006111621856689453  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([581, 1433])
torch.Size([160, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0064411163330078125  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0067348480224609375  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([697, 1433])
torch.Size([238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0072078704833984375  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0074901580810546875  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([838, 1433])
torch.Size([250, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008047103881835938  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0070514678955078125  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([756, 1433])
torch.Size([275, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0076045989990234375  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006817817687988281  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([712, 1433])
torch.Size([252, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007325172424316406  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004479408264160156  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([276, 1433])
torch.Size([104, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004689216613769531  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033118724822998047 |0.02194298803806305 |0.051286980509757996 |0.00014325976371765137 |0.0027685165405273438 |0.0026693344116210938 |
----------------------------------------------------------pseudo_mini_loss sum 3.0953822135925293
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16989
Number of first layer input nodes during this epoch:  12096
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007490634918212891  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000949859619140625
range selection method range initialization spend 6.699562072753906e-05
time for parepare:  6.365776062011719e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.5987625122070312e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.0994415283203125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.560585021972656e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.9325485229492188e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.274482727050781e-05
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  2.5033950805664062e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.1219253540039062e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.4318695068359375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.3589859008789062e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  3.4332275390625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.584426879882812e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.0030395984649658203
generate_one_block  0.0011775493621826172
generate_one_block  0.0010936260223388672
generate_one_block  0.0010995864868164062
generate_one_block  0.0010917186737060547
generate_one_block  0.0010883808135986328
generate_one_block  0.0010821819305419922
generate_one_block  0.0012671947479248047
generate_one_block  0.0010752677917480469
generate_one_block  0.0010831356048583984
generate_one_block  0.0010280609130859375
generate_one_block  0.00102996826171875
generate_one_block  0.0010509490966796875
generate_one_block  0.0010182857513427734
generate_one_block  0.0010552406311035156
generate_one_block  0.0010402202606201172
generate_one_block  0.0010097026824951172
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005960464477539062
gen group dst list time:  8.940696716308594e-05
time for parepare:  0.00014019012451171875
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.000148773193359375
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  0.00016641616821289062
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00019741058349609375
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001087188720703125
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.000141143798828125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00010275840759277344
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00011515617370605469
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.0001087188720703125
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.059906005859375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  8.320808410644531e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011920928955078125
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00017118453979492188
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00021338462829589844
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.982948303222656e-05
----------------------check_connections_block total spend ----------------------------- 0.005563974380493164
generate_one_block  0.0012638568878173828
generate_one_block  0.0012745857238769531
generate_one_block  0.0013718605041503906
generate_one_block  0.001230478286743164
generate_one_block  0.0012516975402832031
generate_one_block  0.0011811256408691406
generate_one_block  0.0011937618255615234
generate_one_block  0.0011990070343017578
generate_one_block  0.0011429786682128906
generate_one_block  0.0011072158813476562
generate_one_block  0.0012230873107910156
generate_one_block  0.0012974739074707031
generate_one_block  0.001131296157836914
generate_one_block  0.0012502670288085938
generate_one_block  0.0012645721435546875
generate_one_block  0.0011048316955566406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006775856018066406
gen group dst list time:  0.00017333030700683594
time for parepare:  0.0002219676971435547
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0006089210510253906
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015592575073242188
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0005609989166259766
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001590251922607422
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.00066375732421875
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005071163177490234
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.0005307197570800781
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00013685226440429688
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003674030303955078
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0004260540008544922
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.0003705024719238281
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00029277801513671875
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002818107604980469
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  5.698204040527344e-05
r_  generation:  0.000514984130859375
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  7.367134094238281e-05
r_  generation:  0.0006501674652099609
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004215240478515625
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  0.0006365776062011719
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0007634162902832031
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.00023698806762695312
----------------------check_connections_block total spend ----------------------------- 0.01416778564453125
generate_one_block  0.0017774105072021484
generate_one_block  0.0016100406646728516
generate_one_block  0.001735687255859375
generate_one_block  0.0014939308166503906
generate_one_block  0.0015456676483154297
generate_one_block  0.0013890266418457031
generate_one_block  0.00141143798828125
generate_one_block  0.0013687610626220703
generate_one_block  0.0012736320495605469
generate_one_block  0.0012450218200683594
generate_one_block  0.0015337467193603516
generate_one_block  0.0018172264099121094
generate_one_block  0.0014090538024902344
generate_one_block  0.0016598701477050781
generate_one_block  0.0018224716186523438
generate_one_block  0.0011761188507080078
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007490634918212891  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

connection checking time:  0.019731760025024414
block generation total time  0.04375720024108887
average batch blocks generation time:  0.002734825015068054
block dataloader generation time/epoch 0.0990610122680664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011041641235351562  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

torch.Size([942, 1433])
torch.Size([327, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011669158935546875  GigaBytes
Max Memory Allocated: 0.014307022094726562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00974893569946289  GigaBytes
Max Memory Allocated: 0.014760017395019531  GigaBytes

torch.Size([700, 1433])
torch.Size([322, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01036691665649414  GigaBytes
Max Memory Allocated: 0.014760017395019531  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011210441589355469  GigaBytes
Max Memory Allocated: 0.014925956726074219  GigaBytes

torch.Size([973, 1433])
torch.Size([377, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01195383071899414  GigaBytes
Max Memory Allocated: 0.014925956726074219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009772777557373047  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([705, 1433])
torch.Size([239, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010276317596435547  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011205673217773438  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([837, 1433])
torch.Size([299, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011793136596679688  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009289741516113281  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([615, 1433])
torch.Size([202, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009694576263427734  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009494304656982422  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([653, 1433])
torch.Size([198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009921550750732422  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009134769439697266  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([586, 1433])
torch.Size([199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009539127349853516  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00948953628540039  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([506, 1433])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009798526763916016  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008325576782226562  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

torch.Size([435, 1433])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008649826049804688  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010665416717529297  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes
Using backend: pytorch

torch.Size([872, 1433])
torch.Size([276, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011195659637451172  GigaBytes
Max Memory Allocated: 0.014952659606933594  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011823177337646484  GigaBytes
Max Memory Allocated: 0.01645803451538086  GigaBytes

torch.Size([909, 1433])
torch.Size([351, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012498855590820312  GigaBytes
Max Memory Allocated: 0.01645803451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009259223937988281  GigaBytes
Max Memory Allocated: 0.01645803451538086  GigaBytes

torch.Size([609, 1433])
torch.Size([208, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009666919708251953  GigaBytes
Max Memory Allocated: 0.01645803451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011823177337646484  GigaBytes
Max Memory Allocated: 0.01645803451538086  GigaBytes

torch.Size([952, 1433])
torch.Size([348, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012571334838867188  GigaBytes
Max Memory Allocated: 0.01645803451538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012131214141845703  GigaBytes
Max Memory Allocated: 0.01791524887084961  GigaBytes

torch.Size([1145, 1433])
torch.Size([403, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01294708251953125  GigaBytes
Max Memory Allocated: 0.01791524887084961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007729530334472656  GigaBytes
Max Memory Allocated: 0.01791524887084961  GigaBytes

torch.Size([324, 1433])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007887840270996094  GigaBytes
Max Memory Allocated: 0.01791524887084961  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001250728964805603 |0.00039853155612945557 |0.0031819194555282593 |0.00010520219802856445 |0.0031057000160217285 |0.0013701915740966797 |
----------------------------------------------------------pseudo_mini_loss sum 1.620571255683899
Total (block generation + training)time/epoch 0.24403047561645508
Training time/epoch 0.1446211338043213
Training time without block to device /epoch 0.13824462890625
Training time without total dataloading part /epoch 0.10365533828735352
load block tensor time/epoch 0.02001166343688965
block to device time/epoch 0.006376504898071289
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16638
Number of first layer input nodes during this epoch:  11763
