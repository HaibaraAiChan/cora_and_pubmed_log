main start at this time 1648428537.2766821
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011019706726074219
range selection method range initialization spend 0.00010967254638671875
time for parepare:  6.699562072753906e-05
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  0.002322673797607422
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  7.176399230957031e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00011205673217773438
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  7.414817810058594e-05
----------------------check_connections_block total spend ----------------------------- 0.0036249160766601562
generate_one_block  0.0014004707336425781
generate_one_block  0.0011744499206542969
generate_one_block  0.0011665821075439453
generate_one_block  0.0011649131774902344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005185604095458984
gen group dst list time:  4.3392181396484375e-05
time for parepare:  0.00015234947204589844
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.00040912628173828125
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.00043082237243652344
local_output_nid generation:  1.9073486328125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0005123615264892578
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00022935867309570312
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00046896934509277344
----------------------check_connections_block total spend ----------------------------- 0.0035097599029541016
generate_one_block  0.0015935897827148438
generate_one_block  0.0015914440155029297
generate_one_block  0.0016853809356689453
generate_one_block  0.0016410350799560547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006148815155029297
gen group dst list time:  8.082389831542969e-05
time for parepare:  0.0001811981201171875
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00028204917907714844
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0012664794921875
local_output_nid generation:  5.412101745605469e-05
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  0.00015234947204589844
r_  generation:  0.0012409687042236328
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00022220611572265625
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0014235973358154297
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0013577938079833984
----------------------check_connections_block total spend ----------------------------- 0.008543968200683594
generate_one_block  0.0026395320892333984
generate_one_block  0.002559185028076172
generate_one_block  0.002637147903442383
generate_one_block  0.0025911331176757812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.012053728103637695
block generation total time  0.016938447952270508
average batch blocks generation time:  0.004234611988067627
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009984970092773438  GigaBytes
Max Memory Allocated: 0.009984970092773438  GigaBytes

torch.Size([1582, 1433])
torch.Size([770, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.011541366577148438  GigaBytes
Max Memory Allocated: 0.011876106262207031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011212348937988281  GigaBytes
Max Memory Allocated: 0.019618988037109375  GigaBytes

torch.Size([1531, 1433])
torch.Size([706, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012728214263916016  GigaBytes
Max Memory Allocated: 0.019618988037109375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011683464050292969  GigaBytes
Max Memory Allocated: 0.019811630249023438  GigaBytes

torch.Size([1618, 1433])
torch.Size([835, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013457298278808594  GigaBytes
Max Memory Allocated: 0.019811630249023438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011541366577148438  GigaBytes
Max Memory Allocated: 0.02013683319091797  GigaBytes

torch.Size([1592, 1433])
torch.Size([783, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.013205528259277344  GigaBytes
Max Memory Allocated: 0.02013683319091797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013214468955993652 |0.08460104465484619 |0.19324153661727905 |0.0001717209815979004 |0.003616034984588623 |0.0028564929962158203 |
----------------------------------------------------------pseudo_mini_loss sum 3.404179573059082
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10156
Number of first layer input nodes during this epoch:  6323
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014636516571044922  GigaBytes
Max Memory Allocated: 0.02013683319091797  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005388259887695312
range selection method range initialization spend 7.700920104980469e-05
time for parepare:  7.700920104980469e-05
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0002079010009765625
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  8.749961853027344e-05
local_output_nid generation:  1.2159347534179688e-05Using backend: pytorch

local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  8.463859558105469e-05
----------------------check_connections_block total spend ----------------------------- 0.001493215560913086
generate_one_block  0.0013544559478759766
generate_one_block  0.001285552978515625
generate_one_block  0.0012784004211425781
generate_one_block  0.0013146400451660156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005824565887451172
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00019812583923339844
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0005853176116943359
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  7.390975952148438e-05
r_  generation:  0.000423431396484375
local_output_nid generation:  1.7881393432617188e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004057884216308594
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  7.295608520507812e-05
r_  generation:  0.0006260871887207031
----------------------check_connections_block total spend ----------------------------- 0.003937244415283203
generate_one_block  0.0020132064819335938
generate_one_block  0.0016961097717285156
generate_one_block  0.0016934871673583984
generate_one_block  0.0019345283508300781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006809234619140625
gen group dst list time:  0.00010895729064941406
time for parepare:  0.000244140625
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0003631114959716797
mini_batch_src_global generation:  0.00015735626220703125
r_  generation:  0.0016646385192871094
local_output_nid generation:  6.604194641113281e-05
local_in_edges_tensor generation:  0.00024271011352539062
mini_batch_src_global generation:  0.00016427040100097656
r_  generation:  0.0013549327850341797
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00023937225341796875
mini_batch_src_global generation:  0.0001468658447265625
r_  generation:  0.001863241195678711
local_output_nid generation:  9.083747863769531e-05
local_in_edges_tensor generation:  0.00027680397033691406
mini_batch_src_global generation:  0.000171661376953125
r_  generation:  0.0017216205596923828
----------------------check_connections_block total spend ----------------------------- 0.010594606399536133
generate_one_block  0.003158092498779297
generate_one_block  0.0022726058959960938
generate_one_block  0.0021905899047851562
generate_one_block  0.0030295848846435547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014636516571044922  GigaBytes
Max Memory Allocated: 0.02013683319091797  GigaBytes

connection checking time:  0.014531850814819336
block generation total time  0.017988204956054688
average batch blocks generation time:  0.004497051239013672
block dataloader generation time/epoch 0.049532175064086914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014755725860595703  GigaBytes
Max Memory Allocated: 0.02321004867553711  GigaBytes

torch.Size([1633, 1433])
torch.Size([851, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016527175903320312  GigaBytes
Max Memory Allocated: 0.02321004867553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.013985157012939453  GigaBytes
Max Memory Allocated: 0.02321004867553711  GigaBytes

torch.Size([1490, 1433])
torch.Size([656, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015379905700683594  GigaBytes
Max Memory Allocated: 0.02321004867553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01474618911743164  GigaBytes
Max Memory Allocated: 0.02321004867553711  GigaBytes

torch.Size([1474, 1433])
torch.Size([670, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016136646270751953  GigaBytes
Max Memory Allocated: 0.02321004867553711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.014998912811279297  GigaBytes
Max Memory Allocated: 0.023670196533203125  GigaBytes

torch.Size([1678, 1433])
torch.Size([878, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.016883373260498047  GigaBytes
Max Memory Allocated: 0.023670196533203125  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.002528369426727295 |0.00042498111724853516 |0.0032265186309814453 |0.00010788440704345703 |0.0034946799278259277 |0.0013530254364013672 |
----------------------------------------------------------pseudo_mini_loss sum 1.6153175830841064
Total (block generation + training)time/epoch 0.09437036514282227
Training time/epoch 0.044472694396972656
Training time without block to device /epoch 0.042772769927978516
Training time without total dataloading part /epoch 0.028669357299804688
load block tensor time/epoch 0.01011347770690918
block to device time/epoch 0.0016999244689941406
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10068
Number of first layer input nodes during this epoch:  6275
