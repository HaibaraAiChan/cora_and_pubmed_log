main start at this time 1648428499.9830925
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001112222671508789
range selection method range initialization spend 8.416175842285156e-05
time for parepare:  6.890296936035156e-05
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.00019812583923339844
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.0017018318176269531
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  7.224082946777344e-05
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  7.939338684082031e-05
----------------------check_connections_block total spend ----------------------------- 0.002995014190673828
generate_one_block  0.0017826557159423828
generate_one_block  0.0011529922485351562
generate_one_block  0.0011508464813232422
generate_one_block  0.0011289119720458984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005276203155517578
gen group dst list time:  4.553794860839844e-05
time for parepare:  0.00015282630920410156
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00018930435180664062
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00036334991455078125
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  0.0004024505615234375
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.00048351287841796875
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00023174285888671875
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.00045228004455566406
----------------------check_connections_block total spend ----------------------------- 0.0033559799194335938
generate_one_block  0.0014948844909667969
generate_one_block  0.0014984607696533203
generate_one_block  0.0016162395477294922
generate_one_block  0.0015468597412109375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005993843078613281
gen group dst list time:  8.130073547363281e-05
time for parepare:  0.00019598007202148438
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00026607513427734375
mini_batch_src_global generation:  0.00010132789611816406
r_  generation:  0.0011200904846191406
local_output_nid generation:  5.0067901611328125e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.00015497207641601562
r_  generation:  0.0011327266693115234
local_output_nid generation:  6.008148193359375e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  0.00015020370483398438
r_  generation:  0.0013270378112792969
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00020623207092285156
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0012772083282470703
----------------------check_connections_block total spend ----------------------------- 0.007950782775878906
generate_one_block  0.00238800048828125
generate_one_block  0.0023698806762695312
generate_one_block  0.0031638145446777344
generate_one_block  0.0023877620697021484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.0113067626953125
block generation total time  0.01646590232849121
average batch blocks generation time:  0.004116475582122803
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009258747100830078  GigaBytes
Max Memory Allocated: 0.009258747100830078  GigaBytes

torch.Size([1447, 1433])
torch.Size([660, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010637760162353516  GigaBytes
Max Memory Allocated: 0.010923385620117188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.010690689086914062  GigaBytes
Max Memory Allocated: 0.01838064193725586  GigaBytes

torch.Size([1434, 1433])
torch.Size([636, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012093067169189453  GigaBytes
Max Memory Allocated: 0.01838064193725586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011257648468017578  GigaBytes
Max Memory Allocated: 0.018871784210205078  GigaBytes

torch.Size([1539, 1433])
torch.Size([763, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.01291513442993164  GigaBytes
Max Memory Allocated: 0.018871784210205078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011180877685546875  GigaBytes
Max Memory Allocated: 0.01935720443725586  GigaBytes

torch.Size([1525, 1433])
torch.Size([720, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.012743473052978516  GigaBytes
Max Memory Allocated: 0.01935720443725586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01604384183883667 |0.08539164066314697 |0.19197535514831543 |0.0001512765884399414 |0.0034791231155395508 |0.0024874210357666016 |
----------------------------------------------------------pseudo_mini_loss sum 3.3832526206970215
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9463
Number of first layer input nodes during this epoch:  5945
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014268875122070312  GigaBytes
Max Memory Allocated: 0.01935720443725586  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004558563232421875
range selection method range initialization spend 6.318092346191406e-05
time for parepare:  9.250640869140625e-05
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  7.987022399902344e-05
local_output_nid generation:  1.1444091796875e-05Using backend: pytorch

local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  6.437301635742188e-05
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  7.295608520507812e-05
----------------------check_connections_block total spend ----------------------------- 0.0013420581817626953
generate_one_block  0.0011463165283203125
generate_one_block  0.0010793209075927734
generate_one_block  0.0011065006256103516
generate_one_block  0.0011115074157714844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047588348388671875
gen group dst list time:  4.00543212890625e-05
time for parepare:  0.00015020370483398438
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  6.008148193359375e-05
r_  generation:  0.00044465065002441406
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0003466606140136719
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0003294944763183594
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.0004780292510986328
----------------------check_connections_block total spend ----------------------------- 0.003168344497680664
generate_one_block  0.0016186237335205078
generate_one_block  0.0014574527740478516
generate_one_block  0.001379251480102539
generate_one_block  0.0015494823455810547
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005512237548828125
gen group dst list time:  8.630752563476562e-05
time for parepare:  0.00017762184143066406
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0002689361572265625
mini_batch_src_global generation:  0.00012135505676269531
r_  generation:  0.001222848892211914
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00019049644470214844
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.0010712146759033203
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.001016378402709961
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.0013012886047363281
----------------------check_connections_block total spend ----------------------------- 0.007521867752075195
generate_one_block  0.0024657249450683594
generate_one_block  0.002248048782348633
generate_one_block  0.002179861068725586
generate_one_block  0.0026721954345703125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014268875122070312  GigaBytes
Max Memory Allocated: 0.01935720443725586  GigaBytes

connection checking time:  0.01069021224975586
block generation total time  0.015570640563964844
average batch blocks generation time:  0.003892660140991211
block dataloader generation time/epoch 0.04070591926574707
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01425027847290039  GigaBytes
Max Memory Allocated: 0.022350788116455078  GigaBytes

torch.Size([1517, 1433])
torch.Size([755, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015868186950683594  GigaBytes
Max Memory Allocated: 0.022350788116455078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013689517974853516  GigaBytes
Max Memory Allocated: 0.022350788116455078  GigaBytes

torch.Size([1435, 1433])
torch.Size([623, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015030384063720703  GigaBytes
Max Memory Allocated: 0.022350788116455078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01424264907836914  GigaBytes
Max Memory Allocated: 0.022350788116455078  GigaBytes

torch.Size([1385, 1433])
torch.Size([613, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015542030334472656  GigaBytes
Max Memory Allocated: 0.022350788116455078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01436614990234375  GigaBytes
Max Memory Allocated: 0.02253866195678711  GigaBytes

torch.Size([1560, 1433])
torch.Size([792, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016114234924316406  GigaBytes
Max Memory Allocated: 0.02253866195678711  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0017300844192504883 |0.00039499998092651367 |0.003138720989227295 |0.00010377168655395508 |0.0027661919593811035 |0.0018723011016845703 |
----------------------------------------------------------pseudo_mini_loss sum 1.5960829257965088
Total (block generation + training)time/epoch 0.07917189598083496
Training time/epoch 0.03821563720703125
Training time without block to device /epoch 0.036635637283325195
Training time without total dataloading part /epoch 0.025907039642333984
load block tensor time/epoch 0.006920337677001953
block to device time/epoch 0.0015799999237060547
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9418
Number of first layer input nodes during this epoch:  5897
