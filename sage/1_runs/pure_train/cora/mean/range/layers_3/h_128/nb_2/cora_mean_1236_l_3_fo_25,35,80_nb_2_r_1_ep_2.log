main start at this time 1648428490.847813
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0007791519165039062
range selection method range initialization spend 9.1552734375e-05
time for parepare:  6.151199340820312e-05
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.0022554397583007812
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00013566017150878906
----------------------check_connections_block total spend ----------------------------- 0.0030629634857177734
generate_one_block  0.0013413429260253906
generate_one_block  0.0011327266693115234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00048232078552246094
gen group dst list time:  2.8133392333984375e-05
time for parepare:  0.000156402587890625
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.0006036758422851562
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0007026195526123047
----------------------check_connections_block total spend ----------------------------- 0.0024144649505615234
generate_one_block  0.0016498565673828125
generate_one_block  0.0018625259399414062
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005629062652587891
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00017070770263671875
local_output_nid generation:  6.270408630371094e-05
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0035049915313720703
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  0.00021409988403320312
r_  generation:  0.0017881393432617188
----------------------check_connections_block total spend ----------------------------- 0.0075016021728515625
generate_one_block  0.002971649169921875
generate_one_block  0.0029730796813964844
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.009916067123413086
block generation total time  0.009457111358642578
average batch blocks generation time:  0.004728555679321289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.011334419250488281  GigaBytes
Max Memory Allocated: 0.011334419250488281  GigaBytes

torch.Size([1832, 1433])
torch.Size([1004, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2576904296875 GB
    Memory Allocated: 0.013599395751953125  GigaBytes
Max Memory Allocated: 0.01374197006225586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.013320446014404297  GigaBytes
Max Memory Allocated: 0.023037433624267578  GigaBytes

torch.Size([1921, 1433])
torch.Size([1180, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2733154296875 GB
    Memory Allocated: 0.016011714935302734  GigaBytes
Max Memory Allocated: 0.023037433624267578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007864117622375488 |0.17211496829986572 |0.3823893070220947 |0.00023984909057617188 |0.005837440490722656 |0.0030341148376464844 |
----------------------------------------------------------pseudo_mini_loss sum 3.4607667922973633
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6637
Number of first layer input nodes during this epoch:  3753
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016463756561279297  GigaBytes
Max Memory Allocated: 0.023037433624267578  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001035928726196289
range selection method range initialization spend 9.34600830078125e-05
time for parepare:  9.584426879882812e-05
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.00020384788513183594
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00015616416931152344
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00015616416931152344
----------------------check_connections_block total spend ----------------------------- 0.0010766983032226562
generate_one_block  0.0015141963958740234
generate_one_block  0.00145721435546875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005917549133300781
gen group dst list time:  4.458427429199219e-05
time for parepare:  0.00021314620971679688
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.00023651123046875
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0008542537689208984
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.0001327991485595703
r_  generation:  0.0009107589721679688
----------------------check_connections_block total spend ----------------------------- 0.0032453536987304688
generate_one_block  0.0022776126861572266
generate_one_block  0.002445697784423828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006673336029052734
gen group dst list time:  7.62939453125e-05
time for parepare:  0.0002651214599609375
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0003459453582763672
mini_batch_src_global generation:  0.00022029876708984375
r_  generation:  0.002161741256713867
local_output_nid generation:  0.0001201629638671875
local_in_edges_tensor generation:  0.0002987384796142578
mini_batch_src_global generation:  0.00026798248291015625
r_  generation:  0.002242565155029297
----------------------check_connections_block total spend ----------------------------- 0.007041215896606445
generate_one_block  0.0037660598754882812
generate_one_block  0.0037124156951904297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016463756561279297  GigaBytes
Max Memory Allocated: 0.023037433624267578  GigaBytes

connection checking time:  0.010286569595336914
block generation total time  0.012201786041259766
average batch blocks generation time:  0.006100893020629883
block dataloader generation time/epoch 0.06265521049499512
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016084671020507812  GigaBytes
Max Memory Allocated: 0.02628183364868164  GigaBytes
Using backend: pytorch

torch.Size([1879, 1433])
torch.Size([1086, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.01853466033935547  GigaBytes
Max Memory Allocated: 0.02628183364868164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.016045093536376953  GigaBytes
Max Memory Allocated: 0.02628183364868164  GigaBytes

torch.Size([1871, 1433])
torch.Size([1118, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2811279296875 GB
    Memory Allocated: 0.018597126007080078  GigaBytes
Max Memory Allocated: 0.02628183364868164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001700758934020996 |0.0009415149688720703 |0.005274415016174316 |0.00018894672393798828 |0.0029535293579101562 |0.0023965835571289062 |
----------------------------------------------------------pseudo_mini_loss sum 1.582535743713379
Total (block generation + training)time/epoch 0.09072661399841309
Training time/epoch 0.02788996696472168
Training time without block to device /epoch 0.02600693702697754
Training time without total dataloading part /epoch 0.019230365753173828
load block tensor time/epoch 0.003401517868041992
block to device time/epoch 0.0018830299377441406
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6661
Number of first layer input nodes during this epoch:  3750
