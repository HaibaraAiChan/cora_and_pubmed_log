main start at this time 1648428462.5438576
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015017986297607422
range selection method range initialization spend 0.00012230873107910156
time for parepare:  0.00011348724365234375
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.0002727508544921875
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.002256155014038086
local_output_nid generation:  2.8133392333984375e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00010609626770019531
local_output_nid generation:  1.811981201171875e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.00013518333435058594
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001785755157470703
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001201629638671875
----------------------check_connections_block total spend ----------------------------- 0.004207134246826172
generate_one_block  0.0019478797912597656
generate_one_block  0.0013344287872314453
generate_one_block  0.0013358592987060547
generate_one_block  0.0013298988342285156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005831718444824219
gen group dst list time:  5.054473876953125e-05
time for parepare:  0.00020051002502441406
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00020551681518554688
mini_batch_src_global generation:  6.29425048828125e-05
r_  generation:  0.00041794776916503906
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  6.413459777832031e-05
r_  generation:  0.0004649162292480469
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0005660057067871094
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  6.604194641113281e-05
r_  generation:  0.0005316734313964844
----------------------check_connections_block total spend ----------------------------- 0.0039014816284179688
generate_one_block  0.0017633438110351562
generate_one_block  0.001791238784790039
generate_one_block  0.001882314682006836
generate_one_block  0.001817464828491211
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006866455078125
gen group dst list time:  9.465217590332031e-05
time for parepare:  0.00021910667419433594
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002868175506591797
mini_batch_src_global generation:  0.00013256072998046875
r_  generation:  0.001363515853881836
local_output_nid generation:  6.413459777832031e-05
local_in_edges_tensor generation:  0.0002472400665283203
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0013577938079833984
local_output_nid generation:  7.891654968261719e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.001642465591430664
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0015189647674560547
----------------------check_connections_block total spend ----------------------------- 0.009553670883178711
generate_one_block  0.0028324127197265625
generate_one_block  0.002620220184326172
generate_one_block  0.0031549930572509766
generate_one_block  0.002374410629272461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.01345515251159668
block generation total time  0.018236398696899414
average batch blocks generation time:  0.0045590996742248535
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.009334564208984375  GigaBytes
Max Memory Allocated: 0.009334564208984375  GigaBytes

torch.Size([1461, 1433])
torch.Size([666, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010724067687988281  GigaBytes
Max Memory Allocated: 0.01101541519165039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.010659217834472656  GigaBytes
Max Memory Allocated: 0.018423080444335938  GigaBytes

torch.Size([1428, 1433])
torch.Size([630, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.012053489685058594  GigaBytes
Max Memory Allocated: 0.018423080444335938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.011397361755371094  GigaBytes
Max Memory Allocated: 0.018978118896484375  GigaBytes

torch.Size([1565, 1433])
torch.Size([773, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.013072490692138672  GigaBytes
Max Memory Allocated: 0.018978118896484375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.011026382446289062  GigaBytes
Max Memory Allocated: 0.019341468811035156  GigaBytes

torch.Size([1496, 1433])
torch.Size([709, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.012572288513183594  GigaBytes
Max Memory Allocated: 0.019341468811035156  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0051877498626708984 |0.09129554033279419 |0.193791925907135 |0.00018143653869628906 |0.004231512546539307 |0.0029761791229248047 |
----------------------------------------------------------pseudo_mini_loss sum 3.414869785308838
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9467
Number of first layer input nodes during this epoch:  5950
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.019341468811035156  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000621795654296875
range selection method range initialization spend 8.130073547363281e-05
time for parepare:  8.344650268554688e-05
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00010371208190917969
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation: Using backend: pytorch
 0.00014591217041015625
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  8.344650268554688e-05
local_output_nid generation:  1.3589859008789062e-05
local_in_edges_tensor generation:  0.00015473365783691406
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00010037422180175781
----------------------check_connections_block total spend ----------------------------- 0.0016617774963378906
generate_one_block  0.0014820098876953125
generate_one_block  0.0011708736419677734
generate_one_block  0.0010118484497070312
generate_one_block  0.0010552406311035156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
gen group dst list time:  3.814697265625e-05
time for parepare:  0.00015497207641601562
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  6.270408630371094e-05
r_  generation:  0.00042247772216796875
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  5.507469177246094e-05
r_  generation:  0.0003178119659423828
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00030112266540527344
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  5.340576171875e-05
r_  generation:  0.0004968643188476562
----------------------check_connections_block total spend ----------------------------- 0.0030138492584228516
generate_one_block  0.0015900135040283203
generate_one_block  0.001340627670288086
generate_one_block  0.0013308525085449219
generate_one_block  0.001485586166381836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005407333374023438
gen group dst list time:  7.677078247070312e-05
time for parepare:  0.0001697540283203125
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0002579689025878906
mini_batch_src_global generation:  0.00010800361633300781
r_  generation:  0.0011513233184814453
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0009953975677490234
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.00011396408081054688
r_  generation:  0.0009741783142089844
local_output_nid generation:  5.888938903808594e-05
local_in_edges_tensor generation:  0.00019311904907226562
mini_batch_src_global generation:  0.0001246929168701172
r_  generation:  0.001216888427734375
----------------------check_connections_block total spend ----------------------------- 0.0071527957916259766
generate_one_block  0.0023500919342041016
generate_one_block  0.002125978469848633
generate_one_block  0.0021028518676757812
generate_one_block  0.003038167953491211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0141143798828125  GigaBytes
Max Memory Allocated: 0.019341468811035156  GigaBytes

connection checking time:  0.010166645050048828
block generation total time  0.01536417007446289
average batch blocks generation time:  0.0038410425186157227
block dataloader generation time/epoch 0.042430877685546875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.0143890380859375  GigaBytes
Max Memory Allocated: 0.022335052490234375  GigaBytes

torch.Size([1532, 1433])
torch.Size([752, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.016002178192138672  GigaBytes
Max Memory Allocated: 0.022335052490234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.013731956481933594  GigaBytes
Max Memory Allocated: 0.022335052490234375  GigaBytes

torch.Size([1443, 1433])
torch.Size([619, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01506662368774414  GigaBytes
Max Memory Allocated: 0.022335052490234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01438140869140625  GigaBytes
Max Memory Allocated: 0.022335052490234375  GigaBytes

torch.Size([1408, 1433])
torch.Size([608, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.015672683715820312  GigaBytes
Max Memory Allocated: 0.022335052490234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.014430522918701172  GigaBytes
Max Memory Allocated: 0.02274179458618164  GigaBytes

torch.Size([1572, 1433])
torch.Size([791, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2928466796875 GB
    Memory Allocated: 0.01617717742919922  GigaBytes
Max Memory Allocated: 0.02274179458618164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0023756027221679688 |0.0003699660301208496 |0.002961874008178711 |9.739398956298828e-05 |0.0032666921615600586 |0.0011970996856689453 |
----------------------------------------------------------pseudo_mini_loss sum 1.5984113216400146
Total (block generation + training)time/epoch 0.08374857902526855
Training time/epoch 0.041091203689575195
Training time without block to device /epoch 0.0396113395690918
Training time without total dataloading part /epoch 0.026500940322875977
load block tensor time/epoch 0.009502410888671875
block to device time/epoch 0.0014798641204833984
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9463
Number of first layer input nodes during this epoch:  5955
