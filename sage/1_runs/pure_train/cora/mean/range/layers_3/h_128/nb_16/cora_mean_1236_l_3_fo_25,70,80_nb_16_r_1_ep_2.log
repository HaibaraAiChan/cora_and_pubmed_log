main start at this time 1648428556.2682633
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014886856079101562
range selection method range initialization spend 0.00010609626770019531
time for parepare:  6.628036499023438e-05
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0001933574676513672
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.002463817596435547
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  2.7894973754882812e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.918212890625e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.822845458984375e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6464462280273438e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  2.7418136596679688e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.751319885253906e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.1696090698242188e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010013580322265625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.703636169433594e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3603439331054688e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  1.5497207641601562e-05
----------------------check_connections_block total spend ----------------------------- 0.0056493282318115234
generate_one_block  0.0015149116516113281
generate_one_block  0.0011227130889892578
generate_one_block  0.0011627674102783203
generate_one_block  0.0011146068572998047
generate_one_block  0.0011069774627685547
generate_one_block  0.0011072158813476562
generate_one_block  0.0011179447174072266
generate_one_block  0.001104593276977539
generate_one_block  0.001129150390625
generate_one_block  0.0011174678802490234
generate_one_block  0.0011391639709472656
generate_one_block  0.0010993480682373047
generate_one_block  0.0011267662048339844
generate_one_block  0.0010783672332763672
generate_one_block  0.001024007797241211
generate_one_block  0.0010085105895996094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006084442138671875
gen group dst list time:  9.1552734375e-05
time for parepare:  0.000148773193359375
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002155303955078125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012993812561035156
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.1948089599609375e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0001068115234375
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  0.00011920928955078125
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  0.00010824203491210938
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.0001480579376220703
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001995563507080078
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00022363662719726562
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00017786026000976562
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.511543273925781e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010919570922851562
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011229515075683594
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  0.00015425682067871094
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010895729064941406
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.0001399517059326172
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.0001418590545654297
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.005772829055786133
generate_one_block  0.0012845993041992188
generate_one_block  0.0013201236724853516
generate_one_block  0.0011818408966064453
generate_one_block  0.001188039779663086
generate_one_block  0.0012481212615966797
generate_one_block  0.0011985301971435547
generate_one_block  0.0012469291687011719
generate_one_block  0.0013740062713623047
generate_one_block  0.0012962818145751953
generate_one_block  0.00119781494140625
generate_one_block  0.0011572837829589844
generate_one_block  0.001146078109741211
generate_one_block  0.0011720657348632812
generate_one_block  0.0011851787567138672
generate_one_block  0.0011734962463378906
generate_one_block  0.0010669231414794922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006954669952392578
gen group dst list time:  0.00016379356384277344
time for parepare:  0.00021767616271972656
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00022292137145996094
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0006544589996337891
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0001385211944580078
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.0003132820129394531
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.0004458427429199219
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004329681396484375
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.00023627281188964844
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00041675567626953125
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.00015044212341308594
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005300045013427734
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001647472381591797
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0007252693176269531
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0006725788116455078
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005557537078857422
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00013446807861328125
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0003123283386230469
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00013875961303710938
mini_batch_src_global generation:  5.078315734863281e-05
r_  generation:  0.0004017353057861328
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.000514984130859375
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0004885196685791016
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.000152587890625
mini_batch_src_global generation:  6.0558319091796875e-05
r_  generation:  0.0004818439483642578
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00017452239990234375
----------------------check_connections_block total spend ----------------------------- 0.013971567153930664
generate_one_block  0.0016510486602783203
generate_one_block  0.0018863677978515625
generate_one_block  0.0013546943664550781
generate_one_block  0.0014986991882324219
generate_one_block  0.0014691352844238281
generate_one_block  0.0014846324920654297
generate_one_block  0.002418041229248047
generate_one_block  0.0018224716186523438
generate_one_block  0.0016641616821289062
generate_one_block  0.0015709400177001953
generate_one_block  0.001306772232055664
generate_one_block  0.0013954639434814453
generate_one_block  0.0014753341674804688
generate_one_block  0.0014739036560058594
generate_one_block  0.0014793872833251953
generate_one_block  0.001150369644165039
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

connection checking time:  0.019744396209716797
block generation total time  0.04453873634338379
average batch blocks generation time:  0.002783671021461487
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005316257476806641  GigaBytes
Max Memory Allocated: 0.005316257476806641  GigaBytes

torch.Size([712, 1433])
torch.Size([247, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005817413330078125  GigaBytes
Max Memory Allocated: 0.0060214996337890625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008412361145019531  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

torch.Size([1010, 1433])
torch.Size([404, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.009142875671386719  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005662441253662109  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

torch.Size([497, 1433])
torch.Size([174, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0060253143310546875  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006754875183105469  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

torch.Size([701, 1433])
torch.Size([224, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007200717926025391  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006290435791015625  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

torch.Size([614, 1433])
torch.Size([221, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0067501068115234375  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006328105926513672  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

torch.Size([621, 1433])
torch.Size([217, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006769657135009766  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007634162902832031  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

torch.Size([865, 1433])
torch.Size([296, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00823068618774414  GigaBytes
Max Memory Allocated: 0.01219320297241211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008745193481445312  GigaBytes
Max Memory Allocated: 0.013340473175048828  GigaBytes

torch.Size([1072, 1433])
torch.Size([432, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.00955343246459961  GigaBytes
Max Memory Allocated: 0.013340473175048828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007873058319091797  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([909, 1433])
torch.Size([345, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.008626937866210938  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006968021392822266  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([740, 1433])
torch.Size([297, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007553577423095703  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005828857421875  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([528, 1433])
torch.Size([162, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006161689758300781  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006963253021240234  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([646, 1433])
torch.Size([238, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007435321807861328  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007174491882324219  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([779, 1433])
torch.Size([250, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0077304840087890625  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006966114044189453  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([706, 1433])
torch.Size([272, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007514476776123047  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006571292877197266  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([666, 1433])
torch.Size([254, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.007081031799316406  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004479408264160156  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([276, 1433])
torch.Size([104, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.004689216613769531  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0041169673204422 |0.021881386637687683 |0.051332101225852966 |0.00014109909534454346 |0.002649739384651184 |0.002572774887084961 |
----------------------------------------------------------pseudo_mini_loss sum 3.1074130535125732
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16243
Number of first layer input nodes during this epoch:  11342
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007490634918212891  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046944618225097656
range selection method range initialization spend 6.389617919921875e-05
time for parepare:  6.127357482910156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.0040740966796875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.6702880859375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.942054748535156e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  3.0279159545898438e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.632110595703125e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.3126602172851562e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.4543533325195312e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.441375732421875e-05
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.512901306152344e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.4557113647460938e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  1.5020370483398438e-05
r_  generation:  2.09808349609375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.679794311523438e-05
mini_batch_src_global generation:  1.430511474609375e-05
r_  generation:  2.193450927734375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.417533874511719e-05
mini_batch_src_global generation:  1.4781951904296875e-05
r_  generation:  2.384185791015625e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  9.608268737792969e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.9311904907226562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  9.5367431640625e-05
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.655952453613281e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  1.5735626220703125e-05
----------------------check_connections_block total spend ----------------------------- 0.0030646324157714844
generate_one_block  0.0011425018310546875
generate_one_block  0.0010852813720703125
generate_one_block  0.0010924339294433594
generate_one_block  0.0010943412780761719
generate_one_block  0.001088857650756836
generate_one_block  0.001077890396118164
generate_one_block  0.0012624263763427734
generate_one_block  0.0010797977447509766
generate_one_block  0.0010864734649658203
generate_one_block  0.0010275840759277344
generate_one_block  0.001024484634399414
generate_one_block  0.0010271072387695312
generate_one_block  0.0010190010070800781
generate_one_block  0.001054525375366211
generate_one_block  0.0010404586791992188
generate_one_block  0.0010123252868652344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00061798095703125
gen group dst list time:  9.131431579589844e-05
time for parepare:  0.00015473365783691406
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.0001499652862548828
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.00016117095947265625
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00019621849060058594
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.0001380443572998047
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  2.765655517578125e-05
r_  generation:  0.00013875961303710938
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00010943412780761719
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  0.00011372566223144531
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00010561943054199219
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  9.036064147949219e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  0.00011730194091796875
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  0.00017881393432617188
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.00010061264038085938
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00020170211791992188
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.0002162456512451172
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  5.054473876953125e-05
----------------------check_connections_block total spend ----------------------------- 0.005614757537841797
generate_one_block  0.0012598037719726562
generate_one_block  0.0012791156768798828
generate_one_block  0.001371622085571289
generate_one_block  0.0012297630310058594
generate_one_block  0.0012598037719726562
generate_one_block  0.0011823177337646484
generate_one_block  0.0011928081512451172
generate_one_block  0.0012028217315673828
generate_one_block  0.001163482666015625
generate_one_block  0.0011167526245117188
generate_one_block  0.001161813735961914
generate_one_block  0.0012102127075195312
generate_one_block  0.0011293888092041016
generate_one_block  0.0012476444244384766
generate_one_block  0.0012621879577636719
generate_one_block  0.0010988712310791016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006988048553466797
gen group dst list time:  0.000164031982421875
time for parepare:  0.00022840499877929688
local_output_nid generation:  2.6226043701171875e-05
local_in_edges_tensor generation:  0.00028324127197265625
mini_batch_src_global generation:  8.797645568847656e-05
r_  generation:  0.000579833984375
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0005199909210205078
local_output_nid generation:  3.147125244140625e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  7.05718994140625e-05
r_  generation:  0.0006556510925292969
local_output_nid generation:  2.0742416381835938e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  6.437301635742188e-05
r_  generation:  0.00048089027404785156
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  6.246566772460938e-05
r_  generation:  0.0005135536193847656
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.00034689903259277344
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.00013494491577148438
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.00039076805114746094
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  5.1975250244140625e-05
r_  generation:  0.000347137451171875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.0002751350402832031
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.0002808570861816406
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.5789947509765625e-05
r_  generation:  0.0004711151123046875
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00015306472778320312
mini_batch_src_global generation:  7.152557373046875e-05
r_  generation:  0.0006284713745117188
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.00039076805114746094
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0001537799835205078
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0006008148193359375
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00016736984252929688
mini_batch_src_global generation:  8.368492126464844e-05
r_  generation:  0.0007071495056152344
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.00016641616821289062
----------------------check_connections_block total spend ----------------------------- 0.01372838020324707
generate_one_block  0.0018224716186523438
generate_one_block  0.0016036033630371094
generate_one_block  0.0017070770263671875
generate_one_block  0.001478433609008789
generate_one_block  0.0015499591827392578
generate_one_block  0.0013606548309326172
generate_one_block  0.0013933181762695312
generate_one_block  0.0013549327850341797
generate_one_block  0.001256704330444336
generate_one_block  0.0012476444244384766
generate_one_block  0.0015268325805664062
generate_one_block  0.0017902851104736328
generate_one_block  0.0013933181762695312
generate_one_block  0.0016176700592041016
generate_one_block  0.001775503158569336
generate_one_block  0.0011305809020996094
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007490634918212891  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

connection checking time:  0.019343137741088867
block generation total time  0.04337739944458008
average batch blocks generation time:  0.002711087465286255
block dataloader generation time/epoch 0.09733390808105469
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010907649993896484  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

torch.Size([917, 1433])
torch.Size([329, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011537551879882812  GigaBytes
Max Memory Allocated: 0.013575553894042969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009678840637207031  GigaBytes
Max Memory Allocated: 0.014557838439941406  GigaBytes

torch.Size([687, 1433])
torch.Size([321, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010294437408447266  GigaBytes
Max Memory Allocated: 0.014557838439941406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011289119720458984  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([988, 1433])
torch.Size([382, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0120391845703125  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009596824645996094  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([672, 1433])
torch.Size([243, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010106563568115234  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01128530502319336  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([838, 1433])
torch.Size([304, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01188039779663086  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009224414825439453  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([603, 1433])
torch.Size([199, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009623527526855469  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00914621353149414  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([588, 1433])
torch.Size([198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009572505950927734  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009017467498779297  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([564, 1433])
torch.Size([198, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009420394897460938  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009142398834228516  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([457, 1433])
torch.Size([134, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00945138931274414  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008298873901367188  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

torch.Size([430, 1433])
torch.Size([152, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.008623123168945312  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010472297668457031  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes
Using backend: pytorch

torch.Size([836, 1433])
torch.Size([276, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0110015869140625  GigaBytes
Max Memory Allocated: 0.014936447143554688  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011448383331298828  GigaBytes
Max Memory Allocated: 0.01589202880859375  GigaBytes

torch.Size([898, 1433])
torch.Size([351, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01212310791015625  GigaBytes
Max Memory Allocated: 0.01589202880859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00909280776977539  GigaBytes
Max Memory Allocated: 0.01589202880859375  GigaBytes

torch.Size([578, 1433])
torch.Size([206, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009496688842773438  GigaBytes
Max Memory Allocated: 0.01589202880859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011448383331298828  GigaBytes
Max Memory Allocated: 0.01589202880859375  GigaBytes

torch.Size([894, 1433])
torch.Size([349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012197494506835938  GigaBytes
Max Memory Allocated: 0.01589202880859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011846542358398438  GigaBytes
Max Memory Allocated: 0.017258644104003906  GigaBytes

torch.Size([1092, 1433])
torch.Size([399, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.012654304504394531  GigaBytes
Max Memory Allocated: 0.017258644104003906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0075855255126953125  GigaBytes
Max Memory Allocated: 0.017258644104003906  GigaBytes

torch.Size([297, 1433])
torch.Size([74, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00774383544921875  GigaBytes
Max Memory Allocated: 0.017258644104003906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.001238986849784851 |0.00048354268074035645 |0.003703504800796509 |0.00011768937110900879 |0.002979576587677002 |0.001340627670288086 |
----------------------------------------------------------pseudo_mini_loss sum 1.6170425415039062
Total (block generation + training)time/epoch 0.2528371810913086
Training time/epoch 0.15515947341918945
Training time without block to device /epoch 0.14742279052734375
Training time without total dataloading part /epoch 0.1101529598236084
load block tensor time/epoch 0.019823789596557617
block to device time/epoch 0.007736682891845703
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  16220
Number of first layer input nodes during this epoch:  11339
