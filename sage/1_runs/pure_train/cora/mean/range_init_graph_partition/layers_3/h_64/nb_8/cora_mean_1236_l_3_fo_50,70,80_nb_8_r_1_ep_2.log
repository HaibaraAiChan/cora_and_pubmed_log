main start at this time 1648608179.0564692
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20806.60546875, 'VmSize': 20806.60546875, 'VmHWM': 3618.0859375, 'VmRSS': 3618.0859375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.005650520324707031
global_2_local 8.153915405273438e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.125999450683594e-05
before graph partition 
		98, 85, 83, 135, 87, 77, 117, 69, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002117156982421875
	Initialize BitList time :  1.4066696166992188e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 98, 85

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
	walk terminate 1 spend time 4.936575174331665
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 98, 83, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005185604095458984
	Initialize BitList time :  4.458427429199219e-05
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 98, 83

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
	walk terminate 1 spend time 5.170979261398315
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 98, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047278404235839844
	Initialize BitList time :  3.457069396972656e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 98, 135

	before terminate 1 the average redundancy rate is:  1.4472049689440993
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.2173913043478262,  1.6770186335403727
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 5.132305860519409
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 5.080351114273071
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		85, 83, 87, 145, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004837512969970703
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 145, 87

	before terminate 1 the average redundancy rate is:  1.4409937888198758
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
	walk terminate 1 spend time 5.076894760131836
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 145, 77, 117, 69, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 18, 21, 18, 18, 14, 


	preparing two sides time :  0.00039887428283691406
	Initialize BitList time :  6.556510925292969e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 145, 77

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
	walk terminate 1 spend time 5.031318187713623
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 145, 117, 69, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 18, 18, 21, 18, 14, 


	preparing two sides time :  0.00044989585876464844
	Initialize BitList time :  6.747245788574219e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 145, 117

	before terminate 1 the average redundancy rate is:  1.627329192546584
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
	walk terminate 1 spend time 5.084856748580933
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 145, 69, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 18, 18, 18, 21, 14, 


	preparing two sides time :  0.0004875659942626953
	Initialize BitList time :  9.250640869140625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 145, 69

	before terminate 1 the average redundancy rate is:  1.329192546583851
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
	walk terminate 1 spend time 5.190923690795898
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 69, 145, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 40.74482727050781
partition_len_list
[85, 83, 87, 87, 77, 117, 69, 145]
range_init_graph_partition selection method range initialization spend 40.745678186416626
time for parepare:  0.00019931793212890625
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0010361671447753906
mini_batch_src_global generation:  0.0001461505889892578
r_  generation:  0.013219118118286133
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00025153160095214844
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  6.890296936035156e-05
r_  generation:  3.981590270996094e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00014853477478027344
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  8.463859558105469e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.123283386230469e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  8.630752563476562e-05
----------------------check_connections_block total spend ----------------------------- 0.017742156982421875
generate_one_block  0.01322793960571289
generate_one_block  0.0012192726135253906
generate_one_block  0.0011162757873535156
generate_one_block  0.0011551380157470703
generate_one_block  0.0011436939239501953
generate_one_block  0.0011692047119140625
generate_one_block  0.0011162757873535156
generate_one_block  0.0011780261993408203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002809762954711914
gen group dst list time:  0.00010085105895996094
time for parepare:  0.0011475086212158203
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0004904270172119141
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.00037479400634765625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00023055076599121094
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001289844512939453
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002372264862060547
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00024580955505371094
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00018072128295898438
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0003364086151123047
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00017452239990234375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.0003437995910644531
----------------------check_connections_block total spend ----------------------------- 0.006094694137573242
generate_one_block  0.0015404224395751953
generate_one_block  0.0012891292572021484
generate_one_block  0.0013244152069091797
generate_one_block  0.0014083385467529297
generate_one_block  0.0013513565063476562
generate_one_block  0.0016629695892333984
generate_one_block  0.0012311935424804688
generate_one_block  0.0016698837280273438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017902851104736328
gen group dst list time:  0.00010824203491210938
time for parepare:  0.0007953643798828125
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0007326602935791016
mini_batch_src_global generation:  0.00029277801513671875
r_  generation:  0.0008845329284667969
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00011444091796875
r_  generation:  0.0007672309875488281
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007781982421875
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.0007684230804443359
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0001609325408935547
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006051063537597656
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.00019693374633789062
mini_batch_src_global generation:  0.00011801719665527344
r_  generation:  0.0011951923370361328
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0006480216979980469
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00018906593322753906
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0010890960693359375
----------------------check_connections_block total spend ----------------------------- 0.013035058975219727
generate_one_block  0.006779909133911133
generate_one_block  0.00616145133972168
generate_one_block  0.006250858306884766
generate_one_block  0.004961252212524414
generate_one_block  0.004431962966918945
generate_one_block  0.0052716732025146484
generate_one_block  0.004121303558349609
generate_one_block  0.005770444869995117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20808.671875, 'VmSize': 20656.50390625, 'VmHWM': 3621.046875, 'VmRSS': 3621.0234375}
connection checking time:  0.01912975311279297
block generation total time  0.05522656440734863
average batch blocks generation time:  0.006903320550918579
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.007236480712890625  GigaBytes
Max Memory Allocated: 0.007236480712890625  GigaBytes

{'VmPeak': 21006.765625, 'VmSize': 20977.6328125, 'VmHWM': 3912.26171875, 'VmRSS': 3912.26171875}
torch.Size([1215, 1433])
torch.Size([491, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007740497589111328  GigaBytes
Max Memory Allocated: 0.007902145385742188  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21753.41796875, 'VmHWM': 4609.8046875, 'VmRSS': 4609.8046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007058143615722656  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4616.3203125, 'VmRSS': 4616.3203125}
torch.Size([1047, 1433])
torch.Size([371, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007462978363037109  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4616.3203125, 'VmRSS': 4616.3203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006402492523193359  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4616.7109375, 'VmRSS': 4616.7109375}
torch.Size([924, 1433])
torch.Size([399, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006834506988525391  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4616.8203125, 'VmRSS': 4616.8203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007089138031005859  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4617.21875, 'VmRSS': 4617.21875}
torch.Size([1053, 1433])
torch.Size([435, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0075473785400390625  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4617.21875, 'VmRSS': 4617.21875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006422519683837891  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4617.3125, 'VmRSS': 4617.3125}
torch.Size([929, 1433])
torch.Size([319, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00677490234375  GigaBytes
Max Memory Allocated: 0.013521194458007812  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21759.1640625, 'VmHWM': 4617.3125, 'VmRSS': 4617.3125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009348869323730469  GigaBytes
Max Memory Allocated: 0.014273643493652344  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.125, 'VmRSS': 4619.125}
torch.Size([1474, 1433])
torch.Size([654, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010020732879638672  GigaBytes
Max Memory Allocated: 0.014273643493652344  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.125, 'VmRSS': 4619.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006620883941650391  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.125, 'VmRSS': 4619.125}
torch.Size([966, 1433])
torch.Size([318, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006964683532714844  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.125, 'VmRSS': 4619.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009347915649414062  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.5, 'VmRSS': 4619.5}
torch.Size([1353, 1433])
torch.Size([575, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009987831115722656  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.5, 'VmRSS': 4619.5}
{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013520389795303345 |0.045695334672927856 |0.10129702091217041 |0.00019696354866027832 |0.003823608160018921 |0.002824544906616211 |
----------------------------------------------------------pseudo_mini_loss sum 3.413297414779663
{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13273
Number of first layer input nodes during this epoch:  8961
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010869026184082031  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21766.56640625, 'VmSize': 21761.5, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004994869232177734
global_2_local 7.724761962890625e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.745887756347656e-05
before graph partition 
		90, 105, 117, 83, 105, 99, 73, 75, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002071857452392578
	Initialize BitList time :  1.239776611328125e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 90, 105

	before terminate 1 the average redundancy rate is:  1.2111801242236024
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  1
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
	walk terminate 1 spend time 5.862804651260376
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
	walk terminate 1 spend time 5.967201471328735
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 127, 117, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				13, 23, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048351287841796875
	Initialize BitList time :  3.910064697265625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 127, 117

	before terminate 1 the average redundancy rate is:  1.5155279503105592
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.4161490683229814,  1.6024844720496894
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.6273291925465838,  1.3788819875776397
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.5031055900621118,  1.5031055900621118
	walk terminate 1 spend time 6.02441143989563
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.3788819875776397,  1.639751552795031
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
	walk terminate 1 spend time 6.070443153381348
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 120, 124, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				13, 21, 20, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004718303680419922
	Initialize BitList time :  4.220008850097656e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 83

	before terminate 1 the average redundancy rate is:  1.2857142857142856
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 5.841688871383667
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 124, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				13, 21, 18, 20, 18, 18, 18, 14, 


	preparing two sides time :  0.000484466552734375
	Initialize BitList time :  4.100799560546875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 105

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.988733291625977
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 6.003082513809204
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		61, 120, 83, 103, 123, 99, 73, 75, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				13, 21, 18, 15, 23, 18, 18, 14, 


	preparing two sides time :  0.00040340423583984375
	Initialize BitList time :  3.0994415283203125e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 123, 99

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
	walk terminate 1 spend time 6.120020627975464
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 123, 73, 75, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				13, 21, 18, 15, 18, 23, 18, 14, 


	preparing two sides time :  0.0005745887756347656
	Initialize BitList time :  4.100799560546875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 123, 73

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
	walk terminate 1 spend time 6.646965980529785
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 123, 75, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				13, 21, 18, 15, 18, 18, 23, 14, 


	preparing two sides time :  0.0005528926849365234
	Initialize BitList time :  4.696846008300781e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 123, 75

	before terminate 1 the average redundancy rate is:  1.2298136645962732
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
	walk terminate 1 spend time 6.61162805557251
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 75, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 61.16390538215637
partition_len_list
[61, 120, 83, 103, 99, 73, 75, 123]
range_init_graph_partition selection method range initialization spend 61.16447329521179
time for parepare:  0.00023651123046875
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0008418560028076172
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0005471706390380859
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0003032684326171875
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  9.5367431640625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002205371856689453
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.1975250244140625e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  5.507469177246094e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  4.839897155761719e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0003094673156738281
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  6.365776062011719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00027871131896972656
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  7.319450378417969e-05
----------------------check_connections_block total spend ----------------------------- 0.005126953125
generate_one_block  0.021169662475585938
generate_one_block  0.0019965171813964844
generate_one_block  0.0013737678527832031
generate_one_block  0.001142740249633789
generate_one_block  0.0011103153228759766
generate_one_block  0.0010771751403808594
generate_one_block  0.0010814666748046875
generate_one_block  0.0011169910430908203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019342899322509766
gen group dst list time:  0.00011754035949707031
time for parepare:  0.0004649162292480469
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0007665157318115234
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00016355514526367188
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.00029349327087402344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0002269744873046875
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.00031757354736328125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.0002734661102294922
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.000209808349609375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002987384796142578
----------------------check_connections_block total spend ----------------------------- 0.005307674407958984
generate_one_block  0.0018458366394042969
generate_one_block  0.0014243125915527344
generate_one_block  0.0013799667358398438
generate_one_block  0.0015559196472167969
generate_one_block  0.0015456676483154297
generate_one_block  0.0013551712036132812
generate_one_block  0.0013442039489746094
generate_one_block  0.001567840576171875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012073516845703125
gen group dst list time:  0.00011277198791503906
time for parepare:  0.00034236907958984375
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.0007607936859130859
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0005190372467041016
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  0.00013017654418945312
r_  generation:  0.0009608268737792969
local_output_nid generation:  3.814697265625e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0008845329284667969
local_output_nid generation:  4.100799560546875e-05
local_in_edges_tensor generation:  0.00017976760864257812
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0009653568267822266
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.000186920166015625
mini_batch_src_global generation:  0.0001125335693359375
r_  generation:  0.0010519027709960938
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00018167495727539062
mini_batch_src_global generation:  0.00022530555725097656
r_  generation:  0.0007548332214355469
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.0001678466796875
mini_batch_src_global generation:  0.00011897087097167969
r_  generation:  0.0008831024169921875
local_output_nid generation:  0.0001862049102783203
local_in_edges_tensor generation:  0.0005331039428710938
mini_batch_src_global generation:  0.0002944469451904297
r_  generation:  0.0022521018981933594
----------------------check_connections_block total spend ----------------------------- 0.020539045333862305
generate_one_block  0.0058422088623046875
generate_one_block  0.0030660629272460938
generate_one_block  0.0026426315307617188
generate_one_block  0.0026831626892089844
generate_one_block  0.002758502960205078
generate_one_block  0.002305269241333008
generate_one_block  0.0018506050109863281
generate_one_block  0.002348184585571289
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010869026184082031  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.45703125, 'VmRSS': 4621.45703125}
connection checking time:  0.02584671974182129
block generation total time  0.035515546798706055
average batch blocks generation time:  0.004439443349838257
block dataloader generation time/epoch 61.280863761901855
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.006600379943847656  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75, 'VmRSS': 4621.75}
torch.Size([693, 1433])
torch.Size([234, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.006866931915283203  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75, 'VmRSS': 4621.75}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009426593780517578  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
torch.Size([1220, 1433])
torch.Size([511, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009982585906982422  GigaBytes
Max Memory Allocated: 0.014471054077148438  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009119987487792969  GigaBytes
Max Memory Allocated: 0.015607833862304688  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
torch.Size([1163, 1433])
torch.Size([463, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009598255157470703  GigaBytes
Max Memory Allocated: 0.015607833862304688  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009724617004394531  GigaBytes
Max Memory Allocated: 0.015903472900390625  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
torch.Size([1241, 1433])
torch.Size([497, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010254859924316406  GigaBytes
Max Memory Allocated: 0.015903472900390625  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009914398193359375  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.015625, 'VmHWM': 4621.75390625, 'VmRSS': 4621.75390625}
torch.Size([1311, 1433])
torch.Size([559, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010489463806152344  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008624553680419922  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
torch.Size([1071, 1433])
torch.Size([416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009052276611328125  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008022785186767578  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
torch.Size([959, 1433])
torch.Size([289, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008350372314453125  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010261058807373047  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
torch.Size([1376, 1433])
torch.Size([555, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010858535766601562  GigaBytes
Max Memory Allocated: 0.016693592071533203  GigaBytes

{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010917097330093384 |0.0006225407123565674 |0.004976630210876465 |0.00018936395645141602 |0.0027352571487426758 |0.0025281906127929688 |
----------------------------------------------------------pseudo_mini_loss sum 2.2414956092834473
{'VmPeak': 21889.515625, 'VmSize': 21826.0, 'VmHWM': 4621.7578125, 'VmRSS': 4621.75}
Total (block generation + training)time/epoch 61.45132899284363
Training time/epoch 0.17020463943481445
Training time without block to device /epoch 0.16522431373596191
Training time without total dataloading part /epoch 0.06573820114135742
load block tensor time/epoch 0.08733677864074707
block to device time/epoch 0.004980325698852539
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13295
Number of first layer input nodes during this epoch:  9034
