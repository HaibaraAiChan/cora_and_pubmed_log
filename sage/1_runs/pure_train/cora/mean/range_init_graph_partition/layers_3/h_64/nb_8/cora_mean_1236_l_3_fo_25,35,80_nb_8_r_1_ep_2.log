main start at this time 1648607391.5219696
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20810.05078125, 'VmSize': 20810.05078125, 'VmHWM': 3622.6796875, 'VmRSS': 3622.6796875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010614395141601562
global_2_local 6.866455078125e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  4.887580871582031e-05
before graph partition 
		98, 85, 83, 135, 87, 77, 117, 69, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00018525123596191406
	Initialize BitList time :  1.1682510375976562e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 98, 85

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
	walk terminate 1 spend time 4.3729376792907715
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 98, 83, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004603862762451172
	Initialize BitList time :  3.361701965332031e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 98, 83

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
	walk terminate 1 spend time 4.3404457569122314
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 98, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004742145538330078
	Initialize BitList time :  3.600120544433594e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 98, 135

	before terminate 1 the average redundancy rate is:  1.4472049689440993
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.2173913043478262,  1.6770186335403727
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 4.465439081192017
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 4.387160062789917
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		85, 83, 87, 145, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0005109310150146484
	Initialize BitList time :  0.00011277198791503906
	getRedundancyCost: time   5.0067901611328125e-06

					length of partitions 145, 87

	before terminate 1 the average redundancy rate is:  1.4409937888198758
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
	walk terminate 1 spend time 4.467833042144775
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 145, 77, 117, 69, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 18, 21, 18, 18, 14, 


	preparing two sides time :  0.0004951953887939453
	Initialize BitList time :  3.695487976074219e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 145, 77

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
	walk terminate 1 spend time 4.46649169921875
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 145, 117, 69, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 18, 18, 21, 18, 14, 


	preparing two sides time :  0.0003330707550048828
	Initialize BitList time :  2.7418136596679688e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 145, 117

	before terminate 1 the average redundancy rate is:  1.627329192546584
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
	walk terminate 1 spend time 4.4387946128845215
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 145, 69, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 18, 18, 18, 21, 14, 


	preparing two sides time :  0.0004775524139404297
	Initialize BitList time :  3.910064697265625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 145, 69

	before terminate 1 the average redundancy rate is:  1.329192546583851
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
	walk terminate 1 spend time 4.431114673614502
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 69, 145, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 35.39539194107056
partition_len_list
[85, 83, 87, 87, 77, 117, 69, 145]
range_init_graph_partition selection method range initialization spend 35.39580678939819
time for parepare:  0.00014591217041015625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0009140968322753906
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.012514829635620117
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  5.8650970458984375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  3.647804260253906e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  0.00010609626770019531
----------------------check_connections_block total spend ----------------------------- 0.01619696617126465
generate_one_block  0.013392925262451172
generate_one_block  0.0011665821075439453
generate_one_block  0.0010747909545898438
generate_one_block  0.0010488033294677734
generate_one_block  0.0010366439819335938
generate_one_block  0.0010786056518554688
generate_one_block  0.001035928726196289
generate_one_block  0.0011038780212402344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018696784973144531
gen group dst list time:  0.000110626220703125
time for parepare:  0.000667572021484375
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0003275871276855469
mini_batch_src_global generation:  4.3392181396484375e-05
r_  generation:  0.00028014183044433594
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002620220184326172
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.00026702880859375
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00011587142944335938
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0002644062042236328
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  0.0001785755157470703
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.000286102294921875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011515617370605469
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00015926361083984375
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.00030612945556640625
----------------------check_connections_block total spend ----------------------------- 0.005007505416870117
generate_one_block  0.0012733936309814453
generate_one_block  0.0012180805206298828
generate_one_block  0.0012586116790771484
generate_one_block  0.0012505054473876953
generate_one_block  0.0012671947479248047
generate_one_block  0.0016133785247802734
generate_one_block  0.007063865661621094
generate_one_block  0.0016024112701416016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014400482177734375
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.0005631446838378906
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.0010254383087158203
mini_batch_src_global generation:  0.0003025531768798828
r_  generation:  0.0006906986236572266
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0003311634063720703
mini_batch_src_global generation:  0.00015854835510253906
r_  generation:  0.0006632804870605469
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0002110004425048828
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0006797313690185547
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  7.224082946777344e-05
r_  generation:  0.0005931854248046875
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  6.127357482910156e-05
r_  generation:  0.0004639625549316406
local_output_nid generation:  4.4345855712890625e-05
local_in_edges_tensor generation:  0.00028824806213378906
mini_batch_src_global generation:  0.0001766681671142578
r_  generation:  0.0009560585021972656
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.0005447864532470703
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.002352476119995117
----------------------check_connections_block total spend ----------------------------- 0.014369487762451172
generate_one_block  0.0064849853515625
generate_one_block  0.004309177398681641
generate_one_block  0.03132009506225586
generate_one_block  0.0046520233154296875
generate_one_block  0.0038039684295654297
generate_one_block  0.005536556243896484
generate_one_block  0.0037784576416015625
generate_one_block  0.00373077392578125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20810.06640625, 'VmSize': 20657.8984375, 'VmHWM': 3623.55859375, 'VmRSS': 3623.55859375}
connection checking time:  0.01937699317932129
block generation total time  0.08016347885131836
average batch blocks generation time:  0.010020434856414795
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.0065174102783203125  GigaBytes
Max Memory Allocated: 0.0065174102783203125  GigaBytes

{'VmPeak': 21006.98046875, 'VmSize': 20977.7421875, 'VmHWM': 3912.33984375, 'VmRSS': 3912.33984375}
torch.Size([1081, 1433])
torch.Size([419, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006961822509765625  GigaBytes
Max Memory Allocated: 0.007096767425537109  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21749.52734375, 'VmHWM': 4606.04296875, 'VmRSS': 4606.04296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006473541259765625  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4612.90625, 'VmRSS': 4612.90625}
torch.Size([938, 1433])
torch.Size([348, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0068569183349609375  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4612.90625, 'VmRSS': 4612.90625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0060367584228515625  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4613.6328125, 'VmRSS': 4613.6328125}
torch.Size([856, 1433])
torch.Size([377, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006448268890380859  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4613.7109375, 'VmRSS': 4613.7109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006402015686035156  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4613.828125, 'VmRSS': 4613.828125}
torch.Size([925, 1433])
torch.Size([359, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006796360015869141  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4613.828125, 'VmRSS': 4613.828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006030082702636719  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4614.640625, 'VmRSS': 4614.640625}
torch.Size([783, 1433])
torch.Size([259, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006333351135253906  GigaBytes
Max Memory Allocated: 0.012224197387695312  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21754.7578125, 'VmHWM': 4614.640625, 'VmRSS': 4614.640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008564949035644531  GigaBytes
Max Memory Allocated: 0.013104915618896484  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.01171875, 'VmRSS': 4616.01171875}
torch.Size([1328, 1433])
torch.Size([573, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00916910171508789  GigaBytes
Max Memory Allocated: 0.013104915618896484  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.01171875, 'VmRSS': 4616.01171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006218910217285156  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.22265625, 'VmRSS': 4616.22265625}
torch.Size([891, 1433])
torch.Size([285, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006536006927490234  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.2265625, 'VmRSS': 4616.2265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00823068618774414  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.2265625, 'VmRSS': 4616.2265625}
torch.Size([1265, 1433])
torch.Size([535, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008837699890136719  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.2265625, 'VmRSS': 4616.2265625}
{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.5390625, 'VmRSS': 4616.5390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012572616338729858 |0.04441732168197632 |0.1028098464012146 |0.00014710426330566406 |0.0035390257835388184 |0.0024361610412597656 |
----------------------------------------------------------pseudo_mini_loss sum 3.375725746154785
{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.5390625, 'VmRSS': 4616.5390625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11972
Number of first layer input nodes during this epoch:  8067
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21760.0546875, 'VmSize': 21756.890625, 'VmHWM': 4616.5390625, 'VmRSS': 4616.5390625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047397613525390625
global_2_local 7.748603820800781e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.269050598144531e-05
before graph partition 
		90, 105, 117, 83, 105, 99, 73, 75, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020742416381835938
	Initialize BitList time :  1.1920928955078125e-05
	getRedundancyCost: time   1.9073486328125e-06

					length of partitions 90, 105

	before terminate 1 the average redundancy rate is:  1.2111801242236024
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  1
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
	walk terminate 1 spend time 5.229240894317627
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
	walk terminate 1 spend time 5.262050151824951
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 127, 117, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				13, 23, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005033016204833984
	Initialize BitList time :  4.291534423828125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 127, 117

	before terminate 1 the average redundancy rate is:  1.5155279503105592
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.4161490683229814,  1.6024844720496894
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.6273291925465838,  1.3788819875776397
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.5031055900621118,  1.5031055900621118
	walk terminate 1 spend time 5.411944150924683
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.3788819875776397,  1.639751552795031
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
	walk terminate 1 spend time 5.315371036529541
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 120, 124, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				13, 21, 20, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047898292541503906
	Initialize BitList time :  4.506111145019531e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 124, 83

	before terminate 1 the average redundancy rate is:  1.2857142857142856
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 5.442225456237793
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 124, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				13, 21, 18, 20, 18, 18, 18, 14, 


	preparing two sides time :  0.0004973411560058594
	Initialize BitList time :  0.00012540817260742188
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 124, 105

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.36120867729187
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.409527540206909
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		61, 120, 83, 103, 123, 99, 73, 75, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				13, 21, 18, 15, 23, 18, 18, 14, 


	preparing two sides time :  0.000476837158203125
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 123, 99

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
	walk terminate 1 spend time 5.468432426452637
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 123, 73, 75, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				13, 21, 18, 15, 18, 23, 18, 14, 


	preparing two sides time :  0.00047779083251953125
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 123, 73

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
	walk terminate 1 spend time 5.3715105056762695
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 123, 75, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				13, 21, 18, 15, 18, 18, 23, 14, 


	preparing two sides time :  0.00046443939208984375
	Initialize BitList time :  3.552436828613281e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 123, 75

	before terminate 1 the average redundancy rate is:  1.2298136645962732
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
	walk terminate 1 spend time 5.385085344314575
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 75, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 53.682695627212524
partition_len_list
[61, 120, 83, 103, 99, 73, 75, 123]
range_init_graph_partition selection method range initialization spend 53.68315553665161
time for parepare:  0.00017905235290527344
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.001107931137084961
mini_batch_src_global generation:  0.0006597042083740234
r_  generation:  0.0004677772521972656
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00029349327087402344
mini_batch_src_global generation:  6.580352783203125e-05
r_  generation:  0.00010776519775390625
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  7.2479248046875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.000102996826171875
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0002238750457763672
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  8.535385131835938e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  7.009506225585938e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.2438507080078125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  6.961822509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.006130218505859375
generate_one_block  0.02086639404296875
generate_one_block  0.001257181167602539
generate_one_block  0.001234292984008789
generate_one_block  0.0010340213775634766
generate_one_block  0.0010061264038085938
generate_one_block  0.0010025501251220703
generate_one_block  0.0009884834289550781
generate_one_block  0.0010721683502197266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020644664764404297
gen group dst list time:  0.0001049041748046875
time for parepare:  0.0007786750793457031
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  6.079673767089844e-05
r_  generation:  0.0002067089080810547
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0003478527069091797
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0002777576446533203
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0003643035888671875
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00024771690368652344
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00018739700317382812
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012612342834472656
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00016379356384277344
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.0003857612609863281
----------------------check_connections_block total spend ----------------------------- 0.005587339401245117
generate_one_block  0.00122833251953125
generate_one_block  0.0013704299926757812
generate_one_block  0.0012869834899902344
generate_one_block  0.0013744831085205078
generate_one_block  0.0014340877532958984
generate_one_block  0.0012621879577636719
generate_one_block  0.0013628005981445312
generate_one_block  0.001600027084350586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016009807586669922
gen group dst list time:  0.00010418891906738281
time for parepare:  0.0005953311920166016
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.0010685920715332031
mini_batch_src_global generation:  0.00019979476928710938
r_  generation:  0.000492095947265625
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0004622936248779297
mini_batch_src_global generation:  0.0002617835998535156
r_  generation:  0.0008189678192138672
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  8.7738037109375e-05
r_  generation:  0.0007338523864746094
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00016260147094726562
r_  generation:  0.0009050369262695312
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0008690357208251953
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  8.082389831542969e-05
r_  generation:  0.0006203651428222656
local_output_nid generation:  2.384185791015625e-05
local_in_edges_tensor generation:  0.0001518726348876953
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0005140304565429688
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.00017571449279785156
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0008797645568847656
----------------------check_connections_block total spend ----------------------------- 0.012560129165649414
generate_one_block  0.0015897750854492188
generate_one_block  0.0021572113037109375
generate_one_block  0.0043792724609375
generate_one_block  0.002039670944213867
generate_one_block  0.0022318363189697266
generate_one_block  0.001965045928955078
generate_one_block  0.0016207695007324219
generate_one_block  0.001985311508178711
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009747505187988281  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21820.90625, 'VmHWM': 4617.48046875, 'VmRSS': 4617.421875}
connection checking time:  0.01814746856689453
block generation total time  0.028888225555419922
average batch blocks generation time:  0.0036110281944274902
block dataloader generation time/epoch 53.78136706352234
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006228923797607422  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21821.42578125, 'VmHWM': 4618.00390625, 'VmRSS': 4618.00390625}
torch.Size([624, 1433])
torch.Size([215, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006478309631347656  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21821.42578125, 'VmHWM': 4618.00390625, 'VmRSS': 4618.00390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009663105010986328  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.0546875, 'VmHWM': 4619.8515625, 'VmRSS': 4619.8515625}
torch.Size([1105, 1433])
torch.Size([451, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010169029235839844  GigaBytes
Max Memory Allocated: 0.01329183578491211  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.0546875, 'VmHWM': 4619.8515625, 'VmRSS': 4619.8515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008492469787597656  GigaBytes
Max Memory Allocated: 0.015223503112792969  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.0546875, 'VmHWM': 4620.46875, 'VmRSS': 4620.46875}
torch.Size([1046, 1433])
torch.Size([389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008910655975341797  GigaBytes
Max Memory Allocated: 0.015223503112792969  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.0546875, 'VmHWM': 4620.47265625, 'VmRSS': 4620.47265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009665966033935547  GigaBytes
Max Memory Allocated: 0.015223503112792969  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.1875, 'VmHWM': 4620.76953125, 'VmRSS': 4620.76953125}
torch.Size([1129, 1433])
torch.Size([459, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.01016378402709961  GigaBytes
Max Memory Allocated: 0.015223503112792969  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.1875, 'VmHWM': 4620.76953125, 'VmRSS': 4620.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00929117202758789  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.546875, 'VmHWM': 4621.27734375, 'VmRSS': 4621.27734375}
torch.Size([1195, 1433])
torch.Size([480, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009799480438232422  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.546875, 'VmHWM': 4621.27734375, 'VmRSS': 4621.27734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007931709289550781  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.546875, 'VmHWM': 4621.27734375, 'VmRSS': 4621.27734375}
torch.Size([942, 1433])
torch.Size([347, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00830221176147461  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.546875, 'VmHWM': 4621.27734375, 'VmRSS': 4621.27734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007342815399169922  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.546875, 'VmHWM': 4621.27734375, 'VmRSS': 4621.27734375}
torch.Size([832, 1433])
torch.Size([252, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007637977600097656  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.546875, 'VmHWM': 4621.27734375, 'VmRSS': 4621.27734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00943613052368164  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.6953125, 'VmHWM': 4621.2890625, 'VmRSS': 4621.2890625}
torch.Size([1222, 1433])
torch.Size([494, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009981632232666016  GigaBytes
Max Memory Allocated: 0.016018390655517578  GigaBytes

{'VmPeak': 21884.90625, 'VmSize': 21824.6796875, 'VmHWM': 4621.2890625, 'VmRSS': 4621.28125}
{'VmPeak': 21884.90625, 'VmSize': 21824.6796875, 'VmHWM': 4621.2890625, 'VmRSS': 4621.28125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013126671314239502 |0.0006309151649475098 |0.0049751996994018555 |0.00019615888595581055 |0.002323538064956665 |0.0018532276153564453 |
----------------------------------------------------------pseudo_mini_loss sum 2.2108640670776367
{'VmPeak': 21884.90625, 'VmSize': 21824.6796875, 'VmHWM': 4621.2890625, 'VmRSS': 4621.28125}
Total (block generation + training)time/epoch 53.96820640563965
Training time/epoch 0.1866161823272705
Training time without block to device /epoch 0.18156886100769043
Training time without total dataloading part /epoch 0.061812400817871094
load block tensor time/epoch 0.10501337051391602
block to device time/epoch 0.005047321319580078
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11919
Number of first layer input nodes during this epoch:  8095
