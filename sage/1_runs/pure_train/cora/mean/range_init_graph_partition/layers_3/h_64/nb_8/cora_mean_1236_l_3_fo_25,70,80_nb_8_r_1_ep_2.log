main start at this time 1648607784.6090097
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20929.921875, 'VmSize': 20929.921875, 'VmHWM': 3613.53125, 'VmRSS': 3613.53125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0015361309051513672
global_2_local 8.296966552734375e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.030632019042969e-05
before graph partition 
		98, 85, 83, 135, 87, 77, 117, 69, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020575523376464844
	Initialize BitList time :  1.2636184692382812e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 98, 85

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
	walk terminate 1 spend time 4.629901170730591
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 98, 83, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00038123130798339844
	Initialize BitList time :  3.0279159545898438e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 98, 83

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
	walk terminate 1 spend time 4.644337892532349
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 98, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047206878662109375
	Initialize BitList time :  3.910064697265625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 98, 135

	before terminate 1 the average redundancy rate is:  1.4472049689440993
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.2173913043478262,  1.6770186335403727
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 4.690288782119751
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 4.572411298751831
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		85, 83, 87, 145, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004742145538330078
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 145, 87

	before terminate 1 the average redundancy rate is:  1.4409937888198758
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
	walk terminate 1 spend time 4.774840593338013
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 145, 77, 117, 69, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 18, 21, 18, 18, 14, 


	preparing two sides time :  0.0005011558532714844
	Initialize BitList time :  3.814697265625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 145, 77

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
	walk terminate 1 spend time 4.675992727279663
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 145, 117, 69, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 18, 18, 21, 18, 14, 


	preparing two sides time :  0.0004756450653076172
	Initialize BitList time :  4.1961669921875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 145, 117

	before terminate 1 the average redundancy rate is:  1.627329192546584
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
	walk terminate 1 spend time 4.762315034866333
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 145, 69, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 18, 18, 18, 21, 14, 


	preparing two sides time :  0.0004558563232421875
	Initialize BitList time :  3.981590270996094e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 145, 69

	before terminate 1 the average redundancy rate is:  1.329192546583851
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
	walk terminate 1 spend time 4.818049669265747
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 69, 145, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 37.59339118003845
partition_len_list
[85, 83, 87, 87, 77, 117, 69, 145]
range_init_graph_partition selection method range initialization spend 37.59391641616821
time for parepare:  0.0001761913299560547
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.000896453857421875
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.016691923141479492
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011420249938964844
mini_batch_src_global generation:  2.2172927856445312e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010347366333007812
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010371208190917969
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.482269287109375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  6.461143493652344e-05
----------------------check_connections_block total spend ----------------------------- 0.020184040069580078
generate_one_block  0.011200428009033203
generate_one_block  0.0014374256134033203
generate_one_block  0.0010995864868164062
generate_one_block  0.0011317729949951172
generate_one_block  0.0011663436889648438
generate_one_block  0.001161813735961914
generate_one_block  0.0011219978332519531
generate_one_block  0.001180410385131836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011296272277832031
gen group dst list time:  9.870529174804688e-05
time for parepare:  0.00039696693420410156
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0003075599670410156
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0002772808074951172
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00021219253540039062
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002300739288330078
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00022935867309570312
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00017571449279785156
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0003273487091064453
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00016617774963378906
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0003333091735839844
----------------------check_connections_block total spend ----------------------------- 0.004736185073852539
generate_one_block  0.001863241195678711
generate_one_block  0.0013585090637207031
generate_one_block  0.001390218734741211
generate_one_block  0.0013549327850341797
generate_one_block  0.006079196929931641
generate_one_block  0.0014977455139160156
generate_one_block  0.0011887550354003906
generate_one_block  0.001394033432006836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.000682830810546875
gen group dst list time:  0.00010132789611816406
time for parepare:  0.0004875659942626953
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.0004706382751464844
mini_batch_src_global generation:  0.00028014183044433594
r_  generation:  0.0008111000061035156
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.00021791458129882812
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0007340908050537109
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.0001685619354248047
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0007767677307128906
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016999244689941406
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.0007138252258300781
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00015807151794433594
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0005593299865722656
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0001995563507080078
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0010995864868164062
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.000606536865234375
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  9.751319885253906e-05
r_  generation:  0.0010120868682861328
----------------------check_connections_block total spend ----------------------------- 0.011747598648071289
generate_one_block  0.0019769668579101562
generate_one_block  0.0018525123596191406
generate_one_block  0.003396272659301758
generate_one_block  0.0019927024841308594
generate_one_block  0.0017313957214355469
generate_one_block  0.0024404525756835938
generate_one_block  0.0018148422241210938
generate_one_block  0.0023462772369384766
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20935.609375, 'VmSize': 20783.9765625, 'VmHWM': 3620.71484375, 'VmRSS': 3620.71484375}
connection checking time:  0.016483783721923828
block generation total time  0.03367805480957031
average batch blocks generation time:  0.004209756851196289
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.007004737854003906  GigaBytes
Max Memory Allocated: 0.007004737854003906  GigaBytes

{'VmPeak': 21009.59375, 'VmSize': 21009.59375, 'VmHWM': 3911.75, 'VmRSS': 3911.75}
torch.Size([1172, 1433])
torch.Size([493, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007508277893066406  GigaBytes
Max Memory Allocated: 0.007659435272216797  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21753.421875, 'VmHWM': 4609.35546875, 'VmRSS': 4609.35546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006709098815917969  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21758.84765625, 'VmHWM': 4615.26953125, 'VmRSS': 4615.26953125}
torch.Size([982, 1433])
torch.Size([370, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007110595703125  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21758.84765625, 'VmHWM': 4615.26953125, 'VmRSS': 4615.26953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006262779235839844  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21758.84765625, 'VmHWM': 4615.98828125, 'VmRSS': 4615.98828125}
torch.Size([898, 1433])
torch.Size([398, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006692409515380859  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21758.84765625, 'VmHWM': 4615.98828125, 'VmRSS': 4615.98828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0069751739501953125  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21759.12109375, 'VmHWM': 4616.87890625, 'VmRSS': 4616.87890625}
torch.Size([1032, 1433])
torch.Size([439, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007434368133544922  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21759.12109375, 'VmHWM': 4616.87890625, 'VmRSS': 4616.87890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006256103515625  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21759.12109375, 'VmHWM': 4617.23046875, 'VmRSS': 4617.23046875}
torch.Size([898, 1433])
torch.Size([322, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006609439849853516  GigaBytes
Max Memory Allocated: 0.012944221496582031  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21759.12109375, 'VmHWM': 4617.23046875, 'VmRSS': 4617.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009155750274658203  GigaBytes
Max Memory Allocated: 0.013916015625  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.06640625, 'VmRSS': 4619.06640625}
torch.Size([1438, 1433])
torch.Size([657, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009829998016357422  GigaBytes
Max Memory Allocated: 0.013916015625  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.06640625, 'VmRSS': 4619.06640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006481170654296875  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.11328125, 'VmRSS': 4619.11328125}
torch.Size([940, 1433])
torch.Size([321, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006827354431152344  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.11328125, 'VmRSS': 4619.11328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.0084075927734375  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.48046875, 'VmRSS': 4619.48046875}
torch.Size([1298, 1433])
torch.Size([574, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009045124053955078  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.48046875, 'VmRSS': 4619.48046875}
{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.484375, 'VmRSS': 4619.484375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009231269359588623 |0.046572715044021606 |0.10036492347717285 |0.00015681982040405273 |0.0031906068325042725 |0.0026557445526123047 |
----------------------------------------------------------pseudo_mini_loss sum 3.3960213661193848
{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.859375, 'VmRSS': 4619.859375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12982
Number of first layer input nodes during this epoch:  8658
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009926795959472656  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21762.78125, 'VmSize': 21761.33984375, 'VmHWM': 4619.859375, 'VmRSS': 4619.859375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00046896934509277344
global_2_local 7.367134094238281e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.2928924560546875e-05
before graph partition 
		90, 105, 117, 83, 105, 99, 73, 75, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0001957416534423828
	Initialize BitList time :  1.1682510375976562e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 90, 105

	before terminate 1 the average redundancy rate is:  1.2111801242236024
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  1
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
	walk terminate 1 spend time 5.464844703674316
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
	walk terminate 1 spend time 5.427242994308472
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 127, 117, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				13, 23, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047588348388671875
	Initialize BitList time :  4.458427429199219e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 127, 117

	before terminate 1 the average redundancy rate is:  1.5155279503105592
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.4161490683229814,  1.6024844720496894
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.6273291925465838,  1.3788819875776397
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.5031055900621118,  1.5031055900621118
	walk terminate 1 spend time 5.7139668464660645
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.3788819875776397,  1.639751552795031
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
	walk terminate 1 spend time 5.565157890319824
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 120, 124, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				13, 21, 20, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004711151123046875
	Initialize BitList time :  4.458427429199219e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 124, 83

	before terminate 1 the average redundancy rate is:  1.2857142857142856
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 5.536267518997192
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 124, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				13, 21, 18, 20, 18, 18, 18, 14, 


	preparing two sides time :  0.0004706382751464844
	Initialize BitList time :  4.8160552978515625e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 124, 105

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.546562910079956
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.441562175750732
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		61, 120, 83, 103, 123, 99, 73, 75, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				13, 21, 18, 15, 23, 18, 18, 14, 


	preparing two sides time :  0.0006196498870849609
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 123, 99

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
	walk terminate 1 spend time 5.487973928451538
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 123, 73, 75, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				13, 21, 18, 15, 18, 23, 18, 14, 


	preparing two sides time :  0.00048351287841796875
	Initialize BitList time :  4.410743713378906e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 123, 73

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
	walk terminate 1 spend time 5.622313022613525
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 123, 75, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				13, 21, 18, 15, 18, 18, 23, 14, 


	preparing two sides time :  0.0005013942718505859
	Initialize BitList time :  9.870529174804688e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 123, 75

	before terminate 1 the average redundancy rate is:  1.2298136645962732
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
	walk terminate 1 spend time 5.511674404144287
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 75, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 55.34481072425842
partition_len_list
[61, 120, 83, 103, 99, 73, 75, 123]
range_init_graph_partition selection method range initialization spend 55.34526610374451
time for parepare:  0.00015974044799804688
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.0013110637664794922
mini_batch_src_global generation:  0.00011777877807617188
r_  generation:  0.00045037269592285156
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002505779266357422
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0001304149627685547
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00025081634521484375
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  7.43865966796875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002377033233642578
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00010228157043457031
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00022411346435546875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  8.225440979003906e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00023365020751953125
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.00010514259338378906
----------------------check_connections_block total spend ----------------------------- 0.005856513977050781
generate_one_block  0.019963502883911133
generate_one_block  0.0012061595916748047
generate_one_block  0.0012733936309814453
generate_one_block  0.0011322498321533203
generate_one_block  0.0010743141174316406
generate_one_block  0.001020669937133789
generate_one_block  0.0010404586791992188
generate_one_block  0.00107574462890625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014853477478027344
gen group dst list time:  7.271766662597656e-05
time for parepare:  0.0007271766662597656
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0003542900085449219
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001595020294189453
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  8.726119995117188e-05
r_  generation:  0.0003402233123779297
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00026679039001464844
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00015115737915039062
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.000339508056640625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0001246929168701172
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.00032448768615722656
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  3.4332275390625e-05
r_  generation:  0.00019621849060058594
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  0.0001742839813232422
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002808570861816406
----------------------check_connections_block total spend ----------------------------- 0.005321979522705078
generate_one_block  0.0012178421020507812
generate_one_block  0.0014920234680175781
generate_one_block  0.0012879371643066406
generate_one_block  0.0013604164123535156
generate_one_block  0.0013737678527832031
generate_one_block  0.0012669563293457031
generate_one_block  0.0013041496276855469
generate_one_block  0.0015876293182373047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001373291015625
gen group dst list time:  0.00010371208190917969
time for parepare:  0.0003199577331542969
local_output_nid generation:  2.002716064453125e-05
local_in_edges_tensor generation:  0.00035452842712402344
mini_batch_src_global generation:  6.699562072753906e-05
r_  generation:  0.0005066394805908203
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.0001239776611328125
r_  generation:  0.000835418701171875
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007789134979248047
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0008652210235595703
local_output_nid generation:  4.363059997558594e-05
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0009152889251708984
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016450881958007812
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.0006613731384277344
local_output_nid generation:  2.5987625122070312e-05
local_in_edges_tensor generation:  0.00014829635620117188
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0005412101745605469
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  9.059906005859375e-05
r_  generation:  0.0009093284606933594
----------------------check_connections_block total spend ----------------------------- 0.01068878173828125
generate_one_block  0.006348848342895508
generate_one_block  0.0019009113311767578
generate_one_block  0.0018374919891357422
generate_one_block  0.0019474029541015625
generate_one_block  0.001985788345336914
generate_one_block  0.0017147064208984375
generate_one_block  0.0019698143005371094
generate_one_block  0.003215312957763672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009926795959472656  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4620.94140625, 'VmRSS': 4620.84375}
connection checking time:  0.016010761260986328
block generation total time  0.03181099891662598
average batch blocks generation time:  0.003976374864578247
block dataloader generation time/epoch 55.441988468170166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.006337642669677734  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.23828125, 'VmRSS': 4621.23828125}
torch.Size([644, 1433])
torch.Size([235, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.006604671478271484  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.2421875, 'VmRSS': 4621.2421875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.0098419189453125  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.24609375, 'VmRSS': 4621.24609375}
torch.Size([1158, 1433])
torch.Size([512, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.01039743423461914  GigaBytes
Max Memory Allocated: 0.014140129089355469  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.24609375, 'VmRSS': 4621.24609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008889198303222656  GigaBytes
Max Memory Allocated: 0.01579427719116211  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.24609375, 'VmRSS': 4621.24609375}
torch.Size([1120, 1433])
torch.Size([460, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009363651275634766  GigaBytes
Max Memory Allocated: 0.01579427719116211  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.24609375, 'VmRSS': 4621.24609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009536266326904297  GigaBytes
Max Memory Allocated: 0.01579427719116211  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.24609375, 'VmRSS': 4621.24609375}
torch.Size([1186, 1433])
torch.Size([501, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010067462921142578  GigaBytes
Max Memory Allocated: 0.01579427719116211  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.60546875, 'VmHWM': 4621.24609375, 'VmRSS': 4621.24609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009763717651367188  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
torch.Size([1283, 1433])
torch.Size([556, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010334968566894531  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008458137512207031  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
torch.Size([1040, 1433])
torch.Size([413, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008883476257324219  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007670402526855469  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
torch.Size([893, 1433])
torch.Size([292, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007999420166015625  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009960174560546875  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
torch.Size([1320, 1433])
torch.Size([552, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010552406311035156  GigaBytes
Max Memory Allocated: 0.016357421875  GigaBytes

{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013947337865829468 |0.000693589448928833 |0.005306333303451538 |0.0001977384090423584 |0.0024097561836242676 |0.0021157264709472656 |
----------------------------------------------------------pseudo_mini_loss sum 2.2352521419525146
{'VmPeak': 21889.35546875, 'VmSize': 21825.58984375, 'VmHWM': 4621.24609375, 'VmRSS': 4621.23828125}
Total (block generation + training)time/epoch 55.639045000076294
Training time/epoch 0.19680190086364746
Training time without block to device /epoch 0.1912531852722168
Training time without total dataloading part /epoch 0.06542634963989258
load block tensor time/epoch 0.11157870292663574
block to device time/epoch 0.005548715591430664
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12902
Number of first layer input nodes during this epoch:  8644
