main start at this time 1648606990.533674
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20805.24609375, 'VmSize': 20802.15625, 'VmHWM': 3613.8125, 'VmRSS': 3613.8125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0008208751678466797
global_2_local 7.677078247070312e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.245208740234375e-05
before graph partition 
		98, 85, 83, 135, 87, 77, 117, 69, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002129077911376953
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 98, 85

	before terminate 1 the average redundancy rate is:  1.1366459627329193
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2173913043478262,  1.0559006211180124
	walk terminate 1 spend time 4.596747398376465
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 98, 83, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004792213439941406
	Initialize BitList time :  3.24249267578125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 98, 83

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.2173913043478262,  1.031055900621118
	walk terminate 1 spend time 4.913459777832031
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 98, 135, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048470497131347656
	Initialize BitList time :  3.2901763916015625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 98, 135

	before terminate 1 the average redundancy rate is:  1.4472049689440993
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.2173913043478262,  1.6770186335403727
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 4.683127403259277
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.0807453416149069,  1.8012422360248448
	walk terminate 1 spend time 4.42876672744751
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		85, 83, 87, 145, 87, 77, 117, 69, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004799365997314453
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 145, 87

	before terminate 1 the average redundancy rate is:  1.4409937888198758
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.8012422360248448,  1.0807453416149069
	walk terminate 1 spend time 4.9132678508758545
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 145, 77, 117, 69, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 18, 21, 18, 18, 14, 


	preparing two sides time :  0.00041413307189941406
	Initialize BitList time :  3.0517578125e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 145, 77

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.8012422360248448,  0.9565217391304348
	walk terminate 1 spend time 4.430370092391968
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 145, 117, 69, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 18, 18, 21, 18, 14, 


	preparing two sides time :  0.00030875205993652344
	Initialize BitList time :  2.288818359375e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 145, 117

	before terminate 1 the average redundancy rate is:  1.627329192546584
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.627329192546584,  1.8012422360248448,  1.453416149068323
	walk terminate 1 spend time 4.433384895324707
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 145, 69, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 18, 18, 18, 21, 14, 


	preparing two sides time :  0.0004677772521972656
	Initialize BitList time :  3.62396240234375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 145, 69

	before terminate 1 the average redundancy rate is:  1.329192546583851
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.329192546583851,  1.8012422360248448,  0.8571428571428571
	walk terminate 1 spend time 4.50153112411499
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		85, 83, 87, 87, 77, 117, 69, 145, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 36.92480993270874
partition_len_list
[85, 83, 87, 87, 77, 117, 69, 145]
range_init_graph_partition selection method range initialization spend 36.92531943321228
time for parepare:  0.0001742839813232422
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0010144710540771484
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.01540684700012207
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0002880096435546875
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  5.698204040527344e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  7.915496826171875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010728836059570312
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.0067901611328125e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010585784912109375
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  7.295608520507812e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  6.556510925292969e-05
----------------------check_connections_block total spend ----------------------------- 0.019237279891967773
generate_one_block  0.012097597122192383
generate_one_block  0.0013196468353271484
generate_one_block  0.0009992122650146484
generate_one_block  0.0010151863098144531
generate_one_block  0.0010502338409423828
generate_one_block  0.0010364055633544922
generate_one_block  0.0010018348693847656
generate_one_block  0.0010662078857421875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0023162364959716797
gen group dst list time:  9.870529174804688e-05
time for parepare:  0.0005967617034912109
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.00029754638671875
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0002796649932861328
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0002684593200683594
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00025200843811035156
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002739429473876953
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.000179290771484375
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0003046989440917969
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00016069412231445312
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00032329559326171875
----------------------check_connections_block total spend ----------------------------- 0.005123615264892578
generate_one_block  0.0013387203216552734
generate_one_block  0.0012776851654052734
generate_one_block  0.0013191699981689453
generate_one_block  0.0012938976287841797
generate_one_block  0.001255035400390625
generate_one_block  0.0017542839050292969
generate_one_block  0.001224517822265625
generate_one_block  0.004331350326538086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006737709045410156
gen group dst list time:  0.00010156631469726562
time for parepare:  0.0005223751068115234
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.00039315223693847656
mini_batch_src_global generation:  0.00023484230041503906
r_  generation:  0.0007190704345703125
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  0.00018334388732910156
r_  generation:  0.0006856918334960938
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  8.273124694824219e-05
r_  generation:  0.0007376670837402344
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  7.414817810058594e-05
r_  generation:  0.0006113052368164062
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015425682067871094
mini_batch_src_global generation:  6.461143493652344e-05
r_  generation:  0.0004925727844238281
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  9.775161743164062e-05
r_  generation:  0.0010061264038085938
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0005686283111572266
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.0001823902130126953
mini_batch_src_global generation:  9.799003601074219e-05
r_  generation:  0.0009868144989013672
----------------------check_connections_block total spend ----------------------------- 0.011114358901977539
generate_one_block  0.0019752979278564453
generate_one_block  0.0018451213836669922
generate_one_block  0.0018846988677978516
generate_one_block  0.0017609596252441406
generate_one_block  0.0016200542449951172
generate_one_block  0.0022830963134765625
generate_one_block  0.0042455196380615234
generate_one_block  0.007125377655029297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20807.296875, 'VmSize': 20656.2578125, 'VmHWM': 3620.76953125, 'VmRSS': 3620.76953125}
connection checking time:  0.016237974166870117
block generation total time  0.036534786224365234
average batch blocks generation time:  0.004566848278045654
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.006404399871826172  GigaBytes
Max Memory Allocated: 0.006404399871826172  GigaBytes

{'VmPeak': 21005.453125, 'VmSize': 20977.67578125, 'VmHWM': 3911.86328125, 'VmRSS': 3911.86328125}
torch.Size([1060, 1433])
torch.Size([416, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006844520568847656  GigaBytes
Max Memory Allocated: 0.006974697113037109  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21749.09375, 'VmHWM': 4604.984375, 'VmRSS': 4604.984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006596088409423828  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4611.0078125, 'VmRSS': 4611.0078125}
torch.Size([961, 1433])
torch.Size([346, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006978034973144531  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4611.0078125, 'VmRSS': 4611.0078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0071258544921875  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4611.9296875, 'VmRSS': 4611.9296875}
torch.Size([884, 1433])
torch.Size([381, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007540225982666016  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4611.9296875, 'VmRSS': 4611.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0061779022216796875  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4612.765625, 'VmRSS': 4612.765625}
torch.Size([883, 1433])
torch.Size([355, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006569385528564453  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4612.765625, 'VmRSS': 4612.765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005629539489746094  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4613.00390625, 'VmRSS': 4613.00390625}
torch.Size([781, 1433])
torch.Size([262, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005934238433837891  GigaBytes
Max Memory Allocated: 0.012234687805175781  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21754.41015625, 'VmHWM': 4613.00390625, 'VmRSS': 4613.00390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008602142333984375  GigaBytes
Max Memory Allocated: 0.012741565704345703  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.37890625, 'VmRSS': 4614.37890625}
torch.Size([1335, 1433])
torch.Size([575, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009207725524902344  GigaBytes
Max Memory Allocated: 0.012741565704345703  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.37890625, 'VmRSS': 4614.37890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006122589111328125  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.4921875, 'VmRSS': 4614.4921875}
torch.Size([873, 1433])
torch.Size([284, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006438255310058594  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.4921875, 'VmRSS': 4614.4921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008193016052246094  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.63671875, 'VmRSS': 4614.63671875}
torch.Size([1258, 1433])
torch.Size([532, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008797168731689453  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.63671875, 'VmRSS': 4614.63671875}
{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4614.640625, 'VmRSS': 4614.640625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007208734750747681 |0.04700958728790283 |0.10308486223220825 |0.00016480684280395508 |0.002720057964324951 |0.0025599002838134766 |
----------------------------------------------------------pseudo_mini_loss sum 3.350048303604126
{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4615.078125, 'VmRSS': 4615.078125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11936
Number of first layer input nodes during this epoch:  8035
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009709835052490234  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21766.8046875, 'VmSize': 21756.45703125, 'VmHWM': 4615.078125, 'VmRSS': 4615.078125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004839897155761719
global_2_local 7.62939453125e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.4836273193359375e-05
before graph partition 
		90, 105, 117, 83, 105, 99, 73, 75, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021076202392578125
	Initialize BitList time :  1.1920928955078125e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 90, 105

	before terminate 1 the average redundancy rate is:  1.2111801242236024
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.1428571428571428,  1.2173913043478262
						 current side  1
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
	walk terminate 1 spend time 5.403544902801514
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024843,  1.2422360248447204,  1.1180124223602483
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.5776397515527951,  0.7577639751552795
	walk terminate 1 spend time 5.488091468811035
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 127, 117, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				13, 23, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003914833068847656
	Initialize BitList time :  3.409385681152344e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 127, 117

	before terminate 1 the average redundancy rate is:  1.5155279503105592
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.4161490683229814,  1.6024844720496894
						 current side  1
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.6273291925465838,  1.3788819875776397
						 current side  0
			 redundancy will reduce  0.01242236024844745
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5031055900621118,  1.5031055900621118,  1.5031055900621118
	walk terminate 1 spend time 5.500658988952637
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.3788819875776397,  1.639751552795031
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.515527950310559,  1.5403726708074534,  1.4906832298136645
	walk terminate 1 spend time 5.800231218338013
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		61, 120, 124, 83, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				13, 21, 20, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004787445068359375
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 124, 83

	before terminate 1 the average redundancy rate is:  1.2857142857142856
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.5403726708074534,  1.031055900621118
	walk terminate 1 spend time 5.53634786605835
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 124, 105, 99, 73, 75, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				13, 21, 18, 20, 18, 18, 18, 14, 


	preparing two sides time :  0.00048828125
	Initialize BitList time :  4.601478576660156e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 124, 105

	before terminate 1 the average redundancy rate is:  1.4223602484472049
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4099378881987579,  1.4037267080745341,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.522146463394165
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.279503105590062,  1.5279503105590062
	walk terminate 1 spend time 5.526553392410278
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		61, 120, 83, 103, 123, 99, 73, 75, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				13, 21, 18, 15, 23, 18, 18, 14, 


	preparing two sides time :  0.00026917457580566406
	Initialize BitList time :  2.47955322265625e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 123, 99

	before terminate 1 the average redundancy rate is:  1.37888198757764
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.37888198757764,  1.5279503105590062,  1.2298136645962734
	walk terminate 1 spend time 5.847677230834961
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 123, 73, 75, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				13, 21, 18, 15, 18, 23, 18, 14, 


	preparing two sides time :  0.0004928112030029297
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 123, 73

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2173913043478262,  1.5279503105590062,  0.906832298136646
	walk terminate 1 spend time 5.559582471847534
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 123, 75, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				13, 21, 18, 15, 18, 18, 23, 14, 


	preparing two sides time :  0.0002760887145996094
	Initialize BitList time :  2.5033950805664062e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 123, 75

	before terminate 1 the average redundancy rate is:  1.2298136645962732
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.5279503105590062,  0.9316770186335404
	walk terminate 1 spend time 5.688981533050537
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		61, 120, 83, 103, 99, 73, 75, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 55.90460252761841
partition_len_list
[61, 120, 83, 103, 99, 73, 75, 123]
range_init_graph_partition selection method range initialization spend 55.905295610427856
time for parepare:  0.0001468658447265625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0010120868682861328
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.00037932395935058594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  3.6716461181640625e-05
r_  generation:  0.00010633468627929688
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  8.7738037109375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00022149085998535156
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.031990051269531e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  5.5789947509765625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00018644332885742188
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.00010728836059570312
----------------------check_connections_block total spend ----------------------------- 0.005007266998291016
generate_one_block  0.02858757972717285
generate_one_block  0.0011792182922363281
generate_one_block  0.0013496875762939453
generate_one_block  0.0010573863983154297
generate_one_block  0.0009906291961669922
generate_one_block  0.0009720325469970703
generate_one_block  0.0009751319885253906
generate_one_block  0.001010894775390625
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019426345825195312
gen group dst list time:  7.43865966796875e-05
time for parepare:  0.0006811618804931641
local_output_nid generation:  4.3392181396484375e-05
local_in_edges_tensor generation:  0.0004391670227050781
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0001609325408935547
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.00031185150146484375
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002582073211669922
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  6.628036499023438e-05
r_  generation:  0.0003159046173095703
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00024700164794921875
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.00018715858459472656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  0.00016236305236816406
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.000278472900390625
----------------------check_connections_block total spend ----------------------------- 0.005328655242919922
generate_one_block  0.001209259033203125
generate_one_block  0.0013518333435058594
generate_one_block  0.0012700557708740234
generate_one_block  0.0014307498931884766
generate_one_block  0.0014777183532714844
generate_one_block  0.0012745857238769531
generate_one_block  0.0013289451599121094
generate_one_block  0.012742280960083008
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01633596420288086
gen group dst list time:  0.00010585784912109375
time for parepare:  0.0007271766662597656
local_output_nid generation:  3.0040740966796875e-05
local_in_edges_tensor generation:  0.1352250576019287
mini_batch_src_global generation:  0.00030803680419921875
r_  generation:  0.0009131431579589844
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.0004150867462158203
mini_batch_src_global generation:  0.00021696090698242188
r_  generation:  0.0011534690856933594
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0003025531768798828
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.001012563705444336
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.00028395652770996094
mini_batch_src_global generation:  0.00014090538024902344
r_  generation:  0.0012984275817871094
local_output_nid generation:  7.510185241699219e-05
local_in_edges_tensor generation:  0.00030422210693359375
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.001302957534790039
local_output_nid generation:  5.626678466796875e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.00011420249938964844
r_  generation:  0.0009260177612304688
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  9.942054748535156e-05
r_  generation:  0.0007832050323486328
local_output_nid generation:  6.4849853515625e-05
local_in_edges_tensor generation:  0.0002627372741699219
mini_batch_src_global generation:  0.00012922286987304688
r_  generation:  0.0013210773468017578
----------------------check_connections_block total spend ----------------------------- 0.15115928649902344
generate_one_block  0.002800464630126953
generate_one_block  0.0022253990173339844
generate_one_block  0.001986265182495117
generate_one_block  0.00212860107421875
generate_one_block  0.002084016799926758
generate_one_block  0.0018284320831298828
generate_one_block  0.0017325878143310547
generate_one_block  0.0022215843200683594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009709835052490234  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21820.72265625, 'VmHWM': 4616.26953125, 'VmRSS': 4616.26953125}
connection checking time:  0.15648794174194336
block generation total time  0.0390927791595459
average batch blocks generation time:  0.004886597394943237
block dataloader generation time/epoch 56.17720913887024
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.0061435699462890625  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21820.83984375, 'VmHWM': 4616.52734375, 'VmRSS': 4616.51953125}
torch.Size([608, 1433])
torch.Size([216, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.006392955780029297  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21820.83984375, 'VmHWM': 4616.52734375, 'VmRSS': 4616.51953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009625434875488281  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21823.48046875, 'VmHWM': 4618.25, 'VmRSS': 4618.25}
torch.Size([1091, 1433])
torch.Size([454, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010132789611816406  GigaBytes
Max Memory Allocated: 0.013232707977294922  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21823.48046875, 'VmHWM': 4618.25, 'VmRSS': 4618.25}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008448600769042969  GigaBytes
Max Memory Allocated: 0.01514291763305664  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21823.48046875, 'VmHWM': 4618.640625, 'VmRSS': 4618.640625}
torch.Size([1038, 1433])
torch.Size([389, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008865833282470703  GigaBytes
Max Memory Allocated: 0.01514291763305664  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21823.48046875, 'VmHWM': 4618.640625, 'VmRSS': 4618.640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.0096282958984375  GigaBytes
Max Memory Allocated: 0.01514291763305664  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21823.66015625, 'VmHWM': 4618.84765625, 'VmRSS': 4618.84765625}
torch.Size([1124, 1433])
torch.Size([459, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010126113891601562  GigaBytes
Max Memory Allocated: 0.01514291763305664  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21823.66015625, 'VmHWM': 4618.84765625, 'VmRSS': 4618.84765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009371280670166016  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.12890625, 'VmHWM': 4619.265625, 'VmRSS': 4619.265625}
torch.Size([1210, 1433])
torch.Size([482, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.00988149642944336  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.12890625, 'VmHWM': 4619.265625, 'VmRSS': 4619.265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007926464080810547  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.12890625, 'VmHWM': 4619.5078125, 'VmRSS': 4619.5078125}
torch.Size([941, 1433])
torch.Size([347, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008296966552734375  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.12890625, 'VmHWM': 4619.5078125, 'VmRSS': 4619.5078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007369518280029297  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.12890625, 'VmHWM': 4619.5078125, 'VmRSS': 4619.5078125}
torch.Size([837, 1433])
torch.Size([257, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007670402526855469  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.12890625, 'VmHWM': 4619.5078125, 'VmRSS': 4619.5078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009532451629638672  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.29296875, 'VmHWM': 4619.80859375, 'VmRSS': 4619.80859375}
torch.Size([1240, 1433])
torch.Size([498, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010081291198730469  GigaBytes
Max Memory Allocated: 0.016060829162597656  GigaBytes

{'VmPeak': 21884.47265625, 'VmSize': 21824.29296875, 'VmHWM': 4619.80859375, 'VmRSS': 4619.80859375}
{'VmPeak': 21884.47265625, 'VmSize': 21824.29296875, 'VmHWM': 4619.8125, 'VmRSS': 4619.8125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003203362226486206 |0.0004343390464782715 |0.003463655710220337 |0.0001289844512939453 |0.0021115243434906006 |0.0016202926635742188 |
----------------------------------------------------------pseudo_mini_loss sum 2.2669644355773926
{'VmPeak': 21884.47265625, 'VmSize': 21824.29296875, 'VmHWM': 4619.8125, 'VmRSS': 4619.8125}
Total (block generation + training)time/epoch 56.263816118240356
Training time/epoch 0.08621668815612793
Training time without block to device /epoch 0.08274197578430176
Training time without total dataloading part /epoch 0.04725360870361328
load block tensor time/epoch 0.02562689781188965
block to device time/epoch 0.003474712371826172
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11928
Number of first layer input nodes during this epoch:  8089
