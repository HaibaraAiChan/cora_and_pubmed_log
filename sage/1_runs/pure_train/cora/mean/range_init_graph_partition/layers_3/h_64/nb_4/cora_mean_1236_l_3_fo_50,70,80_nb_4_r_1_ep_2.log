main start at this time 1648608113.4439027
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20899.24609375, 'VmSize': 20899.24609375, 'VmHWM': 3614.19140625, 'VmRSS': 3614.19140625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014355182647705078
global_2_local 9.799003601074219e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.7220458984375e-05
before graph partition 
		177, 202, 156, 193, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00021314620971679688
	Initialize BitList time :  1.33514404296875e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 177, 202

	before terminate 1 the average redundancy rate is:  1.1770186335403725
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.009316770186335255
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1677018633540373,  1.2236024844720497,  1.1118012422360248
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1645962732919255,  1.0869565217391304,  1.2422360248447204
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.186335403726708,  1.15527950310559
	walk terminate 1 spend time 4.5144877433776855
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.170807453416149,  1.173913043478261,  1.1677018633540373
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.279503105590062,  1.0683229813664596
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1739130434782608,  1.0993788819875776,  1.2484472049689441
	walk terminate 1 spend time 4.760093927383423
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		177, 201, 156, 193, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				38, 32, 35, 35, 


	preparing two sides time :  0.0007240772247314453
	Initialize BitList time :  3.2901763916015625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 201, 156

	before terminate 1 the average redundancy rate is:  1.108695652173913
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.2173913043478262,  1.0
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.2422360248447204,  0.9751552795031055
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.2298136645962734,  0.9875776397515528
	walk terminate 1 spend time 4.742938280105591
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		177, 159, 198, 193, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				38, 36, 31, 35, 


	preparing two sides time :  0.0005612373352050781
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 198, 193

	before terminate 1 the average redundancy rate is:  1.2142857142857144
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2111801242236024,  1.0993788819875776,  1.3229813664596273
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2111801242236024,  1.1118012422360248,  1.31055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2111801242236024,  1.1118012422360248,  1.31055900621118
	walk terminate 1 spend time 4.6490700244903564
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2111801242236027,  1.1366459627329193,  1.2857142857142858
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2111801242236027,  1.1366459627329193,  1.2857142857142858
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2111801242236024,  1.1677018633540373,  1.2546583850931676
	walk terminate 1 spend time 4.725862741470337
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		177, 159, 188, 202, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 23.40409517288208
partition_len_list
[177, 159, 188, 202]
range_init_graph_partition selection method range initialization spend 23.404711484909058
time for parepare:  0.00016617774963378906
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00098419189453125
mini_batch_src_global generation:  0.00012946128845214844
r_  generation:  0.0158231258392334
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00015497207641601562
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  7.414817810058594e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00013518333435058594
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  6.842613220214844e-05
----------------------check_connections_block total spend ----------------------------- 0.01877880096435547
generate_one_block  0.011339902877807617
generate_one_block  0.0012042522430419922
generate_one_block  0.0011267662048339844
generate_one_block  0.0011467933654785156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019180774688720703
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.0007464885711669922
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0005552768707275391
mini_batch_src_global generation:  0.00021982192993164062
r_  generation:  0.0006568431854248047
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.00034737586975097656
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  5.14984130859375e-05
r_  generation:  0.0005586147308349609
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0002219676971435547
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0005862712860107422
----------------------check_connections_block total spend ----------------------------- 0.0052487850189208984
generate_one_block  0.0016644001007080078
generate_one_block  0.0014581680297851562
generate_one_block  0.0015561580657958984
generate_one_block  0.0016796588897705078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015811920166015625
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.0002818107604980469
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0015816688537597656
mini_batch_src_global generation:  0.0006210803985595703
r_  generation:  0.0015461444854736328
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00037384033203125
mini_batch_src_global generation:  0.0001742839813232422
r_  generation:  0.0010187625885009766
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00022292137145996094
r_  generation:  0.001506805419921875
local_output_nid generation:  7.128715515136719e-05
local_in_edges_tensor generation:  0.00043511390686035156
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.0014224052429199219
----------------------check_connections_block total spend ----------------------------- 0.011583089828491211
generate_one_block  0.0026297569274902344
generate_one_block  0.0022857189178466797
generate_one_block  0.0027234554290771484
generate_one_block  0.004546165466308594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0007228851318359375  GigaBytes
Max Memory Allocated: 0.0007228851318359375  GigaBytes

{'VmPeak': 20905.12109375, 'VmSize': 20753.26171875, 'VmHWM': 3621.08203125, 'VmRSS': 3621.08203125}
connection checking time:  0.01683187484741211
block generation total time  0.018543481826782227
average batch blocks generation time:  0.004635870456695557
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.009106159210205078  GigaBytes
Max Memory Allocated: 0.009106159210205078  GigaBytes

{'VmPeak': 20980.45703125, 'VmSize': 20980.45703125, 'VmHWM': 3912.34765625, 'VmRSS': 3912.34765625}
torch.Size([1562, 1433])
torch.Size([802, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.009966850280761719  GigaBytes
Max Memory Allocated: 0.010090351104736328  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21751.1484375, 'VmHWM': 4606.65625, 'VmRSS': 4606.65625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008685111999511719  GigaBytes
Max Memory Allocated: 0.01699209213256836  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21758.56640625, 'VmHWM': 4614.91015625, 'VmRSS': 4614.91015625}
torch.Size([1350, 1433])
torch.Size([616, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009366989135742188  GigaBytes
Max Memory Allocated: 0.01699209213256836  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21758.56640625, 'VmHWM': 4614.91015625, 'VmRSS': 4614.91015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009826183319091797  GigaBytes
Max Memory Allocated: 0.01699209213256836  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21759.64453125, 'VmHWM': 4616.125, 'VmRSS': 4616.125}
torch.Size([1547, 1433])
torch.Size([727, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010634422302246094  GigaBytes
Max Memory Allocated: 0.01699209213256836  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21759.64453125, 'VmHWM': 4616.125, 'VmRSS': 4616.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.010588645935058594  GigaBytes
Max Memory Allocated: 0.01888132095336914  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21760.50390625, 'VmHWM': 4617.27734375, 'VmRSS': 4617.27734375}
torch.Size([1704, 1433])
torch.Size([849, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.01151275634765625  GigaBytes
Max Memory Allocated: 0.01888132095336914  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21760.50390625, 'VmHWM': 4617.27734375, 'VmRSS': 4617.27734375}
{'VmPeak': 21761.609375, 'VmSize': 21760.50390625, 'VmHWM': 4617.65234375, 'VmRSS': 4617.65234375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01928424835205078 |0.0948333740234375 |0.19414019584655762 |0.00018543004989624023 |0.003607332706451416 |0.002585172653198242 |
----------------------------------------------------------pseudo_mini_loss sum 3.4906787872314453
{'VmPeak': 21761.609375, 'VmSize': 21760.50390625, 'VmHWM': 4617.65234375, 'VmRSS': 4617.65234375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9883
Number of first layer input nodes during this epoch:  6163
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012137889862060547  GigaBytes
Max Memory Allocated: 0.01888132095336914  GigaBytes

{'VmPeak': 21761.609375, 'VmSize': 21760.50390625, 'VmHWM': 4617.65234375, 'VmRSS': 4617.65234375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047206878662109375
global_2_local 7.557868957519531e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.316734313964844e-05
before graph partition 
		181, 190, 183, 164, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00022411346435546875
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 181, 190

	before terminate 1 the average redundancy rate is:  1.1521739130434783
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1521739130434783,  1.1366459627329193,  1.1677018633540373
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.0,  1.2981366459627328
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2236024844720497,  1.0683229813664596
	walk terminate 1 spend time 5.641068696975708
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.1180124223602483,  1.1677018633540373
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.2732919254658386,  1.0
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.1677018633540373,  1.124223602484472
	walk terminate 1 spend time 5.646715402603149
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		181, 188, 183, 164, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005121231079101562
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 188, 183

	before terminate 1 the average redundancy rate is:  1.1521739130434783
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1428571428571428,  1.0559006211180124,  1.2298136645962734
						 current side  1
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.186335403726708,  1.1118012422360248
						 current side  0
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1490683229813663,  1.0993788819875776,  1.1987577639751552
	walk terminate 1 spend time 5.520103216171265
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.236024844720497,  1.0559006211180124
						 current side  0
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1366459627329193,  1.124223602484472,  1.1490683229813665
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1304347826086958,  1.236024844720497,  1.0248447204968945
	walk terminate 1 spend time 5.605027675628662
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		181, 165, 199, 164, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 31, 38, 35, 


	preparing two sides time :  0.0005433559417724609
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 199, 164

	before terminate 1 the average redundancy rate is:  1.1273291925465838
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.1055900621118013,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.12111801242236,  1.1304347826086956,  1.1118012422360248
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1211180124223603,  1.0124223602484472,  1.2298136645962734
	walk terminate 1 spend time 5.686625003814697
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.1925465838509317,  1.0559006211180124
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.0993788819875776,  1.1490683229813665
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.1428571428571428,  1.1055900621118013
	walk terminate 1 spend time 5.589771509170532
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		181, 165, 178, 184, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 33.699188470840454
partition_len_list
[181, 165, 178, 184]
range_init_graph_partition selection method range initialization spend 33.69986343383789
time for parepare:  0.00022649765014648438
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0009748935699462891
mini_batch_src_global generation:  0.00018739700317382812
r_  generation:  0.0005044937133789062
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0002593994140625
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.00015974044799804688
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0002548694610595703
mini_batch_src_global generation:  4.38690185546875e-05
r_  generation:  0.00013184547424316406
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00022983551025390625
mini_batch_src_global generation:  0.0002567768096923828
r_  generation:  0.0001881122589111328
----------------------check_connections_block total spend ----------------------------- 0.0046558380126953125
generate_one_block  0.025193214416503906
generate_one_block  0.0013604164123535156
generate_one_block  0.0012581348419189453
generate_one_block  0.001482248306274414
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013895034790039062
gen group dst list time:  4.458427429199219e-05
time for parepare:  0.0006866455078125
local_output_nid generation:  1.8835067749023438e-05
local_in_edges_tensor generation:  0.001016855239868164
mini_batch_src_global generation:  0.0002079010009765625
r_  generation:  0.0006542205810546875
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.00016069412231445312
r_  generation:  0.0005381107330322266
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001621246337890625
mini_batch_src_global generation:  5.412101745605469e-05
r_  generation:  0.00039958953857421875
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0006008148193359375
----------------------check_connections_block total spend ----------------------------- 0.005705833435058594
generate_one_block  0.0016982555389404297
generate_one_block  0.0015850067138671875
generate_one_block  0.0015263557434082031
generate_one_block  0.0016024112701416016
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001634836196899414
gen group dst list time:  8.678436279296875e-05
time for parepare:  0.00030517578125
local_output_nid generation:  6.198883056640625e-05
local_in_edges_tensor generation:  0.00119781494140625
mini_batch_src_global generation:  0.0006623268127441406
r_  generation:  0.0017702579498291016
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0005879402160644531
mini_batch_src_global generation:  0.00017309188842773438
r_  generation:  0.0015110969543457031
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.00021195411682128906
mini_batch_src_global generation:  0.0001277923583984375
r_  generation:  0.001264810562133789
local_output_nid generation:  5.793571472167969e-05
local_in_edges_tensor generation:  0.0003552436828613281
mini_batch_src_global generation:  0.00023436546325683594
r_  generation:  0.0014967918395996094
----------------------check_connections_block total spend ----------------------------- 0.011988162994384766
generate_one_block  0.002878904342651367
generate_one_block  0.0037076473236083984
generate_one_block  0.0026988983154296875
generate_one_block  0.002918720245361328
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012137889862060547  GigaBytes
Max Memory Allocated: 0.01888132095336914  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.48828125, 'VmRSS': 4619.4609375}
connection checking time:  0.01769399642944336
block generation total time  0.018616199493408203
average batch blocks generation time:  0.004654049873352051
block dataloader generation time/epoch 33.78318238258362
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.01196432113647461  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.87109375, 'VmRSS': 4619.87109375}
torch.Size([1692, 1433])
torch.Size([873, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.012885093688964844  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.87109375, 'VmRSS': 4619.87109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011012077331542969  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
torch.Size([1515, 1433])
torch.Size([732, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011798381805419922  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011957168579101562  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
torch.Size([1628, 1433])
torch.Size([693, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.01272726058959961  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011502265930175781  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
torch.Size([1606, 1433])
torch.Size([749, 64])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.012323856353759766  GigaBytes
Max Memory Allocated: 0.021014690399169922  GigaBytes

{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02373403310775757 |0.0008018016815185547 |0.00556182861328125 |0.00022715330123901367 |0.003514230251312256 |0.0021898746490478516 |
----------------------------------------------------------pseudo_mini_loss sum 1.9148539304733276
{'VmPeak': 21888.51953125, 'VmSize': 21824.51953125, 'VmHWM': 4619.95703125, 'VmRSS': 4619.95703125}
Total (block generation + training)time/epoch 33.92980360984802
Training time/epoch 0.14563632011413574
Training time without block to device /epoch 0.14242911338806152
Training time without total dataloading part /epoch 0.03940272331237793
load block tensor time/epoch 0.09493613243103027
block to device time/epoch 0.0032072067260742188
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10196
Number of first layer input nodes during this epoch:  6441
