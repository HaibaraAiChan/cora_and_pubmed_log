main start at this time 1648609407.3581662
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20804.69921875, 'VmSize': 20804.69921875, 'VmHWM': 3615.90234375, 'VmRSS': 3615.90234375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009844303131103516
global_2_local 0.00011777877807617188
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  8.153915405273438e-05
before graph partition 
		83, 77, 90, 107, 139, 73, 122, 64, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0001952648162841797
	Initialize BitList time :  1.1682510375976562e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 83, 77

-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00019669532775878906
	Initialize BitList time :  8.344650268554688e-06
	getRedundancyCost: time   1.1920928955078125e-06

					length of partitions 77, 90

	before terminate 1 the average redundancy rate is:  1.0372670807453415
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
	walk terminate 1 spend time 4.618383169174194
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 77, 90, 107, 139, 73, 122, 64, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048279762268066406
	Initialize BitList time :  2.7894973754882812e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 90, 107

	before terminate 1 the average redundancy rate is:  1.2236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
	walk terminate 1 spend time 4.9229416847229
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 77, 90, 107, 139, 73, 122, 64, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002989768981933594
	Initialize BitList time :  1.8596649169921875e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 107, 139

	before terminate 1 the average redundancy rate is:  1.5279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.329192546583851,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.204968944099379,  1.8385093167701863
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
	walk terminate 1 spend time 4.774271011352539
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
	walk terminate 1 spend time 5.079792022705078
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83, 77, 90, 107, 138, 73, 122, 64, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004947185516357422
	Initialize BitList time :  3.0040740966796875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 138, 73

	before terminate 1 the average redundancy rate is:  1.31055900621118
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
	walk terminate 1 spend time 4.826374769210815
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 138, 122, 64, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003802776336669922
	Initialize BitList time :  2.4080276489257812e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 138, 122

	before terminate 1 the average redundancy rate is:  1.6149068322981366
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
	walk terminate 1 spend time 4.856360673904419
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 122, 138, 64, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004956722259521484
	Initialize BitList time :  2.7894973754882812e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 138, 64

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
	walk terminate 1 spend time 4.7536070346832275
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 122, 64, 138, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 33.852988481521606
partition_len_list
[83, 77, 90, 107, 73, 122, 64, 138]
range_init_graph_partition selection method range initialization spend 33.85374474525452
time for parepare:  0.00016450881958007812
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0015380382537841797
mini_batch_src_global generation:  0.00010991096496582031
r_  generation:  0.02449655532836914
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.775161743164062e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.2901763916015625e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.369850158691406e-05
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.458427429199219e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  9.465217590332031e-05
mini_batch_src_global generation:  1.71661376953125e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.870529174804688e-05
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.393692016601562e-05
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  3.314018249511719e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  5.555152893066406e-05
----------------------check_connections_block total spend ----------------------------- 0.028410911560058594
generate_one_block  0.0054171085357666016
generate_one_block  0.00138092041015625
generate_one_block  0.0010242462158203125
generate_one_block  0.001062631607055664
generate_one_block  0.0009746551513671875
generate_one_block  0.0010180473327636719
generate_one_block  0.0009822845458984375
generate_one_block  0.0010247230529785156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024509429931640625
gen group dst list time:  0.00013709068298339844
time for parepare:  0.0007131099700927734
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0010590553283691406
mini_batch_src_global generation:  0.00014400482177734375
r_  generation:  0.00037789344787597656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00016379356384277344
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.00026416778564453125
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  8.678436279296875e-05
r_  generation:  0.00028228759765625
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  4.220008850097656e-05
r_  generation:  0.0003902912139892578
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012230873107910156
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00018930435180664062
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.0003001689910888672
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002570152282714844
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0003936290740966797
----------------------check_connections_block total spend ----------------------------- 0.006513357162475586
generate_one_block  0.0013661384582519531
generate_one_block  0.0012311935424804688
generate_one_block  0.0012602806091308594
generate_one_block  0.0013885498046875
generate_one_block  0.0012328624725341797
generate_one_block  0.0015125274658203125
generate_one_block  0.001293182373046875
generate_one_block  0.0015735626220703125
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015189647674560547
gen group dst list time:  0.00010395050048828125
time for parepare:  0.0005972385406494141
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.0006546974182128906
mini_batch_src_global generation:  0.00037384033203125
r_  generation:  0.0009157657623291016
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00038433074951171875
mini_batch_src_global generation:  0.00010275840759277344
r_  generation:  0.0006902217864990234
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  7.748603820800781e-05
r_  generation:  0.0007076263427734375
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00017786026000976562
mini_batch_src_global generation:  0.00012350082397460938
r_  generation:  0.0009768009185791016
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  8.606910705566406e-05
r_  generation:  0.0006785392761230469
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  0.018277645111083984
r_  generation:  0.001463174819946289
local_output_nid generation:  0.00010585784912109375
local_in_edges_tensor generation:  0.0004286766052246094
mini_batch_src_global generation:  0.0001552104949951172
r_  generation:  0.0009391307830810547
local_output_nid generation:  0.00010848045349121094
local_in_edges_tensor generation:  0.00035953521728515625
mini_batch_src_global generation:  0.00017189979553222656
r_  generation:  0.0014128684997558594
----------------------check_connections_block total spend ----------------------------- 0.03421187400817871
generate_one_block  0.004258394241333008
generate_one_block  0.00403141975402832
generate_one_block  0.013390302658081055
generate_one_block  0.005713224411010742
generate_one_block  0.0039370059967041016
generate_one_block  0.004503965377807617
generate_one_block  0.0029425621032714844
generate_one_block  0.0038695335388183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20808.71484375, 'VmSize': 20656.546875, 'VmHWM': 3620.7421875, 'VmRSS': 3620.6796875}
connection checking time:  0.0407252311706543
block generation total time  0.05350470542907715
average batch blocks generation time:  0.0066880881786346436
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.008213043212890625  GigaBytes
Max Memory Allocated: 0.008213043212890625  GigaBytes

{'VmPeak': 21006.3828125, 'VmSize': 20977.6328125, 'VmHWM': 3911.73828125, 'VmRSS': 3911.73828125}
torch.Size([1252, 1433])
torch.Size([556, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.009281158447265625  GigaBytes
Max Memory Allocated: 0.009631156921386719  GigaBytes

{'VmPeak': 21748.65234375, 'VmSize': 21748.65234375, 'VmHWM': 4604.6640625, 'VmRSS': 4604.6640625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008652687072753906  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21754.4765625, 'VmSize': 21754.4765625, 'VmHWM': 4611.37890625, 'VmRSS': 4611.37890625}
torch.Size([1055, 1433])
torch.Size([390, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009442806243896484  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21754.4765625, 'VmSize': 21754.4765625, 'VmHWM': 4611.37890625, 'VmRSS': 4611.37890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008189201354980469  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21754.4765625, 'VmSize': 21754.4765625, 'VmHWM': 4611.6328125, 'VmRSS': 4611.6328125}
torch.Size([968, 1433])
torch.Size([394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009012699127197266  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21754.4765625, 'VmSize': 21754.4765625, 'VmHWM': 4611.6328125, 'VmRSS': 4611.6328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009830951690673828  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4612.76953125, 'VmRSS': 4612.76953125}
torch.Size([1274, 1433])
torch.Size([561, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.01095724105834961  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4612.76953125, 'VmRSS': 4612.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.008464813232421875  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4612.8984375, 'VmRSS': 4612.8984375}
torch.Size([1020, 1433])
torch.Size([394, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.009252071380615234  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4612.8984375, 'VmRSS': 4612.8984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.009518623352050781  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.00390625, 'VmRSS': 4613.00390625}
torch.Size([1216, 1433])
torch.Size([474, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.010536670684814453  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.00390625, 'VmRSS': 4613.00390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.007557392120361328  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.00390625, 'VmRSS': 4613.00390625}
torch.Size([850, 1433])
torch.Size([349, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.008255481719970703  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.00390625, 'VmRSS': 4613.00390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.009697437286376953  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.06640625, 'VmRSS': 4613.06640625}
torch.Size([1249, 1433])
torch.Size([521, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.010825634002685547  GigaBytes
Max Memory Allocated: 0.015316009521484375  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.06640625, 'VmRSS': 4613.06640625}
{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.50390625, 'VmRSS': 4613.50390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009751319885253906 |0.045815616846084595 |0.10326147079467773 |0.00015756487846374512 |0.0027666091918945312 |0.0030221939086914062 |
----------------------------------------------------------pseudo_mini_loss sum 3.814962148666382
{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.50390625, 'VmRSS': 4613.50390625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13277
Number of first layer input nodes during this epoch:  8884
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012764453887939453  GigaBytes
Max Memory Allocated: 0.015498161315917969  GigaBytes

{'VmPeak': 21755.67578125, 'VmSize': 21755.67578125, 'VmHWM': 4613.50390625, 'VmRSS': 4613.50390625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004627704620361328
global_2_local 7.128715515136719e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.1021575927734375e-05
before graph partition 
		86, 118, 83, 87, 78, 84, 121, 94, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00019693374633789062
	Initialize BitList time :  1.1444091796875e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 86, 118

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
	walk terminate 1 spend time 5.804007530212402
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
	walk terminate 1 spend time 5.705712795257568
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		100, 103, 83, 87, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				21, 15, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046634674072265625
	Initialize BitList time :  3.0040740966796875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 103, 83

	before terminate 1 the average redundancy rate is:  1.15527950310559
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
	walk terminate 1 spend time 6.048866033554077
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 103, 87, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				21, 18, 15, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00031566619873046875
	Initialize BitList time :  2.7894973754882812e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 103, 87

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
	walk terminate 1 spend time 5.809908628463745
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 103, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				21, 18, 18, 15, 18, 18, 18, 14, 


	preparing two sides time :  0.00045371055603027344
	Initialize BitList time :  3.457069396972656e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 103, 78

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
	walk terminate 1 spend time 5.793446063995361
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 78, 103, 84, 121, 94, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				21, 18, 18, 18, 15, 18, 18, 14, 


	preparing two sides time :  0.0004565715789794922
	Initialize BitList time :  3.62396240234375e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 103, 84

	before terminate 1 the average redundancy rate is:  1.1614906832298137
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
	walk terminate 1 spend time 5.756140470504761
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 78, 84, 103, 121, 94, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				21, 18, 18, 18, 18, 15, 18, 14, 


	preparing two sides time :  0.0004737377166748047
	Initialize BitList time :  3.361701965332031e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 103, 121

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.4409937888198758,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.4409937888198758,  1.329192546583851
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.5527950310559007,  1.2173913043478262
	walk terminate 1 spend time 5.871393442153931
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.031055900621118,  1.7391304347826086
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.1180124223602483,  1.6521739130434783
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.1180124223602483,  1.6521739130434783
	walk terminate 1 spend time 5.7883360385894775
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 87, 78, 84, 90, 133, 94, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				21, 18, 18, 18, 18, 19, 14, 14, 


	preparing two sides time :  0.0004649162292480469
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 133, 94

	before terminate 1 the average redundancy rate is:  1.4099378881987579
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.453416149068323,  1.3540372670807452
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
	walk terminate 1 spend time 5.887461185455322
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
	walk terminate 1 spend time 5.715989828109741
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		100, 83, 87, 78, 84, 90, 103, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 58.20542669296265
partition_len_list
[100, 83, 87, 78, 84, 90, 103, 123]
range_init_graph_partition selection method range initialization spend 58.205841302871704
time for parepare:  0.000118255615234375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.008945226669311523
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0003383159637451172
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  3.743171691894531e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011777877807617188
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010752677917480469
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  4.792213439941406e-05
----------------------check_connections_block total spend ----------------------------- 0.011553525924682617
generate_one_block  0.016605615615844727
generate_one_block  0.0011875629425048828
generate_one_block  0.0013110637664794922
generate_one_block  0.0010848045349121094
generate_one_block  0.0010526180267333984
generate_one_block  0.0010082721710205078
generate_one_block  0.0010635852813720703
generate_one_block  0.0010199546813964844
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0019750595092773438
gen group dst list time:  5.984306335449219e-05
time for parepare:  0.0004105567932128906
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.0004928112030029297
mini_batch_src_global generation:  5.6743621826171875e-05
r_  generation:  0.00032782554626464844
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00021266937255859375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00021457672119140625
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011730194091796875
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0001666545867919922
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.000244140625
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.0002703666687011719
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00027823448181152344
----------------------check_connections_block total spend ----------------------------- 0.004777431488037109
generate_one_block  0.0018551349639892578
generate_one_block  0.0012922286987304688
generate_one_block  0.0013623237609863281
generate_one_block  0.001247406005859375
generate_one_block  0.007678508758544922
generate_one_block  0.0012850761413574219
generate_one_block  0.0014252662658691406
generate_one_block  0.0013115406036376953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006923675537109375
gen group dst list time:  0.00010514259338378906
time for parepare:  0.00021886825561523438
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0004291534423828125
mini_batch_src_global generation:  0.0001957416534423828
r_  generation:  0.0009419918060302734
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0007102489471435547
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.000164031982421875
mini_batch_src_global generation:  7.796287536621094e-05
r_  generation:  0.0007009506225585938
local_output_nid generation:  2.47955322265625e-05
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  6.914138793945312e-05
r_  generation:  0.0006244182586669922
local_output_nid generation:  4.315376281738281e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.0008766651153564453
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00016498565673828125
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0007169246673583984
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  9.584426879882812e-05
r_  generation:  0.0009157657623291016
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  9.512901306152344e-05
r_  generation:  0.0008087158203125
----------------------check_connections_block total spend ----------------------------- 0.011059045791625977
generate_one_block  0.002167940139770508
generate_one_block  0.0018885135650634766
generate_one_block  0.0032491683959960938
generate_one_block  0.002227306365966797
generate_one_block  0.002552032470703125
generate_one_block  0.0021715164184570312
generate_one_block  0.004525423049926758
generate_one_block  0.004338264465332031
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012764453887939453  GigaBytes
Max Memory Allocated: 0.015498161315917969  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21819.94140625, 'VmHWM': 4615.28515625, 'VmRSS': 4615.21484375}
connection checking time:  0.015836477279663086
block generation total time  0.04057765007019043
average batch blocks generation time:  0.005072206258773804
block dataloader generation time/epoch 58.315885066986084
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012445449829101562  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4618.46875, 'VmRSS': 4618.46875}
torch.Size([1203, 1433])
torch.Size([588, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013599872589111328  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4618.46875, 'VmRSS': 4618.46875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011771202087402344  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4619.11328125, 'VmRSS': 4619.11328125}
torch.Size([1078, 1433])
torch.Size([418, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012617111206054688  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4619.11328125, 'VmRSS': 4619.11328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011413097381591797  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4619.17578125, 'VmRSS': 4619.17578125}
torch.Size([1011, 1433])
torch.Size([388, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.01222085952758789  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4619.17578125, 'VmRSS': 4619.17578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.010329246520996094  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4619.24609375, 'VmRSS': 4619.24609375}
torch.Size([809, 1433])
torch.Size([282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.01094818115234375  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21823.95703125, 'VmHWM': 4619.24609375, 'VmRSS': 4619.24609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012582778930664062  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.08203125, 'VmHWM': 4619.35546875, 'VmRSS': 4619.34765625}
torch.Size([1229, 1433])
torch.Size([517, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013591289520263672  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.08203125, 'VmHWM': 4619.35546875, 'VmRSS': 4619.34765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011215686798095703  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.08203125, 'VmHWM': 4619.35546875, 'VmRSS': 4619.34765625}
torch.Size([974, 1433])
torch.Size([386, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012027740478515625  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.08203125, 'VmHWM': 4619.35546875, 'VmRSS': 4619.34765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.01284027099609375  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.34375, 'VmHWM': 4619.578125, 'VmRSS': 4619.578125}
torch.Size([1277, 1433])
torch.Size([507, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013871192932128906  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.34375, 'VmHWM': 4619.578125, 'VmRSS': 4619.578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011802196502685547  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.34375, 'VmHWM': 4619.578125, 'VmRSS': 4619.578125}
torch.Size([1083, 1433])
torch.Size([463, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012804031372070312  GigaBytes
Max Memory Allocated: 0.019083023071289062  GigaBytes

{'VmPeak': 21883.69140625, 'VmSize': 21824.34375, 'VmHWM': 4619.578125, 'VmRSS': 4619.578125}
{'VmPeak': 21883.69140625, 'VmSize': 21824.34375, 'VmHWM': 4619.58203125, 'VmRSS': 4619.58203125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01446843147277832 |0.0006203055381774902 |0.0050626397132873535 |0.0001812577247619629 |0.0035815536975860596 |0.0016219615936279297 |
----------------------------------------------------------pseudo_mini_loss sum 1.601523995399475
{'VmPeak': 21883.69140625, 'VmSize': 21824.34375, 'VmHWM': 4619.58203125, 'VmRSS': 4619.58203125}
Total (block generation + training)time/epoch 58.52194380760193
Training time/epoch 0.20574522018432617
Training time without block to device /epoch 0.20078277587890625
Training time without total dataloading part /epoch 0.07222557067871094
load block tensor time/epoch 0.11574745178222656
block to device time/epoch 0.004962444305419922
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12961
Number of first layer input nodes during this epoch:  8664
