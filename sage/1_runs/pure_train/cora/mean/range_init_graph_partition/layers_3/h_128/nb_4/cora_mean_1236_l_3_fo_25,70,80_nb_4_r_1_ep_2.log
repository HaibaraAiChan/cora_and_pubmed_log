main start at this time 1648609346.3224754
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20803.375, 'VmSize': 20802.71484375, 'VmHWM': 3614.41796875, 'VmRSS': 3614.41796875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0013227462768554688
global_2_local 0.00011348724365234375
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  7.414817810058594e-05
before graph partition 
		153, 183, 208, 195, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00026988983154296875
	Initialize BitList time :  1.621246337890625e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 153, 183

	before terminate 1 the average redundancy rate is:  1.0434782608695652
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0434782608695652,  0.968944099378882,  1.1180124223602483
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0434782608695652,  0.9440993788819876,  1.1428571428571428
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0434782608695652,  0.9751552795031055,  1.1118012422360248
	walk terminate 1 spend time 5.153441429138184
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		157, 179, 208, 195, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005297660827636719
	Initialize BitList time :  3.981590270996094e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 179, 208

	before terminate 1 the average redundancy rate is:  1.201863354037267
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.1614906832298137,  1.2422360248447204
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.1366459627329193,  1.2484472049689441
						 current side  1
			 redundancy will reduce  0.009316770186335255
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.2608695652173914,  1.124223602484472
	walk terminate 1 spend time 5.404971599578857
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.01863354037267073
			 the number of node to move is : 8
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.0186335403726707,  1.3478260869565217
						 current side  1
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.18944099378882,  1.2608695652173914,  1.1180124223602483
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 6
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.18944099378882,  1.0745341614906831,  1.3043478260869565
	walk terminate 1 spend time 5.361506700515747
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		157, 173, 210, 195, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 30, 39, 35, 


	preparing two sides time :  0.0005171298980712891
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   5.245208740234375e-06

					length of partitions 210, 195

	before terminate 1 the average redundancy rate is:  1.2577639751552794
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552796,  1.2857142857142858,  1.2298136645962734
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2577639751552794,  1.3167701863354038,  1.1987577639751552
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173914,  1.2608695652173914,  1.2608695652173914
	walk terminate 1 spend time 5.296223402023315
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		157, 173, 203, 203, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 21.22745442390442
partition_len_list
[157, 173, 203, 203]
range_init_graph_partition selection method range initialization spend 21.228082180023193
time for parepare:  0.00018215179443359375
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0010097026824951172
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.016102313995361328
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00027942657470703125
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.00013303756713867188
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00017833709716796875
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0001964569091796875
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00016236305236816406
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00014925003051757812
----------------------check_connections_block total spend ----------------------------- 0.019526004791259766
generate_one_block  0.011071443557739258
generate_one_block  0.0012469291687011719
generate_one_block  0.0011281967163085938
generate_one_block  0.0010764598846435547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001470327377319336
gen group dst list time:  4.4345855712890625e-05
time for parepare:  0.0007243156433105469
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0005507469177246094
mini_batch_src_global generation:  8.487701416015625e-05
r_  generation:  0.0006346702575683594
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00023555755615234375
mini_batch_src_global generation:  7.128715515136719e-05
r_  generation:  0.0005817413330078125
local_output_nid generation:  1.6927719116210938e-05
local_in_edges_tensor generation:  0.00014352798461914062
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0005755424499511719
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  7.891654968261719e-05
r_  generation:  0.00049591064453125
----------------------check_connections_block total spend ----------------------------- 0.0050127506256103516
generate_one_block  0.0022859573364257812
generate_one_block  0.0015325546264648438
generate_one_block  0.0015790462493896484
generate_one_block  0.0017070770263671875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017008781433105469
gen group dst list time:  7.772445678710938e-05
time for parepare:  0.00042557716369628906
local_output_nid generation:  5.1975250244140625e-05
local_in_edges_tensor generation:  0.0007166862487792969
mini_batch_src_global generation:  0.0004279613494873047
r_  generation:  0.0014302730560302734
local_output_nid generation:  5.1021575927734375e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00021123886108398438
r_  generation:  0.0011968612670898438
local_output_nid generation:  5.91278076171875e-05
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  0.00013518333435058594
r_  generation:  0.0013320446014404297
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.0001347064971923828
r_  generation:  0.0014011859893798828
----------------------check_connections_block total spend ----------------------------- 0.010036706924438477
generate_one_block  0.0028314590454101562
generate_one_block  0.002839803695678711
generate_one_block  0.0027794837951660156
generate_one_block  0.0036509037017822266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20807.7109375, 'VmSize': 20657.03125, 'VmHWM': 3621.88671875, 'VmRSS': 3621.88671875}
connection checking time:  0.015049457550048828
block generation total time  0.01920628547668457
average batch blocks generation time:  0.004801571369171143
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.009669303894042969  GigaBytes
Max Memory Allocated: 0.009669303894042969  GigaBytes

{'VmPeak': 21029.08984375, 'VmSize': 20997.09375, 'VmHWM': 3931.5078125, 'VmRSS': 3931.5078125}
torch.Size([1523, 1433])
torch.Size([751, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.011202335357666016  GigaBytes
Max Memory Allocated: 0.011503219604492188  GigaBytes

{'VmPeak': 21749.1328125, 'VmSize': 21749.1328125, 'VmHWM': 4605.03515625, 'VmRSS': 4605.03515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010859012603759766  GigaBytes
Max Memory Allocated: 0.018951892852783203  GigaBytes

{'VmPeak': 21757.140625, 'VmSize': 21757.140625, 'VmHWM': 4614.125, 'VmRSS': 4614.125}
torch.Size([1465, 1433])
torch.Size([689, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.01232767105102539  GigaBytes
Max Memory Allocated: 0.018951892852783203  GigaBytes

{'VmPeak': 21757.140625, 'VmSize': 21757.140625, 'VmHWM': 4614.125, 'VmRSS': 4614.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.011594772338867188  GigaBytes
Max Memory Allocated: 0.019373416900634766  GigaBytes

{'VmPeak': 21821.88671875, 'VmSize': 21789.890625, 'VmHWM': 4615.671875, 'VmRSS': 4615.671875}
torch.Size([1602, 1433])
torch.Size([805, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.013310432434082031  GigaBytes
Max Memory Allocated: 0.019373416900634766  GigaBytes

{'VmPeak': 21821.88671875, 'VmSize': 21789.890625, 'VmHWM': 4615.671875, 'VmRSS': 4615.671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.011842727661132812  GigaBytes
Max Memory Allocated: 0.02035045623779297  GigaBytes

{'VmPeak': 21821.88671875, 'VmSize': 21790.140625, 'VmHWM': 4616.39453125, 'VmRSS': 4616.39453125}
torch.Size([1648, 1433])
torch.Size([826, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.013591289520263672  GigaBytes
Max Memory Allocated: 0.02035045623779297  GigaBytes

{'VmPeak': 21821.88671875, 'VmSize': 21790.140625, 'VmHWM': 4616.39453125, 'VmRSS': 4616.39453125}
{'VmPeak': 21821.88671875, 'VmSize': 21790.140625, 'VmHWM': 4616.6484375, 'VmRSS': 4616.6484375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016998112201690674 |0.09865725040435791 |0.19865530729293823 |0.00018745660781860352 |0.0038880109786987305 |0.0032939910888671875 |
----------------------------------------------------------pseudo_mini_loss sum 3.7548117637634277
{'VmPeak': 21821.88671875, 'VmSize': 21790.140625, 'VmHWM': 4616.6484375, 'VmRSS': 4616.6484375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10045
Number of first layer input nodes during this epoch:  6238
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014941215515136719  GigaBytes
Max Memory Allocated: 0.02035045623779297  GigaBytes

{'VmPeak': 21821.88671875, 'VmSize': 21790.140625, 'VmHWM': 4616.7734375, 'VmRSS': 4616.7734375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004887580871582031
global_2_local 7.557868957519531e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.412101745605469e-05
before graph partition 
		195, 163, 151, 229, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00022125244140625
	Initialize BitList time :  1.2874603271484375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 195, 163

	before terminate 1 the average redundancy rate is:  1.1118012422360248
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.1925465838509317,  1.0248447204968945
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.2111801242236024,  1.0062111801242235
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.1801242236024845,  1.0372670807453417
	walk terminate 1 spend time 6.063750982284546
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.108695652173913,  1.1180124223602483,  1.0993788819875776
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1118012422360248,  1.1366459627329193,  1.0869565217391304
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1118012422360248,  1.124223602484472,  1.0993788819875776
	walk terminate 1 spend time 6.407919406890869
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		177, 181, 151, 229, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				37, 33, 35, 35, 


	preparing two sides time :  0.0005211830139160156
	Initialize BitList time :  4.5299530029296875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 181, 151

	before terminate 1 the average redundancy rate is:  1.031055900621118
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.031055900621118,  1.1055900621118013,  0.9565217391304348
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.031055900621118,  1.1304347826086956,  0.9316770186335404
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.031055900621118,  1.1118012422360248,  0.9503105590062112
	walk terminate 1 spend time 6.2210001945495605
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		177, 153, 179, 229, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				37, 36, 32, 35, 


	preparing two sides time :  0.0005166530609130859
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 179, 229

	before terminate 1 the average redundancy rate is:  1.2670807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 7
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2453416149068324,  1.2732919254658386,  1.2173913043478262
						 current side  0
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.1366459627329193,  1.3664596273291925
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2515527950310559,  1.2236024844720497,  1.279503105590062
	walk terminate 1 spend time 6.215633392333984
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.021739130434782483
			 the number of node to move is : 5
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2453416149068324,  1.360248447204969,  1.1304347826086956
						 current side  0
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.2236024844720497,  1.2484472049689441
						 current side  1
			 redundancy will reduce  0.04347826086956519
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.3726708074534162,  1.0745341614906831
	walk terminate 1 spend time 6.144726991653442
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		177, 153, 173, 221, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 31.06236696243286
partition_len_list
[177, 153, 173, 221]
range_init_graph_partition selection method range initialization spend 31.06305456161499
time for parepare:  0.00016999244689941406
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.008757352828979492
mini_batch_src_global generation:  0.00012445449829101562
r_  generation:  0.0014104843139648438
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00039124488830566406
mini_batch_src_global generation:  8.106231689453125e-05
r_  generation:  0.0002567768096923828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0002646446228027344
mini_batch_src_global generation:  4.744529724121094e-05
r_  generation:  0.0001392364501953125
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00031638145446777344
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00031638145446777344
----------------------check_connections_block total spend ----------------------------- 0.013901948928833008
generate_one_block  0.028979063034057617
generate_one_block  0.0014369487762451172
generate_one_block  0.001493692398071289
generate_one_block  0.0011734962463378906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002582073211669922
gen group dst list time:  5.9604644775390625e-05
time for parepare:  0.0009109973907470703
local_output_nid generation:  3.4809112548828125e-05
local_in_edges_tensor generation:  0.0009410381317138672
mini_batch_src_global generation:  0.00022721290588378906
r_  generation:  0.0006988048553466797
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0002498626708984375
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0003814697265625
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00017714500427246094
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0005524158477783203
local_output_nid generation:  2.3126602172851562e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.00017952919006347656
r_  generation:  0.0006458759307861328
----------------------check_connections_block total spend ----------------------------- 0.00621342658996582
generate_one_block  0.0016217231750488281
generate_one_block  0.0014867782592773438
generate_one_block  0.0015912055969238281
generate_one_block  0.0018684864044189453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.013922929763793945
gen group dst list time:  9.846687316894531e-05
time for parepare:  0.0002980232238769531
local_output_nid generation:  5.7697296142578125e-05
local_in_edges_tensor generation:  0.11148834228515625
mini_batch_src_global generation:  0.0003333091735839844
r_  generation:  0.0021209716796875
local_output_nid generation:  0.0001742839813232422
local_in_edges_tensor generation:  0.0005540847778320312
mini_batch_src_global generation:  0.00026679039001464844
r_  generation:  0.0019006729125976562
local_output_nid generation:  0.00023245811462402344
local_in_edges_tensor generation:  0.0005900859832763672
mini_batch_src_global generation:  0.0002601146697998047
r_  generation:  0.0022516250610351562
local_output_nid generation:  0.0002200603485107422
local_in_edges_tensor generation:  0.0005707740783691406
mini_batch_src_global generation:  0.0003459453582763672
r_  generation:  0.0030384063720703125
----------------------check_connections_block total spend ----------------------------- 0.12755298614501953
generate_one_block  0.007081747055053711
generate_one_block  0.00947880744934082
generate_one_block  0.0044269561767578125
generate_one_block  0.0034558773040771484
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014941215515136719  GigaBytes
Max Memory Allocated: 0.02035045623779297  GigaBytes

{'VmPeak': 21854.65625, 'VmSize': 21854.40625, 'VmHWM': 4617.8359375, 'VmRSS': 4617.80859375}
connection checking time:  0.13376641273498535
block generation total time  0.031011581420898438
average batch blocks generation time:  0.007752895355224609
block dataloader generation time/epoch 31.30270528793335
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014585494995117188  GigaBytes
Max Memory Allocated: 0.023343563079833984  GigaBytes

{'VmPeak': 21858.51953125, 'VmSize': 21858.51953125, 'VmHWM': 4621.49609375, 'VmRSS': 4621.49609375}
torch.Size([1590, 1433])
torch.Size([743, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.01614856719970703  GigaBytes
Max Memory Allocated: 0.023343563079833984  GigaBytes

{'VmPeak': 21858.51953125, 'VmSize': 21858.50390625, 'VmHWM': 4621.49609375, 'VmRSS': 4621.4921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014037609100341797  GigaBytes
Max Memory Allocated: 0.023343563079833984  GigaBytes

{'VmPeak': 21858.51953125, 'VmSize': 21858.50390625, 'VmHWM': 4621.89453125, 'VmRSS': 4621.89453125}
torch.Size([1500, 1433])
torch.Size([682, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.015451431274414062  GigaBytes
Max Memory Allocated: 0.023343563079833984  GigaBytes

{'VmPeak': 21858.51953125, 'VmSize': 21858.50390625, 'VmHWM': 4621.89453125, 'VmRSS': 4621.89453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.014585494995117188  GigaBytes
Max Memory Allocated: 0.023343563079833984  GigaBytes

{'VmPeak': 21858.51953125, 'VmSize': 21858.50390625, 'VmHWM': 4621.89453125, 'VmRSS': 4621.89453125}
torch.Size([1502, 1433])
torch.Size([726, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.016112327575683594  GigaBytes
Max Memory Allocated: 0.023343563079833984  GigaBytes

{'VmPeak': 21858.51953125, 'VmSize': 21858.50390625, 'VmHWM': 4621.89453125, 'VmRSS': 4621.89453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.015091896057128906  GigaBytes
Max Memory Allocated: 0.023595809936523438  GigaBytes

{'VmPeak': 21859.078125, 'VmSize': 21859.078125, 'VmHWM': 4622.203125, 'VmRSS': 4622.203125}
torch.Size([1695, 1433])
torch.Size([916, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2733154296875 GB
    Memory Allocated: 0.01702260971069336  GigaBytes
Max Memory Allocated: 0.023595809936523438  GigaBytes

{'VmPeak': 21859.078125, 'VmSize': 21859.078125, 'VmHWM': 4622.2109375, 'VmRSS': 4622.2109375}
{'VmPeak': 21859.078125, 'VmSize': 21859.078125, 'VmHWM': 4622.2109375, 'VmRSS': 4622.2109375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009312331676483154 |0.0007208585739135742 |0.00516963005065918 |0.00016731023788452148 |0.00393301248550415 |0.001817464828491211 |
----------------------------------------------------------pseudo_mini_loss sum 1.5983903408050537
{'VmPeak': 21859.078125, 'VmSize': 21859.078125, 'VmHWM': 4622.2109375, 'VmRSS': 4622.2109375}
Total (block generation + training)time/epoch 31.389461040496826
Training time/epoch 0.08630585670471191
Training time without block to device /epoch 0.08342242240905762
Training time without total dataloading part /epoch 0.03889727592468262
load block tensor time/epoch 0.03724932670593262
block to device time/epoch 0.002883434295654297
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  10078
Number of first layer input nodes during this epoch:  6287
