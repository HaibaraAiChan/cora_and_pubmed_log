main start at this time 1648608587.7459254
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20812.0, 'VmSize': 20808.1171875, 'VmHWM': 3619.74609375, 'VmRSS': 3619.74609375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006341934204101562
global_2_local 7.319450378417969e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  4.76837158203125e-05
before graph partition 
		83, 77, 90, 107, 139, 73, 122, 64, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020575523376464844
	Initialize BitList time :  1.2636184692382812e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 83, 77

-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0001983642578125
	Initialize BitList time :  8.821487426757812e-06
	getRedundancyCost: time   1.1920928955078125e-06

					length of partitions 77, 90

	before terminate 1 the average redundancy rate is:  1.0372670807453415
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
	walk terminate 1 spend time 4.282770872116089
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 77, 90, 107, 139, 73, 122, 64, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004849433898925781
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 90, 107

	before terminate 1 the average redundancy rate is:  1.2236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
	walk terminate 1 spend time 4.755186319351196
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 77, 90, 107, 139, 73, 122, 64, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003719329833984375
	Initialize BitList time :  3.457069396972656e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 107, 139

	before terminate 1 the average redundancy rate is:  1.5279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.329192546583851,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.204968944099379,  1.8385093167701863
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
	walk terminate 1 spend time 4.5073463916778564
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
	walk terminate 1 spend time 4.673908710479736
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83, 77, 90, 107, 138, 73, 122, 64, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004055500030517578
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 138, 73

	before terminate 1 the average redundancy rate is:  1.31055900621118
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
	walk terminate 1 spend time 4.475556135177612
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 138, 122, 64, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004858970642089844
	Initialize BitList time :  3.552436828613281e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 138, 122

	before terminate 1 the average redundancy rate is:  1.6149068322981366
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
	walk terminate 1 spend time 4.539750099182129
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 122, 138, 64, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004985332489013672
	Initialize BitList time :  3.743171691894531e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 138, 64

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
	walk terminate 1 spend time 4.450550079345703
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 122, 64, 138, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 31.70663857460022
partition_len_list
[83, 77, 90, 107, 73, 122, 64, 138]
range_init_graph_partition selection method range initialization spend 31.70709204673767
time for parepare:  0.0001709461212158203
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.000982522964477539
mini_batch_src_global generation:  0.00012111663818359375
r_  generation:  0.01579737663269043
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  5.936622619628906e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.316734313964844e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0001704692840576172
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  8.797645568847656e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010395050048828125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  6.556510925292969e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  6.985664367675781e-05
----------------------check_connections_block total spend ----------------------------- 0.0197756290435791
generate_one_block  0.011291265487670898
generate_one_block  0.001230478286743164
generate_one_block  0.0010731220245361328
generate_one_block  0.0010516643524169922
generate_one_block  0.0010623931884765625
generate_one_block  0.001112222671508789
generate_one_block  0.001058816909790039
generate_one_block  0.0011036396026611328
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002744436264038086
gen group dst list time:  0.00015091896057128906
time for parepare:  0.000659942626953125
local_output_nid generation:  5.269050598144531e-05
local_in_edges_tensor generation:  0.0011489391326904297
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.0003383159637451172
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  4.9591064453125e-05
r_  generation:  0.00017905235290527344
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.218650817871094e-05
r_  generation:  0.0002522468566894531
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00020265579223632812
mini_batch_src_global generation:  7.081031799316406e-05
r_  generation:  0.0003104209899902344
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00016379356384277344
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0002734661102294922
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011539459228515625
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00016260147094726562
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00013780593872070312
mini_batch_src_global generation:  6.389617919921875e-05
r_  generation:  0.000354766845703125
----------------------check_connections_block total spend ----------------------------- 0.006043195724487305
generate_one_block  0.0013370513916015625
generate_one_block  0.0012128353118896484
generate_one_block  0.0012607574462890625
generate_one_block  0.001352071762084961
generate_one_block  0.0012955665588378906
generate_one_block  0.00144195556640625
generate_one_block  0.0012848377227783203
generate_one_block  0.001615285873413086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016620159149169922
gen group dst list time:  9.655952453613281e-05
time for parepare:  0.0005667209625244141
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0010478496551513672
mini_batch_src_global generation:  0.0003867149353027344
r_  generation:  0.0007443428039550781
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.0003695487976074219
mini_batch_src_global generation:  0.00031566619873046875
r_  generation:  0.0007112026214599609
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.00024390220642089844
mini_batch_src_global generation:  9.5367431640625e-05
r_  generation:  0.0015881061553955078
local_output_nid generation:  8.344650268554688e-05
local_in_edges_tensor generation:  0.0004627704620361328
mini_batch_src_global generation:  0.0009043216705322266
r_  generation:  0.0018851757049560547
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0003428459167480469
mini_batch_src_global generation:  0.0001583099365234375
r_  generation:  0.0013277530670166016
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0003635883331298828
mini_batch_src_global generation:  0.00018095970153808594
r_  generation:  0.001598358154296875
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00027370452880859375
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.001016378402709961
local_output_nid generation:  6.365776062011719e-05
local_in_edges_tensor generation:  0.000293731689453125
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0015537738800048828
----------------------check_connections_block total spend ----------------------------- 0.022050857543945312
generate_one_block  0.004050493240356445
generate_one_block  0.002417325973510742
generate_one_block  0.002302408218383789
generate_one_block  0.002553224563598633
generate_one_block  0.002622365951538086
generate_one_block  0.0028634071350097656
generate_one_block  0.0024421215057373047
generate_one_block  0.0031328201293945312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20812.0, 'VmSize': 20655.96484375, 'VmHWM': 3620.85546875, 'VmRSS': 3620.85546875}
connection checking time:  0.028094053268432617
block generation total time  0.03318452835083008
average batch blocks generation time:  0.00414806604385376
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.007563114166259766  GigaBytes
Max Memory Allocated: 0.007563114166259766  GigaBytes

{'VmPeak': 21005.625, 'VmSize': 20977.8046875, 'VmHWM': 3911.9296875, 'VmRSS': 3911.9296875}
torch.Size([1131, 1433])
torch.Size([463, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00848245620727539  GigaBytes
Max Memory Allocated: 0.008786678314208984  GigaBytes

{'VmPeak': 21750.33984375, 'VmSize': 21750.0078125, 'VmHWM': 4606.0546875, 'VmRSS': 4606.0546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.007928848266601562  GigaBytes
Max Memory Allocated: 0.013948917388916016  GigaBytes

{'VmPeak': 21755.03515625, 'VmSize': 21755.03515625, 'VmHWM': 4612.3671875, 'VmRSS': 4612.3671875}
torch.Size([920, 1433])
torch.Size([333, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008626937866210938  GigaBytes
Max Memory Allocated: 0.013948917388916016  GigaBytes

{'VmPeak': 21755.03515625, 'VmSize': 21755.03515625, 'VmHWM': 4612.3671875, 'VmRSS': 4612.3671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009058952331542969  GigaBytes
Max Memory Allocated: 0.013948917388916016  GigaBytes

{'VmPeak': 21755.2109375, 'VmSize': 21755.2109375, 'VmHWM': 4613.62890625, 'VmRSS': 4613.62890625}
torch.Size([952, 1433])
torch.Size([373, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009849071502685547  GigaBytes
Max Memory Allocated: 0.013948917388916016  GigaBytes

{'VmPeak': 21755.2109375, 'VmSize': 21755.2109375, 'VmHWM': 4613.62890625, 'VmRSS': 4613.62890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009122848510742188  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4614.625, 'VmRSS': 4614.625}
torch.Size([1142, 1433])
torch.Size([489, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010132789611816406  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4614.625, 'VmRSS': 4614.625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007939815521240234  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4614.9609375, 'VmRSS': 4614.9609375}
torch.Size([922, 1433])
torch.Size([334, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008631229400634766  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4614.9609375, 'VmRSS': 4614.9609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009212493896484375  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4614.9609375, 'VmRSS': 4614.9609375}
torch.Size([1159, 1433])
torch.Size([448, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010188102722167969  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4614.9609375, 'VmRSS': 4614.9609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.007939815521240234  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4615.01953125, 'VmRSS': 4615.01953125}
torch.Size([801, 1433])
torch.Size([305, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.00856781005859375  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.25, 'VmSize': 21756.25, 'VmHWM': 4615.01953125, 'VmRSS': 4615.01953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009349822998046875  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.48046875, 'VmSize': 21756.48046875, 'VmHWM': 4615.2109375, 'VmRSS': 4615.2109375}
torch.Size([1184, 1433])
torch.Size([479, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.010410785675048828  GigaBytes
Max Memory Allocated: 0.015134334564208984  GigaBytes

{'VmPeak': 21756.48046875, 'VmSize': 21756.48046875, 'VmHWM': 4615.2109375, 'VmRSS': 4615.2109375}
{'VmPeak': 21756.48046875, 'VmSize': 21756.48046875, 'VmHWM': 4615.5234375, 'VmRSS': 4615.5234375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008362650871276855 |0.04527634382247925 |0.09916621446609497 |0.0001366734504699707 |0.0026682019233703613 |0.0028874874114990234 |
----------------------------------------------------------pseudo_mini_loss sum 3.765486001968384
{'VmPeak': 21756.48046875, 'VmSize': 21756.48046875, 'VmHWM': 4615.5234375, 'VmRSS': 4615.5234375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12189
Number of first layer input nodes during this epoch:  8211
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012413978576660156  GigaBytes
Max Memory Allocated: 0.015147686004638672  GigaBytes

{'VmPeak': 21756.48046875, 'VmSize': 21756.48046875, 'VmHWM': 4615.5234375, 'VmRSS': 4615.5234375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00047087669372558594
global_2_local 7.414817810058594e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.221366882324219e-05
before graph partition 
		86, 118, 83, 87, 78, 84, 121, 94, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020623207092285156
	Initialize BitList time :  1.239776611328125e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 86, 118

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
	walk terminate 1 spend time 5.19110107421875
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
	walk terminate 1 spend time 5.553721189498901
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		100, 103, 83, 87, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				21, 15, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003199577331542969
	Initialize BitList time :  2.5510787963867188e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 103, 83

	before terminate 1 the average redundancy rate is:  1.15527950310559
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
	walk terminate 1 spend time 5.344725131988525
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 103, 87, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				21, 18, 15, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00039005279541015625
	Initialize BitList time :  3.457069396972656e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 103, 87

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
	walk terminate 1 spend time 5.353355646133423
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 103, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				21, 18, 18, 15, 18, 18, 18, 14, 


	preparing two sides time :  0.00045609474182128906
	Initialize BitList time :  4.00543212890625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 103, 78

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
	walk terminate 1 spend time 5.453780174255371
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 78, 103, 84, 121, 94, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				21, 18, 18, 18, 15, 18, 18, 14, 


	preparing two sides time :  0.0003256797790527344
	Initialize BitList time :  3.1948089599609375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 103, 84

	before terminate 1 the average redundancy rate is:  1.1614906832298137
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
	walk terminate 1 spend time 5.389704465866089
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 78, 84, 103, 121, 94, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				21, 18, 18, 18, 18, 15, 18, 14, 


	preparing two sides time :  0.0004787445068359375
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 103, 121

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.4409937888198758,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.4409937888198758,  1.329192546583851
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.5527950310559007,  1.2173913043478262
	walk terminate 1 spend time 5.36553168296814
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.031055900621118,  1.7391304347826086
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.1180124223602483,  1.6521739130434783
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.1180124223602483,  1.6521739130434783
	walk terminate 1 spend time 5.82156777381897
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 87, 78, 84, 90, 133, 94, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				21, 18, 18, 18, 18, 19, 14, 14, 


	preparing two sides time :  0.000469207763671875
	Initialize BitList time :  4.458427429199219e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 133, 94

	before terminate 1 the average redundancy rate is:  1.4099378881987579
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.453416149068323,  1.3540372670807452
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
	walk terminate 1 spend time 5.240137338638306
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
	walk terminate 1 spend time 5.420177459716797
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		100, 83, 87, 78, 84, 90, 103, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 54.15727782249451
partition_len_list
[100, 83, 87, 78, 84, 90, 103, 123]
range_init_graph_partition selection method range initialization spend 54.157766342163086
time for parepare:  0.00017023086547851562
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.0009796619415283203
mini_batch_src_global generation:  8.96453857421875e-05
r_  generation:  0.0003426074981689453
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  6.747245788574219e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.866455078125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00020194053649902344
mini_batch_src_global generation:  3.0279159545898438e-05
r_  generation:  6.151199340820312e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.961822509765625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  8.296966552734375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001990795135498047
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  7.724761962890625e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00013303756713867188
----------------------check_connections_block total spend ----------------------------- 0.004952430725097656
generate_one_block  0.018483400344848633
generate_one_block  0.0011434555053710938
generate_one_block  0.001363992691040039
generate_one_block  0.0010538101196289062
generate_one_block  0.0010142326354980469
generate_one_block  0.0010232925415039062
generate_one_block  0.0010218620300292969
generate_one_block  0.0010073184967041016
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001859426498413086
gen group dst list time:  8.487701416015625e-05
time for parepare:  0.0007412433624267578
local_output_nid generation:  2.1696090698242188e-05
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.00031495094299316406
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00017881393432617188
mini_batch_src_global generation:  8.559226989746094e-05
r_  generation:  0.00029921531677246094
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.00025773048400878906
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00011491775512695312
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00021648406982421875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0002608299255371094
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002593994140625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.000125885009765625
mini_batch_src_global generation:  5.364418029785156e-05
r_  generation:  0.000308990478515625
----------------------check_connections_block total spend ----------------------------- 0.005324602127075195
generate_one_block  0.0013616085052490234
generate_one_block  0.0012426376342773438
generate_one_block  0.0012407302856445312
generate_one_block  0.0012547969818115234
generate_one_block  0.0012922286987304688
generate_one_block  0.0012884140014648438
generate_one_block  0.0015032291412353516
generate_one_block  0.0014395713806152344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014662742614746094
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.0005183219909667969
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.0010814666748046875
mini_batch_src_global generation:  0.00035881996154785156
r_  generation:  0.0008094310760498047
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.0003581047058105469
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0006563663482666016
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  7.653236389160156e-05
r_  generation:  0.0006606578826904297
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00015664100646972656
mini_batch_src_global generation:  6.556510925292969e-05
r_  generation:  0.0005288124084472656
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0007543563842773438
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006883144378662109
local_output_nid generation:  3.600120544433594e-05
local_in_edges_tensor generation:  0.00016832351684570312
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0008034706115722656
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.0001690387725830078
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0007898807525634766
----------------------check_connections_block total spend ----------------------------- 0.012278079986572266
generate_one_block  0.0020940303802490234
generate_one_block  0.0019598007202148438
generate_one_block  0.0032930374145507812
generate_one_block  0.0015072822570800781
generate_one_block  0.0017926692962646484
generate_one_block  0.0016717910766601562
generate_one_block  0.0018415451049804688
generate_one_block  0.0018756389617919922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012413978576660156  GigaBytes
Max Memory Allocated: 0.015147686004638672  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21820.49609375, 'VmHWM': 4616.41796875, 'VmRSS': 4616.3515625}
connection checking time:  0.01760268211364746
block generation total time  0.026659011840820312
average batch blocks generation time:  0.003332376480102539
block dataloader generation time/epoch 54.247981548309326
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.011736392974853516  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.14453125, 'VmRSS': 4619.14453125}
torch.Size([1071, 1433])
torch.Size([486, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.01272726058959961  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.14453125, 'VmRSS': 4619.14453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.011359214782714844  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.61328125, 'VmRSS': 4619.61328125}
torch.Size([1001, 1433])
torch.Size([380, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012144088745117188  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.61328125, 'VmRSS': 4619.61328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.0111236572265625  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.83984375, 'VmRSS': 4619.83984375}
torch.Size([957, 1433])
torch.Size([356, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.011879920959472656  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.83984375, 'VmRSS': 4619.83984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.010329246520996094  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.86328125, 'VmRSS': 4619.86328125}
torch.Size([809, 1433])
torch.Size([282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.01094818115234375  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.86328125, 'VmRSS': 4619.86328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.011750221252441406  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.8671875, 'VmRSS': 4619.8671875}
torch.Size([1074, 1433])
torch.Size([431, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012619495391845703  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.8671875, 'VmRSS': 4619.8671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.011033058166503906  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.90234375, 'VmHWM': 4619.8671875, 'VmRSS': 4619.8671875}
torch.Size([940, 1433])
torch.Size([358, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.011799812316894531  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21823.88671875, 'VmHWM': 4619.8671875, 'VmRSS': 4619.86328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012266159057617188  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21824.4296875, 'VmHWM': 4620.05078125, 'VmRSS': 4620.05078125}
torch.Size([1170, 1433])
torch.Size([432, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.013177871704101562  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21824.4296875, 'VmHWM': 4620.05078125, 'VmRSS': 4620.05078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.01163482666015625  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21824.4296875, 'VmHWM': 4620.2734375, 'VmRSS': 4620.2734375}
torch.Size([1052, 1433])
torch.Size([436, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2518310546875 GB
    Memory Allocated: 0.012592792510986328  GigaBytes
Max Memory Allocated: 0.018032073974609375  GigaBytes

{'VmPeak': 21884.49609375, 'VmSize': 21824.4296875, 'VmHWM': 4620.2734375, 'VmRSS': 4620.2734375}
{'VmPeak': 21884.49609375, 'VmSize': 21824.4296875, 'VmHWM': 4620.27734375, 'VmRSS': 4620.27734375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013691306114196777 |0.0005833208560943604 |0.004660189151763916 |0.00017717480659484863 |0.002988457679748535 |0.0016407966613769531 |
----------------------------------------------------------pseudo_mini_loss sum 1.6328704357147217
{'VmPeak': 21884.49609375, 'VmSize': 21824.4296875, 'VmHWM': 4620.27734375, 'VmRSS': 4620.27734375}
Total (block generation + training)time/epoch 54.43858361244202
Training time/epoch 0.19039154052734375
Training time without block to device /epoch 0.18572497367858887
Training time without total dataloading part /epoch 0.06424736976623535
load block tensor time/epoch 0.10953044891357422
block to device time/epoch 0.004666566848754883
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11983
Number of first layer input nodes during this epoch:  8074
