main start at this time 1648609804.4372144
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20803.44921875, 'VmSize': 20802.9609375, 'VmHWM': 3613.9765625, 'VmRSS': 3613.9765625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0017368793487548828
global_2_local 0.00010561943054199219
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.936622619628906e-05
before graph partition 
		83, 77, 90, 107, 139, 73, 122, 64, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0001957416534423828
	Initialize BitList time :  1.1682510375976562e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 83, 77

-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0001919269561767578
	Initialize BitList time :  7.867813110351562e-06
	getRedundancyCost: time   1.1920928955078125e-06

					length of partitions 77, 90

	before terminate 1 the average redundancy rate is:  1.0372670807453415
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0372670807453415,  0.9565217391304348,  1.1180124223602483
	walk terminate 1 spend time 4.081469297409058
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 77, 90, 107, 139, 73, 122, 64, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005917549133300781
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 90, 107

	before terminate 1 the average redundancy rate is:  1.2236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.1180124223602483,  1.329192546583851
	walk terminate 1 spend time 4.079026699066162
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		83, 77, 90, 107, 139, 73, 122, 64, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004935264587402344
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 107, 139

	before terminate 1 the average redundancy rate is:  1.5279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5279503105590062,  1.329192546583851,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.204968944099379,  1.8385093167701863
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
	walk terminate 1 spend time 4.221258878707886
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.329192546583851,  1.7142857142857142
	walk terminate 1 spend time 4.16898512840271
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		83, 77, 90, 107, 138, 73, 122, 64, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005962848663330078
	Initialize BitList time :  0.00010371208190917969
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 138, 73

	before terminate 1 the average redundancy rate is:  1.31055900621118
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.7142857142857142,  0.906832298136646
	walk terminate 1 spend time 4.099789142608643
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 138, 122, 64, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.000499725341796875
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 138, 122

	before terminate 1 the average redundancy rate is:  1.6149068322981366
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6149068322981366,  1.7142857142857142,  1.515527950310559
	walk terminate 1 spend time 4.149323225021362
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 122, 138, 64, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005679130554199219
	Initialize BitList time :  3.695487976074219e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 138, 64

	before terminate 1 the average redundancy rate is:  1.2546583850931676
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2546583850931676,  1.7142857142857142,  0.7950310559006211
	walk terminate 1 spend time 4.212723970413208
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		83, 77, 90, 107, 73, 122, 64, 138, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 29.038512468338013
partition_len_list
[83, 77, 90, 107, 73, 122, 64, 138]
range_init_graph_partition selection method range initialization spend 29.039196491241455
time for parepare:  0.0001850128173828125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0010433197021484375
mini_batch_src_global generation:  0.00016450881958007812
r_  generation:  0.013354301452636719
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00018453598022460938
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  0.0001342296600341797
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  5.793571472167969e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  9.72747802734375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  6.67572021484375e-05
----------------------check_connections_block total spend ----------------------------- 0.017397642135620117
generate_one_block  0.014256000518798828
generate_one_block  0.0012998580932617188
generate_one_block  0.0011069774627685547
generate_one_block  0.0011456012725830078
generate_one_block  0.0011451244354248047
generate_one_block  0.0011436939239501953
generate_one_block  0.0010919570922851562
generate_one_block  0.001149892807006836
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012764930725097656
gen group dst list time:  0.0001366138458251953
time for parepare:  0.0006461143493652344
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  5.459785461425781e-05
r_  generation:  0.0003495216369628906
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00017952919006347656
mini_batch_src_global generation:  4.7206878662109375e-05
r_  generation:  0.00028204917907714844
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00015997886657714844
mini_batch_src_global generation:  5.269050598144531e-05
r_  generation:  0.00028777122497558594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003561973571777344
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0001423358917236328
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0001895427703857422
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00030231475830078125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002605915069580078
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001461505889892578
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.000385284423828125
----------------------check_connections_block total spend ----------------------------- 0.0059239864349365234
generate_one_block  0.0014574527740478516
generate_one_block  0.001338958740234375
generate_one_block  0.0013794898986816406
generate_one_block  0.001486063003540039
generate_one_block  0.0014071464538574219
generate_one_block  0.0015943050384521484
generate_one_block  0.001394033432006836
generate_one_block  0.0017249584197998047
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016255378723144531
gen group dst list time:  0.00010943412780761719
time for parepare:  0.0006210803985595703
local_output_nid generation:  5.245208740234375e-05
local_in_edges_tensor generation:  0.0007870197296142578
mini_batch_src_global generation:  0.0004165172576904297
r_  generation:  0.0010068416595458984
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0002455711364746094
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0006957054138183594
local_output_nid generation:  3.337860107421875e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0007774829864501953
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0009920597076416016
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001881122589111328
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0007054805755615234
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0008935928344726562
local_output_nid generation:  3.170967102050781e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0006694793701171875
local_output_nid generation:  4.076957702636719e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.000982522964477539
----------------------check_connections_block total spend ----------------------------- 0.013393163681030273
generate_one_block  0.0029506683349609375
generate_one_block  0.0020411014556884766
generate_one_block  0.0019524097442626953
generate_one_block  0.0052220821380615234
generate_one_block  0.0019605159759521484
generate_one_block  0.002175569534301758
generate_one_block  0.0018661022186279297
generate_one_block  0.002262592315673828
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0015001296997070312  GigaBytes
Max Memory Allocated: 0.0015001296997070312  GigaBytes

{'VmPeak': 20808.89453125, 'VmSize': 20657.2578125, 'VmHWM': 3621.27734375, 'VmRSS': 3621.27734375}
connection checking time:  0.019317150115966797
block generation total time  0.032213449478149414
average batch blocks generation time:  0.004026681184768677
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.00829935073852539  GigaBytes
Max Memory Allocated: 0.00829935073852539  GigaBytes

{'VmPeak': 21005.6875, 'VmSize': 20977.859375, 'VmHWM': 3911.5703125, 'VmRSS': 3911.5703125}
torch.Size([1268, 1433])
torch.Size([557, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00937032699584961  GigaBytes
Max Memory Allocated: 0.00972747802734375  GigaBytes

{'VmPeak': 21753.8046875, 'VmSize': 21751.0703125, 'VmHWM': 4606.8125, 'VmRSS': 4606.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.008792400360107422  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21756.98828125, 'VmSize': 21756.98828125, 'VmHWM': 4613.73046875, 'VmRSS': 4613.73046875}
torch.Size([1081, 1433])
torch.Size([386, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.009577274322509766  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21756.98828125, 'VmSize': 21756.98828125, 'VmHWM': 4613.73046875, 'VmRSS': 4613.73046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.008463382720947266  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21756.98828125, 'VmSize': 21756.98828125, 'VmHWM': 4614.890625, 'VmRSS': 4614.890625}
torch.Size([1019, 1433])
torch.Size([397, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009293556213378906  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21756.98828125, 'VmSize': 21756.98828125, 'VmHWM': 4614.890625, 'VmRSS': 4614.890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.009922981262207031  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4615.87890625, 'VmRSS': 4615.87890625}
torch.Size([1291, 1433])
torch.Size([565, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.01105642318725586  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4615.87890625, 'VmRSS': 4615.87890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.008631229400634766  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.08984375, 'VmRSS': 4616.08984375}
torch.Size([1051, 1433])
torch.Size([393, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.009418010711669922  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.08984375, 'VmRSS': 4616.08984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.009786605834960938  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
torch.Size([1266, 1433])
torch.Size([478, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.010811805725097656  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.007648944854736328  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
torch.Size([867, 1433])
torch.Size([350, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.008349418640136719  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.010004043579101562  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
torch.Size([1306, 1433])
torch.Size([520, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.011132240295410156  GigaBytes
Max Memory Allocated: 0.015540122985839844  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4616.6796875, 'VmRSS': 4616.6796875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00856173038482666 |0.04675129055976868 |0.10097804665565491 |0.00016003847122192383 |0.0027212202548980713 |0.002849102020263672 |
----------------------------------------------------------pseudo_mini_loss sum 3.783449411392212
{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4617.0546875, 'VmRSS': 4617.0546875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13549
Number of first layer input nodes during this epoch:  9149
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.01307535171508789  GigaBytes
Max Memory Allocated: 0.015809059143066406  GigaBytes

{'VmPeak': 21758.13671875, 'VmSize': 21758.13671875, 'VmHWM': 4617.0546875, 'VmRSS': 4617.0546875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004954338073730469
global_2_local 6.818771362304688e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.030632019042969e-05
before graph partition 
		86, 118, 83, 87, 78, 84, 121, 94, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0001926422119140625
	Initialize BitList time :  1.0728836059570312e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 86, 118

	before terminate 1 the average redundancy rate is:  1.267080745341615
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223947
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
	walk terminate 1 spend time 4.955471038818359
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2608695652173911,  1.2422360248447204,  1.279503105590062
	walk terminate 1 spend time 5.083021640777588
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		100, 103, 83, 87, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				21, 15, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005009174346923828
	Initialize BitList time :  3.7670135498046875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 103, 83

	before terminate 1 the average redundancy rate is:  1.15527950310559
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.15527950310559,  1.279503105590062,  1.031055900621118
	walk terminate 1 spend time 4.986710071563721
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 103, 87, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				21, 18, 15, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003523826599121094
	Initialize BitList time :  3.123283386230469e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 103, 87

	before terminate 1 the average redundancy rate is:  1.1801242236024845
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1801242236024845,  1.279503105590062,  1.0807453416149069
	walk terminate 1 spend time 4.940901041030884
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 103, 78, 84, 121, 94, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				21, 18, 18, 15, 18, 18, 18, 14, 


	preparing two sides time :  0.0005588531494140625
	Initialize BitList time :  4.673004150390625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 103, 78

	before terminate 1 the average redundancy rate is:  1.124223602484472
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.124223602484472,  1.279503105590062,  0.968944099378882
	walk terminate 1 spend time 5.095542669296265
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 78, 103, 84, 121, 94, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				21, 18, 18, 18, 15, 18, 18, 14, 


	preparing two sides time :  0.0004782676696777344
	Initialize BitList time :  4.029273986816406e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 103, 84

	before terminate 1 the average redundancy rate is:  1.1614906832298137
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1614906832298137,  1.279503105590062,  1.0434782608695652
	walk terminate 1 spend time 4.973891735076904
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 87, 78, 84, 103, 121, 94, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				21, 18, 18, 18, 18, 15, 18, 14, 


	preparing two sides time :  0.0005235671997070312
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 103, 121

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.4409937888198758,  1.329192546583851
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.4409937888198758,  1.329192546583851
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.5527950310559007,  1.2173913043478262
	walk terminate 1 spend time 5.0296924114227295
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.031055900621118,  1.7391304347826086
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.1180124223602483,  1.6521739130434783
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3850931677018634,  1.1180124223602483,  1.6521739130434783
	walk terminate 1 spend time 5.149332046508789
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 87, 78, 84, 90, 133, 94, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				21, 18, 18, 18, 18, 19, 14, 14, 


	preparing two sides time :  0.0005002021789550781
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 133, 94

	before terminate 1 the average redundancy rate is:  1.4099378881987579
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.453416149068323,  1.3540372670807452
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
	walk terminate 1 spend time 4.943474054336548
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.5279503105590062,  1.279503105590062
	walk terminate 1 spend time 5.031133651733398
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		100, 83, 87, 78, 84, 90, 103, 123, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 50.21680688858032
partition_len_list
[100, 83, 87, 78, 84, 90, 103, 123]
range_init_graph_partition selection method range initialization spend 50.21737480163574
time for parepare:  0.00023031234741210938
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0016453266143798828
mini_batch_src_global generation:  0.00013184547424316406
r_  generation:  0.0007524490356445312
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  9.918212890625e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00027060508728027344
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  8.416175842285156e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00026535987854003906
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  7.200241088867188e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00029730796813964844
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00010728836059570312
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0002751350402832031
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00025844573974609375
mini_batch_src_global generation:  4.267692565917969e-05
r_  generation:  0.00011515617370605469
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0002338886260986328
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  8.726119995117188e-05
----------------------check_connections_block total spend ----------------------------- 0.007353067398071289
generate_one_block  0.02889561653137207
generate_one_block  0.0012874603271484375
generate_one_block  0.0014302730560302734
generate_one_block  0.0010745525360107422
generate_one_block  0.0010800361633300781
generate_one_block  0.0010802745819091797
generate_one_block  0.001088857650756836
generate_one_block  0.0011098384857177734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001795053482055664
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.0006761550903320312
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0012309551239013672
mini_batch_src_global generation:  0.00013136863708496094
r_  generation:  0.0004115104675292969
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00018525123596191406
mini_batch_src_global generation:  8.058547973632812e-05
r_  generation:  0.0002512931823730469
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013375282287597656
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002753734588623047
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  0.00015544891357421875
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001277923583984375
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.00022411346435546875
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00024271011352539062
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002880096435546875
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  4.57763671875e-05
r_  generation:  0.00033926963806152344
----------------------check_connections_block total spend ----------------------------- 0.006476163864135742
generate_one_block  0.0014452934265136719
generate_one_block  0.001293182373046875
generate_one_block  0.0013437271118164062
generate_one_block  0.0012106895446777344
generate_one_block  0.00139617919921875
generate_one_block  0.001367330551147461
generate_one_block  0.0015635490417480469
generate_one_block  0.001546621322631836
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016322135925292969
gen group dst list time:  0.00010561943054199219
time for parepare:  0.0004975795745849609
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0013608932495117188
mini_batch_src_global generation:  0.0004322528839111328
r_  generation:  0.0009028911590576172
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00036025047302246094
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0006937980651855469
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  8.821487426757812e-05
r_  generation:  0.000751495361328125
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  7.009506225585938e-05
r_  generation:  0.0005078315734863281
local_output_nid generation:  3.9577484130859375e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.00016236305236816406
r_  generation:  0.0008559226989746094
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00021409988403320312
mini_batch_src_global generation:  9.34600830078125e-05
r_  generation:  0.0007269382476806641
local_output_nid generation:  3.910064697265625e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0008764266967773438
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00030803680419921875
mini_batch_src_global generation:  9.679794311523438e-05
r_  generation:  0.0008220672607421875
----------------------check_connections_block total spend ----------------------------- 0.013658285140991211
generate_one_block  0.003360271453857422
generate_one_block  0.0029087066650390625
generate_one_block  0.0024597644805908203
generate_one_block  0.0016436576843261719
generate_one_block  0.002221345901489258
generate_one_block  0.001951456069946289
generate_one_block  0.0022056102752685547
generate_one_block  0.0020439624786376953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.01307535171508789  GigaBytes
Max Memory Allocated: 0.015809059143066406  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.15234375, 'VmHWM': 4618.0625, 'VmRSS': 4617.95703125}
connection checking time:  0.020134449005126953
block generation total time  0.029961347579956055
average batch blocks generation time:  0.003745168447494507
block dataloader generation time/epoch 50.32810950279236
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012505531311035156  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.15234375, 'VmHWM': 4618.2109375, 'VmRSS': 4618.2109375}
torch.Size([1214, 1433])
torch.Size([582, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013651847839355469  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.15234375, 'VmHWM': 4618.21484375, 'VmRSS': 4618.21484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011873722076416016  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.15234375, 'VmHWM': 4618.22265625, 'VmRSS': 4618.22265625}
torch.Size([1097, 1433])
torch.Size([418, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012720584869384766  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.15234375, 'VmHWM': 4618.22265625, 'VmRSS': 4618.22265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012498855590820312  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
torch.Size([1102, 1433])
torch.Size([391, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.01331329345703125  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.010549068450927734  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
torch.Size([850, 1433])
torch.Size([282, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011168956756591797  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012722492218017578  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
torch.Size([1255, 1433])
torch.Size([511, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013721466064453125  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.011462211608886719  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
torch.Size([1020, 1433])
torch.Size([387, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.012276649475097656  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.13671875, 'VmHWM': 4618.22265625, 'VmRSS': 4618.21484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013061046600341797  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.28515625, 'VmHWM': 4618.26171875, 'VmRSS': 4618.26171875}
torch.Size([1318, 1433])
torch.Size([499, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.014081478118896484  GigaBytes
Max Memory Allocated: 0.019446849822998047  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.28515625, 'VmHWM': 4618.26171875, 'VmRSS': 4618.26171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.013071060180664062  GigaBytes
Max Memory Allocated: 0.020080089569091797  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.28515625, 'VmHWM': 4618.26171875, 'VmRSS': 4618.26171875}
torch.Size([1140, 1433])
torch.Size([463, 128])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2537841796875 GB
    Memory Allocated: 0.014073848724365234  GigaBytes
Max Memory Allocated: 0.020080089569091797  GigaBytes

{'VmPeak': 21886.15234375, 'VmSize': 21822.28515625, 'VmHWM': 4618.26171875, 'VmRSS': 4618.26171875}
{'VmPeak': 21886.15234375, 'VmSize': 21822.28515625, 'VmHWM': 4618.265625, 'VmRSS': 4618.265625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012261927127838135 |0.0006371438503265381 |0.006618976593017578 |0.0002168118953704834 |0.0031571686267852783 |0.0022153854370117188 |
----------------------------------------------------------pseudo_mini_loss sum 1.7132583856582642
{'VmPeak': 21886.15234375, 'VmSize': 21822.28515625, 'VmHWM': 4618.265625, 'VmRSS': 4618.265625}
Total (block generation + training)time/epoch 50.52738547325134
Training time/epoch 0.19859838485717773
Training time without block to device /epoch 0.19350123405456543
Training time without total dataloading part /epoch 0.08215904235839844
load block tensor time/epoch 0.09809541702270508
block to device time/epoch 0.005097150802612305
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13277
Number of first layer input nodes during this epoch:  8996
