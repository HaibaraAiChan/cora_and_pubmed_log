main start at this time 1648604506.648904
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20805.1328125, 'VmSize': 20801.5625, 'VmHWM': 3612.56640625, 'VmRSS': 3612.56640625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014467239379882812
global_2_local 8.821487426757812e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  4.57763671875e-05
before graph partition 
		71, 93, 84, 121, 97, 105, 111, 66, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00019359588623046875
	Initialize BitList time :  1.2159347534179688e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 71, 93

	before terminate 1 the average redundancy rate is:  1.0186335403726707
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0186335403726707,  0.8819875776397516,  1.15527950310559
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0186335403726707,  0.8819875776397516,  1.15527950310559
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0186335403726707,  0.8819875776397516,  1.15527950310559
	walk terminate 1 spend time 4.48656702041626
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		71, 93, 84, 121, 97, 105, 111, 66, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00029969215393066406
	Initialize BitList time :  2.2649765014648438e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 93, 84

	before terminate 1 the average redundancy rate is:  1.0993788819875776
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.15527950310559,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.15527950310559,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.15527950310559,  1.0434782608695652
	walk terminate 1 spend time 4.444241046905518
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		71, 84, 93, 121, 97, 105, 111, 66, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00031065940856933594
	Initialize BitList time :  2.8371810913085938e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 93, 121

	before terminate 1 the average redundancy rate is:  1.329192546583851
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.6024844720496894,  1.0434782608695652
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.391304347826087,  1.2546583850931676
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.391304347826087,  1.2546583850931676
	walk terminate 1 spend time 4.489112138748169
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.1677018633540373,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.3788819875776397,  1.2670807453416149
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.204968944099379,  1.4285714285714286
	walk terminate 1 spend time 4.5585901737213135
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		71, 84, 97, 115, 97, 105, 111, 66, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.00047516822814941406
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 115, 97

	before terminate 1 the average redundancy rate is:  1.3167701863354038
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.4285714285714286,  1.204968944099379
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.5776397515527951,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3167701863354038,  1.3043478260869565
	walk terminate 1 spend time 4.513166427612305
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.1055900621118013,  1.515527950310559
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.329192546583851,  1.2919254658385093
						 current side  0
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.0559006211180124,  1.5279503105590062
	walk terminate 1 spend time 4.455651044845581
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		71, 84, 97, 85, 123, 105, 111, 66, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 16, 23, 18, 18, 14, 


	preparing two sides time :  0.00044918060302734375
	Initialize BitList time :  3.3855438232421875e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 123, 105

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.5279503105590062,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.5279503105590062,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.5279503105590062,  1.3043478260869565
	walk terminate 1 spend time 4.6229941844940186
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		71, 84, 97, 85, 105, 123, 111, 66, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 16, 18, 23, 18, 14, 


	preparing two sides time :  0.0005099773406982422
	Initialize BitList time :  3.743171691894531e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 123, 111

	before terminate 1 the average redundancy rate is:  1.4534161490683228
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.3043478260869565,  1.5900621118012421
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.3043478260869565,  1.5900621118012421
						 current side  0
			 redundancy will reduce  0.01863354037267051
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.1055900621118013,  1.763975155279503
	walk terminate 1 spend time 4.478731870651245
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.3416149068322982,  1.5527950310559007
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.1428571428571428,  1.7515527950310559
						 current side  1
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.3167701863354038,  1.565217391304348
	walk terminate 1 spend time 4.553930282592773
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		71, 84, 97, 85, 105, 106, 126, 66, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 16, 18, 21, 20, 14, 


	preparing two sides time :  0.0004680156707763672
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 126, 66

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.565217391304348,  0.8198757763975155
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.565217391304348,  0.8198757763975155
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.565217391304348,  0.8198757763975155
	walk terminate 1 spend time 4.456748008728027
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		71, 84, 97, 85, 105, 106, 66, 126, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 45.083677530288696
partition_len_list
[71, 84, 97, 85, 105, 106, 66, 126]
range_init_graph_partition selection method range initialization spend 45.08448386192322
time for parepare:  0.0001780986785888672
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00102996826171875
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.016260385513305664
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  6.103515625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010442733764648438
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.152557373046875e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.989738464355469e-05
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  5.650520324707031e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00011372566223144531
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001125335693359375
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  6.198883056640625e-05
----------------------check_connections_block total spend ----------------------------- 0.020131587982177734
generate_one_block  0.012217283248901367
generate_one_block  0.0013415813446044922
generate_one_block  0.0010352134704589844
generate_one_block  0.0011801719665527344
generate_one_block  0.0011014938354492188
generate_one_block  0.001031637191772461
generate_one_block  0.0010111331939697266
generate_one_block  0.001047372817993164
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010488033294677734
gen group dst list time:  0.00014138221740722656
time for parepare:  0.00036144256591796875
local_output_nid generation:  1.8358230590820312e-05
local_in_edges_tensor generation:  0.0004050731658935547
mini_batch_src_global generation:  6.175041198730469e-05
r_  generation:  0.0001838207244873047
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00019621849060058594
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00011873245239257812
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002682209014892578
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00011110305786132812
mini_batch_src_global generation:  3.24249267578125e-05
r_  generation:  0.0001857280731201172
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00025272369384765625
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0002911090850830078
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00017309188842773438
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00011396408081054688
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0003001689910888672
----------------------check_connections_block total spend ----------------------------- 0.004494428634643555
generate_one_block  0.002385377883911133
generate_one_block  0.0011816024780273438
generate_one_block  0.0013189315795898438
generate_one_block  0.001199960708618164
generate_one_block  0.0014042854309082031
generate_one_block  0.006379365921020508
generate_one_block  0.0011394023895263672
generate_one_block  0.0013546943664550781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006468296051025391
gen group dst list time:  9.942054748535156e-05
time for parepare:  0.0005724430084228516
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.000835418701171875
mini_batch_src_global generation:  0.00022602081298828125
r_  generation:  0.0006060600280761719
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.000194549560546875
mini_batch_src_global generation:  0.0004093647003173828
r_  generation:  0.0007128715515136719
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  0.0001595020294189453
r_  generation:  0.0009126663208007812
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.0001766681671142578
mini_batch_src_global generation:  0.0017352104187011719
r_  generation:  0.0006685256958007812
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.00020170211791992188
mini_batch_src_global generation:  0.00022482872009277344
r_  generation:  0.0009756088256835938
local_output_nid generation:  4.696846008300781e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.0009849071502685547
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006463527679443359
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001926422119140625
mini_batch_src_global generation:  0.00012302398681640625
r_  generation:  0.0010018348693847656
----------------------check_connections_block total spend ----------------------------- 0.015537738800048828
generate_one_block  0.002070188522338867
generate_one_block  0.0021016597747802734
generate_one_block  0.002264738082885742
generate_one_block  0.0019826889038085938
generate_one_block  0.002438783645629883
generate_one_block  0.0024781227111816406
generate_one_block  0.0021114349365234375
generate_one_block  0.0025866031646728516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20807.8984375, 'VmSize': 20656.26953125, 'VmHWM': 3620.0078125, 'VmRSS': 3620.0078125}
connection checking time:  0.020032167434692383
block generation total time  0.03439784049987793
average batch blocks generation time:  0.004299730062484741
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005414485931396484  GigaBytes
Max Memory Allocated: 0.005414485931396484  GigaBytes

{'VmPeak': 21006.62890625, 'VmSize': 20977.91015625, 'VmHWM': 3911.1640625, 'VmRSS': 3911.1640625}
torch.Size([977, 1433])
torch.Size([347, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005527973175048828  GigaBytes
Max Memory Allocated: 0.005553245544433594  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21753.76171875, 'VmHWM': 4609.375, 'VmRSS': 4609.375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00615692138671875  GigaBytes
Max Memory Allocated: 0.011350154876708984  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21759.7734375, 'VmHWM': 4615.95703125, 'VmRSS': 4615.95703125}
torch.Size([1082, 1433])
torch.Size([403, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006289482116699219  GigaBytes
Max Memory Allocated: 0.011350154876708984  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21759.7734375, 'VmHWM': 4615.95703125, 'VmRSS': 4615.95703125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006968498229980469  GigaBytes
Max Memory Allocated: 0.01271677017211914  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21760.59765625, 'VmHWM': 4617.51953125, 'VmRSS': 4617.51953125}
torch.Size([1233, 1433])
torch.Size([536, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007136821746826172  GigaBytes
Max Memory Allocated: 0.01271677017211914  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21760.59765625, 'VmHWM': 4617.6171875, 'VmRSS': 4617.6171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005706310272216797  GigaBytes
Max Memory Allocated: 0.01271677017211914  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21760.59765625, 'VmHWM': 4617.8515625, 'VmRSS': 4617.8515625}
torch.Size([998, 1433])
torch.Size([346, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005825042724609375  GigaBytes
Max Memory Allocated: 0.01271677017211914  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21760.59765625, 'VmHWM': 4617.8515625, 'VmRSS': 4617.8515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007445812225341797  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4618.484375, 'VmRSS': 4618.484375}
torch.Size([1322, 1433])
torch.Size([544, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007619380950927734  GigaBytes
Max Memory Allocated: 0.012743473052978516  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4618.484375, 'VmRSS': 4618.484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007534980773925781  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4618.60546875, 'VmRSS': 4618.60546875}
torch.Size([1271, 1433])
torch.Size([609, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007724761962890625  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4618.60546875, 'VmRSS': 4618.60546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005513668060302734  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4618.65625, 'VmRSS': 4618.65625}
torch.Size([962, 1433])
torch.Size([345, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005627155303955078  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4618.65625, 'VmRSS': 4618.65625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007275581359863281  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4619.0, 'VmRSS': 4619.0}
torch.Size([1290, 1433])
torch.Size([596, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007465839385986328  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4619.0, 'VmRSS': 4619.0}
{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4619.25, 'VmRSS': 4619.25}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011003762483596802 |0.04654446244239807 |0.10003536939620972 |0.0001424252986907959 |0.0027860701084136963 |0.0026712417602539062 |
----------------------------------------------------------pseudo_mini_loss sum 3.395249366760254
{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4619.25, 'VmRSS': 4619.25}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13601
Number of first layer input nodes during this epoch:  9135
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007702827453613281  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21762.28125, 'VmSize': 21761.0859375, 'VmHWM': 4619.25, 'VmRSS': 4619.25}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005714893341064453
global_2_local 9.5367431640625e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.127357482910156e-05
before graph partition 
		130, 102, 71, 89, 98, 103, 92, 64, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00025391578674316406
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 130, 102

	before terminate 1 the average redundancy rate is:  1.4409937888198758
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.4782608695652173,  1.391304347826087
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
	walk terminate 1 spend time 5.1476194858551025
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
	walk terminate 1 spend time 5.383197784423828
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		101, 130, 71, 89, 98, 103, 92, 64, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004851818084716797
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 130, 71

	before terminate 1 the average redundancy rate is:  1.2484472049689441
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6149068322981366,  0.8819875776397516
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6149068322981366,  0.8819875776397516
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6149068322981366,  0.8819875776397516
	walk terminate 1 spend time 5.383591175079346
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 130, 89, 98, 103, 92, 64, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003783702850341797
	Initialize BitList time :  2.86102294921875e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 130, 89

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.6149068322981366,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.6149068322981366,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.6149068322981366,  1.1055900621118013
	walk terminate 1 spend time 5.310580730438232
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 130, 98, 103, 92, 64, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047016143798828125
	Initialize BitList time :  3.409385681152344e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 130, 98

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.6149068322981366,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.6149068322981366,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.6149068322981366,  1.2173913043478262
	walk terminate 1 spend time 5.286020755767822
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 130, 103, 92, 64, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004725456237792969
	Initialize BitList time :  3.314018249511719e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 130, 103

	before terminate 1 the average redundancy rate is:  1.4472049689440993
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.6149068322981366,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.6149068322981366,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.6149068322981366,  1.279503105590062
	walk terminate 1 spend time 5.460836410522461
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 103, 130, 92, 64, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004639625549316406
	Initialize BitList time :  3.3855438232421875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 130, 92

	before terminate 1 the average redundancy rate is:  1.3788819875776397
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.6149068322981366,  1.1428571428571428
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.6149068322981366,  1.1428571428571428
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.6149068322981366,  1.1428571428571428
	walk terminate 1 spend time 5.249349355697632
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 103, 92, 130, 64, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004801750183105469
	Initialize BitList time :  9.799003601074219e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 130, 64

	before terminate 1 the average redundancy rate is:  1.2049689440993787
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.6149068322981366,  0.7950310559006211
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.6149068322981366,  0.7950310559006211
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.6149068322981366,  0.7950310559006211
	walk terminate 1 spend time 5.409359455108643
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 103, 92, 64, 130, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 42.65663385391235
partition_len_list
[101, 71, 89, 98, 103, 92, 64, 130]
range_init_graph_partition selection method range initialization spend 42.65714502334595
time for parepare:  0.00017142295837402344
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.06357932090759277
mini_batch_src_global generation:  0.002086639404296875
r_  generation:  0.0002789497375488281
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00028586387634277344
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  6.604194641113281e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  2.193450927734375e-05
r_  generation:  4.506111145019531e-05
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00013828277587890625
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001544952392578125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.38690185546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  3.886222839355469e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  5.841255187988281e-05
----------------------check_connections_block total spend ----------------------------- 0.06888198852539062
generate_one_block  0.012761116027832031
generate_one_block  0.0012164115905761719
generate_one_block  0.0012519359588623047
generate_one_block  0.0010232925415039062
generate_one_block  0.0010151863098144531
generate_one_block  0.0010485649108886719
generate_one_block  0.0009891986846923828
generate_one_block  0.0010101795196533203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029173851013183594
gen group dst list time:  0.00010204315185546875
time for parepare:  0.0006244182586669922
local_output_nid generation:  3.981590270996094e-05
local_in_edges_tensor generation:  0.07932662963867188
mini_batch_src_global generation:  0.0001747608184814453
r_  generation:  0.0004088878631591797
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  6.985664367675781e-05
r_  generation:  0.0002319812774658203
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  7.510185241699219e-05
r_  generation:  0.0003228187561035156
local_output_nid generation:  2.2649765014648438e-05
local_in_edges_tensor generation:  0.0002257823944091797
mini_batch_src_global generation:  0.00011467933654785156
r_  generation:  0.0003428459167480469
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.0001728534698486328
mini_batch_src_global generation:  4.982948303222656e-05
r_  generation:  0.0002834796905517578
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00017309188842773438
mini_batch_src_global generation:  5.2928924560546875e-05
r_  generation:  0.0003330707550048828
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00015544891357421875
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001666545867919922
mini_batch_src_global generation:  8.702278137207031e-05
r_  generation:  0.0005128383636474609
----------------------check_connections_block total spend ----------------------------- 0.0863027572631836
generate_one_block  0.0025022029876708984
generate_one_block  0.0018761157989501953
generate_one_block  0.0018048286437988281
generate_one_block  0.0016007423400878906
generate_one_block  0.001569509506225586
generate_one_block  0.0014879703521728516
generate_one_block  0.0015575885772705078
generate_one_block  0.0016145706176757812
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014095306396484375
gen group dst list time:  0.00019359588623046875
time for parepare:  0.0007145404815673828
local_output_nid generation:  4.9114227294921875e-05
local_in_edges_tensor generation:  0.0010082721710205078
mini_batch_src_global generation:  0.0003085136413574219
r_  generation:  0.0009608268737792969
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  9.298324584960938e-05
r_  generation:  0.0006644725799560547
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  0.0001087188720703125
r_  generation:  0.0009965896606445312
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.0002148151397705078
mini_batch_src_global generation:  0.00011730194091796875
r_  generation:  0.0009675025939941406
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.0002009868621826172
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007913112640380859
local_output_nid generation:  6.651878356933594e-05
local_in_edges_tensor generation:  0.00021696090698242188
mini_batch_src_global generation:  0.00012063980102539062
r_  generation:  0.0011248588562011719
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002048015594482422
mini_batch_src_global generation:  0.000110626220703125
r_  generation:  0.0008904933929443359
local_output_nid generation:  6.222724914550781e-05
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  0.00014019012451171875
r_  generation:  0.0012905597686767578
----------------------check_connections_block total spend ----------------------------- 0.014745712280273438
generate_one_block  0.0033261775970458984
generate_one_block  0.0020563602447509766
generate_one_block  0.0023005008697509766
generate_one_block  0.0020825862884521484
generate_one_block  0.0017213821411132812
generate_one_block  0.0022804737091064453
generate_one_block  0.0018873214721679688
generate_one_block  0.0023458003997802734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007702827453613281  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.1015625, 'VmHWM': 4620.0546875, 'VmRSS': 4620.01953125}
connection checking time:  0.10104846954345703
block generation total time  0.03201413154602051
average batch blocks generation time:  0.0040017664432525635
block dataloader generation time/epoch 42.92343783378601
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0060672760009765625  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.09765625, 'VmRSS': 4620.08984375}
torch.Size([999, 1433])
torch.Size([433, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006210803985595703  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.09765625, 'VmRSS': 4620.08984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0052280426025390625  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
torch.Size([843, 1433])
torch.Size([296, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005328655242919922  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007275104522705078  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
torch.Size([1225, 1433])
torch.Size([442, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007419109344482422  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006347179412841797  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
torch.Size([1051, 1433])
torch.Size([431, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006491661071777344  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005401611328125  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
torch.Size([875, 1433])
torch.Size([337, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005522251129150391  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006947040557861328  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
torch.Size([1163, 1433])
torch.Size([513, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007109165191650391  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00649261474609375  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
torch.Size([1079, 1433])
torch.Size([396, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0066165924072265625  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.0859375, 'VmHWM': 4620.23046875, 'VmRSS': 4620.23046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007992744445800781  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.28125, 'VmHWM': 4620.34375, 'VmRSS': 4620.34375}
torch.Size([1358, 1433])
torch.Size([622, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008191108703613281  GigaBytes
Max Memory Allocated: 0.014561653137207031  GigaBytes

{'VmPeak': 21889.1015625, 'VmSize': 21825.28125, 'VmHWM': 4620.34375, 'VmRSS': 4620.34375}
{'VmPeak': 21889.1015625, 'VmSize': 21825.28125, 'VmHWM': 4620.34765625, 'VmRSS': 4620.34765625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0033453404903411865 |0.0004928410053253174 |0.0036717653274536133 |0.00013893842697143555 |0.002438873052597046 |0.0018892288208007812 |
----------------------------------------------------------pseudo_mini_loss sum 2.467045783996582
{'VmPeak': 21889.1015625, 'VmSize': 21825.28125, 'VmHWM': 4620.34765625, 'VmRSS': 4620.34765625}
Total (block generation + training)time/epoch 43.01719808578491
Training time/epoch 0.09356427192687988
Training time without block to device /epoch 0.08962154388427734
Training time without total dataloading part /epoch 0.05188584327697754
load block tensor time/epoch 0.026762723922729492
block to device time/epoch 0.003942728042602539
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12811
Number of first layer input nodes during this epoch:  8593
