main start at this time 1648604904.9725907
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20865.67578125, 'VmSize': 20865.67578125, 'VmHWM': 3613.015625, 'VmRSS': 3613.015625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011670589447021484
global_2_local 7.43865966796875e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.2928924560546875e-05
before graph partition 
		71, 93, 84, 121, 97, 105, 111, 66, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00021982192993164062
	Initialize BitList time :  1.2636184692382812e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 71, 93

	before terminate 1 the average redundancy rate is:  1.0186335403726707
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0186335403726707,  0.8819875776397516,  1.15527950310559
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0186335403726707,  0.8819875776397516,  1.15527950310559
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0186335403726707,  0.8819875776397516,  1.15527950310559
	walk terminate 1 spend time 5.052465438842773
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		71, 93, 84, 121, 97, 105, 111, 66, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0006079673767089844
	Initialize BitList time :  4.100799560546875e-05
	getRedundancyCost: time   6.198883056640625e-06

					length of partitions 93, 84

	before terminate 1 the average redundancy rate is:  1.0993788819875776
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.15527950310559,  1.0434782608695652
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.15527950310559,  1.0434782608695652
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0993788819875776,  1.15527950310559,  1.0434782608695652
	walk terminate 1 spend time 5.1824116706848145
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		71, 84, 93, 121, 97, 105, 111, 66, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004630088806152344
	Initialize BitList time :  3.9577484130859375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 93, 121

	before terminate 1 the average redundancy rate is:  1.329192546583851
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.6024844720496894,  1.0434782608695652
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.391304347826087,  1.2546583850931676
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.391304347826087,  1.2546583850931676
	walk terminate 1 spend time 5.222862243652344
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.1677018633540373,  1.4782608695652173
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3229813664596273,  1.3788819875776397,  1.2670807453416149
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.204968944099379,  1.4285714285714286
	walk terminate 1 spend time 5.059759140014648
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		71, 84, 97, 115, 97, 105, 111, 66, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.00047326087951660156
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 115, 97

	before terminate 1 the average redundancy rate is:  1.3167701863354038
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3167701863354038,  1.4285714285714286,  1.204968944099379
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.5776397515527951,  1.031055900621118
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.3167701863354038,  1.3043478260869565
	walk terminate 1 spend time 5.054251432418823
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.1055900621118013,  1.515527950310559
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.31055900621118,  1.329192546583851,  1.2919254658385093
						 current side  0
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.0559006211180124,  1.5279503105590062
	walk terminate 1 spend time 5.115387678146362
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		71, 84, 97, 85, 123, 105, 111, 66, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 16, 23, 18, 18, 14, 


	preparing two sides time :  0.0005197525024414062
	Initialize BitList time :  4.00543212890625e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 123, 105

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.5279503105590062,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.5279503105590062,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.5279503105590062,  1.3043478260869565
	walk terminate 1 spend time 5.188847303390503
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		71, 84, 97, 85, 105, 123, 111, 66, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 16, 18, 23, 18, 14, 


	preparing two sides time :  0.0005223751068115234
	Initialize BitList time :  0.00011038780212402344
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 123, 111

	before terminate 1 the average redundancy rate is:  1.4534161490683228
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.3043478260869565,  1.5900621118012421
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.3043478260869565,  1.5900621118012421
						 current side  0
			 redundancy will reduce  0.01863354037267051
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4347826086956523,  1.1055900621118013,  1.763975155279503
	walk terminate 1 spend time 5.155420541763306
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.3416149068322982,  1.5527950310559007
						 current side  0
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.1428571428571428,  1.7515527950310559
						 current side  1
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4409937888198758,  1.3167701863354038,  1.565217391304348
	walk terminate 1 spend time 5.114625453948975
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		71, 84, 97, 85, 105, 106, 126, 66, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 16, 18, 21, 20, 14, 


	preparing two sides time :  0.0005009174346923828
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 126, 66

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.565217391304348,  0.8198757763975155
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.565217391304348,  0.8198757763975155
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.565217391304348,  0.8198757763975155
	walk terminate 1 spend time 5.150839805603027
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		71, 84, 97, 85, 105, 106, 66, 126, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 51.324129581451416
partition_len_list
[71, 84, 97, 85, 105, 106, 66, 126]
range_init_graph_partition selection method range initialization spend 51.324836015701294
time for parepare:  0.00021219253540039062
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.0010352134704589844
mini_batch_src_global generation:  0.00060272216796875
r_  generation:  0.014083623886108398
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011038780212402344
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.8623809814453125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  2.2649765014648438e-05
r_  generation:  7.748603820800781e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010657310485839844
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  5.9604644775390625e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010204315185546875
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  5.078315734863281e-05
----------------------check_connections_block total spend ----------------------------- 0.01925182342529297
generate_one_block  0.01206517219543457
generate_one_block  0.0011670589447021484
generate_one_block  0.00107574462890625
generate_one_block  0.0010547637939453125
generate_one_block  0.001068115234375
generate_one_block  0.0010826587677001953
generate_one_block  0.0010230541229248047
generate_one_block  0.001081705093383789
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021333694458007812
gen group dst list time:  0.00015282630920410156
time for parepare:  0.00046896934509277344
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.0001919269561767578
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00015163421630859375
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0002110004425048828
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.0002734661102294922
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00020241737365722656
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001201629638671875
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00027298927307128906
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.0003314018249511719
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0001900196075439453
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00012254714965820312
mini_batch_src_global generation:  4.100799560546875e-05
r_  generation:  0.0003266334533691406
----------------------check_connections_block total spend ----------------------------- 0.004731178283691406
generate_one_block  0.0023202896118164062
generate_one_block  0.00122833251953125
generate_one_block  0.001338958740234375
generate_one_block  0.0012593269348144531
generate_one_block  0.0015628337860107422
generate_one_block  0.00786280632019043
generate_one_block  0.0012171268463134766
generate_one_block  0.0014688968658447266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007047653198242188
gen group dst list time:  0.00010466575622558594
time for parepare:  0.0005176067352294922
local_output_nid generation:  2.7179718017578125e-05
local_in_edges_tensor generation:  0.00032901763916015625
mini_batch_src_global generation:  0.0003135204315185547
r_  generation:  0.000667572021484375
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00017023086547851562
mini_batch_src_global generation:  0.00025773048400878906
r_  generation:  0.0007636547088623047
local_output_nid generation:  6.67572021484375e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  0.00014662742614746094
r_  generation:  0.0009558200836181641
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.00016045570373535156
mini_batch_src_global generation:  8.630752563476562e-05
r_  generation:  0.0006949901580810547
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0010035037994384766
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0001857280731201172
mini_batch_src_global generation:  0.00013589859008789062
r_  generation:  0.0010459423065185547
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00015854835510253906
mini_batch_src_global generation:  9.036064147949219e-05
r_  generation:  0.0006928443908691406
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0010600090026855469
----------------------check_connections_block total spend ----------------------------- 0.012767314910888672
generate_one_block  0.0018301010131835938
generate_one_block  0.001920938491821289
generate_one_block  0.0038383007049560547
generate_one_block  0.00414276123046875
generate_one_block  0.004972934722900391
generate_one_block  0.004987001419067383
generate_one_block  0.003187894821166992
generate_one_block  0.003383636474609375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20872.85546875, 'VmSize': 20720.6875, 'VmHWM': 3620.828125, 'VmRSS': 3620.828125}
connection checking time:  0.017498493194580078
block generation total time  0.04652214050292969
average batch blocks generation time:  0.005815267562866211
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005736827850341797  GigaBytes
Max Memory Allocated: 0.005736827850341797  GigaBytes

{'VmPeak': 21007.00390625, 'VmSize': 20977.9921875, 'VmHWM': 3911.51171875, 'VmRSS': 3911.51171875}
torch.Size([1037, 1433])
torch.Size([348, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005852222442626953  GigaBytes
Max Memory Allocated: 0.005880832672119141  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21749.52734375, 'VmHWM': 4604.8515625, 'VmRSS': 4604.8515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0065155029296875  GigaBytes
Max Memory Allocated: 0.012028217315673828  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21755.8125, 'VmHWM': 4611.484375, 'VmRSS': 4611.484375}
torch.Size([1149, 1433])
torch.Size([402, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006649017333984375  GigaBytes
Max Memory Allocated: 0.012028217315673828  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21755.8125, 'VmHWM': 4611.484375, 'VmRSS': 4611.484375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007177829742431641  GigaBytes
Max Memory Allocated: 0.01328277587890625  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21756.484375, 'VmHWM': 4613.59765625, 'VmRSS': 4613.59765625}
torch.Size([1272, 1433])
torch.Size([537, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007348537445068359  GigaBytes
Max Memory Allocated: 0.01328277587890625  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21756.484375, 'VmHWM': 4613.59765625, 'VmRSS': 4613.59765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006102561950683594  GigaBytes
Max Memory Allocated: 0.01328277587890625  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21756.484375, 'VmHWM': 4613.59765625, 'VmRSS': 4613.59765625}
torch.Size([1072, 1433])
torch.Size([349, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006222248077392578  GigaBytes
Max Memory Allocated: 0.01328277587890625  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21756.484375, 'VmHWM': 4613.59765625, 'VmRSS': 4613.59765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007729530334472656  GigaBytes
Max Memory Allocated: 0.01342153549194336  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4614.85546875, 'VmRSS': 4614.85546875}
torch.Size([1375, 1433])
torch.Size([541, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007904052734375  GigaBytes
Max Memory Allocated: 0.01342153549194336  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4614.85546875, 'VmRSS': 4614.85546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007346153259277344  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4614.8984375, 'VmRSS': 4614.8984375}
torch.Size([1303, 1433])
torch.Size([608, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007534980773925781  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4614.8984375, 'VmRSS': 4614.8984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005984783172607422  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4614.8984375, 'VmRSS': 4614.8984375}
torch.Size([1050, 1433])
torch.Size([349, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006099224090576172  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4614.8984375, 'VmRSS': 4614.8984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007405757904052734  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4615.31640625, 'VmRSS': 4615.31640625}
torch.Size([1314, 1433])
torch.Size([595, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007597923278808594  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4615.31640625, 'VmRSS': 4615.31640625}
{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4615.31640625, 'VmRSS': 4615.31640625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011664658784866333 |0.047268956899642944 |0.10395106673240662 |0.00017917156219482422 |0.0032161176204681396 |0.0022199153900146484 |
----------------------------------------------------------pseudo_mini_loss sum 3.3986153602600098
{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4615.75390625, 'VmRSS': 4615.75390625}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14041
Number of first layer input nodes during this epoch:  9572
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00783681869506836  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21764.640625, 'VmSize': 21757.05078125, 'VmHWM': 4615.75390625, 'VmRSS': 4615.75390625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005216598510742188
global_2_local 7.772445678710938e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.4836273193359375e-05
before graph partition 
		130, 102, 71, 89, 98, 103, 92, 64, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002040863037109375
	Initialize BitList time :  1.1920928955078125e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 130, 102

	before terminate 1 the average redundancy rate is:  1.4409937888198758
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.4782608695652173,  1.391304347826087
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
	walk terminate 1 spend time 6.018537759780884
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.434782608695652,  1.6149068322981366,  1.2546583850931676
	walk terminate 1 spend time 6.043862342834473
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		101, 130, 71, 89, 98, 103, 92, 64, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005617141723632812
	Initialize BitList time :  3.8623809814453125e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 130, 71

	before terminate 1 the average redundancy rate is:  1.2484472049689441
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6149068322981366,  0.8819875776397516
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6149068322981366,  0.8819875776397516
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.6149068322981366,  0.8819875776397516
	walk terminate 1 spend time 6.0985963344573975
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 130, 89, 98, 103, 92, 64, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004096031188964844
	Initialize BitList time :  3.266334533691406e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 130, 89

	before terminate 1 the average redundancy rate is:  1.360248447204969
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.6149068322981366,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.6149068322981366,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.360248447204969,  1.6149068322981366,  1.1055900621118013
	walk terminate 1 spend time 6.163746356964111
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 130, 98, 103, 92, 64, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005793571472167969
	Initialize BitList time :  0.0001163482666015625
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 130, 98

	before terminate 1 the average redundancy rate is:  1.4161490683229814
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.6149068322981366,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.6149068322981366,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4161490683229814,  1.6149068322981366,  1.2173913043478262
	walk terminate 1 spend time 6.00850248336792
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 130, 103, 92, 64, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00048089027404785156
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 130, 103

	before terminate 1 the average redundancy rate is:  1.4472049689440993
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.6149068322981366,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.6149068322981366,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4472049689440993,  1.6149068322981366,  1.279503105590062
	walk terminate 1 spend time 6.0294883251190186
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 103, 130, 92, 64, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004658699035644531
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 130, 92

	before terminate 1 the average redundancy rate is:  1.3788819875776397
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.6149068322981366,  1.1428571428571428
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.6149068322981366,  1.1428571428571428
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3788819875776397,  1.6149068322981366,  1.1428571428571428
	walk terminate 1 spend time 6.046987056732178
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 103, 92, 130, 64, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005381107330322266
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 130, 64

	before terminate 1 the average redundancy rate is:  1.2049689440993787
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.6149068322981366,  0.7950310559006211
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.6149068322981366,  0.7950310559006211
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2049689440993787,  1.6149068322981366,  0.7950310559006211
	walk terminate 1 spend time 6.034625291824341
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		101, 71, 89, 98, 103, 92, 64, 130, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 48.47281837463379
partition_len_list
[101, 71, 89, 98, 103, 92, 64, 130]
range_init_graph_partition selection method range initialization spend 48.47342324256897
time for parepare:  0.0002574920654296875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.002321481704711914
mini_batch_src_global generation:  0.0001671314239501953
r_  generation:  0.0006542205810546875
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00029850006103515625
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0002257823944091797
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.000274658203125
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  8.559226989746094e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.389617919921875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001804828643798828
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.3882598876953125e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00018596649169921875
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  6.532669067382812e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  3.075599670410156e-05
r_  generation:  6.961822509765625e-05
----------------------check_connections_block total spend ----------------------------- 0.007283449172973633
generate_one_block  0.029119491577148438
generate_one_block  0.0012233257293701172
generate_one_block  0.0012226104736328125
generate_one_block  0.0010766983032226562
generate_one_block  0.0010709762573242188
generate_one_block  0.0010652542114257812
generate_one_block  0.00103759765625
generate_one_block  0.0010793209075927734
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002144336700439453
gen group dst list time:  8.702278137207031e-05
time for parepare:  0.0007810592651367188
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.0003612041473388672
mini_batch_src_global generation:  0.00011157989501953125
r_  generation:  0.0003104209899902344
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00015354156494140625
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00024437904357910156
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019621849060058594
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0002684593200683594
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  3.719329833984375e-05
r_  generation:  0.00020551681518554688
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012969970703125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002307891845703125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  0.0002281665802001953
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  8.344650268554688e-05
r_  generation:  0.0003769397735595703
----------------------check_connections_block total spend ----------------------------- 0.005691051483154297
generate_one_block  0.001340627670288086
generate_one_block  0.0011949539184570312
generate_one_block  0.0012640953063964844
generate_one_block  0.001317739486694336
generate_one_block  0.0013577938079833984
generate_one_block  0.00142669677734375
generate_one_block  0.0012974739074707031
generate_one_block  0.0019865036010742188
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006968975067138672
gen group dst list time:  0.00010228157043457031
time for parepare:  0.0005357265472412109
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00046253204345703125
mini_batch_src_global generation:  0.00028824806213378906
r_  generation:  0.0007481575012207031
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0005242824554443359
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0002071857452392578
mini_batch_src_global generation:  9.417533874511719e-05
r_  generation:  0.0007853507995605469
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  8.940696716308594e-05
r_  generation:  0.0007572174072265625
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00016641616821289062
mini_batch_src_global generation:  7.939338684082031e-05
r_  generation:  0.0006070137023925781
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0001819133758544922
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0008523464202880859
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00017142295837402344
mini_batch_src_global generation:  8.58306884765625e-05
r_  generation:  0.0006644725799560547
local_output_nid generation:  4.2438507080078125e-05
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  0.000102996826171875
r_  generation:  0.0009794235229492188
----------------------check_connections_block total spend ----------------------------- 0.01124882698059082
generate_one_block  0.01122426986694336
generate_one_block  0.0022962093353271484
generate_one_block  0.0020160675048828125
generate_one_block  0.002030611038208008
generate_one_block  0.001756906509399414
generate_one_block  0.0020837783813476562
generate_one_block  0.0018777847290039062
generate_one_block  0.002230405807495117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00783681869506836  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21821.06640625, 'VmHWM': 4616.3125, 'VmRSS': 4616.3125}
connection checking time:  0.016939878463745117
block generation total time  0.03670191764831543
average batch blocks generation time:  0.004587739706039429
block dataloader generation time/epoch 48.588651180267334
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0063571929931640625  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21823.36328125, 'VmHWM': 4617.86328125, 'VmRSS': 4617.86328125}
torch.Size([1053, 1433])
torch.Size([436, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006502628326416016  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21823.36328125, 'VmHWM': 4617.86328125, 'VmRSS': 4617.86328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005458831787109375  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21823.36328125, 'VmHWM': 4618.203125, 'VmRSS': 4618.203125}
torch.Size([886, 1433])
torch.Size([298, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00556182861328125  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21823.36328125, 'VmHWM': 4618.203125, 'VmRSS': 4618.203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007526874542236328  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.5625, 'VmHWM': 4619.234375, 'VmRSS': 4619.234375}
torch.Size([1272, 1433])
torch.Size([439, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007670402526855469  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.5625, 'VmHWM': 4619.234375, 'VmRSS': 4619.234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006588459014892578  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.4375, 'VmRSS': 4619.43359375}
torch.Size([1096, 1433])
torch.Size([431, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006733894348144531  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.4375, 'VmRSS': 4619.43359375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.005808353424072266  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.76953125, 'VmRSS': 4619.76953125}
torch.Size([951, 1433])
torch.Size([337, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0059299468994140625  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.76953125, 'VmRSS': 4619.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.007006645202636719  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.76953125, 'VmRSS': 4619.76953125}
torch.Size([1174, 1433])
torch.Size([513, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0071697235107421875  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.76953125, 'VmRSS': 4619.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.006419181823730469  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.76953125, 'VmRSS': 4619.76953125}
torch.Size([1065, 1433])
torch.Size([393, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.0065441131591796875  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21824.546875, 'VmHWM': 4619.76953125, 'VmRSS': 4619.76953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.00816965103149414  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21825.1953125, 'VmHWM': 4620.31640625, 'VmRSS': 4620.31640625}
torch.Size([1391, 1433])
torch.Size([625, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2596435546875 GB
    Memory Allocated: 0.008370399475097656  GigaBytes
Max Memory Allocated: 0.01465463638305664  GigaBytes

{'VmPeak': 21885.06640625, 'VmSize': 21825.1953125, 'VmHWM': 4620.31640625, 'VmRSS': 4620.31640625}
{'VmPeak': 21885.06640625, 'VmSize': 21825.1953125, 'VmHWM': 4620.3203125, 'VmRSS': 4620.3203125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016655951738357544 |0.0006860792636871338 |0.006127983331680298 |0.00024956464767456055 |0.0028884410858154297 |0.002033710479736328 |
----------------------------------------------------------pseudo_mini_loss sum 2.4391088485717773
{'VmPeak': 21885.06640625, 'VmSize': 21825.1953125, 'VmHWM': 4620.3203125, 'VmRSS': 4620.3203125}
Total (block generation + training)time/epoch 48.81763172149658
Training time/epoch 0.22855710983276367
Training time without block to device /epoch 0.2230684757232666
Training time without total dataloading part /epoch 0.07616162300109863
load block tensor time/epoch 0.13324761390686035
block to device time/epoch 0.00548863410949707
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13108
Number of first layer input nodes during this epoch:  8888
