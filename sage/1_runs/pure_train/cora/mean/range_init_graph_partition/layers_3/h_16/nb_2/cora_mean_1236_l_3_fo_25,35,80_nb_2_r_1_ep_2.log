main start at this time 1648604003.4345653
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20802.69140625, 'VmSize': 20802.69140625, 'VmHWM': 3613.7265625, 'VmRSS': 3613.7265625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.000591278076171875
global_2_local 7.176399230957031e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.198883056640625e-05
before graph partition 
		324, 363, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.000247955322265625
	Initialize BitList time :  1.9073486328125e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 324, 363

	before terminate 1 the average redundancy rate is:  1.0667701863354035
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0279503105590062,  1.0962732919254659
						 current side  0
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0124223602484472,  1.1118012422360248
						 current side  1
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0341614906832297,  1.0900621118012421
	walk terminate 1 spend time 4.2212443351745605
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.049689440993789,  1.0745341614906831
						 current side  0
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0248447204968945,  1.0993788819875776
						 current side  1
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0403726708074534,  1.0838509316770186
	walk terminate 1 spend time 4.384343147277832
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		335, 349, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 8.608579397201538
partition_len_list
[335, 349]
range_init_graph_partition selection method range initialization spend 8.608924627304077
time for parepare:  0.00010991096496582031
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0005896091461181641
mini_batch_src_global generation:  0.00042128562927246094
r_  generation:  0.011171579360961914
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00016951560974121094
mini_batch_src_global generation:  6.771087646484375e-05
r_  generation:  0.0001881122589111328
----------------------check_connections_block total spend ----------------------------- 0.013209104537963867
generate_one_block  0.015614748001098633
generate_one_block  0.0012977123260498047
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0011527538299560547
gen group dst list time:  3.218650817871094e-05
time for parepare:  0.0006401538848876953
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.00025177001953125
r_  generation:  0.000804901123046875
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.000347137451171875
mini_batch_src_global generation:  0.00016021728515625
r_  generation:  0.0007104873657226562
----------------------check_connections_block total spend ----------------------------- 0.0039844512939453125
generate_one_block  0.0019106864929199219
generate_one_block  0.0019719600677490234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014197826385498047
gen group dst list time:  5.507469177246094e-05
time for parepare:  0.00021219253540039062
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0007054805755615234
mini_batch_src_global generation:  0.0003833770751953125
r_  generation:  0.001678466796875
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.00024819374084472656
mini_batch_src_global generation:  0.00035190582275390625
r_  generation:  0.0017702579498291016
----------------------check_connections_block total spend ----------------------------- 0.006689310073852539
generate_one_block  0.003832578659057617
generate_one_block  0.004662990570068359
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20807.3828125, 'VmSize': 20656.92578125, 'VmHWM': 3620.8359375, 'VmRSS': 3620.8359375}
connection checking time:  0.010673761367797852
block generation total time  0.012378215789794922
average batch blocks generation time:  0.006189107894897461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.01005411148071289  GigaBytes
Max Memory Allocated: 0.01005411148071289  GigaBytes

{'VmPeak': 20968.5703125, 'VmSize': 20968.5703125, 'VmHWM': 3933.62109375, 'VmRSS': 3933.62109375}
torch.Size([1839, 1433])
torch.Size([1046, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2322998046875 GB
    Memory Allocated: 0.010417938232421875  GigaBytes
Max Memory Allocated: 0.010429859161376953  GigaBytes

{'VmPeak': 21718.4375, 'VmSize': 21718.4375, 'VmHWM': 4605.296875, 'VmRSS': 4605.296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.01044464111328125  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

{'VmPeak': 21792.72265625, 'VmSize': 21760.7265625, 'VmHWM': 4616.40625, 'VmRSS': 4616.40625}
torch.Size([1878, 1433])
torch.Size([1122, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.01082754135131836  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

{'VmPeak': 21792.72265625, 'VmSize': 21760.7265625, 'VmHWM': 4616.40625, 'VmRSS': 4616.40625}
{'VmPeak': 21792.72265625, 'VmSize': 21760.7265625, 'VmHWM': 4616.515625, 'VmRSS': 4616.515625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.013195395469665527 |0.18966782093048096 |0.40231382846832275 |0.0002688169479370117 |0.004999876022338867 |0.003319263458251953 |
----------------------------------------------------------pseudo_mini_loss sum 3.3798089027404785
{'VmPeak': 21792.72265625, 'VmSize': 21760.7265625, 'VmHWM': 4616.953125, 'VmRSS': 4616.953125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6569
Number of first layer input nodes during this epoch:  3717
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010933876037597656  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

{'VmPeak': 21792.72265625, 'VmSize': 21760.7265625, 'VmHWM': 4616.953125, 'VmRSS': 4616.953125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005741119384765625
global_2_local 9.489059448242188e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.723403930664062e-05
before graph partition 
		352, 340, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.00033545494079589844
	Initialize BitList time :  1.9073486328125e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 352, 340

	before terminate 1 the average redundancy rate is:  1.0745341614906834
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0745341614906831,  1.0714285714285714
						 current side  1
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
	walk terminate 1 spend time 5.631133556365967
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
	walk terminate 1 spend time 5.5256407260894775
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		340, 351, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 11.160520553588867
partition_len_list
[340, 351]
range_init_graph_partition selection method range initialization spend 11.161023378372192
time for parepare:  0.00016546249389648438
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.001046895980834961
mini_batch_src_global generation:  0.0001678466796875
r_  generation:  0.0006716251373291016
local_output_nid generation:  1.9550323486328125e-05
local_in_edges_tensor generation:  0.00030517578125
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.00038123130798339844
----------------------check_connections_block total spend ----------------------------- 0.003688335418701172
generate_one_block  0.01977705955505371
generate_one_block  0.0013260841369628906
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017635822296142578
gen group dst list time:  3.981590270996094e-05
time for parepare:  0.0006816387176513672
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.0005848407745361328
mini_batch_src_global generation:  0.00032210350036621094
r_  generation:  0.0010151863098144531
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.0004010200500488281
mini_batch_src_global generation:  0.00022077560424804688
r_  generation:  0.0008702278137207031
----------------------check_connections_block total spend ----------------------------- 0.004962444305419922
generate_one_block  0.002328634262084961
generate_one_block  0.0025835037231445312
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016160011291503906
gen group dst list time:  7.200241088867188e-05
time for parepare:  0.00038123130798339844
local_output_nid generation:  0.00010132789611816406
local_in_edges_tensor generation:  0.0009047985076904297
mini_batch_src_global generation:  0.0006592273712158203
r_  generation:  0.002500772476196289
local_output_nid generation:  0.000118255615234375
local_in_edges_tensor generation:  0.0007803440093994141
mini_batch_src_global generation:  0.00036716461181640625
r_  generation:  0.0023734569549560547
----------------------check_connections_block total spend ----------------------------- 0.009638309478759766
generate_one_block  0.0036945343017578125
generate_one_block  0.0034749507904052734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010933876037597656  GigaBytes
Max Memory Allocated: 0.02020406723022461  GigaBytes

{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4618.74609375, 'VmRSS': 4618.74609375}
connection checking time:  0.014600753784179688
block generation total time  0.012081623077392578
average batch blocks generation time:  0.006040811538696289
block dataloader generation time/epoch 11.226186990737915
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010577201843261719  GigaBytes
Max Memory Allocated: 0.02054452896118164  GigaBytes

{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4619.90625, 'VmRSS': 4619.90625}
torch.Size([1837, 1433])
torch.Size([1076, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010949134826660156  GigaBytes
Max Memory Allocated: 0.02054452896118164  GigaBytes

{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4619.90625, 'VmRSS': 4619.90625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010582447052001953  GigaBytes
Max Memory Allocated: 0.02054452896118164  GigaBytes

{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
torch.Size([1838, 1433])
torch.Size([1087, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010956764221191406  GigaBytes
Max Memory Allocated: 0.02054452896118164  GigaBytes

{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007273435592651367 |0.0006561279296875 |0.007041215896606445 |0.0002969503402709961 |0.0042046308517456055 |0.003612518310546875 |
----------------------------------------------------------pseudo_mini_loss sum 2.403419256210327
{'VmPeak': 21888.7421875, 'VmSize': 21824.7421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
Total (block generation + training)time/epoch 11.286243677139282
Training time/epoch 0.05976152420043945
Training time without block to device /epoch 0.05844926834106445
Training time without total dataloading part /epoch 0.02669811248779297
load block tensor time/epoch 0.014546871185302734
block to device time/epoch 0.001312255859375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6529
Number of first layer input nodes during this epoch:  3675
