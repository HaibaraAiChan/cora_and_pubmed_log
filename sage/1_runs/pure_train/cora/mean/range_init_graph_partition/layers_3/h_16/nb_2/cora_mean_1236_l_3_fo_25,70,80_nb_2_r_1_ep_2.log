main start at this time 1648604416.7230625
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20929.61328125, 'VmSize': 20929.61328125, 'VmHWM': 3613.16796875, 'VmRSS': 3613.16796875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016794204711914062
global_2_local 9.655952453613281e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.079673767089844e-05
before graph partition 
		324, 363, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0002510547637939453
	Initialize BitList time :  1.621246337890625e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 324, 363

	before terminate 1 the average redundancy rate is:  1.0667701863354035
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0279503105590062,  1.0962732919254659
						 current side  0
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0124223602484472,  1.1118012422360248
						 current side  1
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0341614906832297,  1.0900621118012421
	walk terminate 1 spend time 4.158536911010742
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.049689440993789,  1.0745341614906831
						 current side  0
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0248447204968945,  1.0993788819875776
						 current side  1
			 redundancy will reduce  0.004658385093167627
			 the number of node to move is : 2
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.062111801242236,  1.0403726708074534,  1.0838509316770186
	walk terminate 1 spend time 4.161471128463745
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		335, 349, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 8.324572801589966
partition_len_list
[335, 349]
range_init_graph_partition selection method range initialization spend 8.325171709060669
time for parepare:  0.0001735687255859375
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.0009493827819824219
mini_batch_src_global generation:  0.00014710426330566406
r_  generation:  0.0189821720123291
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.0002467632293701172
mini_batch_src_global generation:  7.963180541992188e-05
r_  generation:  0.00017142295837402344
----------------------check_connections_block total spend ----------------------------- 0.021461963653564453
generate_one_block  0.009401559829711914
generate_one_block  0.0013158321380615234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010776519775390625
gen group dst list time:  3.266334533691406e-05
time for parepare:  0.00042247772216796875
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.0002930164337158203
mini_batch_src_global generation:  0.0001850128173828125
r_  generation:  0.0006685256958007812
local_output_nid generation:  2.6702880859375e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  0.00010943412780761719
r_  generation:  0.0007205009460449219
----------------------check_connections_block total spend ----------------------------- 0.003113269805908203
generate_one_block  0.0029985904693603516
generate_one_block  0.0022039413452148438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006313323974609375
gen group dst list time:  5.7697296142578125e-05
time for parepare:  0.00016617774963378906
local_output_nid generation:  7.271766662597656e-05
local_in_edges_tensor generation:  0.0005440711975097656
mini_batch_src_global generation:  0.00040340423583984375
r_  generation:  0.0016989707946777344
local_output_nid generation:  7.939338684082031e-05
local_in_edges_tensor generation:  0.0002884864807128906
mini_batch_src_global generation:  0.0003516674041748047
r_  generation:  0.0018031597137451172
----------------------check_connections_block total spend ----------------------------- 0.006673097610473633
generate_one_block  0.007651567459106445
generate_one_block  0.0030965805053710938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.000179290771484375  GigaBytes
Max Memory Allocated: 0.000179290771484375  GigaBytes

{'VmPeak': 20935.8984375, 'VmSize': 20784.3203125, 'VmHWM': 3620.70703125, 'VmRSS': 3620.70703125}
connection checking time:  0.009786367416381836
block generation total time  0.015950679779052734
average batch blocks generation time:  0.007975339889526367
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 0.010425090789794922  GigaBytes
Max Memory Allocated: 0.010425090789794922  GigaBytes

{'VmPeak': 21009.2890625, 'VmSize': 21009.2890625, 'VmHWM': 3911.6015625, 'VmRSS': 3911.6015625}
torch.Size([1908, 1433])
torch.Size([1121, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2322998046875 GB
    Memory Allocated: 0.010807514190673828  GigaBytes
Max Memory Allocated: 0.010819435119628906  GigaBytes

{'VmPeak': 21717.07421875, 'VmSize': 21717.05859375, 'VmHWM': 4605.19921875, 'VmRSS': 4605.19921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.0108489990234375  GigaBytes
Max Memory Allocated: 0.020972728729248047  GigaBytes

{'VmPeak': 21791.7578125, 'VmSize': 21759.76171875, 'VmHWM': 4616.3828125, 'VmRSS': 4616.3828125}
torch.Size([1953, 1433])
torch.Size([1191, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011249065399169922  GigaBytes
Max Memory Allocated: 0.020972728729248047  GigaBytes

{'VmPeak': 21791.7578125, 'VmSize': 21759.76171875, 'VmHWM': 4616.3828125, 'VmRSS': 4616.3828125}
{'VmPeak': 21791.7578125, 'VmSize': 21759.76171875, 'VmHWM': 4616.60546875, 'VmRSS': 4616.60546875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010852456092834473 |0.18525540828704834 |0.40302836894989014 |0.00041675567626953125 |0.004736781120300293 |0.0032088756561279297 |
----------------------------------------------------------pseudo_mini_loss sum 3.3338966369628906
{'VmPeak': 21791.7578125, 'VmSize': 21759.76171875, 'VmHWM': 4617.04296875, 'VmRSS': 4617.04296875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6857
Number of first layer input nodes during this epoch:  3861
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011347293853759766  GigaBytes
Max Memory Allocated: 0.020972728729248047  GigaBytes

{'VmPeak': 21791.7578125, 'VmSize': 21759.76171875, 'VmHWM': 4617.04296875, 'VmRSS': 4617.04296875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005702972412109375
global_2_local 9.417533874511719e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.604194641113281e-05
before graph partition 
		352, 340, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				70, 70, 


	preparing two sides time :  0.0003330707550048828
	Initialize BitList time :  1.9311904907226562e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 352, 340

	before terminate 1 the average redundancy rate is:  1.0745341614906834
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0745341614906831,  1.0714285714285714
						 current side  1
			 redundancy will reduce  0.0015527950310560978
			 the number of node to move is : 2
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
	walk terminate 1 spend time 4.885572910308838
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0729813664596273,  1.0900621118012421,  1.0559006211180124
	walk terminate 1 spend time 5.017336368560791
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		340, 351, 


	--------------------------------------------------end of batch 0
after graph partition
graph partition algorithm spend time 9.906746864318848
partition_len_list
[340, 351]
range_init_graph_partition selection method range initialization spend 9.907193183898926
time for parepare:  0.0001556873321533203
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.0007197856903076172
mini_batch_src_global generation:  0.00015211105346679688
r_  generation:  0.0006196498870849609
local_output_nid generation:  1.5497207641601562e-05
local_in_edges_tensor generation:  0.00025916099548339844
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.00028896331787109375
----------------------check_connections_block total spend ----------------------------- 0.0030059814453125
generate_one_block  0.018901586532592773
generate_one_block  0.0014007091522216797
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002157449722290039
gen group dst list time:  3.504753112792969e-05
time for parepare:  0.0005974769592285156
local_output_nid generation:  2.765655517578125e-05
local_in_edges_tensor generation:  0.0004911422729492188
mini_batch_src_global generation:  0.00030159950256347656
r_  generation:  0.0008876323699951172
local_output_nid generation:  2.8371810913085938e-05
local_in_edges_tensor generation:  0.0003743171691894531
mini_batch_src_global generation:  0.0002765655517578125
r_  generation:  0.0007596015930175781
----------------------check_connections_block total spend ----------------------------- 0.004376888275146484
generate_one_block  0.002025604248046875
generate_one_block  0.0022683143615722656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014584064483642578
gen group dst list time:  6.198883056640625e-05
time for parepare:  0.00018453598022460938
local_output_nid generation:  7.963180541992188e-05
local_in_edges_tensor generation:  0.0006451606750488281
mini_batch_src_global generation:  0.0004317760467529297
r_  generation:  0.0018565654754638672
local_output_nid generation:  0.00011992454528808594
local_in_edges_tensor generation:  0.00028061866760253906
mini_batch_src_global generation:  0.00030994415283203125
r_  generation:  0.0018608570098876953
----------------------check_connections_block total spend ----------------------------- 0.007055997848510742
generate_one_block  0.004395484924316406
generate_one_block  0.0035011768341064453
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011347293853759766  GigaBytes
Max Memory Allocated: 0.020972728729248047  GigaBytes

{'VmPeak': 21887.77734375, 'VmSize': 21823.77734375, 'VmHWM': 4618.0, 'VmRSS': 4618.0}
connection checking time:  0.011432886123657227
block generation total time  0.012190580368041992
average batch blocks generation time:  0.006095290184020996
block dataloader generation time/epoch 9.979931354522705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010776996612548828  GigaBytes
Max Memory Allocated: 0.021142959594726562  GigaBytes

{'VmPeak': 21887.77734375, 'VmSize': 21828.0546875, 'VmHWM': 4622.9609375, 'VmRSS': 4622.9609375}
torch.Size([1874, 1433])
torch.Size([1142, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.01116323471069336  GigaBytes
Max Memory Allocated: 0.021142959594726562  GigaBytes

{'VmPeak': 21887.77734375, 'VmSize': 21828.0546875, 'VmHWM': 4622.9609375, 'VmRSS': 4622.9609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.010916709899902344  GigaBytes
Max Memory Allocated: 0.021142959594726562  GigaBytes

{'VmPeak': 21887.77734375, 'VmSize': 21828.1953125, 'VmHWM': 4623.37890625, 'VmRSS': 4623.37890625}
torch.Size([1900, 1433])
torch.Size([1175, 16])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2440185546875 GB
    Memory Allocated: 0.011312007904052734  GigaBytes
Max Memory Allocated: 0.021142959594726562  GigaBytes

{'VmPeak': 21887.77734375, 'VmSize': 21828.1953125, 'VmHWM': 4623.37890625, 'VmRSS': 4623.37890625}
{'VmPeak': 21887.77734375, 'VmSize': 21828.1953125, 'VmHWM': 4623.38671875, 'VmRSS': 4623.38671875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00624847412109375 |0.0006974935531616211 |0.006821632385253906 |0.00022661685943603516 |0.004208683967590332 |0.005322694778442383 |
----------------------------------------------------------pseudo_mini_loss sum 2.454861640930176
{'VmPeak': 21887.77734375, 'VmSize': 21828.1953125, 'VmHWM': 4623.38671875, 'VmRSS': 4623.38671875}
Total (block generation + training)time/epoch 10.025980234146118
Training time/epoch 0.04513740539550781
Training time without block to device /epoch 0.04374241828918457
Training time without total dataloading part /epoch 0.02783656120300293
load block tensor time/epoch 0.0124969482421875
block to device time/epoch 0.0013949871063232422
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6782
Number of first layer input nodes during this epoch:  3774
