main start at this time 1648611560.942953
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20809.8046875, 'VmSize': 20804.45703125, 'VmHWM': 3615.72265625, 'VmRSS': 3615.72265625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014917850494384766
global_2_local 7.224082946777344e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  4.863739013671875e-05
before graph partition 
		111, 90, 95, 86, 86, 143, 96, 51, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00019860267639160156
	Initialize BitList time :  1.2636184692382812e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 111, 90

	before terminate 1 the average redundancy rate is:  1.2484472049689441
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.3788819875776397,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.3788819875776397,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2484472049689441,  1.3788819875776397,  1.1180124223602483
	walk terminate 1 spend time 4.487648010253906
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		90, 111, 95, 86, 86, 143, 96, 51, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004916191101074219
	Initialize BitList time :  3.600120544433594e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 111, 95

	before terminate 1 the average redundancy rate is:  1.279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.1677018633540373,  1.3664596273291925
						 current side  1
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.3416149068322982,  1.1925465838509317
						 current side  0
			 redundancy will reduce  0.012422360248447006
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.1925465838509317,  1.3416149068322982
	walk terminate 1 spend time 4.788091421127319
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.267080745341615,  1.1925465838509317,  1.3416149068322982
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.0186335403726707,  1.515527950310559
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.0186335403726707,  1.515527950310559
	walk terminate 1 spend time 4.6907219886779785
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		90, 82, 122, 86, 86, 143, 96, 51, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 12, 24, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005137920379638672
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 86

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.515527950310559,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.515527950310559,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.515527950310559,  1.0683229813664596
	walk terminate 1 spend time 4.782505750656128
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		90, 82, 86, 122, 86, 143, 96, 51, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 12, 18, 24, 18, 18, 18, 14, 


	preparing two sides time :  0.0008137226104736328
	Initialize BitList time :  3.62396240234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 122, 86

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.515527950310559,  1.0683229813664596
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.515527950310559,  1.0683229813664596
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2919254658385093,  1.515527950310559,  1.0683229813664596
	walk terminate 1 spend time 5.494543790817261
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		90, 82, 86, 86, 122, 143, 96, 51, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 12, 18, 18, 24, 18, 18, 14, 


	preparing two sides time :  0.003120899200439453
	Initialize BitList time :  7.891654968261719e-05
	getRedundancyCost: time   5.7220458984375e-06

					length of partitions 122, 143

	before terminate 1 the average redundancy rate is:  1.6459627329192545
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.639751552795031,  2.111801242236025,  1.1677018633540373
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.639751552795031,  2.111801242236025,  1.1677018633540373
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.639751552795031,  2.111801242236025,  1.1677018633540373
	walk terminate 1 spend time 5.528334379196167
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.639751552795031,  2.0745341614906834,  1.204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.639751552795031,  2.0745341614906834,  1.204968944099379
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.6521739130434783,  1.9751552795031055,  1.329192546583851
	walk terminate 1 spend time 5.647080183029175
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		90, 82, 86, 86, 107, 159, 96, 51, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 12, 18, 18, 17, 25, 18, 14, 


	preparing two sides time :  0.0005879402160644531
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 159, 96

	before terminate 1 the average redundancy rate is:  1.5838509316770186
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5838509316770186,  1.9254658385093169,  1.2422360248447204
						 current side  1
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5527950310559007,  2.062111801242236,  1.0434782608695652
						 current side  0
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 4
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5527950310559007,  1.875776397515528,  1.2298136645962734
	walk terminate 1 spend time 5.5934765338897705
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.037267080745341685
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.546583850931677,  1.4782608695652173,  1.6149068322981366
						 current side  1
			 redundancy will reduce  0.03726708074534146
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.6770186335403727,  1.4161490683229814
						 current side  0
			 redundancy will reduce  0.03105590062111796
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5527950310559007,  1.5527950310559007,  1.5527950310559007
	walk terminate 1 spend time 5.585462808609009
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		90, 82, 86, 86, 107, 125, 125, 51, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 12, 18, 18, 17, 20, 23, 14, 


	preparing two sides time :  0.0004696846008300781
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 125, 51

	before terminate 1 the average redundancy rate is:  1.093167701863354
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.093167701863354,  1.5527950310559007,  0.6335403726708074
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.093167701863354,  1.5527950310559007,  0.6335403726708074
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.093167701863354,  1.5527950310559007,  0.6335403726708074
	walk terminate 1 spend time 5.574422597885132
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		90, 82, 86, 86, 107, 125, 51, 125, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 52.208282470703125
partition_len_list
[90, 82, 86, 86, 107, 125, 51, 125]
range_init_graph_partition selection method range initialization spend 52.2088782787323
time for parepare:  0.00022530555725097656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0010838508605957031
mini_batch_src_global generation:  0.00020503997802734375
r_  generation:  0.016896724700927734
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00016260147094726562
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  5.7697296142578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.792213439941406e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  6.651878356933594e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00010466575622558594
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  0.00013589859008789062
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  4.363059997558594e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00010991096496582031
mini_batch_src_global generation:  1.8835067749023438e-05
r_  generation:  4.6253204345703125e-05
----------------------check_connections_block total spend ----------------------------- 0.021270751953125
generate_one_block  0.020357131958007812
generate_one_block  0.0012896060943603516
generate_one_block  0.0010962486267089844
generate_one_block  0.0009889602661132812
generate_one_block  0.0009927749633789062
generate_one_block  0.0010135173797607422
generate_one_block  0.0009675025939941406
generate_one_block  0.0010700225830078125
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0013668537139892578
gen group dst list time:  0.0002837181091308594
time for parepare:  0.0010025501251220703
local_output_nid generation:  2.8848648071289062e-05
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  5.650520324707031e-05
r_  generation:  0.00038170814514160156
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00020503997802734375
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00033354759216308594
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00015091896057128906
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.0003268718719482422
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.0001456737518310547
mini_batch_src_global generation:  3.886222839355469e-05
r_  generation:  0.0003113746643066406
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.000148773193359375
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.0004329681396484375
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.00035262107849121094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014066696166992188
mini_batch_src_global generation:  0.00022172927856445312
r_  generation:  0.00022602081298828125
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0001671314239501953
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.00039696693420410156
----------------------check_connections_block total spend ----------------------------- 0.007372856140136719
generate_one_block  0.00436091423034668
generate_one_block  0.0015213489532470703
generate_one_block  0.0015463829040527344
generate_one_block  0.0013628005981445312
generate_one_block  0.001592874526977539
generate_one_block  0.0013720989227294922
generate_one_block  0.0012938976287841797
generate_one_block  0.0015828609466552734
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.004038333892822266
gen group dst list time:  0.00014066696166992188
time for parepare:  0.0011744499206542969
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.0010120868682861328
mini_batch_src_global generation:  0.0010097026824951172
r_  generation:  0.001247406005859375
local_output_nid generation:  4.172325134277344e-05
local_in_edges_tensor generation:  0.0004146099090576172
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0008869171142578125
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00012087821960449219
r_  generation:  0.0009720325469970703
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.00010919570922851562
r_  generation:  0.0009503364562988281
local_output_nid generation:  5.745887756347656e-05
local_in_edges_tensor generation:  0.0004475116729736328
mini_batch_src_global generation:  0.000186920166015625
r_  generation:  0.0012061595916748047
local_output_nid generation:  4.1484832763671875e-05
local_in_edges_tensor generation:  0.0002002716064453125
mini_batch_src_global generation:  0.00010585784912109375
r_  generation:  0.0008745193481445312
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.00020360946655273438
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.000934600830078125
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0001914501190185547
mini_batch_src_global generation:  0.00015616416931152344
r_  generation:  0.0011696815490722656
----------------------check_connections_block total spend ----------------------------- 0.01798725128173828
generate_one_block  0.002180814743041992
generate_one_block  0.0017583370208740234
generate_one_block  0.0018610954284667969
generate_one_block  0.0019237995147705078
generate_one_block  0.002142190933227539
generate_one_block  0.001748800277709961
generate_one_block  0.0019237995147705078
generate_one_block  0.0022842884063720703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20809.8046875, 'VmSize': 20657.01171875, 'VmHWM': 3621.1796875, 'VmRSS': 3621.1171875}
connection checking time:  0.025360107421875
block generation total time  0.0304563045501709
average batch blocks generation time:  0.0038070380687713623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.01042795181274414  GigaBytes
Max Memory Allocated: 0.01042795181274414  GigaBytes

{'VmPeak': 21006.8671875, 'VmSize': 20977.66015625, 'VmHWM': 3911.7734375, 'VmRSS': 3911.7734375}
torch.Size([1340, 1433])
torch.Size([517, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.01243734359741211  GigaBytes
Max Memory Allocated: 0.01321268081665039  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21752.875, 'VmHWM': 4608.8984375, 'VmRSS': 4608.8984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.012139320373535156  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21758.0390625, 'VmHWM': 4614.62890625, 'VmRSS': 4614.62890625}
torch.Size([945, 1433])
torch.Size([381, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.013683795928955078  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21758.0390625, 'VmHWM': 4614.62890625, 'VmRSS': 4614.62890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.011857986450195312  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21758.3515625, 'VmHWM': 4615.3984375, 'VmRSS': 4615.3984375}
torch.Size([1002, 1433])
torch.Size([420, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2459716796875 GB
    Memory Allocated: 0.013543128967285156  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21758.3515625, 'VmHWM': 4615.3984375, 'VmRSS': 4615.3984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.012796878814697266  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
torch.Size([1178, 1433])
torch.Size([404, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.014431476593017578  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.012691974639892578  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
torch.Size([1157, 1433])
torch.Size([553, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.014882564544677734  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.42578125, 'VmRSS': 4616.42578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.012140274047851562  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.75390625, 'VmRSS': 4616.75390625}
torch.Size([1016, 1433])
torch.Size([374, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.013839244842529297  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.75390625, 'VmRSS': 4616.75390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.011995315551757812  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.94921875, 'VmRSS': 4616.94921875}
torch.Size([1028, 1433])
torch.Size([418, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.013530254364013672  GigaBytes
Max Memory Allocated: 0.019271373748779297  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21759.3125, 'VmHWM': 4616.94921875, 'VmRSS': 4616.94921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.014017105102539062  GigaBytes
Max Memory Allocated: 0.01947307586669922  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21760.5546875, 'VmHWM': 4618.015625, 'VmRSS': 4618.015625}
torch.Size([1405, 1433])
torch.Size([594, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2655029296875 GB
    Memory Allocated: 0.01640939712524414  GigaBytes
Max Memory Allocated: 0.01947307586669922  GigaBytes

{'VmPeak': 21761.99609375, 'VmSize': 21760.5546875, 'VmHWM': 4618.015625, 'VmRSS': 4618.015625}
{'VmPeak': 21824.55078125, 'VmSize': 21792.5546875, 'VmHWM': 4618.390625, 'VmRSS': 4618.390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005820751190185547 |0.047886282205581665 |0.10184377431869507 |0.00018486380577087402 |0.003921717405319214 |0.002989053726196289 |
----------------------------------------------------------pseudo_mini_loss sum 4.070591926574707
{'VmPeak': 21824.55078125, 'VmSize': 21792.5546875, 'VmHWM': 4618.453125, 'VmRSS': 4618.453125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13484
Number of first layer input nodes during this epoch:  9071
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.020737648010253906  GigaBytes
Max Memory Allocated: 0.026204586029052734  GigaBytes

{'VmPeak': 21824.55078125, 'VmSize': 21792.5546875, 'VmHWM': 4618.453125, 'VmRSS': 4618.453125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005762577056884766
global_2_local 9.608268737792969e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.794929504394531e-05
before graph partition 
		135, 89, 110, 85, 91, 69, 118, 58, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002613067626953125
	Initialize BitList time :  1.3589859008789062e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 135, 89

	before terminate 1 the average redundancy rate is:  1.391304347826087
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.6770186335403727,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.6770186335403727,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.391304347826087,  1.6770186335403727,  1.1055900621118013
	walk terminate 1 spend time 6.53397798538208
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 135, 110, 85, 91, 69, 118, 58, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004734992980957031
	Initialize BitList time :  4.220008850097656e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 135, 110

	before terminate 1 the average redundancy rate is:  1.5217391304347827
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.6770186335403727,  1.3664596273291925
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.6770186335403727,  1.3664596273291925
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5217391304347827,  1.6770186335403727,  1.3664596273291925
	walk terminate 1 spend time 6.6643242835998535
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 110, 135, 85, 91, 69, 118, 58, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0006074905395507812
	Initialize BitList time :  0.00016188621520996094
	getRedundancyCost: time   5.245208740234375e-06

					length of partitions 135, 85

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.6770186335403727,  1.0559006211180124
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.6770186335403727,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.6770186335403727,  1.0559006211180124
	walk terminate 1 spend time 6.688621520996094
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 110, 85, 135, 91, 69, 118, 58, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004649162292480469
	Initialize BitList time :  3.504753112792969e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 135, 91

	before terminate 1 the average redundancy rate is:  1.4037267080745341
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.6770186335403727,  1.1304347826086956
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.6770186335403727,  1.1304347826086956
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4037267080745341,  1.6770186335403727,  1.1304347826086956
	walk terminate 1 spend time 6.640661001205444
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 110, 85, 91, 135, 69, 118, 58, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004024505615234375
	Initialize BitList time :  3.1948089599609375e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 135, 69

	before terminate 1 the average redundancy rate is:  1.2670807453416149
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.6770186335403727,  0.8571428571428571
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.6770186335403727,  0.8571428571428571
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2670807453416149,  1.6770186335403727,  0.8571428571428571
	walk terminate 1 spend time 6.687056064605713
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 110, 85, 91, 69, 135, 118, 58, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005676746368408203
	Initialize BitList time :  3.886222839355469e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 135, 118

	before terminate 1 the average redundancy rate is:  1.5714285714285716
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5714285714285716,  1.6770186335403727,  1.4658385093167703
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5714285714285714,  1.9006211180124224,  1.2422360248447204
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5714285714285714,  1.9006211180124224,  1.2422360248447204
	walk terminate 1 spend time 6.640789270401001
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5714285714285714,  1.9006211180124224,  1.2422360248447204
						 current side  1
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.565217391304348,  2.0745341614906834,  1.0559006211180124
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.565217391304348,  2.0745341614906834,  1.0559006211180124
	walk terminate 1 spend time 6.595879077911377
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		89, 110, 85, 91, 69, 85, 167, 58, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 18, 12, 24, 14, 


	preparing two sides time :  0.0005447864532470703
	Initialize BitList time :  4.57763671875e-05
	getRedundancyCost: time   4.0531158447265625e-06

					length of partitions 167, 58

	before terminate 1 the average redundancy rate is:  1.3975155279503106
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  2.0745341614906834,  0.7204968944099379
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  2.0745341614906834,  0.7204968944099379
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3975155279503106,  2.0745341614906834,  0.7204968944099379
	walk terminate 1 spend time 6.435637474060059
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 110, 85, 91, 69, 85, 58, 167, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 52.91574501991272
partition_len_list
[89, 110, 85, 91, 69, 85, 58, 167]
range_init_graph_partition selection method range initialization spend 52.91664910316467
time for parepare:  0.00019240379333496094
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0318300724029541
mini_batch_src_global generation:  0.0004951953887939453
r_  generation:  0.0004029273986816406
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001919269561767578
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  7.62939453125e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001251697540283203
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.124641418457031e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  0.00011467933654785156
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00014448165893554688
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.1484832763671875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001480579376220703
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  3.695487976074219e-05
local_output_nid generation:  1.71661376953125e-05
local_in_edges_tensor generation:  0.0001976490020751953
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  6.866455078125e-05
----------------------check_connections_block total spend ----------------------------- 0.036211252212524414
generate_one_block  0.014553546905517578
generate_one_block  0.0011332035064697266
generate_one_block  0.0011639595031738281
generate_one_block  0.0009775161743164062
generate_one_block  0.0009677410125732422
generate_one_block  0.0009732246398925781
generate_one_block  0.0009829998016357422
generate_one_block  0.00102996826171875
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002613067626953125
gen group dst list time:  0.00013566017150878906
time for parepare:  0.0006053447723388672
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.000423431396484375
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0002753734588623047
local_output_nid generation:  1.6450881958007812e-05
local_in_edges_tensor generation:  0.0001556873321533203
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00036716461181640625
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00014662742614746094
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.0002846717834472656
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  4.1961669921875e-05
r_  generation:  0.00028824806213378906
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.00023937225341796875
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00025582313537597656
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001366138458251953
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.00020432472229003906
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001499652862548828
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.0005102157592773438
----------------------check_connections_block total spend ----------------------------- 0.005861520767211914
generate_one_block  0.0041887760162353516
generate_one_block  0.003549337387084961
generate_one_block  0.0028929710388183594
generate_one_block  0.0027861595153808594
generate_one_block  0.0026950836181640625
generate_one_block  0.00146484375
generate_one_block  0.0013501644134521484
generate_one_block  0.001840829849243164
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0012054443359375
gen group dst list time:  0.0001590251922607422
time for parepare:  0.0003032684326171875
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.0007953643798828125
mini_batch_src_global generation:  0.00020837783813476562
r_  generation:  0.0010485649108886719
local_output_nid generation:  6.151199340820312e-05
local_in_edges_tensor generation:  0.0005686283111572266
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.001230478286743164
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.00026488304138183594
mini_batch_src_global generation:  0.00010180473327636719
r_  generation:  0.0008795261383056641
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.00021338462829589844
mini_batch_src_global generation:  9.822845458984375e-05
r_  generation:  0.0008280277252197266
local_output_nid generation:  3.504753112792969e-05
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  9.202957153320312e-05
r_  generation:  0.0007739067077636719
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00021266937255859375
mini_batch_src_global generation:  8.869171142578125e-05
r_  generation:  0.0007166862487792969
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00018668174743652344
mini_batch_src_global generation:  8.249282836914062e-05
r_  generation:  0.0006666183471679688
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0004055500030517578
mini_batch_src_global generation:  0.00022339820861816406
r_  generation:  0.0013375282287597656
----------------------check_connections_block total spend ----------------------------- 0.0150299072265625
generate_one_block  0.002193927764892578
generate_one_block  0.0023174285888671875
generate_one_block  0.0022385120391845703
generate_one_block  0.0020704269409179688
generate_one_block  0.0020067691802978516
generate_one_block  0.0020461082458496094
generate_one_block  0.001981973648071289
generate_one_block  0.002945423126220703
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.020737648010253906  GigaBytes
Max Memory Allocated: 0.026204586029052734  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4619.9375, 'VmRSS': 4619.7890625}
connection checking time:  0.020891427993774414
block generation total time  0.038568735122680664
average batch blocks generation time:  0.004821091890335083
block dataloader generation time/epoch 53.05562448501587
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.019260883331298828  GigaBytes
Max Memory Allocated: 0.02673625946044922  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12109375, 'VmRSS': 4620.12109375}
torch.Size([1144, 1433])
torch.Size([444, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.021033287048339844  GigaBytes
Max Memory Allocated: 0.02673625946044922  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12109375, 'VmRSS': 4620.12109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.019790172576904297  GigaBytes
Max Memory Allocated: 0.02673625946044922  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12890625, 'VmRSS': 4620.12890625}
torch.Size([1242, 1433])
torch.Size([581, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.0220794677734375  GigaBytes
Max Memory Allocated: 0.02673625946044922  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12890625, 'VmRSS': 4620.12890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.020308494567871094  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12890625, 'VmRSS': 4620.12890625}
torch.Size([1195, 1433])
torch.Size([469, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.022143840789794922  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12890625, 'VmRSS': 4620.12890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.019021034240722656  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12890625, 'VmRSS': 4620.12890625}
torch.Size([1099, 1433])
torch.Size([435, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.020774364471435547  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8203125, 'VmHWM': 4620.12890625, 'VmRSS': 4620.12890625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.018617630004882812  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8046875, 'VmHWM': 4620.1328125, 'VmRSS': 4620.125}
torch.Size([1024, 1433])
torch.Size([395, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.020154953002929688  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8046875, 'VmHWM': 4620.1328125, 'VmRSS': 4620.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.01811504364013672  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8046875, 'VmHWM': 4620.1328125, 'VmRSS': 4620.125}
torch.Size([930, 1433])
torch.Size([345, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.01956033706665039  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8046875, 'VmHWM': 4620.1328125, 'VmRSS': 4620.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.018218994140625  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8046875, 'VmHWM': 4620.1328125, 'VmRSS': 4620.125}
torch.Size([950, 1433])
torch.Size([354, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.019579410552978516  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21856.8046875, 'VmHWM': 4620.1328125, 'VmRSS': 4620.125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.02129983901977539  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21857.44921875, 'VmHWM': 4620.3828125, 'VmRSS': 4620.3828125}
torch.Size([1523, 1433])
torch.Size([718, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 0.024257183074951172  GigaBytes
Max Memory Allocated: 0.026912689208984375  GigaBytes

{'VmPeak': 21920.5703125, 'VmSize': 21857.44921875, 'VmHWM': 4620.38671875, 'VmRSS': 4620.38671875}
{'VmPeak': 21920.5703125, 'VmSize': 21857.44921875, 'VmHWM': 4620.390625, 'VmRSS': 4620.390625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006725668907165527 |0.0007409155368804932 |0.005487978458404541 |0.00023633241653442383 |0.004392683506011963 |0.0023276805877685547 |
----------------------------------------------------------pseudo_mini_loss sum 0.7386479377746582
{'VmPeak': 21920.5703125, 'VmSize': 21857.44921875, 'VmHWM': 4620.390625, 'VmRSS': 4620.390625}
Total (block generation + training)time/epoch 53.21227192878723
Training time/epoch 0.15596914291381836
Training time without block to device /epoch 0.15004181861877441
Training time without total dataloading part /epoch 0.08326363563537598
load block tensor time/epoch 0.05380535125732422
block to device time/epoch 0.005927324295043945
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13602
Number of first layer input nodes during this epoch:  9107
