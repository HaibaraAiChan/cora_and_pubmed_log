main start at this time 1648611495.1437845
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20902.00390625, 'VmSize': 20902.00390625, 'VmHWM': 3616.23828125, 'VmRSS': 3616.23828125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009694099426269531
global_2_local 0.00010132789611816406
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.198883056640625e-05
before graph partition 
		192, 178, 199, 175, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00023627281188964844
	Initialize BitList time :  1.430511474609375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 192, 178

	before terminate 1 the average redundancy rate is:  1.1490683229813665
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.0186335403726707,  1.2732919254658386
						 current side  1
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2732919254658386,  1.0186335403726707
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2546583850931676,  1.0372670807453417
	walk terminate 1 spend time 4.787642955780029
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2298136645962734,  1.062111801242236
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2484472049689441,  1.0434782608695652
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.204968944099379,  1.0869565217391304
	walk terminate 1 spend time 4.760603666305542
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		175, 194, 199, 175, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0005462169647216797
	Initialize BitList time :  4.100799560546875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 194, 199

	before terminate 1 the average redundancy rate is:  1.220496894409938
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.360248447204969,  1.049689440993789
						 current side  0
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0434782608695652,  1.3540372670807452
						 current side  1
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.173913043478261,  1.2236024844720497
	walk terminate 1 spend time 4.695034027099609
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.1925465838509317,  1.204968944099379
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.0434782608695652,  1.360248447204969
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2080745341614907,  1.3416149068322982,  1.0745341614906831
	walk terminate 1 spend time 4.928515911102295
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		175, 173, 216, 175, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 31, 38, 35, 


	preparing two sides time :  0.001085519790649414
	Initialize BitList time :  4.076957702636719e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 216, 175

	before terminate 1 the average redundancy rate is:  1.2142857142857144
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2080745341614907,  1.186335403726708,  1.2298136645962734
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.31055900621118,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.173913043478261,  1.236024844720497
	walk terminate 1 spend time 4.66688084602356
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 8
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.360248447204969,  1.0372670807453417
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.2298136645962734,  1.1614906832298137
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.2422360248447204,  1.1490683229813665
	walk terminate 1 spend time 4.940011024475098
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		175, 173, 185, 200, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 28.789087057113647
partition_len_list
[175, 173, 185, 200]
range_init_graph_partition selection method range initialization spend 28.78968858718872
time for parepare:  0.00017714500427246094
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0010230541229248047
mini_batch_src_global generation:  0.00046825408935546875
r_  generation:  0.014856815338134766
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0002598762512207031
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  1.9788742065429688e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.605552673339844e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012922286987304688
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00015234947204589844
----------------------check_connections_block total spend ----------------------------- 0.01842021942138672
generate_one_block  0.012503385543823242
generate_one_block  0.001172780990600586
generate_one_block  0.0010998249053955078
generate_one_block  0.0011241436004638672
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0014653205871582031
gen group dst list time:  5.340576171875e-05
time for parepare:  0.0007917881011962891
local_output_nid generation:  2.1219253540039062e-05
local_in_edges_tensor generation:  0.0005266666412353516
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0005788803100585938
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.000675201416015625
local_output_nid generation:  2.1457672119140625e-05
local_in_edges_tensor generation:  0.00025272369384765625
mini_batch_src_global generation:  9.632110595703125e-05
r_  generation:  0.0006585121154785156
local_output_nid generation:  2.09808349609375e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.00010371208190917969
r_  generation:  0.0007512569427490234
----------------------check_connections_block total spend ----------------------------- 0.005952119827270508
generate_one_block  0.001829385757446289
generate_one_block  0.0018572807312011719
generate_one_block  0.0018777847290039062
generate_one_block  0.00213623046875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0014925003051757812
gen group dst list time:  9.965896606445312e-05
time for parepare:  0.00033402442932128906
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.0010988712310791016
mini_batch_src_global generation:  0.0005471706390380859
r_  generation:  0.0016455650329589844
local_output_nid generation:  7.343292236328125e-05
local_in_edges_tensor generation:  0.0006613731384277344
mini_batch_src_global generation:  0.0004253387451171875
r_  generation:  0.0017123222351074219
local_output_nid generation:  8.106231689453125e-05
local_in_edges_tensor generation:  0.0003750324249267578
mini_batch_src_global generation:  0.00019407272338867188
r_  generation:  0.0019898414611816406
local_output_nid generation:  8.130073547363281e-05
local_in_edges_tensor generation:  0.0005559921264648438
mini_batch_src_global generation:  0.00020384788513183594
r_  generation:  0.001798868179321289
----------------------check_connections_block total spend ----------------------------- 0.014033079147338867
generate_one_block  0.0026443004608154297
generate_one_block  0.002593517303466797
generate_one_block  0.0028116703033447266
generate_one_block  0.004503965377807617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20906.1015625, 'VmSize': 20753.93359375, 'VmHWM': 3620.921875, 'VmRSS': 3620.921875}
connection checking time:  0.019985198974609375
block generation total time  0.020254135131835938
average batch blocks generation time:  0.005063533782958984
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.011248111724853516  GigaBytes
Max Memory Allocated: 0.011248111724853516  GigaBytes

{'VmPeak': 20977.8828125, 'VmSize': 20977.8828125, 'VmHWM': 3910.74609375, 'VmRSS': 3910.74609375}
torch.Size([1492, 1433])
torch.Size([681, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.01412200927734375  GigaBytes
Max Memory Allocated: 0.014653682708740234  GigaBytes

{'VmPeak': 21759.08984375, 'VmSize': 21748.87109375, 'VmHWM': 4603.6796875, 'VmRSS': 4603.6796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.014725208282470703  GigaBytes
Max Memory Allocated: 0.022649765014648438  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.26953125, 'VmHWM': 4613.08984375, 'VmRSS': 4613.08984375}
torch.Size([1536, 1433])
torch.Size([743, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.01778411865234375  GigaBytes
Max Memory Allocated: 0.022649765014648438  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.26953125, 'VmHWM': 4613.08984375, 'VmRSS': 4613.08984375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.015353679656982422  GigaBytes
Max Memory Allocated: 0.02350902557373047  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.12109375, 'VmRSS': 4614.12109375}
torch.Size([1653, 1433])
torch.Size([824, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.01871776580810547  GigaBytes
Max Memory Allocated: 0.02350902557373047  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.12109375, 'VmRSS': 4614.12109375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.015441417694091797  GigaBytes
Max Memory Allocated: 0.024219512939453125  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.29296875, 'VmRSS': 4614.29296875}
torch.Size([1669, 1433])
torch.Size([851, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.018950462341308594  GigaBytes
Max Memory Allocated: 0.024219512939453125  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.29296875, 'VmRSS': 4614.29296875}
{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.359375, 'VmRSS': 4614.359375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017929434776306152 |0.09306097030639648 |0.1963675618171692 |0.00018548965454101562 |0.0042615532875061035 |0.0021114349365234375 |
----------------------------------------------------------pseudo_mini_loss sum 4.351805686950684
{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.859375, 'VmRSS': 4614.859375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10182
Number of first layer input nodes during this epoch:  6350
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.022660255432128906  GigaBytes
Max Memory Allocated: 0.028127193450927734  GigaBytes

{'VmPeak': 21821.265625, 'VmSize': 21789.91015625, 'VmHWM': 4614.859375, 'VmRSS': 4614.859375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00048732757568359375
global_2_local 7.486343383789062e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.078315734863281e-05
before graph partition 
		215, 182, 162, 175, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.00023984909057617188
	Initialize BitList time :  1.3828277587890625e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 215, 182

	before terminate 1 the average redundancy rate is:  1.232919254658385
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1801242236024845,  1.279503105590062
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.2111801242236024,  1.2484472049689441
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1801242236024845,  1.279503105590062
	walk terminate 1 spend time 5.611534833908081
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1925465838509317,  1.2670807453416149
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.15527950310559,  1.2919254658385093
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 7
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2267080745341614,  1.3478260869565217,  1.1055900621118013
	walk terminate 1 spend time 5.8480141162872314
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		178, 217, 162, 175, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				34, 36, 35, 35, 


	preparing two sides time :  0.0005052089691162109
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 217, 162

	before terminate 1 the average redundancy rate is:  1.1770186335403725
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.3354037267080745,  1.0186335403726707
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.3726708074534162,  0.9813664596273292
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.3478260869565217,  1.0186335403726707
	walk terminate 1 spend time 5.678488254547119
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		178, 164, 217, 175, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				34, 36, 35, 35, 


	preparing two sides time :  0.0005013942718505859
	Initialize BitList time :  4.0531158447265625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 217, 175

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.0124223602484472,  1.3975155279503106
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.1614906832298137,  1.2236024844720497
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.186335403726708,  1.1304347826086956,  1.2422360248447204
	walk terminate 1 spend time 5.721903085708618
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.1490683229813665,  1.2236024844720497
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.0683229813664596,  1.2857142857142858
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.1118012422360248,  1.2422360248447204
	walk terminate 1 spend time 5.611373662948608
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		178, 164, 179, 200, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 28.480306148529053
partition_len_list
[178, 164, 179, 200]
range_init_graph_partition selection method range initialization spend 28.480808973312378
time for parepare:  0.0002651214599609375
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0007956027984619141
mini_batch_src_global generation:  0.00012421607971191406
r_  generation:  0.0005109310150146484
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.00025582313537597656
mini_batch_src_global generation:  5.888938903808594e-05
r_  generation:  0.00014281272888183594
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00020766258239746094
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00020313262939453125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0001590251922607422
----------------------check_connections_block total spend ----------------------------- 0.0038344860076904297
generate_one_block  0.01879572868347168
generate_one_block  0.0012392997741699219
generate_one_block  0.001177072525024414
generate_one_block  0.0013506412506103516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.001905679702758789
gen group dst list time:  4.291534423828125e-05
time for parepare:  0.0004115104675292969
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.0006966590881347656
mini_batch_src_global generation:  0.000148773193359375
r_  generation:  0.0004284381866455078
local_output_nid generation:  1.52587890625e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  0.00012493133544921875
r_  generation:  0.0004029273986816406
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0001552104949951172
mini_batch_src_global generation:  5.626678466796875e-05
r_  generation:  0.0004379749298095703
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.0001442432403564453
mini_batch_src_global generation:  8.0108642578125e-05
r_  generation:  0.00048661231994628906
----------------------check_connections_block total spend ----------------------------- 0.004394054412841797
generate_one_block  0.0033349990844726562
generate_one_block  0.001512765884399414
generate_one_block  0.0015912055969238281
generate_one_block  0.0017466545104980469
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006427764892578125
gen group dst list time:  8.034706115722656e-05
time for parepare:  0.0002491474151611328
local_output_nid generation:  5.2928924560546875e-05
local_in_edges_tensor generation:  0.0004703998565673828
mini_batch_src_global generation:  0.00043082237243652344
r_  generation:  0.0012850761413574219
local_output_nid generation:  7.772445678710938e-05
local_in_edges_tensor generation:  0.0002086162567138672
mini_batch_src_global generation:  0.00027680397033691406
r_  generation:  0.001270294189453125
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.00020456314086914062
mini_batch_src_global generation:  0.00014257431030273438
r_  generation:  0.0012857913970947266
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  0.00014829635620117188
r_  generation:  0.0014119148254394531
----------------------check_connections_block total spend ----------------------------- 0.009467840194702148
generate_one_block  0.007958650588989258
generate_one_block  0.0025615692138671875
generate_one_block  0.002537965774536133
generate_one_block  0.0027565956115722656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.022660255432128906  GigaBytes
Max Memory Allocated: 0.028127193450927734  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21853.92578125, 'VmHWM': 4615.78515625, 'VmRSS': 4615.78515625}
connection checking time:  0.013861894607543945
block generation total time  0.02400040626525879
average batch blocks generation time:  0.006000101566314697
block dataloader generation time/epoch 28.558590412139893
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.021652698516845703  GigaBytes
Max Memory Allocated: 0.030522823333740234  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21857.40234375, 'VmHWM': 4619.41015625, 'VmRSS': 4619.41015625}
torch.Size([1502, 1433])
torch.Size([719, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.024656295776367188  GigaBytes
Max Memory Allocated: 0.030522823333740234  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21857.40234375, 'VmHWM': 4619.41015625, 'VmRSS': 4619.41015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.022543907165527344  GigaBytes
Max Memory Allocated: 0.03052377700805664  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21857.57421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
torch.Size([1533, 1433])
torch.Size([690, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.02539968490600586  GigaBytes
Max Memory Allocated: 0.03052377700805664  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21857.57421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.021717548370361328  GigaBytes
Max Memory Allocated: 0.03058767318725586  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21857.57421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
torch.Size([1514, 1433])
torch.Size([715, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.02471303939819336  GigaBytes
Max Memory Allocated: 0.03058767318725586  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21857.57421875, 'VmHWM': 4619.9375, 'VmRSS': 4619.9375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.022548675537109375  GigaBytes
Max Memory Allocated: 0.03058767318725586  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21858.00390625, 'VmHWM': 4620.390625, 'VmRSS': 4620.390625}
torch.Size([1612, 1433])
torch.Size([783, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.025844573974609375  GigaBytes
Max Memory Allocated: 0.03058767318725586  GigaBytes

{'VmPeak': 21917.92578125, 'VmSize': 21858.00390625, 'VmHWM': 4620.390625, 'VmRSS': 4620.390625}
{'VmPeak': 21917.92578125, 'VmSize': 21858.00390625, 'VmHWM': 4620.39453125, 'VmRSS': 4620.39453125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02232837677001953 |0.0007796287536621094 |0.006275653839111328 |0.00025284290313720703 |0.0035280585289001465 |0.002339601516723633 |
----------------------------------------------------------pseudo_mini_loss sum 0.9626116752624512
{'VmPeak': 21917.92578125, 'VmSize': 21858.00390625, 'VmHWM': 4620.39453125, 'VmRSS': 4620.39453125}
Total (block generation + training)time/epoch 28.70273470878601
Training time/epoch 0.14376163482666016
Training time without block to device /epoch 0.14064311981201172
Training time without total dataloading part /epoch 0.04256582260131836
load block tensor time/epoch 0.08931350708007812
block to device time/epoch 0.0031185150146484375
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9789
Number of first layer input nodes during this epoch:  6161
