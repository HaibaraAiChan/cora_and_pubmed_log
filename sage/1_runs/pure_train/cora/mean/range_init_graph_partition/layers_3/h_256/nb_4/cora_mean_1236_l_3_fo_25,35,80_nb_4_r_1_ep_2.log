main start at this time 1648610571.3126788
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20805.6796875, 'VmSize': 20804.734375, 'VmHWM': 3615.10546875, 'VmRSS': 3615.10546875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011339187622070312
global_2_local 9.632110595703125e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.008148193359375e-05
before graph partition 
		192, 178, 199, 175, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002238750457763672
	Initialize BitList time :  1.4066696166992188e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 192, 178

	before terminate 1 the average redundancy rate is:  1.1490683229813665
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
Using backend: pytorch
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.0186335403726707,  1.2732919254658386
						 current side  1
			 redundancy will reduce  0.0031055900621119736
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2732919254658386,  1.0186335403726707
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2546583850931676,  1.0372670807453417
	walk terminate 1 spend time 4.545751571655273
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2298136645962734,  1.062111801242236
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.2484472049689441,  1.0434782608695652
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1459627329192545,  1.204968944099379,  1.0869565217391304
	walk terminate 1 spend time 4.608424663543701
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		175, 194, 199, 175, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				36, 34, 35, 35, 


	preparing two sides time :  0.0007600784301757812
	Initialize BitList time :  4.76837158203125e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 194, 199

	before terminate 1 the average redundancy rate is:  1.220496894409938
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.01552795031055898
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.360248447204969,  1.049689440993789
						 current side  0
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 6
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.0434782608695652,  1.3540372670807452
						 current side  1
			 redundancy will reduce  0.021739130434782705
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.173913043478261,  1.2236024844720497
	walk terminate 1 spend time 4.686466455459595
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.1925465838509317,  1.204968944099379
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.0434782608695652,  1.360248447204969
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2080745341614907,  1.3416149068322982,  1.0745341614906831
	walk terminate 1 spend time 4.6867101192474365
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		175, 173, 216, 175, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				36, 31, 38, 35, 


	preparing two sides time :  0.0005640983581542969
	Initialize BitList time :  4.124641418457031e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 216, 175

	before terminate 1 the average redundancy rate is:  1.2142857142857144
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2080745341614907,  1.186335403726708,  1.2298136645962734
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.201863354037267,  1.31055900621118,  1.093167701863354
						 current side  0
			 redundancy will reduce  0.009316770186335477
			 the number of node to move is : 5
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.173913043478261,  1.236024844720497
	walk terminate 1 spend time 4.538090705871582
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  0.015527950310559202
			 the number of node to move is : 8
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1987577639751552,  1.360248447204969,  1.0372670807453417
						 current side  0
			 redundancy will reduce  0.018633540372670954
			 the number of node to move is : 4
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.2298136645962734,  1.1614906832298137
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1956521739130435,  1.2422360248447204,  1.1490683229813665
	walk terminate 1 spend time 4.753680229187012
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		175, 173, 185, 200, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 27.829282760620117
partition_len_list
[175, 173, 185, 200]
range_init_graph_partition selection method range initialization spend 27.829891681671143
time for parepare:  0.00017118453979492188
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.005483865737915039
mini_batch_src_global generation:  0.00013327598571777344
r_  generation:  0.014551639556884766
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00031495094299316406
mini_batch_src_global generation:  8.130073547363281e-05
r_  generation:  0.0001494884490966797
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0001900196075439453
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  9.751319885253906e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  0.00016236305236816406
----------------------check_connections_block total spend ----------------------------- 0.0225069522857666
generate_one_block  0.00978231430053711
generate_one_block  0.001321554183959961
generate_one_block  0.0011343955993652344
generate_one_block  0.0011649131774902344
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021610260009765625
gen group dst list time:  4.863739013671875e-05
time for parepare:  0.0007519721984863281
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.0003414154052734375
mini_batch_src_global generation:  8.416175842285156e-05
r_  generation:  0.00045800209045410156
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00021910667419433594
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0004394054412841797
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  9.369850158691406e-05
r_  generation:  0.00048732757568359375
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.0002613067626953125
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0005590915679931641
----------------------check_connections_block total spend ----------------------------- 0.004739284515380859
generate_one_block  0.0015041828155517578
generate_one_block  0.0014967918395996094
generate_one_block  0.001519918441772461
generate_one_block  0.0016913414001464844
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015587806701660156
gen group dst list time:  7.987022399902344e-05
time for parepare:  0.0003116130828857422
local_output_nid generation:  4.57763671875e-05
local_in_edges_tensor generation:  0.0006821155548095703
mini_batch_src_global generation:  0.0004897117614746094
r_  generation:  0.001329183578491211
local_output_nid generation:  4.9591064453125e-05
local_in_edges_tensor generation:  0.0005748271942138672
mini_batch_src_global generation:  0.00027871131896972656
r_  generation:  0.0012505054473876953
local_output_nid generation:  5.602836608886719e-05
local_in_edges_tensor generation:  0.0003020763397216797
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0014853477478027344
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00020885467529296875
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.0013973712921142578
----------------------check_connections_block total spend ----------------------------- 0.010715723037719727
generate_one_block  0.0023539066314697266
generate_one_block  0.002445697784423828
generate_one_block  0.002561807632446289
generate_one_block  0.0026450157165527344
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 0.0032434463500976562  GigaBytes
Max Memory Allocated: 0.0032434463500976562  GigaBytes

{'VmPeak': 20808.8203125, 'VmSize': 20656.65234375, 'VmHWM': 3619.75390625, 'VmRSS': 3619.71484375}
connection checking time:  0.015455007553100586
block generation total time  0.01621866226196289
average batch blocks generation time:  0.004054665565490723
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.010855674743652344  GigaBytes
Max Memory Allocated: 0.010855674743652344  GigaBytes

{'VmPeak': 21006.62109375, 'VmSize': 20977.5, 'VmHWM': 3910.8359375, 'VmRSS': 3910.8359375}
torch.Size([1419, 1433])
torch.Size([646, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.013617992401123047  GigaBytes
Max Memory Allocated: 0.014088630676269531  GigaBytes

{'VmPeak': 21759.5078125, 'VmSize': 21751.71875, 'VmHWM': 4607.0078125, 'VmRSS': 4607.0078125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.014186859130859375  GigaBytes
Max Memory Allocated: 0.021726608276367188  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21791.64453125, 'VmHWM': 4614.875, 'VmRSS': 4614.875}
torch.Size([1436, 1433])
torch.Size([656, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.016971111297607422  GigaBytes
Max Memory Allocated: 0.021726608276367188  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21791.64453125, 'VmHWM': 4614.875, 'VmRSS': 4614.875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.014783382415771484  GigaBytes
Max Memory Allocated: 0.022409915924072266  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4615.68359375, 'VmRSS': 4615.68359375}
torch.Size([1547, 1433])
torch.Size([743, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 0.01789093017578125  GigaBytes
Max Memory Allocated: 0.022409915924072266  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4615.68359375, 'VmRSS': 4615.68359375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.014844417572021484  GigaBytes
Max Memory Allocated: 0.023061752319335938  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4616.37109375, 'VmRSS': 4616.37109375}
torch.Size([1558, 1433])
torch.Size([761, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.018068790435791016  GigaBytes
Max Memory Allocated: 0.023061752319335938  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4616.37109375, 'VmRSS': 4616.37109375}
{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4616.48046875, 'VmRSS': 4616.48046875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02010798454284668 |0.09387904405593872 |0.1964043378829956 |0.0001672506332397461 |0.004209041595458984 |0.0019233226776123047 |
----------------------------------------------------------pseudo_mini_loss sum 4.308642387390137
{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4616.48046875, 'VmRSS': 4616.48046875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  9499
Number of first layer input nodes during this epoch:  5960
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.021419048309326172  GigaBytes
Max Memory Allocated: 0.027628421783447266  GigaBytes

{'VmPeak': 21823.640625, 'VmSize': 21792.25390625, 'VmHWM': 4616.91796875, 'VmRSS': 4616.91796875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004734992980957031
global_2_local 7.152557373046875e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.125999450683594e-05
before graph partition 
		215, 182, 162, 175, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				35, 35, 35, 35, 


	preparing two sides time :  0.0002200603485107422
	Initialize BitList time :  1.33514404296875e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 215, 182

	before terminate 1 the average redundancy rate is:  1.232919254658385
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.0031055900621117516
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1801242236024845,  1.279503105590062
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.2111801242236024,  1.2484472049689441
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1801242236024845,  1.279503105590062
	walk terminate 1 spend time 5.501962900161743
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2298136645962732,  1.1925465838509317,  1.2670807453416149
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2236024844720497,  1.15527950310559,  1.2919254658385093
						 current side  1
			 redundancy will reduce  0.006211180124223503
			 the number of node to move is : 7
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2267080745341614,  1.3478260869565217,  1.1055900621118013
	walk terminate 1 spend time 5.712925910949707
				 improvement:  True
0
side is 0
	 walk step 1  partition 
		178, 217, 162, 175, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				34, 36, 35, 35, 


	preparing two sides time :  0.000530242919921875
	Initialize BitList time :  4.363059997558594e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 217, 162

	before terminate 1 the average redundancy rate is:  1.1770186335403725
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.3354037267080745,  1.0186335403726707
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.3726708074534162,  0.9813664596273292
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1832298136645962,  1.3478260869565217,  1.0186335403726707
	walk terminate 1 spend time 5.440552234649658
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		178, 164, 217, 175, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				34, 36, 35, 35, 


	preparing two sides time :  0.0005476474761962891
	Initialize BitList time :  0.0001227855682373047
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 217, 175

	before terminate 1 the average redundancy rate is:  1.2173913043478262
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 6
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.0124223602484472,  1.3975155279503106
						 current side  1
			 redundancy will reduce  0.024844720496894457
			 the number of node to move is : 7
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.1614906832298137,  1.2236024844720497
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.186335403726708,  1.1304347826086956,  1.2422360248447204
	walk terminate 1 spend time 5.4899375438690186
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1863354037267082,  1.1490683229813665,  1.2236024844720497
						 current side  0
			 the number of node to move is : 1
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403727,  1.0683229813664596,  1.2857142857142858
						 current side  1
			 the number of node to move is : 1
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1770186335403725,  1.1118012422360248,  1.2422360248447204
	walk terminate 1 spend time 6.037579536437988
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		178, 164, 179, 200, 


	--------------------------------------------------end of batch 2
after graph partition
graph partition algorithm spend time 28.19267725944519
partition_len_list
[178, 164, 179, 200]
range_init_graph_partition selection method range initialization spend 28.19312047958374
time for parepare:  0.00021505355834960938
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0011768341064453125
mini_batch_src_global generation:  0.0002334117889404297
r_  generation:  0.0009596347808837891
local_output_nid generation:  2.4557113647460938e-05
local_in_edges_tensor generation:  0.00020837783813476562
mini_batch_src_global generation:  6.198883056640625e-05
r_  generation:  0.00011658668518066406
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.0002033710479736328
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00010752677917480469
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001571178436279297
----------------------check_connections_block total spend ----------------------------- 0.005754709243774414
generate_one_block  0.0259554386138916
generate_one_block  0.0013225078582763672
generate_one_block  0.0011141300201416016
generate_one_block  0.0015528202056884766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.00222015380859375
gen group dst list time:  4.5299530029296875e-05
time for parepare:  0.0005705356597900391
local_output_nid generation:  2.9087066650390625e-05
local_in_edges_tensor generation:  0.0004534721374511719
mini_batch_src_global generation:  0.00014972686767578125
r_  generation:  0.0004048347473144531
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00014472007751464844
mini_batch_src_global generation:  0.00011658668518066406
r_  generation:  0.0003821849822998047
local_output_nid generation:  1.5974044799804688e-05
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.0004086494445800781
local_output_nid generation:  1.7642974853515625e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.0004677772521972656
----------------------check_connections_block total spend ----------------------------- 0.004244804382324219
generate_one_block  0.0022726058959960938
generate_one_block  0.0014801025390625
generate_one_block  0.0014960765838623047
generate_one_block  0.0017704963684082031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015819072723388672
gen group dst list time:  7.534027099609375e-05
time for parepare:  0.0004189014434814453
local_output_nid generation:  4.982948303222656e-05
local_in_edges_tensor generation:  0.0012433528900146484
mini_batch_src_global generation:  0.0005075931549072266
r_  generation:  0.0013191699981689453
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0005397796630859375
mini_batch_src_global generation:  0.00026226043701171875
r_  generation:  0.0011484622955322266
local_output_nid generation:  5.030632019042969e-05
local_in_edges_tensor generation:  0.00029277801513671875
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0011775493621826172
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.00020956993103027344
mini_batch_src_global generation:  0.00016117095947265625
r_  generation:  0.0012373924255371094
----------------------check_connections_block total spend ----------------------------- 0.010755062103271484
generate_one_block  0.0023670196533203125
generate_one_block  0.002557039260864258
generate_one_block  0.002849102020263672
generate_one_block  0.01036524772644043
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.021419048309326172  GigaBytes
Max Memory Allocated: 0.027628421783447266  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21856.26953125, 'VmHWM': 4618.49609375, 'VmRSS': 4618.49609375}
connection checking time:  0.014999866485595703
block generation total time  0.025157690048217773
average batch blocks generation time:  0.006289422512054443
block dataloader generation time/epoch 28.283228397369385
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.020514488220214844  GigaBytes
Max Memory Allocated: 0.028795242309570312  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21857.59375, 'VmHWM': 4620.05859375, 'VmRSS': 4620.05859375}
torch.Size([1408, 1433])
torch.Size([655, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.02331686019897461  GigaBytes
Max Memory Allocated: 0.028795242309570312  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21857.59375, 'VmHWM': 4620.05859375, 'VmRSS': 4620.05859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.021315574645996094  GigaBytes
Max Memory Allocated: 0.02879619598388672  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21857.83984375, 'VmHWM': 4620.43359375, 'VmRSS': 4620.43359375}
torch.Size([1453, 1433])
torch.Size([640, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.024013042449951172  GigaBytes
Max Memory Allocated: 0.02879619598388672  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21857.83984375, 'VmHWM': 4620.43359375, 'VmRSS': 4620.43359375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.020578861236572266  GigaBytes
Max Memory Allocated: 0.02886056900024414  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21857.83984375, 'VmHWM': 4620.53125, 'VmRSS': 4620.53125}
torch.Size([1420, 1433])
torch.Size([656, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.023387432098388672  GigaBytes
Max Memory Allocated: 0.02886056900024414  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21857.83984375, 'VmHWM': 4620.53125, 'VmRSS': 4620.53125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.02131938934326172  GigaBytes
Max Memory Allocated: 0.02886056900024414  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21858.01953125, 'VmHWM': 4620.68359375, 'VmRSS': 4620.68359375}
torch.Size([1486, 1433])
torch.Size([718, 256])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2889404296875 GB
    Memory Allocated: 0.024408817291259766  GigaBytes
Max Memory Allocated: 0.02886056900024414  GigaBytes

{'VmPeak': 21920.26953125, 'VmSize': 21858.01953125, 'VmHWM': 4620.68359375, 'VmRSS': 4620.68359375}
{'VmPeak': 21920.26953125, 'VmSize': 21858.01953125, 'VmHWM': 4620.6875, 'VmRSS': 4620.6875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027291059494018555 |0.0007726550102233887 |0.0058591365814208984 |0.0002117753028869629 |0.0037270784378051758 |0.002065896987915039 |
----------------------------------------------------------pseudo_mini_loss sum 0.9202848076820374
{'VmPeak': 21920.26953125, 'VmSize': 21858.01953125, 'VmHWM': 4620.6875, 'VmRSS': 4620.6875}
Total (block generation + training)time/epoch 28.44528865814209
Training time/epoch 0.16167545318603516
Training time without block to device /epoch 0.1585848331451416
Training time without total dataloading part /epoch 0.04125785827636719
load block tensor time/epoch 0.10916423797607422
block to device time/epoch 0.0030906200408935547
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  9157
Number of first layer input nodes during this epoch:  5767
