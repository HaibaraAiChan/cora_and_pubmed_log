main start at this time 1648605332.2874515
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20807.8359375, 'VmSize': 20801.79296875, 'VmHWM': 3612.9140625, 'VmRSS': 3612.9140625}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011203289031982422
global_2_local 9.822845458984375e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.270408630371094e-05
before graph partition 
		89, 105, 105, 72, 116, 104, 92, 71, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020360946655273438
	Initialize BitList time :  1.239776611328125e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 89, 105

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
	walk terminate 1 spend time 4.374509572982788
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004820823669433594
	Initialize BitList time :  3.409385681152344e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 105, 105

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
	walk terminate 1 spend time 4.453179836273193
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004611015319824219
	Initialize BitList time :  3.361701965332031e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 105, 72

	before terminate 1 the average redundancy rate is:  1.0993788819875776
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.479612588882446
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.858213901519775
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004942417144775391
	Initialize BitList time :  0.00018024444580078125
	getRedundancyCost: time   9.298324584960938e-06

					length of partitions 90, 116

	before terminate 1 the average redundancy rate is:  1.279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
	walk terminate 1 spend time 4.6749937534332275
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0015528202056884766
	Initialize BitList time :  2.7894973754882812e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 116, 104

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
	walk terminate 1 spend time 4.539525747299194
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 116, 92, 71, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0003552436828613281
	Initialize BitList time :  3.314018249511719e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 116, 92

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.535093545913696
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 5.132963180541992
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		89, 105, 85, 90, 104, 103, 104, 71, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 21, 18, 21, 15, 14, 


	preparing two sides time :  0.0005562305450439453
	Initialize BitList time :  3.695487976074219e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 104, 71

	before terminate 1 the average redundancy rate is:  1.0869565217391304
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
	walk terminate 1 spend time 5.277299165725708
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 103, 71, 104, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 42.35300302505493
partition_len_list
[89, 105, 85, 90, 104, 103, 71, 104]
range_init_graph_partition selection method range initialization spend 42.353618144989014
time for parepare:  0.00016927719116210938
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0011560916900634766
mini_batch_src_global generation:  0.000263214111328125
r_  generation:  0.017955780029296875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00033926963806152344
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00010895729064941406
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.315376281738281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  0.00012564659118652344
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.288818359375e-05
r_  generation:  7.534027099609375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  3.838539123535156e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  7.987022399902344e-05
----------------------check_connections_block total spend ----------------------------- 0.02257084846496582
generate_one_block  0.019675016403198242
generate_one_block  0.001373291015625
generate_one_block  0.0011610984802246094
generate_one_block  0.0011093616485595703
generate_one_block  0.0010788440704345703
generate_one_block  0.0010731220245361328
generate_one_block  0.0010848045349121094
generate_one_block  0.0011172294616699219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017547607421875
gen group dst list time:  0.00022292137145996094
time for parepare:  0.0006196498870849609
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0003418922424316406
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002243518829345703
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00024390220642089844
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002396106719970703
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012111663818359375
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.0002238750457763672
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.000278472900390625
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00023937225341796875
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012993812561035156
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00017714500427246094
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.0002548694610595703
----------------------check_connections_block total spend ----------------------------- 0.004846811294555664
generate_one_block  0.0041048526763916016
generate_one_block  0.0012993812561035156
generate_one_block  0.001272439956665039
generate_one_block  0.0014753341674804688
generate_one_block  0.009199142456054688
generate_one_block  0.0012853145599365234
generate_one_block  0.0011897087097167969
generate_one_block  0.0013096332550048828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0009758472442626953
gen group dst list time:  0.00010395050048828125
time for parepare:  0.001032114028930664
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.00046634674072265625
mini_batch_src_global generation:  0.0007596015930175781
r_  generation:  0.000682830810546875
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.00017261505126953125
mini_batch_src_global generation:  0.0004813671112060547
r_  generation:  0.0008137226104736328
local_output_nid generation:  3.361701965332031e-05
local_in_edges_tensor generation:  0.000179290771484375
mini_batch_src_global generation:  0.00047850608825683594
r_  generation:  0.0016961097717285156
local_output_nid generation:  0.00010633468627929688
local_in_edges_tensor generation:  0.0004286766052246094
mini_batch_src_global generation:  0.0009481906890869141
r_  generation:  0.0016913414001464844
local_output_nid generation:  0.0001087188720703125
local_in_edges_tensor generation:  0.0004165172576904297
mini_batch_src_global generation:  0.0011441707611083984
r_  generation:  0.0020093917846679688
local_output_nid generation:  7.295608520507812e-05
local_in_edges_tensor generation:  0.00034999847412109375
mini_batch_src_global generation:  0.0001761913299560547
r_  generation:  0.0015606880187988281
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.00031256675720214844
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0010552406311035156
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002677440643310547
mini_batch_src_global generation:  0.0001342296600341797
r_  generation:  0.0013606548309326172
----------------------check_connections_block total spend ----------------------------- 0.023533344268798828
generate_one_block  0.003654003143310547
generate_one_block  0.0038013458251953125
generate_one_block  0.0029969215393066406
generate_one_block  0.003030061721801758
generate_one_block  0.0032911300659179688
generate_one_block  0.002849102020263672
generate_one_block  0.002609729766845703
generate_one_block  0.0030205249786376953
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20807.8359375, 'VmSize': 20656.20703125, 'VmHWM': 3620.1875, 'VmRSS': 3620.1875}
connection checking time:  0.028380155563354492
block generation total time  0.04638862609863281
average batch blocks generation time:  0.0057985782623291016
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005236148834228516  GigaBytes
Max Memory Allocated: 0.005236148834228516  GigaBytes

{'VmPeak': 21030.56640625, 'VmSize': 20998.5703125, 'VmHWM': 3930.7890625, 'VmRSS': 3930.7890625}
torch.Size([910, 1433])
torch.Size([359, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005451202392578125  GigaBytes
Max Memory Allocated: 0.005491733551025391  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4611.3515625, 'VmRSS': 4611.3515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006661891937255859  GigaBytes
Max Memory Allocated: 0.011496543884277344  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4614.11328125, 'VmRSS': 4614.11328125}
torch.Size([1110, 1433])
torch.Size([416, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006909847259521484  GigaBytes
Max Memory Allocated: 0.011496543884277344  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4614.11328125, 'VmRSS': 4614.11328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0061798095703125  GigaBytes
Max Memory Allocated: 0.012084007263183594  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4614.11328125, 'VmRSS': 4614.11328125}
torch.Size([1020, 1433])
torch.Size([414, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006415843963623047  GigaBytes
Max Memory Allocated: 0.012084007263183594  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4614.11328125, 'VmRSS': 4614.11328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006404876708984375  GigaBytes
Max Memory Allocated: 0.012084007263183594  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4614.39453125, 'VmRSS': 4614.39453125}
torch.Size([1062, 1433])
torch.Size([432, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0066509246826171875  GigaBytes
Max Memory Allocated: 0.012084007263183594  GigaBytes

{'VmPeak': 21755.7734375, 'VmSize': 21755.109375, 'VmHWM': 4614.39453125, 'VmRSS': 4614.39453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0073451995849609375  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4618.47265625, 'VmRSS': 4618.47265625}
torch.Size([1237, 1433])
torch.Size([508, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0076313018798828125  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4618.47265625, 'VmRSS': 4618.47265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006403923034667969  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4618.47265625, 'VmRSS': 4618.47265625}
torch.Size([1005, 1433])
torch.Size([381, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0066356658935546875  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4618.47265625, 'VmRSS': 4618.47265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00524139404296875  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4618.9296875, 'VmRSS': 4618.9296875}
torch.Size([845, 1433])
torch.Size([287, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005413532257080078  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4618.9296875, 'VmRSS': 4618.9296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006407737731933594  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4619.0703125, 'VmRSS': 4619.0703125}
torch.Size([1055, 1433])
torch.Size([446, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0066680908203125  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4619.0703125, 'VmRSS': 4619.0703125}
{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4619.2109375, 'VmRSS': 4619.2109375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.005634188652038574 |0.05157366394996643 |0.10447156429290771 |0.0002079308032989502 |0.0035927295684814453 |0.003067493438720703 |
----------------------------------------------------------pseudo_mini_loss sum 3.4759395122528076
{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4619.2109375, 'VmRSS': 4619.2109375}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12238
Number of first layer input nodes during this epoch:  8244
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007175922393798828  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21761.93359375, 'VmSize': 21761.93359375, 'VmHWM': 4619.5859375, 'VmRSS': 4619.5859375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004973411560058594
global_2_local 7.843971252441406e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.602836608886719e-05
before graph partition 
		100, 116, 83, 76, 89, 127, 98, 67, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020551681518554688
	Initialize BitList time :  1.1682510375976562e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 100, 116

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
	walk terminate 1 spend time 6.202590227127075
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		100, 116, 83, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00031876564025878906
	Initialize BitList time :  2.5033950805664062e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 116, 83

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
	walk terminate 1 spend time 6.30717396736145
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 116, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004532337188720703
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 76

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
	walk terminate 1 spend time 6.358978748321533
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 116, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003750324249267578
	Initialize BitList time :  5.984306335449219e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 116, 89

	before terminate 1 the average redundancy rate is:  1.2732919254658386
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
	walk terminate 1 spend time 6.301059722900391
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 116, 127, 98, 67, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004830360412597656
	Initialize BitList time :  3.5762786865234375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 116, 127

	before terminate 1 the average redundancy rate is:  1.5093167701863355
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.6645962732919255,  1.3540372670807452
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.515527950310559,  1.5031055900621118
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.68944099378882,  1.3043478260869565
	walk terminate 1 spend time 6.3997297286987305
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.1180124223602483,  1.875776397515528
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.2670807453416149,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.0807453416149069,  1.875776397515528
	walk terminate 1 spend time 6.41228985786438
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 76, 89, 87, 151, 98, 67, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 17, 19, 18, 14, 


	preparing two sides time :  0.0005834102630615234
	Initialize BitList time :  0.00011539459228515625
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 151, 98

	before terminate 1 the average redundancy rate is:  1.5465838509316772
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
	walk terminate 1 spend time 6.437327861785889
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 151, 67, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 17, 18, 19, 14, 


	preparing two sides time :  0.0003864765167236328
	Initialize BitList time :  2.956390380859375e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 151, 67

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
	walk terminate 1 spend time 6.413290739059448
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 67, 151, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 50.8569552898407
partition_len_list
[100, 83, 76, 89, 87, 98, 67, 151]
range_init_graph_partition selection method range initialization spend 50.85738563537598
time for parepare:  0.00011420249938964844
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.0013272762298583984
mini_batch_src_global generation:  0.0005261898040771484
r_  generation:  0.000469207763671875
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00025391578674316406
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  5.245208740234375e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00016546249389648438
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  4.8160552978515625e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  5.221366882324219e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001761913299560547
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  5.2928924560546875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001773834228515625
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  5.412101745605469e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00015926361083984375
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  4.220008850097656e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00018024444580078125
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  9.298324584960938e-05
----------------------check_connections_block total spend ----------------------------- 0.005397319793701172
generate_one_block  0.021037817001342773
generate_one_block  0.0013031959533691406
generate_one_block  0.0013437271118164062
generate_one_block  0.0011219978332519531
generate_one_block  0.0011107921600341797
generate_one_block  0.0011432170867919922
generate_one_block  0.0010914802551269531
generate_one_block  0.0011551380157470703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0024650096893310547
gen group dst list time:  0.00011014938354492188
time for parepare:  0.0005581378936767578
local_output_nid generation:  4.839897155761719e-05
local_in_edges_tensor generation:  0.0004467964172363281
mini_batch_src_global generation:  0.00010728836059570312
r_  generation:  0.00032830238342285156
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001494884490966797
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.00019359588623046875
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00013899803161621094
mini_batch_src_global generation:  3.504753112792969e-05
r_  generation:  0.0001709461212158203
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.00024390220642089844
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  4.00543212890625e-05
r_  generation:  0.00022673606872558594
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0001399517059326172
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00022840499877929688
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  1.3828277587890625e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  6.151199340820312e-05
r_  generation:  0.0004036426544189453
----------------------check_connections_block total spend ----------------------------- 0.005368709564208984
generate_one_block  0.007906436920166016
generate_one_block  0.0013496875762939453
generate_one_block  0.001329660415649414
generate_one_block  0.0014073848724365234
generate_one_block  0.001432180404663086
generate_one_block  0.0013515949249267578
generate_one_block  0.0013396739959716797
generate_one_block  0.0015206336975097656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007779598236083984
gen group dst list time:  0.00010561943054199219
time for parepare:  0.0005259513854980469
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.005506038665771484
mini_batch_src_global generation:  0.0003058910369873047
r_  generation:  0.0008182525634765625
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00018715858459472656
mini_batch_src_global generation:  9.226799011230469e-05
r_  generation:  0.0005960464477539062
local_output_nid generation:  2.6941299438476562e-05
local_in_edges_tensor generation:  0.00017690658569335938
mini_batch_src_global generation:  7.2479248046875e-05
r_  generation:  0.0005805492401123047
local_output_nid generation:  3.6716461181640625e-05
local_in_edges_tensor generation:  0.00020003318786621094
mini_batch_src_global generation:  8.749961853027344e-05
r_  generation:  0.0007908344268798828
local_output_nid generation:  3.3855438232421875e-05
local_in_edges_tensor generation:  0.00018787384033203125
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.0007414817810058594
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00018262863159179688
mini_batch_src_global generation:  8.845329284667969e-05
r_  generation:  0.0007240772247314453
local_output_nid generation:  2.5033950805664062e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0005233287811279297
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.0002028942108154297
mini_batch_src_global generation:  0.00010156631469726562
r_  generation:  0.0038924217224121094
----------------------check_connections_block total spend ----------------------------- 0.019271373748779297
generate_one_block  0.004371166229248047
generate_one_block  0.0041904449462890625
generate_one_block  0.003785371780395508
generate_one_block  0.003484964370727539
generate_one_block  0.0034804344177246094
generate_one_block  0.0035588741302490234
generate_one_block  0.002785921096801758
generate_one_block  0.003641843795776367
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007175922393798828  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.0546875, 'VmRSS': 4621.0546875}
connection checking time:  0.02464008331298828
block generation total time  0.0469362735748291
average batch blocks generation time:  0.005867034196853638
block dataloader generation time/epoch 50.98591375350952
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007086753845214844  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.80859375, 'VmRSS': 4621.80859375}
torch.Size([1057, 1433])
torch.Size([474, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007355213165283203  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.80859375, 'VmRSS': 4621.80859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005511760711669922  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
torch.Size([763, 1433])
torch.Size([317, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005703926086425781  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0064563751220703125  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
torch.Size([940, 1433])
torch.Size([298, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006636619567871094  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
torch.Size([1121, 1433])
torch.Size([448, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007682323455810547  GigaBytes
Max Memory Allocated: 0.01298666000366211  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007090091705322266  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
torch.Size([1058, 1433])
torch.Size([402, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007321834564208984  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006988525390625  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.19921875, 'VmHWM': 4621.8125, 'VmRSS': 4621.8125}
torch.Size([1039, 1433])
torch.Size([375, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007214546203613281  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005595207214355469  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
torch.Size([779, 1433])
torch.Size([263, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005755901336669922  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008051872253417969  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
torch.Size([1236, 1433])
torch.Size([548, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.00838613510131836  GigaBytes
Max Memory Allocated: 0.013052940368652344  GigaBytes

{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009312957525253296 |0.0021285414695739746 |0.005104094743728638 |0.0003210604190826416 |0.002682209014892578 |0.002160787582397461 |
----------------------------------------------------------pseudo_mini_loss sum 2.5847320556640625
{'VmPeak': 21826.19921875, 'VmSize': 21826.18359375, 'VmHWM': 4621.81640625, 'VmRSS': 4621.80859375}
Total (block generation + training)time/epoch 51.15889501571655
Training time/epoch 0.17220592498779297
Training time without block to device /epoch 0.15517759323120117
Training time without total dataloading part /epoch 0.06701970100402832
load block tensor time/epoch 0.07450366020202637
block to device time/epoch 0.017028331756591797
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11869
Number of first layer input nodes during this epoch:  7993
