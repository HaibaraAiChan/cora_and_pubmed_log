main start at this time 1648606588.6962707
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20802.86328125, 'VmSize': 20802.86328125, 'VmHWM': 3613.9609375, 'VmRSS': 3613.9609375}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011448860168457031
global_2_local 0.00011014938354492188
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.198883056640625e-05
before graph partition 
		89, 105, 105, 72, 116, 104, 92, 71, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020170211791992188
	Initialize BitList time :  1.239776611328125e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 89, 105

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
	walk terminate 1 spend time 4.572940349578857
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003447532653808594
	Initialize BitList time :  2.5272369384765625e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 105, 105

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
	walk terminate 1 spend time 4.565577983856201
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003571510314941406
	Initialize BitList time :  2.8848648071289062e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 105, 72

	before terminate 1 the average redundancy rate is:  1.0993788819875776
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.646705627441406
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.569157361984253
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004858970642089844
	Initialize BitList time :  4.172325134277344e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 90, 116

	before terminate 1 the average redundancy rate is:  1.279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
	walk terminate 1 spend time 4.527812480926514
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0016322135925292969
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 116, 104

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
	walk terminate 1 spend time 4.7378013134002686
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 116, 92, 71, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004696846008300781
	Initialize BitList time :  4.00543212890625e-05
	getRedundancyCost: time   4.76837158203125e-06

					length of partitions 116, 92

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.884235143661499
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.5489747524261475
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		89, 105, 85, 90, 104, 103, 104, 71, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 21, 18, 21, 15, 14, 


	preparing two sides time :  0.0003001689910888672
	Initialize BitList time :  2.4318695068359375e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 104, 71

	before terminate 1 the average redundancy rate is:  1.0869565217391304
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
	walk terminate 1 spend time 4.744236469268799
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 103, 71, 104, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 41.82310891151428
partition_len_list
[89, 105, 85, 90, 104, 103, 71, 104]
range_init_graph_partition selection method range initialization spend 41.823771238327026
time for parepare:  0.00017905235290527344
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.0010998249053955078
mini_batch_src_global generation:  0.000141143798828125
r_  generation:  0.015378475189208984
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0003058910369873047
mini_batch_src_global generation:  5.602836608886719e-05
r_  generation:  0.00010704994201660156
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001862049102783203
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  5.841255187988281e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00019025802612304688
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00017499923706054688
mini_batch_src_global generation:  2.8133392333984375e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00017523765563964844
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00017118453979492188
mini_batch_src_global generation:  2.384185791015625e-05
r_  generation:  4.982948303222656e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00016880035400390625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00010466575622558594
----------------------check_connections_block total spend ----------------------------- 0.020086050033569336
generate_one_block  0.011330366134643555
generate_one_block  0.0012159347534179688
generate_one_block  0.0010995864868164062
generate_one_block  0.0010645389556884766
generate_one_block  0.001050710678100586
generate_one_block  0.0010542869567871094
generate_one_block  0.0010232925415039062
generate_one_block  0.0010447502136230469
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0021288394927978516
gen group dst list time:  0.00014400482177734375
time for parepare:  0.0006914138793945312
local_output_nid generation:  2.574920654296875e-05
local_in_edges_tensor generation:  0.0004420280456542969
mini_batch_src_global generation:  6.747245788574219e-05
r_  generation:  0.0003459453582763672
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00023508071899414062
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00033783912658691406
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00016307830810546875
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003414154052734375
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001628398895263672
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.000324249267578125
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  8.034706115722656e-05
r_  generation:  0.0003662109375
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00015234947204589844
mini_batch_src_global generation:  4.601478576660156e-05
r_  generation:  0.00032591819763183594
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.00014209747314453125
mini_batch_src_global generation:  3.8623809814453125e-05
r_  generation:  0.00022721290588378906
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00035381317138671875
----------------------check_connections_block total spend ----------------------------- 0.0065233707427978516
generate_one_block  0.0015785694122314453
generate_one_block  0.001653432846069336
generate_one_block  0.0016090869903564453
generate_one_block  0.001600027084350586
generate_one_block  0.0018801689147949219
generate_one_block  0.0013480186462402344
generate_one_block  0.0012881755828857422
generate_one_block  0.0015320777893066406
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015058517456054688
gen group dst list time:  0.00014019012451171875
time for parepare:  0.0005717277526855469
local_output_nid generation:  4.935264587402344e-05
local_in_edges_tensor generation:  0.0011475086212158203
mini_batch_src_global generation:  0.0003421306610107422
r_  generation:  0.0009119510650634766
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0004570484161376953
mini_batch_src_global generation:  0.0003337860107421875
r_  generation:  0.0010766983032226562
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00034046173095703125
mini_batch_src_global generation:  0.00014162063598632812
r_  generation:  0.001094818115234375
local_output_nid generation:  5.555152893066406e-05
local_in_edges_tensor generation:  0.00022268295288085938
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.001094818115234375
local_output_nid generation:  6.508827209472656e-05
local_in_edges_tensor generation:  0.000232696533203125
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0013077259063720703
local_output_nid generation:  4.482269287109375e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.00011491775512695312
r_  generation:  0.0009253025054931641
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.0002014636993408203
mini_batch_src_global generation:  0.00010061264038085938
r_  generation:  0.0008215904235839844
local_output_nid generation:  5.221366882324219e-05
local_in_edges_tensor generation:  0.00021076202392578125
mini_batch_src_global generation:  0.000118255615234375
r_  generation:  0.0009810924530029297
----------------------check_connections_block total spend ----------------------------- 0.016400575637817383
generate_one_block  0.0020895004272460938
generate_one_block  0.002115964889526367
generate_one_block  0.002117156982421875
generate_one_block  0.0028705596923828125
generate_one_block  0.0036954879760742188
generate_one_block  0.0018243789672851562
generate_one_block  0.0017237663269042969
generate_one_block  0.0019576549530029297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20809.16796875, 'VmSize': 20657.37109375, 'VmHWM': 3621.4296875, 'VmRSS': 3621.4296875}
connection checking time:  0.022923946380615234
block generation total time  0.0308840274810791
average batch blocks generation time:  0.0038605034351348877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005825519561767578  GigaBytes
Max Memory Allocated: 0.005825519561767578  GigaBytes

{'VmPeak': 21006.70703125, 'VmSize': 20977.9140625, 'VmHWM': 3911.3828125, 'VmRSS': 3911.3828125}
torch.Size([1020, 1433])
torch.Size([377, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00605010986328125  GigaBytes
Max Memory Allocated: 0.006103038787841797  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21750.03515625, 'VmHWM': 4605.98046875, 'VmRSS': 4605.98046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007262706756591797  GigaBytes
Max Memory Allocated: 0.012681961059570312  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21756.71875, 'VmHWM': 4614.1015625, 'VmRSS': 4614.1015625}
torch.Size([1222, 1433])
torch.Size([474, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007536888122558594  GigaBytes
Max Memory Allocated: 0.012681961059570312  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21756.71875, 'VmHWM': 4614.1015625, 'VmRSS': 4614.1015625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007039546966552734  GigaBytes
Max Memory Allocated: 0.01353597640991211  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21756.71875, 'VmHWM': 4614.453125, 'VmRSS': 4614.453125}
torch.Size([1180, 1433])
torch.Size([505, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007317066192626953  GigaBytes
Max Memory Allocated: 0.01353597640991211  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21756.71875, 'VmHWM': 4614.453125, 'VmRSS': 4614.453125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0070972442626953125  GigaBytes
Max Memory Allocated: 0.01353597640991211  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21756.71875, 'VmHWM': 4614.58203125, 'VmRSS': 4614.58203125}
torch.Size([1191, 1433])
torch.Size([505, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007376670837402344  GigaBytes
Max Memory Allocated: 0.01353597640991211  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21756.71875, 'VmHWM': 4614.58203125, 'VmRSS': 4614.58203125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007969379425048828  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.26171875, 'VmRSS': 4615.26171875}
torch.Size([1353, 1433])
torch.Size([595, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008295536041259766  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.26171875, 'VmRSS': 4615.26171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0066852569580078125  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.359375, 'VmRSS': 4615.359375}
torch.Size([1107, 1433])
torch.Size([405, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006928443908691406  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.359375, 'VmRSS': 4615.359375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006237030029296875  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.8125, 'VmRSS': 4615.8125}
torch.Size([1031, 1433])
torch.Size([347, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006435394287109375  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.8125, 'VmRSS': 4615.8125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006853580474853516  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.953125, 'VmRSS': 4615.953125}
torch.Size([1145, 1433])
torch.Size([488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007132530212402344  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4615.953125, 'VmRSS': 4615.953125}
{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4616.01953125, 'VmRSS': 4616.01953125}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.012946933507919312 |0.04683157801628113 |0.09948277473449707 |0.00015103816986083984 |0.0026494860649108887 |0.002750396728515625 |
----------------------------------------------------------pseudo_mini_loss sum 3.530839204788208
{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4616.51953125, 'VmRSS': 4616.51953125}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13696
Number of first layer input nodes during this epoch:  9249
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0076274871826171875  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21760.58203125, 'VmSize': 21757.43359375, 'VmHWM': 4616.51953125, 'VmRSS': 4616.51953125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005450248718261719
global_2_local 9.036064147949219e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.604194641113281e-05
before graph partition 
		100, 116, 83, 76, 89, 127, 98, 67, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002543926239013672
	Initialize BitList time :  1.2874603271484375e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 100, 116

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
	walk terminate 1 spend time 5.462589979171753
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		100, 116, 83, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046133995056152344
	Initialize BitList time :  2.6464462280273438e-05
	getRedundancyCost: time   2.384185791015625e-06

					length of partitions 116, 83

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
	walk terminate 1 spend time 5.605698823928833
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 116, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.000453948974609375
	Initialize BitList time :  3.4332275390625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 76

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
	walk terminate 1 spend time 5.432412385940552
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 116, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004684925079345703
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 116, 89

	before terminate 1 the average redundancy rate is:  1.2732919254658386
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
	walk terminate 1 spend time 5.63026762008667
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 116, 127, 98, 67, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00043773651123046875
	Initialize BitList time :  3.147125244140625e-05
	getRedundancyCost: time   2.1457672119140625e-06

					length of partitions 116, 127

	before terminate 1 the average redundancy rate is:  1.5093167701863355
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.6645962732919255,  1.3540372670807452
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.515527950310559,  1.5031055900621118
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.68944099378882,  1.3043478260869565
	walk terminate 1 spend time 5.456400632858276
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.1180124223602483,  1.875776397515528
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.2670807453416149,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.0807453416149069,  1.875776397515528
	walk terminate 1 spend time 5.413283824920654
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 76, 89, 87, 151, 98, 67, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 17, 19, 18, 14, 


	preparing two sides time :  0.0002880096435546875
	Initialize BitList time :  2.2411346435546875e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 151, 98

	before terminate 1 the average redundancy rate is:  1.5465838509316772
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
	walk terminate 1 spend time 5.386350393295288
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 151, 67, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 17, 18, 19, 14, 


	preparing two sides time :  0.0004775524139404297
	Initialize BitList time :  3.790855407714844e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 151, 67

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
	walk terminate 1 spend time 5.477172136306763
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 67, 151, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 43.88714623451233
partition_len_list
[100, 83, 76, 89, 87, 98, 67, 151]
range_init_graph_partition selection method range initialization spend 43.88763642311096
time for parepare:  0.00012135505676269531
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0014178752899169922
mini_batch_src_global generation:  0.0002033710479736328
r_  generation:  0.0004897117614746094
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00021767616271972656
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  6.0558319091796875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00021719932556152344
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002453327178955078
mini_batch_src_global generation:  2.9087066650390625e-05
r_  generation:  6.246566772460938e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  6.270408630371094e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.000118255615234375
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00011348724365234375
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  3.337860107421875e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  6.246566772460938e-05
----------------------check_connections_block total spend ----------------------------- 0.005080699920654297
generate_one_block  0.02724313735961914
generate_one_block  0.0012006759643554688
generate_one_block  0.00133514404296875
generate_one_block  0.0010712146759033203
generate_one_block  0.0010571479797363281
generate_one_block  0.001068115234375
generate_one_block  0.0010519027709960938
generate_one_block  0.0011017322540283203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.002371549606323242
gen group dst list time:  6.508827209472656e-05
time for parepare:  0.0007181167602539062
local_output_nid generation:  4.744529724121094e-05
local_in_edges_tensor generation:  0.0004112720489501953
mini_batch_src_global generation:  0.00012803077697753906
r_  generation:  0.0004343986511230469
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  7.700920104980469e-05
r_  generation:  0.00020551681518554688
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  3.528594970703125e-05
r_  generation:  0.0001804828643798828
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00012731552124023438
mini_batch_src_global generation:  5.3882598876953125e-05
r_  generation:  0.0003139972686767578
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00015282630920410156
mini_batch_src_global generation:  3.790855407714844e-05
r_  generation:  0.00027561187744140625
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.000141143798828125
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002963542938232422
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  3.337860107421875e-05
r_  generation:  0.0001671314239501953
local_output_nid generation:  1.33514404296875e-05
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.0003783702850341797
----------------------check_connections_block total spend ----------------------------- 0.005716800689697266
generate_one_block  0.0014166831970214844
generate_one_block  0.0012557506561279297
generate_one_block  0.001234292984008789
generate_one_block  0.001363992691040039
generate_one_block  0.001455545425415039
generate_one_block  0.0013921260833740234
generate_one_block  0.0013475418090820312
generate_one_block  0.001726388931274414
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0023927688598632812
gen group dst list time:  0.00011157989501953125
time for parepare:  0.0006444454193115234
local_output_nid generation:  4.220008850097656e-05
local_in_edges_tensor generation:  0.001346588134765625
mini_batch_src_global generation:  0.0003902912139892578
r_  generation:  0.0010509490966796875
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.0003769397735595703
mini_batch_src_global generation:  9.870529174804688e-05
r_  generation:  0.0006623268127441406
local_output_nid generation:  5.173683166503906e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  0.0001270771026611328
r_  generation:  0.0007169246673583984
local_output_nid generation:  6.699562072753906e-05
local_in_edges_tensor generation:  0.0006735324859619141
mini_batch_src_global generation:  0.000385284423828125
r_  generation:  0.0021371841430664062
local_output_nid generation:  0.00012040138244628906
local_in_edges_tensor generation:  0.00043654441833496094
mini_batch_src_global generation:  0.0003371238708496094
r_  generation:  0.0018115043640136719
local_output_nid generation:  9.298324584960938e-05
local_in_edges_tensor generation:  0.00039696693420410156
mini_batch_src_global generation:  0.0009064674377441406
r_  generation:  0.0018682479858398438
local_output_nid generation:  5.9604644775390625e-05
local_in_edges_tensor generation:  0.0003254413604736328
mini_batch_src_global generation:  0.0001811981201171875
r_  generation:  0.0013370513916015625
local_output_nid generation:  0.0001163482666015625
local_in_edges_tensor generation:  0.00030040740966796875
mini_batch_src_global generation:  0.00016736984252929688
r_  generation:  0.00182342529296875
----------------------check_connections_block total spend ----------------------------- 0.02309393882751465
generate_one_block  0.0039768218994140625
generate_one_block  0.003104686737060547
generate_one_block  0.0025796890258789062
generate_one_block  0.011104583740234375
generate_one_block  0.0021944046020507812
generate_one_block  0.002192974090576172
generate_one_block  0.0018415451049804688
generate_one_block  0.0025336742401123047
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0076274871826171875  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21821.69921875, 'VmHWM': 4617.37109375, 'VmRSS': 4617.37109375}
connection checking time:  0.028810739517211914
block generation total time  0.04072070121765137
average batch blocks generation time:  0.005090087652206421
block dataloader generation time/epoch 44.01594567298889
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007834434509277344  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.1796875, 'VmHWM': 4620.13671875, 'VmRSS': 4620.13671875}
torch.Size([1196, 1433])
torch.Size([581, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008151531219482422  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.1796875, 'VmHWM': 4620.13671875, 'VmRSS': 4620.13671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005801677703857422  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.1796875, 'VmHWM': 4620.60546875, 'VmRSS': 4620.60546875}
torch.Size([817, 1433])
torch.Size([335, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006001949310302734  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.1796875, 'VmHWM': 4620.60546875, 'VmRSS': 4620.60546875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007285594940185547  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.1796875, 'VmHWM': 4620.75390625, 'VmRSS': 4620.75390625}
torch.Size([1095, 1433])
torch.Size([337, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007483482360839844  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.1796875, 'VmHWM': 4620.75390625, 'VmRSS': 4620.75390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008180618286132812  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.53515625, 'VmHWM': 4620.96484375, 'VmRSS': 4620.96484375}
torch.Size([1261, 1433])
torch.Size([536, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008472919464111328  GigaBytes
Max Memory Allocated: 0.014294624328613281  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4620.96875, 'VmRSS': 4620.9609375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007733821868896484  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4620.98046875, 'VmRSS': 4620.98046875}
torch.Size([1178, 1433])
torch.Size([437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007982254028320312  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4620.98046875, 'VmRSS': 4620.98046875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007810115814208984  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4621.0859375, 'VmRSS': 4621.0859375}
torch.Size([1192, 1433])
torch.Size([430, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008063316345214844  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4621.0859375, 'VmRSS': 4621.0859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006280422210693359  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4621.0859375, 'VmRSS': 4621.0859375}
torch.Size([907, 1433])
torch.Size([297, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006456851959228516  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.51953125, 'VmHWM': 4621.0859375, 'VmRSS': 4621.0859375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008545875549316406  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.8828125, 'VmHWM': 4621.28515625, 'VmRSS': 4621.28515625}
torch.Size([1328, 1433])
torch.Size([598, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008903026580810547  GigaBytes
Max Memory Allocated: 0.014441490173339844  GigaBytes

{'VmPeak': 21885.44921875, 'VmSize': 21825.8828125, 'VmHWM': 4621.28515625, 'VmRSS': 4621.28515625}
{'VmPeak': 21885.44921875, 'VmSize': 21825.8828125, 'VmHWM': 4621.2890625, 'VmRSS': 4621.2890625}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.009998828172683716 |0.000574648380279541 |0.004283905029296875 |0.0001532435417175293 |0.003196120262145996 |0.0017504692077636719 |
----------------------------------------------------------pseudo_mini_loss sum 2.5786938667297363
{'VmPeak': 21885.44921875, 'VmSize': 21825.8828125, 'VmHWM': 4621.2890625, 'VmRSS': 4621.2890625}
Total (block generation + training)time/epoch 44.17592930793762
Training time/epoch 0.15943431854248047
Training time without block to device /epoch 0.15483713150024414
Training time without total dataloading part /epoch 0.06281661987304688
load block tensor time/epoch 0.07999062538146973
block to device time/epoch 0.004597187042236328
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  13276
Number of first layer input nodes during this epoch:  8974
