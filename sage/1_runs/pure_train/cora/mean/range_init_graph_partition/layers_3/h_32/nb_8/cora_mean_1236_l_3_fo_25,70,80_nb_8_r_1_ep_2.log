main start at this time 1648606183.1630561
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20805.7890625, 'VmSize': 20801.7890625, 'VmHWM': 3612.9453125, 'VmRSS': 3612.9453125}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009629726409912109
global_2_local 0.00011277198791503906
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  7.581710815429688e-05
before graph partition 
		89, 105, 105, 72, 116, 104, 92, 71, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00026106834411621094
	Initialize BitList time :  1.430511474609375e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 89, 105

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
	walk terminate 1 spend time 4.574476957321167
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005347728729248047
	Initialize BitList time :  3.719329833984375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 105, 105

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
	walk terminate 1 spend time 4.531080484390259
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003917217254638672
	Initialize BitList time :  3.0279159545898438e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 105, 72

	before terminate 1 the average redundancy rate is:  1.0993788819875776
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.567009687423706
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.502062797546387
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004892349243164062
	Initialize BitList time :  4.1484832763671875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 90, 116

	before terminate 1 the average redundancy rate is:  1.279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
	walk terminate 1 spend time 4.532387971878052
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0017528533935546875
	Initialize BitList time :  3.695487976074219e-05
	getRedundancyCost: time   4.291534423828125e-06

					length of partitions 116, 104

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
	walk terminate 1 spend time 4.60332179069519
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 116, 92, 71, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.000476837158203125
	Initialize BitList time :  3.886222839355469e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 92

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.956189393997192
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.596513986587524
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		89, 105, 85, 90, 104, 103, 104, 71, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 21, 18, 21, 15, 14, 


	preparing two sides time :  0.0005030632019042969
	Initialize BitList time :  3.528594970703125e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 104, 71

	before terminate 1 the average redundancy rate is:  1.0869565217391304
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
	walk terminate 1 spend time 4.512976884841919
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 103, 71, 104, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 41.40383768081665
partition_len_list
[89, 105, 85, 90, 104, 103, 71, 104]
range_init_graph_partition selection method range initialization spend 41.404608726501465
time for parepare:  0.0001533031463623047
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.03005361557006836
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.009538888931274414
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00023865699768066406
mini_batch_src_global generation:  3.361701965332031e-05
r_  generation:  8.0108642578125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001392364501953125
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  4.3392181396484375e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.7220458984375e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  3.123283386230469e-05
r_  generation:  5.984306335449219e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.4345855712890625e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011992454528808594
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  7.62939453125e-05
----------------------check_connections_block total spend ----------------------------- 0.04229164123535156
generate_one_block  0.00709223747253418
generate_one_block  0.0011773109436035156
generate_one_block  0.001031637191772461
generate_one_block  0.0010788440704345703
generate_one_block  0.0010154247283935547
generate_one_block  0.001016378402709961
generate_one_block  0.00104522705078125
generate_one_block  0.0010521411895751953
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009205341339111328
gen group dst list time:  0.00013208389282226562
time for parepare:  0.0004754066467285156
local_output_nid generation:  3.218650817871094e-05
local_in_edges_tensor generation:  0.00029540061950683594
mini_batch_src_global generation:  8.988380432128906e-05
r_  generation:  0.00031757354736328125
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001533031463623047
mini_batch_src_global generation:  8.177757263183594e-05
r_  generation:  0.0003426074981689453
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00014710426330566406
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  0.00032591819763183594
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001468658447265625
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  0.00029540061950683594
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014519691467285156
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.0001506805419921875
mini_batch_src_global generation:  4.363059997558594e-05
r_  generation:  0.00028514862060546875
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00014138221740722656
mini_batch_src_global generation:  3.5762786865234375e-05
r_  generation:  0.00023651123046875
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00032591819763183594
----------------------check_connections_block total spend ----------------------------- 0.005727291107177734
generate_one_block  0.002348661422729492
generate_one_block  0.0016069412231445312
generate_one_block  0.0016582012176513672
generate_one_block  0.0016818046569824219
generate_one_block  0.005061626434326172
generate_one_block  0.0012145042419433594
generate_one_block  0.0011646747589111328
generate_one_block  0.0012509822845458984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0006847381591796875
gen group dst list time:  0.00013828277587890625
time for parepare:  0.0004897117614746094
local_output_nid generation:  4.76837158203125e-05
local_in_edges_tensor generation:  0.0003523826599121094
mini_batch_src_global generation:  0.00029659271240234375
r_  generation:  0.0008642673492431641
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0002300739288330078
mini_batch_src_global generation:  0.00036978721618652344
r_  generation:  0.0010190010070800781
local_output_nid generation:  5.4836273193359375e-05
local_in_edges_tensor generation:  0.020977497100830078
mini_batch_src_global generation:  0.0005972385406494141
r_  generation:  0.0019490718841552734
local_output_nid generation:  8.606910705566406e-05
local_in_edges_tensor generation:  0.00044226646423339844
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.0018858909606933594
local_output_nid generation:  0.00010085105895996094
local_in_edges_tensor generation:  0.0004096031188964844
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.002275228500366211
local_output_nid generation:  7.081031799316406e-05
local_in_edges_tensor generation:  0.00035500526428222656
mini_batch_src_global generation:  0.0001881122589111328
r_  generation:  0.0013875961303710938
local_output_nid generation:  4.291534423828125e-05
local_in_edges_tensor generation:  0.00022721290588378906
mini_batch_src_global generation:  0.00010776519775390625
r_  generation:  0.0009043216705322266
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  0.0001308917999267578
r_  generation:  0.0012688636779785156
----------------------check_connections_block total spend ----------------------------- 0.04175090789794922
generate_one_block  0.002885103225708008
generate_one_block  0.002849578857421875
generate_one_block  0.0022215843200683594
generate_one_block  0.0021588802337646484
generate_one_block  0.002444028854370117
generate_one_block  0.0020918846130371094
generate_one_block  0.0019216537475585938
generate_one_block  0.002227306365966797
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20807.90625, 'VmSize': 20656.25390625, 'VmHWM': 3620.19140625, 'VmRSS': 3620.19140625}
connection checking time:  0.04747819900512695
block generation total time  0.03478741645812988
average batch blocks generation time:  0.004348427057266235
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005360126495361328  GigaBytes
Max Memory Allocated: 0.005360126495361328  GigaBytes

{'VmPeak': 21019.22265625, 'VmSize': 20987.2265625, 'VmHWM': 3921.03125, 'VmRSS': 3921.03125}
torch.Size([933, 1433])
torch.Size([374, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005582332611083984  GigaBytes
Max Memory Allocated: 0.005625247955322266  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21752.68359375, 'VmHWM': 4608.3671875, 'VmRSS': 4608.3671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007091045379638672  GigaBytes
Max Memory Allocated: 0.01204681396484375  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21759.28125, 'VmHWM': 4616.76171875, 'VmRSS': 4616.76171875}
torch.Size([1190, 1433])
torch.Size([473, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0073642730712890625  GigaBytes
Max Memory Allocated: 0.01204681396484375  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21759.28125, 'VmHWM': 4616.76171875, 'VmRSS': 4616.76171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0068035125732421875  GigaBytes
Max Memory Allocated: 0.01313018798828125  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21759.28125, 'VmHWM': 4617.63671875, 'VmRSS': 4617.63671875}
torch.Size([1136, 1433])
torch.Size([506, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007080078125  GigaBytes
Max Memory Allocated: 0.01313018798828125  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21759.28125, 'VmHWM': 4617.63671875, 'VmRSS': 4617.63671875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007064342498779297  GigaBytes
Max Memory Allocated: 0.01313018798828125  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21759.28125, 'VmHWM': 4617.78125, 'VmRSS': 4617.78125}
torch.Size([1185, 1433])
torch.Size([502, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0073413848876953125  GigaBytes
Max Memory Allocated: 0.01313018798828125  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21759.28125, 'VmHWM': 4617.78125, 'VmRSS': 4617.78125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007883071899414062  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.265625, 'VmRSS': 4618.265625}
torch.Size([1337, 1433])
torch.Size([595, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.008208274841308594  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.265625, 'VmRSS': 4618.265625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006802558898925781  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.3515625, 'VmRSS': 4618.3515625}
torch.Size([1066, 1433])
torch.Size([409, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007047176361083984  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.3515625, 'VmRSS': 4618.3515625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00585174560546875  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.5390625, 'VmRSS': 4618.5390625}
torch.Size([959, 1433])
torch.Size([344, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006047725677490234  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.5390625, 'VmRSS': 4618.5390625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.00666046142578125  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.54296875, 'VmRSS': 4618.54296875}
torch.Size([1109, 1433])
torch.Size([488, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006938457489013672  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.54296875, 'VmRSS': 4618.54296875}
{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.98046875, 'VmRSS': 4618.98046875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010762900114059448 |0.04628831148147583 |0.10105061531066895 |0.0001614987850189209 |0.0027445554733276367 |0.0024831295013427734 |
----------------------------------------------------------pseudo_mini_loss sum 3.5212013721466064
{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.98046875, 'VmRSS': 4618.98046875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  13357
Number of first layer input nodes during this epoch:  8915
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007432460784912109  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21769.24609375, 'VmSize': 21760.0859375, 'VmHWM': 4618.98046875, 'VmRSS': 4618.98046875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006535053253173828
global_2_local 7.486343383789062e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.221366882324219e-05
before graph partition 
		100, 116, 83, 76, 89, 127, 98, 67, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00020885467529296875
	Initialize BitList time :  1.1682510375976562e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 100, 116

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
	walk terminate 1 spend time 5.185081243515015
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		100, 116, 83, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047469139099121094
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 116, 83

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
	walk terminate 1 spend time 5.462230682373047
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 116, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004410743713378906
	Initialize BitList time :  7.367134094238281e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 116, 76

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
	walk terminate 1 spend time 5.3654584884643555
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 116, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00047469139099121094
	Initialize BitList time :  3.62396240234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 89

	before terminate 1 the average redundancy rate is:  1.2732919254658386
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
	walk terminate 1 spend time 5.440914154052734
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 116, 127, 98, 67, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0005021095275878906
	Initialize BitList time :  4.00543212890625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 127

	before terminate 1 the average redundancy rate is:  1.5093167701863355
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.6645962732919255,  1.3540372670807452
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.515527950310559,  1.5031055900621118
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.68944099378882,  1.3043478260869565
	walk terminate 1 spend time 5.581621408462524
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.1180124223602483,  1.875776397515528
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.2670807453416149,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.0807453416149069,  1.875776397515528
	walk terminate 1 spend time 5.343638181686401
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 76, 89, 87, 151, 98, 67, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 17, 19, 18, 14, 


	preparing two sides time :  0.0004534721374511719
	Initialize BitList time :  3.337860107421875e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 151, 98

	before terminate 1 the average redundancy rate is:  1.5465838509316772
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
	walk terminate 1 spend time 5.623587608337402
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 151, 67, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 17, 18, 19, 14, 


	preparing two sides time :  0.0005016326904296875
	Initialize BitList time :  9.72747802734375e-05
	getRedundancyCost: time   3.814697265625e-06

					length of partitions 151, 67

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
	walk terminate 1 spend time 5.417308807373047
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 67, 151, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 43.446948766708374
partition_len_list
[100, 83, 76, 89, 87, 98, 67, 151]
range_init_graph_partition selection method range initialization spend 43.44742202758789
time for parepare:  0.00012564659118652344
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.0013854503631591797
mini_batch_src_global generation:  0.00013875961303710938
r_  generation:  0.0003509521484375
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00015735626220703125
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  1.8596649169921875e-05
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  5.6743621826171875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001342296600341797
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  4.601478576660156e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001323223114013672
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  2.1219253540039062e-05
r_  generation:  4.696846008300781e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  2.0265579223632812e-05
r_  generation:  3.5762786865234375e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  7.271766662597656e-05
----------------------check_connections_block total spend ----------------------------- 0.00473332405090332
generate_one_block  0.023400306701660156
generate_one_block  0.0011723041534423828
generate_one_block  0.001413106918334961
generate_one_block  0.001007080078125
generate_one_block  0.0009899139404296875
generate_one_block  0.0011065006256103516
generate_one_block  0.0010294914245605469
generate_one_block  0.0010409355163574219
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0017154216766357422
gen group dst list time:  6.413459777832031e-05
time for parepare:  0.0005946159362792969
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.0005950927734375
mini_batch_src_global generation:  0.00011086463928222656
r_  generation:  0.0004248619079589844
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  6.318092346191406e-05
r_  generation:  0.00020623207092285156
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.266334533691406e-05
r_  generation:  0.00018310546875
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.00012564659118652344
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00027441978454589844
local_output_nid generation:  1.0251998901367188e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.00026345252990722656
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013017654418945312
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.0002856254577636719
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001266002655029297
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001697540283203125
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.00042748451232910156
----------------------check_connections_block total spend ----------------------------- 0.005777120590209961
generate_one_block  0.0014481544494628906
generate_one_block  0.0012738704681396484
generate_one_block  0.0012543201446533203
generate_one_block  0.0013813972473144531
generate_one_block  0.0014297962188720703
generate_one_block  0.00141143798828125
generate_one_block  0.0013473033905029297
generate_one_block  0.001674652099609375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0011191368103027344
gen group dst list time:  0.00010991096496582031
time for parepare:  0.0007131099700927734
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0006241798400878906
mini_batch_src_global generation:  0.00036072731018066406
r_  generation:  0.0009415149688720703
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.0002961158752441406
mini_batch_src_global generation:  8.296966552734375e-05
r_  generation:  0.0006413459777832031
local_output_nid generation:  2.9325485229492188e-05
local_in_edges_tensor generation:  0.00021505355834960938
mini_batch_src_global generation:  7.343292236328125e-05
r_  generation:  0.0007226467132568359
local_output_nid generation:  4.458427429199219e-05
local_in_edges_tensor generation:  0.00024437904357910156
mini_batch_src_global generation:  0.0001475811004638672
r_  generation:  0.0009067058563232422
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00017905235290527344
mini_batch_src_global generation:  9.107589721679688e-05
r_  generation:  0.0007836818695068359
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00017642974853515625
mini_batch_src_global generation:  0.00011610984802246094
r_  generation:  0.0007956027984619141
local_output_nid generation:  2.7418136596679688e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  0.00012731552124023438
r_  generation:  0.0005717277526855469
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00022339820861816406
mini_batch_src_global generation:  0.00016927719116210938
r_  generation:  0.0010516643524169922
----------------------check_connections_block total spend ----------------------------- 0.013208866119384766
generate_one_block  0.0022232532501220703
generate_one_block  0.0017004013061523438
generate_one_block  0.001706838607788086
generate_one_block  0.005201101303100586
generate_one_block  0.004301309585571289
generate_one_block  0.004174947738647461
generate_one_block  0.0026319026947021484
generate_one_block  0.0037069320678710938
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007432460784912109  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.6640625, 'VmRSS': 4619.6640625}
connection checking time:  0.018985986709594727
block generation total time  0.036867618560791016
average batch blocks generation time:  0.004608452320098877
block dataloader generation time/epoch 43.556159257888794
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007785320281982422  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.79296875, 'VmRSS': 4619.79296875}
torch.Size([1187, 1433])
torch.Size([575, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008098125457763672  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.79296875, 'VmRSS': 4619.79296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0056247711181640625  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.796875, 'VmRSS': 4619.796875}
torch.Size([784, 1433])
torch.Size([335, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005824089050292969  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.796875, 'VmRSS': 4619.796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006729602813720703  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.796875, 'VmRSS': 4619.796875}
torch.Size([991, 1433])
torch.Size([337, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006926536560058594  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.796875, 'VmRSS': 4619.796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007954597473144531  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.796875, 'VmRSS': 4619.796875}
torch.Size([1219, 1433])
torch.Size([536, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008244991302490234  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3515625, 'VmHWM': 4619.796875, 'VmRSS': 4619.796875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0073375701904296875  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
torch.Size([1104, 1433])
torch.Size([437, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007585048675537109  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007397174835205078  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
torch.Size([1115, 1433])
torch.Size([426, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007647037506103516  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005996227264404297  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
torch.Size([854, 1433])
torch.Size([299, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006171703338623047  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008319854736328125  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
torch.Size([1286, 1433])
torch.Size([599, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008675098419189453  GigaBytes
Max Memory Allocated: 0.014177322387695312  GigaBytes

{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.015526533126831055 |0.0008146166801452637 |0.0055061280727386475 |0.00020870566368103027 |0.0042029619216918945 |0.002434968948364258 |
----------------------------------------------------------pseudo_mini_loss sum 2.6240506172180176
{'VmPeak': 21824.3515625, 'VmSize': 21824.3359375, 'VmHWM': 4619.80078125, 'VmRSS': 4619.79296875}
Total (block generation + training)time/epoch 43.784950494766235
Training time/epoch 0.2275090217590332
Training time without block to device /epoch 0.2209920883178711
Training time without total dataloading part /epoch 0.08177733421325684
load block tensor time/epoch 0.12421226501464844
block to device time/epoch 0.006516933441162109
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  12835
Number of first layer input nodes during this epoch:  8540
