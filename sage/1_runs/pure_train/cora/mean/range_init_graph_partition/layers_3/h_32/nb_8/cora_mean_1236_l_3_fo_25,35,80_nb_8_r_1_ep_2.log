main start at this time 1648605749.7978888
-----------------------------------------before load data 
 Nvidia-smi: 11.1502685546875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

in feats:  1433
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20865.875, 'VmSize': 20865.875, 'VmHWM': 3612.0, 'VmRSS': 3612.0}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010330677032470703
global_2_local 9.012222290039062e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  6.461143493652344e-05
before graph partition 
		89, 105, 105, 72, 116, 104, 92, 71, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002579689025878906
	Initialize BitList time :  1.430511474609375e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 89, 105

	before terminate 1 the average redundancy rate is:  1.204968944099379
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
Using backend: pytorch
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.204968944099379,  1.1055900621118013,  1.3043478260869565
	walk terminate 1 spend time 4.2606658935546875
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0004949569702148438
	Initialize BitList time :  3.3855438232421875e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 105, 105

	before terminate 1 the average redundancy rate is:  1.3043478260869565
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3043478260869565,  1.3043478260869565,  1.3043478260869565
	walk terminate 1 spend time 4.546915054321289
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 105, 72, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046563148498535156
	Initialize BitList time :  3.218650817871094e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 105, 72

	before terminate 1 the average redundancy rate is:  1.0993788819875776
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.55964469909668
				 improvement:  True
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.0559006211180124,  1.1180124223602483
	walk terminate 1 spend time 4.286917209625244
				 improvement:  True
0
side is 1
	 walk step 1  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.00048232078552246094
	Initialize BitList time :  3.790855407714844e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 90, 116

	before terminate 1 the average redundancy rate is:  1.279503105590062
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.279503105590062,  1.1180124223602483,  1.4409937888198758
	walk terminate 1 spend time 4.59398627281189
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		89, 105, 85, 90, 116, 104, 92, 71, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.001142263412475586
	Initialize BitList time :  3.6716461181640625e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 116, 104

	before terminate 1 the average redundancy rate is:  1.3664596273291925
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3664596273291925,  1.4409937888198758,  1.2919254658385093
	walk terminate 1 spend time 4.629376411437988
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 116, 92, 71, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 15, 21, 18, 18, 18, 14, 


	preparing two sides time :  0.0004742145538330078
	Initialize BitList time :  4.0531158447265625e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 116, 92

	before terminate 1 the average redundancy rate is:  1.2919254658385093
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.006211180124223725
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.439230918884277
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2857142857142856,  1.2919254658385093,  1.279503105590062
	walk terminate 1 spend time 4.610256910324097
				 improvement:  True
1
side is 0
	 walk step 1  partition 
		89, 105, 85, 90, 104, 103, 104, 71, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 15, 21, 18, 21, 15, 14, 


	preparing two sides time :  0.0004909038543701172
	Initialize BitList time :  3.504753112792969e-05
	getRedundancyCost: time   3.0994415283203125e-06

					length of partitions 104, 71

	before terminate 1 the average redundancy rate is:  1.0869565217391304
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.0869565217391304,  1.2919254658385093,  0.8819875776397516
	walk terminate 1 spend time 4.399926424026489
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		89, 105, 85, 90, 104, 103, 71, 104, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 40.353116273880005
partition_len_list
[89, 105, 85, 90, 104, 103, 71, 104]
range_init_graph_partition selection method range initialization spend 40.353641748428345
time for parepare:  0.0002033710479736328
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.009257078170776367
mini_batch_src_global generation:  0.00013947486877441406
r_  generation:  0.012354850769042969
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00019240379333496094
mini_batch_src_global generation:  4.5299530029296875e-05
r_  generation:  5.4836273193359375e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012946128845214844
mini_batch_src_global generation:  1.9550323486328125e-05
r_  generation:  4.100799560546875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  5.745887756347656e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.6253204345703125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011968612670898438
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.457069396972656e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00012159347534179688
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  7.653236389160156e-05
----------------------check_connections_block total spend ----------------------------- 0.02439427375793457
generate_one_block  0.008085250854492188
generate_one_block  0.0013604164123535156
generate_one_block  0.0010704994201660156
generate_one_block  0.0010571479797363281
generate_one_block  0.0010831356048583984
generate_one_block  0.0010724067687988281
generate_one_block  0.0010540485382080078
generate_one_block  0.0010864734649658203
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0010347366333007812
gen group dst list time:  0.00013637542724609375
time for parepare:  0.0004017353057861328
local_output_nid generation:  2.4080276489257812e-05
local_in_edges_tensor generation:  0.0004086494445800781
mini_batch_src_global generation:  4.8160552978515625e-05
r_  generation:  0.0002655982971191406
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00016164779663085938
mini_batch_src_global generation:  5.221366882324219e-05
r_  generation:  0.0002906322479248047
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002651214599609375
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014257431030273438
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002741813659667969
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.00032973289489746094
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001437664031982422
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.0002703666687011719
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.00019884109497070312
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00030159950256347656
----------------------check_connections_block total spend ----------------------------- 0.005316495895385742
generate_one_block  0.002341032028198242
generate_one_block  0.0015521049499511719
generate_one_block  0.0015442371368408203
generate_one_block  0.001619100570678711
generate_one_block  0.0047724246978759766
generate_one_block  0.0013899803161621094
generate_one_block  0.001188039779663086
generate_one_block  0.0012543201446533203
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007410049438476562
gen group dst list time:  0.00013828277587890625
time for parepare:  0.0005815029144287109
local_output_nid generation:  4.673004150390625e-05
local_in_edges_tensor generation:  0.00044608116149902344
mini_batch_src_global generation:  0.0002522468566894531
r_  generation:  0.0008122920989990234
local_output_nid generation:  4.267692565917969e-05
local_in_edges_tensor generation:  0.00020599365234375
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0009143352508544922
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.00020575523376464844
mini_batch_src_global generation:  0.0001010894775390625
r_  generation:  0.0008959770202636719
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.00020432472229003906
mini_batch_src_global generation:  0.00010657310485839844
r_  generation:  0.0009148120880126953
local_output_nid generation:  5.435943603515625e-05
local_in_edges_tensor generation:  0.00022745132446289062
mini_batch_src_global generation:  0.0001361370086669922
r_  generation:  0.0011096000671386719
local_output_nid generation:  4.124641418457031e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00010514259338378906
r_  generation:  0.0008478164672851562
local_output_nid generation:  3.266334533691406e-05
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  8.535385131835938e-05
r_  generation:  0.0006661415100097656
local_output_nid generation:  4.5299530029296875e-05
local_in_edges_tensor generation:  0.00020933151245117188
mini_batch_src_global generation:  0.00010633468627929688
r_  generation:  0.0009806156158447266
----------------------check_connections_block total spend ----------------------------- 0.013390064239501953
generate_one_block  0.00357818603515625
generate_one_block  0.004698991775512695
generate_one_block  0.004244089126586914
generate_one_block  0.003217935562133789
generate_one_block  0.003682851791381836
generate_one_block  0.0034906864166259766
generate_one_block  0.002701282501220703
generate_one_block  0.003101348876953125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.9959716796875 GB
    Memory Allocated: 0.0003566741943359375  GigaBytes
Max Memory Allocated: 0.0003566741943359375  GigaBytes

{'VmPeak': 20871.3828125, 'VmSize': 20720.19921875, 'VmHWM': 3619.03125, 'VmRSS': 3619.03125}
connection checking time:  0.018706560134887695
block generation total time  0.04437661170959473
average batch blocks generation time:  0.005547076463699341
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 0.005257606506347656  GigaBytes
Max Memory Allocated: 0.005257606506347656  GigaBytes

{'VmPeak': 21031.296875, 'VmSize': 20999.4296875, 'VmHWM': 3932.19921875, 'VmRSS': 3932.19921875}
torch.Size([914, 1433])
torch.Size([358, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005472660064697266  GigaBytes
Max Memory Allocated: 0.005513668060302734  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21750.46484375, 'VmHWM': 4605.6328125, 'VmRSS': 4605.6328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006560802459716797  GigaBytes
Max Memory Allocated: 0.011416912078857422  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21756.48828125, 'VmHWM': 4612.34765625, 'VmRSS': 4612.34765625}
torch.Size([1091, 1433])
torch.Size([416, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006808757781982422  GigaBytes
Max Memory Allocated: 0.011416912078857422  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21756.48828125, 'VmHWM': 4612.34765625, 'VmRSS': 4612.34765625}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006186008453369141  GigaBytes
Max Memory Allocated: 0.011988162994384766  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21756.48828125, 'VmHWM': 4612.921875, 'VmRSS': 4612.921875}
torch.Size([1021, 1433])
torch.Size([416, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006422996520996094  GigaBytes
Max Memory Allocated: 0.011988162994384766  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21756.48828125, 'VmHWM': 4612.921875, 'VmRSS': 4612.921875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006511688232421875  GigaBytes
Max Memory Allocated: 0.011988162994384766  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21756.48828125, 'VmHWM': 4613.578125, 'VmRSS': 4613.578125}
torch.Size([1082, 1433])
torch.Size([433, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0067596435546875  GigaBytes
Max Memory Allocated: 0.011988162994384766  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21756.48828125, 'VmHWM': 4613.578125, 'VmRSS': 4613.578125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007259845733642578  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4613.96875, 'VmRSS': 4613.96875}
torch.Size([1221, 1433])
torch.Size([513, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.007550239562988281  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4613.96875, 'VmRSS': 4613.96875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0065097808837890625  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.1171875, 'VmRSS': 4614.1171875}
torch.Size([1013, 1433])
torch.Size([378, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006739139556884766  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.1171875, 'VmRSS': 4614.1171875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.005347728729248047  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.27734375, 'VmRSS': 4614.27734375}
torch.Size([865, 1433])
torch.Size([291, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.0055217742919921875  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.27734375, 'VmRSS': 4614.27734375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006514549255371094  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.61328125, 'VmRSS': 4614.61328125}
torch.Size([1053, 1433])
torch.Size([442, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2401123046875 GB
    Memory Allocated: 0.006773471832275391  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.61328125, 'VmRSS': 4614.61328125}
{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.6171875, 'VmRSS': 4614.6171875}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007786005735397339 |0.04717892408370972 |0.10154765844345093 |0.0001563727855682373 |0.002553015947341919 |0.0024204254150390625 |
----------------------------------------------------------pseudo_mini_loss sum 3.558858871459961
{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4614.6171875, 'VmRSS': 4614.6171875}
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  12258
Number of first layer input nodes during this epoch:  8260
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007282733917236328  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21760.15625, 'VmSize': 21757.19921875, 'VmHWM': 4615.1171875, 'VmRSS': 4615.1171875}
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0004868507385253906
global_2_local 7.677078247070312e-05
---------------------------- variant graph partition start---------------------
range_init for graph_partition spend:  5.412101745605469e-05
before graph partition 
		100, 116, 83, 76, 89, 127, 98, 67, 

{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-{}-

-------------------------------------------------------------  compare batch pair  (0,1)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0002086162567138672
	Initialize BitList time :  1.1205673217773438e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 100, 116

	before terminate 1 the average redundancy rate is:  1.341614906832298
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.341614906832298,  1.2422360248447204,  1.4409937888198758
	walk terminate 1 spend time 5.186831951141357
				 improvement:  False
0
side is 1
	 walk step 0  partition 
		100, 116, 83, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 0
-------------------------------------------------------------  compare batch pair  (1,2)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00032138824462890625
	Initialize BitList time :  2.5987625122070312e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 116, 83

	before terminate 1 the average redundancy rate is:  1.236024844720497
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.236024844720497,  1.4409937888198758,  1.031055900621118
	walk terminate 1 spend time 5.279616832733154
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 116, 76, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 1
-------------------------------------------------------------  compare batch pair  (2,3)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003132820129394531
	Initialize BitList time :  2.6941299438476562e-05
	getRedundancyCost: time   2.86102294921875e-06

					length of partitions 116, 76

	before terminate 1 the average redundancy rate is:  1.1925465838509317
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.1925465838509317,  1.4409937888198758,  0.9440993788819876
	walk terminate 1 spend time 5.36772346496582
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 116, 89, 127, 98, 67, 


	--------------------------------------------------end of batch 2
-------------------------------------------------------------  compare batch pair  (3,4)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.00046896934509277344
	Initialize BitList time :  3.552436828613281e-05
	getRedundancyCost: time   3.337860107421875e-06

					length of partitions 116, 89

	before terminate 1 the average redundancy rate is:  1.2732919254658386
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.2732919254658386,  1.4409937888198758,  1.1055900621118013
	walk terminate 1 spend time 5.541334629058838
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 116, 127, 98, 67, 


	--------------------------------------------------end of batch 3
-------------------------------------------------------------  compare batch pair  (4,5)
				 list len:
				18, 18, 18, 18, 18, 18, 18, 14, 


	preparing two sides time :  0.0003876686096191406
	Initialize BitList time :  3.075599670410156e-05
	getRedundancyCost: time   2.6226043701171875e-06

					length of partitions 116, 127

	before terminate 1 the average redundancy rate is:  1.5093167701863355
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  1
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :0  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.6645962732919255,  1.3540372670807452
						 current side  0
			 redundancy will reduce  2.220446049250313e-16
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5093167701863353,  1.515527950310559,  1.5031055900621118
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.68944099378882,  1.3043478260869565
	walk terminate 1 spend time 5.199773788452148
				 improvement:  True
	 walk terminate 1 start-------
						 current side  0
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 4
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.1180124223602483,  1.875776397515528
						 current side  1
			 redundancy will reduce  0.012422360248447228
			 the number of node to move is : 3
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4968944099378882,  1.2670807453416149,  1.7267080745341614
						 current side  0
			 redundancy will reduce  0.031055900621118182
			 the number of node to move is : 3
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.4782608695652173,  1.0807453416149069,  1.875776397515528
	walk terminate 1 spend time 5.282074451446533
				 improvement:  True
1
side is 1
	 walk step 1  partition 
		100, 83, 76, 89, 87, 151, 98, 67, 


	--------------------------------------------------end of batch 4
-------------------------------------------------------------  compare batch pair  (5,6)
				 list len:
				18, 18, 18, 18, 17, 19, 18, 14, 


	preparing two sides time :  0.0004825592041015625
	Initialize BitList time :  3.647804260253906e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 151, 98

	before terminate 1 the average redundancy rate is:  1.5465838509316772
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.5465838509316772,  1.875776397515528,  1.2173913043478262
	walk terminate 1 spend time 5.387930631637573
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 151, 67, 


	--------------------------------------------------end of batch 5
-------------------------------------------------------------  compare batch pair  (6,7)
				 list len:
				18, 18, 18, 18, 17, 18, 19, 14, 


	preparing two sides time :  0.0004801750183105469
	Initialize BitList time :  3.62396240234375e-05
	getRedundancyCost: time   3.5762786865234375e-06

					length of partitions 151, 67

	before terminate 1 the average redundancy rate is:  1.3540372670807455
	--------------------------------------------------------------------------------
	 walk terminate 1 start-------
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :0  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  1
			 the number of node to move is : 0
			 --group redundancy rate update  step :1  side 1
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
						 current side  0
			 the number of node to move is : 0
			 --group redundancy rate update  step :2  side 0
			 redundancy rate (ration_mean, ratio_A, ratio_B): 1.3540372670807455,  1.875776397515528,  0.8322981366459627
	walk terminate 1 spend time 5.293970823287964
				 improvement:  False
1
side is 0
	 walk step 0  partition 
		100, 83, 76, 89, 87, 98, 67, 151, 


	--------------------------------------------------end of batch 6
after graph partition
graph partition algorithm spend time 42.5623242855072
partition_len_list
[100, 83, 76, 89, 87, 98, 67, 151]
range_init_graph_partition selection method range initialization spend 42.56303644180298
time for parepare:  0.0002732276916503906
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.0431365966796875
mini_batch_src_global generation:  0.0001895427703857422
r_  generation:  0.0007998943328857422
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0002040863037109375
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  4.76837158203125e-06
local_in_edges_tensor generation:  0.0001895427703857422
mini_batch_src_global generation:  2.1457672119140625e-05
r_  generation:  3.814697265625e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00012636184692382812
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.291534423828125e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00013065338134765625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.076957702636719e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.3126602172851562e-05
r_  generation:  4.553794860839844e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00017380714416503906
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.00011372566223144531
----------------------check_connections_block total spend ----------------------------- 0.04800844192504883
generate_one_block  0.015319585800170898
generate_one_block  0.0014858245849609375
generate_one_block  0.0013544559478759766
generate_one_block  0.0010700225830078125
generate_one_block  0.0010433197021484375
generate_one_block  0.0010476112365722656
generate_one_block  0.0010251998901367188
generate_one_block  0.0011301040649414062
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018818378448486328
gen group dst list time:  0.00013256072998046875
time for parepare:  0.0007891654968261719
local_output_nid generation:  5.125999450683594e-05
local_in_edges_tensor generation:  0.0004124641418457031
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0003819465637207031
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  6.818771362304688e-05
r_  generation:  0.00022482872009277344
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.00019931793212890625
local_output_nid generation:  1.430511474609375e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  5.4836273193359375e-05
r_  generation:  0.00032067298889160156
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00016188621520996094
mini_batch_src_global generation:  4.172325134277344e-05
r_  generation:  0.0002841949462890625
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001475811004638672
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.0003485679626464844
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00013184547424316406
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.0001571178436279297
local_output_nid generation:  1.4066696166992188e-05
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  4.2438507080078125e-05
r_  generation:  0.000415802001953125
----------------------check_connections_block total spend ----------------------------- 0.0066759586334228516
generate_one_block  0.004716396331787109
generate_one_block  0.0026509761810302734
generate_one_block  0.0025293827056884766
generate_one_block  0.0027272701263427734
generate_one_block  0.0025119781494140625
generate_one_block  0.002087831497192383
generate_one_block  0.0015444755554199219
generate_one_block  0.0017464160919189453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.016492843627929688
gen group dst list time:  0.00016355514526367188
time for parepare:  0.0005121231079101562
local_output_nid generation:  3.933906555175781e-05
local_in_edges_tensor generation:  0.1234288215637207
mini_batch_src_global generation:  0.0004112720489501953
r_  generation:  0.0010406970977783203
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00033211708068847656
mini_batch_src_global generation:  0.00011134147644042969
r_  generation:  0.0007185935974121094
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.00020122528076171875
mini_batch_src_global generation:  0.00010752677917480469
r_  generation:  0.0007152557373046875
local_output_nid generation:  6.079673767089844e-05
local_in_edges_tensor generation:  0.000217437744140625
mini_batch_src_global generation:  0.00012183189392089844
r_  generation:  0.0009508132934570312
local_output_nid generation:  5.078315734863281e-05
local_in_edges_tensor generation:  0.0002117156982421875
mini_batch_src_global generation:  0.0001049041748046875
r_  generation:  0.0008921623229980469
local_output_nid generation:  4.863739013671875e-05
local_in_edges_tensor generation:  0.000209808349609375
mini_batch_src_global generation:  0.00010538101196289062
r_  generation:  0.0008831024169921875
local_output_nid generation:  3.719329833984375e-05
local_in_edges_tensor generation:  0.00019097328186035156
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0006375312805175781
local_output_nid generation:  5.650520324707031e-05
local_in_edges_tensor generation:  0.0002448558807373047
mini_batch_src_global generation:  0.00014066696166992188
r_  generation:  0.0011954307556152344
----------------------check_connections_block total spend ----------------------------- 0.1365971565246582
generate_one_block  0.0030062198638916016
generate_one_block  0.0020339488983154297
generate_one_block  0.0018553733825683594
generate_one_block  0.002150297164916992
generate_one_block  0.0021295547485351562
generate_one_block  0.001989126205444336
generate_one_block  0.0018379688262939453
generate_one_block  0.0023734569549560547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007282733917236328  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21821.44921875, 'VmHWM': 4615.73046875, 'VmRSS': 4615.72265625}
connection checking time:  0.14327311515808105
block generation total time  0.03789067268371582
average batch blocks generation time:  0.0047363340854644775
block dataloader generation time/epoch 42.84715032577515
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007081508636474609  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.5703125, 'VmHWM': 4618.0234375, 'VmRSS': 4618.0234375}
torch.Size([1056, 1433])
torch.Size([476, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007349967956542969  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.5703125, 'VmHWM': 4618.0234375, 'VmRSS': 4618.0234375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005329132080078125  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.5703125, 'VmHWM': 4618.6328125, 'VmRSS': 4618.6328125}
torch.Size([729, 1433])
torch.Size([312, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005517482757568359  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.5703125, 'VmHWM': 4618.6328125, 'VmRSS': 4618.6328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006402015686035156  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.5703125, 'VmHWM': 4618.6875, 'VmRSS': 4618.6875}
torch.Size([930, 1433])
torch.Size([296, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006579875946044922  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.5703125, 'VmHWM': 4618.6875, 'VmRSS': 4618.6875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007466793060302734  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4618.9375, 'VmRSS': 4618.9375}
torch.Size([1128, 1433])
torch.Size([452, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007721900939941406  GigaBytes
Max Memory Allocated: 0.01300811767578125  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4618.9375, 'VmRSS': 4618.9375}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0070743560791015625  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4618.953125, 'VmRSS': 4618.953125}
torch.Size([1055, 1433])
torch.Size([401, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.007306098937988281  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4618.953125, 'VmRSS': 4618.953125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.006972789764404297  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4619.11328125, 'VmRSS': 4619.11328125}
torch.Size([1036, 1433])
torch.Size([379, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.0072002410888671875  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4619.11328125, 'VmRSS': 4619.11328125}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005696296691894531  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4619.1875, 'VmRSS': 4619.1875}
torch.Size([798, 1433])
torch.Size([269, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.005859851837158203  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21824.96484375, 'VmHWM': 4619.1875, 'VmRSS': 4619.1875}
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008003711700439453  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21825.50390625, 'VmHWM': 4619.7109375, 'VmRSS': 4619.7109375}
torch.Size([1227, 1433])
torch.Size([551, 32])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2420654296875 GB
    Memory Allocated: 0.008339405059814453  GigaBytes
Max Memory Allocated: 0.013074874877929688  GigaBytes

{'VmPeak': 21885.21484375, 'VmSize': 21825.50390625, 'VmHWM': 4619.7109375, 'VmRSS': 4619.7109375}
{'VmPeak': 21885.21484375, 'VmSize': 21825.50390625, 'VmHWM': 4619.7109375, 'VmRSS': 4619.7109375}
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0029693245887756348 |0.000505298376083374 |0.0037224292755126953 |0.00014895200729370117 |0.0034706294536590576 |0.0019783973693847656 |
----------------------------------------------------------pseudo_mini_loss sum 2.6144702434539795
{'VmPeak': 21885.21484375, 'VmSize': 21825.50390625, 'VmHWM': 4619.7109375, 'VmRSS': 4619.7109375}
Total (block generation + training)time/epoch 42.94690656661987
Training time/epoch 0.09955286979675293
Training time without block to device /epoch 0.09551048278808594
Training time without total dataloading part /epoch 0.0607144832611084
load block tensor time/epoch 0.023754596710205078
block to device time/epoch 0.004042387008666992
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  11846
Number of first layer input nodes during this epoch:  7959
